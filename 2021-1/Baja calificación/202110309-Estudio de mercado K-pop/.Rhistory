#text(hh,EdadesMuestra$Fr.relativa+0.1, labels = EdadesMuestra$Fr.relativa)
# Estilo del eje y, ajustado a los límites
EdadesMuestra$Fr.relativa
TablaFrecabs = function(){
Intervalos<-c("[8,10)","[10,12)","[12,14)","[14,16)","[16,18)","[18,20)","[20,22)","[22,24)","[24,26)", "[26,28)","[28,30)","[30,32)","[32,34)","[34,36)")
Frec_relativa<-c(0.005,0.01,0.01,0.09,0.19,0.30,0.18,0.08,0.06,0.03,0.02,0.01,0.01,0.005)
tabla = data.frame(Intervalos, Frec_relativa)
tabla
}
EdadPoblacion<-TablaFrecabs()
EdadPoblacion
op=par(mfrow=c(2,3))
#muestra
p<-0.0137
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.005
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[8,10)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
#---------
p<-0.0137
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.01
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[12,14)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
#---------
p<-0.0616
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.09
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[14,16)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
#---------
p<-0.16
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.19
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[16,18)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
#---------
p<-0.3082
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.30
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[18,20)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
#---------
p<-0.2055
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
pb<-0.18
X <- seq(-1,1, by = 0.1)
plot(X, dnorm(X), type = "l",ylab="Densidad Normal",main="[20,22)")
abline(v=c(inf8,sup8),lty=2, col = "blue")
abline(h = 0, col = "gray")
abline(v = pb, col = "red")
par(op)
p<-0.0137
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf8<-p-(z*(sqrt((p*(1-p))/n)))
sup8<-p+(z*(sqrt((p*(1-p))/n)))
p8<-0.005
p<-0.0
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf10<-p-(z*(sqrt((p*(1-p))/n)))
sup10<-p+(z*(sqrt((p*(1-p))/n)))
p10<-0.01
p<-0.0137
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf12<-p-(z*(sqrt((p*(1-p))/n)))
sup12<-p+(z*(sqrt((p*(1-p))/n)))
p12<-0.01
p<-0.0616
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf14<-p-(z*(sqrt((p*(1-p))/n)))
sup14<-p+(z*(sqrt((p*(1-p))/n)))
p14<-0.09
p<-0.2534
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf16<-p-(z*(sqrt((p*(1-p))/n)))
sup16<-p+(z*(sqrt((p*(1-p))/n)))
p16<-0.19
p<-0.3082
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf18<-p-(z*(sqrt((p*(1-p))/n)))
sup18<-p+(z*(sqrt((p*(1-p))/n)))
p18<-0.30
p<-0.2055
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf20<-p-(z*(sqrt((p*(1-p))/n)))
sup20<-p+(z*(sqrt((p*(1-p))/n)))
p20<-0.18
p<-0.0753
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf22<-p-(z*(sqrt((p*(1-p))/n)))
sup22<-p+(z*(sqrt((p*(1-p))/n)))
p22<-0.08
p<-0.0342
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf24<-p-(z*(sqrt((p*(1-p))/n)))
sup24<-p+(z*(sqrt((p*(1-p))/n)))
p24<-0.06
p<-0.0137
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf26<-p-(z*(sqrt((p*(1-p))/n)))
sup26<-p+(z*(sqrt((p*(1-p))/n)))
p26<-0.03
p<-0.0068
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf28<-p-(z*(sqrt((p*(1-p))/n)))
sup28<-p+(z*(sqrt((p*(1-p))/n)))
p28<-0.02
p<-0.0068
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf30<-p-(z*(sqrt((p*(1-p))/n)))
sup30<-p+(z*(sqrt((p*(1-p))/n)))
p30<-0.01
p<-0
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf32<-p-(z*(sqrt((p*(1-p))/n)))
sup32<-p+(z*(sqrt((p*(1-p))/n)))
p32<-0.01
p<-0.0068
IC<-0.95
alfa<-1-IC
z<-qnorm(alfa/2,lower.tail = FALSE)
inf34<-p-(z*(sqrt((p*(1-p))/n)))
sup34<-p+(z*(sqrt((p*(1-p))/n)))
p34<-0.005
summary(DF_Filtrado$Edad)
hist(DF_Filtrado$Edad, col = "orange", main= "Histograma de Edad de la población K-pop", xlab="Edad", ylab = "Frecuencia", freq = FALSE, breaks = 20)
curve(dnorm(x, mean(DF_Filtrado$Edad), sd = sd(DF_Filtrado$Edad)), # Función dnorm a evaluar
0, 40,150, # Límites de x y nº de valores a evaluar
col = "slateblue4",
lwd= 2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i", add=TRUE)
n<-nrow(DF_Filtrado)
media<-21
media_p<-mean(DF_Filtrado$Edad)
s<-sd(DF_Filtrado$Edad)
IC<-0.95
alfa<-1-IC
zcrit<- qt(alfa,df=n-1,lower.tail = T)
#zcrit
zobservado <-(media_p-media)*sqrt(n)/(s)
#zobservado
pvalue<-pt(zobservado,df=n-1,lower.tail = T)
#pvalue
precision3<-zcrit*s/sqrt(n)
#precision3
X <- seq(-8,8, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-5,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
summary(DR$Inversion)
hist(DR$Inversion, col = "orange", main= "Histograma de Inversion de los estudiantes", xlab="Cantidad en soles", ylab = "Frecuencia", freq = FALSE)
curve(dexp(x, 1/mean(DR$Inversion,na.rm = TRUE)), # Función dexp a evaluar
0, 600, 200, # Límites de x y nÂº de valores a evaluar
col = "red",
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(0, 10, 600),  # Marcas del eje x
ylim = c(0,0.1), # Límites del eje
yaxs = "i", add = TRUE) # Estilo del eje y, ajustado a los límites
points(DR$Inversion, dexp(DR$Inversion, 1/mean(DR$Inversion,na.rm = TRUE)), ylab = "f(x)", pch = 20,  lwd = 1, col = "blue")
n<-nrow(DR)
media<-mean(DR$Inversion)
media_p<-median(DR$Inversion)
s<-sd(DR$Inversion)
IC<-0.95
alfa<-1-IC
zcrit<- qt(alfa,df=n-1,lower.tail = FALSE)
zobservado <- (media-media_p)*sqrt(n)/(s)
#zobservado
pvalue<-pt(zobservado,df=n-1,lower.tail = FALSE)
#pvalue
precision3<-zcrit*s/sqrt(n)
X <- seq(-7, 7, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-7,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
summary(DR$Kilocalorias[DR$IMC>=25])
boxplot(DR$Kilocalorias ~ DR$imc_OMS,horizontal = T,las=1 ,main="Distribución de kcal en plato por IMC",xlab = "kcal",ylab=" ",col=c("yellow","lightgreen","purple","skyblue"), cex.axis=.65 )
IMC_elevado<-filter(DR,DR$IMC>=25)
n<-nrow(IMC_elevado)
media<-mean(IMC_elevado$Kilocalorias, na.rm = TRUE)
media_p<-median(IMC_elevado$Kilocalorias,na.rm = TRUE) #poblacion en general
s<-sd(IMC_elevado$Kilocalorias, na.rm = TRUE)
IC<-0.95
alfa<-1-IC
zcrit<-qt(alfa,df=n-1,lower.tail = FALSE)
zobservado <- (media-media_p)*sqrt(n)/(s)
pvalue<-pt(zobservado,df=n-1,lower.tail = FALSE) #grado de libertad
precision1<-zcrit*s/sqrt(n)
X <- seq(-5, 5, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(2.5,0.4,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
lm3<-lm(DR$Frec_Consum~DR$Inversion)
summary(lm3)
hist(lm3$residuals, breaks= 30,main="Histograma residuales de regresión Consumo mensual vs. Gastos", freq = FALSE,col="tan1")
curve(dnorm(x, mean(lm3$residuals), sd = sd(lm3$residuals)), # Función dnorm a evaluar
-30, 50,150, # Límites de x y nº de valores a evaluar
col = "royalblue4",
lwd= 2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i", add=TRUE) # Estilo del eje y, ajustado a los límites
lm5<-lm(DR$IMC~ (DR$Frec_Consum+DR$Kilocalorias))
summary(lm5)
hist(lm5$residuals, breaks= 30,main="Histograma residuales de regresión Consumo mensual vs. Gastos", freq = FALSE,col="tan1")
curve(dnorm(x, mean(lm5$residuals), sd = sd(lm5$residuals)), # Función dnorm a evaluar
-15, 15, 500, # Límites de x y nº de valores a evaluar
col = "red",
lwd=2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i",add=T) # Estilo del eje y, ajustado a los límites
knitr::opts_chunk$set(echo = FALSE)
redondeo<-function(x){
result<-round(x,2)
return(result)
}
library(dplyr)
library(readr)
#install.packages("ftdh")
library(stringr)
library(modeest)
#library(ftdh)
DF<- read_csv("Kpop.csv")
DR<- read_csv("RestauranteKpop.csv")
DF<-rename(DF,"Seguidor"="Marca temporal","Sigues"="1. ¿Sigues el género K-pop?", "Edad"="2. ¿Qué edad tienes?","Genero"="3.¿Cuál es su género?", "Tiempo"="4. ¿Hace cuántos años sigue el K-pop?","Fanclub"="5. ¿Pertenece a algún fan club?","Preferencia"= "6. ¿Qué es lo que más le gusta del género K-pop?","Grupo"="7. ¿Cuál es su grupo favorito?","Importancia"="8. ¿Cuán importante considera el K-pop en su vida? Siendo 1 poco importante y 5 muy importante","Influencia"="9.  ¿De qué forma le llegó a gustar el K-pop?","Sentimiento"="10. ¿Cómo se siente al escuchar K-pop?","Medios"="11. ¿Qué medios de comunicación sueles utilizar para mantenerte al tanto del K-pop?","DineroCompras"="12. ¿Cuánto dinero (S/) mensualmente invierte en compras de productos relacionados al K-pop?","DineroServicios"="13. ¿Cuánto dinero (S/) mensualmente invierte en servicios relacionados al K-Pop?","Producto"="14. ¿Qué productos compras o comprarías relacionados al K-pop? Elija 1 de acuerdo a su preferencia","Servicio"="15. ¿A qué servicios recurre o recurriría con temática K-pop? Elija 1 de acuerdo a su preferencia","Exclusion"="16. ¿Te has sentido juzgado o discriminado por ser K-poper?" )
DR<-rename(DR,"Seguidor"="Marca temporal","Peso"="¿Cuál es su peso? En kg", "Estatura"="¿Cuál es su estatura? En cm","Tipo_Comida"="¿Qué tipo de comida preferiría que contenga la carta?", "Frec_Consum"="¿Cuántas veces al mes consume en un restaurante? Incluya las veces que pide comida por delivery por la situación actual","Inversion"="¿Cuánto gasta mensualmente al recurrir a restaurantes?","b_Comida"= "¿El tipo de comida determina su preferencia en un restaurante? Por ejemplo comida vegetariana, dietética, etc.","Tipo_Dieta"="¿Qué tipo de dieta alimenticia sigue?", "Kilocalorias"="¿Cuántas kilocalorías procura consumir en un plato de comida?" )
DF_Filtrado <- DF %>% filter(Sigues == "Si" ) %>% select(Edad:Exclusion)# recordar que Edad - Tiempo>=4 para cuando se trabaje con la variable Tiempo
DR<-mutate(DR, IMC= round(Peso/(Estatura/100)^2, 2))
Numericos<-function(X){
return(list(Min=redondeo(min(X,na.rm=T)),
Max=redondeo(max(X,na.rm=T)),
Moda=redondeo(mfv(X,na_rm = T)),
Media=redondeo(mean(X,na.rm = T )),
Mediana=redondeo(median(X, na.rm = T)),
Desviacion=redondeo(sd(X,na.rm=T)),
Varianza=redondeo(var(X,na.rm = T)),
CV=redondeo((sd(X,na.rm=T)/mean(X,na.rm=T)))))
}
mapply(Numericos, list(Edad= DF_Filtrado$Edad))
boxplot(DR$IMC, horizontal = TRUE,main="Distribución de IMC", xlab="Indice de masa corporal",col="khaki1")
abline(v=mean(DR$IMC,na.rm=TRUE),col="red",lwd=2)
abline(v=18.5,col="lightblue",lty=2)
abline(v=25,col="lightblue",lty=2)
boxplot(DR$Inversion, horizontal = TRUE,main="Distribución de inversión mensual", xlab="Inversión mensual en Restaurante (soles)",col="yellow")
abline(v=mean(DR$Inversion,na.rm=TRUE),col="chocolate4",lwd=2)
#Categorizar IMC según clasificación de la OMS
DR$imc_OMS[DR$IMC<18.5]="Desnutrición"
DR$imc_OMS[DR$IMC>=18.5]="Normal"
DR$imc_OMS[DR$IMC>=25]="Sobrepeso"
DR$imc_OMS[DR$IMC>=30]="Obesidad"
boxplot(DR$Inversion~DR$imc_OMS,main="Distribución de la inversión en restaurantes por la clasificación del IMC",xlab="Clasificación IMC",ylab="Inversión",col=c("gold2","lightgreen","tomato","lightblue","orange3"))
abline(h=mean(DR$Inversion),col="red",lwd=2)
abline(h=median(DR$Inversion),col="blue",lwd=2)
legend(x = "topright",c("media","mediana"),col=c("red","blue"),lwd=2)
plot(DR$Inversion,DR$Frec_Consum,main="Relación entre la inversión mensual y la frecuencia que va al restaurante",xlab="Inversión mensual",ylab="Frecuencia restaurante",col=c("Green"),pch=20)
abline(lm(DR$Frec_Consum~DR$Inversion), col = "red",lwd=2)
round(cor(DR$Inversion,DR$Frec_Consum, use ="complete.obs"),2)
round(cov(DR$Inversion,DR$Frec_Consum, use ="complete.obs"),2)
TablaFrecs = function(x,k,A,p){
L = (min(x)-1)-p/2+A*(0:k)
x_cut = cut(x, breaks = L, right=FALSE)
Intervalos = levels(x_cut)
Media = (L[1]+L[2])/2+A*(0:(k-1))
Fr.absoluta= as.vector(table(x_cut))
Fr.relativa = round(Fr.absoluta/length(x),4)
Fr.abs.acum = cumsum(Fr.absoluta)
Fr.rel.acum = cumsum(Fr.relativa)
tabla = data.frame(Intervalos, Media, Fr.absoluta,  Fr.relativa)
tabla
}
EdadesMuestra<-TablaFrecs(DF_Filtrado$Edad,k=14,A = 2,p=0)
hist(DF_Filtrado$Edad,breaks = 14,main="Histograma de Edades", col="skyblue", xlab = "Residuos", freq = FALSE)
curve(dnorm(x, mean(DF_Filtrado$Edad), sd = sd(DF_Filtrado$Edad)), # Función dnorm a evaluar
0, 40,150, # Límites de x y nº de valores a evaluar
col = "slateblue4",
lwd= 2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i", add=TRUE)
#text(hh,EdadesMuestra$Fr.relativa+0.1, labels = EdadesMuestra$Fr.relativa)
# Estilo del eje y, ajustado a los límites
TablaFrecabs = function(){
Intervalos<-c("[8,10)","[10,12)","[12,14)","[14,16)","[16,18)","[18,20)","[20,22)","[22,24)","[24,26)", "[26,28)","[28,30)","[30,32)","[32,34)","[34,36)")
Frec_relativa<-c(0.005,0.01,0.01,0.09,0.19,0.30,0.18,0.08,0.06,0.03,0.02,0.01,0.01,0.005)
tabla = data.frame(Intervalos, Frec_relativa)
tabla
}
EdadPoblacion<-TablaFrecabs()
EdadPoblacion
knitr::include_graphics("Graf_confianza.png")
knitr::include_graphics("Tabla_confianza.png")
summary(DF_Filtrado$Edad)
hist(DF_Filtrado$Edad, col = "orange", main= "Histograma de Edad de la población K-pop", xlab="Edad", ylab = "Frecuencia", freq = FALSE, breaks = 20)
curve(dnorm(x, mean(DF_Filtrado$Edad), sd = sd(DF_Filtrado$Edad)), # Función dnorm a evaluar
0, 40,150, # Límites de x y nº de valores a evaluar
col = "slateblue4",
lwd= 2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i", add=TRUE)
n<-nrow(DF_Filtrado)
media<-20
media_p<-median(DF_Filtrado$Edad)
s<-sd(DF_Filtrado$Edad)
IC<-0.95
alfa<-1-IC
zcrit<- qt(alfa,df=n-1,lower.tail = FALSE)
#zcrit
zobservado <- (media-media_p)*sqrt(n)/(s)
#zobservado
pvalue<-pt(zobservado,df=n-1,lower.tail = FALSE)
#pvalue
precision3<-zcrit*s/sqrt(n)
#precision3
X <- seq(-5,5, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-5,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
X <- seq(-5,5, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-5,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
summary(DR$Inversion)
hist(DR$Inversion, col = "orange", main= "Histograma de Inversion de los estudiantes", xlab="Cantidad en soles", ylab = "Frecuencia", freq = FALSE)
curve(dexp(x, 1/mean(DR$Inversion,na.rm = TRUE)), # Función dexp a evaluar
0, 600, 200, # Límites de x y nÂº de valores a evaluar
col = "red",
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(0, 10, 600),  # Marcas del eje x
ylim = c(0,0.1), # Límites del eje
yaxs = "i", add = TRUE) # Estilo del eje y, ajustado a los límites
points(DR$Inversion, dexp(DR$Inversion, 1/mean(DR$Inversion,na.rm = TRUE)), ylab = "f(x)", pch = 20,  lwd = 1, col = "blue")
n<-nrow(DR)
media<-mean(DR$Inversion)
media_p<-median(DR$Inversion)
s<-sd(DR$Inversion)
IC<-0.95
alfa<-1-IC
zcrit<- qt(alfa,df=n-1,lower.tail = FALSE)
zobservado <- (media-media_p)*sqrt(n)/(s)
zobservado
pvalue<-pt(zobservado,df=n-1,lower.tail = FALSE)
pvalue
precision3<-zcrit*s/sqrt(n)
X <- seq(-7, 7, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-7,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
X <- seq(-7, 7, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-7,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
summary(DR$Kilocalorias[DR$IMC>=25])
boxplot(DR$Kilocalorias ~ DR$imc_OMS,horizontal = T,las=1 ,main="Distribución de kcal en plato por IMC",xlab = "kcal",ylab=" ",col=c("yellow","lightgreen","purple","skyblue"), cex.axis=.65 )
IMC_elevado<-filter(DR,DR$IMC>=25)
n<-nrow(IMC_elevado)
media<-mean(IMC_elevado$Kilocalorias, na.rm = TRUE)
media_p<-median(IMC_elevado$Kilocalorias,na.rm = TRUE) #poblacion en general
s<-sd(IMC_elevado$Kilocalorias, na.rm = TRUE)
IC<-0.95
alfa<-1-IC
zcrit<-qt(alfa,df=n-1,lower.tail = FALSE)
zobservado <- (media-media_p)*sqrt(n)/(s)
pvalue<-pt(zobservado,df=n-1,lower.tail = FALSE) #grado de libertad
precision1<-zcrit*s/sqrt(n)
X <- seq(-5, 5, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(2.5,0.4,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
X <- seq(-5, 5, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(2.5,0.4,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
lm3<-lm(DR$Frec_Consum~DR$Inversion)
summary(lm3)
hist(lm3$residuals, breaks= 30,main="Histograma residuales de regresión Consumo mensual vs. Gastos", freq = FALSE,col="tan1")
curve(dnorm(x, mean(lm3$residuals), sd = sd(lm3$residuals)), # Función dnorm a evaluar
-30, 50,150, # Límites de x y nº de valores a evaluar
col = "royalblue4",
lwd= 2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i", add=TRUE) # Estilo del eje y, ajustado a los límites
n<-nrow(DF_Filtrado)
media<-21
media_p<-mean(DF_Filtrado$Edad)
s<-sd(DF_Filtrado$Edad)
IC<-0.95
alfa<-1-IC
zcrit<- qt(alfa,df=n-1,lower.tail = T)
#zcrit
zobservado <-(media_p-media)*sqrt(n)/(s)
#zobservado
pvalue<-pt(zobservado,df=n-1,lower.tail = T)
#pvalue
precision3<-zcrit*s/sqrt(n)
#precision3
X <- seq(-8,8, by = 0.1)
plot(X, dt(X,df=n-1), type = "l",ylab="Densidad de t-Student")
abline(v=c(zcrit,zobservado), lty = c(1,2), col = c("red", "blue"))
abline(h = 0, col = "gray")
legend(-5,0.38,c("zcritico","zobservado"),col=c("red","blue"), lty = c(1,2))
lm5<-lm(DR$IMC~ (DR$Frec_Consum+DR$Kilocalorias))
summary(lm5)
hist(lm5$residuals, breaks= 30,main="Histograma residuales de regresión Consumo mensual vs. Gastos", freq = FALSE,col="tan1")
curve(dnorm(x, mean(lm5$residuals), sd = sd(lm5$residuals)), # Función dnorm a evaluar
-15, 15, 500, # Límites de x y nº de valores a evaluar
col = "red",
lwd=2,
las = 1, # Etiquetas alineadas horizontalmente
ann = FALSE, # Sin títulos en los ejes
xaxp = c(-15, 15, 5),  # Marcas del eje x
ylim = c(0,0.05), # Límites del eje
yaxs = "i",add=T) # Estilo del eje y, ajustado a los límites
plot((DR$Frec_Consum+DR$Kilocalorias),DR$IMC,pch=20,col=rgb(0,0,0,0.2))
knitr::opts_chunk$set(echo = FALSE)
lm3<-lm(DR$Frec_Consum~DR$Inversion)
summary(lm3)
knitr::include_graphics("Var_dr.png")
knitr::include_graphics("Var_kp.png")
knitr::include_graphics("Var_dr.png")
