---
title: "Inversión Cryptos"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: lumen
---

<div style="text-align: justify">


# **Introducción**

## Relevancia

En el mundo actual, las inversiones digitales tales como las criptomonedas y acciones se han vuelto muy populares y fáciles de acceder debido a su método digital. La relevancia de este tema es que al ser un nuevo método digital hay mucha gente que le falta informarse y por este desconocimiento hacen malas inversiones que les genera pérdidas de su dinero. Es importante tener un conocimiento de la forma en que tienen las personas de pensar acerca de estos tipos de inversiones. De esta manera, la importancia de la encuesta es analizar que tanto las formas de inversión digitales han entrado en la comunidad universitaria de UTEC, y de qué forma han sido asimiladas.

# **Datos**

## Proceso de recolección de datos

Para recolectar los datos utilizamos la herramienta **Google Forms**, la cual nos permite crear encuestas y compartirlas. Las encuestas fueron enviadas de manera masiva a los correos de los estudiantes de UTEC, se realizó de esta manera porque consideramos que utilizar medios digitales para llegar a nuestro público objetivo era factible, ahorra tiempo y recursos. Asimismo, nos aseguramos que la encuesta contiene preguntas sencillas y fáciles de responder, sabemos que el tiempo de un universitario es limitado, por lo tanto, nos aseguramos que nuestra encuesta no demande mucho tiempo. Además, con el objetivo de obtener más observaciones ofrecimos un sorteo entre las personas que llenen la encuesta.

## Población, muestra y muestreo

-   **Población**: Los estudiantes universitarios.

-   **Unidad muestral:** Estudiante universitario de UTEC.

-   **Tamaño de la muestra:** 203 estudiantes.

-   **Representatividad:** Cada alumno de UTEC presentó la misma probabilidad de ser incluido en la muestra. Nuestra metodología, presenta pocos sesgos gracias a la estrategia de recolección de datos. Asimismo, la información obtenida no se ve afectada por el tiempo.

-   **Tipo de muestreo:** El tipo de muestreo que realizamos fue el `Muestreo Probabilístico Aleatorio Simple`, pues la encuesta buscaba llegar a personas que formen parte del alumnado de UTEC de forma aleatoria debido a que consideramos que es la más sensata y factible para nuestro tipo de proyecto.

## Clasificación de Variables

Variables generales:

| [Variable]{.smallcaps} | [Tipo de variable]{.smallcaps} |      [Restricción]{.smallcaps}       |
|:-----------------:|:-----------------------:|:--------------------------:|
|        Carrera         |      Cualitativa Nominal       | Lista de opciones (Carreras de UTEC) |
|   Periodo de ingreso   |      Cualitativa Nominal       |          Lista de opciones           |
|         Género         |      Cualitativa Nominal       |          Lista de opciones           |
|   Invertido sí o no    | Cualitativa Nominal Dicotómica |                Sí/No                 |

Variables en caso la persona **no invierta**:

<table style="width:98%;">
<colgroup>
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><p><span class="smallcaps">Variable</span></p></th>
<th style="text-align: center;"><p><span class="smallcaps">Tipo de variable</span></p></th>
<th style="text-align: center;"><p><span class="smallcaps">Restricción</span></p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><p>Razón de no inversión</p></td>
<td style="text-align: center;"><p>Cualitativa Nominal</p></td>
<td style="text-align: center;"><p>Lista de opciones</p>
<p>Desinformación, no cuentas con dinero, desinterés, miedo al fracaso, otro</p></td>
</tr>
<tr class="even">
<td style="text-align: center;"><p>Inversión a Futuro</p></td>
<td style="text-align: center;"><p>Cualitativa Nominal</p></td>
<td style="text-align: center;"><p>Sí/No</p></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><p>Conoce a un inversionista</p></td>
<td style="text-align: center;"><p>Cualitativa Nominal</p></td>
<td style="text-align: center;"><p>Sí/No</p></td>
</tr>
<tr class="even">
<td style="text-align: center;"><p>Curso de educación financiera en UTEC</p></td>
<td style="text-align: center;"><p>Cualitativa Nominal</p></td>
<td style="text-align: center;"><p>Sí/No</p></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><p>Disposición a invertir</p></td>
<td style="text-align: center;"><p>Cualitativa Nominal</p></td>
<td style="text-align: center;"><p>Lista de opciones</p></td>
</tr>
</tbody>
</table>

Variables en caso la persona **invierta**:

|               [Variable]{.smallcaps}               | [Tipo de variable]{.smallcaps} |                                [Restricción]{.smallcaps}                                 |
|:------------------:|:----------------:|:--------------------------------:|
|               Conocimiento del tema                |      Cualitativa ordinal       |                                           1-5                                            |
|               Seguridad al invertir                |      Cualitativa ordinal       |                                           1-5                                            |
|              Inversiones en acciones               |      Cualitativa nominal       |                         Lista de opciones de acciones existentes                         |
|               Inversiones en cryptos               |      Cualitativa nominal       |                         Lista de opciones de cryptos existentes                          |
|             Tiempo mensual invirtiendo             |      Cualitativa ordinal       |                                    Valores entre 1-5                                     |
|            Tipo de acción más adquirida            |      Cualitativa nominal       |                                    Lista de opciones                                     |
|         Tipo de criptomoneda más adquirida         |      Cualitativa nominal       |                                    Lista de opciones                                     |
|               Disposición a invertir               |      Cualitativa nominal       |                                          Si/No                                           |
|       Medio por el que aprendiste a invertir       |      Cualitativa nominal       | Lista de opciones (Autodidacta, Intermediario, Curso de inversiones, Prueba error, otro) |
|          Porcentaje de pérdida tolerable           |     Cuantitativa discreta      |                          Número natural positivo entre 0 y 100                           |
| Porcentaje de los ingresos dedicado a la inversión |     Cuantitativa discreta      |                          Número natural positivo entre 0 y 100                           |
|                    Volatilidad                     |      Cualitativa nominal       |                        Opciones (Criptomonedas, acciones, ambos)                         |
|   Porcentaje de ganancias en base a la inversión   |     Cuantitativa discreta      |                          Número natural positivo entre 0 y 100                           |

## Librerías utilizadas

-   readr
-   dplyr
-   ggplot
-   modeest

```{r load_libraries, echo=FALSE, message=FALSE}
library(readr)
library(dplyr)
library(modeest)
```

```{r, echo=FALSE,include=FALSE}
CRP <- read_csv("ENCUESTA.csv")
```

```{r, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
r <- function(x){
  resul <- round(x,2)
  return(resul)
}
```

```{r, echo=FALSE, include=FALSE}
spec(CRP)
```

## Criterios generales de Limpieza de la base de datos

Para la limpieza de datos usamos los siguientes criterios:

1.  Identificar nuevamente si las variables presentan utilidad para nuestro proyecto.

2.  Realizamos un análisis exploratorio: renombramos las variables, asignamos el tipo de variable (numérico o caracter), cuantificar los datos erróneos.

3.  Los datos evidentemente erróneos fueron re-consultados a la fuente original, de esta manera fueron corregidos los datos.

4.  Cada pregunta de encuesta tenía condiciones de llenado, y un ejemplo referencial de llenado. En caso no se siguió el modelo, se corrige de la siguiente manera (2021.1 -- \> 2021-1).

5.  Analizamos si los datos recogidos presentados son posibles y tienen sentido. Los datos imposibles fueron re-consultados a la fuente.

```{r, echo=FALSE,results='hide'}
names(CRP)=c("MARCA TEMPORAL","CORREO ELECTRÓNICO","NOMBRE Y APELLIDO","EDAD","CARRERA","CICLO","PERIODO","GÉNERO","DINERO INVERTIDO EN ACCIONES O CRYPTOS","¿PORQUÉ NO INVIERTES EN ACC O CRYPTOS?","¿INVERTIRÍAS TU DINERO A FUTURO?","CONOCIMIENTO DEL TEMA DEL 1 AL 5","SEGURIDAD DEL TEMA DEL 1 AL 5","DINERO INVERTIDO EN ACCIONES","DINERO INVERTIDO EN CRYPTOS","TIEMPO INVERTIDO AL MES EN HORAS","ACCIONES ADQUIRIRAS EN ALGUNA EMPRESA","TIPO DE CRYPTOS","¿CONOCES A ALGUIEN QUE INVIRTIÓ EN CRYPTOS?","EDUCACIÓN FINANCIERA UNIVERSITARIA","¿EN QUÉ INVERTIRÍAS SI NO ES CRYPTOS O ACCIONES?","MEDIO DE APRENDIZAJE DE CRYPTOS","PORCENTAJE DE PÉRDIDA TOLERABLE","PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN","¿CUÁL ES MÁS VOLÁTIL?","PORCENTAJE DE GANANCIA OBTENIDA")
```

```{r echo=FALSE,results='hide',message=FALSE,include=FALSE}
 CRP <- CRP %>% mutate(`MEDIO DE APRENDIZAJE DE CRYPTOS` = 
        ifelse(`MEDIO DE APRENDIZAJE DE CRYPTOS` == "Autodidacta (Internet, videos, libros, etc)", "Autodidacta", 
        ifelse(`MEDIO DE APRENDIZAJE DE CRYPTOS` == "Intermediario (familiar, amigo, conocido, etc)", "Intermediario",
        ifelse(`MEDIO DE APRENDIZAJE DE CRYPTOS` =="Prueba y error", "Pr. y Err.",
        ifelse(`MEDIO DE APRENDIZAJE DE CRYPTOS` == "Curso de inversiones", "Cursos", `MEDIO DE APRENDIZAJE DE CRYPTOS`)))))
CRP
```

## Limpieza de la base de datos

### Corrección de la variable: **Periodo**

1.  Identificamos las diferencias de ingresos de datos de periodo. Vemos que `2021.1`,`2021 -1` es igual a `2021-1` sin embargo, R Studio lo cuenta como un dato distinto. Lo mismo ocurre con los demás.

```{r echo=FALSE}
unique(CRP$PERIODO)
```

2.  Elegimos el modelo correcto y uniformamos todos los ingresos.

```{r echo=FALSE,results="hide"}
CRP %>% mutate(PERIODO = 
        ifelse(PERIODO == "2017", "2017-1",
        ifelse(PERIODO %in% c("2019", "2019 - 2"), "2019-2",
        ifelse(PERIODO %in% c("2020", "2020-I","2020 - 1"), "2020-1",  
        ifelse(PERIODO == "2020 -1", "2020-1",
        ifelse(PERIODO %in% c("2021", "2021 -2","2021 - 2"), "2021-2",
        ifelse(PERIODO %in% c("2021 1", "2021.1"), "2021-1",
        ifelse(PERIODO == "2022-2", "2022-1",PERIODO
        )))))))) -> CRP
CRP %>% count(PERIODO)
```

### Corrección de la variable: `DINERO INVERTIDO EN ACCIONES` y `DINERO INVERTIDO EN CRYPTOS` filtrando la variable: **DINERO INVERTIDO EN ACCIONES O CRYPTOS**

**Encuestados que respondieron que `Sí` invierten su dinero en acciones o criptomonedas:**

Del rango seleccionado por los encuestados, se decidió tomar el promedio del *dinero invertido en acciones* y del *dinero invertido en cryptos* de la siguiente manera:

-   Si marcó el rango `<0 - 500>`, entonces $\frac{0+500}{2}=250$.
-   Si marcó el rango `<500 - 1000>`, entonces $\frac{500+1000}{2}=750$.
-   Si marcó el rango `<1000 - 2000>`, entonces $\frac{1000+2000}{2}=1500$.
-   Si marcó el rango `<2000 - 5000>`, entonces $\frac{2000+5000}{2}=3500$.
-   Si marcó el rango `<5000 - 10000>`, entonces $\frac{5000+10000}{2}=7500$.
-   Si marcó el rango `<+ 10000>`, entonces $12000$.

```{r include=FALSE}
CRP_SI <- CRP %>% filter(`DINERO INVERTIDO EN ACCIONES O CRYPTOS`=="Sí") %>% mutate(`DINERO INVERTIDO EN ACCIONES` = 
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "0 - 500", 250,
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "500 - 1000", 750,
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "1000 - 2000", 1500,
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "2000 - 5000", 3500,
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "5000 - 10000", 7500,
        ifelse(`DINERO INVERTIDO EN ACCIONES` == "+ 10000", 12000, `DINERO INVERTIDO EN ACCIONES`
        ))))))) %>% mutate(`DINERO INVERTIDO EN CRYPTOS` = 
        ifelse(`DINERO INVERTIDO EN CRYPTOS` == "0 - 500", 250,
        ifelse(`DINERO INVERTIDO EN CRYPTOS` == "500 - 1000", 750,
        ifelse(`DINERO INVERTIDO EN CRYPTOS` %in% c("1000 - 2 000","1000 - 2000"), 1500,
        ifelse(`DINERO INVERTIDO EN CRYPTOS` == "2 000 - 5 000", 3500,
        ifelse(`DINERO INVERTIDO EN CRYPTOS` == "5 000 - 10 000", 7500,
        ifelse(`DINERO INVERTIDO EN CRYPTOS` == "+ 10 000", 12000, `DINERO INVERTIDO EN CRYPTOS`
        ))))))) %>% mutate(`TIEMPO INVERTIDO AL MES EN HORAS` = 
        ifelse(`TIEMPO INVERTIDO AL MES EN HORAS` == "1", 34,
        ifelse(`TIEMPO INVERTIDO AL MES EN HORAS` == "2", 68,
        ifelse(`TIEMPO INVERTIDO AL MES EN HORAS` == "3", 102,
        ifelse(`TIEMPO INVERTIDO AL MES EN HORAS` == "4", 136,
        ifelse(`TIEMPO INVERTIDO AL MES EN HORAS` == "5", 170,
               `TIEMPO INVERTIDO AL MES EN HORAS`
        ))))))
CRP_SI
```

**Importante:** Debido a la naturaleza de nuestra encuesta, la cual dividía con distintas preguntas según la respuesta a la pregunta **¿Has invertido en criptomonedas o acciones?**, dividimos la data y creamos otro csv con los que sí han invertido.

```{r eval=TRUE}
write_csv(CRP_SI,"ENCUESTA_SI.csv")
```

```{r include=FALSE}
CRP_SI <- read_csv("ENCUESTA_SI.csv",col_types = "cccncccccccccnnnccccccnncn")
CRP_SI
```

```{r include=FALSE}
select(CRP_SI, `NOMBRE Y APELLIDO`:`PORCENTAJE DE GANANCIA OBTENIDA`)
```


```{r, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
r <- function(x){
  resul <- round(x,2)
  return(resul)
}
```


# **Análisis descriptivo**

El conjunto de datos tiene `r nrow(CRP)` observaciones y `r ncol(CRP)` variables. Hay un total de `r sum(!is.na(CRP))` datos no faltantes y `r sum(is.na(CRP))` datos faltantes que son responsables de **203** casos incompletos y **0** casos completos.

```{r, include=FALSE}
nrow(CRP)
ncol(CRP)
sum(is.na(CRP)) #Da el total de datos faltantes NA (como celda)
sum(!is.na(CRP)) #Da el total de datos No faltantes NA (como celda)
sum(complete.cases(CRP)) #El numero de observaciones o filas sin NA
sum(!complete.cases(CRP)) #El numero de observaciones o filas con NA
```

En función de los datos faltantes podemos observar que: En la tabla tenemos **36.47%** de datos faltantes, **63.53%** de datos completos, un **100 %** de filas incompletas y un **0 %** de filas completas. El porcentaje de datos faltantes es **pequeño**, pero afecta a un número relativamente **grande** de casos.

```{r, include=FALSE}
r(sum(!complete.cases(CRP))/nrow(CRP)*100)
r(sum(complete.cases(CRP))/nrow(CRP)*100)
```

Hay **9** variables sin datos faltantes. El promedio y la mediana del número de datos faltantes por variable son **74.04** y **73** respectivamente, el número promedio de datos faltantes por unidad muestral es **9.48**

```{r, include=FALSE}
colSums(is.na(CRP))
r(mean(colSums((is.na(CRP)))))
r(median(colSums((is.na(CRP)))))
r(mean(rowSums((is.na(CRP)))))
```

## Variable: **Porcentaje de pérdida tolerable**

Muestra el porcentaje de pérdida tolerable que cada persona encuestada considera. Del mismo modo, podría ocasionar que se retiren de una inversión. Indica el riesgo que cada persona está dispuesta a afrontar con el monto invertido.

**Con todos sus valores atípicos**

```{r echo=FALSE,include=FALSE}
 moda1 <- r(mfv(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na_rm=1))
median1 <- r(median(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))
mean1 <- r(mean(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))
sd1 <- r(sd(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))

 m_efectiva <- sum(complete.cases(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`))
summary(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`) #Resumen general de la variable
```

La variable `PORCENTAJE DE PÉRDIDA TOLERABLE` es *Cuantitativa discreta*, su moda es **`r moda1`%**, su desviación estándar es **`r sd1`%**, su mediana es **`r median1`%** y su promedio es **`r mean1`%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **`r m_efectiva`**.

```{r, include=FALSE}
Q1 <- quantile(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.25, na.rm = TRUE)
Q2 <- quantile(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.50, na.rm = TRUE)
Q3 <- quantile(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.75, na.rm = TRUE) 
Q4 <- quantile(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,1,na.rm = TRUE)
IQR <- IQR(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm = TRUE)
Q1
Q2
Q3
Q4
IQR
```

```{r echo=FALSE, fig.align='center'}
hist(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,xlab="Porcentaje de pérdida tolerable (%)",ylab="Frecuencia",main="Histograma de pérdida tolerable (%)",breaks=nrow(table(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`)), ylim = c(0,20), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`),col="blue",lwd=2) 
abline(v=mean(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`),col="red",lwd=2) 
legend(80,20,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r, echo=FALSE}
boxplot(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, pch=19,horizontal=T,main="Boxplot del % de pérdida tolerable", xlab="Porcentaje (%)")
abline (v=mean(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
max1 <- max(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)-min(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)
iqr1<-IQR(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE PÉRDIDA TOLERABLE` tiene valores atípicos. El rango de la variable es **`r max1`%** y su rango intercuartil es **`r iqr1`%** por lo que la variable está **relativamente concentrada**.


**Sin sus valores atípicos**

La variable `PORCENTAJE DE PÉRDIDA TOLERABLE` es *Cuantitativa discreta*, su moda es **10%**, su desviación estándar es **15.18%**, su mediana es **15%** y su promedio es **19.05%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **71**.

```{r, include=FALSE}
PerdSinAtipicos <- CRP_SI %>% filter(`PORCENTAJE DE PÉRDIDA TOLERABLE` >= (Q1 - 1.5*IQR) & `PORCENTAJE DE PÉRDIDA TOLERABLE` <= (Q3 + 1.5*IQR))
r(mfv(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na_rm=1))
r(median(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))
r(mean(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))
r(sd(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=1))
sum(complete.cases(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`))
summary(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`) #Resumen general de la variable
```

```{r, include=FALSE}
PerdSinAtipicos %>% arrange(desc(`PORCENTAJE DE PÉRDIDA TOLERABLE`))
```

```{r, include=FALSE}
Q11 <- quantile(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.25, na.rm = TRUE)
Q22 <- quantile(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.50, na.rm = TRUE)
Q33 <- quantile(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, 0.75, na.rm = TRUE) 
Q44 <- quantile(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`,1,na.rm = TRUE)
IQR1 <- IQR(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm = TRUE)
Q11
Q22
Q33
Q44
IQR1
```

```{r, echo=FALSE}
hist(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`,xlab="Porcentaje de pérdida tolerable (%)",ylab="Frecuencia",main="Histograma de % de pérdida tolerable",breaks=nrow(table(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`)), ylim = c(0,14), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`),col="blue",lwd=2) 
abline(v=mean(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`),col="red",lwd=2) 
legend(38,14,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r, echo=FALSE}
boxplot(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, horizontal=T,main="Boxplot del % de pérdida tolerable", xlab="Porcentaje (%)")
abline (v=mean(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
max2 <- max(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)-min(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)
iqr2 <- IQR(PerdSinAtipicos$`PORCENTAJE DE PÉRDIDA TOLERABLE`, na.rm=T)
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE PÉRDIDA TOLERABLE` sin sus valores atípicos. El rango de la variable es **50%** y su rango intercuartil es **25%** por lo que la variable está *relativamente dispersa*.


## Variable: **Porcentaje de ingreso destinado a la inversión**

La variable nos muestra cuál es el porcentaje de ingreso de las personas encuestadas que sí invierten en el mercado digital (criptomonedas o acciones).

**Con todos sus valores atípicos**

La variable `PORCENTAJE DE INGRESO DESTINADO A LA INVERSIÓN` es *Cuantitativa discreta*, su moda es **10%**, su desviación estándar es **17.28%**, su mediana es **15%** y su promedio es **21.32%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **73**.

```{r, include=FALSE}
r(mfv(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na_rm=1))
r(median(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
r(mean(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
r(sd(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
sum(complete.cases(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`))
```

```{r, include=FALSE}
Q111 <- quantile(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.25, na.rm = TRUE)
Q222 <- quantile(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.50, na.rm = TRUE)
Q333 <- quantile(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.75, na.rm = TRUE) 
Q444 <- quantile(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,1,na.rm = TRUE)
IQR11 <- IQR(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm = TRUE)
Q111
Q222
Q333
Q444
IQR11
```

```{r, echo=FALSE}
hist(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,xlab="Porcentaje de ingreso destinado a la inversión (%)",ylab="Frecuencia",main="Histograma de ingreso destinado a la inversión (%)", breaks=nrow(table(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`)), ylim = c(0,15), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`),col="blue",lwd=2) 
abline(v=mean(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`),col="red",lwd=2) 
legend(80,15,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r, echo=FALSE}
boxplot(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, horizontal=T,pch=19, main="Boxplot del % de ingreso destinado a la inversión", xlab="Porcentaje (%)")
abline (v=mean(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
rang3 <- max(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)-min(CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)
iqr3 <- IQR(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE INGRESO DESTINADO A LA INVERSIÓN` tiene valores atípicos. El rango de la variable es **98%** y su rango intercuartil es **20%** por lo que la variable está *relativamente concentrada*.


**Sin sus valores atípicos**

La variable `PORCENTAJE DE INGRESO DESTINADO A LA INVERSIÓN` es *Cuantitativa discreta*, su moda es **10%**, su desviación estándar es **14.72%**, su mediana es **15%** y su promedio es **20.24%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **72**.

```{r, include=FALSE}
IngSinAtipicos <- CRP_SI %>% filter(`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` >= (Q111 - 1.5*IQR11) & `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` <= (Q333 + 1.5*IQR11))
r(mfv(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na_rm=1))
r(median(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
r(mean(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
r(sd(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=1))
sum(complete.cases(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`))
summary(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`) #Resumen general de la variable
```

```{r, include=FALSE}
IngSinAtipicos %>% arrange(desc(`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`))
```

```{r, include=FALSE}
Q1111 <- quantile(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.25, na.rm = TRUE)
Q2222 <- quantile(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.50, na.rm = TRUE)
Q3333 <- quantile(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, 0.75, na.rm = TRUE) 
Q4444 <- quantile(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,1,na.rm = TRUE)
IQR111 <- IQR(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm = TRUE)
Q1111
Q2222
Q3333
Q4444
IQR111
max(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)-min(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)
IQR(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T)
```

```{r, echo=FALSE}
hist(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,xlab="Ingreso destinado a la inversión (%)",ylab="Frecuencia",main="Histograma de ingreso destinado a la inversión (%)",breaks=40, ylim = c(0,20), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`),col="blue",lwd=2) 
abline(v=mean(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`),col="red",lwd=2) 
legend(45,20,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r echo=FALSE}
boxplot(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, horizontal=T,main="Boxplot del Ingreso destinado a la inversión (%)", xlab="Porcentaje (%)")
abline (v=mean(IngSinAtipicos$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` sin sus valores atípicos. El rango de la variable es **59%** y su rango intercuartil es **20%** por lo que la variable está *relativamente dispersa*.


## Variable: **Porcentaje de ganancia obtenida**

La variable nos muestra el porcentaje de ganancias obtenidas de las personas encuestadas que invirtieron en criptomonedas. Podemos también ver la relación entre el dinero invertido en criptomonedas y/o acciones respecto a su porcentaje de ganancia que obtuvieron.

**Con todos sus valores atípicos**

La variable `PORCENTAJE DE GANANCIA OBTENIDA` es *Cuantitativa discreta*, su moda es **10%**, su desviación estándar es **28.6%** su mediana es **25%** y su promedio es **34.5%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **73**.

```{r, include=FALSE}
r(mfv(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na_rm=1))
r(median(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
r(mean(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
r(sd(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
sum(complete.cases(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`))
summary(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`) #Resumen general de la variable
```

```{r , include=FALSE}
Q11111 <- quantile(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.25, na.rm = TRUE)
Q22222 <- quantile(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.50, na.rm = TRUE)
Q33333 <- quantile(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.75, na.rm = TRUE) 
Q44444 <- quantile(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,1,na.rm = TRUE)
IQR1111 <- IQR(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm = TRUE)
Q11111
Q22222
Q33333
Q44444
IQR1111
```

Para entender mejor la variable que me dice la ganancia porcentual en base a la inversión de nuestra muestra, utilizamos un gráfico de barras, donde nos menciona la frecuencia con la que, los inversores, obtienen un porcentaje de rentabilidad. El porcentaje que más se repite (moda) se encuentra entre 5% y 10%.

```{r, echo=FALSE}
hist(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,xlab="Ganancia obtenida (%)",ylab="Frecuencia",main="Histograma de ganancia obtenida (%)",breaks=nrow(table(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`)), ylim = c(0,10), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`),col="blue",lwd=2) 
abline(v=mean(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`),col="red",lwd=2) 
legend(75,10,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r, echo=FALSE}
boxplot(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, horizontal=T,main="Boxplot de la ganancia obtenida (%)", xlab="Porcentaje (%)")
abline (v=mean(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE GANANCIA OBTENIDA` no tiene valores atípicos. El rango de la variable es **99%** y su rango intercuartil es **35%** por lo que la variable está relativamente concentrada.

```{r, include=FALSE}
max(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)-min(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)
```

```{r, include=FALSE}
IQR(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)
```



**Sin sus valores atípicos**

La variable `PORCENTAJE DE GANANCIA OBTENIDA` es *Cuantitativa discreta*, su moda es **10%**, su desviación estándar es **27.71%**, su mediana es **25%** y su promedio es **33.59%**, por lo que la variable es **sesgada a la derecha**. El tamaño efectivo de la muestra para esta variable es **72**.

```{r, include=FALSE}
GanSinAtipicos <- CRP_SI %>% filter(`PORCENTAJE DE GANANCIA OBTENIDA` >= (Q11111 - 1.5*IQR1111) & `PORCENTAJE DE GANANCIA OBTENIDA` <= (Q33333 + 1.5*IQR1111))
r(mfv(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na_rm=1))
r(median(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
r(mean(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
r(sd(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=1))
sum(complete.cases(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`))
summary(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`) #Resumen general de la variable
```

```{r, include=FALSE}
GanSinAtipicos %>% arrange(desc(`PORCENTAJE DE GANANCIA OBTENIDA`))
```

```{r, include=FALSE}
Q111111 <- quantile(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.25, na.rm = TRUE)
Q222222 <- quantile(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.50, na.rm = TRUE)
Q333333 <- quantile(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, 0.75, na.rm = TRUE) 
Q444444 <- quantile(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`,1,na.rm = TRUE)
IQR11111 <- IQR(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm = TRUE)
Q111111
Q222222
Q333333
Q444444
IQR11111
```

```{r, echo=FALSE}
hist(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`,xlab="Porcentaje de ganancia obtenida (%)",ylab="Frecuencia",main="Histograma de ganancia obtenida (%)",breaks=nrow(table(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`)), ylim = c(0,10), col="lightgray")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
abline(v=median(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`),col="blue",lwd=2) 
abline(v=mean(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`),col="red",lwd=2)
legend(75,10,legend=c("Mediana","Media"),lwd=2,col=c("blue","red")) 
```

```{r, echo=FALSE}
boxplot(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, horizontal=T,main="Boxplot de la ganancia obtenida (%)", xlab="Porcentaje (%)")
abline (v=mean(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T), col= "red")
legend(x = "topright",
       legend = "media",
       fill = "red",
       title = "Leyenda")
grid(nx = NULL, ny = NA, lty = 2, col = "gray", lwd = 1)
```

Considerando el boxplot, el rango y el rango intercuartil podemos afirmar que: La variable `PORCENTAJE DE GANANCIA OBTENIDA` sin sus valores atípicos. El rango de la variable es **99%** y su rango intercuartil es **36.25%** por lo que la variable está relativamente dispersa.

```{r, include=FALSE}
max(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)-min(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)
```

```{r, include=FALSE}
IQR(GanSinAtipicos$`PORCENTAJE DE GANANCIA OBTENIDA`, na.rm=T)
```


## Coeficientes de variación de las variables cuantitativas discretas

El uso apropiado del promedio como descriptor de posición depende del coeficiente de variación. Se ordenarán las variables numéricas **de mayor a menor** de acuerdo a qué tan apropiado es usar su promedio como descriptor de posición.

```{r, include=FALSE}
cof_var_perdida <- r(sd(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,na.rm = T)/mean(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,na.rm = T))
cof_var_ganancia <- r(sd(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,na.rm = T)/mean(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,na.rm = T))
cof_var_p_ingreso <- r(sd(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,na.rm = T)/mean(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,na.rm = T))
```

|                                                 | Coeficiente de variación |
|-------------------------------------------------|--------------------------|
| `PORCENTAJE DE PÉRDIDA TOLERABLE`               | `r cof_var_perdida`      |
| `PORCENTAJE DE GANANCIA OBTENIDA`               | `r cof_var_ganancia`     |
| `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` | `r cof_var_p_ingreso`    |

Graficamos la variable `PORCENTAJE DE PÉRDIDA TOLERABLE` en función de `PORCENTAJE DE GANANCIA OBTENIDA`. Al graficar la variable `PORCENTAJE DE GANANCIA OBTENIDA` contra la variable `PORCENTAJE DE PÉRDIDA TOLERABLE` se puede apreciar que cuando `PORCENTAJE DE GANANCIA OBTENIDA` crece, el `PORCENTAJE DE PÉRDIDA TOLERABLE` en general crece. Esto se corrobora calculando la correlación entre ambas variables, que da **0.06**. El tamaño efectivo de la muestra para el cálculo de la correlación es **73**.

```{r, echo=FALSE}
smoothScatter(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,pch=19, main="Perdida tolerable (%) ~ Ganancia obtenida (%)", xlab="Ganancia obtenida (%)", ylab="Perdida tolerable (%)")
abline(lm(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE` ~ CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`), col="red", lwd=2)
legend("topright",bty="n",legend = c("Línea de Tendencia"), col="red", lwd=2)
text(90,70, paste("Correlación:", r(cor(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,use="complete.obs"))))
m_efectiva_inv <- sum(!(is.na(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`)|is.na(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`)))
grid(nx = NULL, ny = NA, lty = 2, col = "lightgray", lwd = 1)
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

Graficamos la variable `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` en función de `PORCENTAJE DE GANANCIA OBTENIDA`. Al graficar la variable `PORCENTAJE DE GANANCIA OBTENIDA` contra la variable `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` se puede apreciar que cuando `PORCENTAJE DE GANANCIA OBTENIDA` crece, el `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` en general crece. Esto se corrobora calculando la correlación entre ambas variables, que da **0.35**. El tamaño efectivo de la muestra para el cálculo de la correlación es **73**.

```{r, echo=FALSE}
smoothScatter(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`, pch=19,, main="Ingreso destinado a inversión (%) ~ Ganancia obtenida (%) ", xlab="Ganancia obtenida (%)", ylab="Ingreso destinado a invertir (%)")

abline(lm(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` ~ CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`), col="red", lwd=2)

legend("topright",bty="n",legend = c("Línea de Tendencia"), col="red", lwd=2)
text(85,70, paste("Correlación:", r(cor(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA`,use="complete.obs"))))

grid(nx = NULL, ny = NA, lty = 2, col = "lightgray", lwd = 1)
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

Graficamos la variable `PORCENTAJE DE PÉRDIDA TOLERABLE` en función de `PORCENTAJE DE INGRESO DESTINADO A LA INVERSIÓN`. Al graficar la variable `PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` contra la variable `PORCENTAJE DE PÉRDIDA TOLERABLE` se puede apreciar que la correlación entre ambas variables nos resulta **0**. Es decir, significa una ausencia de relación entre ambas variables. El tamaño efectivo de la muestra para el cálculo de la correlación es **73**.

```{r echo=FALSE}
smoothScatter(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`, pch=19, main="Ingreso destinado a inversión (%) ~ Perdida tolerable (%)", xlab="Ingreso a invertir (%)", ylab="Perdida tolerable (%)")
abline(lm(CRP$`PORCENTAJE DE PÉRDIDA TOLERABLE` ~ CRP$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`), col="red", lwd=2)
legend("topright",bty="n",legend = c("Línea de Tendencia"), col="red", lwd=2)
text(85,70, paste("Correlación:", r(cor(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`,CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,use="complete.obs"))))
#sum(!(is.na(CRP_SI$`PORCENTAJE DE PÉRDIDA TOLERABLE`)|is.na(CRP_SI$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`)))
grid(nx = NULL, ny = NA, lty = 2, col = "lightgray", lwd = 1)
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

## Variable: **Género**

```{r, include=FALSE}
unique(CRP$GÉNERO)
```

```{r, echo=FALSE}
barplot(table(CRP_SI$GÉNERO), main="Género de los encuestados", ylab="Nro. de encuestados",col=c("pink","sky blue","gray"),ylim=c(0,60), las=1, font.axis=4, legend.text=c("Femenino","Masculino","Prefiero no decirlo"))
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

```{r, echo=FALSE}
boxplot(CRP_SI$`PORCENTAJE DE GANANCIA OBTENIDA` ~ CRP_SI$GÉNERO,pch=19, main="Porcentaje de ganancia obtenida según su género", xlab="Género", ylab="Porcentaje (%)")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 1)
```

## Variable: **Medio de aprendizaje de cryptos**

Consideramos, que en este gráfico se puede entender mucho mejor el medio por el cual se aprendió más sobre la inversión por parte de nuestras unidades muestrales. Si observamos, el valor que más se repite (moda) es el de `Autodidacta`\`, infiriendo así que nuestros inversores aprendieron más por este medio.

```{r, echo=FALSE}
barplot(sort(table(CRP$`MEDIO DE APRENDIZAJE DE CRYPTOS`),decreasing=T), main = "Medio de aprendizaje de cryptos", xlab = "Nro. de encuestados", ylim=c(0,45), las=1, col=c("#EDAE0F","#FAC025","#F6CE55","#F9DC86"))
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
legend(3,38,legend=c("Autodidacta","Intermediario","Cursos","Pr. y Err."),lwd=12,col=c("#EDAE0F","#FAC025","#F6CE55","#F9DC86")) 
```

Con este gráfico de barras, observamos la cantidad de personas que aprendió sobre criptomonedas por diferentes medios Si observamos, la mayor parte de las personas aprendió de forma autodidacta a invertir.

```{r, echo=FALSE}
boxplot(`PORCENTAJE DE PÉRDIDA TOLERABLE` ~ `MEDIO DE APRENDIZAJE DE CRYPTOS`, data = CRP_SI, pch=19, main="Pérdida tolerable (%) ~ Medio de aprendizaje", xlab="Medio aprendido",ylab="Perdida (%)")
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```
Este gráfico, nos permite analizar la concentración de cada boxplot, asimismo su la mediana.

Analizando el primer boxplot, se puede decir que el 50% de las personas que aprendieron de manera **AUTODIDACTA**, tienen un porcentaje de tolerancia mayor a los demás estudiantes que tienen diferente medio de aprendizaje. Asimismo, existe una dispersión relativa entre los resultados. Este resultado se entiende, porque al tener más conocimiento toleras más porcentaje de perdida. En el último boxplot, tenemos unos resultados más concentrados, y el 50% de las personas que aprenden con el método **PRUEBA Y ERROR**, tienden a arriesgarse menos.


## Variable: **Volatilidad**

```{r, echo=FALSE}
barplot(sort(table(CRP_SI$`¿CUÁL ES MÁS VOLÁTIL?`),decreasing = T), main="Volatilidad según los encuestados", ylab="Nro. de encuestados", xlab="¿Cuál es más volatil?",col=c("#EDAE0F","#F6CE55","#F9DC86"),ylim=c(0,50), las=1, font.axis=4)
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)

```

## Variable: **Tipo de Criptomoneda**

En cuanto a las criptomonedas en las que han invertido nuestra muestra, decidimos mostrar las 4 en las que más se invierte, dando por resultado el gráfico que se observa. Como se observa, la cripto "preferida" por los inversores es la del Bitcoin.

```{r,include=FALSE}
filter(CRP_SI, `TIPO DE CRYPTOS`=="Bitcoin")
filter(CRP_SI, `TIPO DE CRYPTOS`=="Ethereum")
filter(CRP_SI, `TIPO DE CRYPTOS`=="DodgeCoin")
filter(CRP_SI, `TIPO DE CRYPTOS`=="Litecoin")
```

```{r,echo=FALSE}
TIPO_CRYPTOS <- filter(CRP_SI, `TIPO DE CRYPTOS` %in% c("Bitcoin","Ethereum","DodgeCoin", "Litecoin"))
barplot(sort(table(TIPO_CRYPTOS$`TIPO DE CRYPTOS`),decreasing = T), main="Principales criptomonedas invertidas", xlab="Nro. de encuestados", ylab="Criptomonedas preferidas",ylim=c(0,35), las=1, font.axis=4, col=c("#EDAE0F","#FAC025","#F6CE55","#F9DC86"))
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
legend(25,3.5,legend=c("Bitcoin","Etherium","Dogecoin","AgeCoin¿?"),lwd=12,col=c("#EDAE0F","#FAC025","#F6CE55","#F9DC86"))
```

## Variable: **¿Invierte en acciones o criptomonedas?**

```{r, echo=FALSE}
barplot(sort(table(CRP$`DINERO INVERTIDO EN ACCIONES O CRYPTOS`), decreasing = T), main="Inversión de los encuestados", xlab="N° de Alumnos", ylim=c(0,140), col=c("#F9DC86","#FAC025"), las=1)

grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

## Variable: **¿Cuánto conocimiento crees que tienes acerca del tema en cuestión?**

```{r,include=FALSE}
Conocimiento <- table(CRP_SI$`CONOCIMIENTO DEL TEMA DEL 1 AL 5`)
Conocimiento
```

```{r,echo=FALSE}
barplot(sort(Conocimiento, decreasing = F), horiz=T ,main="Gráfico de barras", ylab="Frecuencia",xlab= "Conocimiento en Cryptos de los encuestados ", names.arg = c("1", "2", "3","4","5"), xlim = c(0,35),las=1, font.axis=4, col=c("#FCF5CF","#F9DC86","#F6CE55","#FAC025","#EDAE0F"))
grid(nx = NULL, ny = NA, lty = 2, col = "lightgray", lwd = 1)
legend(25,3,legend=c("Mucho","Normal","Medio","Poco","Nada"),lwd=12,col=c("#EDAE0F","#FAC025","#F6CE55","#F9DC86","#FCF5CF"))

```

## Variable: **¿Invertirías tu dinero a futuro?**

```{r,include=FALSE}
CRP_NO <- CRP %>% filter(`DINERO INVERTIDO EN ACCIONES O CRYPTOS`=="No")

```

```{r,echo=FALSE}
barplot(sort(table(CRP_NO$`¿INVERTIRÍAS TU DINERO A FUTURO?`), decreasing = T), main="Inversión a futuro", xlab="N° de Alumnos", ylim=c(0,120), col=c("#FAC025","#F9DC86"), las=1)
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

```{r,include=FALSE}
CRP_SI_IND<- CRP_SI %>% filter(CARRERA=="Ingeniería Industrial") #%>% count(CARRERA)
CRP_SI_IND
```

```{r,include=FALSE}
edades_ind <- unique(CRP_SI_IND$EDAD)
edades_ind
```

```{r,include=FALSE}
length(edades_ind)
```

```{r, include=FALSE}
r(table(CRP_SI_IND$GÉNERO)/nrow(CRP_SI_IND)*100)
```

```{r, include=FALSE}
(r(table(CRP_SI_IND$GÉNERO)/nrow(CRP_SI_IND)*100))[names(table(CRP_SI_IND$GÉNERO))=="Masculino"]
(r(table(CRP_SI_IND$GÉNERO)/nrow(CRP_SI_IND)*100))[names(table(CRP_SI_IND$GÉNERO))=="Femenino"]
```

```{r, include=FALSE}
r(table(CRP_SI_IND$`MEDIO DE APRENDIZAJE DE CRYPTOS`,CRP_SI_IND$GÉNERO)/rowSums(table(CRP_SI_IND$`MEDIO DE APRENDIZAJE DE CRYPTOS`,CRP_SI_IND$GÉNERO))*100)
```

## Variable: Tiempo invertido al mes en horas

Como máximo 6 horas al día, 42 horas a la semana y 168 horas al mes, por conveniencia, asumimos que **170** horas es el que representa el tiempo máximo de horas invertidas al mes.

```{r, echo=FALSE}
boxplot(CRP_SI$`TIEMPO INVERTIDO AL MES EN HORAS`,na.rm=T, main="Boxplot del tiempo invertido al mes", ylab="Tiempo invertido al mes (horas)", ylim=c(0,200))
grid(nx = NA, ny = NULL, lty = 2, col = "lightgray", lwd = 1)
```

# **Patrones**

```{r, include=FALSE}
BTC <- filter(CRP_SI, `TIPO DE CRYPTOS`=="Bitcoin")
ETH <- filter(CRP_SI, `TIPO DE CRYPTOS`=="Ethereum")
DOGE <- filter(CRP_SI, `TIPO DE CRYPTOS`=="DodgeCoin")
LTC <- filter(CRP_SI, `TIPO DE CRYPTOS`=="Litecoin")
BTC
ETH
DOGE
LTC

Bitcoins <-BTC %>% mutate(Cantidad_bitcoin=`DINERO INVERTIDO EN CRYPTOS`*0.000048)
Bitcoins
Ethereum <- ETH %>% mutate(Cantidad_ethereum=`DINERO INVERTIDO EN CRYPTOS`*0.00088)
Ethereum
DodgeCoin <- DOGE %>% mutate(Cantidad_DodgeCoin=`DINERO INVERTIDO EN CRYPTOS`*15.45)
DodgeCoin
Litecoin <- LTC %>% mutate(Cantidad_Litecoin=`DINERO INVERTIDO EN CRYPTOS`*0.018)
Litecoin
```


## Patrón 1

Tamaño efectivo de la muestra para el cálculo de la correlación:

```{r,echo=FALSE}
sum(!(is.na(Bitcoins$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`)|is.na(Bitcoins$Cantidad_bitcoin))) #Tamaño efectivo de la muestra para el cálculo de la correlación.
```


```{r,echo=FALSE}
plot(Bitcoins$Cantidad_bitcoin, Bitcoins$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,pch=19,main="Diagrama de dispersión",xlab="Cantidad de Bitcoin (BTC)",ylab = "Ingreso destinado a invertir (%)",xlim=c(0,0.4), ylim=c(0,100))

abline(lm(Bitcoins$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN` ~ Bitcoins$Cantidad_bitcoin),col="red", lwd=2)

text(0.3,90, paste("Correlación:", r(cor(Bitcoins$`PORCENTAJE DE INGRESO DEDICADO A LA INVERSIÓN`,Bitcoins$Cantidad_bitcoin,use="complete.obs"))))
```


Podemos apreciar un patrón en el siguiente gráfico de dispersión entre el *Porcentaje de ingreso destinado a la inversión* y la *Cantidad de Bitcoins* que tendrían las personas que optaron por dicho tipo de criptomoneda.
En su mayoría, los encuestados optan por destinar su ingreso en un rango de $\text{<0% - 40%>}$, permitiéndoles generar menos de $\text{0.1 BTC}$. No obstante, se presenta el caso de que un encuestado invirtió aproximadamente el 60% de su ingreso y por lo tanto posee en su billetera digital de Bitcoins cerca de $\text{0.36 BTC}$. Por ello, podemos determinar la correlación entre estas dos variables, que nos resulta $0.59$. Es importante mencionar que el tamaño efectivo de la muestra para el cálculo de la correlación fue de $34$. Es decir, 34 de nuestros encuestados invierten en Bitcoin.

## Patrón 2

Tamaño efectivo de la muestra para el cálculo de la correlación:

```{r, echo=FALSE}
sum(!(is.na(CRP_SI$`DINERO INVERTIDO EN ACCIONES`)|is.na(CRP_SI$`DINERO INVERTIDO EN CRYPTOS`))) #Tamaño efectivo de la muestra para el cálculo de la correlación.
```

```{r, echo=FALSE}
plot(CRP_SI$`DINERO INVERTIDO EN CRYPTOS`,CRP_SI$`DINERO INVERTIDO EN ACCIONES`,pch=19,main="Diagrama de dispersión",xlab="Dinero invertido en Cryptos ($)",ylab = "Dinero invertido en Acciones ($)", xlim=c(0,15000),ylim=c(0,15000))

abline(lm(CRP_SI$`DINERO INVERTIDO EN ACCIONES`~CRP_SI$`DINERO INVERTIDO EN CRYPTOS`),col="red")

text(12000,5000, paste("Correlación:", r(cor(CRP_SI$`DINERO INVERTIDO EN ACCIONES`,CRP_SI$`DINERO INVERTIDO EN CRYPTOS`,use="complete.obs"))))
```

Podemos observar un patrón en el siguiente gráfico de dispersión entre las variables: *Dinero invertido en acciones* y *Dinero invertido en criptomonedas*. Variables que nos permiten saber cuánto dinero (dólares) han llegado a invertir nuestros encuestados que sí están dentro del mercado digital que ofrecen las acciones de diversas empresas y las criptomonedas.
Es curioso el patrón que podemos apreciar, ya que se comporta casi de manera simétrica. Algunos invierten "poco" en criptomonedas pero a su vez invierten "un poco más" en acciones. Y viceversa, algunos invierten "poco" en acciones y "un poco" más en criptomonedas. Sin embargo, se nos presenta un dato en que un encuestado invirtió más de *$ 1200* tanto en acciones como en criptomonedas.
Finalmente, se halló la correlación entre estas dos variables, que nos resulta $0.46$. Es importante mencionar que el tamaño efectivo de la muestra para el cálculo de la correlación fue de $73$. Es decir, 73 de nuestros encuestados sí invierten en Criptomonedas y Acciones.

## Patrón 3

Tamaño efectivo de la muestra para el cálculo de la correlación:
```{r, echo=FALSE}
sum(!(is.na(Bitcoins$`TIEMPO INVERTIDO AL MES EN HORAS`)|is.na(Bitcoins$`PORCENTAJE DE GANANCIA OBTENIDA`))) #Tamaño efectivo de la muestra para el cálculo de la correlación.
```


```{r, echo=FALSE}
plot(Bitcoins$`PORCENTAJE DE GANANCIA OBTENIDA`,Bitcoins$`TIEMPO INVERTIDO AL MES EN HORAS`,pch=19,main="Diagrama de dispersión",xlab="Porcentaje de Ganancia (%)",ylab = "Tiempo invertido al mes (h)", xlim=c(0,100),ylim=c(0,200))

abline(lm(Bitcoins$`TIEMPO INVERTIDO AL MES EN HORAS`~Bitcoins$`PORCENTAJE DE GANANCIA OBTENIDA`),col="red")

text(90,50, paste("Correlación:", r(cor(Bitcoins$`TIEMPO INVERTIDO AL MES EN HORAS`,Bitcoins$`PORCENTAJE DE GANANCIA OBTENIDA`,use="complete.obs"))))

```

Podemos apreciar otro patrón en el siguiente gráfico de dispersión entre el *Porcentaje de ganancia obtenida de la inversión* y el *Tiempo invertido al mes (horas)* de los encuestados que invierten en Bitcoin. Los puntos de dispersión presentan una tendencia creciente, de modo que si un alumno ocupó una gran cantidad de su tiempo (horas) al mes en invertir en Bitcoin, resultó que obtuvo un porcentaje alto de ganancias. Por ejemplo, si mensualmente dedicó unas $\text{170 horas y 136 horas}$, obtendrá un $\text{75%}$ y $\text{100%}$, respectivamente. Por ello, podemos determinar la correlación entre estas dos variables, que nos resulta $0.43$. Es importante mencionar que el tamaño efectivo de la muestra para el cálculo de la correlación fue de $34$. Es decir, 34 de nuestros encuestados invierten en Bitcoin.

# **Modelos probabilísticos**

## Modelo 1: **Distribución Binomial**

**Variable Aleatoria**: X=Número de hombres que sí han invertido.

**éxito**: Hombre que invierta en criptomonedas.

**fracaso**: Hombre que no invierta en criptomonedas.

**número de ensayos**: 203

Si la probabilidad de que un hombre invierta es $p=\frac{57}{203}$. Se selecciona una muestra de 203 alumnos.

$$X\sim Bin(203, \frac{57}{203})$$
```{r,include=FALSE}
prob_e_h <- 57/203
prob_e_h
prob_e_m <- 14/203
prob_e_m
v_esperado <- 203*prob_e_h
```

Valor esperado: **`r v_esperado`**
 
Varianza: **`r round((203*prob_e_h*(1-prob_e_h)),2)`**

```{r,echo=FALSE}
plot(dbinom(c(0:203),203,prob_e_h),xlab="Nro. de ensayos",ylab = "P(X=x)",main="Función de probabilidad binomial")
#abline(v=58,col="red")
abline(v=203*prob_e_h,col="blue")
#dbinom(85,203,prob_e_h)
```



```{r, echo=FALSE}

plot(dbinom(c(0:203), 203, prob_e_m), type = "h", lwd = 1.5,
     main = "Función de probabilidad binomial",
     ylab = "P(X = x)", xlab = "Número de éxitos", ylim = c(0,0.12))
lines(dbinom(c(0:203), size = 203, prob_e_h), type = "h",
      lwd = 2, col = "blue")
lines(dbinom(c(0:203), size = 203, prob_e_m), type = "h",
      lwd = 2, col = "red")
legend("topright", legend = c("203  57/203", "203  14/203"),
       title = "n           p", title.adj = 0.85,
       lty = 1, col = c("blue","red"), lwd = 2, box.lty = 1)

```
## Modelo 2: **Distribución Geométrica**

Su función de probabilidad está dada por: 
$$P(X=x)=(1-p)^{x-1}×p$$
$x=(1,2,3,...,n)$

Notación: $$x \sim \mathsf{Geom(\frac{34}{203})}$$
x: Ensayos hasta conseguir el **primer Éxito**.\
p: Probabilidad de Éxito.

Se sabe que la probabilidad de que un encuestado haya invertido en Bitcoin es $p=\frac{34}{203}$. Calcule la probabilidad de que el vigésimo encuestado sea el quinto en haber invertido en Bitcoin.

$$y \sim \mathsf{Geom(\frac{34}{203})}$$
El $p=\frac{34}{203}$ de la población encuestada pertenecen al grupo de personas que invirtieron en Bitcoin. Supongamos que se realiza un estudio estadístico en un día arbitrario y se quiere determinar la probabilidad de que el décimo sujeto haya invertido en Bitcoin.

```{r,include=FALSE}
p <- 34/203
x <- c(1:9)
dgeom(x,p)
```

Valor esperado: **`r round(1/p,2)`**

Varianza: **`r round((1-p)/(p^2),2)`**

```{r,echo=FALSE}
barplot(dgeom(x,p),ylab = "Probabilidad",ylim = c(0,0.18), names.arg=c(1:9), col = "lightgray")
```

## Modelo 3: **Distribución Hipergeométrica**

Su función está dada por:

$$P(X=x)=\frac{\binom{r}{x}\binom{N-r}{n-x}}{\binom{N}{x}}$$ $x=(0,1,2,3,...,n)$

Notación: $$x\sim Hiperg(N,r,n)$$ 
- x: Número de éxitos de la muestra.\
- N: Tamaño de la población.(73)\
- n: Tamaño de la muestra o número de ensayos que vamos a seleccionar.(15)\
- r: Número de casos exitosos en la población.(11)\
- N-r: Número de fracaso.(73-11=62)\



El total de encuestados que respondieron que sí invierten en acciones o criptomonedas son de 73 y de ellos 62 no son de la carrera de Industrial. Se selecciona una muestra de 15 encuestados al azar sin reemplazo de las 73 personas para un estudio inmediato de la Facultad de Industrial.

$$x\sim Hiperg(73,11,15)$$
Calcular la probabilidad de encontrar **hasta 3** encuestados de industrial.

$P(X≤3)$

```{r}
N <- 73 #Tamaño de la Población
r_ <- 11 #Número de casos exitosos en la población
nr <- 62 #Número de fracasos en la población
n <- 15 #Tamaño de la muestra
x <- c(0:3)
dhyper(x,r_,nr,n)
```


```{r, include=FALSE}
v_esperado2 <- round((15*11)/73,2)
vrz <- round(15*choose(11,73)*choose(62,73)*choose(73-15,73-1),2)
```

Valor esperado: **`r round(v_esperado2,2)`**

Varianza: **`r round(vrz,2)`**

```{r,echo=FALSE}
barplot(dhyper(x,r_,nr,n),ylab = "Probabilidad",col="lightgray",ylim = c(0,0.4), names.arg=c(0:3))
```




