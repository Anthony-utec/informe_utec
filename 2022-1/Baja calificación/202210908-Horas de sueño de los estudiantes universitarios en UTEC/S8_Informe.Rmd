---
title: "P2. Entrega"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: paper
---
  <style type="text/css">
   body{
    font-family: "Helvetica", sans-serif;
    font-size: 11px;
   }
   strong {
    color: #00022e;
   }
   h1, h2 {
    color: #00022e;
   }
  </style>

<center>

![UTEC - Universidad de Ingeniería y Tecnología](https://proyectos.utec.edu.pe/themes/custom/utec/logo.png)

**Estadística y Probabilidades I**

**Principales agentes que predominan entre la relación del sueño sobre el rendimiento académico en los estudiantes de UTEC en el año 2022**

</center>


# Proyecto

+ **Tema:** 

La relación entre el sueño y el rendimiento académico.

+ **Titulo de Proyecto:** 

Principales agentes que predominan entre la relación del sueño sobre el rendimiento académico de los estudiantes de la Universidad de Ingeniería y Tecnología en el año 2022.

# Introducción

## Relevancia
  
  Dormir correctamente produce beneficios importantes para nuestro cuerpo y mente debido a que refuerza nuestro sistema inmunológico, es decir, nos ayuda a mantenernos saludables, además, fortalece la memoria y evite que estemos cansados, pero, ¿Qué sucede si no dormimos bien?, pues, la falta de sueño o las pocas horas que duerme una persona produce problemas de salud tanto físico como mental; una de las consecuencias es ser propenso a sufrir enfermedades crónicas como hipertensión, obesidad y diabetes ya que dormir poco o no dormir hace que el apetito aumente provocando una mala dieta y en algunos casos, la resistencia a la insulina. También, la falta de sueño está ligada a la depresión, ansiedad y trastornos psicológicos. 
  
  Si hablamos de una persona que se encuentra estudiando, puede provocar, además, menor rendimiento físico y una capacidad cognitiva limitada (Cramer, 2016). Como vemos, se hace mención de las consecuencias, pero, ¿Qué provoca que un estudiante duerma de una manera inadecuada? Para responder esta pregunta, se han realizado diversos estudios en relación al sueño y el rendimiento académico en distintas partes del mundo,  como mencionan (BaHammam, Alaseem, Alzakri, Almeneessier, & Sharif, 2012) *la falta de sueño llega a relacionarse negativamente con el rendimiento academico*, de la misma manera,  (Wong *et al.,* 2003) indica en su investigación que entre mayor sea la duración del sueño entre semana, este produce un mejor rendimiento académico en estudiantes. Es decir, tanto la duración como la calidad del sueño muestran relación en la eficiencia académica (Machado-Duque, Enrique, & Machado-Alba, 2015
  
  Por lo tanto, el presente proyecto se enfoca en encontrar y determinar la relación entre agentes que predominan en el sueño sobre el rendimiento académico en estudiantes universitarios de la Universidad UTEC, debido a que sabemos como estudiantes que muchas de nuestras actividades diarias se encuentran enfocadas en los estudios académicos que provocan una mayor demanda de tiempo y posiblemente cambiar radicalmente su estilo de vida y en muchos casos, de una forma negativa, descuidando nuestra salud física y mental, dentro de ello, el sueño, por consecuente, nos planteamos el siguiente problema:

¿Cuales son los principales agentes que predominan entre la relación del sueño sobre el rendimiento académico de los estudiantes de la Universidad de Ingeniería y Tecnología en el año 2022?

Finalmente, nuestros objetivos presentes:
1. Describir como presentar problemas para dormir influye sobre el prestar atención en las clases académicas.
2. Conocer la relación entre las horas que le toma a un alumno conciliar el sueño y su promedio ponderado
3. Identificar la relación entre las variables numéricas Ciclo del estudiante (Ciclo) y su duración del sueño (Duración)

# Datos

## Recolección de datos

Primeramente, para poder obtener los datos de nuestro proyecto, realizamos una encuesta on-line poder obtener los datos sobre los principales agentes que predominan en la relación del sueño y el rendimiento académico, a través de la herramienta Google Form, de esta manera, nos ayudaría para poder recolectar las respuestas a las trece incógnitas que solicitábamos a los estudiantes que completarían la encuesta, ademas, Google Form cuenta con una opción de poder generar una hoja de calculo con todas las respuestas recolectadas, uso que nos resulto muy útil a la hora de generar nuestra base de datos en formato csv, por lo que consideramos la mejor opción para implementar nuestra encuesta. Ademas, optamos por este tipo de encuesta ya que logramos obtener respuestas de distintos estudiantes de la universidad,  .
Segundo, quienes tenían a su disposición la encuesta solo debían cumplir los siguientes requisitos: 
   
   + No encontrarse tomando medicamentos para dormir.
   + Encontrarse matriculado en el ciclo académico 2022-1
   + Ser estudiante del segundo ciclo en adelante.
   + Ser mayor de edad.

Por ultimo, las estrategias que consideramos para poder llegar a la población fueron compartir el link del formulario en diferentes grupos de chats ya sea de un curso o de una organización estudiantil con el respectivo permiso del administrador, las aplicaciones donde se logro compartir nuestra encuesta fueron Telegram y WhatsApp. También, consideramos importante poder ofrecer nuestra ayuda a los distintos grupos que se encontraban realizando su encuesta, así ellos también nos ayudarían, de esa manera, pudimos lograr que nuestro formulario llegase a mas estudiantes.

## Población, muestra y muestreo

+ **Población:**

Estudiantes de la Universidad de Ingeniería y Tecnología que actualmente se encuentren cursando el semestre 2022-1.

+ **Unidad Muestral:** 

La muestra que empleamos fue aleatoria con 212 estudiantes de la Universidad de Ingeniería y Tecnología ubicada en la sede de Barranco, Lima - Perú. Los 212 estudiantes ademas de ser mayores de edad, pertenecen a una de las 12 carreras profesionales que ofrece UTEC y se encuentran entre el 2do y 10mo ciclo de dicha carrera.

+ **Tipo de Muestreo:** 

Tenemos el tipo de Muestreo aleatorio simple, debido a que, la recolección de datos de los estudiantes de UTEC fue aleatoria.

## Variables

Las variables de nuestra base de datos son:

- **Edad**: Edad del estudiante encuestado. 
- **Genero**: Sexo (Hombre o Mujer) 
- **Carrera**: Carrera de pre-grado en la que se encuentra estudiando 
- **Ciclo**: Ciclo de dicha carrera.
- **Durmiendo**: Horas del sueño al día.
- **Calidad**: Calidad del sueño (Muy buena, Buena, Mala, Demasiado Mala)
- **Conciliar**:  Tiempo en conciliar el sueño (en horas)
- **Problemas**: ¿Tienes problemas para poder ir a dormir? (Si, No, A veces)
- **Cansancio**: ¿Te despiertas cansado por las mañanas? (Si, No)
- **Somnolencia**: ¿Presentas sueño durante el día? (Si, No, A veces)
- **Promedio**: Promedio ponderado en el ciclo anterior (Menor a 11, Entre 11 y 15, Mayor a 15)
- **Atencion**: ¿Consideras que le prestas atención a las clases? (Nunca, Algunas veces, Muchas veces, Casi siempre)
- **Dificultad**: ¿Tienes dificultades para realizar las actividades estudiantiles? (Nunca, Algunas veces, Muchas veces, Casi siempre)

A continuación, nuestra tabla con las variables identificadas segun su tipo, escala y restricciones: 
   
|**Variables**|**Tipo de variable**|**Escala**|**Restricciones**|  
|-|-|-|-|  
|Edad|Variable numérica Discreta|Escala de Razón|Mayor o igual a 18 años|  
|Genero|Variable categórica Nominal|Escala Nominal|Mujer o Hombre|  
|Carrera|Variable categórica Nominal|Escala Nominal|1 de las 12 carreras|  
|Ciclo|Variable numérica Discreta|Escala de Intervalo|Entre 2do y 10mo ciclo|  
|Duracion|Variable numérica Discreta|Escala de Razón|En horas|  
|Calidad|Variable categórica ordinal|Escala Ordinal|Elegir una opción|  
|Conciliar|Variable numérica Discreta|Escala de Razón|En horas|      
|Problemas|Variable categórica nominal|Escala Nominal|Elegir una opción|  
|Cansancio|Variable categórica nominal|Escala Nominal|Elegir una opción|      
|Somnolencia|Variable categórica nominal|Escala nominal|Elegir una opción|  
|Promedio|Variable categórica Ordinal|Escala Ordinal|Elegir una opción|  
|Atención|Variable categórica ordinal|Escala Ordinal|Elegir una opción|  
|Dificultad|Variable categórica ordinal|Escala Ordinal|Elegir una opción| 
   
## Limpieza de base de datos

Antes de realizar nuestra limpieza de base de datos, instalaremos las librerías que vamos a utilizar para que sea posible poder garantizar una correcta ejecución de nuestra base da datos:


Luego, cargamos las librerías:

```{r}
library (readr)
library (dplyr)
library (stringi)
library (corrplot)
library (PerformanceAnalytics)
library (ggplot2)
library (ggthemes)
library (tidyverse)
library (Hmisc)
library (gmodels)
library (gt)
library (modeest)
library (GGally)
library (readxl)
library (flextable)
library (moments) 
library (janitor)
library (rcompanion)
library(glue)
library (knitr)
```

Ahora, podemos cargar nuestra base de datos a través de un data frame inicial que lo nombraremos como *'DD'*, ademas, como solo deseamos contar con las variables relevantes y útiles, eliminaremos la 

```{r}
DD <- read_csv("S8BaseDatos.csv")
```

Utilizamos el comando *names* en nuestro data frame para poder observar los nombres de las columnas:

```{r}
names(DD)
```

Decidimos renombrar el nombre de las variables para un mejor manejo de estos en los próximos pasos:

```{r}
colnames(DD)[3:14]<-c("Genero", "Carrera", "Ciclo", "Duracion", "Calidad", "Conciliar", "Problemas", "Cansancio", "Somnolencia", "Promedio", "Atencion", "Dificultad")
```   

Teniendo nuestro data frame *'DD'* actualizado, procederemos a realizar la limpieza de datos pertinente:

+ Primero, verificamos que no existen NA's en DD:

```{r}
sum(is.na(DD)) #is.na() -> este comando detecta los datos incompletos; sum -> sumar
```

Hemos obtenido 0 datos incompletos debido a que en nuestra encuesta solicitábamos que cada pregunta sea contestada obligatoriamente, así que no será necesario una limpieza de NA.

También, si observamos nuestro data frame, podemos ver en la primera columna, una variable llamada **"Marca temporal"**, esta ha sido creada predeterminadamente por Google Form, pero como no vamos a utilizarla y no nos proporciona información relevante, la eliminaremos.

Entonces, creamos un data frame final llamado *'DF'* donde estarán solo las variables útiles, es decir, desde la variable *Edad* hasta *Dificultad* con el comando *select*:

```{r}
DF <- select(DD,Edad:Dificultad)
```

Finalmente, hemos podido considerar que el data frame *'DF'* se encuentra limpia ya que no presenta ningún valor perdido y tiene las variables adecuadas que nos garantiza una mejor utilidad para nuestros objetivos.

# Análisis descriptivo

Antes de poder realizar nuestros objetivos planteados, conoceremos los valores más importantes de nuestro data frame *'DF'*:

  + Utilizaremos el comando *glimpse()* que nos permitirá confirmar el tipo de variable que anteriormente habían sido definidas en la tabla.

```{r}
glimpse(DF)
```

Como podemos ver, confirmamos que tenemos cuatro variables numéricas (dbl) y que el resto son caracteres. Además, nos resultó útil implementar este comando, ya que, también fue posible conocer el numero de *observaciones* (rows) que resulta un total de *212* y el número de *variables* (columms) igual a *13 variables*. 

  + Por otra parte, para poder conocer los datos completos empleamos el comando *sum*:

```{r}
sum(!is.na(DF))
```

Obteniendo *2756* datos completos.

  + Hemos decidido convertir las variables con caracteres a factores *(variables categóricas)*, por lo que, emplearemos *lapply()*:

```{r}
#primero, guardamos las variables que convertiremos en un vector
categoricas <- c("Genero", "Carrera", "Calidad", "Problemas", "Cansancio", "Somnolencia", "Promedio", "Atencion", "Dificultad")

#segundo, se aplica la funcion lapply a todo el vector
DF[categoricas] <- lapply(DF[categoricas], factor)
```

  + Ahora, usando el comando *summary()* podemos obtener un análisis descriptivo, donde, para las variables numéricas nos muestra el valor mínimo, máximo, 1er y 3er cuartil, la mediana y el promedio. Y en las categóricas, obtenemos, por ejemplo, para la variable *Genero* la número total de encuestados *Hombres (105) y Mujeres (107)* 

```{r}
summary(DF)
```

**Observaciones:**

  - De acuerdo a la función **summary(DF)** podemos observar que dentro de las variables del sueño como: Cansancio, Somnolencia, Atención y Dificultad, los valores más altos son de los estudiantes que afirman presentar estos factores con respecto a los que respondieron que no.

A continuación, presentamos el desarrollo de nuestros objetivos:

**DESCRIPTORES NUMERICOS**

Primeramente, conoceremos los casos y datos completos de cada variable de nuestros tres objetivos:


```{r}
#primer objetivo
sum(complete.cases(DF$Problemas)) #complete.cases: casos completos
sum(complete.cases(DF$Atencion))
sum(!is.na(DF$Problemas)) #datos completos
sum(!is.na(DF$Atencion))
```
  
  - Debido a que para este primer objetivo estamos trabajando con dos variables categóricas, sus resultados posible no arrojan valores numéricos (mediana, media, máximo y mínimo, etc) por lo que, solo podemos observar que tanto para la variable Problemas como para la variable Atencion, el numero de casos y datos completos son iguales,es decir, 212 casos completos y 212 datos completos, debido a que no existe NA's en ninguna de estás variables.
  
```{r}
#psegundo objetivo
sum(complete.cases(DF$Conciliar)) #complete.cases: casos completos
sum(complete.cases(DF$Promedio))
sum(!is.na(DF$Conciliar)) #datos completos
sum(!is.na(DF$Promedio))
```

 - Podemos observar que tanto para la variable **Conciliar** como para la variable **Promedio**, el número de los casos y datos completos son iguales a la cantidad de observación, osea 212. Esto quiere decir que no existe datos ni casos incompletos en estas variables.  
  
```{r}
#tercer objetivo
sum(complete.cases(DF$Ciclo))
sum(complete.cases(DF$Duracion))
sum(!is.na(DF$Ciclo)) 
sum(!is.na(DF$Duracion))
```

 - Podemos observar que tanto para la variable Ciclo como para la variable Duración, el numero de los casos y datos completos son iguales, esto quiere decir que no existe ningún dato incompleto en nuestra base de datos.

**Primer Objetivo: Conocer la relación entre las variables categóricas Problemas para dormir (Problemas) y Prestar atención a las clases (Atencion)**

**DESCRIPTORES GRAFICOS**
  
  * ***Tabla de Contingencia***
  
    Siguiendo, para la parte de descriptores gráficos, crearemos una tabla de contingencia con ambas variables incluidas, a través del comando *table()* para obtener la distribución absoluta de estudiantes según presenten o no problemas para dormir y presten o no atención a las clases y lo almacenamos en *primerOb* que hace referencia a la tabla del primer objetivo que estamos desarrollando:
```{r}
primerOb = table(DF[c("Problemas", "Atencion")])
primerOb
```

**Observaciones**
  
  - De acuerdo con nuestra tabla de contingencia **primerOb** podemos observar, por ejemplo, que la mayor parte de los estudiantes que no presentan problemas para poder ir a dormir consideran que casi siempre prestan atención a las clases, esto tiene mucho sentido ya que, alguien que duerme sin problemas y descansa cómodamente, despierta y se siente mucho mejor, es por ello, que no encontramos ningún valor los estudiantes que no tienen problemas para dormir y consideran que nunca le prestan atención a las clases.

  * ***Gráfico de Barras Comparativa***
  
  El uso de gráficos de barras es muy frecuente en variables cualitativas porque se puede   visualizar la distribución y la relación de ambas variables respectoa a las respuestas de la enciesta.
  
```{r}
barplot(primerOb, beside = T, space = c(0.2, 2), main = "Distribución de estudiantes por la variable Atención y Problema", xlab = "Presta atencion a las clases",ylab = "Cantidad de estudiantes", sub = "Fuente: Elaboración propia", col = c("#440154FF", "#1F968BFF", "#FDE725FF"))

legend(x = "topright", legend = c("A veces", "No", "Si"), fill = c("#440154FF", "#1F968BFF", "#FDE725FF"), 
       title = "Problemas para dormir")
 abline(h = 0) #para que el eje x muestre una linea continua
```

**Observaciones**
  
De la gráfica se puede concluir que la mayoría de los alumnos que tienen dificultados para dormir presentan dificultades prestando atención en clase.

**Segundo Objetivo: Describir la relación entre las horas que le toma a un alumno conciliar el sueño y su promedio ponderado**

Debido a que la variable (Conciliar) es numérica, utilizamos la función **summary()** para obtener su media, mediana, su valor mínimo y máximo. Además, presentamos individualmente el rango, el rango intercuartil y la desviación estándar de dicha variable.

```{r}
summary(DF$Conciliar)

glue("El rango de la variable Conciliar es: ", max(DF$Conciliar)-min(DF$Conciliar))
glue("El rango intercuartíl de la variable Conciliar es: ", IQR(DF$Conciliar))
glue("La desviación estándar de la variable Conciliar es: ", sd(DF$Conciliar))
glue("La moda de la variable Conciliar ponderado es: ", mfv(DF$Conciliar))
```

**Observaciones: **

Los descriptores numéricos permiten el entendimiento de la variable conciliar.

**DESCRIPTORES GRAFICOS**

  * ***Tabla Simple***
  
    Siguiendo, para la parte de descriptores gráficos, crearemos una tabla simple para la variable  cualitativa **Promedio**, a través del comando *table()* y lo almacenamos en *tbPromedio* que hace referencia a la tabla del segundo objetivo que estamos desarrollando:
```{r}
tbPromedio <- table(DF$Promedio)
tbPromedio
```

  * ***Histograma***
  
  Realizamos un histograma para plantear la variable numérica **Conciliar**
```{r}
hist(DF$Conciliar, main = "Histograma de la variable Conciliar", xlab = "Horas",  ylab = "Frecuencia")
grid(nx = NA, ny = NULL, lty = 2, col = "gray", lwd = 0.5)
hist(DF$Conciliar, add = TRUE, col = "skyblue", )
```
  
**Observaciones: **

En la tabla y en el histograma se puede observar numérica y gráficamente la distribución de las respuestas de los alumnos para las variables "Tiempo en conciliar el sueño" y "promedio ponderado".

  * ***Tabla cruzada***
  
```{r}
segundOb = table(DF[c("Conciliar", "Promedio")])
segundOb
```
  
  * ***Mosaico***
  
```{r}
mosaicplot(~ Conciliar + Promedio, data = DF, las = 1,
main = "Tiempo en conciliar el sueño y promedio ponderado", xlab = "Tiempo en conciliar el sueño (horas)", ylab = "Promedio ponderado", col = c("blue")
, cex.axis = 0.9, sub = "Fuente: Elaboración propia")

```

**Observaciones:**

En la tabla cruzada y el diagrama de mozaico se muestra numérica y gráficamente la distribución de las respuestas de los alumnos de ambas variables relacionadas entre si.

**Tercer Objetivo: Identificar la relación entre las variables numéricas duración del sueño (Duracion) y el ciclo del estudiante (Ciclo)**

...

```{r}
summary(DF$Ciclo)
summary(DF$Duracion)
```

```{r}
glue("La moda de la variable Ciclo es: ", mfv(DF$Ciclo))
glue("La moda de la variable Duracion es: ", mfv(DF$Duracion))
glue("El rango de la variable Ciclo es: ", max(DF$Ciclo)-min(DF$Ciclo))
glue("El rango de la variable Duración es: ", max(DF$Duracion)-min(DF$Duracion))
glue("La variación estandar de la variable Ciclo es: ", sd(unlist(DF$Ciclo)))
glue("La variación estandar de la variable Duración es: ", sd(unlist(DF$Duracion)))
```

**DESCRIPTORES GRAFICOS**

* ***Boxplot: Variable Ciclo***
```{r}
boxplot(DF$Ciclo, col="green", main="CICLOS")
```
* ***Boxplot: Variable Duracion***

```{r}
boxplot(DF$Duracion, col="orange", main="DURACIÓN")
```

**Observaciones: **

  - De acuerdo a la gráfica mostrada sobre el histograma de la variable Ciclo se puede notar que el ciclo va desde el 2do ciclo hasta el 10cimo ciclo. En adición a eso, se puede ver que hay más estudiantes que se encuentran en el 2do o 3er ciclo.

  - De acuerdo a la gráfica mostrada sobre el histograma de la variable Duración se puede notar que las horas de sueño va desde desde las 4 hasta las 10 horas. En adición a eso, se puede ver que hay más estudiantes que duermen entre 5 horas con 30 minutos y 6 horas.

  * ***Gráfico de dispersión***

```{r}
plot(DF$Ciclo, DF$Duracion, ylab="DURACIÓN DE HORAS DE SUEÑO", xlab="CICLO",main="GRÁFICO DE DISPERSIÓN DE LA DURACION VS CICLO")
```

**Observaciones: **

Elegimos el gráfico de puntos para comparar las variables debido a que ambas son numéricas,de manera visual podemos observar que entre el 5to y 8avo ciclo lo máximo que llegan a dormir son 8 horas

  * ***Correlación - Coeficiente de correlación***
```{r}
cor.test(DF$Ciclo,DF$Duracion)
```

**Observaciones: **

Al analizar el coeficiente de correlación de Pearson, podemos concluir que existe una correlación negativa. Esto quiere decir que ambas variables se correlacionan en sentido inverso. Mientras una crece la otra disminuye

```{r}
plot(DF$Ciclo, DF$Duracion)
cov(DF$Ciclo, DF$Duracion)
cor(DF$Ciclo,DF$Duracion) # entre 10-25 -> Muy debil. Entre 25-50-> Debil. Entre 50 - 75 -> Buena. Entre 75 - 90 -> Muy buena ... 
```

La correlacion entre estas dos variables es +0.8333 lo que indica que tienen una asociacion directamente proporcional muy buena, por lo que se puede realziar un modelo de regresión lineal simple, donde, X: Nomina y Y: Ventas

duracion = 9.42 + (-0.7071)* ciclo

**Observaciones: **

La línea anterior quiere decir que, si el estudiante no se encontrara en ningun ciclo, su duracion del sueño podria ser de 9.42 horas, sin embargo, a medida que el estudiante se encuentra en un ciclo superior, la duracion del sueño estaria disminuyendo en 0.7071 horas


  * ***COVARIANZA Y REGRESIÓN***
```{r}
lma<-lm(DF$Ciclo ~ DF$Duracion)

plot(DF$Ciclo,DF$Duracion, pch=20, main = "CICLO VS DURACION", xlab="Ciclo", ylab = "Duracion",col=rgb(0,0,0,0.2))
abline(lma,col="red")
```

# Análisis probabilístico

**PROBABILIDADES FRECUENTISTA**

* ***Tabla cruzada: Variables Ciclo y Calidad de sueño del estudiante***

```{r}
terceroP <- table(DF$Ciclo, DF$Duracion)
colnames(terceroP) = c("4 horas", "5 horas", "6 horas", "7 horas", "8 horas", "9 horas", "10 horas") 
rownames(terceroP) = c("2do ciclo", "3er ciclo", "4to ciclo", "5to ciclo", "6to ciclo", "7mo ciclo", "8avo ciclo", "9no ciclo","10mo ciclo")
tabP3 <- CrossTable(terceroP, prop.r=T, prop.c=T,prop.t=F, prop.chisq = F, format="SAS", dnn = c("Ciclo", "Duracion"))

tabla3P<-prop.table(terceroP)
tabla3P
```

***AXIOMA 1***

```{r}
glue("La probabilidad de que un estudiante seleccionado aleatoriamente sea de 9no ciclo es: ",tabla3P[8,1]+tabla3P[8,2]+tabla3P[8,3]+tabla3P[8,4]+tabla3P[8,5]+tabla3P[8,6]+tabla3P[8,7])
```
***AXIOMA 2***

**La probabilidad de que las horas de sueño de un estudiante sea mayor o igual a 8 o que el alumno sea de 6to ciclo. **
$$P(A \cup B)= P(A)+P(B)-P(A \cap B)$$
```{r}
glue("Sea PA2='Las horas de sueño sea mayor o igual a 8':")
PA2<-(tabla3P[1,5]+tabla3P[1,6]+tabla3P[1,7])+(tabla3P[2,5]+tabla3P[2,6]+tabla3P[2,7])+(tabla3P[3,5]+tabla3P[3,6]+tabla3P[3,7])+(tabla3P[4,5]+tabla3P[4,6]+tabla3P[4,7])+(tabla3P[5,5]+tabla3P[5,6]+tabla3P[5,7])+(tabla3P[6,5]+tabla3P[6,6]+tabla3P[6,7])+(tabla3P[7,5]+tabla3P[7,6]+tabla3P[7,7])+(tabla3P[8,5]+tabla3P[8,6]+tabla3P[8,7])+(tabla3P[9,5]+tabla3P[9,6]+tabla3P[9,7])
glue("P(A2)= ",PA2)
glue("Sea PB2='El alumno sea de 6to ciclo':")
PB2<-(tabla3P[5,1]+tabla3P[5,2]+tabla3P[5,3]+tabla3P[5,4]+tabla3P[5,5]+tabla3P[5,6]+tabla3P[5,7])
glue("P(B2)= ", PB2)
glue("Sea P(A ∩ B):")
PAB2<-(tabla3P[5,5]+tabla3P[5,6]+tabla3P[5,7])
glue("P(A ∩ B)= ", PAB2)
glue("Calculamos P(A ∪ B)= ", PAoB2<-(PA2+PB2-PAB2))

```


  * ***Tabla cruzada: Variables Somnolencia y Promedio***

```{r}
segundoP <- table(DF$Somnolencia, DF$Promedio)
colnames(segundoP) = c("pr1: Entre 11 y 15", "pr2: Mayor a 15", "pr3: Menor a 11") 
rownames(segundoP) = c("s1: A veces", "s2: No", "s3: Si")
tabP2 <- CrossTable(segundoP, prop.r=T, prop.c=T,prop.t=F, prop.chisq = F, format="SAS", dnn = c("Somnolencia", "Promedio ponderado"))
```
```{r}
Tab3a<-prop.table(segundoP)
Tab3a
```
***AXIOMA 3***
**La probabilidad de que un estudiante presente a veces sueño durante el dia dado que el estudiante seleccionado tenga un promedio ponderado entre 11 y 15. **
$$P(A / B)=P(A \cap B)/P(B)$$

```{r}
glue("Sea PA3='Casos en los que a veces se presenta somnolencia'")
glue("Sea PB3='Cantidad de alumnos con promedio ponderando entre 11 y 15'")
PB3<-(Tab3a[1,1]+Tab3a[2,1]+Tab3a[3,1])
glue("PB3= ",PB3)
PAi3B<-(Tab3a[1,1])
glue("P(A∩B)= ", PAi3B)
glue("Reemplazando en P(A∩B)/P(B)= ", PAi3B/PB3)


```


***AXIOMA 4***
**Supongamos que se selecciona al azar a un estudiante y resulta que a veces presenta sueño durante el dia. **
*¿Cual es la probabilidad de que este estudiante pertenezca al grupo que indicaron tener un promedio ponderado menor a 11?. *
*Necesitamos encontrar P(PR3/S1). Primero, encontramos P(PR3), P(PR2), P(PR1)*
```{r}
glue("Sea P(PR3)Estudiantes con promedio ponderado < 11/ total de estudiantes encuestados= ", Tab3a[1,3]+Tab3a[2,3]+Tab3a[3,3])
PPR3<-(Tab3a[1,3]+Tab3a[2,3]+Tab3a[3,3])
glue("Sea P(PR2)=", Tab3a[1,2]+Tab3a[2,2]+Tab3a[3,2])
PPR2<-(Tab3a[1,2]+Tab3a[2,2]+Tab3a[3,2])
glue("Sea P(PR1)=", Tab3a[1,1]+Tab3a[2,1]+Tab3a[3,1])
PPR1<-(Tab3a[1,1]+Tab3a[2,1]+Tab3a[3,1])
```
*Ahora, calculamos la probabilidad que el estudiante con un entre 11 y 15 (Pr1) presente a veces sueño durante el dia. Encontrar P(S1/PR1)*
```{r}
glue("P(S1/PR1): Numero de estudiantes con promedio ponderado entre 11 y 15 y presenta a veces sueño durante el día / numero total de esUtdiantes= ", segundoP[1,1]/(segundoP[1,1]+segundoP[2,1]+segundoP[3,1]))
PS1PR1<-(segundoP[1,1]+segundoP[2,1]+segundoP[3,1])
```

```{r}
glue("P(S1/PR2)=", (segundoP[1,2]/(segundoP[1,2]+segundoP[2,2]+segundoP[3,2])))
PS1PR2<-(segundoP[1,2]/(segundoP[1,2]+segundoP[2,2]+segundoP[3,2]))
```
```{r}
glue("P(S1/PR3)=", (segundoP[1,3]/(segundoP[1,3]+segundoP[2,3]+segundoP[3,3])))
PS1PR3<-(segundoP[1,3]/(segundoP[1,3]+segundoP[2,3]+segundoP[3,3]))
```
**Finalmente se usa e teorema de bases**
```{r}
glue("P(PR3/S1)=(P(S1/PR3)*P(PR3))/(P(S1/PR3)*P(PR3))+(P(S1/PR2)*P(PR2))+(P(S1/PR1)*P(PR1))")
glue("P(PR3/S1)=",(PS1PR3*PPR3)/((PS1PR3*PPR3)+(PS1PR2*PPR2)+(PS1PR1*PPR1)))
```


```{r}
tercerP  = table(DF[c("Conciliar", "Promedio")])
colnames(tercerP) = c( "c2: Entre 11 y 15", "c3: Mayor a 15","c1: Menor a 11")
rownames(tercerP) = c("cl1:  1 hora", "cl2:  2 horas", "cl3: 3 horas", "cl4: 4 horas", "cl6: 6 horas") 
tabP3 <- CrossTable(tercerP, prop.r=T, prop.c=T,prop.t=F, prop.chisq = F, format="SAS", dnn = c("Tiempo para conciliar el sueño", "Primedio ponderado"))
pp3<-prop.table(tercerP)
pp3
```


***1.- La probabilidad de que un estudiante demore en concebir el sueño 1 hora y tenga: ***

```{r}
glue("a) menos que 11 de promedio ponderado es:", pp3[1,3])
glue("b) entre 11 y 15 de promedio ponderado es:", pp3[1,1])
glue("c) más de 15 de promedio ponderado es:", pp3[1,2])
glue("d) un promedio ponderado aprobatorio:", pp3[1,2]+pp3[1,1])
```

***2.- La probabilidad de que un estudiante demore en concebir el sueño  2 horas y tenga:***

```{r}
glue("a) menos que 11 de promedio ponderado es:", pp3[2,3])
glue("b) entre 11 y 15 de promedio ponderado es:", pp3[2,1])
glue("c) más de 15 de promedio ponderado es:", pp3[2,2])
glue("d) Tenga un promedio ponderado aprobatorio:", pp3[2,2]+pp3[2,1])
```

***3.- La probabilidad de que un estudiante demore en concebir el sueño  3 horas y tenga:***

```{r}
glue("a) menos que 11 de promedio ponderado es:", pp3[3,3])
glue("b) entre 11 y 15 de promedio ponderado es:", pp3[3,1])
glue("c) más de 15 de promedio ponderado es:", pp3[3,2])
glue("d) Tenga un promedio ponderado aprobatorio:", pp3[3,2]+pp3[3,1])
```

***4.- La probabilidad de que un estudiante demore en concebir el sueño  4 horas y tenga:***

```{r}
glue("a) menos que 11 de promedio ponderado es:", pp3[4,3])
glue("b) entre 11 y 15 de promedio ponderado es:", pp3[4,1])
glue("c) más de 15 de promedio ponderado es:", pp3[4,2])
glue("d) Tenga un promedio ponderado aprobatorio:", pp3[4,2]+pp3[4,1])
```

***5.- La probabilidad de que un estudiante demore en concebir el sueño  6 horas y tenga:***

```{r}
glue("a) menos que 11 de promedio ponderado es:", pp3[5,3])
glue("b) entre 11 y 15 de promedio ponderado es:", pp3[5,1])
glue("c) más de 15 de promedio ponderado es:", pp3[5,2])
glue("d) Tenga un promedio ponderado aprobatorio:", pp3[5,2]+pp3[5,1])
```
**Observaciones**
Según la data recopilada y los calculos realizados, se puede concluir que entre mas tiempo le tome al alumno conciliar el sueño, menor va a ser su probabilidad de tener un promedio aprobatorio.
Mientras mas tiempo le toma al alumno conciliar el sueño, baja el promedio ponderado estadisticamente.

**MODELOS DE DISTRIBUCIÓN**

Finalmente, presentaremos nuestros tres modelos de distribución discretas, donde calcularemos algunas probabilidades según el contexto que hemos colocado, pero primero, realizaremos un análisis de nuestras variables numéricas para poder obtener algún tipo de patrón en ellas y poder identificar con que tipo de modelo deberíamos trabajar.

**Análisis de variables aleatorias**

  - Para poder observar cómo se ven las distribuciones de las principales variables numéricas del estudio, se utilizaron histogramas que serán presentados a continuación:


```{r}
attach(DF)
par(mfrow = c(2,2))
hist(Edad, breaks=10, col = "peachpuff", border = "black", main="Edad",xlab="Edad",ylab = "Frecuencia", labels = T)
hist(Ciclo, breaks=10, col = "peachpuff", border = "black", main="Ciclo",xlab="Ciclo",ylab = "Frecuencia", labels = T)
hist(Duracion, breaks=10, col = "peachpuff", border = "black", main="Duracion",xlab="Duracion",ylab = "Frecuencia", labels = T)
hist(Conciliar, breaks=10, col = "peachpuff", border = "black", main="Conciliar",xlab="Conciliar",ylab = "Frecuencia", labels = T)
```

**Observaciones: **

Hemos realizado una comparación de las cuatro variables numéricas que tenemos en nuestra base de datos **DF** a través de las gráficos de histograma con el fin de poder encontrar una ideal modelación de dichas variables. Podemos observar que, al tratarse de variables numéricas discretas, se debe emplear modelos de distribución discretas trabajadas en clase como: Binomial, Poisson, Geométrica e Hipergeométrica.

**Primer Modelo Binomial: Encontrar Duracion**

   Como sabemos, la distribución binomial generalmente se usa en situaciones en las que solo hay dos resultados posibles de un experimento aleatorio, como **éxito** o **fracaso**, cara o cruz, ganancia o pérdida, y la probabilidad de éxito es constante de un ensayo a otro. Todos los ensayos deben ser independientes entre sí.
   
   En R, la distribución binomial se distribuye de la siguiente manera:
   
  - dbinom(): función de densidad o de probabilidad.
  - pbinom(): función de distribución
  - qbinom(): función para el cálculo de cuantiles.
  - rbinom(): función para simular datos con dicha distribución.


Entonces, para nuestro primer modelo, utilizaremos la variable Duracion (tiempo que duerme un estudiante) y primero, realizaremos una tabla, donde, obtendremos la frecuencia relativa y el porcontaje de sus valores.
```{r}
dur  = table(DF$Duracion)

porcentajes1 <- prop.table(dur) # Calcular frecuencias relativas
porcentajeM1 <- as.data.frame(porcentajes1); porcentajeM1 # Convertir a data frame

TablaM1 <- data.frame(dur, round(porcentajeM1[,2]*100, 2)) # Porcentajes
colnames(TablaM1) <- c("Duracion del sueño", "Frecuencia", "Porcentaje (%)") # Editar nombres
TablaM1
```

En nuestra base de datos **TablaM1** tenemos que el 26.42% de los estudiantes de UTEC duermen 6 horas. Si se selecciona una muestra aleatoria de diez estudiantes.

**a) Calcule la probabilidad de que se seleccionen exactamente cuatro estudiantes que duermen 6 horas.**

Para encontrar la probabilidad de que se seleccionen exactamente cuatro estudiantes que duermen 6 horas, necesitamos usar la función **dbinom()**

Sea **X** el número de estudiantes estudiantes que duermen 6 horas de 10 estudiantes seleccionados al azar y la probabilidad de éxito es 0.2642. Entonces **X∼B(10,0.2642).**

Entonces, primero definimos los términos dados como:

```{r}
# El numero de ensayos o tamaño
n <- 10
# La probabilidad de éxito o prob
pr <- 0.2642
# x son los posibles valores de la variable aleatoria x
x <- 0:n
```

La función de masa de probabilidad de X es:

$$P(X = x) = (10/ x)(0.2642)^x(1-0.2642)^(10-x)$$
$$x = 0, 1, ..., 10$$
Para el punto (a) necesitamos encontrar la probabilidad (P = 4), es posible obtener este resultado reemplazando los valores en la funcion de masa de probabilidad, pero, nosotros utilizaremos la funcion **dbinom()** para calcular la misma probabilidad:

```{r}
rptaM1A <- dbinom(4, n, pr)
rptaM1A
```
Si queremos trazar la gráfica de la distribución de probabilidad binomial, calcularemos las probabilidades de distribucion binomial y haremos una tabla de ellas y luego empleamos **plot()**:

```{r}
## Calcular las probabilidades binomiales
M1x <- dbinom(x, n, pr)
# hacer una tabla
M1Atab1 <- cbind(x, M1x)
# especificar los nombres de las columnas
colnames(M1Atab1)<-c("x", "P(X=x)")
M1Atab1
```

```{r}
## Trazar la distribución de probabilidad binomial
plot(x, M1x, type="h",xlim=c(0,11),ylim=c(0,max(M1x)),
     lwd=10, col="blue",ylab="P(X=x)")
title("Distribucion de probabilidad Binomial (n=10,pr=0.2642)")
```

**b) Calcular la probabilidad de que se seleccionen 2 o menos alumnos que duermen 6 horas**

Necesitamos encontrar la probabilidad **P(X ≤ 2)**

```{r}
rptaM1B <- pbinom(2, n, pr)
rptaM1B
```
La probabilidad anterior también se puede calcular usando la función **dbinom()** y la función **sum()** de la siguiente manera:

```{r}
sum(dbinom(0:2, n, pr))
```

**c) La probabilidad de que se seleccionen más de 8 estudiantes que duermen 6 horas**

Necesitamos encontrar la probabilidad **P(X > 8)**
Entonces utilizamos: 

$$P(X>8)=1−P(X≤8)= 1- pbinom(8, n, pr)$$

```{r}
rptaM1C <- 1-pbinom(5, n, pr)
rptaM1C
```

**d) La probabilidad de que se seleccionen de 4 a 6 (inclusive) estudiantes que duermen 6 horas**

$$P(4≤X≤6)=P(X=4)+P(X=5)+P(X=6)$$

```{r}
rptaM1D <- pbinom(6, n, pr)-pbinom(3, n, pr)
rptaM1D

sum(dbinom(4:6,n,pr)) # calcula la probabilidad binomial para x=4, x=5 y x=6. Luego agrega todas las probabilidades usando la función sum() 
```
Trazamos la gráfica de probabilidades binomiales acumulativas.

```{r}
M1xp <- pbinom(x,n,pr)
M1tabl2 <- cbind(x,M1x,M1xp)
colnames(M1tabl2) <- c("x", "P(X=x)","P(X<=x)")
kable(M1tabl2,align="c")
```
```{r}
plot(x,M1xp,type="s",lwd=2,col="blue",
     ylab=expression(P(X<=x)),
main="Funcion de distribucion B(n=10,p=0.2642)")
```

**Tercer Modelo Binomial: Determinar **


Por ultimo, para nuestro tercer modelo, realizaremos un proceso similar al que vimos en el primer modelo, pero esta vez con la variable **Ciclo**, primero obtenemos nuestra tabla de frecuencia y porcentajes:

```{r}
cicl  = table(Ciclo)

porcentajes3 <- prop.table(cicl) # Calcular frecuencias relativas
porcentajeM3 <- as.data.frame(porcentajes3); porcentajeM3 # Convertir a data frame

TablaM3 <- data.frame(cicl, round(porcentajeM3[,2]*100, 2)) # Porcentajes
colnames(TablaM3) <- c("Ciclo academico", "Frecuencia", "Porcentaje (%)") # Editar nombres
TablaM3
```

En nuestra base de datos **TablaM3** tenemos que el 11.79% de los estudiantes de UTEC se encuentran en el quinto ciclo. Si se selecciona una muestra aleatoria de 8 estudiantes.

**a) Calcule la probabilidad de que se seleccionen exactamente 5 estudiantes que se encuentran en el quinto ciclo.**

Para encontrar la probabilidad de que se seleccionen exactamente 5 estudiantes que se encuentran en el quinto ciclo, necesitamos usar la función **dbinom()**.

Sea **X** el número de estudiantes estudiantes que se encuentran en el quinto ciclo de 8 estudiantes seleccionados al azar y la probabilidad de éxito 0.1179. Entonces **X∼B(8,0.1179).**

Entonces, primero definimos los términos dados como:

```{r}
# El numero de ensayos o tamaño
size <- 8
# La probabilidad de éxito o prob
prob <- 0.1179
# x son los posibles valores de la variable aleatoria x
x <- 0:size
```

Para el punto (a) necesitamos encontrar la probabilidad (P = 5):

```{r}
rptaM3A <- dbinom(5, size, prob)
rptaM3A
```
Trazamos la distribución de probabilidad binomial:

```{r}
## Calcular las probabilidades binomiales
M3x <- dbinom(x, size, prob)
# hacer una tabla
M3Atab1 <- cbind(x, M3x)
# especificar los nombres de las columnas
colnames(M3Atab1)<-c("x", "P(X=x)")
M3Atab1
```

```{r}
## Trazar la distribución de probabilidad binomial
plot(x, M3x, type="h",xlim=c(0,11),ylim=c(0,max(M3x)),
     lwd=10, col="blue",ylab="P(X=x)")
title("Distribucion de probabilidad Binomial (n=8,pr=0.1179)")
```

**b) Calcular la probabilidad de que se seleccionen 3 o menos alumnos que se encuentren en el quinto ciclo**

Necesitamos encontrar la probabilidad **P(X ≤ 3)**

```{r}
rptaM3B <- pbinom(3, size, prob)
rptaM3B
```
La probabilidad anterior también se puede calcular usando la función **dbinom()** y la función **sum()** de la siguiente manera:

```{r}
sum(dbinom(0:3, size, prob))
```

**c) La probabilidad de que se seleccionen más de 4 estudiantes que se encuentren en el quinto ciclo**

Necesitamos encontrar la probabilidad **P(X > 4)**
Entonces utilizamos: 

$$P(X>4)=1−P(X≤4)= 1- pbinom(4, size, prob)$$

```{r}
rptaM1C <- 1-pbinom(4, size, prob)
rptaM1C
```

**d) La probabilidad de que se seleccionen de 4 a 6 (inclusive) estudiantes que esten en el quinto ciclo**

$$P(4≤X≤6)=P(X=4)+P(X=5)+P(X=6)$$

```{r}
rptaM3D <- pbinom(6, size, prob)-pbinom(3, size, prob)
rptaM3D

sum(dbinom(4:6,size,prob)) 
```
Trazamos la gráfica de probabilidades binomiales acumulativas.

```{r}
M3xp <- pbinom(x,size,prob)
M3tabl3 <- cbind(x,M3x,M3xp)
colnames(M3tabl3) <- c("x", "P(X=x)","P(X<=x)")
kable(M3tabl3,align="c")
```
```{r}
plot(x,M3xp,type="s",lwd=2,col="blue",
     ylab=expression(P(X<=x)),
main="Funcion de distribucion B(n=8,p=0.1179)")
```

**Conclusiones: **

Finalmente, hemos concluido con nuestro informe sobre los agentes que influyen en la relación del sueño y el rendimiento academico.
Las conclusiones que hemos llegado a hacer son:

* Mientras un estudiante se encuentra en un ciclo superior, la cantidad de horas que le dedica al sueño se ven disminuidas, debido a que cada vez los cursos se vuelven más pesadas y difíciles de llevar, en los primer ciclos, uno se adecua a este nuevo horario universitaria y no es tan complicado de sobrellevar pero a la larga, vemos que no es tan fácil como se presenta, ocurren más problemas, estres, poco tiempo para distribuirse y eso genera en el estudiante consecuencias perjudiciales para la salud física y mental.
* Tambien hemos encontrado que mientras un estudiante presente buena calidad de sueño, su promedio ponderada se verá reflejado significativamente positiva, es decir, quien descansa de una manera adecuada, tiene la capacidad de poder recibir mejor información, tener una buena memoria, por ende, rendir más en los estudios.
* Por último, consideramos que debe tomarse más en serio el problema de no dormir adecuadamente, en nuestro el 30% de la población presenta problemas para conciliar, si somos más conscientes, podemos tener una población más activa y superada, con menos casos de enfermedades fisicas y mentales, pero para ello se necesita difundir información adecuada y concisa sobre como poder reivindicar los males, como en este estudio, la falta de sueño.

5. Bibliografía

  - https://www.facebook.com/bbcnews. (2016, April 5). 5 consecuencias de la falta de sueño - BBC News Mundo. BBC News Mundo; BBC News Mundo. https://www.bbc.com/mundo/noticias/2016/04/160404_salud_falta_sueno_no_dormir_consecuencias_lb
  - Wong ML, Lau EY, Wan JH, Cheung SF, Hui CH, MokDS. The interplay between sleep and mood in predicting academic functioning, physical health and psychological health 2013; 74: 217-7
  - Abad-Alegría, F., Melendo-Soler, J.A. y Pérez-Trullen, J.M. (1994). Alteraciones globales del
sueño en una población juvenil: malos dormidores y trasgresores del sueño. Psiquis, 15,
438-444.
  - Kiener, P. (2022). CRAN Task View: Probability Distributions. R-Project.org. https://doi.org/https://CRAN.R-project.org/view=Distributions