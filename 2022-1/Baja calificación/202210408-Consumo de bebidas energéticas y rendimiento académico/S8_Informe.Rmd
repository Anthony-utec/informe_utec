---
title: "P2 Informe"
author: "Consumo de bebidas energéticas y rendimiento académico_"
date: "24/06/2022"
output:
  html_document:
    df_print: paged
  pdf_document: default
---
<img src="UTEC.jpg" width="150"/> 

## **Indice**
+ Introducción
  + Relevancia
  + Planificación
+ Datos
  + Recolección de datos
  + Población, muestra y muestreo
  + Variables
  + Limpieza de base de datos
+ Análisis descriptivo y correlaciones
+ Variables aleatorias
+ Conclusión
+ Bibliografía

Se instala las librerías necesarias
```{r,echo, message = FALSE}
if(!require(readr)){install.packages(readr)}
if(!require(dplyr)){install.packages(dplyr)}
if(!require(stringi)){install.packages(stringi)}
if(!require(ggplot2)){install.packages('ggplot2')}
if(!require(scales)){install.packages(scales)}

```
  
```{r, echo=FALSE,message = FALSE}
# Llamada a las librerias
library (readr)
library (dplyr)
library(stringi)
library (ggplot2)
library(scales)
```

```{r, echo=FALSE}
# Lectura de la data
  DF <- read_csv("Encuesta.csv", col_types = "cccccccnncnnnncnnnnccc") 
DDLIMPIO<-read.csv("BaseDeDatosLimpia.csv")
```


### **CORRECCIONES**

#### En base a la entrega 1 y a los comentarios realizados por el docente, los cambios que se han realizado son:

+ Trabajamos los descriptores gráficos con un solo paquete de visualización (ggplot2).

+ Utilizamos descriptores numéricos para describir a las variables. 

+ Hicimos correlaciones de variables para llegar a un análisis más exacto.

+ Eliminamos las salidas de códigos innecesarios.

+ Se especifica de manera clara el criterio de limpieza de la base de datos.

+ Se corrigió la definición de población, muestra y tipo de muestreo.


### **TEMA**
"Estudio sobre la relación entre el consumo de bebidas energéticas y el rendimiento académico de los estudiantes de UTEC"


## **Introducción**

+ #### **Relevancia**

El periodo universitario es considerado como uno de los episodios más retadores en la vida académica de una persona, ya que es aquí donde se enfrentan a nuevos retos y desafíos que ponen a prueba todas sus capacidades, en su mayoría, intelectuales. En ese contexto, el tiempo es uno de los elementos del que más se adolece en esta etapa, por lo que los universitarios cada vez más recurren a bebidas energizantes con el fin de mantenerse despiertos largas horas para completar sus deberes académicos y con esto obtener un mejor rendimiento en la universidad y con ello mejores calificaciones. En este sentido, creemos llamativo e interesante estudiar el impacto que tiene el consumo de bebidas energizantes en relación con el rendimiento académico de los jóvenes universitarios de UTEC, para así identificar si existe una relación directa entre ambas variables, ya que resulta ser un tema del cual somos partícipes y que acontece a nuestro alrededor.

+ #### **Planificación**

El estudio se realizará de forma integradora, a excepción de los universitarios de primer ciclo, ya que ellos aún no pueden dar observaciones respecto a cómo les fue en un ciclo anterior. En ese sentido, se recogerá una muestra aleatoria por un método de muestreo aleatorio simple a todos los estudiantes de los diversos ciclos. La encuesta tendrá un tiempo de recojo de datos “brutos” por el periodo de dos semanas, luego de ello, se procederá a filtrar los datos a fin de recoger una muestra representativa y con datos “limpios”.


```{r, echo=FALSE,message = FALSE}
require(tidyverse)
```

```{r, echo=FALSE,message = FALSE}
gantt<-read.csv("esquema.csv", h=T)
acts<-c("Planteamiento del proyecto", "Lanzamiento de la encuesta y recojo de datos", "Depuración y limpieza de datos", "Análisis descriptivo", "Creación del informe P1", "Presentación de informe P1", "Introducción y planificación para P1", "Descripción de variables en R", "Definición de población, muestra, método de muestreo, etc.", "Rectificación de datos de las encuestas","Correcciones de la P1","Analisis de la data y rectificacion de datos","Correccion de graficos y esquemas","Avances de P2","Creacion de distribucion normal para P2","Consideraciones finales para P2","Creacion de la presentación 2","Exposicion final")
els<-c("Todos", "Niunier", "Dangelo", "Yashira", "Anthony", "Luis")
```

```{r, echo=FALSE,message = FALSE}
g.gant<-gather(gantt, "state", "date", 4:5) %>% mutate(date=as.Date(date, "%Y.%m.%d"), Actividad=factor(Actividad, acts[length(acts):1]), Responsable=factor(Responsable, els))
```

```{r, echo=FALSE,message = FALSE}
ggplot(g.gant, aes(date, Actividad, color=Responsable, group=Item))+
  geom_line(size=6)+
  labs(x="Fechas del proyecto", y=NULL, tittle="Project Timeline")+theme(panel.background = element_rect(fill = "#D6DCDE"))
```


## **Datos**

+ #### **Recolección de datos**
Para obtener los datos de los estudiantes de UTEC sobre el consumo de bebidas energéticas estamos efectuando encuestas a través de un formulario creado en google forms, nuestros encuestados son jóvenes universitarios de la Universidad de Ingeniería y Tecnología (UTEC), que se encuentran cursando al menos segundo ciclo.


+ #### **Población, muestra y muestreo**

+ **Población**:
  
Para nuestro estudio la población estudiada son los estudiantes de la Universidad de Ingeniería y Tecnología que estén cursando estudios actualmente; es necesario precisar que la población está delimitada desde aquellos estudiantes de segundo ciclo hasta aquellos del décimo ciclo.

Unidad muestral:

  + La unidad muestral en este estudio es un estudiante de la UTEC que esté cursando como mínimo el segundo ciclo.
  
  + Muestra: En el estudio la muestra es un total de 200 estudiantes de la UTEC que cursan como mínimo el segundo ciclo académico. No hay restricciones en cuanto a edad u otros factores.
  
  + Tipo de muestreo:
  
Dado que la encuesta fue lanzada de forma voluntaria para su realización así como el estudio solo admite estudiantes de ciclos superiores al segundo, el tipo de muestreo es por conveniencia.


+ #### **Variables**

+ **Relación** (Categórica nominal): Expectativa que poseen los estudiantes acerca de si el consumo de cafeína influye en su rendimiento, las opciones se restringen a _Si_, _No_ o _No estoy seguro_ y no existe un orden entre las opciones.

Se pueden mostrar en el siguiente gráfico de barras.

```{r, echo=FALSE}
ggplot(DDLIMPIO, aes(x = reorder(Creeencia_de_Efectividad, Creeencia_de_Efectividad, function (x) -length (x))), fill= DDLIMPIO$Creeencia_de_Efectividad) +
  geom_bar(width=0.8, colour="white")  +    
  labs(x="Relación",y= "Número de estudiantes")  + ggtitle("Percepción de los estudiantes sobre el impacto de las bebidas energéticas \nsobre su rendimiento académico")+
  ylim(c(0,120))+ geom_text(aes(label=..count..), stat='count',
            position=position_dodge(0.9), 
            vjust=-0.5, 
            size=4.0,
            colour="black")+theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))

```

Procedemos a analizar la percepción que tienen los estudiantes respecto a si consideran que es efectivo el consumo de bebidas energizantes para tener más tiempo de estudio en las noches y así mejorar sus calificaciones. La mayor parte de los encuestados mencionaron que **no estaban seguros que el consumo de bebidas energizantes les ayudó a mejorar su rendimiento académico**.
De esa forma, 58 estudiantes consideran que **NO** les ayudó a mejorar sus calificaciones, 101 estudiantes **no están seguros**, mientras que 42 de ellos **SI** creen que el consumo de bebidas energizantes ayudó a mejorar sus calificaciones.    


+ **Bebida energética** (Categórica nominal): El tipo de bebida energizante que consume, es una variable nominal y solo se restringe a bebidas que contengan cafeína.

Podemos observar su distribución en el siguiente gráfico, en el cual se muestra que la moda, o la bebida que los estudiantes consumen en su mayoría es el café.

```{r, echo=FALSE}
DEE <- DDLIMPIO[!is.na(DDLIMPIO$Bebida),]
ggplot(DEE, aes(x = reorder(Bebida, Bebida, function (x) length (x))), fill = Bebida) + 
    geom_bar(width=0.8, colour="white", fill = "darkgrey") + 
  labs(x="Bebida energética",y= "Cantidad") +ylim(c(0,110))+ ggtitle("Preferencias de bebidas energéticas") +theme(panel.background = element_rect(fill = "#D6DCDE"))+coord_flip() + geom_text(aes(label=..count..), stat='count',
            position=position_dodge(0.9), 
            vjust=0.4, hjust=-0.5,
            size=4.0,
            colour="black")+
  theme(axis.line = element_line(colour = "black",size = 0.5))

```

+ **Ranking** (Categórica nominal): Ranking académico en el que se encuentra el estudiante, el estudiante puede pertenecer al _DECIMO SUPERIOR_, _QUINTO SUPERIOR_, _TERCIO SUPERIOR_ o a _Ninguno de ellos_, estos valores no presentan un orden entre ellos así como no se pueden realizar operaciones matemáticas con estos valores.


```{r, echo=FALSE}
ggplot(DDLIMPIO, aes(x = reorder(Ranking, Ranking, function (x) -length (x))), fill= DDLIMPIO$Ranking) +
  geom_bar(width=0.8, colour="white") + labs(x="Ranking",y= "Cantidad") + ggtitle("Ranking académico de los estudiantes") + ylim(c(0,100)) + geom_text(aes(label=..count..), stat='count',
            position=position_dodge(0.9), 
            vjust=-0.5, 
            size=4.0,
            colour="black")+theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))

```

+ **Cantidad de cursos matriculados** (Numérica discreta): Esta variable hace referencia a la cantidad de cursos que un alumno se ha matriculado en el ciclo anterior; es una variable numérica discreta, debido a que la cantidad de cursos que puede tomar un estudiante en un ciclo es limitada, por lo tanto, es contable.

A continuación se muestra su gráfica y su análisis.

```{r,echo=FALSE}
ggplot(DDLIMPIO,aes(x=Cant_cursos)) + 
  geom_bar(width=1, colour="white", fill="darkgrey")+
  labs(x="Cantidad de cursos", y ="Frecuencia")+ ggtitle("Cursos matriculados en el anterior ciclo") +
  ylim(c(0,80))+
  theme_bw(base_size = 15) +  
  geom_text(aes(label=..count..), stat='count',
            position=position_dodge(0.9), 
            vjust=-0.5, 
            size=4.0) + 
  scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8))+
  theme(panel.background = element_rect(fill = "#D6DCDE"))
```

```{r,echo=FALSE}
mean(DDLIMPIO$Cant_cursos,round(1))
```
En promedio los estudiantes en el anterior ciclo se matricularon en 6 cursos
```{r,echo=FALSE}
mode <- function(x) {
   return(as.numeric(names(which.max(table(x)))))
}
mode(DDLIMPIO$Cant_cursos)
```
La mayor cantidad de estudiantes se matricularon en 6 cursos
```{r,echo=FALSE}
range(DDLIMPIO$Cant_cursos)
```
La cantidad de cursos matriculados en el anterior está en un intervalo de 2 a 8 cursos, por lo tanto, el rango de la variable es 6.
```{r,echo=FALSE}
round(var(DDLIMPIO$Cant_cursos),2)
round(sd(DDLIMPIO$Cant_cursos),2)
```
La variable "Cant_cursos" los datos tiene una varianza de 1.37 y la desviación estándar es 1.17. Al comparar la desviación estándar con la media, se muestra que los datos están muy dispersos.



+ **Horas despierto con bebidas energéticas** (Numérica continua): Esta variable hace referencia a la cantidad de horas extra que un alumno se ha mantenido despierto habiendo ingerido bebidas energéticas; es numérica continúa, debido a que este es un valor continuo que se puede expresar en una cantidad infinita de valores.

A continuación se muestra una gráfica que muestra las horas extras que los estudiantes permanecen despiertos al consumir una bebida energética.

```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$desp_con_bebida))


ggplot(DE,aes(x=unlist(DE))) + 
  geom_histogram(colour="black", fill="gray",bins=11,binwidth = 1)+
  labs(x="Cantidad de horas", y ="Frecuencia")+ ggtitle("Horas extra despierto con bebida energética")+
  ylim(c(0,60))+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$desp_con_bebida)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$desp_con_bebida)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")+
  theme(axis.line = element_line(colour = "black",size = 0.5))
```

La media y la mediana de esta variable son las siguientes.

```{r,echo=FALSE}
round(mean(DDLIMPIO$desp_con_bebida, na.rm=TRUE),2)
median(DDLIMPIO$desp_con_bebida, na.rm=TRUE)
```

Ahora calculamos la desviación estándar y el coeficiente de variación de los valores.

```{r,echo=FALSE}
round(sd(DDLIMPIO$desp_con_bebida, na.rm=TRUE),2)
round(sd(DDLIMPIO$desp_con_bebida, na.rm=TRUE)/mean(DDLIMPIO$desp_con_bebida, na.rm=TRUE),2)
```
Con el dato de la desviación estándar es posible identificar que la mayoría de los estudiantes perciben que la bebida los mantiene despierto en un intervalo de 1.52 horas alrededor de la media, es decir, entre 1.68 y 4.72 horas.

Además, con este valor de desviación estándar podemos afirmar que los datos no están tan dispersos respecto de la media, ya que su valor es relativamente más pequeño, asimismo, el valor del coeficiente de variación nos muestra que no hay una gran variación entre los datos. 

Asimismo, se ha identificado que nuestra variable no tiene un sesgo visible, es decir, los datos no se han visto influenciados por valores externos.




+ **Horas dormido con bebida energética** (Numérica continua): Este tipo de variable hace referencia a las horas que un estudiante ha dormido habiendo ingerido bebidas energéticas; es una numérica continua, ya que al trabajar con el tiempo este posee un valor numérico que puede tomar una cantidad infinita de valores.

A continuación se muestra la distribución de las horas que duerme un estudiante cuando consume una bebida energética.

```{r, echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$dormido_con_bebida))


ggplot(DE,aes(x=unlist(DE))) + 
  geom_histogram(colour="black", fill="gray",bins=11,binwidth = 1)+
  labs(x="Cantidad de horas", y ="Frecuencia")+ ggtitle("Horas que durmio el estudiante con bebida energética")+
  ylim(c(0,50))+
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$dormido_con_bebida)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$dormido_con_bebida)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")+
  theme(axis.line = element_line(colour = "black",size = 0.5))

  
```

De la gráfica se puede apreciar que el número de horas de sueño de un estudiante que ha consumido una bebida energética varía en su mayoría entre 5 y 6 horas, de hecho esta es la clase modal del histograma. Por otro lado, podemos apreciar que nuestra variable no tiene un sesgo pronunciado hacia la derecha, por lo que se puede considerar que es una distribución sin sesgos definidos por valores ***'outliers'***. 

La media y la mediana de esta variable son los siguientes:

```{r,echo=FALSE}
round(mean(DDLIMPIO$dormido_con_bebida, na.rm = TRUE),2)
median(DDLIMPIO$dormido_con_bebida, na.rm = TRUE)
```

Ahora procedemos a calcular la desviación estándar y el coeficiente de variación.
```{r,echo=FALSE}
round(sd(DDLIMPIO$dormido_con_bebida, na.rm=TRUE),2)
round(sd(DDLIMPIO$dormido_con_bebida, na.rm=TRUE)/mean(DDLIMPIO$dormido_con_bebida, na.rm=TRUE),2)
```

Al calcular la desviación estándar de los datos, podemos identificar que no están tan alejados de la media, ya que su valor resulta ser menor en comparación con esta. Asimismo, con el valor del coeficiente de variación podemos identificar que nuestra variable no tiene gran cantidad de datos dispersos.




+ **Hora dormido sin bebida energética** (Numérica continua): Esta variable hace referencia a la cantidad de horas que duerme el estudiante sin consumir bebidas energéticas.Al igual que la variable anterior, no existe un rango contable de valores que esta variable puede tomar, ya que las respuestas de los estudiantes son muy variadas, solo habiendo restricción en cuanto al máximo y mínimo valor.

A continuación se muestra la distribución de las horas que duerme un estudiante cuando no consume una bebida energética.

```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$dormido_sin_bebida))

ggplot(DE,aes(x=unlist(DE))) + 
  labs(x="Horas", y ="Frecuencia")+
  ggtitle("Horas que durmio el estudiante sin bebida energética")+
  geom_histogram(colour="black", fill="gray",bins=11,binwidth = 1)+
  ylim(c(0,80))+
  scale_x_continuous(breaks=c(3,4,5,6,7,8,9,10,12)) +  
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$dormido_sin_bebida)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$dormido_sin_bebida)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")+
  theme(axis.line = element_line(colour = "black",size = 0.5))
```

La media y la mediana de esta distribución de valores es la siguiente.

```{r,echo=FALSE}
round(mean(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE),2)
round(median(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE),2)
```
Respecto a la gráfica, podemos ver que la cantidad de horas que duerme un estudiante sin haber consumido bebidas energéticas se concentra en el intervalo de horas de 6.5 a 8.5. Esto lo podemos comprobar con nuestros descriptores numéricos, en donde se puede observar que el promedio de horas en que los estudiantes duermen sin haber consumido bebidas energéticas es de 7 horas. De igual forma, esta variable tiene una distribución casi simétrica dado que la mediana es cercana a la media.

Ahora procedemos a calcular la desviación estándar y el coeficiente de variación de estos datos.

```{r,echo=FALSE}
round(sd(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE),2)
round(sd(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE)/mean(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE),2)
```
Procedemos a calcular la desviación estándar de la variable y así determinar si los datos están alejados respecto de la media. Podemos apreciar, que la desviación estándar es 1.29, lo que significa que los datos tienen una ligera dispersión respecto de la media. De la misma forma, el valor del coeficiente de variación es mínimo, lo que significa que los datos no están alejados entre sí. 


Ahora haremos una comparativa entre las horas que duerme en promedio un estudiante cuando consume alguna bebida energizante y cuando no lo hace. 

Los promedios son los siguientes:

```{r,echo=FALSE}
round(mean(DDLIMPIO$dormido_con_bebida,na.rm = TRUE),2)
round(mean(DDLIMPIO$dormido_sin_bebida, na.rm=TRUE),2)
```


Al hacer dicha comparativa encontramos una diferencia aproximada de dos horas, es decir, que cuando los estudiantes consumen una bebida energizante, aproximadamente dormirán 2 horas menos que cuando no la consumen, las cuales podrían ser utilizadas para culminar sus actividades académicas.


+ **Promedio general de la carrera** (Numérica discreta): Esta variable hace referencia al promedio general que obtuvo el estudiante el ciclo anterior a la encuesta. La UTEC trabaja los promedios con 2 decimales. Por lo tanto, esta variable es numérica discreta, ya que tomará un amplio rango de valores, pero no infinitos.

A continuación se muestran las notas promedio de los estudiantes.

```{r, echo=FALSE}

DE <- data.frame(na.omit(DDLIMPIO$Nota_Promedio))

gr1 <- ggplot(DE,aes(x=unlist(DE)))+ geom_histogram(colour="black",fill="grey",bins=30)
gr1 + xlab("Nota alcanzada") + ylab ("Número de casos") + 
  scale_x_continuous(breaks= seq(0,20,by=1))+
  ylim(c(0,30))+
  
  ggtitle("Notas promedio de los estudiantes")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))
```


A continuación calculamos la media y la mediana de estos valores 

```{r,echo=FALSE}
round(mean(DDLIMPIO$Nota_Promedio, na.rm=TRUE),2)
median(DDLIMPIO$Nota_Promedio, na.rm=TRUE)

```

Con respecto a esta variable podemos decir que el promedio de notas de los estudiantes encuestados de la UTEC es de 14.88 y una mediana de 15. Por lo tanto, podemos concluir que hay una pequeña asimetría o sesgo hacia la izquierda.



+ **Desde que horas la consume** (Numérica discreta): Esta variable indica la hora en que los estudiantes empiezan a consumir bebidas energéticas de forma habitual. Al restringir la variable a horas enteras y en un rango de 0 a 23 horas, se considera que esta variable es discreta.

A continuación se muestra la distribución de las horas en la que un alumno comienza a consumir bebidas energéticas durante el día.

```{r,echo=FALSE}
gr1 <- ggplot(DDLIMPIO, aes(x = Incio_horas_consumo)) + geom_bar(width=1, colour="black",fill="grey")
gr1 + xlab("Horas") + ylab ("Cantidad de estudiantes") + 
  ggtitle("Horas de inicio consumo de bebidas enérgeticas durante el día")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))


```
```{r,echo=FALSE}
round(median(DDLIMPIO$Incio_horas_consumo, na.rm=TRUE),2)
round(mean(DDLIMPIO$Incio_horas_consumo, na.rm=TRUE),2)
```

Respecto a la gráfica, podemos mencionar que la moda es 20, es decir, los estudiantes en su mayoría consumen bebidas energéticas a partir de las 8 pm. Analizando esto con nuestros descriptores numéricos, podemos decir que la distribución de la hora en que los estudiantes inician a consumir bebidas energéticas tiene un sesgo hacia la izquierda, dado que la media es menor que la mediana, y la mediana menor a la moda. Además, podemos evidenciar que su consumo no se limita a horas de la noche, sino que abarca gran parte de las horas diurnas.




+ **Ciclo** (Categórica ordinal): Se refiere al ciclo en el que el estudiante empezó a consumir bebidas energéticas. Dado que se tiene una cantidad definida y exacta de la cantidad de ciclos, la variable es categórica ordinal.

A continuación se muestra la distribución de los ciclos que los estudiantes comenzaron a consumir bebidas energéticas.

```{r,echo=FALSE}
ggplot(DDLIMPIO, aes(x = Ciclo)) +                    
  geom_bar(width=0.5, colour="black", fill="grey") +       
  labs(x="Ciclo de inicio de consumo",y= "Frecuencia")  +                
  ylim(c(0,80)) +    
    scale_x_continuous(breaks= seq(0,10,by=1))+
  ggtitle("Ciclos que los estudiantes comenzaron a consumir bebidas enérgeticas")  +   
  theme_bw(base_size = 12) +                    
  geom_text(aes(label=..count..), stat='count', 
            position=position_dodge(0.9), 
            vjust=-0.5, 
            size=4.0
            ) + 
  theme(panel.background = element_rect(fill = "#D6DCDE"))
```


Respecto a esta variable, podemos mencionar que la moda, o el ciclo en el cual los estudiantes tuvieron mayor tendencia a empezar a consumir bebidas energizantes, es en el tercer ciclo, lo que se evidencia en el gráfico presentado, ello se podría relacionar con el ámbito académico y la exigencia que existe para presentar actividades académicas, por lo cual el tiempo de estudio juega un papel fundamental.


+ **Miligramos de cafeína** (Numérica continua): Esta variable hace referencia a la cantidad de cafeína en miligramos por cada litro que contiene la bebida energizante que consume el estudiante. Dado que no tenemos un rango contable de valores que puede tomar dicha variable, se considera como numérica continua.
---|
Para el caso de esta variable, los datos de mg de cafeína por litro de bebida energizante son datos extraídos de Internet y como parte de la información pública, por ende no se puede hablar de algún análisis con descriptores numéricos, ya que la cantidad depende de cada tipo de bebida consumido por los estudiantes.
---|

+ **Consumo promedio diario en litros** (Numérica continua): Se refiere a la cantidad en Litros de la bebida energética que el estudiante consume diariamente. Es numérica porque los litros se miden numéricamente y continua porque puede tomar una cantidad incontable de valores dentro de un rango no definido.

Dado que la variable contiene diversos datos cercanos entre sí, además que sigue una distribución continua se presentan de la siguiente forma.

```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$Consumo_dia))
consumo <- ggplot(DE,aes(x=unlist(DE)))
consumo +
  stat_boxplot(geom = "errorbar",width = 0.5)+
  geom_boxplot(colour="black", fill="darkgrey")+labs(x="Consumo en litros diarios en promedio",y="")+
  ggtitle("Distribución del consumo promedio en litros diarios de los estudiantes")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  scale_y_discrete()

```


```{r,echo=FALSE}
round(median(DDLIMPIO$Consumo_dia, na.rm=TRUE),2)
round(mean(DDLIMPIO$Consumo_dia, na.rm=TRUE),2)
round(IQR(DDLIMPIO$Consumo_dia, na.rm=TRUE),2)
```

Respecto a esta variable podemos apreciar que está bastante concentrada dentro de su rango intercuartil, lo que se ve reflejado en la diferencia de aproximadamente 0.02 entre la media y la mediana. Eso significa también que no hay un sesgo mayoritariamente notorio respecto a cuánta bebida consumen diariamente los estudiantes. Por otro lado, podemos observar algunos valores "outliers" que son casos atípicos de un consumo relativamente excesivo de bebida energizante.

+ **Consumo semana 1-semana 5** (Numérica continúa): Cantidad en litros que el estudiante consume semanalmente durante el periodo de la semana 1 a 5. Es numérica continua, ya que los valores ingresados contienen decimales, por lo tanto, esta variable no tiene un límite definido y los estudiantes pueden colocar cualquier cantidad.

A continuación se muestra la distribución del promedio en litros que los estudiantes consumieron en el periodo de la semana 1 a la 5 en el ciclo 2021-2.


```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$Consumo_1_5))

gr1 <- ggplot(DE,aes(x=unlist(DE)))+ geom_histogram(colour="black",fill="grey",bins=15)
gr1 + xlab("Cantidad promedio de litros") + ylab ("Cantidad de estudiantes") + 
  scale_x_continuous(breaks= seq(0,10,by=1))+
  ylim(c(0,40))+
  ggtitle("Consumo semanal promedio en el periodo semana 1 a la 5")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$Consumo_1_5)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$Consumo_1_5)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")

```

Procedemos a calcular sus descriptores numéricos.

```{r,echo=FALSE}
round(median(DDLIMPIO$Consumo_1_5, na.rm=TRUE),2)
round(mean(DDLIMPIO$Consumo_1_5, na.rm=TRUE),2)
```

Respecto a la variable “consumo de la semana 1 a la semana 5”, podemos analizar que tiene un sesgo hacia la derecha, dado que la media es mayor que la mediana, además que no hay una concentración respecto de esta.

+ **Consumo semana 6-semana 10** (Numérica continua): Cantidad en litros que el estudiante consume semanalmente durante el periodo de la semana 6 a 10. Es numérica continua, ya quelos valores ingresados contienen decimales, por lo tanto, esta variable no tiene un límite definido y los estudiantes pueden colocar cualquier cantidad.

A continuación se muestra la distribución del promedio en litros que los estudiantes consumieron en el periodo de la semana 6 a la 10 en el ciclo 2021-2.


```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$Consumo_6_10))

gr1 <- ggplot(DE,aes(x=unlist(DE)))+ geom_histogram(colour="black",fill="grey",bins=15)
gr1 + xlab("Cantidad promedio de litros") + ylab ("Cantidad de estudiantes") + 
  scale_x_continuous(breaks= seq(0,10,by=1))+
  ylim(c(0,35))+
  
  ggtitle("Consumo semanal promedio en el periodo semana 6 a la 10")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$Consumo_6_10)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$Consumo_6_10)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")

```


A continuación calculamos sus descriptores numéricos.

```{r,echo=FALSE}
round(median(DDLIMPIO$Consumo_6_10, na.rm=TRUE),2)
round(mean(DDLIMPIO$Consumo_6_10, na.rm=TRUE),2)
```

Respecto a la variable “consumo de la semana 6 a la semana 10”, podemos mencionar, que tiene una leve distribución sesgada hacia la derecha, dado que el valor de la media resulta ser mayor al de la mediana. Por otro lado, en estas semanas aumenta en promedio el consumo de bebidas energizantes respecto de las primeras semanas.

 
+ **Consumo semana 11- semana 16** (Numérica continua): Cantidad en litros que el estudiante consume semanalmente durante el periodo de la semana 11 a 16. Es numérica continua continua, ya que los valores ingresados contienen decimales, por lo tanto, esta variable no tiene un límite definido y los estudiantes pueden colocar cualquier cantidad.

A continuación se muestra la distribución del promedio en litros que los estudiantes consumieron en el periodo de la semana 11 a la 16 en el ciclo 2021-2.


```{r,echo=FALSE}
DE <- data.frame(na.omit(DDLIMPIO$Consumo_11_16))

gr1 <- ggplot(DE,aes(x=unlist(DE)))+ geom_histogram(colour="black",fill="grey",bins=21)
gr1 + xlab("Cantidad promedio de litros") + ylab ("Cantidad de estudiantes") + 
  scale_x_continuous(breaks= seq(0,15,by=1))+
  ylim(c(0,35))+
  
  ggtitle("Consumo semanal promedio en el periodo semana 11 a la 16")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))+
  geom_vline(aes(xintercept = mean(na.omit(DDLIMPIO$Consumo_6_10)),
                  color = "media"),
              linetype = "dashed",
              size = 1)+
  geom_vline(aes(xintercept = median(na.omit(DDLIMPIO$Consumo_6_10)),
                  color = "mediana"),
              linetype = "dashed",
              size = 1) +
   labs(color = "Leyenda")

```

Procedemos a calcular los descriptores numéricos:

```{r,echo=FALSE}
round(median(na.omit(DDLIMPIO$Consumo_11_16)),2)
round(mean(na.omit(DDLIMPIO$Consumo_11_16)),2)
```

Respecto a la variable “consumo de la semana 11 a la semana 16”, podemos analizar basándonos en sus descriptores numéricos que hay una sesgo a la derecha, ya que la media es mayor a la mediana. Por otro lado, podemos apreciar que el consumo promedio se mantiene en este periodo respecto al periodo anterior, dado que no hay una gran diferencia en el consumo.


#### **Clasificación de variables** 
|Pregunta       |Variable |Tipo de variable |Restricciones
|-------------|---------|--------|------------------------
|Cursos     |Cursos        |Numérica discreta|Numero mayor a 3 y menor a 9 dígitos
|Horas extra despierto con bebida energética|Desp_con_bebida|Numérica continua|Numero positivo
|Horas dormido con bebida energética|Dormido_con_bebida|Numérica continua|Numero positivo
|Horas dormido sin bebida energética|Dormido_sin_bebida|Numérica continua|Numero positivo
|Promedio general de la carrera|Nota_Promedio|Numérica discreta|Numero positivo menor o igual a 20
|Desde que horas la consume|Inicio_horas_consumo|Numérica continua|Numero positivo
|Miligramos de cafeína|cafeína_mg|Numérica continua|Numero positivo superor a 0
|Consumo promedio diario en litros|Consumo_día|Numérica continua|Numero positivo
|Consumo Semana 1 - Semana 5|Consumo_1_5|Numérica continua|Numero positivo
|Consumo Semana 6 - Semana 10|Consumo_6-10|Numérica continua|Numero positivo
|Consumo Semana 11 - Semana 16|Consumo_11_16|Numérica continua|Numero positivo
|Bebida energética|Bebida|Categórica nominal|Bebida que contenga cafeína
|Ranking|Ranking|Categórica nominal|Tercio superior, quinto superior, décimo superior,NA
|Relación|Creencia_de_Efectividad|Categórica nominal|Si,No,No estoy seguro
|Ciclo que inicio el consumo de bebidas energéticas|Inicio_consumo|Categórica ordinal|Número dentro del rango de 1 a 10



#### **Limpieza de base de datos**


  + Llamado a las librerías 
```{r, echo=FALSE}
library (readr)
library (dplyr)
library(stringi)
```
se procede a seleccionar las variable útiles para el esudio y a cambiar el nombre de las variables
  + Lectura de la data
```{r}
DF <- read_csv("Encuesta.csv", col_types = "cccccccnncnnnncnnnnccc") 
```
  + Revisión de la data:
  
Número de observaciones y variables respectivamente.
```{r, echo=FALSE}
dim(DF)  # Dimensiones de la base de datos 
```

 + Nombre original de las variables
```{r, echo=FALSE}
names(DF)
```
  + Selección de las variables que son útiles para el estudio 
```{r, echo=FALSE}
DD <- select(DF, 6,8:22)
names (DD)
```
 + Renombramos las variables de la nueva base de datos `DD`

```{r, echo=FALSE}
DD <- rename(DD, Ciclo = Ciclo, Inicio_consumo = "Ciclo que inicio el consumo de bebidas energéticas", Cant_cursos = Cursos, Bebida = "Bebida energética", cafeina_mg = "Miligramos de Cafeína", Consumo_dia = "Consumo promedio diario en litros (L)", desp_con_bebida = "Horas extras despierto con bebida energética", dormido_con_bebida = "Horas dormido con bebida energética", dormido_sin_bebida = "Horas dormido sin bebida energética", Consumo_1_5 = "Consumo Semana 1 - Semana 5", Consumo_6_10 =  "Consumo Semana 6 - Semana 10" , Consumo_11_16 = "Consumo Semana 11 - Semana 16", Nota_Promedio = "Promedio General de la carrera", Ranking = Ranking, Incio_horas_consumo = "Desde que horas la consume", Creeencia_de_Efectividad = Relacion)

names(DD)
```

  + Revisión del inicio y el final de la base de datos: Al leer el principio y el final de la base de datos nos damos una idea de los posibles problemas con ella. 

```{r, echo=FALSE}
head(DD) #primeras filas
tail(DD) #últimas filas
```

### **Corrección de las variables**
  

  **Corrección de la variable `Bebida`**
  
  + Se observa que la variable `Bebida` presenta algunos datos que tienen el mismo significado de _No Consumo_, otros datos no cumplen con la restricción de contener cafeína para ser considerados, por lo que se les considera como _N.A_
```{r, echo=FALSE}
unique(DD$Bebida)
```


```{r, echo=FALSE}

DD %>% mutate(Bebida =
      ifelse(Bebida == "pepsi por el exceso azucar", "pepsi", 
      ifelse(Bebida %in% c("Ninguna", "Ninguno","ninguno","No consumo"), "No Consumo",
      ifelse(Bebida %in% c("Maca con leche", "todas las anteriores", "Gatorade"), NA, Bebida
             )))) -> DD
DD %>% count(Bebida)
```
  +   Asimismo, eliminamos las tildes
```{r, echo=FALSE}
unique(DD$Bebida)
DD %>% mutate(Bebida = stri_trans_general(Bebida,'latin-ascii')) -> DD
DD %>% count(Bebida) 
```
**Corrección de la variable `cafeína_mg`**

  + Se observa que existe un gran número de valores _NA_ 
```{r, echo=FALSE}
sum(is.na(DD$cafeina_mg))
```
En total hay 80 observaciones que contienen _NA_ en la variable `cafeina_mg`.

   + Se reemplaza los valores _NA_ en `cafeina_mg` que corresponden a productos procesados, los cuales contienen determinada cantidad de miligramos de cafeína por litro del producto.

```{r, echo=FALSE}
select(DD, Bebida, cafeina_mg)
DD %>% mutate(cafeina_mg =
ifelse(Bebida == "C4 Ultimate", 300, 
ifelse(Bebida == "Coca cola", 80, 
ifelse(Bebida == "Magnus", 85, 
ifelse(Bebida == "Monster Energy Drink", 290, 
ifelse(Bebida =="pepsi",110, 
ifelse(Bebida == "Red Bull",300, 
ifelse(Bebida == "Sporade",800, 
ifelse(Bebida == "Supernova", 180, 
ifelse(Bebida == "Volt", 103, cafeina_mg)))))))))
) -> DD

select(DD, Bebida, cafeina_mg)
```


  + Se observa que existen valores que son atípicos, para este caso optamos por comunicarnos con los encuestados determinamos que habían colocado la cantidad de café en miligramos mas no de cafeína, con ello obtuvimos las siguientes correcciones
Valores de la variable _cafeina_mg_ limpios.

Los valores de _cafeina_mg_ luego de la limpieza son:
```{r, echo=FALSE}
DD %>% mutate(cafeina_mg = 
ifelse(cafeina_mg == 16000.000, 640, 
ifelse(cafeina_mg == 3000.000, 300, 
       ifelse(cafeina_mg %in% c(2,4,0,8), NA, cafeina_mg)))) -> DD

unique(DD$cafeina_mg)
```

```{r, echo=FALSE}
DD %>% mutate(dormido_con_bebida = 
ifelse(dormido_con_bebida == 0, NA, dormido_con_bebida)) -> DD
```

```{r, echo=FALSE}
DD %>% mutate(desp_con_bebida = 
ifelse(desp_con_bebida == 0, NA, desp_con_bebida)) -> DD
```
**Corrección de la variable `dormido_sin_bebida`**

  + Observamos que no cumple con las restricción de ser numérica, utilizamos el siguiente criterio de corrección, aquellas variables que se encuentren en un rango corto las colocamos como el promedio entre los extremos, los datos que representen una hora determinada la pasamos a un valor numérico y aquellos datos que no se puedan interpretar como un valor numérico son tomadas como _NA_.   
```{r, echo=FALSE}
unique(DD$dormido_sin_bebida)
```
+ Valores reales aceptados
```{r, echo=FALSE,warning=FALSE}
DD %>% mutate(dormido_sin_bebida = 
ifelse(dormido_sin_bebida == "5-6", 5.5, 
ifelse(dormido_sin_bebida == "81", 8, 
ifelse(dormido_sin_bebida == "9:30",9.5, 
ifelse(dormido_sin_bebida == "7-8",7.5, 
ifelse( dormido_sin_bebida == "8 o 9", 8.5, 
ifelse(dormido_sin_bebida %in% c("Si","Sí", "07-ago",0), NA, dormido_sin_bebida))))))) -> DD
DD$dormido_sin_bebida <- as.numeric(DD$dormido_sin_bebida)
unique(DD$dormido_sin_bebida)
```

**Corrección de las variables `Consumo_1_5`, `Consumo_6_10` y `Consumo_11_16`**

  + Estas variables presentan datos que resultan atípicos comparado con el resto de encuestados, al consultarles, algunos mencionaron que confundieron las cantidades al insertarlas como mililitros en lugar de litros. Por otro lado, algunos entendieron mal la consigna y respondieron con todos los litros que consumen durante este periodo en lugar del promedio semanal que consumen. Procedemos a cambiar estos datos. En el caso en que no conseguimos respuesta se cambia el dato a un _NA_

**Corrección de las variables `Consumo_1_5`**
```{r, echo=FALSE}
unique(DD$Consumo_1_5)
```
```{r, echo=FALSE}
DD %>% mutate(Consumo_1_5 = 
ifelse(Consumo_1_5 == 10, 2, 
ifelse(Consumo_1_5 == 15, 3, 
ifelse(Consumo_1_5 == 23, 4.6, 
ifelse(Consumo_1_5 == 7.098, 1.42, 
ifelse(Consumo_1_5 == 25, 1.75, 
ifelse(Consumo_1_5 == 30, 6, 
ifelse(Consumo_1_5 == 3000, 3,
ifelse(Consumo_1_5 == 20, 4, 
ifelse(Consumo_1_5 == 75, NA, 
ifelse(Consumo_1_5 %in% c(40,0), NA,                                                                            ifelse(Consumo_1_5 == 7, 1.75,                                                                                  ifelse(Consumo_1_5 == 473, 0.473,                                                                               ifelse(Consumo_1_5 == 11.5, 2.3,                                                                                ifelse(Consumo_1_5 == 24, 4.8,                                                                                  ifelse(Consumo_1_5 == 310, 3.10,                                                                               ifelse(Consumo_1_5 == 300, 3,                                                                                 ifelse(Consumo_1_5 == 18, 3.6, 
ifelse(Consumo_1_5 == 805, 0.805, 
ifelse(Consumo_1_5 == 32.2, 6.4, 
ifelse(Consumo_1_5 == 14.490, 2.898, 
ifelse(Consumo_1_5 == 16.1, 3.22, 
ifelse(Consumo_1_5 == 12, 0.42, 
Consumo_1_5))))))))))))))))))))))) -> DD 
```
+ Variable `Consumo_1_5`corregida
```{r, echo=FALSE}
unique(DD$Consumo_1_5)
```




**Corrección de la variable `Consumo_6_10`**
```{r, echo=FALSE}
unique(DD$Consumo_6_10)
```
+ Variable `Consumo_6_10`corregida
```{r, echo=FALSE}
DD %>% mutate(Consumo_6_10 = 
ifelse(Consumo_6_10 == 18, 3.6, 
ifelse(Consumo_6_10 == 20, 4, 
ifelse(Consumo_6_10 == 14, 2.8, 
ifelse(Consumo_6_10 == 10, 2, 
ifelse(Consumo_6_10 == 2000, 2, 
ifelse(Consumo_6_10 == 75, NA, 
ifelse(Consumo_6_10 == 35, 7,
ifelse(Consumo_6_10 == 29, 5.8, 
ifelse(Consumo_6_10 == 473, 4.73, 
ifelse(Consumo_6_10 == 10.5, 2.1,                                                                                                       ifelse(Consumo_6_10 == 12, 2.4,                                                                                                         ifelse(Consumo_6_10 == 15.8, 3.16,                                                                                                     ifelse(Consumo_6_10 == 15, 3,                                                                                               ifelse(Consumo_6_10 == 1240, 1.240,                                                                                                     ifelse(Consumo_6_10 == 500, 5,                                                                                                       ifelse(Consumo_6_10== 48.3, NA,                                                                                                         ifelse(Consumo_6_10 == 15.1, 3, 
ifelse(Consumo_6_10 == 146, 1.46, 
ifelse(Consumo_6_10 == 16.1, 3.22, 
ifelse(Consumo_6_10 %in% c(50, 0), NA, Consumo_6_10))))))))))))))))))))) -> DD 

unique(DD$Consumo_6_10)
```

**Corrección de la variable `Consumo_11_16`**
```{r, echo=FALSE}
unique(DD$Consumo_11_16)
```
+ Variable `Consumo_11_16`corregida
```{r, echo=FALSE}
DD %>% mutate(Consumo_11_16 = 
ifelse(Consumo_11_16 == 20, 4, 
ifelse(Consumo_11_16 == 30, 6, 
ifelse(Consumo_11_16 == 15, 3, 
ifelse(Consumo_11_16 == 40, NA, 
ifelse(Consumo_11_16 == 12, 2.4, 
ifelse(Consumo_11_16 == 4000, 4, 
ifelse(Consumo_11_16 == 75, NA,
ifelse(Consumo_11_16 == 473, 0.473, 
ifelse(Consumo_11_16 == 11.3, 2.26, 
ifelse(Consumo_11_16 == 620, 0.62,                                                                                                      ifelse(Consumo_11_16 == 500, 0.5,                                                                                                      ifelse(Consumo_11_16 == 946, 0.946,                                                                                                     ifelse(Consumo_11_16 == 16.1, 3.22, ifelse(Consumo_11_16 == 11, 1.1, ifelse(Consumo_11_16 == 10, 1,                                                                                                   ifelse(Consumo_11_16 %in% c(60,33, 0), NA, Consumo_11_16))))))))))))))))) -> DD                                                                                          

unique(DD$Consumo_11_16)
```


**Corrección de la variable `Nota_Promedio`**

+ Se observa que existen que exceden el límite restringido, en este caso preferimos convertirlas a _NA_

```{r, echo=FALSE}
filter(DD, DD$Nota_Promedio < 6| DD$Nota_Promedio > 20)
```
Luego de la corrección
```{r, echo=FALSE}
DD %>% mutate( Nota_Promedio = 
ifelse(Nota_Promedio < 6, NA, ifelse(Nota_Promedio > 20, NA, Nota_Promedio))) -> DD
unique(DD$Nota_Promedio)
```
**Corrección de la variable `Consumo_dia`**
Los valores ingresados tienen una magnitud de litros para lo cual algunos valores resultan irreales de ser consumidas por un encuestado durante un día, consultamos a los estudiantes y cambiamos las respuestas de aquellos que accedieron a darnos esa información, de quienes no se obtuvo respuesta fueron reemplpazados por un _NA_.

```{r, echo=FALSE}
unique(DD$Consumo_dia)
```
Luego de la limpieza
```{r, echo=FALSE}
DD %>% mutate(Consumo_dia = 
ifelse(Consumo_dia == 250, 0.250, 
ifelse(Consumo_dia == 473, 0.473, 
ifelse(Consumo_dia == 625, 0.625, 
ifelse(Consumo_dia == 200, 0.200, 
ifelse(Consumo_dia == 350, 0.350, 
ifelse(Consumo_dia == 310, 0.310, 
ifelse(Consumo_dia == 300, 0.300, 
ifelse(Consumo_dia == 345, 0.345, 
ifelse(Consumo_dia > 2, NA, ifelse(Consumo_dia == 0, NA, 
Consumo_dia)))))))))) 
)-> DD

unique(DD$Consumo_dia)
```
**Corrección de la variable `Cant_cursos`**
La mínima cantidad de créditos para un ciclo regular es de 12, en este caso se necesita al menos 3 cursos, por lo cual reemplazamos los datos inferiores a este rango con _NA_. En caso existieran valores superiores a 10, estos también se reemplazan con _NA_.
```{r, echo = FALSE}
unique(DD$Cant_cursos)
```
Observamos que existen valores que escapan del rango permitido entre 3 y 10. Por lo que procedemos a tomarlos como valores _NA_. Es así como los nuevos valores son: 
```{r, echo=FALSE}
DD %>% mutate(Cant_cursos = ifelse(Cant_cursos == 2, NA, Cant_cursos)) -> DD
unique(DD$Cant_cursos)
```




  + Finalmente se procede a guardar la base de datos limpia en un nuevo archivo, llamado BaseDeDatosLimpia.csv
```{r}
write_csv(DD,"BaseDeDatosLimpia.csv")
```

### **Creación de nuevas variables para el estudio**

#### **Crear la variable `total_cafeína`**

Ahora procedemos a crear nuestra variable de **"total de cafeína"** consumida por los estudiantes de forma diaria. Esto se ha realizado multiplicando los litros de la bebida que consumen (`Consumo_dia`), por la variable `cafeinca_mg` la cual muestra el nivel de cafeína que posee la bebida energética que consumen los estudiantes medidos en $mg/L$, de esta forma tendremos un resultado final en mg.
Asignamos el resultado de dicha multiplicación a la variable `total_cafeina` la cual es una variable numérica continua al ser producto de la multiplicación de 2 variables de esta categoría.

```{r}
DD$total_cafeina<-DD$cafeina_mg*DD$Consumo_dia
```


De igual forma crearemos tres variables adicionales que miden el consumo total semanal de cafeína que fue subdividido anteriormente en tres etapas para realizar su posterior análisis.


#### **Crear la variable total cafeína de cada grupo semanal**
- La variable `total_cafeina_1` contiene los miligramos de cafeína en promedio que el estudiante consumió de manera semanal en el periodo de la Semana 1 a la Semana 5, esto se obtiene multiplicando los valores de la variable que contiene el total de cafeína por litro que contiene la bebida que consumen los estudiantes (`cafeina_mg`) con él  consumó en litros de manera semanal que tuvo el estudiante en ese periodo (`Consumo_1_5`).

- La variable `total_cafeina_2` contiene los miligramos de cafeína en promedio que el estudiante consumió de manera semanal en el periodo de la Semana 6 a la Semana 10, esto se obtiene multiplicando los valores de la variable que contiene el total de cafeína por litro que contiene la bebida que consumen los estudiantes (`cafeina_mg`) con él consumó en litros de manera semanal que tuvo el estudiante en ese periodo (`Consumo_6_10`).

- La variable `total_cafeina_3` contiene los miligramos de cafeína en promedio que el estudiante consumió de manera semanal en el periodo de la Semana 11 a la Semana 16, esto se obtiene multiplicando los valores de la variable que contiene el total de cafeína por litro que contiene la bebida que consumen los estudiantes (`cafeina_mg`) con él consumó en litros de manera semanal que tuvo el estudiante en ese periodo (`Consumo_11_16`).

```{r}
DD$total_cafeina_1<-DD$cafeina_mg*DD$Consumo_1_5
DD$total_cafeina_2<-DD$cafeina_mg*DD$Consumo_6_10
DD$total_cafeina_3<-DD$cafeina_mg*DD$Consumo_11_16

```




## **Análisis descriptivo y correlaciones**

#### **Relación entre las variables _CONSUMO TOTAL DE CAFEINA (mg)_ y _PROMEDIO GENERAL DE LA CARRERA_.**

```{r,echo=FALSE, warning=FALSE}
puntos<-ggplot(DD, aes(total_cafeina,Nota_Promedio)) + geom_point()+ labs(x="Consumo total de cafeína por día (mg)",y="Promedio obtenido en el ciclo anterior inmediato") + 
   ggtitle("Distribución del consumo diario de los estudiantes con sus promedios obtenidos")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+geom_smooth(method = "lm", se = FALSE, formula = y ~ x
)+
  theme(axis.line = element_line(colour = "black",size = 0.5))

puntos
```

A continuación se muestra la correlación entre ambas variables.

```{r, echo=FALSE}
round(cor(DD$Nota_Promedio,DD$total_cafeina,use='complete.obs'),2)
```


Apoyándonos del gráfico y habiendo calculado el coeficiente de correlación lineal el cual es 0.09, se puede apreciar que hay una ínfima relación entre el consumo total diario de cafeína medido en mg y las notas obtenidas por los estudiantes en el ciclo anterior inmediato. De esa forma se aprecia que en general un mayor consumo de cafeína no significa necesariamente un mayor rendimiento académico que se ve reflejado en los promedios obtenidos, análogamente, se puede apreciar que algunos estudiantes han obtenido muy buenas calificaciones sin la necesidad de un consumo elevado o necesario de cafeína ,por lo tanto, no se puede hablar de una relación evidente entre ambas variables.


#### **Relación entre las variables _CONSUMO TOTAL DE CAFEINA (mg)_ y _LA CANTIDAD DE CURSOS MATRICULADOS EN EL CICLO ANTERIOR_.**
```{r,echo=FALSE, warning=FALSE}
puntos<-ggplot(DD, aes(Cant_cursos,total_cafeina)) + geom_point()+ labs(y="Consumo total de cafeína por día (mg)",x="Cantidad de cursos matriculados en el ciclo anterior inmediato") + 
   ggtitle("Distribución del consumo diario de los estudiantes con la cantidad de cursos")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+geom_smooth(method = "lm", se = FALSE, formula = y ~ x
)+scale_x_continuous(breaks= seq(0,8,by=1))+
  ylim(c(0,320))+
  theme(axis.line = element_line(colour = "black",size = 0.5))

puntos
```

A continuación se muestra la correlación entre ambas variables.

```{r, echo=FALSE}
round(cor(DD$Cant_cursos,DD$total_cafeina,use='complete.obs'),2)
```
Tomando en cuenta el gráfico podemos apreciar que la cándida de cursos que se matricula un alumno no influye que un alumno vaya a consumir más bebidas energéticas. Además, teniendo en cuenta el coeficiente de la correlación en ambas variables el cual -0.16 se puede concluir que el estar en más cursos matriculados no aumenta el consumo de cafeína.

#### **Relación entre las variables _HORAS DESPIERTO CON BEBIDA ENERGETICA_ y _PROMEDIO GENERAL DE LA CARRERA_.**
```{r,echo=FALSE,warning=FALSE}
puntos<-ggplot(DD, aes(desp_con_bebida,Nota_Promedio)) + geom_point()+ labs(x="Horas extra despierto habiendo ingerido bebidas energéticas",y="Promedio obtenido en el ciclo anterior inmediato") + 
   ggtitle("Distribución de las horas extras que tiene el estudiante consumiendo bebidas \nenergéticas y la nota promedio obtenida en el ciclo anterior")+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+geom_smooth(method = "lm", se = FALSE, formula = y ~ x
)+scale_x_continuous(breaks= seq(0,20,by=2))+
  theme(axis.line = element_line(colour = "black",size = 0.5))
puntos
```

A continuación se muestra la correlación entre ambas variables.
```{r, echo=FALSE}
round(cor(DD$Nota_Promedio,DD$desp_con_bebida,use='complete.obs'),2)
```
Según podemos analizar en la gráfica, la cantidad de horas extra despierto que puede ofrecer consumir una bebida no va a influir en el promedio obtenido. Además, con el coeficiente de correlación de ambas variables, el cual es 0.08, se puede concluir que la relación en ambas variables es demasiado baja, no obstante, en algunos alumnos las horas extra proporcionadas por una bebida energética ha apoyado en su promedio general.


#### **Relación entre las variables _CONSUMO TOTAL DE CAFEINA (mg_) y _RANKING ACADÉMICO_.**


```{r,echo=FALSE,warning=FALSE}
ggplot(DD, aes(y=reorder(Ranking, Ranking, function (y) -length (y)), x = total_cafeina))+
  stat_boxplot(geom = "errorbar",width = 0.5)+
  geom_boxplot(colour="black", fill="darkgrey")+ labs(x="Consumo total de cafeína por día (mg)",y="Ranking")+ 
  ggtitle("Distribución del total de cafeina en mg con respecto al ranking")+
  scale_x_continuous(breaks= seq(0,300,by=50))+ 
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))

```


De la gráfica podemos decir que no hay una relación de gran medida entre el consumo de bebidas energéticas y el ranking académico, ya que una gran cantidad de estudiantes no alcanzaron un ranking a pesar de consumir cafeína. Además, que algunos estudiantes que ocupan el "Tercio superior" en el ranking académico consumen más cafeína que aquellos que no ocupan ningún ranking. No obstante, los que ocupan "Decimo superior" y "Quinto superior" consumen menos cafeína que aquellos que no ocupan un ranking lo que se puede interpretar que el consumo de cafeína no afecta significativamente el poder estar en un ranking académico.


#### **Análisis de las variables `Consumo_1_5`, `Consumo_6_10` y `Consumo_11_16`**

La relevancia para las variables `Consumo_1_5`, `Consumo_6_10`, `Consumo_11_16` está en ver si las semanas de lo que dura un ciclo afecta en el consumo de bebidas para el rendimiento académico; ya que un curso se puede volver más complicado y cansado en las etapas finales.

Como ya hemos calculado anteriormente cuál es la cantidad semanal promedio de mg de cafeína que consume un estudiante, procederemos a calcular el promedio de consumo en estos periodos, para identificar si existe una relación.

A continuación se calcula el promedio de consumo semanal de cada uno de los periodos en los que dividimos el ciclo. El primer valor hace referencia a cuántos miligramos de cafeína se consume semanalmente en el periodo de la semana 1 a la semana 5, el segundo valor hace referencia a cuánta cafeína semanal se consume en promedio de la semana 6 a la semana 10, de igual forma con el último valor hasta la semana 16.

Dichos promedios son los siguientes:

```{r,echo=FALSE}
round(mean(DD$total_cafeina_1, na.rm = TRUE),2)
round(mean(DD$total_cafeina_2, na.rm = TRUE),2)
round(mean(DD$total_cafeina_3, na.rm = TRUE),2)
```


Se aprecia que el consumo promedio de cafeína en el primer periodo del ciclo (Semana 1 - Semana 5) es de 350.91 mg y es menor comparado con el segundo periodo (Semana 6 - Semana 10), el cual es 419.16 mg.   


```{r, echo=FALSE, warning=FALSE}
DE <- data.frame(DD = c(DD$total_cafeina_1, DD$total_cafeina_2, DD$total_cafeina_3), group = c(rep("Semana 1-5"), rep("Semana 6-10"),rep("Semana 11-16")))

ggplot(DE, aes(x=DD, y=group))+
  stat_boxplot(geom = "errorbar",width = 0.5)+
  ggtitle("Distribución de consumo semanal promedio de cafeína (mg) \npor periodo")+
  geom_boxplot(colour="black", fill="darkgrey")+
  ylab("")+ 
  xlab("Promedio de cafeína (mg)")+
  theme(panel.background = element_rect(fill = "#D6DCDE"))+
  theme(axis.line = element_line(colour = "black",size = 0.5))
```

## **Variables aleatorias**

#### **Aproximación a una distribución normal de nuestra variable "total de cafeína"**

Como primera parte trabajaremos con la variable consumo total de miligramos de cafeína y utilizaremos el **Teorema central del límite** para aproximar esta distribución de datos a una distribución normal. Dado que en este caso tenemos más de 30 observaciones efectivas.

Para ello procedemos a calcular el promedio y la varianza de los datos, que viene a estar dada por la varianza dividido sobre la cantidad de datos que se tienen.

```{r,echo=FALSE}
mean(DD$total_cafeina, na.rm = TRUE)
media <- mean(DD$total_cafeina, na.rm = TRUE)
var(DD$total_cafeina, na.rm = TRUE)/sum(!is.na(DD$total_cafeina))
varianza <- var(DD$total_cafeina, na.rm = TRUE)/sum(!is.na(DD$total_cafeina))
```

De tal forma que la aproximación de nuestra distribución normal queda de la siguiente forma:


```{r,echo=FALSE}
data.frame(x=DD$total_cafeina) %>% 
ggplot(aes(x=x))+stat_function(fun=dnorm,n=280,args = list(mean=media,sd=sqrt(varianza)),color="orange",size=2)+ 
  ylab("") +
  labs(title = "Distribución Normal",
       subtitle = "(sd = 9.78)",
       x = "",
       y = "")+ 
  theme(legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),panel.background = element_rect(fill = "#D6DCDE")) +xlim(c(30,120))

```

A partir de lo que tenemos en dicha distribución, se hace el cálculo de la probabilidad de que un estudiante consuma un valor mayor a la mitad del consumo diario recomendado por la FDA, el cual es un valor de 400 mg al día. Por tanto, hallamos la probabilidad de un consumo mayor a 400.

```{r}
pnorm(400,mean=media,sd=sqrt(varianza),lower.tail = FALSE)

```

Como podemos evidenciar, esto representa según la distribución normal un caso que se acerca a lo imposible. Este dato resulta relevante para el estudio ya que conocemos la probabilidad de que los estudiantes de la Universidad de Ingeniería y Tecnología consuman más de 400 mg de cafeína diaria que es lo máximo recomendado según la _Food and Drug Administration_ (FDA). En ese sentido, saber que la probabilidad es baja resulta favorable ya que significa que muy pocos estudiantes sufrirán las consecuencias de consumir cantidades superiores a los 400 mg de cafeína, los cuales son: mareos, taquicardias, entre otros que podrían poner en riesgo su salud, como lo detalla la FDA (2018). 


#### **Aproximación a una distribución normal de nuestra variable "horas dormido con bebida energética"**

Como primera parte trabajaremos con la variable horas dormido con bebida energética y utilizaremos el **Teorema central del límite** para aproximar esta distribución de datos a una distribución normal. Dado que en este caso tenemos más de 30 observaciones efectivas.

Para ello procedemos a calcular el promedio y la varianza de los datos, que viene a estar dada por la varianza dividido sobre la cantidad de datos que se tienen.

```{r,echo=FALSE}
round(mean(DD$dormido_con_bebida, na.rm = TRUE),3)
media1 <- mean(DD$dormido_con_bebida, na.rm = TRUE)
round(var(DD$dormido_con_bebida, na.rm = TRUE)/sum(!is.na(DD$dormido_con_bebida)),3)
varianza1 <- var(DD$dormido_con_bebida, na.rm = TRUE)/sum(!is.na(DD$dormido_con_bebida))

```

De tal forma que la aproximación de nuestra distribución normal queda de la siguiente forma:

```{r,echo=FALSE}
data.frame(x=DD$dormido_con_bebida) %>% 
ggplot(aes(x=x))+stat_function(fun=dnorm,n=200,args = list(mean=media1,sd=sqrt(varianza1)),color="orange",size=2)+ 
  ylab("") +
  labs(title = "Distribución Normal",
       subtitle = "(sd = 0.13)",
       x = "",
       y = "")+ 
  theme(legend.title = element_blank(),
        plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5),panel.background = element_rect(fill = "#D6DCDE")) +xlim(c(3.5,7.5))

```

A partir de lo que tenemos en dicha distribución, se hace el cálculo de la probabilidad de que un estudiante considerado como adulto de más de 18 años duerma menos de las horas mínimas recomendadas el cual es de 6 horas según la revista Health Day. Por tanto, hallamos la probabilidad de horas de sueño menor a 6 horas.

```{r}
pnorm(6,mean=media1,sd=sqrt(varianza1),lower.tail = TRUE)
```

Como podemos apreciar en base a esta aproximación a una distribución normal, la probabilidad de que un estudiante duerma menos de 6 horas es muy alta, casi totalmente probable, con un valor de 99.99 % lo que a su vez resulta un dato desconcertante ya que se se aprecia que al consumir bebidas energéticas que contienen cafeína los estudiantes duermen menos horas de las recomendadas lo que significa que muchos de ellos sufrirán consecuencias en su salud como cansancio, latidos acelerados, mareos y dolores de cabeza. Finalmente no se recomienda consumir este tipo de bebidas ya que más allá de beneficiar, lo que hacen es perjudicar.



## **Conclusiones**

- En conclusión, lo primero que se pudo identificar a partir de nuestra interacción entre el consumo promedio diario de cafeína con los promedios obtenidos por los estudiantes es que no existe una relación directa y concisa que muestre que a mayor o menor consumo de cafeína se tendrá mejores o peores calificaciones, ya que como se demostró, el coeficiente de correlación lineal de los datos era 0.09, un valor que nos muestra la inexistencia de algún tipo de relación.

- En segundo lugar, tampoco se demostró que existe una relación lineal clara entre la cantidad de cursos que llevó el estudiante en el ciclo anterior inmediato con la cantidad diaria promedio de consumo de mg de cafeína. Ello quiere decir que no necesariamente llevar una mayor cantidad de cursos significa consumir mayor cantidad de cafeína, ni tampoco se demuestra lo contrario. 

- Asimismo, se demostró que no existe algún tipo de relación entre las horas que el estudiante permanece despierto debido a que consume alguna bebida energizante con el promedio general que obtuvo, ya que se pudo apreciar que las horas que el estudiante permanece despierto no significa que tendrá un mayor o menor promedio, por lo que tampoco muestra una relación entre el consumo de bebidas energéticas y el rendimiento académico.

- Por último al analizar los grupos académicos con su consumo total de cafeína en mg de forma diaria nos pudimos dar cuenta que los estudiantes que pertenecen al tercio superior de sus carreras reportan un mayor consumo de mg de cafeína, lo que se reduce si analizamos el quinto superior pero que aumenta en el caso del décimo superior por lo que tampoco pudimos hallar una relación entre si el consumo de cafeína va relacionado con el ranking académico del estudiante.

- Por ende no recomendamos el uso de estas bebidas energizantes y emplear otros métodos para tener más tiempo, ya que no demuestra una mejora considerable, además que a la larga puede traer consigo daños a la salud.


## **Bibliografía**

+ Coll, V. (n.d). Iniciación a la visualización de datos. Recuperado de: [https://www.uv.es/vcoll/Temas_AED/4_Visualizacion_datos.html](https://www.uv.es/vcoll/Temas_AED/4_Visualizacion_datos.html)

+ Campitelli, E. (2018, 1 de Junio). Tu propio smooth en geom_smooth(). Recuperado de: [https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/](https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/) 

+ Need help with error when running “geom_smooth()` using formula ‘y ~ x’”. (2021, enero 11). RStudio Community. Recuperado de: [https://community.rstudio.com/t/need-help-with-error-when-running-geom-smooth-using-formula-y-x/92890](https://community.rstudio.com/t/need-help-with-error-when-running-geom-smooth-using-formula-y-x/92890)

+ Preidt, R. (2011, septiembre 12). Los estudiantes universitarios no duermen lo suficiente. _Consumer Health News | HealthDay_. Recuperado de: [https://consumer.healthday.com/kids-health-information-23/misc-kid-s-health-news-435/los-estudiantes-universitarios-no-duermen-lo-suficiente-656786.html](https://consumer.healthday.com/kids-health-information-23/misc-kid-s-health-news-435/los-estudiantes-universitarios-no-duermen-lo-suficiente-656786.html)

+ Rcharts. (n.d). Box plot por grupo en ggplot2. Recuperado de: [https://r-charts.com/es/distribucion/box-plot-grupo-ggplot2/](https://r-charts.com/es/distribucion/box-plot-grupo-ggplot2/)

+ RPubs - Boxplots con ggplot2. (s/f). Rpubs.com. Recuperado el 24 de junio de 2022.  Recuperado de: [https://rpubs.com/MrCristianrl/496859](https://rpubs.com/MrCristianrl/496859) 

+ RPubs - GGPLOT2. Gráfico de barras IV - Reordenar barras. (s/f). Rpubs.com. Recuperado el 24 de junio de 2022, de [https://rpubs.com/Rortizdu/140196](https://rpubs.com/Rortizdu/140196)






