---
title: "Productos para máquinas expendedoras y sus diferentes formas de pago en UTEC"
date: "24 Junio 2022"
output:
  html_document:
    toc: yes
    toc_float: yes
    theme: united
    code_folding: "hide"
  pdf_document:
    toc: yes
---

<br>

<br>

# **Introducción**

___

### **Objetivo**

Analizar las preferencias de los estudiantes de pregrado de UTEC matriculados en el periodo 2022-1, al momento de consumir productos en las máquinas expendedoras de esta universidad, a fin de que las empresas eviten futuros riesgos al invertir en este tipo de máquinas.

### **Relevancia**

Para que un negocio tenga éxito necesita conocer a su público objetivo. Para ello realizaremos una investigación de mercado, la cual busca recopilar información sobre los individuos en los que están interesados las empresas y así evitar riesgos de inversión.

### **Planificación**

Mediante un diagrama de Gantt establecimos nuestra planificación para la entrega final.

```{r, echo=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(vistime)
library(tidyr)
library(lubridate)
library(dplyr)
library(readr)
library(patchwork)
library(ggplot2)
library(plan)
library(stringr)
library(scales)
library(corrplot)
library(hrbrthemes)

```

# **Datos**
___

### **Proceso de recolección de datos**

El método de recolección de datos usado para el estudio fue la encuesta, del cual se obtuvieron 214 respuestas y la distribución de estas fue primero mediante correos institucionales y luego de 157 respuestas, fueron realizadas presencialmente en las áreas comunes de UTEC y de forma aleatoria. Esto se realizó a fin de llegar a toda nuestra población objetivo y así sacar una muestra donde cada individuo tenga las mismas posibilidades de responderla.

Dichos correos fueron diseñados de la siguiente forma:

- Los correos fueron enviados con la finalidad de que la vista previa se pareciera al correo que un compañero de trabajo te mandaría por una situación urgente, por lo que así captamos inicialmente el interés de nuestra población.
- Además utilizamos un incentivo monetario, motivando a que las 15 primeras personas que respondieran dicho correo ganarían 10 soles. (Lo que explica también la gran cantidad de respuestas en la primera hora)
- Y finalmente, para obtener su total atención, al final del correo, les enviamos una imagen adorable y graciosa referente al proyecto.

### **Población, muestra y muestreo**

La población del estudio se encuentra conformada por los estudiantes de pregrado de UTEC matriculados en el periodo 2022-1 que hace uso de las máquinas expendedoras, siendo la muestra de 214 personas. El muestreo es del tipo aleatorio simple. 

### **Variables**

#### **Descripción**

-   `Sexo`: El sexo con el cual se siente identificado la persona encuestada
-   `Consumidor`: Indica si el encuestado consume los productos.
-   `Pago`: El método de pago preferido.
-   `Producto`: El tipo de producto consumido
-   `Asequibilidad`: Asequibilidad de los productos de una máquina expendedora de UTEC.
-   `Variedad y calidad`: Indica qué le parece la variedad y calidad sobre los productos.
-   `Gasto promedio`: Gasto diario en máquinas expendedoras.
-   `Alcancia diaria`: Dinero que lleva diariamente el encuestado.
-   `Gasto diario`: Monto ideal que gastaría en la máquina expendedora.
-   `Estatura`: Estatura del individuo en metros.
-   `Peso`: Peso del encuestado en kilogramos.
-   `Edad`: Edad del encuestado en años.
-   `Consumo diario`: Cantidad de productos que compra usualmente.
-   `Preferencia`: Preferencia entre productos salados y dulces.
-   `IMC`: esta variable dependerá del Peso y Estatura del encuestado $\frac{Peso}{Estatura^2}$.
-   `Nivel de peso`: se le asigna una categoría dependiendo el IMC de la persona.

#### **Tipo y Restricción de las variables**

| Variable | Tipo | Restricción |
|:---------------|:-------------:|---------------:|
| Sexo | Categórica nominal | Hombre, mujer, otro |
| Consumidor | Categórica nominal | Sí, No |
| Pago | Categórica nominal | Efectivo, App, Tarjeta, Otro |
| Producto | Categórica nominal | Bebidas calientes, Bebidas frías y gaseosas, Snacks, otros |
| Asequibilidad | Categórica ordinal | Número entero positivo del 1 al 5 |
| Variedad y calidad | Categórica ordinal | Número entero positivo del 1 al 5 |
| Gasto promedio | Numérica continua | Número racional positivo |
| Alcancía diaria | Numérica continua | Número racional positivo |
| Gasto diario | Numérica continua | Número racional positivo |
| Estatura | Numérica continua | Número racional positivo |
| Peso | Numérica continua | Número racional positivo |
| Edad | Numérica discreta | Número entero positivo |
| Consumo diario | Numérica discreta | Número entero positivo |
| Preferencia | Categórica nominal | Productos dulces, Productos salados |
| IMC | Numérica continua | Número racional positivo |
| Nivel de peso | Categórica ordinal | Peso bajo, Normal, Sobre peso, Obesidad |

<br>


### **Limpieza de base de datos**

En esta parte analizaremos las variables **numéricas** y **categóricas** por separado, para realizar la limpieza de estas dos partes.

```{r, echo=FALSE, warning=FALSE, include=FALSE}
DataFrame <- read_csv("DataFrame.csv")
df<-DataFrame
```

#### **Variables numéricas**

Mediante el uso de **boxplots** se puede analizar algunos datos atípicos que puedan estar presentes en cada una de las variables.

```{r, echo=FALSE, warning=FALSE}

b1 <- ggplot(data = df, aes(y=`Gasto diario`,x="")) + 
  ggtitle("Gasto Diario") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Soles (S/.)",x="") + 
  geom_jitter(alpha = 0.5, color = "#ff6969")
b2 <- ggplot(data = df, aes(y=`Alcancia diaria`,x="")) + 
  ggtitle("Alcancía diaria") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Soles (S/.)",x="") +
  geom_jitter(alpha = 0.5, color = "#ff6969")
b3 <- ggplot(data = df, aes(y=`Consumo diario`,x="")) + 
  ggtitle("Consumo Diario") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Cantidad de productos",x="") +
  geom_jitter(alpha = 0.5, color = "#ff6969")
b4 <- ggplot(data = df, aes(y=Estatura,x="")) + 
  ggtitle("Estatura") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Metros (m)",x="") +
  geom_jitter(alpha = 0.5, color = "#ff6969")
b5 <- ggplot(data = df, aes(y=Peso,x="")) + 
  ggtitle("Peso") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Kilogramos (kg)",x="") +
  geom_jitter(alpha = 0.5, color = "#ff6969")
b6 <- ggplot(data = df, aes(y=Edad,x="")) + 
  ggtitle("Edad") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Años",x="") +
  geom_jitter(alpha = 0.5, color = "#ff6969")

b1+b2+b3+b4+b5+b6
```

Las variables `Gasto diario` y `Alcancia diaria` tienen datos irreales superando $1000$ soles para su gasto diario en compras de productos en una maquina expendedora y $3000$ soles para uso diario en general. Por otro lado, la variable `Peso` tiene personas con menos de $30kg$ y para `Estatura` existen personas con menos de $1.25m$, estos datos atípicos fueron consultados de nuevo con los encuestados para corregir sus fallos. Por ultimo, las variables `Edad` y `Consumo diario` parecen tener valores normales. El resultado después de la limpieza se muestra en los siguientes gráficos, así como también el código usado para la limpieza.

```{r}
#LIMPIEZA Y CORRECION

df$`Gasto diario`[df$`Gasto diario`>25]<-NA
df$`Alcancia diaria`[df$`Alcancia diaria`>500]<-NA

#esto por arreglar
df$Estatura[df$Estatura<1.25]<-NA
df$Peso[df$Peso<30]<-NA
```


```{r, echo=FALSE, warning=FALSE}

b1 <- ggplot(data = df, aes(y=`Gasto diario`,x="")) + 
  ggtitle("Gasto Diario") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Soles (S/.)",x="") + 
  geom_jitter(alpha = 0.5, color = "#429f94")
b2 <- ggplot(data = df, aes(y=`Alcancia diaria`,x="")) + 
  ggtitle("Alcancía diaria") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Soles (S/.)",x="") +
  geom_jitter(alpha = 0.5, color = "#429f94")
b3 <- ggplot(data = df, aes(y=`Consumo diario`,x="")) + 
  ggtitle("Consumo Diario") +
  theme(plot.title = element_text(hjust = 0.5)) +  
  geom_boxplot(alpha = 0.5) +  labs(y="Cantidad de productos",x="") +
  geom_jitter(alpha = 0.5, color = "#429f94")
b4 <- ggplot(data = df, aes(y=Estatura,x="")) + 
  ggtitle("Estatura") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Metros (m)",x="") +
  geom_jitter(alpha = 0.5, color = "#429f94")
b5 <- ggplot(data = df, aes(y=Peso,x="")) + 
  ggtitle("Peso") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Kilogramos (kg)",x="") +
  geom_jitter(alpha = 0.5, color = "#429f94")
b6 <- ggplot(data = df, aes(y=Edad,x="")) + 
  ggtitle("Edad") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Años",x="") +
  geom_jitter(alpha = 0.5, color = "#429f94")

b1+b2+b3+b4+b5+b6
```


#### **Variables categóricas**

Mediante el uso de **gráficos de barras** se puede analizar algunos datos que no corresponden al tipo de restricción de la variable.

```{r, echo=FALSE, warning=FALSE, message = FALSE}


g1 <- ggplot(df, aes(x=Pago)) + ggtitle("Pago") +
  theme(plot.title = element_text(hjust = 0.5)) + geom_bar(fill="#ff6969") + scale_x_discrete(labels = function(x) str_wrap(x, 10)) +  labs(y = "Frecuencia", x="Tipo de pago")
g2 <- ggplot(df, aes(x=Producto)) + ggtitle("Producto") +
  theme(plot.title = element_text(hjust = 0.5)) + geom_bar(fill="#ff6969") + scale_x_discrete(labels = function(x) str_wrap(x, 10)) +  labs(y = "Frecuencia", x="Tipo de producto")
g1/g2
```

En la variable `Pago` observamos una sugerencia de pago con criptomonedas, así como con Yape, ambas recomendaciones serán incluidas a pago con App, ya que hablamos de dinero digital. Además hay 4 casos en los que las personas recomendaron el uso de más de un solo método de pago, pero tomaremos como prioridad el pago con App, ya que es el método de pago menos común en máquinas expendedoras, y lo que buscamos es innovar.

```{r}
#LIMPIEZA Y CORRECCIÓN - PAGO

#Efectivo y App
df[11, "Pago"] = "App"
df[183, "Pago"] = "App" 
#Las 3 anteriores
df[26, "Pago"] = "App"
#Yape
df[87, "Pago"] = "App"
#Efectivo y Yape
df[118, "Pago"] = "App"
#Bitcoin
df[131, "Pago"] = "App"
```


En la variable `Producto` hubieron dos individuos que recomendaron la venta de chicle y uno que sugirió la venta de barras proteicas, lo que son considerados como “Snacks”, además, otro individuo sugirió la venta de bebidas alcohólicas, lo que es perteneciente a “Bebidas frías y gaseosas”, por lo que será categorizado de esa forma.

```{r}
#LIMPIEZA Y CORRECCIÓN - PRODUCTO

#Chicle
df[146, "Producto"] = "Snacks"
df[204, "Producto"] = "Snacks"
#Barras proteicas
df[162, "Producto"] = "Snacks"

#Bebidas alcohólicas
df[131, "Producto"] = df[22, "Producto"] #es bebidas frías y gaseosas
```

El resultado después de la limpieza se muestra en los siguientes gráficos:

```{r, echo=FALSE, warning=FALSE}

g1 <- ggplot(df, aes(x=Pago)) + ggtitle("Pago") +
  theme(plot.title = element_text(hjust = 0.5)) + geom_bar(fill="#9bd3ae") + scale_x_discrete(labels = function(x) str_wrap(x, 10)) +  labs(y = "Frecuencia", x="Tipo de pago")
g2 <- ggplot(df, aes(x=Producto)) + ggtitle("Producto") +
  theme(plot.title = element_text(hjust = 0.5)) + geom_bar(fill="#9bd3ae") + scale_x_discrete(labels = function(x) str_wrap(x, 10)) +  labs(y = "Frecuencia", x="Tipo de producto")
g1/g2
```



> *NOTA: Con los datos una vez limpios, se procedió a implementar las variables `IMC` y `Nivel de peso` las cuales dependen de las variables `Peso` y `Estatura`.*

```{r}
df <- df %>% mutate(df, IMC = round(Peso/(Estatura^2),2))

df <- df %>% 
  mutate(df, `Nivel de peso` = ifelse(
    IMC < 18.55, "Bajo peso", ifelse(
      IMC < 25, "Normal", ifelse(
        IMC < 30, "Sobrepeso", "Obesidad"))))

```


# **Análisis descriptivo**
___
### **Univariado**

#### **Gasto promedio** *(Gasto diario en máquinas expendedoras)*
```{r}
df$`Gasto promedio`[df$`Gasto promedio`>39]<-NA

summary(df$`Gasto promedio`)
```
:::::::::::::: {.columns}
::: {.column width="40%"}

.  
.  
.  

* **Coeficiente de variación** 
```{r, echo=FALSE, warning=FALSE}
coef_var <- function(x, na.rm = FALSE) {
  sd(x, na.rm=na.rm) / mean(x, na.rm=na.rm)
}


coef_var(x=df$`Gasto promedio`, na.rm=T)

```



* **Desviación estándar** 
```{r, echo=FALSE, warning=FALSE}
sd(df$`Gasto promedio`, na.rm = TRUE)
```
.  
.  
.  

:::
::: {.column width="60%"}

```{r, echo=FALSE, warning=FALSE}

plot.new()

set.seed(1)

# Fondo gris claro
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4],
     col = "#ebebeb")

# Añadimos un grid blanco
grid(nx = NULL, ny = NULL, col = "white", lty = 1,
     lwd = par("lwd"), equilogs = TRUE)

par(new = TRUE)


boxplot(df$`Gasto promedio`,
        main = "Gasto promedio",
        ylab = "Soles (S/.)")
stripchart(df$`Gasto promedio`,              # Data
           method = "jitter", # Random noise
           pch = 19,          # Pch symbols
           col = "gray",           # Color of the symbol
           vertical = TRUE,   # Vertical mode
           add = TRUE)        # Add it over


abline(h = min(df$`Gasto promedio`, na.rm=TRUE), col = "Blue")
abline(h = max(df$`Gasto promedio`, na.rm=TRUE), col = "Yellow")
abline(h = mean(df$`Gasto promedio`, na.rm=TRUE), col = "Green")
abline(h = quantile(df$`Gasto promedio`, c(0.25, 0.75), na.rm=TRUE), col = "Red")


legend("topright", 
       legend = c("Media", "Max", "Min", "1st Qu y 3rd Qu"), # Posición y título
       lty = c(1,1,1,1),
       col = c("green","yellow","blue","red"),
       lwd = 2,
       bg = "white") # Color de fondo de la leyenda
```
:::
::::::::::::::

Contemplamos que una persona gasta en promedio S/.5.60 en las máquinas expendedoras diariamente. Gracias a la desviación estándar observamos, en promedio, que el dinero que invierten los estudiantes en estos productos se desvía de la media aproximadamente S/. 3.7, lo que a los inversionistas les dará una noción de cuánto deberían costar sus productos o discernir qué productos son mas rentables. Sin embargo, deben tomar en cuenta que el coeficiente de variación (que relativamente es alto) no da seguridad a los inversionistas de que el gasto diario de los alumnos no varía mucho con respecto al promedio.


#### **Alcancía diaria** *(Dinero que lleva diariamente el encuestado)*

```{r}
summary(df$`Alcancia diaria`)
```
:::::::::::::: {.columns}
::: {.column width="50%"}

```{r, echo=FALSE, warning=FALSE}
plot.new()

set.seed(1)

# Fondo gris claro
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4],
     col = "#ebebeb")

# Añadimos un grid blanco
grid(nx = NULL, ny = NULL, col = "white", lty = 1,
     lwd = par("lwd"), equilogs = TRUE)


par(new = TRUE)

hist(x = df$`Alcancia diaria`, 
     main = "Alcancía diaria", 
     xlab = "Soles (S/.)", ylab = "Frecuencia",
     col = c("ivory"))

mode <- function(x) {
   return(as.numeric(names(which.max(table(x)))))
}

abline(v = mean(df$`Alcancia diaria`, na.rm=TRUE), col = "Green")
abline(v = median(df$`Alcancia diaria`, na.rm=TRUE), col = "Blue")
abline(v = mode(df$`Alcancia diaria`), col = "Orange")


legend("topright", 
       legend = c("Media", "Moda", "Mediana"), # Posición y título
       fill = c("green","orange","blue"),
       bg = "white") # Color de fondo de la leyenda




```

:::
::: {.column width="50%"}


```{r, echo=FALSE, warning=FALSE}

plot.new()

set.seed(1)

# Fondo gris claro
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4],
     col = "#ebebeb")

# Añadimos un grid blanco
grid(nx = NULL, ny = NULL, col = "white", lty = 1,
     lwd = par("lwd"), equilogs = TRUE)

par(new = TRUE)


boxplot(df$`Alcancia diaria`,
        main = "Alcancía diaria",
        ylab = "Soles (S/.)")
stripchart(df$`Alcancia diaria`,              # Data
           method = "jitter", # Random noise
           pch = 19,          # Pch symbols
           col = "gray",           # Color of the symbol
           vertical = TRUE,   # Vertical mode
           add = TRUE)        # Add it over


abline(h = min(df$`Alcancia diaria`, na.rm=TRUE), col = "Blue")
abline(h = max(df$`Alcancia diaria`, na.rm=TRUE), col = "Yellow")
abline(h = quantile(df$`Alcancia diaria`, c(0.25, 0.75), na.rm=TRUE), col = "Red")


legend("topright", 
       legend = c("Max", "Min", "1st Qu y 3rd Qu"), # Posición y título
       lty = c(1,1,1),
       col = c("yellow","blue","red"),
       lwd = 2,
       bg = "white") # Color de fondo de la leyenda
```

:::
::::::::::::::


:::::::::::::: {.columns}
::: {.column width="33%"}
* **Coeficiente de variación** 
```{r, echo=FALSE, warning=FALSE}

coef_var(x=df$`Alcancia diaria`, na.rm=T)

```

:::
::: {.column width="33%"}

* **Varianza** 
```{r, echo=FALSE, warning=FALSE}
var(df$`Alcancia diaria`, na.rm = TRUE)
```

:::
::: {.column width="33%"}

* **Moda** 
```{r, echo=FALSE, warning=FALSE}
xd <- mode(df$`Alcancia diaria`)
xd
```
  
:::
::::::::::::::



Observamos que los estudiantes en promedio llevan a la universidad S/.20.40, pero el coeficiente de variación (que es alto) no da seguridad a los inversionistas de que el dinero que llevan los alumnos no varía mucho con respecto a la media. Finalmente, vemos que los datos se distribuyen de manera asimétrica positiva, lo que demuestra que la mayoría de personas lleva menos de S/.20.40 (el promedio) a la universidad. Todo esto ayuda también a tener una noción de cuánto deberían costar los productos o discernir que productos son mas rentables. 

___

### **Bivariado**


#### **Pago vs. Gasto diario**
 
:::::::::::::: {.columns}
::: {.column width="40%"}

Como podemos ver en la gráfica, la mediana de App es ligeramente mayor a la de Tarjeta y Efectivo, esta diferencia nos indica que mas del 50% de las personas que usan una App como método de pago podrían gastar mas dinero para comprar algún articulo de la maquina expendedora.
La mediana para cada uno es:

-   `Tarjeta`:6
-   `Efectivo`:6
-   `App`:8

Así deducimos que las personas que eligen el método de App tienden a gastar más dinero, por lo que se debería tener en cuenta este tipo de método de pago al momento de considerar invertir en una máquina expendedora.

```{r}

dftarjeta <- filter(df, Pago == "Tarjeta")
dfapp <- filter(df, Pago == "App")
dfefectivo <- filter(df, Pago == "Efectivo")

mediant <- median(na.omit(dftarjeta$`Gasto diario`))
mediane <-median(na.omit(dfefectivo$`Gasto diario`))
mediana <- median(na.omit(dfapp$`Gasto diario`))

```


:::
::: {.column width="60%"}

```{r, echo=FALSE, warning=FALSE}
ggplot(na.omit(df) , aes(x = Pago, y = `Gasto diario`)) + 
  ggtitle("Pago vs. Gasto diario") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_boxplot(alpha = 0.5) +  labs(y="Método de Pago",x = "Gasto diario (S/.)") +
  geom_jitter(alpha = 0.5, color = "#ff6969") + coord_flip()
```

:::
::::::::::::::



#### **Sexo vs. Pago**


```{r,echo=FALSE}
dfM <- df
```

```{r,echo=FALSE}
dfM$Pago <- ordered(dfM$Pago, levels = c("App", "Efectivo", "Tarjeta"))
dfM$Sexo <- ordered(dfM$Sexo, levels = c("Hombre", "Mujer", "Otro"))
```

Al identificar las variables a utilizar podemos crear una tabla para identificar la intersección o relación que existen entre los datos de las dos variables.

```{r,echo}
table1 <- table(dfM$Pago, dfM$Sexo, dnn= c("Pago", "Sexo"))
table1 
```

:::::::::::::: {.columns}
::: {.column width="40%"}

<br>

<br>

La tabla de frecuencia de las variables `Pago` y `Sexo` muestra que los hombres son más propensos a realizar algún tipo de compra a las máquinas expendedora. También, indica que la forma de pago más usada es el efectivo, tanto por hombres y por mujeres, seguido por app y por último la tarjeta.En base a los datos obtenidos podemos crear un gráfica de mosaico que muestre los porcentajes de manera visual sobre las formas de pago que realizan los estudiantes de UTEC.

:::
::: {.column width="60%"}

```{r,echo=FALSE}

mosaicplot(table1,main="Método de Pago según el género", col = "#9999cc")

```
:::
::::::::::::::

Como podemos observar, la gráfica nos muestra de manera visual el porcentaje que obtuvimos. Para saber los porcentajes que se están representando creamos una tabla de porcentaje para que nos indique qué representa cada parte del gráfico de mosaico.

```{r}
# Suma 100% por filas
round(prop.table(table1, 1)*100,2)
```

De esta tabla de porcentaje podemos entender que los hombres tienen una mayor parte de los porcentajes respecto a las formas de pago, lo que nos corrobora que los hombres son más propensos a comprar de las máquinas expendedoras, también muestra que el medio de pago por preferencia es en efectivo.

#### **Sexo vs. Preferencia**

```{r,echo=FALSE}
dfM$Preferencia <- ordered(dfM$Preferencia, levels = c("Productos dulces", "Productos salados"))
dfM$Sexo <- ordered(dfM$Sexo, levels = c("Hombre", "Mujer", "Otro"))
```

Crearemos una tabla para identificar la intersección o relación que existen entre los datos de las dos variables que estaremos analizando.

```{r}
table2 <- table(dfM$Preferencia, dfM$Sexo, dnn= c("Preferencia", "Sexo"))
table2 
```

:::::::::::::: {.columns}
::: {.column width="40%"}

<br>

<br>

La tabla de frecuencia nos muestra que los hombres tienen una mayor preferencia sobre los productos salados que los productos dulces, pero la diferencia es mínima, en cambio las mujeres tienen un mayor gusto por los productos dulces.  
  
  
Con la tabla de frecuencia en base a las variables podemos crear una gráfica de mosaico, la cual nos mostrara de manera visual los porcentajes que representan a nuestra muestra.

:::
::: {.column width="60%"}

```{r,echo=FALSE}
mosaicplot(table2,main="Preferencia según el género",col = "#b0c2f2")
```

:::
::::::::::::::

Como podemos observar, la gráfica nos muestra de manera visual el porcentaje que obtuvimos. Para saber los porcentajes que se están representando creamos una tabla de porcentaje para que nos indique lo qué representa cada parte del gráfico de mosaico.

```{r,echo=FALSE}
#prop.table(table2)
```

```{r}
# Suma 100% por filas
round(prop.table(table2, 1)*100,2)
```

En esta tabla se nos muestra los porcentajes que están representados en la gráfica de mosaicos.

___

#### **Correlaciones entre variables**

En la siguiente matriz podemos apreciar los distintos valores de correlación entre las variables `Gasto Promedio`,`Alcancia diaria`,`Gasto diario`,`Edad`, `Consumo diario` e `IMC`, lo que nos permitirá analizar la relación entre estas.

```{r, echo=FALSE, warning=FALSE, message = FALSE}
#dataframe con nuestras variables de interés
dfn <- select(na.omit(df), `Gasto promedio`, `Alcancia diaria`, `Gasto diario`, Edad, `Consumo diario`, `IMC`)

corrplot(cor(dfn), method = 'number', tl.col = "black", bg = "#ff6969", cl.pos = 'n', col = NULL)
```

Observamos que `Consumo diario` y `Gasto diario` tienen la relación directa más fuerte de entre todas las variables, además, `Gasto promedio` y `Edad` tienen la relación inversa más fuerte.

___

#### **Consumo diario vs. Gasto diario**

**Consumo diario: ** *Cantidad de productos que compra usualmente.*  
**Gasto diario: ** *Monto ideal que gastaría en la máquina expendedora.*

:::::::::::::: {.columns}
::: {.column width="40%"}

<br>



<br>

* **Correlación:**
```{r, echo=FALSE, warning=FALSE, message = FALSE}
cor(dfn$`Consumo diario`, dfn$`Gasto diario`, use = "complete.obs")
```
* **Covarianza:**
```{r, echo=FALSE, warning=FALSE, message = FALSE}
cov(dfn$`Consumo diario`, dfn$`Gasto diario`, use = "complete.obs")
```

:::
::: {.column width="60%"}

```{r, echo=FALSE, warning=FALSE, message = FALSE}
ggplot(dfn, aes(`Consumo diario`, `Gasto diario`)) +
  ggtitle("Consumo diario vs. Gasto diario") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_point(
        color="black",
        fill="#69b3a2",
        shape=22,
        alpha=0.5,
        size=3,
        stroke = 1
        ) +
  geom_smooth(method=lm , color="red", se=FALSE) +
    theme_ipsum()+  labs(y="Gasto diario (S/.)",x = "Cantidad de productos consumidos")
```

:::
::::::::::::::

Podemos apreciar que la relación lineal entre ambas variables es moderadamente fuerte y positiva, esto implica que la razón del por que una persona gasta más se debe a que tal vez esta quiere comprar más productos, lo que podría indicar que los estudiantes prefieren cantidad antes que calidad. La dispersión entre estas dos variables acrecienta a medida que ambas crecen en valor, ya que son pocas las personas que están dispuestas a gastar y consumir mucho en las máquinas expendedoras de UTEC.
 
<br>


<br>



#### **Gasto promedio vs. Gasto diario**

**Gasto promedio: ** *Gasto diario en máquinas expendedoras.*  
**Gasto diario: ** *Monto ideal que gastaría en la máquina expendedora.*

:::::::::::::: {.columns}
::: {.column width="40%"}
<br>



<br>

* **Correlación:**
```{r, echo=FALSE, warning=FALSE, message = FALSE}
cor(dfn$`Gasto promedio`, dfn$`Gasto diario`, use = "complete.obs")
```
* **Covarianza:**
```{r, echo=FALSE, warning=FALSE, message = FALSE}
cov(dfn$`Gasto promedio`, dfn$`Gasto diario`, use = "complete.obs")
```


:::
::: {.column width="60%"}

```{r, echo=FALSE, warning=FALSE, message = FALSE}
ggplot(dfn, aes(`Gasto promedio`, `Gasto diario`)) +
  ggtitle("Gasto promedio vs. Gasto diario") +
  theme(plot.title = element_text(hjust = 0.5)) + 
  geom_point(
        color="black",
        fill="#b0c2f2",
        shape=22,
        alpha=0.5,
        size=3,
        stroke = 1
        ) +
  geom_smooth(method=lm , color="red", se=FALSE) +
    theme_ipsum()+  labs(y="Gasto diario (S/.)",x = "Gasto promedio (S/.)")
```

:::
::::::::::::::

Podemos observar que hay poco grado de asociación lineal entre estas variables, ya que esta es débil y positiva. Esto nos indica que hay una relación poco confiable entre lo que un estudiante presuntamente invertiría en una máquina expendedora con lo que realmente invierte, por ello recomendamos atender principalmente a datos reales antes que a suposiciones.



<br>


<br>

# **Análisis probabilístico**
___

### **Estatura**

```{r}
df$Estatura <- as.numeric(df$Estatura)
```

#### **Empírica**

Analizaremos la Estatura (variable continua). Como se puede observar, el siguiente histograma muestra la densidad y estatura, lo que nos indicará la distribución de valores de destino. En destinos categóricos (destinos con un nivel de medición del nominal u ordinal), se genera un gráfico de barras que muestra en porcentaje de casos que entran dentro de cada categoría del destino. 

```{r}
hist(df$Estatura,breaks=14, freq=FALSE, main="Histograma de Estatura", xlab="Estatura (metros)",ylab="Densidad", col="green",ylim = c(0,7))
lines(density(df$Estatura, na.rm=TRUE),col="red",lwd=3)

curve(dnorm(x, mean(df$Estatura,na.rm=TRUE), sd(df$Estatura,na.rm=TRUE)), lwd = 2, col = "blue", add = T)
legend("topleft", c("curva observada", "curva (normal) teórica"),
       lty = 1, lwd = 2, col = c("red", "blue"), bty = "n",
       cex = 0.8)
```


Cuando utilizamos los datos para analizar su distribución es por qué hablamos de una distribución empírica, que es la distribución real de un sujeto o una opción, y mide las posibilidades reales e individuales sobre la medición de la puntuación directa del sujeto ó de una opción de la cual se ha medido la frecuencia de ocurrencia.

<br>


<br>


Primero, creamos la función FDA (Función de distribución acumulada), que está con base en la curva roja (curva real), que toma como parámetro la variable x y que calcula la proporción de estatura dentro de los datos que obtuvimos. Esta función nos mostrará realmente que tan probable se distribuyen sus datos en los intervalos que mediremos.


```{r}
FDA_Estatura <- function(x){
  mean(df$Estatura <= x,na.rm=TRUE)
}

FDA_Estatura(1.7)
```

La mediana es el valor que divide nuestros datos en dos partes iguales. Con lo que, si calculamos la mediana su valor será:
```{r}
median(df$Estatura, na.rm = TRUE)
```

Ingresaremos la mediana obtenida a nuestra función para preguntar cuál es la proporción de estudiantes que miden dicho valor o menos. Debería de salir un valor muy cercano al 50% por definición de la mediana.

```{r}
mediana_Estatura <- median(df$Estatura, na.rm = TRUE)
FDA_Estatura(mediana_Estatura)
```


<br>


<br>



De momento se calculó proporciones con la función de distribución acumulada FDA.  

Si queremos saber cuánto es la probabilidad de que al escoger un hombre al azar éste mida 1.8m o menos, podríamos utilizar la misma FDA, y dado que cada estudiante tiene las mismas chances de ser elegido la respuesta a la pregunta sería la proporción de estudiantes que miden 1.8 o menos.

```{r}
FDA_Estatura(1.8)
```

Si ahora queremos calcular la probabilidad de que alguien escogido al azar sea más alto que 1.75m, primero calcularemos la FDA para 1.75 y luego obtenemos el complemento.
```{r}
# Probabilidad de que mida 1.75m o menos
prob_Estatura <- FDA_Estatura(1.75)

# Probabilidad de que mida más de 1.75m
1- prob_Estatura
```

Si ahora quisiéramos saber la probabilidad de que al escoger a alguien al azar éste mida más de 1.6m, pero no más de 1.9m, tendríamos como resultado:
```{r}
prob_1_Estatura <- FDA_Estatura(1.9)

prob_2_Estatura <- FDA_Estatura(1.6)

prob_1_Estatura - prob_2_Estatura
```

<br>


<br>


#### **Normal**
___

Ahora analizaremos la distribución teórica (curva azul). Esta distribución podría modelarse utilizando una distribución normal, para ello, en R utilizaremos la función pnorm(x, promedio, desv_est). **Estimaremos la probabilidad de que al escoger un persona al azar que mida menos o igual que 1.80m.**

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
FDA_Estatura(1.8)
```

*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_Estatura <- mean(df$Estatura,na.rm = TRUE)
desv_est_Estatura <- sd(df$Estatura,na.rm = TRUE)

probabilidad_Estatura <- pnorm(1.8, promedio_Estatura, desv_est_Estatura)
probabilidad_Estatura
```

Obtenemos aproximadamente los mismos resultados. Utilizar una distribución normal nos facilita el trabajo cuando nuestros datos tienen un comportamiento normal.  


*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul: *

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_Estatura <- seq(-4, 4, length = 100) * desv_est_Estatura + promedio_Estatura
normal_Estatura <- dnorm(sec_Estatura, promedio_Estatura, desv_est_Estatura)


normal_Estatura %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_Estatura, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("Estatura") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_Estatura < 1.8, sec_Estatura, 0)), fill = "blue") +
  xlim(min(sec_Estatura), max(sec_Estatura)) +
  labs(subtitle = paste("P(x <= 1.8) =", probabilidad_Estatura))
```

<br>


<br>

___

**De la misma forma, podríamos estimar la probabilidad de que al escoger un persona al azar que mida más de 1.75m.**

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
1- FDA_Estatura(1.75)
```

*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_Estatura <- mean(df$Estatura,na.rm = TRUE)
desv_est_Estatura <- sd(df$Estatura,na.rm = TRUE)

probabilidad_Estatura <- 1- pnorm(1.75, promedio_Estatura, desv_est_Estatura)
probabilidad_Estatura
```
  
  
*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul:*

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_Estatura <- seq(-4, 4, length = 100) * desv_est_Estatura + promedio_Estatura
normal_Estatura <- dnorm(sec_Estatura, promedio_Estatura, desv_est_Estatura)

normal_Estatura %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_Estatura, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("Estatura") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_Estatura > 1.75, sec_Estatura, 0)), fill = "blue") +
  xlim(min(sec_Estatura), max(sec_Estatura)) +
  labs(subtitle = paste("P(x > 1.75) =", probabilidad_Estatura))
```
<br>


<br>

___

**Finalmente, volvamos a calcular la probabilidad de que al escoger a alguien al azar éste mida más de 1.6m, pero no más de 1.8m.**

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
prob_1_Estatura <- FDA_Estatura(1.8)
prob_2_Estatura <- FDA_Estatura(1.6)
prob_1_Estatura - prob_2_Estatura
```

*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_Estatura <- mean(df$Estatura,na.rm = TRUE)
desv_est_Estatura <- sd(df$Estatura,na.rm = TRUE)

probabilidad_Estatura <- pnorm(1.8, promedio_Estatura, desv_est_Estatura) - pnorm(1.6, promedio_Estatura, desv_est_Estatura)
probabilidad_Estatura
```


*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul:*

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_Estatura <- seq(-4, 4, length = 100) * desv_est_Estatura + promedio_Estatura
normal_Estatura <- dnorm(sec_Estatura, promedio_Estatura, desv_est_Estatura)

normal_Estatura %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_Estatura, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("Estatura") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_Estatura > 1.6 & sec_Estatura <= 1.8, sec_Estatura, 0)), fill = "blue") +
  xlim(min(sec_Estatura), max(sec_Estatura)) +
  labs(subtitle = paste("P(1.6 < x <= 1.8) =", probabilidad_Estatura))
```


Para estatura:
Podemos calcular probabilidades a partir del siguiente ejemplo:

-   ¿Cuál es la probabilidad de que los estudiantes que consumen de las máquinas expendedoras en UTEC midan al menos $1.7 \ m$?

**Solución**

```{r}
mu <- mean(df$Estatura, na.rm = T)
sigma <- sd(df$Estatura, na.rm = T)
round(mu, 2)
round(sigma, 2)
```

$$\mathbb{X} \sim \text{Norm} \left( \mu \approx 1.70, \sigma \approx 0.08 \right)$$
$$\mathbb{P} \left( x \geq 1.70 \right)$$
```{r}
ans <- pnorm(1.70, mu, sigma)
round(ans, 2)
```

<br>


<br>


### **IMC**

```{r}
df$IMC <- as.numeric(df$IMC)
```

#### **Normal**

Analizamos el IMC (variable continua). Nuestro histograma muestra densidad e IMC, por lo que **aplicamos la distribución teórica a una distribución que se deriva de ciertos principios o suposiciones por razonamiento lógico y matemático, en oposición a una derivada de datos del mundo real obtenidos por investigación empírica**.

```{r}
hist(df$IMC,breaks=25, freq=FALSE, main="Histograma IMC", xlab="IMC", col="green",ylim = c(0,0.25))
lines(density(df$IMC, na.rm=TRUE),col="red",lwd=3)

curve(dnorm(x, mean(df$IMC,na.rm=TRUE), sd(df$IMC,na.rm=TRUE)), lwd = 2, col = "blue", add = T)
legend("topleft", c("curva observada", "curva (normal) teórica"),
       lty = 1, lwd = 2, col = c("red", "blue"), bty = "n",
       cex = 0.8)
```

```{r}
FDA_IMC <- function(x){
  mean(df$IMC <= x,na.rm=TRUE)
}
```

Esta distribución podría modelarse utilizando una distribución normal. Para ello, en R utilizaremos la función pnorm(x, promedio, desv_est) para estimar la probabilidad pero utilizando una función de distribución normal con un promedio "promedio_IMC" y una desviación estandar "desv_est_IMC". De esta forma, podemos estimar cuál es la probabilidad de que si escogemos un valor al azar éste sea menor o igual que x.

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
FDA_IMC(27)
```

*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_IMC <- mean(df$IMC,na.rm = TRUE)
desv_est_IMC <- sd(df$IMC,na.rm = TRUE)

probabilidad_IMC <- pnorm(27, promedio_IMC, desv_est_IMC)
probabilidad_IMC
```


Obtenemos aproximadamente los mismos resultados. Utilizar una distribución normal nos facilita el trabajo cuando nuestros datos tiene un comportamiento normal.

*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul:*

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_IMC <- seq(-4, 4, length = 100) * desv_est_IMC + promedio_IMC
normal_IMC <- dnorm(sec_IMC, promedio_IMC, desv_est_IMC)

normal_IMC %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_IMC, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("IMC") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_IMC < 27, sec_IMC, 0)), fill = "blue") +
  xlim(min(sec_IMC), max(sec_IMC)) +
  labs(subtitle = paste("P(x <= 27) =", probabilidad_IMC))
```

<br>


<br>

___


**De la misma forma, podríamos estimar la probabilidad de que al escoger un IMC al azar sea 25.**

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
1- FDA_IMC(25)
```

*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_IMC <- mean(df$IMC,na.rm = TRUE)
desv_est_IMC <- sd(df$IMC,na.rm = TRUE)

probabilidad_IMC <- 1- pnorm(25, promedio_IMC, desv_est_IMC)
probabilidad_IMC

```



*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul:*

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_IMC <- seq(-4, 4, length = 100) * desv_est_IMC + promedio_IMC
normal_IMC <- dnorm(sec_IMC, promedio_IMC, desv_est_IMC)

normal_IMC %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_IMC, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("IMC") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_IMC > 25, sec_IMC, 0)), fill = "blue") +
  xlim(min(sec_IMC), max(sec_IMC)) +
  labs(subtitle = paste("P(x > 25) =", probabilidad_IMC))
```

<br>


<br>

___


**Finalmente, volvamos a calcular la probabilidad de que al escoger el IMC al azar éste sea más de 20, pero no más de 27.5 tendríamos.**

*Utilizando la distribución empírica (data real):*
```{r}
# Utilizando la distribución empírica (data real):
prob_1_IMC <- FDA_IMC(27.5)
prob_2_IMC <- FDA_IMC(20)
prob_1_IMC - prob_2_IMC
#> [1] 0.9445813


```


*Utilizando la distribución teórica normal (data approx.):*
```{r}
# Utilizando la distribución teórica normal (data approx.):
promedio_IMC <- mean(df$IMC,na.rm = TRUE)
desv_est_IMC <- sd(df$IMC,na.rm = TRUE)

probabilidad_IMC <- pnorm(27.5, promedio_IMC, desv_est_IMC) - pnorm(20, promedio_IMC, desv_est_IMC)
probabilidad_IMC
```


*Matemáticamente estamos calculando el área bajo la curva la cual se ve de color azul: * 

```{r, echo=FALSE, warning=FALSE, message = FALSE}
sec_IMC <- seq(-4, 4, length = 100) * desv_est_IMC + promedio_IMC
normal_IMC <- dnorm(sec_IMC, promedio_IMC, desv_est_IMC)

normal_IMC %>% 
  as.data.frame() %>% 
  rename(valor = ".") %>% 
  ggplot() +
  aes(sec_IMC, valor) +
  geom_line() +
  theme(axis.text.y = element_blank()) +
  xlab("IMC") +
  ylab("") +
  ggtitle("Distribución normal") +
  geom_area(aes(x = ifelse(sec_IMC > 20 & sec_IMC <= 27.5, sec_IMC, 0)), fill = "blue") +
  xlim(min(sec_IMC), max(sec_IMC)) +
  labs(subtitle = paste("P(20 < x <= 27.5) =", probabilidad_IMC))
```


Para IMC:
También podemos aplicar un experimento:

-   Cuál es la probabilidad de que los estudiantes que consumen de las máquinas expendedoras en UTEC presenten menos de $20 \ \frac{kg}{m^2}$ (IMC)?

**Solución**

```{r}
mu <- mean(df$IMC, na.rm = T)
sigma <- sd(df$IMC, na.rm = T)
round(mu, 2)
round(sigma, 2)
```

Esto se puede resolver estandarizando la variable:

$$z = \frac{x- \mu}{\sigma} = \frac{20- \left( \approx 23.95 \right)}{\left( \approx 3.38 \right)}$$

```{r}
z <- (20-mu)/sigma
round(z, 2)
```

$$z \approx -1.17$$
$$\mathbb{P} \left( z \le -1.17 \right)$$

```{r}
ans <- pnorm(z)
round(ans, 2)
```
La probabilidad de que el IMC de una persona sea menor a $20 \ \frac{kg}{m^2}$ es de aproximadamente $0.12$.

### **Peso**

```{r}
FDA_Peso <- function(x){
  mean(df$Peso <= x, na.rm=TRUE)
}
```

```{r}
hist(df$Peso, breaks = 25, freq = F, main = "Histograma de Peso", col = "green", xlab="Peso", ylab="Densidad")
lines(density(df$Peso, na.rm = T), lwd = 2, col = "red")
curve(dnorm(x, mean(df$Peso, na.rm = T), sd(df$Peso, na.rm = T)), lwd = 2, col = "blue", add = T)
legend("topleft", c("curva observada", "curva (normal) teórica"), lty = 1, lwd = 2, col = c("red", "blue"), bty = "n", cex = 0.8)
```

La distribución es normal como se puede observar. A parte, cumple con la siguiente proporción de sus datos:

<center><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1a/Boxplot_vs_PDF.svg/800px-Boxplot_vs_PDF.svg.png"
width="400"
height="341" /></center>

```{r}
mu <- mean(df$Peso, na.rm = T)
sigma <- sd(df$Peso, na.rm = T) 
```

<br>


<br>



Errores absolutos y relativos en al distribución de la muestra dentro de los intervalos:

$\left[\mu-\sigma,\mu+\sigma\right]$


* *Cálculo de la probabilidad teórica:*
```{r}
(val.teo <- pnorm(mu+sigma, mu, sigma) - pnorm(mu-sigma, mu, sigma))
```

* *Cálculo de la probabilidad empírica:*
```{r}
(val.emp <- FDA_Peso(mu+sigma) - FDA_Peso(mu-sigma))
```

* *Cálculo del error absoluto:*
```{r}
round(abs(val.teo - val.emp), 2)
```

* *Cálculo del error relativo:*
```{r}
round(abs(val.teo - val.emp)/val.teo, 2)
```

<br>


<br>



El error absoluto y relativo es de $0.04$ y $0.06$ respectivamente.

$\left[\mu-2\sigma,\mu+2\sigma\right]$

* *Cálculo de la probabilidad teórica:*
```{r}
(val.teo <- pnorm(mu+2*sigma, mu, sigma) - pnorm(mu-2*sigma, mu, sigma))
```

* *Cálculo de la probabilidad empírica:*
```{r}
(val.emp <- FDA_Peso(mu+2*sigma) - FDA_Peso(mu-2*sigma))
```

* *Cálculo del error absoluto:*
```{r}
round(abs(val.teo - val.emp), 2)
```

* *Cálculo del error relativo:*
```{r}
round(abs(val.teo - val.emp)/val.teo, 2)
```

<br>


<br>




El error absoluto y relativo es de $0.02$ y $0.03$ respectivamente.

$\left[\mu-3\sigma,\mu+3\sigma\right]$

* *Cálculo de la probabilidad teórica:*
```{r}
(val.teo <- pnorm(mu+3*sigma, mu, sigma) - pnorm(mu-3*sigma, mu, sigma))
```

* *Cálculo de la probabilidad empírica:*
```{r}
(val.emp <- FDA_Peso(mu+3*sigma) - FDA_Peso(mu-3*sigma))
```

* *Cálculo del error absoluto:*
```{r}
round(abs(val.teo - val.emp), 7)
```

* *Cálculo del error relativo:*
```{r}
round(abs(val.teo - val.emp)/val.teo, 7)
```

El error absoluto y relativo es de $3.1142\text{e}-3$ y $3.1226\text{e}-3$ respectivamente.

**En conclusión, la distribución de los datos estimados de la densidad empírica se aproxima en gran medida a la densidad teórica de la normal.**













