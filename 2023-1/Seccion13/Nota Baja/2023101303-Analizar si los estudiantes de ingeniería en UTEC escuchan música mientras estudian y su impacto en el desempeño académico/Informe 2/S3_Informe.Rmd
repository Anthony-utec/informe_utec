---
title: "Proyecto"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
---
  
```{r}
library(readr)
library(dplyr)
#install.packages('modeest')
#install.packages('tidyverse')
#install.packages("rmarkdown")
library(tidyr)
library(modeest)
library(tidyverse)
library(ggplot2)

```


# [INTRODUCCIÓN]{style="color:darkred"}:

## RELEVANCIA

La investigación trata sobre los estudiantes de la universidad de Ingeniería y Tecnología (UTEC) si escuchan
música mientras estudian, los cual tiene una gran importancia tanto en el ámbito
académico como pedagógico. Este estudio puede brindar información
valiosa acerca de las preferencias y los hábitos de estudio de los
estudiantes, así como su impacto en su rendimiento académico. Diversas
investigaciones previas sugieren que la música puede tener influencia en
la concentración y la productividad durante tareas cognitivas. Por lo
tanto, comprender si los estudiantes de ingeniería en UTEC utilizan la
música como una estrategia para mejorar su enfoque y rendimiento puede
tener implicaciones significativas en el diseño de entornos de
aprendizaje efectivos. Además, este estudio podría ayudar a identificar
patrones o diferencias en el uso de la música según el género, nivel
académico u otras variables, lo cual permitiría personalizar las
estrategias de enseñanza y aprendizaje de manera más adecuada. En
resumen, investigar la relación entre la música y el estudio en los
estudiantes de ingeniería en UTEC tiene el potencial de enriquecer el
campo de la educación y ofrecer una guía práctica para promover un
entorno de aprendizaje más eficiente y adaptado a las necesidades de los
estudiantes.

## OBJETIVOS

### OBJETIVOS GENERALES

Realizar un análisis estadístico de una base de datos sobre la relación
de la música con los estudiantes de UTEC mediante gráficos y
descriptores, con la finalidad de identificar patrones entre las horas
que un estudiante escucha música y las variables del estudio (edad,
promedio, carrera, plataforma, etc.).
Realizar un análisis probabilístico sobre la relación de la música con los estudiantes de UTEC mediante las probabilidades empíricas, condicionales y las variables aleatorias discretas y continuas.

### OBJETIVOS ESPECÍFICOS

-   Utilizar distintos descriptores numéricos para entender la tendencia
    de cada variable del estudio, de los alumnos de UTEC encuestados,
    con el fin comprender la relación existente entre la música con el
    promedio, edad, etc.
-   Estudiar la cantidad de alumnos de UTEC que escuchan música mientras
    estudian, mediante gráficos estadísticos con la finalidad de
    determinar si mejoran su rendimiento cognitivo/académico. 
-   Determinar correctamente el espacio de resultados teóricos y las probabilidades empíricas de todos los eventos atómicos con la finalidad de estimar la probabilidad de un evento en función de la frecuencia relativa.
-   Encontrar dos pares de eventos dependientes e independientes y verificar usando la fórmula 
condicional para cada par de variables elegidos e interpretar correctamente los resultados obtenidos.
-   Estudiar a fondo dos variables discretas y dos variables continuas presentando evidencia numérica en función de sus datos

## CONTEXTO


Este estudio se lleva a cabo en UTEC. El objetivo principal es analizar si los estudiantes de ingeniería en UTEC escuchan música mientras estudian y su impacto en el desempeño académico. No se ha investigado específicamente este tema antes, por lo que este estudio busca llenar ese vacío y explorar las preferencias y comportamientos de los estudiantes en relación con la música durante el estudio. Se considerarán factores como género, carrera, tiempo dedicado a escuchar música y promedios de calificaciones. Los resultados, analizados mediante gráficos y descriptores numéricos, pueden tener implicaciones en la enseñanza y el desarrollo de entornos de estudio óptimos. Además, este estudio puede servir como punto de partida para futuras investigaciones en la relación música-rendimiento académico en UTEC.

**DATOS**

 - RECOLECCIÓN DE DATOS

Para obtener los datos, realizamos un cuestionario virtual con preguntas predefinidas en equipo. Este método es accesible y viable para el público, dado que la tecnología actualmente está ampliamente disponible. Nos permite organizar la información de cada persona que responde, ahorrando tiempo. Posteriormente, encuestamos a nuestro público objetivo, distribuyéndonos entre los miembros del equipo. Utilizamos un QR para facilitar el acceso a la encuesta y alcanzar el número mínimo de encuestados requerido.


- POBLACIÓN MUESTRA Y MUESTREO


Nuestra población de estudio son estudiantes de UTEC de 17 a 25 años. Utilizamos muestreo aleatorio simple para seleccionar encuestados al azar, pero nos centramos en nuestra población objetivo. Además, el tamaño de la muestra debe ser mayor a 150 encuestados.


- VARIABLES

| Variable                                  | Tipo y rango típico asumido                 |
|-----------------------------------|-------------------------------------|
| Género                                    | Cualitativa Nominal                         |
| Carrera                                   | Cualitativa Nominal                         |
| Música con estudio                        | Cualitativa Nominal                         |
| Preferencia musical                       | Cualitativa Nominal                         |
| Plataformas                               | Cualitativa Nominal                         |
| ¿Por qué escuchas música? (Motivo)        | Cualitativa Nominal                         |
| ¿Por qué no escuchas música? (Sin motivo) | Cualitativa Nominal                         |
| Horarios                                  | Cualitativa Nominal                         |
| Edad                                      | Cuantitativa Discreta (17 - 26 años)        |
| Horas de música (Tiempo)                  | Cuantitativa Continua (2 a 5 horas diarias) |
| Promedio de notas                         | Cuantitativa Continua (11 a 20 de nota)     |

```{r}
DATOS <- read_csv("ProyectoGrupo13Encuesta1.csv")
```

```{r}
NuevosDatos <- DATOS[,-c(1,2,3,8,11,12,13,14,20)]
```


- LIMPIEZA DE DATOS

      ELIMINAR LAS OBSERVACIONES INNECESARIAS

Se escoge a manera de filtro la primera variable 'Edad', puesto que hay

observaciones completamente vacías

```{r}
NuevosDatos <- NuevosDatos[!is.na(NuevosDatos$'Edad:'),]
```

      RENOMBRAR LOS N/A

Nos referimos con renombrar los N/A a llenar las respuestas que no fueron completadas por los participantes de la encuesta debido a que por la configuración de la encuesta al marcar que no, no se les abría la pestaña con dichas preguntas.

```{r}
NuevosDatos$`Género preferido` <- ifelse(is.na(NuevosDatos$`Género preferido`),"NO EXISTE",NuevosDatos$`Género preferido`)

NuevosDatos$`¿Por qué escuchas música?` <- ifelse(is.na(NuevosDatos$`¿Por qué escuchas música?`),"No escucho música",NuevosDatos$`¿Por qué escuchas música?`)

NuevosDatos$`Plataforma en la que escuchas música:` <- ifelse(is.na(NuevosDatos$`Plataforma en la que escuchas música:` ),"NINGUNA",NuevosDatos$`Plataforma en la que escuchas música:` )

NuevosDatos$`¿Por qué no escuchas música?` <- ifelse(is.na(NuevosDatos$`¿Por qué no escuchas música?`),"Si escucho música", NuevosDatos$`¿Por qué no escuchas música?`)

NuevosDatos$`¿Cuánto tiempo escuchas música? Al día.` <- ifelse(is.na(NuevosDatos$`¿Cuánto tiempo escuchas música? Al día.`),0,NuevosDatos$`¿Cuánto tiempo escuchas música? Al día.`)

NuevosDatos$`¿En qué horarios sueles escuchar música?` <- ifelse(is.na(NuevosDatos$`¿En qué horarios sueles escuchar música?` ),"No suelo escuchar música",NuevosDatos$`¿En qué horarios sueles escuchar música?` )

NuevosDatos$`¿Cuánto es el promedio de tus evaluaciones en el último semestre académico? (Ejemplo: 18, 18.66, 13.12.)` <- ifelse(is.na(NuevosDatos$`¿Cuánto es el promedio de tus evaluaciones en el último semestre académico? (Ejemplo: 18, 18.66, 13.12.)`),0,NuevosDatos$`¿Cuánto es el promedio de tus evaluaciones en el último semestre académico? (Ejemplo: 18, 18.66, 13.12.)`)
```

      CAMBIAMOS EL TIEMPO DE SEGUNDOS A HORAS

```{r}
NuevosDatos$`¿Cuánto tiempo escuchas música? Al día.` <- round(NuevosDatos$`¿Cuánto tiempo escuchas música? Al día.`/3600,2)
```

      CAMBIAMOS LOS NOMBBRES

Cambios los nombres de nuestras variables para que sean más cortos y

fáciles de identificar en nuestra tabla.

```{r}
NuevosDatos %>% rename( Edad = 'Edad:' , Género = 'Género:' , 'Preferencia musical' = 'Género preferido', Motivo = '¿Por qué escuchas música?' , Plataformas = 'Plataforma en la que escuchas música:', "Sin motivo" = '¿Por qué no escuchas música?', 'Música con estudio' = '¿Escuchas música cuando estudias?' , Tiempo = '¿Cuánto tiempo escuchas música? Al día.' , Horarios = '¿En qué horarios sueles escuchar música?' , Promedios = '¿Cuánto es el promedio de tus evaluaciones en el último semestre académico? (Ejemplo: 18, 18.66, 13.12.)' ) -> NuevosDatos
```



# [ANÁLISIS DESCRIPTIVO]{style="color:darkred"}:

## VARIABLE GÉNERO 

```{r}
modaGénero <- mfv(NuevosDatos$Género)

tablaGénero <- data.frame(Moda = c(modaGénero))

tablaGénero

ggplot(data=NuevosDatos) +

geom_bar(position="stack" ,aes(Género), colour = "green", fill = "green") + theme_light() + labs(title = "Gráfica sobre los géneros")
```
- En el primer cuadrante se muestra como moda "Masculino" en la variable género.
- En el segundo cuadrante se observa un gráfico de barras dividido en tres secciones (femenino, masculino y prefiero no decirlo), siendo la sección con mayor elección en masculino. Este análisis nos ayudará en nuestro estudio, debido a que algunos estudios mencionan que las mejoras académicas relacionadas con la música dependían del género del estudiante.

## VARIABLE CARRERA 

```{r}
modaCarrera <- mfv(NuevosDatos$Carrera)

tablaCarrera <- data.frame(Moda = c(modaCarrera))

tablaCarrera

ggplot(data=NuevosDatos) +

geom_bar(position="identity" ,aes(Carrera), colour = "#B0E2FF", fill = "orange") + theme_light() + labs(title = "Gráfica Carrera") + coord_flip()


```
- En el primer cuadrante se muestra como moda "INGENIERÍA INDUSTRIAL" en la variable "Carrera".
- En el segundo cuadrante se observa un gráfico de barras para la variable "Carrera" nos ayudará a comprender visualmente cuál es la proporción existente de estudiantes que escuchan música mientras estudian, por carreras universitarias.

## VARIABLE "MÚSICA CON ESTUDIO" 

```{r}
modaMusicaconestudio <- mfv(NuevosDatos$`Música con estudio`)

tablaMusicaconestudio <- data.frame(Moda = c(modaMusicaconestudio))

tablaMusicaconestudio

NuevosDatos$`Música con estudio` <- factor(NuevosDatos$`Música con estudio`, levels = c("Sí", "No"), labels = c("Sí", "No"))

ggplot(NuevosDatos, aes(x = `Música con estudio`, fill = `Música con estudio`)) +

geom_bar(position = "dodge") +

xlab("Estudia Música") +

ylab("Frecuencia")
```
- En el primer cuadrante se muestra como moda "Sí" en la variable "Música con estudio.
- En el segundo cuadrante se observa un gráfico de barras, donde podremos ver completamente la relación existente entre la frecuencia de estudiantes de UTEC que estudia escuchando música (por cualquier motivo) y los estudiantes que no escuchan música. De esta forma, podremos contrastar con investigaciones realizadas, que la música resulta ser un factor común en las horas de estudio de los jóvenes estudiantes.


## VARIABLE PREFERENCIA MÚSICAL 

```{r}
modaPreferenciamusical<- mfv(NuevosDatos$`Preferencia musical`)

tablaPreferenciamusical <- data.frame( Moda = c(modaPreferenciamusical))

tablaPreferenciamusical

ggplot(NuevosDatos) +

geom_bar(position="identity" ,aes(`Preferencia musical`), colour = "black", fill = "pink") + theme_light() + labs(title = "Gráfica de género musical preferida") + coord_flip()
```
- En el primer cuadrante se muestra como moda el género pop en la variable "Preferencia música".
- En el segundo cuadrante se observa un gráfico de barras sobre los diferentes géneros musicales por las cuales los estudiantes prefieren.


## VARIABLE PLATAFORMAS

```{r}
modaPlataformas<- mfv(NuevosDatos$Plataformas)

tablaPlataformas <- data.frame( Moda = c(modaPlataformas))

tablaPlataformas

ggplot(NuevosDatos) +

geom_bar(position="identity" ,aes(Plataformas), colour = "black", fill = "#7B68EE") + theme_light() + labs(title = "Gráfica de plataformas ") + coord_flip()
```
- En el primer cuadrante se muestra como moda la plataforma spotify en la variable "Plataformas".
- En el segundo cuadrante se observa un gráfico de barras sobre los diferentes plataformas de escuchar por las cuales los estudiantes prefieren.


## VARIABLE "¿POR QUÉ ESCUCHAS MÚSICA? (MOTIVO)" 

```{r}
modaMotivo<- mfv(NuevosDatos$Motivo)

tablaMotivo <- data.frame( Moda = c(modaMotivo))

tablaMotivo

ggplot(NuevosDatos) +

geom_bar(position="identity" ,aes(Motivo), colour = "brown", fill = "brown") + theme_light() + labs(title = "Gráfica género") + coord_flip()
```
- En el primer cuadrante se muestra como moda "Para liberar mi estrés" en la variable "¿Por qué escuchas música (motivo)".
- En el segundo cuadrante se observa un gráfico de barras sobre las razones por las cuales los estudiantes escuchan música. Nos ayudará a entender el comportamiento que tienen. El estrés, la concentración, el sueño o la imaginación, pueden ser algunas de las razones encontradas en este útil gráfico de barras.

## VARIABLE "¿POR QUÉ NO ESCUCHAS MÚSICA?" 

```{r}
prueba<- (NuevosDatos$`Sin motivo`)
prueba <- subset (prueba, prueba != "Si escucho música")
modaSinMotivo<- mfv((prueba))
tablaSinMotivo <- data.frame( Moda = c(modaSinMotivo))
tablaSinMotivo
```
- Se muestra la moda de los estudiantes encuestados al responder "¿Por qué no
escuchas música?" es porque les distrae mientras estudian.

## VARIABLE HORARIOS 

```{r}
modaHorarios<- mfv(NuevosDatos$Horarios)
tablaHorarios <- data.frame( Moda = c(modaHorarios))
tablaHorarios
```

- Con este análisis, podemos notar que de los 203 encuestados que
respondieron que sí, tienen una moda de escuchar todo el día música.

## VARIABLE EDAD  

```{r}
meanEdad <- mean(NuevosDatos$Edad )

medianaEdad <- median(NuevosDatos$Edad )

modaEdad <- mfv(NuevosDatos$Edad )

rangoEdad <- range(NuevosDatos$Edad)

sdEdad <- sd(NuevosDatos$Edad )

iqrEdad<- IQR(NuevosDatos$Edad )

varEdad <- var(NuevosDatos$Edad )

tablaEdad <- data.frame(Promedio = c(meanEdad), Mediana = c(medianaEdad), Moda = c(modaEdad), DesviacionEstandar = c(sdEdad), RangoIntercuartil = c(iqrEdad), Variacion = c(varEdad), Rango =c(rangoEdad))

tablaEdad

plot(NuevosDatos$Edad) #dispersión

boxplot(NuevosDatos$Edad)

stripchart(NuevosDatos, method = "jitter", pch = 19, add = TRUE, col = "blue", vertical = T)
```


Este diagrama de dispersión unidimensional nos ayuda a comprender la cantidad de estudiantes en rangos de edad típicos. Con el diagrama de cajas, se observa la mediana, los valores extremos y los atípicos de la variable "Edad" de los estudiantes.

## VARIABLE "HORAS DE MÚSICA" 

```{r}
meanTiempo <- mean(NuevosDatos$Tiempo )

medianaTiempo<- median(NuevosDatos$Tiempo )

modaTiempo <- mfv(NuevosDatos$Tiempo )

rangoTiempo <- range(NuevosDatos$Tiempo)

sdTiempo <- sd(NuevosDatos$Tiempo )

iqrTiempo <- IQR(NuevosDatos$Tiempo )

varTiempo <- var(NuevosDatos$Tiempo )

tablaTiempo <- data.frame(Promedio = c(meanTiempo), Mediana = c(medianaTiempo), Moda = c(modaTiempo), DesviacionEstandar = c(sdTiempo), RangoIntercuartil = c(iqrTiempo), Variacion = c(varTiempo), Rango =c(rangoTiempo))

tablaTiempo

plot(NuevosDatos$Tiempo)

boxplot(NuevosDatos$Tiempo)

stripchart(NuevosDatos, method = "jitter", pch = 19, add = TRUE, col = "black", vertical = T)
```

Este diagrama de dispersión unidimensional podrá ser de ayuda para
observar la tendencia y responder preguntas como "¿Cuántas horas
escuchan música los estudiantes de UTEC?", y al igual que la variable
cuantitativa Edad, en el diagrama de cajas podemos visualizar la mediana
de las horas con música.

## VARIABLE PROMEDIO DE NOTAS 

```{r}
meanPromedios <- mean(NuevosDatos$Promedios )

medianaPromedios<- median(NuevosDatos$Promedios)

modaPromedios <- mfv(NuevosDatos$Promedios )

rangoPromedios <- range(NuevosDatos$Promedios)

sdPromedios <- sd(NuevosDatos$Promedios )

iqrPromedios <- IQR(NuevosDatos$Promedios )

varPromedios <- var(NuevosDatos$Promedios )

tablaPromedio <- data.frame(Promedio = c(meanPromedios), Mediana = c(medianaPromedios), Moda = c(modaPromedios), DesviacionEstandar = c(sdPromedios), RangoIntercuartil = c(iqrPromedios), Variacion = c(varPromedios), rango=c(rangoPromedios))
tablaPromedio
plot(NuevosDatos$Promedios, xlab = "Frecuencia",
     ylab = "Promedio", 
     col = "red") #dispersión

boxplot(NuevosDatos$Promedios)
```

Del diagrama, se observa el promedio de los estudiantes encuestados y su tendencia hacia notas aprobatorias al escuchar música. El diagrama de bigotes muestra pocos valores atípicos, lo que sugiere que los estudiantes, en relación con la música, mantienen un buen desempeño académico junto con una mediana nota aprobatoria.

## ANALIZAMOS ENTRE DOS VARIABLES

### PROMEDIOS Y TIEMPO

```{r}


plot(NuevosDatos$Tiempo, NuevosDatos$Promedios,  pch=23, lwd=2, bg="green", cex=1.5, col="purple", main = "Diagrama de dispersión de Promedios ~ Tiempo")

Correlacion = cor(NuevosDatos$Tiempo, NuevosDatos$Promedios)
Correlacion
```

Del gráfico, se puede inferir que los alumnos de UTEC tienen tendencia a tener promedios altos cuando escuchan música durante 0-5 horas. Sin embargo, para promedios de escucha superiores a 5 horas, se observa que hay una cantidad menor de alumnos con promedios similares pero altos.


# [ANÁLISIS PROBABILÍSTICOS]{style="color:darkred"}:

En esta sección se comparara los valores de la muestra con los  modelos teóricos  y determinar si estos datos se cumplen, para ello se debe determinar una serie de descriptores  de manera empírica.

## EVENTOS

## PROBABILIDADES EMPÍRICAS

### VARIABLE TIEMPO 

Esta variable es importante porque indica el tiempo que pasan los estudiantes escuchando música, y como esta influye en sus estudios.

- Calcular el espacio muestral (valores únicos en la variable "TIEMPO")

```{r}
espacio_muestral <- unique(NuevosDatos$Tiempo)
```

- Contar la frecuencia de cada valor único en la variable "TIEMPO"

```{r}
frecuencias <- table(NuevosDatos$Tiempo)
```

- Calcular la probabilidad empírica de cada evento atómico

```{r}
probabilidades_empiricas <- prop.table(frecuencias)
```


- Imprimir el espacio muestral y las probabilidades empíricas para cada evento

```{r}
cat("Espacio muestral:", espacio_muestral, "\n\n")
for (i in 1:length(probabilidades_empiricas)) {
  evento <- names(probabilidades_empiricas)[i]
  probabilidad <- probabilidades_empiricas[i]
  cat("Evento:", evento, "- Probabilidad empírica:", probabilidad, "\n")
}

```


EJEMPLO:

"Tras el análisis de la variable 'Tiempo' en nuestra base de datos de
música y estudio,se llego a lo siguiente: La probabilidad empírica de
que los estudiantes escuchen 1 hora al día e 0.05940594 , lo que indica
que aproximadamente el 5,9% de las personas en la muestra escuchan en
ese tiempo.

- Agrupar los conjuntos en eventos más pequeños

El código toma un conjunto de datos representado por el espacio muestral y las probabilidades empíricas, lo agrupa en rangos y calcula la suma de las probabilidades empíricas para cada rango. Esto permite analizar y resumir la distribución de las probabilidades en función de los rangos del espacio muestral.

```{r}
# Espacio muestral y probabilidades empíricas
espacio_muestral <- c(0, 5, 1, 6, 2, 4, 1.5, 11.58, 3, 2.75, 6.5, 3.5, 2.5, 2.33, 4.5, 22.98, 23, 1.75, 7, 8, 10, 9, 2.08, 12, 2.23, 6.1, 16, 1.33, 17, 12.23, 5.13, 15, 5.5, 3.17, 20, 2.58, 2.25)
probabilidades_empiricas <- c(0.1732673, 0.05940594, 0.004950495, 0.00990099, 0.004950495, 0.08415842, 0.004950495, 0.004950495, 0.004950495, 0.004950495, 0.03960396, 0.004950495, 0.004950495, 0.004950495, 0.0990099, 0.004950495, 0.01980198, 0.1287129, 0.02970297, 0.08910891, 0.004950495, 0.00990099, 0.05445545, 0.004950495, 0.004950495, 0.00990099, 0.02970297, 0.004950495, 0.01980198, 0.004950495, 0.03465347, 0.004950495, 0.004950495, 0.004950495, 0.00990099, 0.004950495, 0.004950495, 0.004950495, 0.00990099)

# Asegurar que ambos vectores tengan la misma longitud
n <- min(length(espacio_muestral), length(probabilidades_empiricas))
espacio_muestral <- espacio_muestral[1:n]
probabilidades_empiricas <- probabilidades_empiricas[1:n]

# Crear data frame
data <- data.frame(espacio_muestral, probabilidades_empiricas)

# Agrupar en rangos y calcular la suma de las probabilidades empíricas
rangos <- cut(data$espacio_muestral, breaks = c(0, 5, 10, 15, 20, 25))
resultado <- aggregate(probabilidades_empiricas ~ rangos, data, sum)

# Imprimir resultado
print(resultado)
```


### VARIABLE PROMEDIO 
Esta variable es importante porque indica el promedio de los estudiantes al escuchar música.

- Calcular el espacio muestral (valores únicos en la variable "promedio")

```{r}
espacio_muestral <- unique(NuevosDatos$Promedios)
```

- Contar la frecuencia de cada valor único en la variable "PROMEDIO"

```{r}
frecuencias<- table(NuevosDatos$Promedios)
```

- Calcular la probabilidad empírica de cada evento atómico

```{r}
probabilidades_empiricas<- prop.table(frecuencias)
```

- Imprimir el espacio muestral sus probabilidades empíricas de cada evento

```{r}
cat("Espacio muestral:", espacio_muestral, "\n\n")
for (i in 1:length(probabilidades_empiricas)) {
  evento <- names(probabilidades_empiricas)[i]
  probabilidad <- probabilidades_empiricas[i]
  cat("Evento:", evento, "- Probabilidad empírica:", probabilidad, "\n")
}
```

EJEMPLO: Tras el análisis de la variable 'Promedio' en nuestra base de datos de música y estudio, se obtuvo lo siguiente: La probabilidad empírica de tener un promedio de 15.5 es 0.00990099, lo que representa aproximadamente el 9,9% de las personas en la muestra con ese promedio de notas.

Agrupar eventos
El código separa eventos en cuatro vectores según su valor numérico y calcula la probabilidad empírica. El espacio muestral es un vector de 80 elementos. Se separa en los vectores a, b, c y d según su valor numérico. La probabilidad empírica se calcula dividiendo la longitud de cada vector por la longitud del espacio muestral. Por último, se imprimen los eventos y las probabilidades empíricas.

```{r}
# Datos del espacio muestral
espacio_muestral <- c(0, 16, 14.32, 17, 18, 15, 13.68, 15.86, 17.5, 14, 10, 12, 14.5, 14.69, 16.9, 14.7, 16.46, 16.78, 11.5, 17.62, 17.3, 18.15, 16.8, 15.89, 18.06, 15.7, 15.28, 13, 13.56, 12.33, 17.1, 13.75, 15.24, 15.75, 15.5, 17.35, 14.33, 14.9, 15.82, 11.9, 19.5, 11.63, 20, 1, 14.02, 16.4, 16.1, 15.46, 17.77, 14.56, 17.6, 15.6, 14.8, 13.07, 14.25, 17.2, 16.5, 14.87, 16.55, 13.5, 11, 17.4, 15.67, 13.66, 14.86, 13.87, 16.63, 15.35, 14.84, 16.3, 17.7, 15.72, 19, 13.41, 18.32, 13.7, 14.82, 15.84, 17.31)

# Separar en vectores
a <- espacio_muestral[espacio_muestral >= 0 & espacio_muestral <= 5]
b <- espacio_muestral[espacio_muestral >= 5.1 & espacio_muestral <= 10]
c <- espacio_muestral[espacio_muestral >= 10.1 & espacio_muestral <= 15]
d <- espacio_muestral[espacio_muestral >= 15.1 & espacio_muestral <= 20]

# Calcular probabilidades empíricas
prob_a <- length(a)/length(espacio_muestral)
prob_b <- length(b)/length(espacio_muestral)
prob_c <- length(c)/length(espacio_muestral)
prob_d <- length(d)/length(espacio_muestral)

# Imprimir eventos y probabilidades empíricas
print(paste("Evento: 0-5 - Probabilidad empírica:", prob_a))
print(paste("Evento: 5.1-10 - Probabilidad empírica:", prob_b))
print(paste("Evento: 10.1-15 - Probabilidad empírica:", prob_c))
print(paste("Evento: 15.1-20 - Probabilidad empírica:", prob_d))
```


### VARIABLE HORARIO 
Esta variable es importante porque indica el horario
que pasan los estudiantes escuchando música, y como esta influye en sus
estudios.

- Calcular el espacio muestral (valores únicos en la variable "HORARIOS")

```{r}
espacio_muestral <- unique(NuevosDatos$Horarios)
```

- Contar la frecuencia de cada valor único en la variable "HORARIO"

```{r}
frecuencias <- table(NuevosDatos$Horarios)
```

- Calcular la probabilidad empírica de cada evento atómico

```{r}
probabilidades_empiricas <- prop.table(frecuencias)
```

- Imprimir el espacio muestral y las probabilidades empíricaS para cada evento

```{r}
cat("Espacio muestral:", espacio_muestral, "\n\n")
for (i in 1:length(probabilidades_empiricas)) {
  evento <- names(probabilidades_empiricas)[i]
  probabilidad <- probabilidades_empiricas[i]
  cat("Evento:", evento, "- Probabilidad empírica:", probabilidad, "\n")
}

```


EJEMPLO: "Tras el análisis de la variable 'Horario' en nuestra base de
datos de música y estudio,se llego a lo siguiente: La probabilidad
empírica de que los estudiantes escuchen música de 1:00 pm - 6:00 pm
(Por la tarde)es 0.004950495 , lo que indica que aproximadamente el 0,5%
de las personas en la muestra escuchan música en ese horario.

- AGRUPAR LOS EVENTOS EN 3 VECTORES

El código separa eventos en tres vectores (mañana, tarde y noche) según su horario y calcula la probabilidad empírica en cada momento. Se crean vectores para cada momento usando los valores de tiempo del espacio muestral. Los eventos se asignan a cada vector con la función c(). La probabilidad empírica se calcula con length() e intersect(). Se imprimen las probabilidades empíricas con cat().

```{r}
# Crear vectores para cada momento del día
manana <- c(7:12)
tarde <- c(1:6)
noche <- c(6:9, 9:24)

# Asignar los eventos a cada vector
eventos_manana <- c(14.33, 17.5, 14, 10, 12, 14.5, 11.5, 15.82, 11, 13.41, 14.82, 15.84)
eventos_tarde <- c(14.02, 16.9, 14.7, 14.69, 14.87, 15.35, 13.87, 15.5, 13.07, 15.24, 15.6, 14.8, 13.66, 13.56, 15.72, 16.55, 14.25, 16.46, 15.46, 16.4, 15.67, 14.56, 15.75, 15.28, 16.63, 15.46)
eventos_noche <- c(16.78, 17.62, 17.3, 18.15, 16.8, 15.89, 18.06, 15.7, 19.5, 20, 17.77, 17.6, 17.4, 19, 18.32, 17.2, 17.1, 17.35, 15.86, 15, 15.82, 15.84, 16, 16.9, 16.1, 16.46, 16.55, 16.3, 17.7, 18, 15.7, 15.72)

# Calcular la probabilidad empírica de cada evento
prob_manana <- length(intersect(eventos_manana, manana)) / length(eventos_manana)
prob_tarde <- length(intersect(eventos_tarde, tarde)) / length(eventos_tarde)
prob_noche <- length(intersect(eventos_noche, noche)) / length(eventos_noche)

# Imprimir las probabilidades empíricas
cat("Probabilidad empírica en la mañana:", prob_manana, "\n")
cat("Probabilidad empírica en la tarde:", prob_tarde, "\n")
cat("Probabilidad empírica en la noche:", prob_noche, "\n")
```



## PROBABILIDAD CONDICIONAL

1.- Probabilidad de que un estudiante tenga promedio mayor a 15 y este escuche música al estudiar

-   **Eventos dependientes**

**Seleccionando nuestros eventos**

*Evento 1: Seleccionar un estudiante que estudie con música*

*Evento 2: Seleccionar un estudiante que tenga promedio mayor a 15*

```{r}
Total<-nrow(NuevosDatos[,8])

#primero hallamos la probabilidad de que un estudiante sí escuche música al estudiar
Cantsi<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="Sí"))
Proba_si<-Cantsi/Total


#sacando la probabilidad de que un estudiante no escuche música al estudiar
Cantno<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="No"))
Proba_no<-Cantno/Total

```

```{r}
Total2<-nrow(NuevosDatos[,11])
#Ahora buscamos la probabilidad de que un estudiante que escuche música al estudiar tenga promedio mayor a 15.

Prob_1<-nrow(filter(NuevosDatos,NuevosDatos$Promedios>15))/Total2

#Ahora buscamos la probabilidad de que un estudiante que no escuche música al estudiar tenga promedio mayor a 15.
Prob_2<-nrow(filter(NuevosDatos,NuevosDatos$Promedios<15))/Total2

```

**Validamos la independencia**

$$P(A ∩ B) = P(A)P(B)$$

```{r}
P1<-Proba_si*Prob_1
P1
```

Después de haber aplicado la fórmula podemos ver que estos eventos dependen entre sí por ende para la probabilidad condicional debemos aplicar la siguiente fórmula.

**Probabilidad condicional**

$$P(A|B) =P(A ∩ B) /P(B)$$

```{r}
PA<-P1/Prob_1
PA
```

2.- Probabilidad de que al seleccionar un estudiante si escuche música al estudiar si es hombre

-   **Eventos independientes**

**Seleccionando nuestros eventos**

*Evento 1: Seleccionar un estudiante que sea hombre*

*Evento 2: Seleccionar un estudiante que sí escuche música al estudiar*

```{r}
TOTAL2<-nrow(NuevosDatos[,2])

#Sacando la probabilidad de seleccionar a una mujer
Cant_m<-nrow(filter(NuevosDatos,NuevosDatos$Género=="Femenino"))
Proba_m<-Cant_m/TOTAL2

#Sacando la probabilidad de seleccionar a un hombre
Cant_h<-nrow(filter(NuevosDatos,NuevosDatos$Género=="Masculino"))
Proba_h<-Cant_h/TOTAL2

```

```{r}
TOTAL3<-nrow(NuevosDatos[,8])

#Ahora buscamos la probabilidad de que si escuche música al estudiar
Prob_3<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="Sí"))/TOTAL3

#Ahora buscamos la probabilidad de que no escuche música al estudiar
Prob_4<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="No"))/TOTAL3

```

**Validando la independencia**

$$P(A ∩ B) = P(A)P(B)$$

```{r}
P2<-Proba_h*Prob_3
P2
```

Después de haber aplicado la fórmula podemos ver que estos eventos no dependen entre sí por ende para la probabilidad condicional debemos aplicar la siguiente fórmula.

**Probabilidad condicional**

$$
 P(B|A) = P(A|B)P(B) / P(A)
$$

```{r}
PB<-Proba_h*Prob_3+Proba_h*Prob_4
PB
```

3.- Probabilidad de que al seleccionar un estudiante si escuche música al estudiar si es mujer

-   **Eventos independientes**

**Seleccionando nuestros eventos**

*Evento 1: Seleccionar un estudiante que sea hombre o mujer*

*Evento 2: Seleccionar un estudiante que no escuche música al estudiar*

```{r}
TOTAL2<-nrow(NuevosDatos[,2])

#Sacando la probabilidad de seleccionar a una mujer
Cant_m2<-nrow(filter(NuevosDatos,NuevosDatos$Género=="Femenino"))
Proba_m2<-Cant_m2/TOTAL2

#Sacando la probabilidad de seleccionar a un hombre
Cant_h2<-nrow(filter(NuevosDatos,NuevosDatos$Género=="Masculino"))
Proba_h2<-Cant_h2/TOTAL2

```

```{r}
TOTAL3<-nrow(NuevosDatos[,8])

#Ahora buscamos la probabilidad de que no escuche música al estudiar
Prob_5<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="No"))/TOTAL3

#Ahora buscamos la probabilidad de que no escuche música al estudiar 
Prob_6<-nrow(filter(NuevosDatos,NuevosDatos$`Música con estudio`=="No"))/TOTAL3


```

**Validando la independencia**
$$P(A ∩ B) = P(A)P(B)$$

```{r}
P3<-Proba_m2*Prob_5
P3
```

Después de haber aplicado la fórmula podemos ver que estos eventos no dependen entre sí por ende para la probabilidad condicional debemos aplicar la siguiente fórmula.

**Probabilidad condicional**
$$
 P(B|A) = P(A|B)P(B) / P(A)
$$

```{r}
PC<-Proba_m2*Prob_5+Proba_h2*Prob_6
PC
```

## VARIABLES DISCRETAS

#### DISTRIBUCIÓN DE PROBABILIDADES PARA VARIABLES DISCRETAS

El análisis de las distribuciones de probabilidades para variables aleatorias discretas es importante en nuestro estudio para comprender y modelar fenómenos aleatorios. Veremos las distribuciones de Bernoulli, binomial, binomial negativa, geométrica e hipergeométrica. Cada una tiene características propias y se aplica en situaciones específicas considerando sustituciones y el número de ensayos, éxitos y fracasos. Propondremos eventos y problemas para demostrar estas distribuciones y sus aplicaciones.

### Binomial

Representa la probabilidad de conseguir "x" éxitos en "n" ensayos de
Bernoulli independientes. Cada ensayo solo posee dos posibilidades:
éxito y fracaso. El éxito está representado por "p" y de fracaso por
"q".

*Variable Promedio:*

**Evento 1:**

Al finalizar el semestre 2022-2, la Oficina de Seguimiento Estudiantil
de la universidad, publicó datos estadísticos sobre el promedio
ponderado de los estudiantes de UTEC en los últimos años. Se obtuvo que
los estudiantes tenían entre 14 y 17 de promedio ponderado por ciclo
académico. ¿Cuál es la probabilidad que los estudiantes de UTEC sigan
manteniendo ese rango?

Debemos determinar: P(Rango de promedio ponderado común)

```{r}

promediociclo <- filter(NuevosDatos, Promedios >= 14 & Promedios <= 17)


probponderado <- round(nrow(promediociclo)/nrow(NuevosDatos), 2) 
```

```{r}
probponderado
```

En contraste, la probabilidad de que los alumnos no mantengan ese
promedio ponderado se puede calcular como 1 - P.

```{r}
1 - probponderado
```

Graficar ambos casos (éxito y fracaso):

```{r}
TablapromediosUTEC <- ifelse(NuevosDatos$Promedios <= 17 &  NuevosDatos$Promedios >= 14 , "Dentro del rango", "Fuera del rango")
barplot(prop.table(table(TablapromediosUTEC)), xlab = "Promedio ponderado esperado", ylab = "Probabilidad", col = c("blue", "green"))
```

**Problema 1:**

¿Qué tan probable es encontrar a 98 estudiantes que tengan un promedio
ponderado dentro de lo adecuado?

Variable Aleatoria X: Cantidad de estudiantes de UTEC que se encuentran
en el rango de promedio ponderado hallado por la Oficina de Seguimiento
Estudiantil, de un conjunto de 203 personas (muestreo).

Usamos el modelo binomial: $$X∼Bin(203,0.57)$$
y determinamos P(X=98)


```{r}

round(dbinom(x = 98, size = nrow(NuevosDatos), prob = probponderado),4)

```

*Interpretación:* Al escoger a 98 estudiantes, la probabilidad de éxito
para el rango de promedio ponderado adecuado es 0.0025.

**Problema 2:**

¿Cuál es la probabilidad de escoger a estudiantes del estudio y que por
lo menos más del 35% tengo un promedio ponderado adecuado según la
Oficina de Seguimiento Estudiantil?

Variable Aleatoria X: Cantidad de estudiantes que se encuentran en el
rango de promedio ponderado esperado de un conjunto de 203 personas
(muestreo).

Calculamos el 35% de la muestra total (203), y sobre esta aplicamos la
probabilidad de estar en el rango adecuado (0.57):

```{r}
Porcentaje<-0.35*(203)
Porcentaje
```

Planteamos el modelo binomial: 

$$𝑷(𝑿~ 71.05)$$

```{r}
pbinom(Porcentaje, size = 203, prob = 0.57, lower.tail = FALSE)

```

*Interpretación:* Al escoger a estudiantes que por lo menos más del 35%
de la muestra total se encuentre en el rango de promedio ponderado
esperado, se obtiene la probabilidad de éxito de 1. Es decir, bajo ese
porcentaje siempre se tendrá estudiantes dentro del rango esperado.

Graficando:

```{r}
barraspromedio<-colores <- c(rep("light green",125), 'red')
barplot(pbinom(0:207, size = nrow(NuevosDatos), prob = probponderado, lower.tail = FALSE), names.arg = c(0:207), main = "Función de masa acumulada de la variable X - 35% por lo menos de estudiantes en el rango esperado", ylab = "Probabilidad Acumulada", xlab = "Número de estudiantes", col = barraspromedio,
     cex.axis=0.8, cex.names=0.8, cex.lab=0.8, cex.main=0.8, space = FALSE)
abline(v = 62.1, lwd = 2, col = "red")


legend('topright',legend="Probabilidad acumulada del 35% de estudiantes que tengan un promedio adecuado",col="red",lwd=2,cex=0.4)
```

Del gráfico, vemos que la probabilidad acumulada de aproximadamente 95
estudiantes manejan un promedio adecuado, estando cerca al 100% (1), y
de ahí empieza el decrecimiento de la función.

### Geométrica

El modelo geométrico es una distribución de probabilidad que se basa en
los experimentos realizados por Bernoulli hasta alcanzar el éxito por
primera vez.

*Variable Horas de música:*

**Problema 1:**

\
Deseamos conocer la posibilidad de que un estudiante de UTEC de 18 años
escuche 4 horas de música al día mientras estudia. ¿Cuál es la
probabilidad que un estudiante cumpla estas condiciones después de 5
ensayos en una muestra de 203 estudiantes?\
Variables que intervienen:\
-Edad del estudiante\
Horas de música al día

```{r}
table(NuevosDatos$Edad,NuevosDatos$Tiempo)

```

```{r}
table(NuevosDatos$Edad)
```

```{r}
diecisieteaños4horas<-filter(NuevosDatos, Edad==18 & Tiempo==4.00 )

dim(diecisieteaños4horas)
```

Se tiene un total de 203 estudiantes de las cuales 7 tienen 18 años y
escuchan 4 horas al día de música, entonces podemos decir:

$$P(éxito)= 7/203 = 0.03448$$

$$P(fracaso) = 196/203 = 0.96552$$

Ahora, luego de 5 ensayos debemos tener a alguien de 18 años que escuche
4 horas de música diariamente.

*y= 4 estudiantes no cumplen los requisitos*\
Entonces, se pide lo siguiente: p(y=4) =?

```{r}
estudiantescumplen<-dgeom(4,0.03448)
estudiantescumplen
```

Expresando en porcentaje la probabilidad que sucede este suceso:

```{r}
Porcentaje2<-round(estudiantescumplen*100,2)
Porcentaje2
```

*Interpretación:* Se observa que la probabilidad que el quinto
estudiante encuestado sea el primero que tenga 18 años y escuche 4 horas
de música mientras estudia diariamente es igual a 3%.

**Problema 2:**

¿Cuántos estudiantes de 18 años en promedio se tienen que escoger del
estudio hasta conseguir por primera vez a uno que escuche 4 horas de
música diariamente mientras estudia?

Definimos X:

*X= Cantidad de estudiantes que escuchen 3 horas de música mientras
estudian al día.*\

Hallamos el esperado mediante el modelo geométrico, utilizaremos la
probabilidad de las dos condiciones dadas que ya hallamos en el anterior
problema planteado:

```{r}
E=1/0.03448
round(E)
```

*Interpretación:* La esperanza de encontrar a un estudiante de 18 años
que escuche música 4 horas al día mientras estudia del estudio por
primera vez es al intento 29. Es decir, el 29vo estudiante cumplirá
estas condiciones.

## VARIABLES CONTINUAS

En variables continuas respecto nuestra investigación, se utilizará la variable de "tiempo" y la de "promedios" de las encuestas hacia los estudiantes de la UTEC.

### VARIABLE TIEMPO

Con la variable "tiempo" para saber que tipo de variable continua es.Primero averiguamos mediante un histograma y con la curva de densidad, la cual nos demostrará si es normal, exponencial o otra .También, se graficará la línea de la normal y en donde se encuentra la media, para que nos ayude en esta elección. 


```{r}
#Histograma

hist(NuevosDatos$Tiempo, freq=FALSE, main="Histograma: Tiempo de música que escuchas al día", xlab= "Tiempo (horas)",ylab="Frecuencia", col="green", xlim = c(0,25),ylim = c(0,0.25), breaks = 19)

# Densidad
lines(density(NuevosDatos$Tiempo), lwd = 3, lty = 8 , col = 'red')

# Normal
curve(dnorm(x, mean(NuevosDatos$Tiempo), sd(NuevosDatos$Tiempo)), lwd = 2, col = "blue", add = T)

#Linea de la media
abline(v= mean(NuevosDatos$Tiempo),col= "#C71585",lwd=3)

#Legenda
legend("topright", c("curva normal", "curva de densidad","media" ),
        col = c("blue", "red","#C71585"), bty = "n", cex =0.9,lty = 1:2, lwd=3)


```
Se observa en nuestro histograma del tiempo en horas que existe la variable continua normal.Además, la media se encuentra en casi al medio de esa normal.Por ello, calculamos la esperanza , desviación estándar y la varianza.  

```{r}
# Esperanza aproximada a la media 
t_μx = mean(NuevosDatos$Tiempo)
t_μx


#Desviación estándar
t_σx = sd(NuevosDatos$Tiempo)
t_σx

#Varianza (t_σx)**2 
t_Vx<- t_σx**2
t_Vx
```

Para corroborar este análisis utilizamos probabilidades.

**PROBABILIDADES**

1.- ¿Cuál es la probabilidad de escoger un estudiante de UTEC al azar y
que el estudiante escuche música al día a lo máximo 8 horas?

```{r}
pnorm(8,t_μx,t_σx )
```

2.- ¿Cuál es la probabilidad de escoger un estudiante de UTEC al azar y
que el estudiante escuche música al día a lo menos 10 horas?

```{r}
1- pnorm(10,t_μx,t_σx )
```

3.- ¿Cuál es la probabilidad de que los estudiantes de UTEC escuchen a
lo menos 18 horas y a lo mas 20 horas al día?

```{r}
pnorm(20,t_μx,t_σx ) - pnorm(18,t_μx,t_σx ) 
```

4.- ¿ Cuál es la probabilidad que un estudiante de UTEC escogido al azar
escuche menor a las 3 horas al día ?

```{r}
pnorm(3,t_μx,t_σx)
```

### VARIABLE PROMEDIO


Con la variable "promedio" para saber que tipo de variable continua es. Primero averiguamos mediante un histograma y con la curva de densidad, la cual nos demostrará si es normal, exponencial o otra .También, se graficará la línea de la normal y en donde se encuentra la media, para que nos ayude en esta elección. 

```{r}

#Histograma

hist(NuevosDatos$Promedios, freq=FALSE, main="Histograma: Promedios de los alumnos de UTEC", xlab= " Notas",ylab="Frecuencia", col="green", xlim = c(0,20),ylim = c(0,0.3), breaks = 19)

# Densidad
lines(density(NuevosDatos$Promedios), lwd = 3, lty = 8 , col = 'red')

# Normal
curve(dnorm(x, mean(NuevosDatos$Promedios), sd(NuevosDatos$Promedios)), lwd = 2, col = "blue", add = T)

#Linea de la media

abline(v= mean(NuevosDatos$Promedios),col= "#C71585",lwd=3)

#Legenda
legend("topright", c("curva normal", "curva de densidad","media" ),
        col = c("blue", "red","#C71585"), bty = "n", cex =0.9,lty = 1:2, lwd=3)
```

En el histograma se muestra la frecuencia de los promedios de los estudiantes de UTEC en un rango de notas del 0 al 20. Se observa la curva normal (azul), la curva de densidad (roja) y la media (morada). Analizamos si la variable es una distribución normal utilizando la media y la forma de campana en la curva de densidad dentro de ese intervalo. Para ello, calculamos la esperanza, desviación estándar y varianza.

```{r}
# Esperanza aproximada a la media 
p_μx = mean(NuevosDatos$Promedios)
p_μx


#Desviación estándar
p_σx = sd(NuevosDatos$Promedios)
p_σx

#Varianza (p_σx)**2 
p_Vx<- p_σx**2
p_Vx
```
Para corroborar este análisis lo verificamos con las probabilidades y así sabemos que tan probables son en salir un alumno al azar.

**PROBABILIDADES**

1.- ¿Cuál es la probabilidad de escoger un estudiante de UTEC al azar y
que el estudiante tenga por lo menos 16 en promedio?

```{r}
1 - pnorm(16,p_μx,p_σx )
```

2.- ¿Cuál es la probabilidad de escoger un estudiante de UTEC al azar y
que el estudiante tenga 19 a 20 en promedio?

```{r}
pnorm(20,p_μx,p_σx ) - pnorm(19,p_μx,p_σx)
```

3.- ¿Cuál es la probabilidad de escoger un estudiante de UTEC al azar y
que el estudiante tenga 13 promedio a lo máximo?

```{r}
pnorm(13,p_μx,p_σx )
```

# [CONCLUSIÓN FINAL]{style="color:darkred"}:

Luego de estudiar las probabilidades de algunos eventos y utilizar distintos modelos probabilísticos para entender cada variable del estudio, comprendimos que sí existe una relación entre las horas de música que escucha un estudiante de UTEC mientras estudia con el promedio, edad, y otras variables. Además el uso de  gráficos estadísticos nos ayudó a examinar de mejor manera estas probabilidades de éxito y fracaso de los evento propuestos. 

