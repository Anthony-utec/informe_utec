---
title: "HÁBITOS DE SUEÑO DE LOS ESTUDIANTES DE LA UTEC Y SU RELACIÓN CON EL RENDIMIENTO ACADÉMICO"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: readable
editor_options: 
  markdown: 
    wrap: 72
---

**Tema:** Hábitos de sueño de los estudiantes de la UTEC y su relación
con el rendimiento académico.

![](dormir.jpg)

# **Relevancia del estudio:**

<p style="text-align: justify;">

El descanso es un aspecto primordial en la vida de cualquier persona, y aún más para los estudiantes universitarios. La evidencia científica respalda la importancia de dormir lo suficiente, ya que permite llevar a cabo las actividades diarias de manera eficiente, controlar el estrés y la ansiedad, y fortalecer el sistema inmunológico. Sin embargo, muchos estudiantes descuidan su descanso debido a la creencia errónea de que no afecta su rendimiento académico. En realidad, la falta de sueño puede tener graves consecuencias en su desempeño académico. Por lo tanto, es crucial abordar este tema y examinar cuántos estudiantes son conscientes de la importancia de su bienestar y cómo la falta de descanso puede perjudicar su rendimiento académico.

</p>

## *Objetivos:*

<p style="text-align: justify;">

1.  Evaluar la prevalencia de los problemas de sueño en los estudiantes
    de la UTEC.

2.  Analizar si la cantidad de cursos que lleva un estudiante influye en
    las horas de sueño.

3.  Generar información sobre las preferencias y hábitos de descanso de
    los estudiantes de UTEC con el fin de promover la mejora de estos
    espacios.

    </p>

## *Contexto:*

<p style="text-align: justify;">

La creciente preocupación por la salud y el bienestar de los estudiantes universitarios ha destacado la importancia del sueño para el éxito académico. El sueño desempeña un papel crucial en el funcionamiento cognitivo, la concentración, la memoria y el estado de ánimo, factores clave en el rendimiento académico.
Al analizar los hábitos de sueño de los estudiantes de la UTEC, se obtiene información valiosa sobre la duración, calidad y patrones de sueño, así como posibles interrupciones. Esto brinda una comprensión más profunda de cómo estos factores se relacionan con el rendimiento académico de los estudiantes.
La investigación en esta área proporciona datos esenciales para desarrollar estrategias y programas de intervención que fomenten hábitos de sueño saludables entre los estudiantes universitarios. Al promover un mejor sueño, se mejora el bienestar general de los estudiantes y se potencia su éxito académico. Además, esta información puede ser utilizada por las instituciones educativas para implementar políticas y servicios que respalden un sueño adecuado y maximicen el rendimiento académico de los estudiantes.
</p>

# **Limpieza de base de datos**

## *Cargar los datos*

<p style="text-align: justify;">

Para cargar los datos utilizamos la librería 'readxl'. Asimismo llamamos
a la librería 'dplyr', para cambiar los nombres de las variables.

</p>

```{r}
library(ggplot2)
library(readr)
library(readxl)
library(dplyr)
library(dplyr)
library(stringr)
```

*Cargamos la base de datos y la asignamos a la tabla DF*

```{r}
DF<-read_csv("baselimpia.csv")
```

*Nombre de las variables presentes*

```{r}
names(DF)
```

# **Variable 'Espacios_de_descanso'**
Analizaremos la variable "Espacios_de_descanso" ya que forma parte de nuestro tercer objetivo, por lo que esta es de suma importancia en la investigación.
```{r}
moda_espaciosdescanso <- names(table(DF$Espacios_de_descanso))[which.max(table(DF$Espacios_de_descanso))]
moda_espaciosdescanso
```

```{r}

espacios <- c("Piso 11", "Piso 6", "No hay", "Biblioteca", "Comedor", "Salones vacíos", "Piso 1")
espacio_freq <- colSums(DF[, c("Piso11", "Piso6", "NoEspacio", "Biblioteca", "Comedor", "SalonVacio", "Piso1")])
par(mar = c(5, 10, 4, 2) + 0.1)
barplot(espacio_freq, main = "Lugares que los estudiantes consideran espacios de descanso", xlab = "Espacio de Descanso",cex.axis=0.8, ylab = "Frecuencia", col=rainbow(7), cex.names = 0.7, ylim=c(0,200), cex.main=0.8)
```

Con la gráfica proporcionada es posible observar las preferencias de
espacios de descanso en UTEC. Como es de esperar, el lugar con más
observaciones a favor es el piso 11, seguido de los salones vacíos. En
nuestra encuesta, también añadimos la opción "No hay" para observar la
proporción de estudiantes que considera que no existen espacios de
descanso en UTEC. Dado que nuestro estudio tuvo una muestra de 205
personas y que se aprecia un aproximado de 40 estudiantes que marcaron
esa opción, podemos decir que la proporción es 1 de cada 5 estudiantes.
A nuestro parecer, esta es una proporción alta. En adición, mediante la
variable de satisfacción con los espacios de descanso obtuvimos que la
gran mayoría se mantuvo neutro respecto a su nivel de conformidad con
los ya mencionados.

# **Probabilidad empírica**

## *Cant.Cursos*

La probabilidad empírica de un evento viene definida por el número de
veces que aparece ese evento con respecto al total de casos observados.

1.  Calcular cuántos valores distintos hay en la base de datos, de esa
    forma hallaremos el Espacio Muestral.

```{r}
DF$Cant.Cursos
```

```{r}
filter(DF,Cant.Cursos == 3)
filter(DF,Cant.Cursos == 4)
filter(DF,Cant.Cursos == 5)
filter(DF,Cant.Cursos == 6)
filter(DF,Cant.Cursos == 7)
filter(DF,Cant.Cursos == 8)
```

De nuestra base de 227 registros para la variable Cant.Cursos los
valores que toma son los siguientes:

Valor 3: 14 veces Valor 4: 15 veces Valor 5: 52 veces Valor 6: 99 veces
Valor 7: 41 veces Valor 8: 6 veces

2.Definimos los eventos: - ¿Cuál es la probabilidad de obtener al azar
un alumno que lleva 5 cursos de una muestra de 227 alumnos?

3.  La probabilidad de cada evento atómico se calcula de la siguiente
    manera:

Probabilidad del valor 3: 14/227 = 0.06 Probabilidad del valor 4: 15/227
= 0.07 Probabilidad del valor 5: 52/227 = 0.23 Probabilidad del valor 6:
99/227 = 0.44 Probabilidad del valor 7: 41/227 = 0.18 Probabilidad del
valor 8: 6/227= 0.03

Estas probabilidades representan la proporción de registros en la base
de datos que corresponden a cada valor específico en la columna
"Cant.Cursos".

Conclusión:

-   El 6% de 227 alumnos llevan 3 cursos.
-   El 7% de 227 alumnos llevan 4 cursos.
-   El 23% de 227 alumnos llevan 5 cursos.
-   El 44% de 227 alumnos llevan 6 cursos.
-   El 18% de 227 alumnos llevan 7 cursos.
-   El 3% de 227 alumnos llevan 8 cursos.

## *H.Sueño*

1.  Calcular cuántos valores distintos hay en la base de datos, de esa
    forma hallaremos el Espacio muestral

```{r}
DF$H.Sueño
```

```{r}
filter(DF,H.Sueño== 8.00)
filter(DF,H.Sueño == 5.30)
filter(DF,H.Sueño == 6.00)
filter(DF,H.Sueño == 6.30)
filter(DF,H.Sueño == 7.00)
filter(DF,H.Sueño== 4.30)
filter(DF,H.Sueño== 5.00)
filter(DF,H.Sueño == 7.30)
filter(DF,H.Sueño == 4.00)
filter(DF,H.Sueño== 2.30)
filter(DF,H.Sueño == 4.60)
filter(DF,H.Sueño== 7.15)
filter(DF,H.Sueño== 8.30)
filter(DF,H.Sueño == 6.10)
filter(DF,H.Sueño == 5.20)
filter(DF,H.Sueño == 3.00)
filter(DF,H.Sueño == 3.20)
filter(DF,H.Sueño== 10.00)
filter(DF,H.Sueño== 6.50)
filter(DF,H.Sueño == 2.00)
filter(DF,H.Sueño == 6.45)
filter(DF,H.Sueño == 9.00)
filter(DF,H.Sueño == 7.45)
filter(DF,H.Sueño== 15.00)
filter(DF,H.Sueño == 7.40)
filter(DF,H.Sueño== 5.45)
```

Agrupamos en intervalos:

```{r}
nointervalos <- 5   # Número de intervalos que se desea
amplitud <- 2.00 #valor mínimo
rangointervalos <- amplitud / nointervalos
rangointervalos
```

Agrupamos cada valor en intervalos para ello usamos paste:

```{r}
print(paste("Los valores de cada grupos van ..."," de ", rangointervalos, " en  ", rangointervalos, " a partir de :", min(DF$H.Sueño)))
```

Tabla de frecuencia de los datos agrupados:

```{r}
tabla.intervalos <- transform(table(cut(DF$H.Sueño, breaks = 5)))
tabla.intervalos
```

```{r}
plot(tabla.intervalos, main = "H.sueño en intervalos")
```

De nuestra base de 227 registros para la variable H.Sueño los valores
que toma en intervalos son los siguientes:

Valor [1.99, 3.6]: 5 veces Valor [3.6, 5.2]: 56 veces Valor [5.2, 6.8]:
77 veces Valor [6.8, 8.4]: 82 veces Valor [8.4, 10]: 6 veces

2.  La función de probabilidad para cada valor se calcula de la
    siguiente manera:

Probabilidad del valor [1.99, 3.6]: 5/227 = 0.02 Probabilidad del valor
[3.6, 5.2]: 56/227 = 0.25 Probabilidad del valor [5.2, 6.8]: 77/227 =
0.34 Probabilidad del valor [6.8, 8.4]: 82/227 = 0.36 Probabilidad del
valor [8.4, 10]: 6/227 = 0,03

Conclusiones: - La probabilidad de seleccionar un estudiante al azar que
duerma entre 1.99 a 3.6 horas en una muestra de 227 es de 2%. - La
probabilidad de seleccionar un estudiante al azar que duerma entre 3.6 a
5.2 horas en una muestra de 227 es de 25% - La probabilidad de
seleccionar un estudiante al azar que duerma entre 5.2 a 6.8 horas en
una muestra de 227 es de 34%. - La probabilidad de seleccionar un
estudiante al azar que duerma entre 6.8 a 8.4 horas en una muestra de
227 es de 36%. - La probabilidad de seleccionar un estudiante al azar
que duerma entre 8.4 a 10 horas en una muestra de 227 es de 3%.

# **Probabilidad condicional**

## *Evento Independiente*

Utilizamos la variable Horas de sueño y horas de estudio siendo ambas
continuas.

```{r}
# Filtrar los valores no faltantes (NA)
DF_filtered <- na.omit(DF)

# Calcular la correlación entre las variables filtradas
correlation <- cor(DF_filtered$H.Sueño, DF_filtered$Horas.de.estudio)
print(correlation)
```

```{r}
ggplot(DF,aes(x=DF$H.Sueño,y=DF$Horas.de.estudio)) + 
  geom_point(shape=1) + 
  labs(title="Gráfico 1: Comparación entre horas de sueño y horas de estudio",x="Horas de sueño",y="Horas de estudio") + theme_light() + 
  geom_abline(intercept=0, slope=1, col="red")
```

Al ser dos variables continuas, podemos utilizar la función cor para
saber el nivel de correlación que tienen estas dos variables.
Visualizamos un -0.0252 siendo una correlación negativa y menor a 1.
Sabiendo que la relación es muy baja podemos concluir que no hay una
relación directa. Y por lo tanto una mayor independencia.

Se cuenta la información de

-   Evento A: "Estudiante que duerma 4 horas cada día"
-   Evento B: "Un estudiante estudia menos de 15 horas semanales"

Teniendo la siguiente información:

-   La probabilidad de que un estudiante duerma 4 horas al día es 0.4
    (P(A)=0.4)

```{r}
# La probabilidad que un estudiante duerma 4 horas al día, sobre un promedio de 10 horas. Sería 4/10
dormir4 = 4/10
```

-   La probabilidad de que un estudiante estudie 15 horas semanales es
    0.6 (P(B)=0.6)

```{r}
Prob15semanales = 0.6
```

Sabemos que si estos eventos son independientes, entonces P(A∩B) =
P(A)\*P(B) Entonces, la probabilidad de que duerma 4 horas al día y
estudie 15 horas semanales es:

P(A∩B) = P(A)\* P(B)

```{r}
Phorasdormidasyestudiadas = Prob15semanales*dormir4
Phorasdormidasyestudiadas
```

Si calculamos las probabilidades condicionales:

P(A\|B) = P(A ∩ B) / P(B) = 0.24 / 0.6 = 0.4.

```{r}
ProbAtalqueB = Phorasdormidasyestudiadas/Prob15semanales
ProbAtalqueB
```

P(B\|A) = P(A ∩ B) / P(A) = 0.24 / 0.4 = 0.6.

```{r}
ProbBtalqueA = Phorasdormidasyestudiadas/dormir4
ProbBtalqueA
```

En este caso, ambas probabilidades condicionales son iguales a las
probabilidades individuales de los eventos A y B, respectivamente. Esto
indica que los eventos son independientes. Por lo tanto podemos decir
que no importa que tantas horas duermas, no influye en las horas de
estudio que repases esa misma semana.

## *Evento Dependiente*

Evento A: "El tiempo que te quedaste dormido en clase es mayor a 1
hora". Evento B: "Las horas que duermes en promedio son menores a 8".

Tenemos una muestra de 227 datos. - La probabilidad de que se quede
dormido en clase por más de una hora, según los datos proporcionados, es
de 84/227, lo cual es aproximadamente igual a 0.369.

```{r}
# Filtramos la cantidad de gente que se quedaron dormidos mas de una hora en clase
(filter(DF,DF$Cant.D.U>1))
# Podemos visualizar que tenemos 84 observaciones, por lo tanto, 84 estudiantes se quedaron dormidos más de una hora en clase.
Estudiantesdormidosmas1hr = 84
Total = 227
Probabilidad = Estudiantesdormidosmas1hr/Total
Probabilidad
```

La probabilidad de dormir 8 horas es de 18/227 (18 veces aparece en la
muestra de 227 datos), que es igual a 0.079.

```{r}
Probdormir8horas  = 18/227
Probdormir8horas
```

La probabilidad de dormir 5.30 horas es de 11/227, que es igual a 0.048

```{r}
Probdormir5horas  = 11/227
Probdormir5horas
```

La probabilidad de dormir 6 horas es de 45/227, que es igual a 0.198.

```{r}
Probdormir6horas  = 45/227
Probdormir6horas
```

La probabilidad de dormir 7 horas es de 44/227, que es igual a 0.193.

```{r}
Probdormir7horas  = 44/227
Probdormir7horas
```

La probabilidad de dormir 4 horas es de 7/227, que es igual a 0.0176.

```{r}
Probdormir4horas  = 4/227
Probdormir4horas
```

La probabilidad de dormir 2.30 horas es de 1/227, que es igual a 0.0044

```{r}
Probdormir2horas  = 1/227
Probdormir2horas
```

La probabilidad de que las horas que duermes en promedio sean menores a
8, según los datos proporcionados, es de 124/227, lo cual es
aproximadamente igual a 0.5418.

```{r}
Probb = Probdormir2horas+Probdormir4horas+Probdormir5horas+Probdormir6horas+Probdormir7horas+Probdormir8horas
Probb
```

Para verificar la dependencia de los eventos A y B, debemos calcular la
probabilidad conjunta P(A ∩ B) y compararla con el producto de las
probabilidades individuales P(A) \* P(B).

La probabilidad conjunta P(A ∩ B) se obtiene contando los casos en los
que se cumplan ambos eventos. De acuerdo con los valores proporcionados,
hay 11 casos en los que se quedaron dormidos en clase por más de una
hora y las horas de sueño son menores a 8.

Entonces, P(A ∩ B) = 11/227, que es aproximadamente igual a 0.048.

```{r}
Probconjunta = 11/227
```

El producto de las probabilidades individuales P(A) \* P(B) es
aproximadamente igual a 0.369 \* 0.542 = 0.203.

Como P(A ∩ B) ≠ P(A) \* P(B), podemos concluir que los eventos A y B son
dependientes.

Con esto podemos probar que siendo dependiente ambos sucesos, a los
chicos de la universidad UTEC. Cuando duermen menos de 8 horas, existe
una relación directamente proporcional para que se duerman en clase.

# **Variables discretas**

## *Cantidad de cursos*

1.  Distribución binomial y de la probabilidad: Analizaremos la variable
    "cantidad de cursos" en base a la distribución Binomial, para ello,
    en R utilizaremos la función dbinom.

Para realizar el experimento debemos conocer la probabilidad de cada
uno, entonces :

```{r,echo=FALSE}
table(DF$Cant.Cursos)
DFP<- table(DF$Cant.Cursos)/nrow(DF)
round(DFP,4)
```

+----------------+----------------------+------------------------+
| <span st       | <                    | <span style=           |
| y              | span style="color:#3 | "                      |
| le="color:#3F7 | F                    | c                      |
| 2              | 7281">*Probabilidad* | olor:#3F7281">*Unidad* |
| 81">*Opciones* |                      |                        |
+:==============:+:====================:+:======================:+
| *Nivel 1*      | 0                    | Probabilidad que se    |
|                |                      | escoja 1 curso         |
+----------------+----------------------+------------------------+
| *Nivel 2*      | 0                    | Probabilidad que se    |
|                |                      | escoja 2 curso         |
+----------------+----------------------+------------------------+
| *Nivel 3*      | 0.0617               | Probabilidad que se    |
|                |                      | escoja 3 curso         |
+----------------+----------------------+------------------------+
| *Nivel 4*      | 0.0661               | Probabilidad que se    |
|                |                      | escoja 4 curso         |
+----------------+----------------------+------------------------+
| *Nivel 5*      | 0.2291               | Probabilidad que se    |
|                |                      | escoja 5 curso         |
+----------------+----------------------+------------------------+
| *Nivel 6*      | 0.4361               | Probabilidad que se    |
|                |                      | escoja 6 curso         |
+----------------+----------------------+------------------------+
| *Nivel 7*      | 0.1806               | Probabilidad que se    |
|                |                      | escoja 7 curso         |
+----------------+----------------------+------------------------+
| *Nivel 8*      | 0.0264               | Probabilidad que se    |
|                |                      | escoja 8 curso         |
+----------------+----------------------+------------------------+

Densidad de la cantidad de cursos :

```{r}
μ <- mean(DF$Cant.Cursos)
σ <- sd(DF$Cant.Cursos)
x2 <- c(8, seq(1,1,length=8),1)
y2 <- c(8, dnorm(seq(1,1,length=8), mean = μ, sd = σ), 1)
curve(dnorm(x, mean = μ, sd = σ), from=0, to=8, ylab="",xlab = "",lwd = 1, main="Cantidad de cursos")
text(x = 7, y = 1, 'P(x < 10)' ,cex = 1)

```

Sabemos que la moda de la cantidad de cursos que escogieron los alumnos
es de 6, entonces para que nuestro estudio no tenga como resultado una
probabilidad tan pequeña escogeremos una muestra de de 80 alumnos del
total.

CASO I: ¿Cuál es la probabilidad de seleccionar a 80 alumnos y que estos
hayan llevado 6 cursos en el ciclo?

```{r}
# Cálculo de la probabilidad utilizando la distribución binomial

P6 <- dbinom(80 , nrow(DF),  sum(DF$Cant.Cursos == "6")/nrow(DF) )
P6
P6*100
P6
```

```{r}
n <- 80  # Número de ensayos
p <- P6  # Probabilidad de éxito

valor_esperado <- n * p

# Varianza
varianza <- n * p * (1 - p)

print(valor_esperado)
print(varianza)

```

Gráfica de nuestra función probabilidad binomial negativa

```{r,echo=FALSE}
plot(dnbinom(0:99 ,40,99/227),type="h",xlab="x",ylab="P(X=k)",main="Función de Probabilidad ")
```

Análisis Probabilístico:

El motivo de utilizar este modelo se debe a la aplicación de la teoría
de la distribución binomial negativa. En este caso, el objetivo es
obtener 40 de los 99 éxitos posibles en una muestra de 80 ensayos. La
probabilidad se calcula como un evento simple, dividiendo el número de
casos favorables (99) entre el número total de eventos posibles (227).

CASO II:

¿Cuál es la probabilidad de seleccionar a 30 alumnos y que este hayan
llevado 7 cursos en el ciclo?

```{r}

# Cálculo de la probabilidad utilizando la distribución binomial
P7 <- dbinom(30, nrow(DF),  sum(DF$Cant.Cursos == "7")/nrow(DF) )
P7
P7*100

```

Valor esperado (media): E(X) = n \* p Varianza: Var(X) = n \* p \* (1 -
p)

```{r}

n <- 30  # Número de ensayos
p <- P7  # Probabilidad de éxito

valor_esperado <- n * p

# Varianza
varianza <- n * p * (1 - p)

print(valor_esperado)
print(varianza)

```

Gráfica de nuestra función probabilidad binomial negativa

```{r,echo=FALSE}
plot(dnbinom(0:41 ,15,41/227),type="h",xlab="x",ylab="P(X=k)",main="Función de Probabilidad ")
```

Respuestas: - La probabilidad de tener a 80 alumnos del total de los
datos recogidos, mediante la distribución binomial es de : 0.00204 o
0.20463 %

-   La probabilidad de tener 30 alumnos del total de los datos
    recogidos, mediante la distribución binomial es de : 0.0111 o 1.111
    %

## *Calidad de sueño*

+----------------+----------------------+------------------------+
| <span st       | <                    | <span style=           |
| y              | span style="color:#3 | "                      |
| le="color:#3F7 | F                    | c                      |
| 2              | 7281">*Probabilidad* | olor:#3F7281">*Unidad* |
| 81">*Opciones* |                      |                        |
+:==============:+:====================:+:======================:+
| *Nivel 1*      | 0.0661               | Probabilidad que se    |
|                |                      | escoja el nivel 1      |
+----------------+----------------------+------------------------+
| *Nivel 2*      | 0.1630               | Probabilidad que se    |
|                |                      | escoja el nivel 2      |
+----------------+----------------------+------------------------+
| *Nivel 3*      | 0.4581               | Probabilidad que se    |
|                |                      | escoja el nivel 3      |
+----------------+----------------------+------------------------+
| *Nivel 4*      | 0.2203               | Probabilidad que se    |
|                |                      | escoja el nivel 4      |
+----------------+----------------------+------------------------+
| *Nivel 5*      | 0.0925               | Probabilidad que se    |
|                |                      | escoja el nivel 5      |
+----------------+----------------------+------------------------+

En este experimento, la muestra consiste en seleccionar únicamente 5
niveles de satisfacción (1, 2, 3, 4, 5), lo que representa un conjunto
finito. Por lo tanto, utilizaremos una distribución hipergeométrica para
analizar cuán probable es que los encuestados estén más satisfechos que
otros en cuanto a la calidad del sueño. La distribución hipergeométrica
nos permitirá determinar la probabilidad de obtener una muestra en la
que haya un mayor número de encuestados satisfechos en comparación con
los demás.

```{r,echo=FALSE}

table(DF$Calidad.de.sueño)
DFP<- table(DF$Calidad.de.sueño)/nrow(DF)
round(DFP,4)
```

Después de analizar los datos, se observa que de un total de 227
entrevistados, 104 de ellos seleccionaron el nivel de desempeño igual a
3. En este modelo probabilístico, nuestro objetivo es determinar la
probabilidad de que, en una muestra de 150 entrevistados, se encuentre
aproximadamente el 50% del número de entrevistados que eligieron la
opción 3. Además, buscaremos calcular el valor esperado de esta
probabilidad.

P(x = 104), k=75, p = 50/201

Gráfica de nuestra función probabilidad binomial negativa

```{r,echo=FALSE}
plot(dnbinom(0:104,75,104/227),type="h",xlab="x",ylab="P(X=k)",main="Función de Probabilidad ")
```

Análisis Probabilístico:

El motivo de utilizar este modelo se debe a la aplicación de la teoría
de la distribución binomial negativa. En este caso, el objetivo es
obtener 75 de los 104 éxitos posibles en una muestra de 150 ensayos. La
probabilidad se calcula como un evento simple, dividiendo el número de
casos favorables (104) entre el número total de eventos posibles (227).

CASO III: ¿Cuál es la probabilidad de que al agarrar una muestra al azar
de 50 personas encuestadas, a lo más 10 personas tengan un nivel de
satisfacción de 3 en la calidad de sueño, sabiendo que la población es
de 227 personas encuestadas?

Éxito: Que una persona encuestada tenga 3 como nivel de satisfacción en
la categoría de "calidad de sueño"

```{r}
table(DF$Calidad.de.sueño)
```

M= 104 (cantidad de alumnos que escogieron el nivel 3)

N = 227 (tamaño de la población)

n = 50 (tamaño de la muestra)

k = 104 (éxitos en la población)

x \<= 20 (personas de la muestra con 3 de satisfacción )

P(x ≤ 20)

N-M= 227-104 = 123

```{r}

cat('Probabilidad (phyper(x, M, N − M, n)):', phyper(20,104,123,50),'\n') 
cat('Valor esperado (E(X)= n*M/N):', 50*104/227,'\n')
cat('Varianza (V(X) = (n*M/N)(1 − M/N)(N-n)/(N-1)):', (50*(50/227))*(1-(50/227))*(227-50)/(227-1),'\n')
cat('Desviación estándar (D(x)=((n*M/N)(1 − M/N)(N-n)/(N-1))^0.5:', ((50*(50/227))*(1-(50/227))*(227-50)/(227-1))^0.5,'\n')

```

CASO IV: ¿Cuál es la probabilidad de que al agarrar una muestra al azar
de 45 personas encuestadas, 5 personas tengan un nivel de satisfacción
de 5 en la calidad de sueño, sabiendo que la población es de 227
personas encuestadas?

Distribución Hipergeometrica:

Éxito: Que una persona encuestada tengo 3 como nivel de satisfacción en
la modalidad híbrida

N = 227 (tamaño de la población)

n = 45 (tamaño de la muestra)

k = 21 (éxitos en la población)

P(x=\<5)

x = 5 (personas de la muestra con 3 de satisfacción)

```{r,echo=FALSE}

cat('Probabilidad (phyper(x, M, N − M, n)):', dhyper(x=5,m=21,n=206,k=45),'\n') 
cat('Valor esperado (E(X)= n*M/N):', 45*21/227,'\n')
cat('Varianza (V(X) = (n*M/N)(1 − M/N)(N-n)/(N-1)):', (45*(21/227))*(1-(21/227))*(227-45)/(227-1),'\n')
cat('Desviación estándar (D(x)=((n*M/N)(1 − M/N)(N-n)/(N-1))^0.5:', ((45*(21/227))*(1-(21/227))*(227-45)/(227-1))^0.5,'\n')

```

Respuestas:

-   La probabilidad de que a lo más 10 personas encuestadas de una
    muestra de 50 tengan un nivel de satisfacción de `3` en la calidad
    de sueño es de: `0.4293 o 42.93%`

-   La probabilidad de que a lo más 5 personas encuestadas de una
    muestra de 45 tengan un nivel de satisfacción de `5` en la calidad
    de sueño es de : `0.04504 o 4.504%`

Se puede ver que es mas propenso que al escoger una muestra de 50
personas encuestadas, como mucho 10 de dichas personas tendrán un alto
indice de probabilidad de bajo nivel de satisfacción con respecto a la
calidad de sueño .

Análisis Probabilístico:\* Finalmente se pudo comprobar que al escoger
una muestra es mas probable encontrar más personas que tengan un alto
nivel de "no satisfacción" con respecto a la calidad del sueño, que
encontrar personas que estén muy satisfechas.

Comparación de los niveles de satisfacción en ambos modelos:

De la comparación con respecto al nivel de satisfacción de los
estudiantes por la calidad de sueño, se puede observar que es más
propenso que al seguir encuestando a estudiantes, ellos respondan que
están menos satisfechos con aquella mientras más cursos lleven, por
ende, se puede intuir que prefieren sacrificar su calidad de sueño por
motivos de la responsabilidad de la cantidad de cursos .

# **Variables continuas**

Trabajaremos con las variables "Promedio" y "horas.de.estudio":

## *Promedio*

Lo primero que haremos es identificar esta variable a través de un
histograma:

```{r}
# Eliminar filas con valores faltantes en la variable "Promedio"
DF_clean <- na.omit(DF$Promedio)

# Cálculo de la mediana y el promedio
median_value <- median(DF_clean)
mean_value <- mean(DF_clean)

# Gráfico de histograma y curva de densidad para la variable "Promedio"
hist(DF_clean, breaks = "FD", probability = TRUE, col = "lightblue", xlab = "Promedio", main = "Distribución de Promedio")
lines(density(DF_clean), col = "red", lwd = 2)

# Agregar mediana y promedio al gráfico
abline(v = median_value, col = "blue", lwd = 2, lty = 2)
abline(v = mean_value, col = "green", lwd = 2, lty = 2)
legend("topright", legend = c(paste0("Mediana = ", median_value), paste0("Promedio = ", mean_value)), col = c("blue", "green"), lwd = 2, lty = 2)

```
Se ha generado un gráfico que muestra el histograma y la curva de densidad de la variable "promedio". Esta representación gráfica nos permite visualizar la distribución de manera clara. Al combinar el histograma con la curva de densidad, podemos reducir las fluctuaciones y variaciones en la representación de los datos. En el gráfico, se puede observar la distribución de la variable promedio después de eliminar los valores faltantes.

Las líneas verticales de color azul representan la mediana, que es de 14.92, mientras que las líneas verdes representan el promedio, que es de 14.9780844660194. La mediana y el promedio están muy cerca y se encuentran en el centro de la distribución. Esto sugiere que la distribución es simétrica y no hay una gran diferencia entre estos valores. Por lo tanto, tanto la mediana como el promedio son medidas de tendencia central similares y representan el valor central típico de los datos.La considermamos una normal.


Validar la normal
```{r}
medtd <- mean(DF$Promedio, na.rm = TRUE)
meditd <- median(DF$Promedio, na.rm = TRUE)

print(medtd)
print(meditd)
```

```{r}
utd <- mean(DF$Promedio, na.rm = TRUE)
desvtd <- sd(DF$Promedio, na.rm = TRUE)
print(utd)
print(desvtd)
```

```{r}
# Calculamos la varianza
vartd <- var(DF$Promedio, na.rm = TRUE)
print(vartd)
vartd2 <- sum((DF$Promedio - medtd)^2, na.rm = TRUE) / (length(DF$Promedio) - sum(is.na(DF$Promedio)))
print(vartd2)
```

Podemos observar que son prácticamente lo mismo

```{r}
# Calculamos la varianza
vartd <- var(DF$Promedio, na.rm = TRUE)
print(vartd)

# Calculamos la esperanza
espetd <- mean(DF$Promedio, na.rm = TRUE)
print(espetd)

```

Tal que: X \~ N(14.98, 2.71)

Ejemplo: ¿Cuál es la probabilidad de que un estudiante seleccionado al
azar de la UTEC duerma más de 9 horas al día, basándonos en los datos
del estudio que muestra un promedio de 14.98 horas y una desviación
estándar de 2.71 horas en una muestra de 227 estudiantes de los ciclos 3
y 4?

```{r}
# Parámetros
promedio <- 14.98
desviacion <- 2.71
umbral <- 9

# Cálculo de la probabilidad P(X > 9) utilizando la función de distribución acumulativa (pnorm) y complementando con 1
probabilidad <- 1 - pnorm(umbral, mean = promedio, sd = desviacion)
print(probabilidad)
```

## *Horas.de.estudio*

```{r}
# Eliminar filas con valores faltantes en la variable "Horas.de.estudio"
DF_clean <- na.omit(DF$Horas.de.estudio)

# Cálculo de la mediana y el promedio
median_value <- median(DF_clean)
mean_value <- mean(DF_clean)

# Gráfico de histograma y curva de densidad para la variable "Horas.de.estudio"
hist(DF_clean, breaks = "FD", probability = TRUE, col = "lightblue", xlab = "Horas de estudio", main = "Distribución de Horas de estudio")
lines(density(DF_clean), col = "red", lwd = 2)

abline(v = median_value, col = "blue", lwd = 2, lty = 2)
abline(v = mean_value, col = "green", lwd = 2, lty = 2)
legend("topright", legend = c(paste0("Mediana = ", median_value), paste0("Promedio = ", mean_value)), col = c("blue", "green"), lwd = 2, lty = 2)

```

Se observa una distribución de las horas de estudio, representada por el histograma y la curva de densidad. La mediana, representada por la línea azul, es de 7.3, mientras que el promedio, representado por la línea verde, es de 8.975. Aunque ambas líneas están cercanas entre sí, no se puede afirmar con certeza que la distribución sea simétrica, ya que los valores no son tan cercanos ni iguales. En este caso, se puede observar una diferencia significativa entre la mediana y el promedio, lo que indica que la distribución está sesgada hacia la derecha. Esto se confirma cuando la mediana es menor que el promedio. Ambas medidas representan el valor central típico de las horas de estudio.
Pero, consideraremos la gráfica como una normal, para así poder seguir con los
pasos dados para variables continuas.

```{r}
medtd <- mean(DF$Horas.de.estudio, na.rm = TRUE)
meditd <- median(DF$Horas.de.estudio, na.rm = TRUE)

print(medtd)
print(meditd)
```

```{r}
utd <- mean(DF$Horas.de.estudio, na.rm = TRUE)
desvtd <- sd(DF$Horas.de.estudio, na.rm = TRUE)
print(utd)
print(desvtd)
```

```{r}
# Calculamos la varianza
vartd <- var(DF$Horas.de.estudio, na.rm = TRUE)
print(vartd)
vartd2 <- sum((DF$Horas.de.estudio - medtd)^2, na.rm = TRUE) / (length(DF$Horas.de.estudio) - sum(is.na(DF$Horas.de.estudio)))
print(vartd2)
```

```{r}
# Calculamos la varianza
vartd <- var(DF$Horas.de.estudio, na.rm = TRUE)
print(vartd)

# Calculamos la esperanza
espetd <- mean(DF$Horas.de.estudio, na.rm = TRUE)
print(espetd)
```

Tal que: X \~ N(8.98,40.75)

EJEMPLO: se está llevando a cabo un estudio sobre los hábitos de sueño
de los estudiantes y su relación con el rendimiento académico. La
universidad busca entender cómo los hábitos de sueño pueden afectar el
desempeño estudiantil.

Se recolectaron datos sobre los hábitos de sueño de una muestra de
estudiantes de la UTEC. El promedio aritmético del tiempo de sueño de la
muestra fue de 8.98 horas, con una desviación estándar de 40.75 horas.

La pregunta que nos interesa responder es: ¿Cuál es la probabilidad de
que un estudiante seleccionado al azar de la UTEC duerma más de X horas
al día?

```{r}
#Utilizando los datos proporcionados, podemos utilizar la distribución normal para calcular la probabilidad. Por ejemplo, si estamos interesados en calcular la probabilidad de que un estudiante duerma más de 10 horas al día, podemos utilizar el siguiente código en R:
promedio <- 8.98
desviacion <- 40.75
umbral <- 10

# Cálculo de la probabilidad P(X > X) utilizando la función de distribución acumulativa (pnorm) y complementando con 1
probabilidad <- 1 - pnorm(umbral, mean = promedio, sd = desviacion)
print(probabilidad)
```

# **Conclusiones**

-Tras los estudios realizados, se concluye que las horas que duerme un estudiante influyen en su rendimiento académico. Esto se demostró mediante análisis y evidencia empírica.

-Por otro lado, se concluye que las horas que un estudiante le dedica al estudio no tienen influencia en las horas que duerme. Esta conclusión se obtuvo a través del cálculo de probabilidades.

-Al analizar los gráficos, se observa que a medida que un estudiante lleva más cursos, sus horas de sueño disminuyen gradualmente. Sin embargo, no se puede afirmar que exista una influencia directa, ya que esto depende de otros factores distintos a la cantidad de cursos.

-Los estudios realizados indican que es más probable encontrar estudiantes insatisfechos con la calidad de su sueño que estudiantes satisfechos.

-Al analizar los gráficos y la información obtenida, se observa que hay una mayor cantidad de estudiantes que prefieren descansar en el piso 11. Además, se nota que existe una mayor cantidad de estudiantes que no se sienten satisfechos con los espacios de descanso.
```{r}
write_csv(DF, "baselimpia.csv")
```

