---
title: <center>"Estudio de la  Inteligencia emocional de los estudiantes de UTEC en relación a las notas obtenidas durante el semestre académico 2023-1."</center>
output: 
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: journal
---

# **INTRODUCCION: ** 

## **RELEVANCIA DEL ESTUDIO:**

La inteligencia, entendida como la capacidad de adquirir y aplicar conocimiento, ha sido estudiada como un factor esencial para el éxito en el ámbito profesional  y académico.Sin embargo, luego de la publicación de David Goleman “La inteligencia emocional” en 1995, la atención se dirigió gradualmente a otro elemento no intelectual relacionado con el comportamiento inteligente, la inteligencia emocional, manifestándose en pensamientos y acciones permisivas, una persona que se conoce a sí misma y se relaciona armónicamente con los demás.   
La inteligencia emocional nos permite ser conscientes de las emociones propias y ajenas, ser tolerante ante la presión y frustración dentro de cualquier ambiente laboral, destaca nuestra capacidad de trabajar en equipo y adoptar una actitud empática y social, lo que nos permite un mayor desarrollo personal. 

## **OBJETIVOS:**

### ***OBJETIVO GENERAL:***

Determinar si la inteligencia emocional infiere con las notas que obtienen los estudiantes de UTEC durante un semestre académico.  

### ***OBJETIVOS ESPECÍFICOS:***

1.	Analizar e Identificar  cualquier patrón o tendencia en los datos que sugiera una relación entre la inteligencia emocional y las notas obtenidas por los estudiantes de UTEC.
2.	Evaluar la fuerza de la relación entre la inteligencia emocional y las notas obtenidas mediante el uso de técnicas estadísticas apropiadas. 
3.	interpretar los resultados del análisis estadístico y determinar si hay suficiente evidencia para afirmar que la inteligencia emocional influye en las notas obtenidas por los estudiantes de UTEC.

## **CONTEXTO:**

No es necesario tener un conocimiento previo para poder entender el informe, únicamente tener nociones sobre lo que es la inteligencia emocional. 

# **DATOS:**

## **PROCESO DE RECOLECCION DE DATOS:**

Para el proceso de recolección de datos se utilizo uno un encuesta virtual, se compartió de manera presencial mediante códigos QR y redes sociales.

## **POBLACION,MUESTRA Y MUESTREO**

1. *Población:* Nuestra población son los alumnos de UTEC del ciclo 2023-1.
2. *Muestra:* El tamaño de la muestra es de 150 observaciones limpias sin datos faltantes, ni datos atipicos. 
3. *Muestreo:* Se utilizo un muestro aleatorio simple. 


### ***Carga de librerías y dataframe:***

```{r}

if (!require(readr)){install.packages("readr");library(readr)}
if (!require(dplyr)){install.packages("dplyr");library(dplyr)}
if (!require(ggplot2)){install.packages("ggplot2");library(ggplot2)}
if (!require(gridExtra)){install.packages("gridExtra");library(gridExtra)}

```
```{r}
DatosN <- read_csv("DatosN.csv")
```


# **ANALISIS DESCRIPTIVO**

## **variable Edad**

```{r}
moda_edad <- as.numeric(names(which.max(table(DatosN$Edad))))
mediana_edad <- median(DatosN$Edad)
media_edad <- mean(DatosN$Edad)
varianza_edad <- var(DatosN$Edad)
desviacion_estandar_edad <- sd(DatosN$Edad)
rango_edad <- max(DatosN$Edad) - min(DatosN$Edad)
intercuartil_edad <- IQR(DatosN$Edad)

moda_edad <- round(moda_edad, 2)
mediana_edad <- round(mediana_edad, 2)
media_edad <- round(media_edad, 2)
varianza_edad <- round(varianza_edad, 2)
desviacion_estandar_edad <- round(desviacion_estandar_edad, 2)
rango_edad <- round(rango_edad, 2)
intercuartil_edad <- round(intercuartil_edad, 2)

tabla <- data.frame(Estadística = c("Moda", "Mediana", "Media", "Varianza", "Desviación Estándar", "Rango", "Intercuartil"),
                    Valor = c(moda_edad, mediana_edad, media_edad, varianza_edad, desviacion_estandar_edad, rango_edad, intercuartil_edad))
print(tabla)
```

## **Variable Total de curso**

```{r}
moda_totalcurso <- as.numeric(names(which.max(table(DatosN$TotalCurso))))
mediana_totalcurso <- median(DatosN$TotalCurso)
media_totalcurso <- mean(DatosN$TotalCurso)
varianza_totalcurso <- var(DatosN$TotalCurso)
desviacion_estandar_totalcurso <- sd(DatosN$TotalCurso)
rango_totalcurso <- max(DatosN$TotalCurso) - min(DatosN$TotalCurso)
intercuartil_totalcurso <- IQR(DatosN$TotalCurso)

moda_totalcurso <- round(moda_totalcurso, 2)
mediana_totalcurso <- round(mediana_totalcurso, 2)
media_totalcurso <- round(media_totalcurso, 2)
varianza_totalcurso <- round(varianza_totalcurso, 2)
desviacion_estandar_totalcurso <- round(desviacion_estandar_totalcurso, 2)
rango_totalcurso <- round(rango_totalcurso, 2)
intercuartil_totalcurso <- round(intercuartil_totalcurso, 2)

tabla <- data.frame(Estadística = c("Moda", "Mediana", "Media", "Varianza", "Desviación Estándar", "Rango", "Intercuartil"),
                    Valor = c(moda_totalcurso, mediana_totalcurso, media_totalcurso, varianza_totalcurso, desviacion_estandar_totalcurso, rango_totalcurso, intercuartil_totalcurso))
print(tabla)
```
## **Variable Promedio Ciencias**
```{r}
moda_pciencias <- as.numeric(names(which.max(table(DatosN$PCiencias))))
mediana_pciencias <- median(DatosN$PCiencias)
media_pciencias <- mean(DatosN$PCiencias)
varianza_pciencias <- var(DatosN$PCiencias)
desviacion_estandar_pciencias <- sd(DatosN$PCiencias)
rango_pciencias <- max(DatosN$PCiencias) - min(DatosN$PCiencias)
intercuartil_pciencias <- IQR(DatosN$PCiencias)

moda_pciencias <- round(moda_pciencias, 2)
mediana_pciencias <- round(mediana_pciencias, 2)
media_pciencias <- round(media_pciencias, 2)
varianza_pciencias <- round(varianza_pciencias, 2)
desviacion_estandar_pciencias <- round(desviacion_estandar_pciencias, 2)
rango_pciencias <- round(rango_pciencias, 2)
intercuartil_pciencias <- round(intercuartil_pciencias, 2)

tabla <- data.frame(Estadística = c("Moda", "Mediana", "Media", "Varianza", "Desviación Estándar", "Rango", "Intercuartil"),
                    Valor = c(moda_pciencias, mediana_pciencias, media_pciencias, varianza_pciencias, desviacion_estandar_pciencias, rango_pciencias, intercuartil_pciencias))
print(tabla)
```
# **RELACIONES ENTRE VARIABLES**


## ***Relación entre las notas obtenidas por los estudiantes y su edad:***

Este gráfico muestra la relación entre las notas obtenidas por los estudiantes y su edad. 
```{r}
medias_pciencias_edad <- aggregate(DatosN$PCiencias, by = list(DatosN$Edad), FUN = mean)
colnames(medias_pciencias_edad) <- c("Edad", "MediaPCiencias")
media_general_pciencias <- mean(DatosN$PCiencias)
ggplot(medias_pciencias_edad, aes(x = Edad, y = MediaPCiencias)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = round(MediaPCiencias, 1)), vjust = -0.5) +
  geom_hline(yintercept = media_general_pciencias, linetype = "dashed", color = "red") +
  annotate("text", x = max(medias_pciencias_edad$Edad), y = media_general_pciencias, label = paste("Media general:", round(media_general_pciencias, 1)), hjust = 1.2) +
  labs(title = "Media de PCiencias por Edad", x = "Edad", y = "Media de PCiencias") +
  scale_y_continuous(name="Media de PCiencias", labels=scales::comma) +
  scale_x_continuous(name="Edad", breaks=seq(min(medias_pciencias_edad$Edad), max(medias_pciencias_edad$Edad), by=1)) +
  theme(plot.title=element_text(hjust=0.5)) +
  labs(caption="Fuente: DatosN")
```

## ***Relación entre la edad de los estudiantes y la cantidad de cursos que lleva en un semestre:***

Esta gráfica de barras que muestra la media de TotalCurso por edad. La línea punteada roja representa la media general de TotalCurso y las barras azules representan la media de TotalCurso para cada edad. La escala del eje "y" se ha ajustado para mostrar valores con comas y el eje "x" muestra las edades en incrementos de uno en uno. 
```{r}
medias_totalcurso_edad <- aggregate(DatosN$TotalCurso, by = list(DatosN$Edad), FUN = mean)
colnames(medias_totalcurso_edad) <- c("Edad", "MediaTotalCurso")
media_general_totalcurso <- mean(DatosN$TotalCurso)

ggplot(medias_totalcurso_edad, aes(x = Edad, y = MediaTotalCurso)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  geom_text(aes(label = round(MediaTotalCurso)), vjust = -0.5) +
  geom_hline(yintercept = media_general_totalcurso, linetype = "dashed", color = "red") +
  annotate("text", x = max(medias_totalcurso_edad$Edad), y = media_general_totalcurso, label = paste("Media general:", round(media_general_totalcurso)), hjust = 1.2) +
  labs(title = "Media de TotalCurso por Edad", x = "Edad", y = "Media de TotalCurso") +
  scale_y_continuous(name="Media de TotalCurso", labels=scales::comma) +
  scale_x_continuous(name="Edad", breaks=seq(min(medias_totalcurso_edad$Edad), max(medias_totalcurso_edad$Edad), by=1)) +
  theme(plot.title=element_text(hjust=0.5)) +
  labs(caption="Fuente: DatosN")
```

# **DESVIACION ESTANDAR**
```{r}
par(mfrow = c(1, 3))
boxplot(DatosN$Edad,
        main = " Edad",
        ylab = "Edad de los estudiantes",
        col = "blue",
        boxwex = 0.5,
        notch = TRUE,
        outline = FALSE)
points(DatosN$Edad, pch = 21, bg = "red")
abline(h = median(DatosN$Edad), lty = 2, col = "darkgray")
abline(h = quantile(DatosN$Edad, probs = c(0.25, 0.75)), lty = 3, col = "gray")
legend("topright", legend = c("Mediana", "Cuartiles", "Puntos de datos", paste("Desviación estándar:", round(sd(DatosN$Edad), 2))),
       lty = c(2, 3, NA, NA), pch = c(NA, NA, 21, NA), col = c("darkgray", "gray", "red", NA),
       pt.bg = c(NA, NA, "red", NA), bty = "n", cex=1.1)

boxplot(DatosN$TotalCurso,
        main = " TotalCurso ",
        ylab = "Cantidad de cursos",
        col = "blue",
        boxwex = 0.5,
        notch = TRUE,
        outline = FALSE)
points(DatosN$TotalCurso, pch = 21, bg = "red")
abline(h = median(DatosN$TotalCurso), lty = 2, col = "darkgray")
abline(h = quantile(DatosN$TotalCurso, probs = c(0.25, 0.75)), lty = 3, col = "gray")
legend("topright", legend = c("Mediana", "Cuartiles", "Puntos de datos", paste("Desviación estándar:", round(sd(DatosN$TotalCurso), 2))),
       lty = c(2, 3, NA, NA), pch = c(NA, NA, 21, NA), col = c("darkgray", "gray", "red", NA),
       pt.bg = c(NA, NA, "red", NA), bty = "n", cex=1.1)

boxplot(DatosN$PCiencias,
        main = " PCiencias",
        ylab = "Promedio de notas",
        col = "blue",
        boxwex = 0.5,
        notch = TRUE,
        outline = FALSE)
points(DatosN$PCiencias, pch = 21, bg = "red")
abline(h = median(DatosN$PCiencias), lty = 2, col = "darkgray")
abline(h = quantile(DatosN$PCiencias, probs = c(0.25, 0.75)), lty = 3, col = "gray")
legend("topright", legend = c("Mediana", "Cuartiles", "Puntos de datos", paste("Desviación estándar:", round(sd(DatosN$PCiencias), 2))),
       lty = c(2, 3, NA, NA), pch = c(NA, NA, 21, NA), col = c("darkgray", "gray", "red", NA),
       pt.bg = c(NA, NA, "red", NA), bty = "n", cex=1.1)
```


# **GRÁFICOS DE DISPERSIÓN PARA  VISUALIZAR LA RELACIÓN ENTRE LAS VARIABLES**
```{r}

p1 <- ggplot(DatosN, aes(x = Edad, y = TotalCurso)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_continuous(name = "Edad", breaks = seq(min(DatosN$Edad), max(DatosN$Edad), by = 5)) +
  scale_y_continuous(name = "TotalCurso", breaks = seq(min(DatosN$TotalCurso), max(DatosN$TotalCurso), by = 1)) +
  labs(title = "Relación entre Edad y TotalCurso") +
  theme(plot.title = element_text(hjust = 0.5))
p2 <- ggplot(DatosN, aes(x = Edad, y = PCiencias)) +
  geom_point(color = "red") +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_continuous(name = "Edad", breaks = seq(min(DatosN$Edad), max(DatosN$Edad), by = 5)) +
  scale_y_continuous(name = "PCiencias", breaks = seq(min(DatosN$PCiencias), max(DatosN$PCiencias), by = 5)) +
  labs(title = "Relación entre Edad y PCiencias") +
  theme(plot.title = element_text(hjust = 0.5))

p3 <- ggplot(DatosN, aes(x = TotalCurso, y = PCiencias)) +
  geom_point(color = "green") +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_continuous(name = "TotalCurso", breaks = seq(min(DatosN$TotalCurso), max(DatosN$TotalCurso), by = 5)) +
  scale_y_continuous(name = "PCiencias", breaks = seq(min(DatosN$PCiencias), max(DatosN$PCiencias), by = 5)) +
  labs(title = "Relación entre TotalCurso y PCiencias") +
  theme(plot.title = element_text(hjust = 0.5))
grid.arrange(p1, p2, p3, ncol=1)
```

# **RELACIONES MULTIVARIADAS**

## ***Relación atención, claridad y reparación con PCiencias y total de cursos***

```{r}
boxplot(DatosN$PCiencias~DatosN$Atencion*DatosN$TotalCurso,xlab = "Atención:TotalCurso", ylab = "PCiencias", las=3,cex.axis=0.44)
legend("topleft", legend = "Mediana", col = "black", lwd =4 )
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
boxplot(DatosN$PCiencias~DatosN$Claridad*DatosN$TotalCurso,xlab = "Claridad:TotalCurso", ylab = "PCiencias", las=3,cex.axis=0.44)
legend("topleft", legend = "Mediana", col = "black", lwd = 4)
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
boxplot(DatosN$PCiencias~DatosN$Reparacion*DatosN$TotalCurso,xlab = "Reparación:TotalCurso", ylab = "PCiencias", las=3,cex.axis=0.44)
legend("topleft", legend = "Mediana", col = "black", lwd = 4)
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
```

## ***Relación atención, claridad y reparación con PCiencias y sexo***

```{r}
boxplot(DatosN$PCiencias~DatosN$Atencion*DatosN$Sexo, xlab = "Atencion:Sexo", ylab = "PCiencias", las=0.5,cex.axis=0.55)
legend("topleft", legend = "Media", col = "black", lwd = 4)
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
boxplot(DatosN$PCiencias~DatosN$Claridad*DatosN$Sexo, xlab = "Claridad:Sexo", ylab = "PCiencias", las=0.5,cex.axis=0.55)
legend("topleft", legend = "Media", col = "black", lwd = 4)
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
boxplot(DatosN$PCiencias~DatosN$Reparacion*DatosN$Sexo, xlab = "Reparación:Sexo", ylab = "PCiencias", las=0.5,cex.axis=0.55)
legend("topleft", legend = "Media", col = "black", lwd = 4)
legend("topright", legend = "Valores Atípicos", pch = 1, col = "black", pt.bg = "white", cex = 1)
```

# **CONCLUSIONES** 

En general, la mayoría de los estudiantes llevan 6 cursos en promedio y el promedio de calificaciones tiene una relación positiva débil con el total de cursos, con una correlación de 0,24.

La inteligencia emocional se mide en tres aspectos: atención, claridad y reparación. Los chicos con más atención obtuvieron notas más altas, mientras que no hubo relación en las chicas. Las mujeres con excelente claridad no obtuvieron notas tan altas como se esperaba y no hubo relación en los hombres. No hubo relación en el aspecto de reparación en hombres ni mujeres.

Las mujeres tienen un mejor dominio en el aspecto de inteligencia emocional claridad y también en atención y recuperación.

No existe una estrecha relación entre las notas obtenidas y la inteligencia emocional en hombres ni mujeres, pero se puede observar alguna relación en algún aspecto de la inteligencia emocional. Se encontraron datos atípicos y relaciones inesperadas entre algunos aspectos de la I.E.

# **PROBABILIDAD EMPÍRICA**

## **Probabilidad empírica de la variable PCiencias**

Se analiza la distribución de las notas de los estudiantes en la asignatura de ciencias, utilizando la variable **PCiencias** que representa la nota promedio en dicha asignatura. Se clasifican las notas en tres intervalos: **A** (mayor o igual a 20), **B** (entre 11 y 15) y **C** (menor que 11). Se calcula la probabilidad empírica de cada intervalo como la frecuencia relativa de las notas que pertenecen a ese intervalo.

```{r}

limite_A <- 11
limite_B <- 15
limite_C <- 20


eventos <- ifelse(DatosN$PCiencias < limite_A, "C",
                  ifelse(DatosN$PCiencias < limite_B, "B", "A"))

frecuencias <- table(eventos)

probabilidades <- frecuencias / sum(frecuencias)
resultados <- data.frame(Evento = names(probabilidades),
                         Frecuencia = frecuencias,
                         Probabilidad = probabilidades)
print(resultados)
```
Se observa que el evento B tiene la mayor probabilidad, lo que indica que más de la mitad de los estudiantes obtienen notas entre 11 y 15 en la asignatura de ciencias. Esto puede deberse a varios factores. 

## **Probabilidad empírica de la variable TotalCurso**

se analiza la distribución de la cantidad de cursos que llevan los estudiantes utilizando la variable TotalCurso. Se clasifican las cantidades en tres intervalos: A (menos de 5 cursos), B (solo 6 cursos) y C (más de 7 cursos) y se calcula la probabilidad empírica de cada intervalo.

```{r}
evento_A <- sum(DatosN$TotalCurso <= 5)
evento_B <- sum(DatosN$TotalCurso == 6)
evento_C <- sum(DatosN$TotalCurso >= 7)
total_eventos <- evento_A + evento_B + evento_C
prob_A <- evento_A / total_eventos
prob_B <- evento_B / total_eventos
prob_C <- evento_C / total_eventos
tabla_probabilidades <- data.frame(Evento = c("Menos desde 5 cursos", "Solo 6 cursos", "Mas de hasta 7 cursos"),
                                   Cantidad = c(evento_A, evento_B, evento_C),
                                   Probabilidad = c(prob_A, prob_B, prob_C))
print(tabla_probabilidades)
print("El evento más probable es Solo 6 cursos con una probabilidad de 0.4533333.")
```


# **PROBABILIDAD CONDICIONAL**

Se analiza la relación entre el número de cursos, el promedio de ciencias, la edad y la claridad con la que entienden las clases. El objetivo es explorar la probabilidad de encontrar a un alumno mayor de edad con una claridad baja utilizando el concepto de probabilidad condicional y la regla de Bayes. También se evaluará la independencia entre los eventos utilizando el test de Chi-cuadrado.

## **Probabilidad 1**

Para este caso veremos cuál es la probabilidad de encontrar a un alumno mayor de edad con una Claridad Baja.

Se definen los siguientes eventos:

Evento A: Seleccionar a un alumno que lleve 7 cursos.

Evento B: Seleccionar a un alumno que tenga un promedio de ciencias en el intervalo A.

```{r}

limite_A <- 16
limite_B <- 20
evento_A <- DatosN$TotalCurso == 7
evento_B <- DatosN$PCiencias >= limite_A & DatosN$PCiencias <= limite_B

tabla_contingencia <- table(evento_A, evento_B)
resultado_test <- chisq.test(tabla_contingencia)

print(resultado_test)
print("El resultado del test de independencia de Chi-cuadrado indica que no hay suficiente evidencia para rechazar la hipótesis nula de independencia entre los eventos A y B. El valor p obtenido (0.2307) es mayor que un nivel de significancia típico de 0.05, lo que sugiere que los eventos A y B son independientes.")

```

## **Calculamos P(A ∩ B)**

En este apartado se analiza la probabilidad de que un alumno lleve 7 cursos y tenga un promedio de ciencias mayor a 15, usando los datos de la muestra. Se definen los siguientes eventos:

Evento C: Seleccionar a un alumno que lleve 7 cursos.

Evento D: Seleccionar a un alumno que tenga un promedio de ciencias mayor a 15.

Se calcula la probabilidad conjunta de estos eventos, es decir, la probabilidad de que ocurran ambos al mismo tiempo, usando la siguiente fórmula:

$P(C \cap D) = \frac{n(C \cap D)}{n}$

Donde n(C∩D) es el número de alumnos que cumplen con ambos eventos, y n es el número total de alumnos en la muestra. El resultado obtenido es:

```{r}
Prob_eventoAyProb_eventoB <- sum(DatosN$TotalCurso == 7 & DatosN$PCiencias>15)/150
Prob_eventoAyProb_eventoB
```
Luego, se calcula el producto de las probabilidades marginales de cada evento, usando la siguiente fórmula:

$P(C) \times P(D) = \frac{n(C)}{n} \times \frac{n(D)}{n}$

Donde n(C) es el número de alumnos que llevan 6 cursos, y n(D) es el número de alumnos que tienen un promedio de ciencias mayor a 15. El resultado obtenido es:

```{r}
Prob_eventoA <- sum(DatosN$TotalCurso == 7)/150
Prob_eventoB <- sum(DatosN$PCiencias>11)/150
Prob_eventoA*Prob_eventoB
```
Se observa que la probabilidad conjunta y el producto de las probabilidades marginales son diferentes, lo que implica que los eventos C y D no son independientes. 

Se calcula la probabilidad conjunta de que un alumno lleve 6 cursos y tenga un promedio de ciencias en el intervalo A.

Evento A: Seleccionar a un alumno que lleve 6 cursos.

Evento B: Seleccionar a un alumno que tenga un promedio de ciencias en el intervalo A.

Se utiliza la siguiente fórmula para calcular la probabilidad conjunta:

$P(A \cap B) = \frac{n(A \cap B)}{n}$

Donde n(A∩B) es el número de alumnos que cumplen con ambos eventos, y n es el número total de alumnos en la muestra. El resultado obtenido es:
```{r}

total_alumnos <- nrow(DatosN)


alumnos_evento_A <- DatosN$TotalCurso == 6


alumnos_evento_B <- DatosN$PCiencias >= 16 & DatosN$PCiencias <= 20


alumnos_eventos <- sum(alumnos_evento_A & alumnos_evento_B)


prob_conjunta <- alumnos_eventos / total_alumnos

print(prob_conjunta)
```

La probabilidad conjunta obtenida fue de 0.12, lo que significa que la probabilidad de seleccionar a un alumno que lleve 6 cursos y tenga un promedio de ciencias en el intervalo A es del 12%. Esto indica que hay una relación entre los dos eventos, ya que no son independientes.

# **PAR DE EVENTOS DEPENDIENTES: "REPARACIÓN" VS "PROMEDIO DE NOTAS DE CIENCIAS"**

se analiza la dependencia entre la variable “Reparación” y la variable “Promedio de Notas de Ciencias”.

Evento A: Seleccionar a un estudiante que tenga una reparación Adecuada o Excelente.

Evento B: Seleccionar a un estudiante que tenga una nota A (mayor a 15) en ciencias.

Se calcula la probabilidad marginal del evento A, usando la siguiente fórmula:

P(A)=P(A=Adecuada)+P(A=Excelente)

Donde P(A=Adecuada) es la proporción de estudiantes que tienen una reparación Adecuada, y P(A=Excelente) es la proporción de estudiantes que tienen una reparación Excelente.

## **Probabilidad de A**

P(A)=P(A=Adecuada)=número de estudiantes con reparación adecuada/total de estudiantes+P(A=Excelente)=número de estudiantes con reparación Excelente/total de estudiantes


```{r}
sum(DatosN$Reparacion == "Adecuada")
```

```{r}
sum(DatosN$Reparacion == "Excelente")
```
```{r}
sum(nrow(DatosN))
```
P(A)= 
```{r}
p_A <- (86/150)+(18/150)
p_A
```
La probabilidad marginal de A es 0.6933333, lo que significa que el 69.33% de los estudiantes tienen una reparación Adecuada o Excelente.

## **Probabilidad de B**

Se analiza la dependencia entre la variable “Reparación” y la variable “Promedio de Notas de Ciencias”, usando los datos de la muestra. Se definen los siguientes eventos:

Evento A: Seleccionar a un estudiante que tenga una reparación Adecuada o Excelente.

Evento B: Seleccionar a un estudiante que tenga una nota mayor a 14 en ciencias.

Se calcula la probabilidad marginal del evento B, usando la siguiente fórmula:

$P(B) = \frac{n(B)}{n}$

Donde n(B) es el número de estudiantes que tienen una nota mayor a 14 en ciencias, y n es el número total de estudiantes en la muestra. El resultado obtenido es:

```{r}
sum(DatosN$PCiencias>15)
```
```{r}
p_B <- (70/150)
p_B
```
La probabilidad marginal de B es 0.4667, lo que significa que el 46.67% de los estudiantes tienen una nota mayor a 14 en ciencias.

## **Probabilidad de hallar A y B**

P(A ∩ B) = número de estudiantes que tengan Reparación adecuada o excelente y una nota aprobatoria mayor a 14

Se calcula la probabilidad conjunta de A y B, usando la siguiente fórmula:

$P(A \cap B) = \frac{n(A \cap B)}{n}$

Donde n(A∩B) es el número de estudiantes que tienen una reparación Adecuada o Excelente y una nota mayor a 14 en ciencias. 

```{r}
sum(DatosN$Reparacion %in% c("Adecuada","Excelente") & DatosN$PCiencias>14)/150
```
```{r}
p_ayb <- 46/150
p_ayb
```
La probabilidad conjunta de A y B es 0.3067, lo que significa que la probabilidad de seleccionar a un estudiante que cumpla ambos eventos (tenga una reparación Adecuada o Excelente y una nota mayor a 14 en ciencias) es del 30.67%.

Se calcula el producto de las probabilidades marginales de A y B, usando la siguiente fórmula:

$P(A) \times P(B) = \frac{n(A)}{n} \times \frac{n(B)}{n}$

Donde n(A) es el número de estudiantes que tienen una reparación Adecuada o Excelente, y n(B) es el número de estudiantes que tienen una nota mayor a 14 en ciencias. El resultado obtenido es:

```{r}
p_A*p_B
```
El producto de las probabilidades marginales de A y B es 0.3235556, lo que significa que si los eventos fueran independientes, la probabilidad conjunta sería del 32.36%.

Se observa que la probabilidad conjunta y el producto de las probabilidades marginales son diferentes. Esto implica que los eventos A y B no son independientes, ya que el producto entre sus probabilidades no es igual a su probabilidad conjunta.

Se calcula la probabilidad condicional de A dado B:

$P(A|B) = \frac{P(A \cap B)}{P(B)}$

```{r}

prob_condicional <- p_ayb / p_B

print(prob_condicional)

```

La probabilidad condicional de A dado B es 0.6571, lo que significa que el 65.71% de los estudiantes que tienen una nota mayor a 14 en ciencias tienen una reparación Adecuada o Excelente. Esto indica que la reparación (capacidad de regular los estados emocionales de forma adecuada) de los estudiantes está relacionada con su promedio de notas. Además, el hecho de tener un total de cursos igual a 7 no tendría ninguna influencia sobre la probabilidad de que el promedio de nota sea mayor a 11, y viceversa.

# **PAR DE EVENTOS INDEPENDIENTES: "TOTAL DE CURSOS" VS " NOTA"**

En este apartado se analiza la independencia entre la variable “Total de cursos” y la variable “Promedio de Notas de Ciencias”, usando los datos de la muestra. Se definen los siguientes eventos:

Evento C: Seleccionar a un estudiante que tenga un total de cursos igual a 7.

Evento D: Seleccionar a un estudiante que tenga un promedio de nota mayor a 11.

## **calculo de la probabilidad marginal del evento C**

$P(C) = \frac{n(C)}{n}$

Donde n(C) es el número de estudiantes que tienen un total de cursos igual a 7, y n es el número total de estudiantes en la muestra. El resultado obtenido es:
```{r}
Prob_eventoC <- sum(DatosN$TotalCurso==7)/150
print(Prob_eventoC)
```
La probabilidad marginal de C es 0.2533333, lo que significa que el 25% de los estudiantes tienen un total de cursos igual a 7.

## **calculo de la probabilidad marginal del evento D**

$P(D) = \frac{n(D)}{n}$

Donde n(D) es el número de estudiantes que tienen un promedio de nota mayor a 11, y n es el número total de estudiantes en la muestra:

```{r}
Prob_eventoD <- sum(DatosN$PCiencias > 11)/150
print(Prob_eventoD)
```
La probabilidad marginal de D es 0.92, lo que significa que el 92% de los estudiantes tienen un promedio de nota mayor a 11.

## **calcuo de la probabilidad conjunta de C y D**

$P(C \cap D) = \frac{n(C \cap D)}{n}$

Donde n(C∩D) es el número de estudiantes que tienen un total de cursos igual a 7 y un promedio de nota mayor a 11. El resultado obtenido es:
```{r}
Prob_eventoCyProb_eventoD <- sum(DatosN$TotalCurso == 7 & DatosN$PCiencias>11)/150
Prob_eventoCyProb_eventoD
```
La probabilidad conjunta de C y D es 0.2333333, lo que significa que la probabilidad de seleccionar a un estudiante que cumpla ambos eventos (tenga un total de cursos igual a 7 y un promedio de nota mayor a 11) es del 23%.

## **calculo del producto de las probabilidades marginales de C y D**

El resultado obtenido es:

```{r}
Prob_eventoC*Prob_eventoD
```
El producto de las probabilidades marginales de C y D es 0.2330667, lo que significa que si los eventos fueran independientes, la probabilidad conjunta sería del 23.31%.

Se observa que la probabilidad conjunta y el producto de las probabilidades marginales son iguales. Esto implica que los eventos C y D son independientes, ya que el producto entre sus probabilidades es igual a su probabilidad conjunta. Esto significa que no hay una relación entre el total de cursos y el promedio de notas de ciencias.

## **calculo de la probabilidad condicional de C dado D**

$P(C|D) = \frac{P(C \cap D)}{P(D)}$

El resultado obtenido es:

```{r}
prob_condicional <- Prob_eventoCyProb_eventoD/Prob_eventoD

print(prob_condicional)

```
La probabilidad condicional de C dado D es 0.2536232, lo que significa que el 25% de los estudiantes que tienen un promedio de nota mayor a 11 tienen un total de cursos igual a 7.

Se puede ver que la probabilidad mencionada es igual a la probabilidad marginal de C, lo que confirma que los eventos son independientes. Esto significa que el hecho de que un estudiante tenga un promedio de nota mayor a 11 no tiene efecto en la probabilidad de que tenga un total de cursos igual a 7, y viceversa.

# **VARIABLES ALEATORIAS DISCRETAS**

1. Supongamos que seleccionamos al azar a un grupo de estudiantes mayores de edad (18 o más). ¿Cuál es la probabilidad de que exactamente 5 estudiantes al azar tengan una adecuada claridad? Si solo consideramos la décima parte de la muestra.

A. Distribución Binomial.

La distribución binomial es una distribución de probabilidad discreta que describe el número de éxitos en una secuencia de n ensayos independientes de Bernoulli. En este caso, cada estudiante seleccionado al azar se considera un ensayo, y el éxito se define como tener una adecuada claridad.

X ~ Bin(p, n) donde p es la probabilidad de éxitos y n el número de observaciones.

B. Variable aleatoria:

X: # estudiantes mayores de edad con una adecuada o excelente claridad en una muestra de 15.

C. Identificación de parámetros:

X ~ Bin(P1, n1) donde:

Éxitos: # estudiantes mayores de con una adecuada claridad. P1: es la probabilidad de seleccionar estudiantes de 20 años o más con una adecuada claridad n1: muestra de tamaño igual a 15 observaciones. k1: número de éxitos igual a 1

```{r}
k1 <- 1
n1 <- nrow(DatosN)/10
P1 <- sum(DatosN$Edad > 17 & (DatosN$Claridad == "Adecuada"| DatosN$Claridad == "Excelente"))/150
```
Aquí, calculamos la probabilidad de éxito P1 como la proporción de estudiantes en la muestra que tienen más de 17 años y tienen una claridad adecuada o excelente. También definimos el tamaño de la muestra n1 como la décima parte del tamaño total de la muestra y el número de éxitos k1 como 1.

```{r}
dbinom(k1,n1,P1)
```
Usando la función dbinom, podemos calcular la probabilidad de tener exactamente k1 éxitos en n1 ensayos con una probabilidad de éxito P1.

D. Gráfico de función de Densidad.
```{r}
x1 <- 0:n1
Densidad1 <- dbinom(x1,n1,P1)
```

```{r}
D1 <- data.frame(x1, Densidad1)
```

```{r}
ggplot(D1, aes(x1, Densidad1)) +
  geom_bar(stat = "identity", fill = "lightblue", color = "black") +
  labs(title = "Función de Densidad Binomial",
       x = "Número de éxitos",
       y = "Densidad") +
  theme_minimal()
```
Aquí, calculamos la función de densidad para cada posible número de éxitos x desde 0 hasta n, y luego usamos ggplot para crear un gráfico de barras que muestra la distribución binomial.

E. Validar propiedades 
```{r}

esperanza <- n1 * P1
varianza <- n1 * P1 * (1 - P1)
desviacion <- sqrt(varianza)

esperanza
varianza
desviacion
```
La distribución binomial tiene una media igual a n * p y una varianza igual a n * p * (1 - p). Aquí, calculamos la media, la varianza y la desviación estándar de nuestra distribución binomial usando estos valores.

2. Estudio de la dificultad percibida del curso “Cálculo de una variable”

Se quiere saber cuál es la probabilidad de que se necesiten seleccionar exactamente 15 estudiantes para encontrar 5 que hayan considerado “Cálculo de una variable” como el curso más difícil, considerando que la probabilidad individual de que un estudiante lo considere como tal es P2 y que los eventos son independientes.

A. Distribución binomial negativa.

Para abordar el problema de encontrar la probabilidad de que se necesiten seleccionar exactamente 15 estudiantes para encontrar 5 que hayan considerado “Cálculo de una variable” como el curso más difícil, se puede utilizar la distribución binomial negativa. Se define la variable aleatoria X como el número de selecciones necesarias para obtener los 5 estudiantes deseados en una muestra de 15 estudiantes. X sigue una distribución binomial negativa con parámetros r y p, donde r es el número de éxitos deseados y p es la probabilidad de éxito en una selección.
B. Variable aleatoria.

X: Número de selecciones necesarias para obtener los 5 estudiantes que consideren “Cálculo de una variable” como el curso más difícil en una muestra de 15 estudiantes.

C. Identificación de parámetros.

X ~ NB(5, P2) donde:

r: número de éxitos deseados igual a 5. p: probabilidad de éxito en una selección igual a P2.

```{r}
P2 <- sum(DatosN$CDCiencias=="Cálculo de una Variable")/150
```
Una vez que tenemos el valor estimado de P2, podemos calcular la probabilidad de que se necesiten exactamente 15 selecciones para encontrar 5 estudiantes que consideren “Cálculo de una variable” como el curso más difícil utilizando la función dnbinom.

```{r}
P <- dnbinom(x = 15, size = 5, prob = P2)
cat("P(X = 15) =", P)

```
Además, podemos visualizar la función de densidad de probabilidad de X utilizando un gráfico de barras. Para ello, primero calculamos las probabilidades para cada valor posible de X (desde 0 hasta 15) utilizando la función dnbinom
D. Gráfico de función Densidad. 

```{r}
x2 <- 0:15
Densidad2 <- dnbinom(x2, size = 5, prob = P2)
```

```{r}
D2 <- data.frame(x2,Densidad2)
```

```{r}
ggplot(D2,aes(x2, Densidad2)) +
  geom_bar(stat = "identity", fill = "lightblue", color = "black") +
  labs(title = "Función de Densidad Binomial Negativa",
       x = "Número de selecciones",
       y = "Densidad") +
  theme_minimal()
```
Finalmente, podemos validar las propiedades de la distribución binomial negativa calculando su esperanza, varianza y desviación estándar:
E. Validar propiedades 

```{r}
r <- 5
p <- P2

esperanza <- r * (1 - p) / p
varianza <- r * (1 - p) / p^2
desviacion <- sqrt(varianza)

esperanza
varianza
desviacion
```

# **VARIABLES ALEATORIAS CONTINUAS**

Se analiza la probabilidad de que el promedio de notas de los estudiantes masculinos y femeninos sea mayor a 13, utilizando una distribución normal.

```{r}
DatosNMasculino <- subset(DatosN, Sexo == "Masculino")
DatosNFemenino <- subset(DatosN, Sexo== "Femenino")
```

Primero, separamos los datos en dos subconjuntos: uno para estudiantes masculinos y otro para estudiantes femeninos.

“¿Cuál es la probabilidad de que el promedio de notas de los estudiantes masculinos sea mayor a 13?”

A. Variable aleatoria continua - distribución normal:
X: # Promedio de notas de los estudiantes masculinos.
B. Identificamos la gráfica

Primero hallamos la Media (μ) y la Desviación estándar (σ) de nuestra los valores que toma PCiencias de los alumnos.

```{r}
μ_masculino <- mean(DatosNMasculino$PCiencias)
σ_masculino <- sd(DatosNMasculino$PCiencias)
```
Aquí, calculamos la media y la desviación estándar del promedio de notas de los estudiantes masculinos.

```{r}

valores_prom_Masc <- sort(unique(DatosNMasculino$PCiencias))


secuencia_lim_inf_Masc <- valores_prom_Masc[1]-0.1 
secuencia_lim_sup_Masc <- valores_prom_Masc[length(valores_prom_Masc)]+0.1 


x_Masc <- seq(secuencia_lim_inf_Masc, secuencia_lim_sup_Masc)
```

```{r}

densidad_masculina <- dnorm(x_Masc, mean = μ_masculino , sd = σ_masculino)

data_masculina <- data.frame(x = x_Masc, densidad = densidad_masculina)
ggplot(data_masculina, aes(x = x, y = densidad)) +
  geom_line(color = "blue", size = 2) +
  labs(title = "Función de Densidad",
       x = "Promedio de Notas de los alumnos",
       y = "Densidad")
```
Aquí, calculamos la función de densidad para cada valor posible del promedio de notas utilizando la media y la desviación estándar calculadas anteriormente. Luego, usamos ggplot para crear un gráfico que muestra la función de densidad.

C. Validar 

Utilizamos el test de Shapiro-Wilk para validar que se trata de una distribución normal.

```{r}
resultados_sw_masculino <- shapiro.test(DatosNMasculino$PCiencias)
resultados_p_masculino <- resultados_sw_masculino$p.value
resultados_p_masculino
```
Por teoría si el valor “resultados_p_masculino” es mayor a 0.05 se puede concluir que se trata de una distribución normal, 0.06198066 > 0.05 si cumple.
D. Probabilidad del problema planteado

```{r}

probabilidad_masculina <- 1 - pnorm(13, mean = μ_masculino, sd = σ_masculino)


probabilidad_masculina
```
Aquí, calculamos la probabilidad del problema planteado utilizando la función pnorm, que calcula la probabilidad acumulada hasta un valor dado para una distribución normal con una media y desviación estándar especificadas.

2.“¿Cuál es la probabilidad de que el promedio de notas de los estudiantes femeninos sea mayor a 13?”
A. Variable aleatoria continua:

X: # Promedio de notas de los estudiantes femeninos.

B. Identificamos la gráfica

Primero hallamos la Media (μ) y la Desviación estándar (σ) de nuestra los valores que toma PCiencias de las alumnas.

```{r}
μ_femenino <- mean(DatosNFemenino$PCiencias)
σ_femenino <- sd(DatosNFemenino$PCiencias)
```
Aquí, calculamos la media y la desviación estándar del promedio de notas de los estudiantes femeninos.

```{r}

valores_prom_Fem <- sort(unique(DatosNFemenino$PCiencias))


secuencia_lim_inf_Fem <- valores_prom_Fem[1]-0.1 
secuencia_lim_sup_Fem <- valores_prom_Fem[length(valores_prom_Fem)]+0.1 


x_Fem <- seq(secuencia_lim_inf_Fem, secuencia_lim_sup_Fem)
```

```{r}
densidad_femenino <- dnorm(x_Fem, mean = μ_femenino , sd = σ_femenino)


data_femenimo <- data.frame(x = x_Fem, densidad = densidad_femenino)
ggplot(data_masculina, aes(x = x, y = densidad)) +
  geom_line(color = "blue", size = 2) +
  labs(title = "Función de Densidad",
       x = "Promedio de Notas de las alumnas",
       y = "Densidad")
```
Aquí, calculamos la función de densidad para cada valor posible del promedio de notas utilizando la media y la desviación estándar calculadas anteriormente. Luego, usamos ggplot para crear un gráfico que muestra la función de densidad.

C. Validar 
utilizamos el test de Shapiro-Wilk para validar que se trata de una distribucion normal 
```{r}
resultados_sw_femenino <- shapiro.test(DatosNFemenino$PCiencias)
resultados_p_femenino <- resultados_sw_femenino$p.value
resultados_p_femenino
```
por teoría si el valor "resultados_p_masculino" es mayor a 0.05 se puede concluir que se trata de una distribución normal, 0.008224975 < 0.05 no cumple.

D. Probabilidad de problema planteado 
```{r}
probabilidad_femenino <- 1 - pnorm(13, mean = μ_femenino, sd = σ_femenino)

probabilidad_femenino
```
Aquí, calculamos la probabilidad del problema planteado utilizando la función pnorm, que calcula la probabilidad acumulada hasta un valor dado para una distribución normal con una media y desviación estándar especificadas.


# **CONCLUSIONES**

## **Conclusión 1**
Según el cálculo que se hizo, hay un 0.571 de posibilidades de que los alumnos varones tengan un promedio mayor a 13 y por lo tanto un buen rendimiento académico. Este cálculo se basó en que el promedio sigue una distribución normal, lo cual se comprobó con el test de Shapiro-Wilk. El gráfico que se muestra a continuación ilustra la función de densidad del promedio de los alumnos varones y la línea vertical que marca el valor de 13. Se ve que la mayor parte del área bajo la curva queda a la derecha de la línea, lo que respalda el cálculo hecho.
```{r}
ggplot(data_masculina, aes(x = x, y = densidad)) +
  geom_line(color = "blue", size = 2) +
  geom_vline(xintercept = 13, color = "red", linetype = "dashed") +
  labs(title = "Función de Densidad",
       x = "Promedio de Notas de los alumnos",
       y = "Densidad")
```

## **Conclusión 2**
El 48.6% de las estudiantes femeninas tienen un promedio superior a 13, lo que demuestra que son buenas estudiantes. Sin embargo, los datos no se ajustan a una distribución normal y tienen una forma extraña, sesgada hacia la izquierda y con una cúspide muy alta. Quizás una distribución log-normal podría ajustarse mejor a los datos.

## **Conclusión 3** 
La probabilidad de que un estudiante sea mayor de edad y tenga una claridad baja es de 0.6571, lo que muestra una fuerte asociación entre la claridad y la edad de los estudiantes. Esta probabilidad se obtuvo usando la distribución binomial negativa y es diferente a la probabilidad marginal de A, lo que implica que los eventos no son independientes y que hay una relación entre la claridad y la edad. Esto sugiere que los estudiantes mayores tienen más chances de tener una claridad baja que los estudiantes menores.




