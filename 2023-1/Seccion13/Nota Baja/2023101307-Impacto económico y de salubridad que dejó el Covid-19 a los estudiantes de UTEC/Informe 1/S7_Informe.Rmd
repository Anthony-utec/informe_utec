---
title: "Impacto económico y de salubridad que dejó el  Covid-19 a los estudiantes de UTEC"
output:
  html_document:
    toc: TRUE
    theme: united
---

# **Introducción**
La pandemia del Coronavirus fue un asunto que agarró a mucha gente desprevenida, causando entre tantas cosas un impacto en la economía debido a que los trabajos de muchas personas se vieron afectados. Esta investigación tiene como fin medir el impacto del Covid 19 en la economía de los familiares de los estudiantes de UTEC y ver si esto afectó en sus estudios.

## **Relevancia**
Investigar sobre cómo el Covid-19 afectó económicamente a las familias de los estudiantes de UTEC es de suma importancia debido a las implicaciones significativas que esta crisis sanitaria ha tenido en la vida de las personas. Al abordar este tema, vamos a obtener una comprensión profunda de los desafíos económicos a los que se enfrentaron las familias durante la pandemia y cómo estos desafíos afectaron directamente la continuidad de los estudios universitarios de los estudiantes de UTEC. Uno de los objetivos secundarios es conocer el estado en el que las personas se encontraban si contrajeron el Covid-19, ya sea leve, grave o crítico. Esto es esencial para comprender el impacto de la enfermedad en la salud de los estudiantes y sus familias, al identificar la gravedad de los casos de Covid-19, se podrá evaluar mejor la correlación entre el estado de salud y el impacto económico experimentado por las familias. Además, mostrar los gastos económicos invertidos en el tratamiento de los estudiantes UTEC afectados por la Covid-19 proporcionará una visión detallada de la carga financiera que las familias tuvieron que soportar. Esto incluirá no solo los costos médicos directos, como las consultas médicas, los medicamentos y las hospitalizaciones, sino también los gastos adicionales relacionados con la prevención y el control del virus, como los equipos de protección personal y las pruebas de diagnóstico. Los resultados de esta investigación pueden ser para implementar medidas de apoyo efectivas y promover el bienestar académico y económico de los estudiantes de UTEC y sus familias en el contexto post pandémico.


## **Objetivos**

### **Principal**
El objetivo principal del estudio es evaluar como el Covid-19 afectó económicamente a las familias de los estudiantes de la UTEC y mediante los datos recolectados analizar, entender y concluir si este perjudicó los estudios universitarios de estos.

### **Secundarios**

* Conocer el estado en el que la persona se encontraba si le dió Covid-19 (Estado leve, grave o crítico)

* Mostrar gastos económicos invertidos en el tratamiento de los estudiantes UTEC afectados por la COVID-19

* Conocer los tratamientos seguidos por los pacientes afectados por el Covid-19 vinculados a los estudiantes de UTEC

## **Contexto**

-Gastos médicos: En algunos casos, los estudiantes universitarios pueden haber enfrentado gastos médicos adicionales debido a la pandemia. Esto puede incluir pruebas de COVID-19, tratamiento médico, visitas a establecimientos médicos, y entre otros. Estos gastos pueden haber ejercido presión sobre los recursos económicos de los estudiantes y sus familias.

-Impacto en la salud: Los estudiantes universitarios que contrajeron COVID-19 pueden haber experimentado una variedad de síntomas, desde síntomas leves, graves y hasta críticos que requerían hospitalización. La enfermedad en sí misma puede haber causado gripe, fiebre, pérdida gustativa y olfativa, y entre otros. 


# **Datos**

## **Proceso de recolección de datos**
Se elaboró un formulario mediante el cual se fueron recolectando los datos necesarios para la investigación. Este formulario se compartió por diferentes grupos de estudio de la UTEC mediante enlaces y también fue respondido mediante QR en la misma universidad. Además, las preguntas del formulario contaban con un rango de respuestas para que a la hora de hacer la limpieza de datos no hayan demasiados datos incongruentes.

## **Población, muestra y muestreo**

### **Población**
La población son los estudiantes de Pre-grado de Universidad de Ingeniería y Tecnología del semestre 2023-1.

### **Muestra**
El tamaño de la muestra son 170 alumnos, lo cual representa una cantidad significativa que nos permitirá trabajar con estos datos.

### **Muestreo**
Esta investigación se realizó con muestreo aleatorio simple.

## **Variables**

**Variables numéricas**


Variable                Tipo                  Restricciones
----------------------- ------------------    -------------------------
Edad                    Numérica discreta     Entero positivo [15-60]
Ciclo                   Numérica discreta     Entero positivo [1-10]
Peso                    Numérica continua     Número real [40-150]
Altura                  Numérica continua     Número real [130-200]
Familiares_Infectados   Numérica discreta     Entero positivo [0-20]
Tiempo_Infección        Numérica discreta     Entero positivo [0-100]
Vacunas_Recibidas       Numérica discreta     Entero positivo [0-6]
Establecimiento_Veces   Numérica discreta     Entero positivo [0-30]
COVID19_Veces           Numérica discreta     Entero positivo [0-10]
PruebasDescarte_Veces   Numérica discreta     Entero positivo [0-50]
Gasto                   Numérica continua     Número positivo mayor a 0


**Variables categóricas**

Variable                Tipo                   Restricciones
----------------------- -------------------    ---------------------
Escala                  Categórica ordinal     Respuesta obligatoria  
Distrito                Categórica nominal     Respuesta obligatoria   
Estado                  Categórica ordinal     Respuesta obligatoria
Tratamiento             Categórica ordinal     Respuesta obligatoria
Sintomas                Categórica nominal     Respuesta obligatoria
Vacunas_Recibidas       Categórica nominal     Respuesta obligatoria
Variante                Categórica nominal     Respuesta obligatoria
Tipo_Prueba             Categórica nominal     Respuesta obligatoria


## **Limpieza de base de datos**

```{r,include=FALSE}
librerias <- c("readr","dplyr","tidyr","modeest","tidyverse","ggplot2")

libreriasF = librerias[!(librerias %in% rownames(installed.packages()))]

if (length(libreriasF) > 0) {
    install.packages(libreriasF)
}
lapply(librerias, library, character.only = TRUE)

```

Primero, hay que cargar el archivo en el que se encuentran nuestros datos para comenzar con la limpieza

```{r}
DF <- read_csv("Encuesta.csv")
```

Eliminamos las columnas que no nos sirven
```{r}
DF <- select(DF, -`Marca temporal`)
```

Cambiaremos el nombre de las variables para un trabajo más eficiente
```{r}
DF %>% rename(Edad = `Ingrese su edad`, Ciclo = `Ingrese su ciclo`, Peso = `Ingrese su peso en kg`, Altura = `Ingrese su altura (En centímetros)`, Escala = `Seleccione su escala` , Distrito = `Elija el distrito donde reside`, Familiares_Infectados = `¿Cuántas personas afectadas de Covid hubo en su familia?`, Tiempo_Infección = `¿Cuánto tiempo duro la infección del Covid-19 en su caso? Tiempo en días.`, Vacunas_Recibidas = `¿Cuántas vacunas recibió para contrarrestar el Covid-19 ?`, Establecimiento_Veces =`Ingrese el número de veces que acudió a un establecimiento médico durante la pandemia (2020-2022)`, COVID19_Veces = `¿Cuántas veces le dio el Covid-19?`, PruebasDescarte_Veces = `¿Cuántas veces durante la pandemia se realizó las pruebas de descarte de Covid-19?`, Estado = `Seleccione cual fue estado de gravedad como paciente de Covid-19`, Gasto = `¿Aproximadamente cuánto se gastó (en soles) en el tratamiento para la persona afectada de Covid 19?`, Tratamiento = `Seleccione el tratamiento seguido`, Sintomas = `Seleccione los síntomas que tuvo`, Vacuna = `Seleccione el tipo de vacunas recibidas`, Variante = `Seleccione que variante del Covid-19 le afecto`, TipoPrueba = `¿Qué tipo de prueba de descarte del Covid-19 se realizo?`) -> DFN
```

Entonces procederemos con la limpieza de datos

```{r}
table(complete.cases(DFN))
```

Podemos observar el total de observaciones, que son 170. De estas 170, hay 157 observaciones completas y 13 incompletas. 
Procederemos a eliminar los datos faltantes.

```{r}
DFN = na.omit(DFN)
```

Con esto eliminamos los pocos datos faltantes presentes en el data frame.
Ahora verificaremos las variables y eliminaremos los datos no representativos de estas.

**Tiempo de infección**
```{r}
DFN$Tiempo_Infección[DFN$Tiempo_Infección > 60] <- NA
```

Los datos transformados a NA's los eliminamos
```{r}
DFN = na.omit(DFN)
```

Algunas variables cuentan con respuestas de más de una opción, por ello, separaremos en diferentes columnas los datos que tengan más de una opción.

**Tipo de prueba**

Con la función separate crearemos 3 variables nuevas que serán: Molecular, Antígena y Ninguna, las cuales representan las opciones disponibles a marcar.

```{r}
DFN <- DFN %>% separate(TipoPrueba, c("Molecular","Antigena","Ninguna"), sep = ",")
```

A partir de ahora nos centraremos en convertir los datos marcados en TRUE y FALSE
```{r}
DFN$Molecular[DFN$Molecular == "Molecular"] <- TRUE
DFN$Antigena[DFN$Molecular == "Antigena"] <- TRUE
DFN$Ninguna[DFN$Molecular == "Ninguna"] <- TRUE
DFN$Antigena[DFN$Antigena == " Antigena"] <- TRUE
DFN$Molecular[DFN$Molecular == "Antigena"] <- FALSE
DFN$Molecular[DFN$Molecular == "Ninguna"] <- FALSE
DFN$Antigena[is.na(DFN$Antigena)] <- FALSE
DFN$Ninguna[is.na(DFN$Ninguna)] <- FALSE
```

Aquí tenemos el resumen de la cantidad de personas que se han hecho la prueba molecular, antígena y las que no se han hecho ninguna de las dos.
```{r}
DFN %>%
  group_by(Molecular,Antigena,Ninguna) %>%
  tally()
```

**Vacunas recibidas**

Con las vacunas tenemos el mismo caso que con el tipo de pruebas, por lo tanto, crearemos 3 nuevas variables que serán: Pfizer, AstraZeneca y Sinopharm, cada TRUE indicará que la opción fue marcada y cada FALSE indicará que la opción **NO** fue marcada.
```{r}
DFN <- DFN %>% separate(Vacuna, c("Pfizer","AstraZeneca","Sinopharm"), sep = ",")
```

```{r}
DFN$Pfizer[DFN$Pfizer == "Pfizer"] <- TRUE
DFN$Sinopharm[DFN$Pfizer == "Sinopharm"] <- TRUE
DFN$Sinopharm[DFN$AstraZeneca == " Sinopharm"] <- TRUE
DFN$Sinopharm[DFN$Sinopharm == " Sinopharm"] <- TRUE
DFN$AstraZeneca[DFN$Pfizer == "AstraZeneca"] <- TRUE
DFN$AstraZeneca[DFN$AstraZeneca == " AstraZeneca"] <- TRUE
DFN$Pfizer[DFN$Pfizer != "TRUE"] <- FALSE
DFN$AstraZeneca[DFN$AstraZeneca != "TRUE"] <- FALSE
DFN$AstraZeneca[is.na(DFN$AstraZeneca)] <- FALSE
DFN$Sinopharm[is.na(DFN$Sinopharm)] <- FALSE
```

Con table podemos ver un resumen de la cantidad de personas que se pusieron las diferentes vacunas.
```{r}
DFN %>%
  group_by(Pfizer,AstraZeneca,Sinopharm) %>%
  tally()
```


Y con esto tendríamos la base de datos limpia
```{r}
summary(DFN)
```


# **Análisis descriptivo**


## Análisis Univariado

Ahora para cada variable usaremos los distintos descriptores (Promedio, mediana, moda, etc…) para saber la información de los datos obtenidos para cada variable.

**Edad**

```{r}
meanEdad <- mean(DFN$Edad) #Promedio de la variable Edad
medianEdad <- median(DFN$Edad) #Mediana de la variable Edad
modaEdad <- mfv(DFN$Edad) #Moda de la variable Edad
sdEdad <- sd(DFN$Edad) #Desviación Estandar de la variable Edad
iqrEdad <- IQR(DFN$Edad) #Rango Intercuartil de la variable Edad
varEdad <- var(DFN$Edad) #Variación de Edad
tablaEdad <- data.frame(Promedio = c(meanEdad), Mediana = c(medianEdad), Moda = c(modaEdad), DesviacionEstandar = c(sdEdad), RangoIntercuartil = c(iqrEdad), Variacion = c(varEdad))
tablaEdad
```

```{r}
#Observamos el promedio (19,14) y la mediana (19) en la cual podemos identificar que nuestro conjunto de datos de la edad está en una asimetría positiva.
```

**Ciclo**

```{r}
meanCiclo <- mean(DFN$Ciclo) #Promedio de la variable Ciclo
medianCiclo <- median(DFN$Ciclo) #Mediana de la variable Ciclo
modaCiclo <- mfv(DFN$Ciclo) #Moda de la variable Ciclo
sdCiclo <- sd(DFN$Ciclo) #Desviación Estandar de la variable Ciclo
iqrCiclo <- IQR(DFN$Ciclo) #Rango Intercuartil de la variable Ciclo
varCiclo <- var(DFN$Ciclo) #Variación de Ciclo
tablaCiclo <- data.frame(Promedio = c(meanCiclo), Mediana = c(medianCiclo), Moda = c(modaCiclo), DesviacionEstandar = c(sdCiclo), RangoIntercuartil = c(iqrCiclo), Variacion = c(varCiclo))
tablaCiclo
```

```{r}
#Observamos el promedio (3.59) y la mediana (3) en la cual podemos identificar que nuestro conjunto de datos de los ciclos de los estudiantes UTEC está en un sesgo positivo. 
```

**Peso**

```{r}
meanPeso <- mean(DFN$Peso) #Promedio de la variable Peso
medianPeso <- median(DFN$Peso) #Mediana de la variable Peso
modaPeso <- mfv(DFN$Peso) #Moda de la variable Peso
sdPeso <- sd(DFN$Peso) #Desviación Estandar de la variable Peso
iqrPeso <- IQR(DFN$Peso) #Rango Intercuartil de la variable Peso
varPeso <- var(DFN$Peso) #Variación de Peso
tablaPeso <- data.frame(Promedio = c(meanPeso), Mediana = c(medianPeso), Moda = c(modaPeso), DesviacionEstandar = c(sdPeso), RangoIntercuartil = c(iqrPeso), Variacion = c(varPeso))
tablaPeso
```

```{r}
#Observamos que según la varianza la data no está muy concentrada y cercana a la media. Observamos el promedio (67.53) y la mediana (67) en la cual podemos identificar que nuestro conjunto de datos del peso está sesgada hacia la derecha.
```

**Altura**

```{r}
meanAltura <- mean(DFN$Altura) #Promedio de la variable Altura
medianAltura <- median(DFN$Altura) #Mediana de la variable Altura
modaAltura <- mfv(DFN$Altura) #Moda de la variable Altura
sdAltura <- sd(DFN$Altura) #Desviación Estandar de la variable Altura
iqrAltura <- IQR(DFN$Altura) #Rango Intercuartil de la variable Altura
varAltura <- var(DFN$Altura) #Variación de Altura
tablaAltura <- data.frame(Promedio = c(meanAltura), Mediana = c(medianAltura), Moda = c(modaAltura), DesviacionEstandar = c(sdAltura), RangoIntercuartil = c(iqrAltura), Variacion = c(varAltura))
tablaAltura
```

```{r}
#Observamos el promedio (170.33) y la mediana (170) en la cual podemos identificar que nuestro conjunto de datos de la altura está sesgada hacia la derecha.
```

**Escala**

```{r}
medianEscala <- median(DFN$Escala) #Mediana de la variable Escala
modaEscala <- mfv(DFN$Escala) #Moda de la variable Escala
rangoEscala <- range(DFN$Escala) #Rango mínimo y Rango máximo de la variable Escala
tablaEscala <- data.frame(Mediana = c(medianEscala), Moda = c(modaEscala), Rango = c(rangoEscala))
tablaEscala
```

```{r}
#Observamos en base a nuestra mediana y moda que en nuestra data tiende a ver más personas con menores escalas económicas de la universidad.
```

**Distrito**

```{r}
medianDistrito <- median(DFN$Distrito) #Mediana de la variable Distrito
modaDistrito <- mfv(DFN$Distrito) #Moda de la variable Distrito
rangoDistrito <- range(DFN$Distrito) #Rango mínimo y Rango máximo de la variable Distrito
tablaDistrito <- data.frame(Mediana = c(medianDistrito), Moda = c(modaDistrito), Rango = c(rangoDistrito))
tablaDistrito
```

```{r}
#Observamos que en nuestra data las personas encuestadas tienden a vivir en Barranco, quizás debido a que la universidad también tiene como ubicación Barranco.
```

**Familiares infectados**

```{r}
meanFamiliares <- mean(DFN$Familiares_Infectados) #Promedio de la variable Familiares_Infectados
medianFamiliares <- median(DFN$Familiares_Infectados) #Mediana de la variable Familiares_Infectados
modaFamiliares <- mfv(DFN$Familiares_Infectados) #Moda de la variable Familiares_Infectados
sdFamiliares <- sd(DFN$Familiares_Infectados) #Desviación Estandar de la variable Familiares_Infectados
iqrFamiliares <- IQR(DFN$Familiares_Infectados) #Rango Intercuartil de la variable Familiares_Infectados
varFamiliares <- var(DFN$Familiares_Infectados) #Variación de Familiares_Infectados
tablaFamiliares <- data.frame(Promedio = c(meanFamiliares), Mediana = c(medianFamiliares), Moda = c(modaFamiliares), DesviacionEstandar = c(sdFamiliares), RangoIntercuartil = c(iqrFamiliares), Variacion = c(varFamiliares))
tablaFamiliares
```



```{r}
#Observamos el promedio (3.59) y la mediana (3) en la cual podemos identificar que nuestro conjunto de datos de los familiares infectados está sesgada hacia la derecha.
```


**Tiempo de infección**

```{r}
meanTiempoInf <- mean(DFN$Tiempo_Infección) #Promedio de la variable TiempoInf
medianTiempoInf <- median(DFN$Tiempo_Infección) #Mediana de la variable TiempoInf
modaTiempoInf <- mfv(DFN$Tiempo_Infección) #Moda de la variable TiempoInf
sdTiempoInf <- sd(DFN$Tiempo_Infección) #Desviación Estandar de la variable TiempoInf
iqrTiempoInf <- IQR(DFN$Tiempo_Infección) #Rango Intercuartil de la variable TiempoInf
varTiempoInf <- var(DFN$Tiempo_Infección) #Variación de TiempoInf
tablaTiempoInf <- data.frame(Promedio = c(meanTiempoInf), Mediana = c(medianTiempoInf), Moda = c(modaTiempoInf), DesviacionEstandar = c(sdTiempoInf), RangoIntercuartil = c(iqrTiempoInf), Variacion = c(varTiempoInf))
tablaTiempoInf
```

```{r}
#Observamos el promedio (14.15) y la mediana (13) en la cual podemos identificar que nuestro conjunto de datos del tiempo de infección está sesgada hacia la derecha. Además, según la varianza de los datos, esta tiende a variar bastante respecto a la media.
```

**Vacunas recibidas**

```{r}
meanVacunasR <- mean(DFN$Vacunas_Recibidas) #Promedio de la variable Vacunas_Recibidas
medianVacunasR <- median(DFN$Vacunas_Recibidas) #Mediana de la variable Vacunas_Recibidas
modaVacunasR <- mfv(DFN$Vacunas_Recibidas) #Moda de la variable Vacunas_Recibidas
sdVacunasR <- sd(DFN$Vacunas_Recibidas) #Desviación Estandar de la variable Vacunas_Recibidas
iqrVacunasR <- IQR(DFN$Vacunas_Recibidas) #Rango Intercuartil de la variable Vacunas_Recibidas
varVacunasR <- var(DFN$Vacunas_Recibidas) #Variación de Vacunas_Recibidas
tablaVacunasR <- data.frame(Promedio = c(meanVacunasR), Mediana = c(medianVacunasR), Moda = c(modaVacunasR), DesviacionEstandar = c(sdVacunasR), RangoIntercuartil = c(iqrVacunasR), Variacion = c(varVacunasR))
tablaVacunasR
```

```{r}
#Observamos el promedio (2.97) y la mediana (3) en la cual podemos identificar que nuestro conjunto de datos de las vacunas recibidas está en una asimetría negativa.
```

**Establecimiento**

```{r}
meanEstablecimiento <- mean(DFN$Establecimiento_Veces) #Promedio de la variable Establecimiento_Veces
medianEstablecimiento <- median(DFN$Establecimiento_Veces) #Mediana de la variable Establecimiento_Veces
modaEstablecimiento <- mfv(DFN$Establecimiento_Veces) #Moda de la variable Establecimiento_Veces
sdEstablecimiento <- sd(DFN$Establecimiento_Veces) #Desviación Estandar de la variable Establecimiento_Veces
iqrEstablecimiento <- IQR(DFN$Establecimiento_Veces) #Rango Intercuartil de la variable Establecimiento_Veces
varEstablecimiento <- var(DFN$Establecimiento_Veces) #Variación de Establecimiento_Veces
tablaEstablecimiento <- data.frame(Promedio = c(meanEstablecimiento), Mediana = c(medianEstablecimiento), Moda = c(modaEstablecimiento), DesviacionEstandar = c(sdEstablecimiento), RangoIntercuartil = c(iqrEstablecimiento), Variacion = c(varEstablecimiento))
tablaEstablecimiento
```

```{r}
#Observamos el promedio (2.71) y la mediana (2) en la cual podemos identificar que nuestro conjunto de datos de las veces que se ha ido a un establecimiento está sesgada hacia la derecha.
```

**Covid19 Veces**

```{r}

meanCovidVeces <- mean(DFN$COVID19_Veces) 
medianCovidVeces <- median(DFN$COVID19_Veces) 
modaCovidVeces <- mfv(DFN$COVID19_Veces) 
sdCovidVeces <- sd(DFN$COVID19_Veces) 
iqrCovidVeces <- IQR(DFN$COVID19_Veces) 
varCovidVeces <- var(DFN$COVID19_Veces) 
tablaCovidVeces <- data.frame(Promedio = c(meanCovidVeces), Mediana = c(medianCovidVeces), Moda = c(modaCovidVeces), DesviacionEstandar = c(sdCovidVeces), RangoIntercuartil = c(iqrCovidVeces), Variacion = c(varCovidVeces))
tablaCovidVeces
```

```{r}

#Observamos el promedio (1.58) y la mediana (1) en la cual podemos identificar que nuestro conjunto de datos de las veces que les ha dado COVID-19 a los estudiantes UTEC está sesgada hacia la derecha.
```

**Pruebas Descarte Veces**

```{r}
meanPruebaDescarte <- mean(DFN$PruebasDescarte_Veces) 
medianPruebaDescarte <- median(DFN$PruebasDescarte_Veces) 
modaPruebaDescarte <- mfv(DFN$PruebasDescarte_Veces) 
sdPruebaDescarte <- sd(DFN$PruebasDescarte_Veces) 
iqrPruebaDescarte <- IQR(DFN$PruebasDescarte_Veces) 
varPruebaDescarte <- var(DFN$PruebasDescarte_Veces) 
tablaPruebaDescarte <- data.frame(Promedio = c(meanPruebaDescarte), Mediana = c(medianPruebaDescarte), Moda = c(modaPruebaDescarte), DesviacionEstandar = c(sdPruebaDescarte), RangoIntercuartil = c(iqrPruebaDescarte), Variacion = c(varPruebaDescarte))
tablaPruebaDescarte
```

```{r}
#Observamos el promedio (3.25) y la mediana (2) en la cual podemos identificar que nuestro conjunto de datos de las veces que se hizo las pruebas de descarte está sesgada hacia la derecha. 
```

**Estado**

```{r}
medianEstado <- median(DFN$Estado) 
modaEstado <- mfv(DFN$Estado)
rangoEstado <- range(DFN$Estado)
tablaEstado <- data.frame(Mediana = c(medianEstado), Moda = c(modaEstado), Rango = c(rangoEstado))
tablaEstado
```

```{r}
#Observamos que en nuestra data es predominante los casos leves que ha ocasionado el COVID-19 a los estudiantes UTEC.
```

**Gasto**

```{r}
meanGasto <- mean(DFN$Gasto) 
medianGasto <- median(DFN$Gasto) 
modaGasto <- mfv(DFN$Gasto) 
sdGasto <- sd(DFN$Gasto) 
iqrGasto <- IQR(DFN$Gasto) 
varGasto <- var(DFN$Gasto) 
tablaGasto <- data.frame(Promedio = c(meanGasto), Mediana = c(medianGasto), Moda = c(modaGasto), DesviacionEstandar = c(sdGasto), RangoIntercuartil = c(iqrGasto), Variacion = c(varGasto))
tablaGasto
```

```{r}
#Observamos el promedio (837.93) y la mediana (200) en la cual podemos identificar que nuestro conjunto de datos de los gastos está sesgada hacia la derecha. Además, según el valor muy alto de la varianza nos indica que los datos de gastos tienden a ser extremadamente distanciados de la media.
```

**Tratamiento**

```{r}
medianTratamiento <- median(DFN$Tratamiento) 
modaTratamiento <- mfv(DFN$Tratamiento) 
rangoTratamiento <- range(DFN$Tratamiento)  
tablaTratamiento <- data.frame(Mediana = c(medianTratamiento), Moda = c(modaTratamiento), Rango = c(rangoTratamiento))
tablaTratamiento
```

```{r}
#Observamos gracias a la moda y la mediana que los tratamientos frente al COVID-19 en los estudiantes UTEC se ha realizado en la casa.
```

**Síntomas**

```{r}
medianSintomas <- median(DFN$Sintomas) 
modaSintomas <- mfv(DFN$Sintomas) 
rangoSintomas <- range(DFN$Sintomas)  
tablaSintomas <- data.frame(Mediana = c(medianSintomas), Moda = c(modaSintomas), Rango = c(rangoSintomas))
tablaSintomas
```

```{r}
#Observamos gracias a la moda y la mediana que los síntomas frente al COVID-19 en los estudiantes UTEC más común ha sido la gripe.
```

**Tipo de Vacuna: Pfizer, AstraZeneca o Sinopharm**

```{r}
medianPfizer <- median(DFN$Pfizer) 
modaPfizer <- mfv(DFN$Pfizer) 
rangoPfizer <- range(DFN$Pfizer) 
tablaPfizer <- data.frame(Mediana = c(medianPfizer), Moda = c(modaPfizer), Rango = c(rangoPfizer))
tablaPfizer
```

```{r}
medianAstraZeneca <- median(DFN$AstraZeneca) 
modaAstraZeneca <- mfv(DFN$AstraZeneca) 
rangoAstraZeneca <- range(DFN$AstraZeneca) 
tablaAstraZeneca <- data.frame(Mediana = c(medianAstraZeneca), Moda = c(modaAstraZeneca), Rango = c(rangoAstraZeneca))
tablaAstraZeneca
```

```{r}
medianSinopharm <- median(DFN$Sinopharm) 
modaSinopharm <- mfv(DFN$Sinopharm) 
rangoSinopharm <- range(DFN$Sinopharm) 
tablaSinopharm <- data.frame(Mediana = c(medianSinopharm), Moda = c(modaSinopharm), Rango = c(rangoSinopharm))
tablaSinopharm
```

```{r}

#Observamos gracias a la moda y la mediana que las personas han tenido una mayor preferencia a vacunarse con Pfizer, mas no mucha preferencia con AstraZeneca o Sinopharm.
```

**Variante**

```{r}

medianVariante <- median(DFN$Variante) 
modaVariante <- mfv(DFN$Variante) 
rangoVariante <- range(DFN$Variante) 
tablaVariante <- data.frame(Mediana = c(medianVariante), Moda = c(modaVariante), Rango = c(rangoVariante))
tablaVariante
```

```{r}

#Observamos gracias a la moda que entre los variantes que se han desarrollado en el COVID-19, el más concurrido es el Omicron
```

**Tipo de Prueba: Molecular, Antígena o Ninguna**

```{r}

medianMolecular <- median(DFN$Molecular) 
modaMolecular <- mfv(DFN$Molecular) 
rangoMolecular <- range(DFN$Molecular) 
tablaMolecular <- data.frame(Mediana = c(medianMolecular), Moda = c(modaMolecular), Rango = c(rangoMolecular))
tablaMolecular
  
```

```{r}

medianAntigena <- median(DFN$Antigena) 
modaAntigena <- mfv(DFN$Antigena) 
rangoAntigena <- range(DFN$Antigena) 
tablaAntigena <- data.frame(Mediana = c(medianAntigena), Moda = c(modaAntigena), Rango = c(rangoAntigena))
tablaAntigena
```

```{r}

medianNinguna <- median(DFN$Ninguna) 
modaNinguna <- mfv(DFN$Ninguna) 
rangoNinguna <- range(DFN$Ninguna) 
tablaNinguna <- data.frame(Mediana = c(medianNinguna), Moda = c(modaNinguna), Rango = c(rangoNinguna))
tablaNinguna

```

```{r}
#Observamos gracias a la mediana y moda que la prueba de descarte por preferencia de los estudiantes UTEC ha sido la molecular.
```


## Análisis Bivariado

Ahora utilizaremos gráficas para que nos permitan ayudar para la visualización de los datos y obtener 


## **Estado~Tratamiento**

```{r}
Estado <- DFN$Estado
Tratamiento <- DFN$Tratamiento
ggplot(data = NULL, aes(x = Estado, y = Tratamiento)) + 
  geom_jitter(aes(color = Estado), size = 1, alpha = 0.7) +
  xlab('Estado') + 
  ylab('Tratamiento') +
  ggtitle('Relación entre el estado del paciente y su tratamiento') + 
  theme_minimal()



```

Observamos que para cuando son estados críticos o graves hay una tendencia a preferir la hospitalización, en cambio, para cuando son casos leves se prefiere un tratamiento en la casa. Asimismo, hay una pequeña parte en casos leves que prefieren no ser hospitalizados, o ser llevados a la clínica a fin de ser su tratamiento. Aunque esto nos desvela que los estudiantes UTEC frente al COVID-19 en su mayoría prefieren tomarse cuidados por su cuenta, ya sea en su casa o sin hospitalización, por lo tanto, hay riesgo de que al no seguir un tratamiento médico podría escalar a caso grave o crítico.

## **Gasto~Tratamiento**

```{r}

tabgastoyestado<-table(DFN$Estado, DFN$Gasto)
barplot(tabgastoyestado, main="Relación Estado del paciente~Gasto(Soles)",col=c("red","yellow", "green"))

legend(x="topright", legend=c("Crítico","Grave","Leve"),fill = c("red","yellow","green"), title="leyenda")

```

Se puede observar que mientras el estado del paciente sea peor, es decir, cuando se llegue al estado grave o crítico, entonces va a haber un mayor gasto económico. En cambio, para estados leves se tiene a un menor gasto económico. También se pude apreciar que a medida el precio aumenta la cantidad de personas disminuye y en los valores más altos solo encontramos personas con un estado grave y crítico. También vemos que en su mayoría las personas que estuvieron en un estado leve gastaron aproximadamente 120 soles y las personas que estuvieron en estado leve y crítico en su mayoría gastaron por encima de 900 soles.

## **Covid Veces~Establecimiento Veces**

```{r}
COVID19_Veces <- DFN$COVID19_Veces
Establecimiento_Veces <- DFN$Establecimiento_Veces

tabCyE<-table(COVID19_Veces, Establecimiento_Veces)
boxplot(formula=COVID19_Veces~Establecimiento_Veces, data=DFN,col="green", horizontal = T)

```

En el eje X de los boxplots podemos ver las veces que un estudiante UTEC ha sido infectado por COVID-19 donde el valor mas bajo es cero y 7 el valor mas alto. En el eje Y tenemos las veces que los estudiantes fueron a un establecimiento médico. Como se puede observar, en los casos que los alumnos que nunca fueron a un establecimiento son los que no fueron contagiados o los que fueron contagiados máximo dos veces; también se puede ver que mientras más veces el estudiante fue infectado este a su vez recurrió más veces a un establecimiento médico.

 

 