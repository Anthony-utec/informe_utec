---
title: "Impacto económico y de salubridad que dejó el  Covid-19 a los estudiantes
  de UTEC"
output:
  html_document:
    toc: yes
    theme: united
  pdf_document:
    toc: yes
---

# **Introducción**

La pandemia del Coronavirus fue un asunto que agarró a mucha gente desprevenida, causando entre tantas cosas un impacto en la economía debido a que los trabajos de muchas personas se vieron afectados. Esta investigación tiene como fin medir el impacto del Covid 19 en la economía de los familiares de los estudiantes de UTEC y ver si esto afectó en sus estudios.

## **Relevancia**

Investigar sobre cómo el Covid-19 afectó económicamente a las familias de los estudiantes de UTEC es de suma importancia debido a las implicaciones significativas que esta crisis sanitaria ha tenido en la vida de las personas. Al abordar este tema, vamos a obtener una comprensión profunda de los desafíos económicos a los que se enfrentaron las familias durante la pandemia y cómo estos desafíos afectaron directamente la continuidad de los estudios universitarios de los estudiantes de UTEC. Uno de los objetivos secundarios es conocer el estado en el que las personas se encontraban si contrajeron el Covid-19, ya sea leve, grave o crítico. Esto es esencial para comprender el impacto de la enfermedad en la salud de los estudiantes y sus familias, al identificar la gravedad de los casos de Covid-19, se podrá evaluar mejor la correlación entre el estado de salud y el impacto económico experimentado por las familias. Además, mostrar los gastos económicos invertidos en el tratamiento de los estudiantes UTEC afectados por la Covid-19 proporcionará una visión detallada de la carga financiera que las familias tuvieron que soportar. Esto incluirá no solo los costos médicos directos, como las consultas médicas, los medicamentos y las hospitalizaciones, sino también los gastos adicionales relacionados con la prevención y el control del virus, como los equipos de protección personal y las pruebas de diagnóstico. Los resultados de esta investigación pueden ser para implementar medidas de apoyo efectivas y promover el bienestar académico y económico de los estudiantes de UTEC y sus familias en el contexto post pandémico.

## **Objetivos**

### **Principal**

El objetivo principal del estudio es evaluar como el Covid-19 afectó económicamente a las familias de los estudiantes de la UTEC y mediante los datos recolectados analizar, entender y concluir si este perjudicó los estudios universitarios de estos.

### **Secundarios**

-   Conocer el estado en el que la persona se encontraba si le dió Covid-19 (Estado leve, grave o crítico)

-   Mostrar gastos económicos invertidos en el tratamiento de los estudiantes UTEC afectados por la COVID-19

-   Conocer los tratamientos seguidos por los pacientes afectados por el Covid-19 vinculados a los estudiantes de UTEC

## **Contexto**

-Gastos médicos: En algunos casos, los estudiantes universitarios pueden haber enfrentado gastos médicos adicionales debido a la pandemia. Esto puede incluir pruebas de COVID-19, tratamiento médico, visitas a establecimientos médicos, y entre otros. Estos gastos pueden haber ejercido presión sobre los recursos económicos de los estudiantes y sus familias.

-Impacto en la salud: Los estudiantes universitarios que contrajeron COVID-19 pueden haber experimentado una variedad de síntomas, desde síntomas leves, graves y hasta críticos que requerían hospitalización. La enfermedad en sí misma puede haber causado gripe, fiebre, pérdida gustativa y olfativa, y entre otros.

# **Datos**

## **Proceso de recolección de datos**

Se elaboró un formulario mediante el cual se fueron recolectando los datos necesarios para la investigación. Este formulario se compartió por diferentes grupos de estudio de la UTEC mediante enlaces y también fue respondido mediante QR en la misma universidad. Además, las preguntas del formulario contaban con un rango de respuestas para que a la hora de hacer la limpieza de datos no hayan demasiados datos incongruentes.

## **Población, muestra y muestreo**

### **Población**

La población son los estudiantes de Pre-grado de Universidad de Ingeniería y Tecnología del semestre 2023-1.

### **Muestra**

El tamaño de la muestra son 170 alumnos, lo cual representa una cantidad significativa que nos permitirá trabajar con estos datos.

### **Muestreo**

Esta investigación se realizó con muestreo aleatorio simple.

## **Variables**

**Variables numéricas**

| Variable              | Tipo              | Restricciones             |
|:----------------------|:------------------|:--------------------------|
| Edad                  | Numérica discreta | Entero positivo [15-60]   |
| Ciclo                 | Numérica discreta | Entero positivo [1-10]    |
| Peso                  | Numérica continua | Número real [40-150]      |
| Altura                | Numérica continua | Número real [130-200]     |
| Familiares_Infectados | Numérica discreta | Entero positivo [0-20]    |
| Tiempo_Infección      | Numérica discreta | Entero positivo [0-100]   |
| Vacunas_Recibidas     | Numérica discreta | Entero positivo [0-6]     |
| Establecimiento_Veces | Numérica discreta | Entero positivo [0-30]    |
| COVID19_Veces         | Numérica discreta | Entero positivo [0-10]    |
| PruebasDescarte_Veces | Numérica discreta | Entero positivo [0-50]    |
| Gasto                 | Numérica continua | Número positivo mayor a 0 |

**Variables categóricas**

| Variable          | Tipo               | Restricciones         |
|:------------------|:-------------------|:----------------------|
| Escala            | Categórica ordinal | Respuesta obligatoria |
| Distrito          | Categórica nominal | Respuesta obligatoria |
| Estado            | Categórica ordinal | Respuesta obligatoria |
| Tratamiento       | Categórica ordinal | Respuesta obligatoria |
| Sintomas          | Categórica nominal | Respuesta obligatoria |
| Vacunas_Recibidas | Categórica nominal | Respuesta obligatoria |
| Variante          | Categórica nominal | Respuesta obligatoria |
| Tipo_Prueba       | Categórica nominal | Respuesta obligatoria |

## **Limpieza de base de datos**

```{r,include=FALSE}
librerias <- c("readr","dplyr","tidyr","modeest","tidyverse","ggplot2")

libreriasF = librerias[!(librerias %in% rownames(installed.packages()))]

if (length(libreriasF) > 0) {
    install.packages(libreriasF)
}
lapply(librerias, library, character.only = TRUE)

```

Primero, hay que cargar el archivo en el que se encuentran nuestros datos para comenzar con la limpieza

```{r}
DF <- read_csv("Encuesta.csv")
```

Eliminamos las columnas que no nos sirven

```{r}
DF <- select(DF, -`Marca temporal`)
```

Cambiaremos el nombre de las variables para un trabajo más eficiente

```{r}
DF %>% rename(Edad = `Ingrese su edad`, Ciclo = `Ingrese su ciclo`, Peso = `Ingrese su peso en kg`, Altura = `Ingrese su altura (En centímetros)`, Escala = `Seleccione su escala` , Distrito = `Elija el distrito donde reside`, Familiares_Infectados = `¿Cuántas personas afectadas de Covid hubo en su familia?`, Tiempo_Infección = `¿Cuánto tiempo duro la infección del Covid-19 en su caso? Tiempo en días.`, Vacunas_Recibidas = `¿Cuántas vacunas recibió para contrarrestar el Covid-19 ?`, Establecimiento_Veces =`Ingrese el número de veces que acudió a un establecimiento médico durante la pandemia (2020-2022)`, COVID19_Veces = `¿Cuántas veces le dio el Covid-19?`, PruebasDescarte_Veces = `¿Cuántas veces durante la pandemia se realizó las pruebas de descarte de Covid-19?`, Estado = `Seleccione cual fue estado de gravedad como paciente de Covid-19`, Gasto = `¿Aproximadamente cuánto se gastó (en soles) en el tratamiento para la persona afectada de Covid 19?`, Tratamiento = `Seleccione el tratamiento seguido`, Sintomas = `Seleccione los síntomas que tuvo`, Vacuna = `Seleccione el tipo de vacunas recibidas`, Variante = `Seleccione que variante del Covid-19 le afecto`, TipoPrueba = `¿Qué tipo de prueba de descarte del Covid-19 se realizo?`) -> DFN
```

Entonces procederemos con la limpieza de datos

```{r}
table(complete.cases(DFN))
```

Podemos observar el total de observaciones, que son 170. De estas 170, hay 157 observaciones completas y 13 incompletas. Procederemos a eliminar los datos faltantes.

```{r}
DFN = na.omit(DFN)
```

Con esto eliminamos los pocos datos faltantes presentes en el data frame. Ahora verificaremos las variables y eliminaremos los datos no representativos de estas.

**Tiempo de infección**

```{r}
DFN$Tiempo_Infección[DFN$Tiempo_Infección > 60] <- NA
```

Los datos transformados a NA's los eliminamos

```{r}
DFN = na.omit(DFN)
```

Algunas variables cuentan con respuestas de más de una opción, por ello, separaremos en diferentes columnas los datos que tengan más de una opción.

**Tipo de prueba**

Con la función separate crearemos 3 variables nuevas que serán: Molecular, Antígena y Ninguna, las cuales representan las opciones disponibles a marcar.

```{r}
DFN <- DFN %>% separate(TipoPrueba, c("Molecular","Antigena","Ninguna"), sep = ",")
```

A partir de ahora nos centraremos en convertir los datos marcados en TRUE y FALSE

```{r}
DFN$Molecular[DFN$Molecular == "Molecular"] <- TRUE
DFN$Antigena[DFN$Molecular == "Antigena"] <- TRUE
DFN$Ninguna[DFN$Molecular == "Ninguna"] <- TRUE
DFN$Antigena[DFN$Antigena == " Antigena"] <- TRUE
DFN$Molecular[DFN$Molecular == "Antigena"] <- FALSE
DFN$Molecular[DFN$Molecular == "Ninguna"] <- FALSE
DFN$Antigena[is.na(DFN$Antigena)] <- FALSE
DFN$Ninguna[is.na(DFN$Ninguna)] <- FALSE
```

Aquí tenemos el resumen de la cantidad de personas que se han hecho la prueba molecular, antígena y las que no se han hecho ninguna de las dos.

```{r}
DFN %>%
  group_by(Molecular,Antigena,Ninguna) %>%
  tally()
```

**Vacunas recibidas**

Con las vacunas tenemos el mismo caso que con el tipo de pruebas, por lo tanto, crearemos 3 nuevas variables que serán: Pfizer, AstraZeneca y Sinopharm, cada TRUE indicará que la opción fue marcada y cada FALSE indicará que la opción **NO** fue marcada.

```{r}
DFN <- DFN %>% separate(Vacuna, c("Pfizer","AstraZeneca","Sinopharm"), sep = ",")
```

```{r}
DFN$Pfizer[DFN$Pfizer == "Pfizer"] <- TRUE
DFN$Sinopharm[DFN$Pfizer == "Sinopharm"] <- TRUE
DFN$Sinopharm[DFN$AstraZeneca == " Sinopharm"] <- TRUE
DFN$Sinopharm[DFN$Sinopharm == " Sinopharm"] <- TRUE
DFN$AstraZeneca[DFN$Pfizer == "AstraZeneca"] <- TRUE
DFN$AstraZeneca[DFN$AstraZeneca == " AstraZeneca"] <- TRUE
DFN$Pfizer[DFN$Pfizer != "TRUE"] <- FALSE
DFN$AstraZeneca[DFN$AstraZeneca != "TRUE"] <- FALSE
DFN$AstraZeneca[is.na(DFN$AstraZeneca)] <- FALSE
DFN$Sinopharm[is.na(DFN$Sinopharm)] <- FALSE
```

Con table podemos ver un resumen de la cantidad de personas que se pusieron las diferentes vacunas.

```{r}
DFN %>%
  group_by(Pfizer,AstraZeneca,Sinopharm) %>%
  tally()
```

Y con esto tendríamos la base de datos limpia

```{r}
summary(DFN)
```

# **Análisis descriptivo**

## **Estado\~Tratamiento**

```{r}
Estado <- DFN$Estado
Tratamiento <- DFN$Tratamiento
ggplot(data = NULL, aes(x = Estado, y = Tratamiento)) + 
  geom_jitter(aes(color = Estado), size = 1, alpha = 0.7) +
  xlab('Estado') + 
  ylab('Tratamiento') +
  ggtitle('Relación entre el estado del paciente y su tratamiento') + 
  theme_minimal()



```

Observamos que para cuando son estados críticos o graves hay una tendencia a preferir la hospitalización, en cambio, para cuando son casos leves se prefiere un tratamiento en la casa. Asimismo, hay una pequeña parte en casos leves que prefieren no ser hospitalizados, o ser llevados a la clínica a fin de ser su tratamiento. Aunque esto nos desvela que los estudiantes UTEC frente al COVID-19 en su mayoría prefieren tomarse cuidados por su cuenta, ya sea en su casa o sin hospitalización, por lo tanto, hay riesgo de que al no seguir un tratamiento médico podría escalar a caso grave o crítico.

## **Gasto\~Tratamiento**

```{r}

tabgastoyestado<-table(DFN$Estado, DFN$Gasto)
barplot(tabgastoyestado, main="Relación Estado del paciente~Gasto(Soles)",col=c("red","yellow", "green"))

legend(x="topright", legend=c("Crítico","Grave","Leve"),fill = c("red","yellow","green"), title="leyenda")

```

Se puede observar que mientras el estado del paciente sea peor, es decir, cuando se llegue al estado grave o crítico, entonces va a haber un mayor gasto económico. En cambio, para estados leves se tiene a un menor gasto económico. También se pude apreciar que a medida el precio aumenta la cantidad de personas disminuye y en los valores más altos solo encontramos personas con un estado grave y crítico. También vemos que en su mayoría las personas que estuvieron en un estado leve gastaron aproximadamente 120 soles y las personas que estuvieron en estado leve y crítico en su mayoría gastaron por encima de 900 soles.

## **Covid Veces\~Establecimiento Veces**

```{r}
COVID19_Veces <- DFN$COVID19_Veces
Establecimiento_Veces <- DFN$Establecimiento_Veces

tabCyE<-table(COVID19_Veces, Establecimiento_Veces)
boxplot(formula=COVID19_Veces~Establecimiento_Veces, data=DFN,col="green", horizontal= T,main= "Relación Covid19_Veces~Establecimiento_Veces")

```

En el eje X de los boxplots podemos ver las veces que un estudiante UTEC ha sido infectado por COVID-19 donde el valor mas bajo es cero y 7 el valor mas alto. En el eje Y tenemos las veces que los estudiantes fueron a un establecimiento médico. Como se puede observar, en los casos que los alumnos que nunca fueron a un establecimiento son los que no fueron contagiados o los que fueron contagiados máximo dos veces; también se puede ver que mientras más veces el estudiante fue infectado este a su vez recurrió más veces a un establecimiento médico.

# **Análisis probabilístico**

## **Probabilidad empírica**

### **Variable: Covid19_Veces**

**Evento: Cantidad de veces que fueron afectados los estudiantes de UTEC por el Covid-19.**

```{r}
DFN %>%
  group_by(COVID19_Veces) %>%
  tally()

```

```{r}
tabla <- table(DFN$COVID19_Veces)
ProbTabla <- prop.table(tabla)
ProbTabla
```

Una vez analizadas las probabilidades empíricas de todos los eventos atómicos de la variable "Covid19_Veces" podemos comprender las situaciones en la que los estudiantes estuvieron implicados. Por ejemplo, la probabilidad de que un estudiante de UTEC haya sido afectado dos veces por el Covid-19 es del 28%. Las probabilidades de estos eventos son importantes para analizar la relación de la afectación económica con respecto a las veces que fueron afectados por el Coronavirus.

### **Variable: Estado**

**Evento: Estado de los estudiantes de UTEC al contraer el Covid19.**

```{r}
DFN %>%
  group_by(Estado) %>%
  tally()
```

```{r}
tabla <- table(DFN$Estado)
ProbTabla <- prop.table(tabla)
ProbTabla
```

Una vez analizadas las probabilidades empíricas de todos los eventos atómicos de la variable "Estado" podemos comprender las situaciones en la que los estudiantes estuvieron implicados. Por ejemplo, la probabilidad de que un estudiante de UTEC haya tenido un caso crítico debido al Covid19 es del 20%. Las probabilidades de estos eventos son importantes para analizar la relación de la afectación económica con respecto al estado del paciente cuando este tuvo Covid19.

## **Probabilidad condicional**

### **Eventos dependientes**

**Evento A: Seleccionar un alumno que haya tenido Covid19 dos veces o más.**

**Evento B: Seleccionar un alumno con un gasto mayor o igual al promedio.**

```{r}
A <- DFN$COVID19_Veces
B <- DFN$Gasto
```

```{r}
#Probabilidad de que un estudiante haya tenido 2 o más veces Covid19
A1 <- filter(DFN,A >= 2)
s <- nrow(A1)
n <- nrow(DFN)
ProbA1 <- round(s/n, 2)
ProbA1

#Probabilidad de que un estudiante haya tenido Covid19 menos de 2 veces
A2 <- filter(DFN,A < 2)
ProbA2 <- round(nrow(A2)/n, 2)
ProbA2
```

```{r}
m <- mean(DFN$Gasto)
#Probabilidad de que un estudiante haya tenido un gasto mayor o igual al promedio.
B1 <- filter(DFN,B>=m)
ProbB1 <- round(nrow(B1)/n,2)
ProbB1

#Probabilidad de que un estudiante haya tenido un gasto menor al promedio.
B2 <- filter(DFN,B<m)
ProbB2 <- round(nrow(B2)/n,2)
ProbB2
```

Para validar la independencia de estos eventos usaremos la siguiente formula:

$$P(A ∩ B) = P(A)P(B)$$

```{r}
TA <- sum((A>=2)&(B>=m))+sum((A>=2)&(B<m))
TB <- sum((B>=m)&(A>=2))+sum((B>=m)&(A<2))
P1 <- (TA/n)*(TB/n)
P1
```

Asumimos que estos dos eventos son dependientes entre sí, entonces:

$$P(A|B) =P(A ∩ B) /P(B)$$

```{r}
#Probabilidad condicional
PAB <- P1/ProbB1
PAB
```

### **Eventos independientes**

**Evento A: Seleccionar un alumno con más de 20 años.**

**Evento B: Seleccionar un alumno que estuvo con Covid19 por más de 20 días.**

```{r}
a <- DFN$Edad
b <- DFN$Tiempo_Infección
```

```{r}
#Probabilidad de que un estudiante tenga más de 20 años
a1 <- filter(DFN,a > 20)
Proba1 <- round(nrow(a1)/n, 2)
Proba1

#Probabilidad de que un estudiante tenga 20 años o menos
a2 <- filter(DFN,a <= 20)
Proba2 <- round(nrow(a2)/n, 2)
Proba2
```

```{r}
#Probabilidad de que un estudiante tenga más de 20 días enfermo
b1 <- filter(DFN,b > 20)
Probb1 <- round(nrow(b1)/n, 2)
Probb1

#Probabilidad de que un estudiante tenga 20 días o menos enfermo
b2 <- filter(DFN,b <= 20)
Probb2 <- round(nrow(b2)/n, 2)
Probb2
```

Para validar la independencia de estos eventos usaremos la siguiente formula:

$$P(A ∩ B) = P(A)P(B)$$

```{r}
Ta <- sum((a>20)&(b>20))+sum((a>20)&(b<=20))
Tb <- sum((b>20)&(a>20))+sum((b>20)&(a<=20))
p1 <- (Ta/n)*(Tb/n)
p1
```

Asumimos que estos dos eventos son independientes, por lo tanto:

$$
 P(B|A) = P(A|B)P(B) / P(A)
$$

```{r}
Pab <- sum((a>20)/n)
Pb <- sum((b>20)/n)
Pa <- Proba1*Probb1 + Proba2*Probb2
Pba <- (Pab*Pb)/Pa
Pba
```

## **Variables Aleatorias discretas**

### **Distribución Binomial para la variable Covid19_Veces**

En la realización de este trabajo se han encuestado a 170 alumnos de UTEC sobre la cantidad de veces que tuvieron Covid19. Anteriormente se ha calculado la probabilidad de que un alumno haya tenido dos veces o más Covid19 (0.46). Se desea saber cual es la probabilidad de que de 50 alumnos encuestados aleatoriamente, 25 hayan tenido dos o más veces Covid19.

**Identificación de parámetros**

El modelo que usará para trabajar será el modelo binomial, ya que podemos hallar la probabilidad del éxito en una cantidad fija.

X: Cantidad de alumnos que han tenido Covid19 dos veces o más en un grupo de 50 alumnos

n: Cantidad fija de intentos (50 alumnos)

X \~ Binom(n=50, p=0.46)

Usando la formula del modelo binomial: $$p_{\mathbb{X}}(x)=\binom{n}{x}p^x(1-p)^{n-x }$$

```{r}
choose(50,25)*((0.46)^25)*((1-0.46)^(50-25))
```

En este caso vemos que la probabilidad de encontrar a 25 alumnos que hayan tenido más de dos veces Covid19 en un grupo de 50 encuestados es del 9.56%. Para comprobar este resultado usaremos una gráfica de la función masa.

```{r}
barra<-colores <- c(rep("blue",25))
barplot(dbinom(0:50,size = 50,prob = 0.46),names.arg=c(0:50),main="Función de masa", ylab="Probabilidad", xlab="Alumnos que tuvieron Covid19 dos o más veces",col=barra)
```

Apoyándonos en la gráfica se puede deducir que hay mayor probabilidad de encontrar entre 22 y 24 alumnos que hayan tenido Covid19 dos o más veces en un grupo de 50 alumnos.

### **Distribución binomial para la variable Vacunas_Recibidas**

En este caso, se desea saber cual es la probabilidad de que en un grupo fijo de 100 alumnos 50 de ellos se hayan vacunado dos o menos veces, teniendo en cuenta de que la probabilidad de que un alumno se haya vacunado dos o menos veces es del 17%.

X: Cantidad de alumnos que se han vacunado dos o menos veces en un grupo de 100 alumnos

n: Cantidad fija de intentos (100 alumnos)

X \~Binom(n=100,p=0.17)

```{r}
choose(100,50)*((0.17)^50)*((1-0.17)^(100-50))
```

En el siguiente caso se puede observar que la probabilidad de encontrar a 50 alumnos que se hayan vacunado dos veces o menos en un grupo de 100 encuestados es casi del 0%. Para comprobar este resultado usaremos una gráfica de la función masa.

```{r}
barra<-colores <- c(rep("blue",50))
barplot(dbinom(0:100,size = 100,prob = 0.17),names.arg=c(0:100),main="Función de masa", ylab="Probabilidad", xlab="Alumnos que tuvieron Covid19 dos o más veces",col=barra)
```

## **Variables Aleatorias Continuas**

Se desea saber la probabilidad de que los estudiantes UTEC presenten menos de 8 días de infección

```{r}
#Paso 1: Identificar gráficamente una variable aleatoria continua
library(ggplot2)
```

Añadir la curva de normalidad

```{r}
library(readr)
EncuestaLIMPIO <- read_csv("EncuestaLIMPIO.csv", 
                           col_types = cols(Edad = col_number(), 
                                            Ciclo = col_number(), Peso = col_number(), 
                                            Altura = col_number(), Escala = col_character(), 
                                            Familiares_Infectados = col_number(), 
                                            Tiempo_Infección = col_number(), 
                                            Vacunas_Recibidas = col_number(), 
                                            Establecimiento_Veces = col_number(), 
                                            COVID19_Veces = col_number(), PruebasDescarte_Veces = col_number(), 
                                            Molecular = col_logical()))
ggplot(EncuestaLIMPIO, aes(x = Tiempo_Infección)) +
  geom_density(fill = "lightblue", color = "black") +
  labs(x = "Tiempo_Infección", y = "Densidad", title = "Gráfico de Densidad - Tiempo de infección") +
  theme_minimal() +
  stat_function(fun = dnorm, args = list(mean = mean(EncuestaLIMPIO$Tiempo_Infección), sd = sd(EncuestaLIMPIO$Tiempo_Infección)), color = "red", linewidth = 1)
```

```{r}
library(ggplot2)

# Histograma de la variable familiares infectados
ggplot(EncuestaLIMPIO, aes(x = Tiempo_Infección)) +
  geom_histogram(color = "black", fill = "red", bins = 10) +
  labs(x = "Familiares infectados", y = "Frecuencia", title = "Histograma de tiempo de infección") +
  theme_minimal()
```

```{r}
#Paso 2: Validación de normalidad

#Si se cumple estas condiciones, en tanto tenemos que verificarlo:

#Distribución simétrica:

#Se puede ver que no es tán simétrico como parece, pero podría llegar a ser, sin embargo, ahorita haremos los cálculos.

#Media es aproximadamente a la mediana:
mean(EncuestaLIMPIO$Tiempo_Infección)
median(EncuestaLIMPIO$Tiempo_Infección)

# mean = 14.15484
# mediana = 13
```

Observando los valores de la media y la mediana, masomenos no difieren tanto, podrían aproximarse estos valores.

```{r}
#Varianza es aproximadamente a la desviación estándar al cuadrado
var(EncuestaLIMPIO$Tiempo_Infección)
(sd(EncuestaLIMPIO$Tiempo_Infección))^2

# var = 116.3395
# sd^2 = 116.3395
```

```{r}
probabilidades <- c((table(EncuestaLIMPIO$Tiempo_Infección < 8) / nrow(EncuestaLIMPIO)))
esperanza_T <- mean(EncuestaLIMPIO$Tiempo_Infección, weights = probabilidades)

mean(EncuestaLIMPIO$Tiempo_Infección)
print(esperanza_T)

# mean = 14.15484
# esperanza = 14.15484

```

```{r}
#Paso 3: Parámetros sería la media y la desviación estándar por si se acerca a una distribución normal
# u = media
u <- mean(EncuestaLIMPIO$Tiempo_Infección)
# sigma = desviación estándar
sigma <- sd(EncuestaLIMPIO$Tiempo_Infección)

#X ~ N(u, sigma)

```

```{r}
#Paso 4: Usar las probabilidades

#Probabilidad de tiempo de infección
# X <- Tiempo de infección
# P(X > 7)

pnorm(7, u, sigma, lower.tail = F)
```

```{r}
#La probabilidad de que los estudiantes UTEC presenten un tiempo de infección mayor a 7 días es 0.75.
```

#Usando otra variable continua

#Se desea saber la probabilidad de que los familiares infectados de los estudiantes UTEC, sea menor a 4

```{r}
#Paso 1: Identificar gráficamente una variable aleatoria continua
library(ggplot2)

# Añadir la curva de normalidad
ggplot(EncuestaLIMPIO, aes(x = Familiares_Infectados)) +
  geom_density(fill = "blue", color = "black") +
  labs(x = "Tiempo_Infección", y = "Densidad", title = "Gráfico de Densidad - Familiares infectados") +
  theme_minimal() +
  stat_function(fun = dnorm, args = list(mean = mean(EncuestaLIMPIO$Familiares_Infectados), sd = sd(EncuestaLIMPIO$Familiares_Infectados)), color = "red", linewidth = 1)
```

```{r}
library(ggplot2)

# Histograma de la variable familiares infectados
ggplot(EncuestaLIMPIO, aes(x = Familiares_Infectados)) +
  geom_histogram(color = "black", fill = "yellow", bins = 10) +
  labs(x = "Familiares infectados", y = "Frecuencia", title = "Histograma de familiares infectados") +
  theme_minimal()
```

```{r}
#Paso 2: Validación de normalidad

#Si se cumple estas condiciones, en tanto tenemos que verificarlo:

#Distribución simétrica:

#Se puede ver que no es tán simétrico como parece, pero podría llegar a ser, sin embargo, ahorita haremos los cálculos.

#Media es aproximadamente a la mediana:

mean(EncuestaLIMPIO$Familiares_Infectados)
median(EncuestaLIMPIO$Familiares_Infectados)

# mean = 3.593548
# mediana = 3

#Observando los valores de la media y la mediana, masomenos no difieren tanto, podrían aproximarse estos valores.

#Varianza es aproximadamente a la desviación estándar al cuadrado
var(EncuestaLIMPIO$Familiares_Infectados)
(sd(EncuestaLIMPIO$Familiares_Infectados))^2

# var = 6.91814
# sd^2 = 6.91814
```

```{r}
#Esperanza debe ser aproximadamente a la media
probabilidades <- c((table(EncuestaLIMPIO$Familiares_Infectados < 4) / nrow(EncuestaLIMPIO)))
esperanza_F <- mean(EncuestaLIMPIO$Familiares_Infectados, weights = probabilidades)

print(esperanza_F)

# mean = 3.593548
# esperanza = 3.593548
```

```{r}
#Paso 3: Parámetros sería la media y la desviación estándar por si se acerca a una distribución normal
# u = media
u <- mean(EncuestaLIMPIO$Familiares_Infectados)
# sigma = desviación estándar
sigma <- sd(EncuestaLIMPIO$Familiares_Infectados)

#X ~ N(u, sigma)
```

```{r}
#Paso 4: Usar las probabilidades

#Probabilidad de familiares infectados < 4
# X <- Familiares infectados
# P(X < 4)

pnorm(4, u, sigma, lower.tail = F)
```

```{r}
#La probabilidad de que los estudiantes UTEC presenten menor que 4 familiares infectados es 0.83.
```

# **Conclusiones**

-   Las variables con más foco de atención dentro del estudio son: gasto, Covid_19veces y Estado.
-   En la mayoría de casos los estudiantes de UTEC sufrieron un caso leve de coronavirus, sin embargo, la otra parte de alumnos que representan los casos graves y críticos también representan una cifra significativa.
-   Mediante los resultados de la parte del análisis probabilístico concluimos que realmente hubo una afectación económica en algunos estudiantes de UTEC, gastando en algunos casos más de 1000 soles.
