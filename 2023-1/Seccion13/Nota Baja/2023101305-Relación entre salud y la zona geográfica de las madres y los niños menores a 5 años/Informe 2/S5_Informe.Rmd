---
title: "Proyecto Grupal - Entrega 2" 
output:
  html_document:
    df_print: paged
  pdf_document: default
subtitle: Relación entre salud y la zona geográfica de las madres y los niños menores a 5 años. 
---

# La fecundidad y salud materna en el Perú: Los factores a nivel nacional que afectan la salud reproductiva, abortiva, infantil y de índole familiar.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Contenidos

1.  Introducción

    -   Relevancia del tema escogido
    -   Objetivos
    -   Ventajas
    -   Planificación

2.  Datos

    -   Proceso de recolección de datos
    -   Población, muestra y muestreo
    -   Variables
    -   Limpieza de base de datos

3.  Análisis descriptivo

4.  Probabilidades

5.  Variables aleatorias y modelos

6.  Conclusión

## Introducción:

-   En el Perú, desde que nos encontramos en la era republicana los temas de fecundidad y mortalidad infantil siempre han sido temas de preocupación familiar y nacional. Ante todo, a mediados del siglo XX donde el pico de mortalidad infantil y, a su vez, de fertilidad llegaron a su pico más alto, debido a la masivas migraciones que se hacían a la capital y, que por consiguiente, generaron una deficiente distribución territorial y malas condiciones de vida, que trajeron consecuencias en la salud materna y familiar de las clases más pobres, lo cual, hizo a su vez que la tasa de mortalidad general aumentara en la nación.
-   En la actualidad, este tema no debe ser descuidado ni considerado como un tema de desinteresada importancia, pues aun hasta la fecha vemos zonas de lima en donde las condiciones de vida no son óptimas para tener una buena calidad de salud reproductiva, abortiva, infantil y de índole familiar. Es por esto mismo, que como grupo nos encontramos interesados en abordar el tema de "Salud Familiar" para generar interés, conocimiento y, sobre todo, preocupación entre las personas.
-   A partir de lo mencionado anteriormente, el objetivo general de este estudio es poder comprobar si existe una relación directa entre la salud de las madres y los niños menores a 5 años con la zona geográfica donde se encuentran, para brindar una mejor respuesta a la incógnita nos basamos en la recopilación de datos de una encuesta hecha por INEI en el 2012 a madres y niños de todo el Perú, mediante esta encuesta obtendremos los datos relevantes para nuestra investigación separando a los evaluados por su zona geográfica para que finalmente obtengamos quienes presenta en promedio mayor índice de buena salud y por lo tanto sacar una conclusión certera.

### Relevancia del estudio:

-   La relevancia de este estudio la podemos hallar en el análisis la relación entre los factores que afectan la salud y la ubicación de los participantes en la Encuesta Nacional Demográfica y de Salud Familiar. Esto lo podremos lograr através de los siguentes obejtivos:
    -   Evaluar la prevalencia de las principales enfermedades y padecimientos en el Perú en 2012, incluyendo enfermedades crónicas, infecciosas y mentales por departamentos del Perú.
    -   Analizar las características demográficas de la población encuestada en 2012, y evaluar la relación con los factores que afectan la salud de los participantes de la encuesta.
    -   Evaluar la accesibilidad y calidad de los servicios de salud en el Perú en 2012, incluyendo la disponibilidad de servicios, la satisfacción de los usuarios y las barreras para el acceso.

### Objetivos:

-   Objetivo general: El propósito principal de este estudio es investigar la relación entre la salud materno-infantil y la zona geográfica en madres y niños menores de 5 años, utilizando las variables disponibles en la base de datos proporcionada. Se pretende analizar cómo diferentes factores relacionados con la ubicación geográfica pueden afectar la salud de esta población específica. Se describirá y analizar la distribución geográfica de madres y niños menores de 5 años en relación con indicadores de salud específicos. Se utilizarán variables como "Año", "País", "Región" y "Tipo de lugar de residencia" para examinar cómo estos factores geográficos pueden influir en la salud.
-   Objetivo específico 1: Cuantificar la prevalencia de las principales enfermedades y padecimientos en el Perú en 2012, dependiendo de su sexo y edad.
-   Objetivo específico 2: Identificar las características demográficas de la población encuestada en 2012, y determinar la relación con los problemas de salud de los participantes de la encuesta.
-   Objetivo específico 3: Determinar la accesibilidad y calidad de los servicios de salud en el Perú en 2012,sobre todo las barreras en el acceso.

### Ventajas:

1.  Concientización y conocimiento que podemos llegar a generar en todas las personas que revisen nuestro proyecto, su previo estudio y el respectivo análisis descriptivo que tendremos que realizar con la base de datos y sus diversas variables y gráficas descriptivas.
2.  Nos permite comprender las necesidades de la población mediante los datos extraídos de la encuesta, para así poder desarrollar una mejor calidad de vida para esta misma.Asimismo, el estudio nos ayudará a saber cuáles son las características en común de una población vulnerable.
3.  Permite conocer la percepción de los usuarios sobre los servicios de salud, lo que es útil para los centros de salud y encargados para identificar oportunidades de mejora y optimizar el acceso a los servicios.

### Planificación:

<center>

![Planificación](Planificacion.png)

</center>

## Datos:

### Recolección de datos:

-   En este proyecto se optó por el análisis de bases de datos públicas, de un tema muy preocupante como es la relación entre salud y la zona geográfica de las madres, para lo cual se tomó como estudio de analizar los datos de los últimos años.

#### [Fuente de los datos:](https://www.datosabiertos.gob.pe/dataset/encuesta-demogr%C3%A1fica-y-de-salud-familiar-endes-2012-instituto-nacional-de-estad%C3%ADstica-e)

-   <https://www.datosabiertos.gob.pe/dataset/encuesta-demogr%C3%A1fica-y-de-salud-familiar-endes-2012-instituto-nacional-de-estad%C3%ADstica-e>

#### Base de datos: (Tabla)

```{r}
library(readr)
DF <- read_csv('RECH0_7.csv')
DF
DF2 <- read_csv("RECH5.csv")
```

### Población, muestra y muestreo:

-   Población: Madres y niños menores a 5 años en el Perú
-   Tipo de muestreo: La población, en este caso, serían las madres entre 12 a 49 años de edad y niños menores de 5 años de 24 departamentos del Perú y la muestra probabilística, por áreas, estratificadas, bioetópicas e independientes de cada departamento fueron escogidas estratégicamente por la base de datos del INEI donde se considero como universo poblacional las hogares particulares y sus miembros.
-   La muestra, por este criterio selectivo, será igual a la población delimitada por INEI donde se trabajará con 27825.
-   Tipos de variables: Categóricas y numéricas.
-   Instrumento para la recolección: Se uso como estrategia encuestas dirigidas a hogares principales y hogares secundarios

### Variables (respectivamente a la base):

-   Numérica - Año
-   Categórica - Código
-   Categórica - País
-   Numérica - Grupo
-   Numérica - Número de hogar
-   Numérica - Número de Casa
-   Numérica - Número de línea del encuestado
-   Numérica - Unidad de Área
-   Numérica - Peso de la muestra
-   Numérica - Mes de la entrevista
-   Numérica - Año de la entrevista
-   Numérica - Fecha de entrevista
-   Numérica - Número de miembros del hogar
-   Numérica - Número de mujeres
-   Numérica - Número de hombres
-   Numérica - Número de miembros de derecho
-   Numérica - Número de miembros de hecho
-   Numérica - Número de niños menores de 5 años
-   Categórica - Resultado de la entrevista del hogar
-   Numérica - Día de la entrevista
-   Numérica - Número de visitas
-   Categórica - Identificación del entrevistador
-   Categórica - Identificación del manipulador
-   Categórica - Muestra alguna vez casada
-   Categórica - Unidad primaria de muestreo
-   Numérica - Número de estrato de muestra
-   Categórica - Dominio de muestra
-   Categórica - Región
-   Categórica - Tipo de lugar de residencia
-   Categórica - Lugar de residencia
-   Categórica - Selección para hombre/esposo
-   Numérica - Número de niños elegibles por altura y peso
-   Numérica - Total de adultos medidos
-   Categórica - Selección para hemoglobina
-   Numérica - Selección para el módulo de estatus de la mujer
-   Numérica - Selección para el módulo de violencia doméstico

## Limpieza de base de datos:

### Variables a utilizar para el analisis descriptivo:

-   categórica nominal - Año de la entrevista (ID1)
-   Categórica nominal - País (HV000)
-   Categórica nominal - Grupo (HV001)
-   Numérica discreta - Número de hogar (HV002)
-   Numérica continua - Mes de la entrevista (HV006)
-   Numérica discreta - Número de miembros del hogar(HV009)
-   Numérica discreta - Número de mujeres (HV010)
-   Numérica discreta - Número de hombres (HV011)
-   Numérica discreta - Número de niños menores de 5 años (HV014)
-   Numérica continua - Resultado de la entrevista del hogar(HV015)
-   Numérica discreta - Número de visitas (HV017)
-   Categórica nominal - Región (HV024)
-   Categórica ordinal - Tipo de lugar de residencia (HV025)
-   Categórica ordinal - Lugar de residencia (HV026)
-   Numérica discreta - Total de adultos medidos (HV041)
-   Categórica ordinal - Selección para hemoglobina (HV042)
-   Numérica continua - Selección para el módulo de estatus de la mujer (HV043)
-   Numérica continua - Selección para el módulo de violencia doméstico (HV044)

#### Códigos para la eliminacion de datos:

###### (1) Nos muestra el resumen del dataframe(DT)

-   "summary(DT)"

###### (2) Cantidad de los datos faltantes

-   "sum(is.na(DT))"

###### (3) Tabla de datos faltantes (NA) y no faltantes

-   "table(is.na(DT))"

###### (4) Cantidad de registros u observaciones completas

-   "sum(complete.cases(DT))"

###### (5) Cantidad de observaciones incompletas

-   "sum(!complete.cases(DT))"

###### (6) Ordenar los datos según su orden

-   order(x, decreasing = FALSE, na.last = TRUE)

##### Por último tenemos que cargar las librerías que utilizaremos para limpiar la base de datos:

```{r}
if(!require(readr)){install.packages('readr')}
library(readr)
if(!require(dplyr)){install.packages('dplyr')}
library(dplyr)
if(!require(stringr)){install.packages('stringr')}
library(stringr)
if(!require(gmodels)){install.packages('gmodels')}
library(gmodels)
if(!require(qcc)){install.packages('qcc')}
library(qcc)
if(!require(vcd)){install.packages('vcd')}
library(vcd)
if(!require(plotly)){install.packages('plotly')}
library(plotly)
```

### Sumemos la cantidad de los datos faltantes

```{r}
sum(is.na(DF)) 
table(is.na(DF))   
```

### Contamos la cantidad de observaciones incompletas

```{r}
sum(!complete.cases(DF))
#El resultado nos indica que todos los casos de la base están incompletos. Esto se debe a que hay tres columnas que no presentan datos (NA) y que alteran los resultados del Data Frame.
```

### Borramos las columnas que no aporten datos (NA)

```{r}
DF %>% select(-44, -43, -36, -34, -32) -> DF
sum(!complete.cases(DF))
```

### Contamos la cantida de registros u observaciones completas

```{r}
sum(complete.cases(DF))
```

### Borramos las columnas y/o variables que no vamos a utilizar en el análisis descriptivo:

```{r}
DF %>% select(-2, -6, -7, -8, -9, -11, -12, -16, -17, -20, -22, -23, -24, -25, -26, -27, -31, -32, -33, -34, -35) -> DF
```

### Cambiamos los nombres de las variables del DF

```{r}
DF %>% rename(Año = ID1, 
              País = HV000, 
              Grupo = HV001, 
              'Numero de hogar' = HV002,
              Mes =  HV006, 
              'Numero de miembros del hogar'= HV009, 
              'Numero de mujeres' = HV010, 
              'Numero de hombres' = HV011, 
              'Niños menores de 5 anos' = HV014, 
              'ResultadoEntrevista' = HV015,  
              'NumeroVisitas' = HV017,
              Región = HV024, 
              'TipoResidencia' = HV025, 
              'LugarResidencia' = HV026, 
              'Total de adultos medidos' = HV041,
              'SelecciónHemoglobina' = HV042,
              'SelecciónEstatusMujer' = HV043,
              'SelecciónMóduloViolenciaDoméstica' = HV044) -> DF
```

### Hacemos uso del código "mutate" para modificar las observaciones según su significado:

```{r}
#País 
DF %>% mutate(País=case_when(País == "PE6" ~ "Perú")) -> DF
```

```{r}
#Mes de la entrevista
DF %>% mutate(Mes=case_when(Mes == 1 ~ "Enero",
                            Mes== 2 ~ "Febrero",
                            Mes== 3 ~ " Marzo",
                            Mes == 4 ~ "Abril", 
                            Mes == 5 ~ "Mayo",
                            Mes == 6 ~ "Junio",
                            Mes == 7 ~ "Julio", 
                            Mes == 8 ~ "Agosto", 
                            Mes == 9 ~ "Septiembre", 
                            Mes == 10 ~ "Octubre", 
                            Mes == 11 ~ "Noviembre", 
                            Mes == 12 ~ "Diciembre")) -> DF
```

```{r}
#Resultado de la entrevista
DF %>% mutate(ResultadoEntrevista=case_when(ResultadoEntrevista == 1 ~ "Completado",
                                            ResultadoEntrevista == 2 ~ "HH presente",
                                            ResultadoEntrevista == 3 ~ "HH ausente",
                                            ResultadoEntrevista == 4 ~ "Pospuesto",
                                            ResultadoEntrevista == 5 ~ "Rechazado",
                                            ResultadoEntrevista == 6 ~ "vivienda vacante",
                                            ResultadoEntrevista == 7 ~ "Vivienda estropeada",
                                            ResultadoEntrevista == 8 ~ "Vivienda no encontrada", 
                                            ResultadoEntrevista == 9 ~ "Otros")) -> DF
```

```{r}
#Región 
DF %>% mutate(Región=case_when(Región == 1 ~ "Amazonas",
                               Región == 2 ~ "Áncash",
                               Región == 3 ~ "Apurímac",
                               Región == 4 ~ "Arequipa",
                               Región == 5 ~ "Ayacucho",
                               Región == 6 ~ "Cajamarca",
                               Región == 7 ~ "Callao",
                               Región == 8 ~ "Cuzco",
                               Región == 9 ~ "Huancavelica",
                               Región == 10 ~ "Huánuco",
                               Región == 11 ~ "Ica",
                               Región == 12 ~ "Junín",
                               Región == 13 ~ "La Libertad",
                               Región == 14 ~ "Lambayeque",
                               Región == 15 ~ "Lima",
                               Región == 16 ~ "Loreto",
                               Región == 17 ~ "Madre de Dios",
                               Región == 18 ~ "Moquegua",
                               Región == 19 ~ "Paso",
                               Región == 20 ~ "Piura",
                               Región == 21 ~ "Puno",
                               Región == 22 ~ "San Martín",
                               Región == 23 ~ "Tacna",
                               Región == 24 ~ "Tubos",
                               Región == 25 ~ "Ucayalí")) -> DF
```

```{r}
#Tipo de residencia
DF %>% mutate(TipoResidencia=case_when(TipoResidencia == 1 ~ "Urbano",
                                       TipoResidencia == 2 ~ "Rural")) -> DF
```

```{r}
#Lugar de residencia
DF %>% mutate(LugarResidencia=case_when(LugarResidencia == 0 ~ "Capital/Ciudad Grande",
                                        LugarResidencia == 1 ~ "Ciudad Pequeña",
                                        LugarResidencia == 2 ~ "Pueblo",
                                        LugarResidencia == 3 ~ "Campo")) -> DF
```

```{r}
DF %>% mutate(SelecciónHemoglobina=case_when(SelecciónHemoglobina == 0 ~ "No seleccionado",
                                             SelecciónHemoglobina == 1 ~ "Seleccionado")) -> DF
```

```{r}
DF %>% mutate(SelecciónEstatusMujer=case_when(SelecciónEstatusMujer == 0 ~ "Hogar no seleccionado",
                                              SelecciónEstatusMujer == 1 ~ "Hogar Seleccionado",
                                              SelecciónEstatusMujer == NA ~ "No aplicar")) -> DF
```

```{r}
DF %>% mutate(SelecciónMóduloViolenciaDoméstica=case_when(SelecciónMóduloViolenciaDoméstica == 0 ~ "Hogar no seleccionado",
                                                          SelecciónMóduloViolenciaDoméstica == 1 ~ "Hogar Seleccionado",
                                                          SelecciónMóduloViolenciaDoméstica == NA ~ "No aplicar")) -> DF
```

```{r}
DF
```

### Veamos ahora el resumen del dataframe(DF)

```{r}
summary(DF)
```

# Análisis Descriptivo:

## A continuación y en una primera instancia, realizaremos un análisis descriptivo para explorar y resumir los datos recolectados. A través de técnicas estadísticas y gráficas, identificamos patrones y tendencias clave.

```{r}
#Delimitamos la función "round" para que todos nuestros descriptores tengan dos decimales.
#Funciones
r <- function(x){
  return(round(x, digits = 2))
}
```

### Estadisticas descriptivas y descriptores numéricos de la poblacion según la región a la que pertenecen

```{r}
df_frecuencias <- as.data.frame(table(DF$Región))   
```

-   Media

```{r}
mean(df_frecuencias$Freq) 
```

-   Mediana

```{r}
median(df_frecuencias$Freq)
```

-   Desviación estándar

```{r}
r(sd(df_frecuencias$Freq))
```

#### Gráfico de barras de la variable Region

```{r}
tabla_frecuencias <- table(DF$Región)
plot_ly(x = names(tabla_frecuencias), y = tabla_frecuencias, type = "bar", color = I("blue"),name = "Número de personas por región") %>%
  add_trace(y = mean(tabla_frecuencias), type = "scatter", mode = "lines", name = "Media de personas que participaron por region", line = list(color = "red", dash = "dash")) %>%
  add_trace(y = median(tabla_frecuencias), type = "scatter", mode = "lines", name = "Mediana de personas que participaron por region", line = list(color = "green", dash = "dash")) %>%
  layout(title = "Diagrama de barras de la variable Region", xaxis = list(title = "Regiones"), yaxis = list(title = "n.º de personas"))
```

-   Al observar que la diferencia entre la media y mediana no es muy grande, se podría pensar que la distribución de las frecuencias por región no está fuertemente sesgada, y que se usó una cantidad similar de personas por región; esto lo comprobamos al ver que la mayoría de regiones se encuentra cerca a estos valores. Sin embargo, Lima y Callao tienen valores muy lejanos en comparación con el resto de las regiones,sus valores son notablemente más altos y más bajos, respectivamente. Pero la presencia de valores extremos puede deberse a la densidad de población; es decir que se realizaron más y menos encuestas en estas regiones buscando tener una población representativa.

#### Diagrama de pareto de la variable Region

```{r}
tabla_frecuencias <- table(DF$Región)
tabla_ordenada <- sort(tabla_frecuencias, decreasing = TRUE)
pareto.chart(tabla_ordenada)
```

-   Se utilizó una gráfica de Pareto para examinar la distribución de las regiones según el número de personas encuestadas.La línea que representa el porcentaje acumulado de personas encuestadas muestra un valor inicial elevado en Lima. Esto se debe a que Lima es la región con la mayor cantidad de personas encuestadas. A medida que avanzamos hacia las demás regiones, la cantidad de personas encuestadas disminuye gradualmente, lo que resulta en una curva ascendente en la línea; pues va disminuyendo su pendiente. En la parte final de la gráfica, donde se encuentra Callao, la línea se vuelve más plana. Esto indica que Callao es significativamente la región con menos encuestados en comparación con las demás.

### Grupo al que pertenece cada observación del Data Frame

```{r}
hist(DF$Grupo,
     col= 'green',
     breaks =500,
     main = "Gráfica Grupo",
     xlab = "Número de grupo ",
     ylab = "Frecuencia")
```

# Análisis Probabilístico:

## Probabilidad empírica

### Variable Edad

La variable edad en este contexto tiene que ver con la edad de los niños en el resultado de la entrevista.

Ahora definiremos a los eventos atómicos como los posibles numeros de niños menores de 5 años en un hora.

Sabemos que este número varía entre 0 y 6.

**Eventos**

$$
Sea\ conjunto\ de\ eventos \ atomicos= S\\
S = \{\{0\}, \{1\},\{2\},\{3\},\{4\},\{5\} ,\{6\}\}
$$

Ahora, calcularemos las probabilidades empíricas de estos eventos atómicos en R:

```{r echo=FALSE}
options(scipen = 99)

# Probabilidades empíricas para 'Niños menores de 5 años'
prob_niños_menor_5 <- table(DF$`Niños menores de 5 anos`) / nrow(DF)
print(prob_niños_menor_5)
```

+-----------------------------+---------------+
| Cantidad de ñinos por hogar | Probabilidad  |
+=============================+===============+
| 0                           | ```           |
|                             | 0.67          |
|                             | ```           |
+-----------------------------+---------------+
| 1                           | ```           |
|                             | 0.24          |
|                             | ```           |
+-----------------------------+---------------+
| 2                           | ```           |
|                             | 0.07          |
|                             | ```           |
+-----------------------------+---------------+
| 3                           | ```           |
|                             | 0.01          |
|                             | ```           |
+-----------------------------+---------------+
| 4                           | ```           |
|                             | 0.0007        |
|                             | ```           |
+-----------------------------+---------------+
| 5                           | ```           |
|                             | 0.0001        |
|                             | ```           |
+-----------------------------+---------------+
| 6                           | ```           |
|                             | 0.00003       |
|                             | ```           |
+-----------------------------+---------------+

Los resultados obtenidos son las probabilidades empíricas de tener un cierto número de niños menores de 5 años en un hogar. Estos resultados nos permiten entender la distribución de niños menores de 5 años en los hogares particiantes de la entrevista

-   Un 67% de los hogares no tienen niños menores de 5 años.

-   Un 24% de los hogares tienen un niño menor de 5 años.

-   Un 7% de los hogares tienen dos niños menores de 5 años.

-   Un 1% de los hogares tienen tres niños menores de 5 años.

-   Un 0.07% (o 7 hogares por cada 10,000) tienen cuatro niños menores de 5 años.

-   Un 0.01% (o 1 hogar por cada 10,000) tiene cinco niños menores de 5 años.

-   Un 0.003% (o 3 hogares por cada 100,000) tienen seis niños menores de 5 años.

Estas probabilidades proporcionan una idea clara de la composición de los hogares en términos del número de niños menores de 5 años.

### Variable Región

Para la variable región podemos definir los eventos atomicos como las distintas regiónes geográficas en el conjunto de datos.

Podemos definir un evento como:

$$
\text{Evento A = La persona encuestada sea de Lima}
$$

y encontrar su probabilidad empírica como

```{r echo=FALSE}
# Probabilidad empírica de que una persona encuestada sea de Lima
num_personas_lima <- sum(DF$Región == 'Lima')
num_total_personas <- nrow(DF)

probabilidad_empirica_lima <- num_personas_lima / num_total_personas
print(probabilidad_empirica_lima)

```

$$
P(A) = 0.094
$$

Además podemos encontrar la probabilidad de todos los eventos atómicos:

**Probabilidad de los eventos atómicos.**

```{r echo=FALSE}
prob_región <- table(DF$Región) / nrow(DF)
print(prob_región)
```

```{r echo=FALSE}
unique(DF$Región)
```

| Región        | Probabilidad |
|---------------|--------------|
| Amazonas      | 0.037        |
| Ancash        | 0.046        |
| Apurímac      | 0.039        |
| Arequipa      | 0.041        |
| Ayacucho      | 0.044        |
| Cajamarca     | 0.038        |
| Callao        | 0.009        |
| Cuzco         | 0.039        |
| Huancavelica  | 0.035        |
| Huánuco       | 0.036        |
| Ica           | 0.040        |
| Junín         | 0.038        |
| La Libertad   | 0.040        |
| Lambayeque    | 0.034        |
| Lima          | 0.094        |
| Loreto        | 0.032        |
| Madre de Dios | 0.038        |
| Moquegua      | 0.040        |
| Pasco         | 0.041        |
| Piura         | 0.040        |
| Puno          | 0.052        |
| San Martín    | 0.036        |
| Tacna         | 0.033        |
| Tumbes        | 0.034        |
| Ucayalí       | 0.036        |

Según estos datos, la probabilidad empírica de que una persona encuestada sea de Lima es aproximadamente 0.0944, o 9.44%.

Esto significa que, alrededor del 9.44% de las personas encuestadas son de Lima. Por lo tanto, si seleccionamos al azar a una persona de tu conjunto de datos, habría una probabilidad del 9.44% de que esa persona sea de Lima.

Es importante tener en cuenta que esta es una probabilidad empírica, lo que significa que está basada en la frecuencia de observación en las entrevistas específicamente. Podría no representar exactamente la proporción real de personas de Lima en la población total.

### Probabilidad condicional

La probabilidad condicional es la probabilidad de que ocurra un evento A, dado que otro evento B ya ha ocurrido. Si los eventos A y B son independientes, entonces la probabilidad de que ocurran A y B es el producto de sus probabilidades individuales, P(A) \* P(B). Si no son independientes, entonces la probabilidad condicional de A dado B se calcula como P(A ∩ B) / P(B).

Definiremos nuestros eventos y probabilidades como:

$$
P(A) = \text{Probabilidad de que un hogar esté en Lima}\\
P(B) = \text{Probabilidad de que un hogar tenga un niño menor de 5 años.}\\
P(A \cap B) = \text{Probabilidad de que un hogar en Lima tenga al menos un niño menor de 5 años}
$$

Podemos verificar si los eventos no son independientes verificando que la multiplicación es mayor a 0:

```{r}
# Cálculo de las probabilidades marginales
p_A <- sum(DF$Región == 'Lima') / nrow(DF)
p_B <- sum(DF$'Niños menores de 5 anos' >= 1) / nrow(DF)

# Cálculo de la probabilidad conjunta
p_conjunta <- sum(DF$Región == 'Lima' & DF$'Niños menores de 5 anos' >= 1) / nrow(DF)

# Comparación
if (abs(p_conjunta - p_A * p_B) < 0.001) {
  print("Los eventos son independientes.")
} else {
  print("Los eventos no son independientes.")
}

```

Como los eventos son dependientes podemos encontrar la probabilidad condicional

Procedemos a encontrar la probabilidad condicional:

```{r echo=FALSE}
# Cantidad de hogares en Lima con al menos un niño menor de 5 años
num_hogares_lima_con_niños <- sum(DF$Región == 'Lima' & DF$'Niños menores de 5 anos' >= 1)

# Cantidad total de hogares en Lima
num_hogares_lima <- sum(DF$Región == 'Lima')

# Probabilidad condicional
prob_condicional <- num_hogares_lima_con_niños / num_hogares_lima
print(prob_condicional)

```

$$
P(\text{"Hogar tiene al menos un niño menor a 5 años"}| \text{"Hogar está en Lima"}) = \text{0.2692}
$$

### Variables discreta (Binomial Negativa)

#### Introducción

En este análisis, estamos interesados en modelar el número de hogares que debemos encuestar antes de encontrar tres hogares con al menos un niño menor de 5 años. Este escenario es un caso clásico de la distribución binomial negativa, que se utiliza para modelar el número de pruebas necesarias para alcanzar un número específico de éxitos.

#### Análisis

Para realizar este análisis, **necesitamos asumir** que la ***probabilidad*** de encontrar un hogar con al menos un niño menor de 5 años ***es la misma para cada hogar*** y que los resultados de las diferentes ***pruebas son independientes***. En nuestro caso, hemos estimado esta probabilidad usando la proporción de hogares con al menos un niño menor de 5 años en nuestros datos.

#### Definición

Dados los supuestos descritos anteriormente podemos establecer la variable aleatoria:

$$
X \sim \text{El numero de hogares que debemos encuestar antes de encontrar 3 hogares con al menos un niño menor de 5 años}
$$

Y como se distribuye.

$$
X\sim \text{BN(p,k)}
$$

Luego realizamos una simulación de 1000 pruebas, donde cada prueba representa el número de hogares que necesitamos encuestar para encontrar tres hogares con al menos un niño menor de 5 años. Los resultados de esta simulación se muestran en el siguiente gráfico.

```{r}
# Asumamos que la probabilidad de encontrar un hogar con al menos un niño menor de 5 años
# es igual a la proporción de tales hogares en tus datos

p <- sum(DF$'Niños menores de 5 anos' >= 1) / nrow(DF)

# Ahora, vamos a simular el número de hogares que necesitas encuestar para encontrar tres
# con al menos un niño menor de 5 años. Haremos esto 1000 veces para obtener una distribución

set.seed(123)  # fijamos la semilla para reproducibilidad
simulaciones <- rnbinom(1000, size = 3, prob = p)

# Ahora podemos hacer un diagrama de bastones de las probabilidades estimadas
tab_simulaciones <- table(simulaciones)
prob_simulaciones <- tab_simulaciones / sum(tab_simulaciones)
plot(prob_simulaciones, type = "h", lwd = 2, 
     xlab = "Número de hogares encuestados", 
     ylab = "Probabilidad",
     main = "Simulación de Binomial Negativa")

```

#### Interpretación

El gráfico muestra las probabilidades estimadas para cada número posible de hogares encuestados antes de encontrar tres hogares con al menos un niño menor de 5 años.

Por ejemplo, la probabilidad estimada de que se necesite encuestar a 0 hogares antes de encontrar tres hogares con al menos un niño menor de 5 años es 0.035, mientras que la probabilidad estimada de que necesites encuestar a 1 hogar es 0.074, y así sucesivamente. La probabilidad disminuye a medida que el número de hogares necesarios para encuestar aumenta, lo cual tiene sentido ya que es más probable que encuentres hogares con niños menores de 5 años en tus primeras encuestas que después de muchas encuestas.

#### Preguntas Relevantes

Cuando modelamos algo con una distribución binomial negativa, estamos interesados en el número de ensayos (en este caso, encuestas a hogares) que necesitamos realizar antes de alcanzar un cierto número de "éxitos" (en este caso, encontrar hogares con al menos un niño menor de 5 años).

En el caso de la simulación que realizamos, definimos un "éxito" como encontrar un hogar con al menos un niño menor de 5 años. Decidimos que queríamos encontrar tres de estos hogares, por lo que simulamos cuántas encuestas necesitaríamos realizar hasta que encontráramos tres hogares que cumplieran con este criterio.

***¿Cuál es la probabilidad de que tengamos que encuestar 3 hogares para encontrar 3 hogares con al menos un niño menor de 5 años?***

```{r}
cat("La probabilidad es:",dnbinom(0,3,p))
```

### Variable Discreta (Bernulli)

El estudio abarcó familias que viven tanto como en la ciudad como en el campo. Como sabemos en el Perú existe una gran brecha en la atención de la salud entre estos dos tipos de localidades. Los centro rurales cuentan con muchas deficiencias que pueden poner en riesgo la salud de los recién nacidos.

Por eso buscaremos analízar la variable TipoResidencia. Esta variable tiene dos factores "Urbano" y "Rural". Para este estudio vamos a buscar la probabildad de que un encuestado tenga un tipo de residencia Rural.

```{r}

prob_rural <- sum(DF$TipoResidencia == "Rural") / nrow(DF)

# Imprimir el resultado
print(prob_rural)

```

Ahora que sabemos la probabilidad asociada a que una persona responda en la encuesta a tipo de vivienda Rural podemos definirla de la siguiente manera:

$$
Definimos \; A : \text{Persona responda en la encuesta "Rural"}\\
p = P(A) = 0.3966
$$

Y ahora que tenemos el parametro p podemos definir la variable aleatoria

$$
Y \sim \text{ Variable aleatoria que representa si una persona respondio "Rural" }\\Y = \begin{cases} 1 & \text{si el encuestado responde "Rural"} \\0 & \text{si el encuestado no responde "Rural"}\end{cases}\\Y \sim Bernulli(p=0.3967)
$$

Esto quiere decir que si le preguntamos a un encuestado al azar, asumiendo que la probabilidad de que una persona viva en el campo igual para todos y que la respuesta de una persona no influye en la respuesta de los demás, nos dirá que sí el 39% de las veces.

### Variable Continua (Peso)

Ahora haremos el analisis de la variable Peso de las personas encuestadas. Esta variable es importante por que estamos viendo factores que puedan afectar la maternidad. El peso es un factor que según la OMS puede afectar el desarrollo de los fetos e influye en el desarrollo sano de los bebes durante el embarazo.

```{r echo=FALSE}
Peso = DF2$HA2/10

```

Primero haremos una inspección visual de la variable usando un boxplot. Este boxplot nos ayudará a ver si existen datos atípicos en nuestra encuesta.

```{r echo=FALSE}
boxplot(Peso, main ="Boxplot Peso de las Mujeres encuestadas")

```

Como podemos observar, hay valores que pueden parecer subreales. 1000 kilos no es un numero posible en la variable Peso. Por lo tanto removeremos ese valor así como también los valores atípicos para tratar de analizar a la muestra de manera mas representativa.

```{r echo=FALSE}
PesoLimpio =Peso[!Peso %in% boxplot.stats(Peso)$out]
hist(PesoLimpio)
```

Luego de hacer la limpieza procederemos a inspeccionar la data limpia y como podemos ver la muestra se asemeja a una distribución normal.

Ahora haremos un grafíco de densidad simulado y lo compararemos con el real para ver esta similitud de manera más clara.

```{r echo=FALSE}
# Extraer los datos de peso limpio y eliminar NA
peso_limpio <- na.omit(PesoLimpio)

# Calcular la media y desviación estándar
media <- mean(peso_limpio)
sd <- sd(peso_limpio)

# Generar los datos simulados
simulado <- rnorm(length(peso_limpio), mean=media, sd=sd)

# Crear gráficos de densidad
densidad_peso_limpio <- density(peso_limpio)
densidad_simulado <- density(simulado)

# Gráfico
plot(densidad_peso_limpio, main="Comparación de densidades: Datos reales vs Simulados", xlab="Peso Limpio", ylab="Densidad")
lines(densidad_simulado, lty=2, col="red")

# Añadir líneas verticales para la media real y teórica
abline(v = mean(peso_limpio), lty=2, col="blue")  # Media real
abline(v = mean(simulado), lty=2, col="green")  # Media teórica

# Añadir leyenda
legend("topright", legend=c("Datos reales", "Datos simulados", "Media real", "Media teórica"), 
       lty=c(1, 2, 2, 2), col=c("black", "red", "blue", "green"))


```

Como podemos ver, la similitud es alta. Pero usaremos la libreria fitdist para comparar la curtosis y alargamiento de las distribuciones y poder compararla con otras distribuciones. La función nos ayudará a darnos mas pistas acerca del comportamiento de esta variable.

```{r echo=FALSE}
library(fitdistrplus)
descdist(PesoLimpio)
```

El eje horizontal del gráfico representa la asimetría (skewness) y el eje vertical representa la curtosis (kurtosis) de una distribución. Cada distribución teórica tiene una ubicación específica en este espacio. Por ejemplo, la distribución normal tiene asimetría y curtosis igual a cero y está ubicada en el origen.

Cuando se traza una muestra de datos en este gráfico, su ubicación en relación con las distribuciones teóricas puede dar una indicación de qué modelo de distribución puede ser apropiado para esos datos. Por ejemplo, si una muestra de datos está más cerca de la ubicación de la distribución normal, entonces puede ser razonable asumir que esos datos siguen una distribución normal.

En nuestro caso nuestra observación (Punto Azul) esta cerca a la variable normal (Asterisco) entonces podemos decir que, según el grafíco, nuestra variable si sigue una distribución normal.

Como ultima prueba usaremos el grafico QQplot que nos permite evaluar si los datos siguen una distribución normal.

```{r}
# Extraer los datos de peso limpio y eliminar NA
peso_limpio <- na.omit(PesoLimpio)

# Crear un gráfico QQ
qqnorm(peso_limpio, main = "Gráfico QQ de Peso Limpio")
qqline(peso_limpio, col = "red")

```

Si bien es cierto que nuestros datos (Puntos Negros) no caen directamente en la linea roja todos los otros indicios nos hacen pensar que la variable se distribuye normalmente.

Ahora caracterizaremos nuestra variable aleatoria usando la distribución normal.

```{r}
mean(PesoLimpio)
sd(PesoLimpio)
```

Para caracterizar nuestra variable aleatoria tenemos que definir la variable y sus parametros.

Como nuestro interes es buscar la probabilidad de que una persona tenga sobrepeso primero vamos a definir sobrepeso como una persona que pese mas de 70Kg. Es verdad que el sobrepeso se tiene diferentes factores como la talla y la edad. Sin embargo, para fines practicos y por la falta de esta información de las encuestadas usaremos un peso de 70Kg considerando que según el MINSA el promedio de mujeres en el Perú pesa 57Kg.

$$
X \sim \text{Peso de las mujeres}\\
X \sim \text{Norm(59.69,10.39)}
$$

A partir de esta definicion podemos hacernos la pregunta

**¿Cuál es la probabilidad de que una mujer encuestada pese más de 70Kg?**

```{r}
pnorm(70,59.69,10.39,lower.tail = FALSE)
```

$$
p = P[X >= 70] = pnorm(70,59.69,10.39,lower.tail=FALSE)\\
p = 0.16
$$

Entonces podemos decir que la probabilidad de que una encuestada pese mas de 70 kilos es de 16%

### Variable Continua (Hemoglobina)

La hemoglobina es una proteína en los glóbulos rojos que transporta oxígeno por todo el cuerpo. Los niveles bajos de hemoglobina, una condición conocida como anemia, pueden tener varios efectos en la salud reproductiva de las mujeres, la fecundidad y la maternidad.

1.  **Salud de la madre:** Las mujeres con anemia pueden experimentar fatiga y debilidad, y tienen un mayor riesgo de complicaciones durante el embarazo y el parto, incluyendo un mayor riesgo de mortalidad materna.

2.  **Fecundidad:** Algunos estudios han encontrado que la anemia puede afectar la fecundidad, es decir, la capacidad de una mujer para concebir. Los niveles bajos de hemoglobina pueden influir en la función del ovario y la calidad de los óvulos, potencialmente afectando la capacidad de una mujer para quedar embarazada.

3.  **Salud del recién nacido:** Los bebés de madres anémicas tienen un mayor riesgo de nacer con bajo peso, de nacer prematuramente, y de tener retrasos en el crecimiento y desarrollo.

```{r include=FALSE}
hemoglobina <- DF2$HA53/10
```

Verificaremos si existen valores atípicos en la variable hemoglobina.

```{r echo=FALSE}
boxplot(hemoglobina)
```

En el caso de hemoglobina vemos que existe un valor de 100. Como sabemos esto no es posible entonces procedemos a elminar solo ese valor. En este caso no eliminaremos los datos atípicos debido a que estos estan dentro del rango posible teoricamente y pueden ser mediciones reales.

```{r echo=FALSE}
hemoglobina <- hemoglobina[hemoglobina != max(hemoglobina, na.rm = TRUE)]

hist(hemoglobina, main = "Hemoglobina en las mujeres encuestadas")
```

En nuestro caso la hemoglobina esta en **g/dl.** Según la OMS, el rango ideal para mujeres debe ser de 12.1 a15.1 g/dl. Los valores menores a 12 se consideran casos de anemia. Los valores mayores a 15 pueden ser problemas hormonales en el caso de mujeres embarazadas. Es importante indicar que la hemoglobina alta tambien puede ser influenciada por factores como la altura y el consumo de carnes.

```{r echo=FALSE}
# Crear el gráfico Q-Q para la variable 'hemoglobina'
qqnorm(hemoglobina, main = "Q-Q plot para Hemoglobina")
qqline(hemoglobina, col = "red", lwd = 2)

```

En el contexto de hemoglobina, esto podría significar que la mayoría de mujeres encuestadas tienen niveles de hemoglobina cerca de la media, con menos personas teniendo niveles de hemoglobina extremadamente altos o bajos. Este es un patrón común en muchas mediciones de salud y biológicas.

Para hacer otra prueba de normalidad diferente a la variable peso vamos a hacer una prueba de hipótesis.

Para hacer la prueba de hipótesis necesitamos establecer la hipótesis nula y la alternativa

$$
h_o =\text{La variable hemoglobina sigue una distribución normal}\\
h_a =\text{Hemoglobina no sigue una distribución normal}
$$

```{r}
# Obtener los parámetros de una distribución normal ajustada a los datos
params <- fitdistr( hemoglobina, "normal")$estimate

# Realizar la prueba de Kolmogorov-Smirnov
ks.test( hemoglobina, "pnorm", mean = params[1], sd = params[2])

```

Para ver el resultado de la prueba evaluaremos el p-value para ver si se logra rechazar la hipotesis nula. En este caso el p valor es 0.00000002.

#### Resultado

Como el p valor es muy pequeño entonces, según la prueba KS, se rechaza la hipotesis nula ynuestros datos no siguen una distribución normal.

Sin embargo, es importante recordad que ninguna prueba puede demostrar que los datos son normales; solo demuestran evidencias contra la normalidad. Un factor importante a considerar es el tamaño de la muestra. En nuestro caso la muestra es de 24415 entonces cualquier desviación se amplificará e influiran en las pruebas estadísticas.

#### Caracterización de la variable aleatoria.

Ahora que asumimos que nuestros datos se puede modelar usando una distribución normal vamos a caracterizar la variable aleatoria teniendo en cuenta los niveles de anemia Hemoglobina =\< 12.1

```{r}
pnorm(12.1, mean(hemoglobina),sd(hemoglobina))
(mean(hemoglobina))
(sd(hemoglobina))
```

$$
H \sim \text{ Nivel de hemoglobina de una mujer que respondió la encuesta}\\
P[H <= 12.1] = Norm(13.79,1.818) = 0.17
$$

En nuestra investigación sobre los niveles de hemoglobina, hemos realizado un análisis probabilístico detallado. Entre los hallazgos, descubrimos que la probabilidad de que una persona tenga un nivel de hemoglobina inferior a 12.1 g/dL es de 0.17 o 17%. Este dato es importante porque los niveles de hemoglobina por debajo de 12.0 g/dL en mujeres y 13.5 g/dL en hombres se consideran generalmente como un indicador de anemia, una condición que puede afectar negativamente la salud general y el bienestar.

Este hallazgo tiene varias implicaciones. En primer lugar, indica que aproximadamente 1 de cada 6 individuos en nuestra muestra podría estar en riesgo de anemia. Sin embargo, esta es una estimación basada en un límite de 12.1 g/dL y deberíamos considerar que los niveles normales pueden variar ligeramente.

Además, este resultado resalta la importancia de las intervenciones de salud dirigidas a aumentar los niveles de hemoglobina en la población, especialmente si futuras investigaciones confirman una prevalencia alta de niveles bajos de hemoglobina. Estas intervenciones podrían incluir la mejora de la nutrición, el acceso a suplementos de hierro, y la educación sobre los riesgos asociados con los bajos niveles de hemoglobina.

Por último, es importante recordar que esta es una probabilidad empírica basada en nuestra muestra y puede no representar exactamente la prevalencia en la población general. Para obtener una visión más completa, este hallazgo debe ser complementado con estudios adicionales y un análisis más profundo de la distribución de los niveles de hemoglobina en diferentes subgrupos de la población.
