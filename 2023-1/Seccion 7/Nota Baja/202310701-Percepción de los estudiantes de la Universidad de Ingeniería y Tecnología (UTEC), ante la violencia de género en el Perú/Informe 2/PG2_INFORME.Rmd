---
title: "INFORME"
date: "2023-06-28"
output:       
  html_document:
    toc: true
    toc_depth: 5
    toc_float:
      collapsed: false
      smooth_scroll: true
  html_notebook:
    toc: true
    toc_depth: 5
    toc_float:
      collapsed: false
      smooth_scroll: true
---

# **Tema**

**Percepción de los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC), que cursan el  ciclo 2023-1, ante la violencia de género en el Perú**

# **Introducción**

## **Relevancia**

El tema del informe ayuda a comprender la magnitud del problema: Conocer la percepción de los estudiantes sobre la violencia de género puede ayudar a comprender la magnitud del problema en el país y en las universidades en particular. La percepción de los estudiantes sobre la violencia de género puede ayudar a identificar áreas de mejora en la prevención y respuesta a la violencia de género en las universidades.

## **Objetivos**

-   Identificar el grado de conciencia de los estudiantes de UTEC sobre la prevalencia y los efectos de la violencia de género en el Perú
-   Identificar los factores subyacentes que contribuyen a la perpetuación de la violencia de género en la sociedad peruana según la percepción de los estudiantes de la UTEC.
-   Evaluar la percepción de los estudiantes de la UTEC sobre las medidas y políticas actuales para prevenir y abordar la violencia de género en la UTEC y en el Perú

## **Contexto**

El término “violencia de género” hace referencia a cualquier acto con el que se busque dañar a una persona por su género. La violencia de género nace de normas perjudiciales, abuso de poder y desigualdades de género.



```{r}
tablita <-'respuestasFinal.csv'
Data <- read.csv(tablita)
```
 
Mediante el comando **summary**, podemos ver que las variables fueron leidas correctamente.
```{r}
Data <- Data[, -43]
Data <- Data[, -42]
Data <- Data[, -41]
Data <- Data[, -1]
```

Hacemos uso del comando **colnames** para poder reemplazar el nombre de las variables.
```{r}
nombr.columnas <-c("Género","Edad","Carrera","EscalaPension","HorasEstudio","ViolenciaGenero","ExisteViolenciaG","CharlaInformativa","VictimaViolenciaG","HogarViolencia","CercanosViolenciaG","ProblemaEnPeru","ParticipaCampaña","EducacionPreviene","CasosViolencia","CasosProcesados","ConoceViolenciaG","MedidasPrevencion","EstadoEfectivo","LugarMasFrecuente","InstruidoViolenciaG","OrigenViolenciaG","AcudirPorAyuda","InfluenciaDeMedios","ProblemaSoloMujeres","DenunciasDeVictimas","DenunciasViolenciaMujer","ViolenciaAMujeres","RazonAgresionMujeres","CampañaNiUnaMenos","ViolenciaAHombes","TipoViolenciaHombre","RazonViolenciaHombre","LibertadMujer","HombreMayorAccesoEducacion","DiferenciaSalarial","HombreMayorAscensoLaboral","AccesoCargoPolitico","ActosSexistasEnUniversidad")
colnames(Data)<-nombr.columnas
head(Data)
```
# **ANALISIS PROBABILISTICO**

## PROBABILIDAD EMPIRICA

### VARIABLE 1: 

  Considera que la violencia de género es un problema grave en el Perú.

**PASO 1:**

  Experimento: Seleccionar un alumno del presente estudio de violencia de género y observar si considera la violencia de genero un problema grave en el Perú

**Paso 2:**

  Espacio de resultados
  Ωexp: {Si, No}

**Paso 3:**

  A1 : Seleccionar una persona que si considera la violencia de genero un problema grave en el Perú.

  A2: Seleccionar una persona que no considera la violencia de género un problema grave en el Perú.

**Paso 4:**

  Se esta describiendo a las probabilidades asociadas a los eventos A1 y A2

  P(A1) = frecuencia(A1)/ n
  P(A2) = frecuencia(A2)/ n

```{r}

frecuencia <- table(Data$ProblemaEnPeru)
print(frecuencia)
n <- nrow(Data)
PA1 <- 143/n
PA2 <- 8/n

frecuencia_probabiliad <- frecuencia/n
frecuencia_probabiliad <- round(frecuencia_probabiliad, digits = 2)
frecuencia_probabiliad

```
La probabilidad de seleccionar a un alumno de la Universidad de Ingeniería Y Tecnología que considere la violencia de genero un problema grave en el Perú es de 0.95

### VARIABLE 2:

  **Experimento 2:** Seleccionar un alumno del presente estudio y observar si considera que la violencia de género es más frecuente en los hogares

**Paso 2:**
  Espacio de resultados

  Ωexp: {Calles, Hogares, Trabajos, Instituciones educativas}

**Paso 3:**

  A1: Seleccionar una persona que cree que es más frecuente en las calles

  A2: Seleccionar una persona que cree que es más frecuente en los hogares

  A3: Seleccionar una persona que cree que es más frecuente en los trabajos

  A4: Seleccionar una persona que cree que es más frecuente en las Instituciones educativas

**Paso 4:**
  
  Se esta describiendo a las probabilidades asociadas a los eventos A1, A2, A3 y A4

  P(A1) = frecuencia(A1)/ n
  P(A2) = frecuencia(A2)/ n
  P(A3) = frecuencia(A3)/ n
  P(A4) = frecuencia(A4)/ n

```{r}
frecuencia <- table(Data$LugarMasFrecuente)
print(frecuencia)
n <- nrow(Data)

frecuencia_probabiliad <- frecuencia/n
frecuencia_probabiliad <- round(frecuencia_probabiliad, digits = 2)
frecuencia_probabiliad

```
La probabilidad de seleccionar un alumno de la Universidad de Ingeniería y Tecnología que considera la violencia de genero es más frecuente en los hogares es de 0.51 



## **PROBABILIDAD CONDICIONAL**

  **Experimento 1 (Asociado al evento A):** Seleccionar un estudiante y observar si cree que la violencia de genero es un problema grave en el Perú
  
  **Experimento 2 (Asociado al evento B):** Seleccionar un estudiante y observar si conoce a alguien que haya sido victima de violencia de género

**Evento A:** Selecciona un estudiante que cree que la violencia de género es un problema grave en el Perú.
  
**Evento B:** Seleccionar un estudiante que conoce a alguien cercano que haya sido víctima de violencia de género."

**Validar la independencia:**

**P(A∩B) = P(A).P(B)**

```{r}
frecuencia1 <- table(Data$ProblemaEnPeru)
frecuencia2 <- table(Data$CercanosViolenciaG)

# Probabilidades empíricas de cada evento

cat("\nProblema grave en el Perú\n")
frecuencia_probabiliad_1 <- frecuencia1 / n
frecuencia_probabiliad_1 <- round(frecuencia_probabiliad_1, digits = 2)
frecuencia_probabiliad_1

cat("\nConoce a alguien cercano\n")
frecuencia_probabiliad_2 <- frecuencia2 / n
frecuencia_probabiliad_2 <- round(frecuencia_probabiliad_2, digits = 2)
frecuencia_probabiliad_2


df_frecuencia_probabiliad_1 <- as.data.frame(frecuencia_probabiliad_1)
df_frecuencia_probabiliad_2 <- as.data.frame(frecuencia_probabiliad_2)

P_A <- df_frecuencia_probabiliad_1[2, 2]

P_B <- df_frecuencia_probabiliad_2[2, 2]

#Validar independencia 
P_A_int_B <- P_A * P_B
P_A_int_B <- round(P_A_int_B,2)
P_A_int_B

AB <- subset(Data, Data$ProblemaEnPeru == "Si" & Data$CercanosViolenciaG == "Si")
AB <- nrow(AB)

CAB <- subset(Data, Data$ProblemaEnPeru == "No" & Data$CercanosViolenciaG == "Si")
CAB <- nrow(CAB)

ACB <- subset(Data, Data$ProblemaEnPeru == "Si" & Data$CercanosViolenciaG == "No")
ACB <- nrow(ACB)

CACB <- subset(Data, Data$ProblemaEnPeru == "No" & Data$CercanosViolenciaG == "No")
CACB <- nrow(CACB )

datos <- matrix(c(AB, ACB ,CAB, CACB), nrow = 2, ncol = 2)
df <- data.frame(datos)
nombr.columnas <-c("A", "¬A")
colnames(df)<-nombr.columnas
nombr.filas <-c("B", "¬B")
rownames(df)<-nombr.filas
df

df_p <- df/n
df_p <- round(df_p, digits = 2)
df_p

datos <- matrix(c(AB, ACB, (AB+ACB) ,CAB, CACB, (CAB + CACB), (AB+CAB), (ACB+CACB), (AB+CAB+ACB+CACB)), nrow = 3, ncol = 3)
df_t <- data.frame(datos)
nombr.columnas <-c("A", "¬A", "Total")
colnames(df_t)<-nombr.columnas
nombr.filas <-c("B", "¬B", "Total")
rownames(df_t)<-nombr.filas
df_t <- as.data.frame(df_t)
df_t


```

P(A ∩ B) = P(A) * P(B)
0.65 = 0.65 son independientes

```{r}
# Hallar la probabilidad condicional
# P(A|B) = P(A ∩ B) / P(B)

P_AdadoB <- (P_A * P_B)/P_B
P_AdadoB <- round(P_AdadoB,2)
P_AdadoB

#BAYES
# P(B|A) = P(A|B) . P(B) / P(TA)
# P(TA) = P(A|B). P(B) + P(A|¬B) .P(¬B) 
# P(A|¬B) = A¬B/T¬B
# P(¬B) = T¬B/Total

Total <- df_t[3, 3]
TCB <- df_t[2, 3]

P_TotalA <- (P_AdadoB*P_B) + ((ACB/TCB)*(TCB/Total))
P_TotalA <- round(P_TotalA,2)
P_BdadoA <- (P_AdadoB * P_B)/ P_TotalA
round(P_BdadoA,2)



```
**Análisis:** 

En resumen, en este experimento se observa que la percepción de la gravedad de la violencia de género en el Perú por parte de los estudiantes no está influenciada por su conocimiento de casos cercanos. Además, la probabilidad de que un estudiante crea que la violencia de género es un problema grave en el Perú se mantiene constante independientemente de si conocen o no a alguien cercano que haya sido víctima de violencia de género.

La probabilidad del evento A dado el evento B es de 0.95 y la probabilidad de B dado el evento A es de 0.69

**Experimento 3 (Asociado al evento A) :** Seleccionar un estudiante y observar si recibió una charla Informativa en la Universidad

**Experimento 3 (Asociado al evento B) :** Seleccionar un estudiante y observar si considera que la educación previene la violencia de género

**Evento A:** Seleccionar un estudiante que ha recibido una charla informativa en la universidad sobre violencia de género.

**Evento B:** Seleccionar un estudiante que considera que la educación es un factor clave para prevenir la violencia de género.

```{r}
frecuencia1 <- table(Data$CharlaInformativa)
frecuencia2 <- table(Data$EducacionPreviene)

#PROBABILIDADES EMPIRICAS DE CADA EVENTO
cat("\nRecibio Charla Informativa\n")
frecuencia_probabiliad_1 <- frecuencia1 / n
frecuencia_probabiliad_1 <- round(frecuencia_probabiliad_1, digits = 2)
frecuencia_probabiliad_1

cat("\nEducacion Previene la violencia de genero\n")
frecuencia_probabiliad_2 <- frecuencia2 / n
frecuencia_probabiliad_2 <- round(frecuencia_probabiliad_2, digits = 2)
frecuencia_probabiliad_2


df_frecuencia_probabiliad_1 <- as.data.frame(frecuencia_probabiliad_1)
df_frecuencia_probabiliad_2 <- as.data.frame(frecuencia_probabiliad_2)

P_A <- df_frecuencia_probabiliad_1[2, 2]

P_B <- df_frecuencia_probabiliad_2[2, 2]

#Validar independencia 
P_A_int_B <- P_A * P_B
P_A_int_B <- round(P_A_int_B,2)
P_A_int_B

AB <- subset(Data, Data$CharlaInformativa == "Si" & Data$EducacionPreviene == "Si")
AB <- nrow(AB)

CAB <- subset(Data, Data$CharlaInformativa == "No" & Data$EducacionPreviene == "Si")
CAB <- nrow(CAB)

ACB <- subset(Data, Data$CharlaInformativa == "Si" & Data$EducacionPreviene == "No")
ACB <- nrow(ACB)

CACB <- subset(Data, Data$CharlaInformativa == "No" & Data$EducacionPreviene == "No")
CACB <- nrow(CACB )

datos <- matrix(c(AB, ACB ,CAB, CACB), nrow = 2, ncol = 2)
df <- data.frame(datos)
nombr.columnas <-c("A", "¬A")
colnames(df)<-nombr.columnas
nombr.filas <-c("B", "¬B")
rownames(df)<-nombr.filas
df

df_p <- df/n
df_p <- round(df_p, digits = 2)
df_p <- as.data.frame(df_p)
df_p

datos <- matrix(c(AB, ACB, (AB+ACB) ,CAB, CACB, (CAB + CACB), (AB+CAB), (ACB+CACB), (AB+ACB+CAB + CACB)), nrow = 3, ncol = 3)
df_t <- data.frame(datos)
nombr.columnas <-c("A", "¬A", "Total")
colnames(df_t)<-nombr.columnas
nombr.filas <-c("B", "¬B", "Total")
rownames(df_t)<-nombr.filas
df_t <- as.data.frame(df_t)
df_t

```

P(A ∩ B) = P(A) * P(B)
0.51 ≠ 0.5 no son independientes


```{r}
#Hallar la probabilidad condicional
# P(A|B) = P(A ∩ B) / P(B)
P_AintB <- df_p[1, 1]
P_AdadoB <- P_AintB/P_B
P_AdadoB <- round(P_AdadoB,2)
P_AdadoB

#BAYES
# P(B|A) = P(A|B) . P(B) / P(TA)
# P(TA) = P(A|B). P(B) + P(A|¬B) .P(¬B) 
# P(A|¬B) = A¬B/T¬B
# P(¬B) = T¬B/Total

Total <- df_t[3, 3]
TCB <- df_t[2, 3]

P_TotalA <- (P_AdadoB*P_B) + ((ACB/TCB)*(TCB/Total))
P_TotalA <- round(P_TotalA,2)
P_BdadoA <- (P_AdadoB * P_B)/ P_TotalA
round(P_BdadoA,2)
```

**Análisis:** En este caso, si la probabilidad condicional P(B|A) es mayor que la probabilidad del evento A (P(A)). Se puede interpretar que la creencia de que la educación es un factor clave para prevenir la violencia de género (evento B) está influenciada por haber recibido una charla informativa en la universidad sobre violencia de género (evento A).

Esta dependencia indica que la información recibida en la charla informativa puede estar influyendo en la percepción y consideración de la educación como un factor importante en la prevención de la violencia de género.

La probabilidad del evento A dado el evento B es de 0.53 y la probabilidad del evento B dado el evento A es de 0.98

# **ANALISIS DESCRIPTIVO**

# **Variables Discretas**

## **Variable 1:**

**Paso 1: Definir distribucion**

Distribución binomial o binómica
- El éxito de la variable está definido por la cifra más aproximada al valor real de casos denunciados de violencia de género en el Perú. Esta cifra oscila entre los 90000 y 180000 casos anuales, tomaremos a la opción "Más de 100000" casos para el cálculo.

```{r}
sum(Data$CasosViolencia=="Más de 100000") #CANTIDAD DE ÉXITOS DE LA VARIABLE ESTABLECIDA
```

**Paso 2: Construir variable**
## **Variable 2:**

**Paso 1: Definir distribución**
  
   Se usa el tipo de distribución binomial.
  - El éxito de la variable se define por la cantidad de alumnos encuestados que hayan sido instruidos sobre la violencia de género en su hogar.
  
```{r}
sum(Data$InstruidoViolenciaG=="En casa") #Cantidad de éxitos de la Variable aleatoria discreta
```


**Paso 2: Constuir variable**

  VADiscreta2: Número de alumnos encuestados que se instruyeron sobre violencia de género en su hogar.
  
**Paso 3 y 4: Definir parámetros.**
  Tomamos el total de observaciones obtenidas para esta representación y la representamos mediante una     función de masa de probabilidad.

  Bin(n,p) -> Bin(151, probabilidad)
  
(...)


```{r}

frecuencia1 <- table(Data$InstruidoViolenciaG)
frecuencia2 <- table(round(frecuencia1/n, digits=2))
frecuencia2.1 <- sum(Data$InstruidoViolenciaG=="En casa")/n

cat("\nDistribución de instrucción \n")
frecuencia1
cat("\nProbabilidades \n")
frecuencia_probabiliad_1 <- frecuencia1 / n
frecuencia_probabiliad_1 <- round(frecuencia_probabiliad_1, digits = 2)
frecuencia_probabiliad_1

# Paso 3 y 4: 

plot(dbinom(x=1:151,size=151, frecuencia2.1), ylim=c(0,0.1), main="Distribucion de la variable", ylab="P(X=x)", xlab="x")

# Paso 5: Propiedades
cat("\nEsperanza: ")
n*frecuencia2.1
cat("\nVarianza: ")
round(n*frecuencia2.1*(1-frecuencia2.1), digits=2)

```
**Paso 6:**
  ¿Cuál es la probabilidad de que un alumno no haya sido instruido sobre la violencia de género en su hogar?

```{r}
round(1-frecuencia2.1, digits=2)
```



# **Variables continuas**


## **Variable 1:**

**Paso 1: Identificar distribución**

```{r}

# Calcular la densidad de los datos
densidad <- density(Data$MedidasPrevencion)

# Crear el gráfico
plot(densidad, lwd=2, col="red", main="Calificación medidas de prevención", xlab="Puntaje")

# Agregar líneas verticales para separar los intervalos
abline(v = 2.5, lwd = 2, col = "blue")

# Mostrar leyenda para indicar los intervalos
legend("topright", legend=c("Intervalo"), col=c("blue"), lwd=2)
```

**Paso 2: Validación**

  Mediante este gráfico, observamos que no se trata de una distribución normal, uniforme o exponencial. 
  Establecemos a 2.5 como calificación correcta para las medidas del Estado para prevenir y abordar la violencia de género, entonces el la línea azul divide el gráfico entre los que consideran que el Estado tiene menor y mayor puntaje.
  
**Paso 3 y 4:**  

  ¿Cual es la probabilidad de encontrar un alumno que considere que el Estado tiene menor puntaje del establecido?
  
```{r}
fr <- table(Data$MedidasPrevencion<2.5)
prob <- round(fr/n, digits=2)
prob
```
  La probabilidad de encontrar un alumno que califique al Estado con un puntaje menor al establecido es de 0.78.  



## **Variable 2:**

**Paso 1: Identificar distribución**

```{r}

# Calcular la densidad de los datos
densidad <- density(Data$EstadoEfectivo)

# Crear el gráfico
plot(densidad, lwd=2, col="red", main="Estado efectivo", xlab="Puntuación")

# Agregar líneas verticales para separar los intervalos
abline(v = 1, lwd = 2, col = "blue")

# Mostrar leyenda para indicar los intervalos
legend("topright", legend=c("Intervalos" ), col=c("blue"), lwd=2)
```


**Paso 2: Validar distribución**

  Notamos que no tenemos una distribución conocida. Para la efectividad del Estado de prevenir y abordar la violencia de género establecemos 1 como calificación correcta. Notamos que esta toma una distribución exponencial.


**Paso 3: Propiedades**
```{r}
lambda <- 1/mean(Data$EstadoEfectivo)
cat("\nEsperanza: ")
round(1/lambda, digits=2)
cat("\nVarianza: ")
round(1/(lambda^2), digits=2)

```


**Paso 4:** 
  ¿Cuál es la probabilidad de encontrar un alumno que dé un puntaje mayor al establecido?
  
```{r}
round(pexp(q=1, rate = lambda, lower.tail=FALSE),digits=2)
```
