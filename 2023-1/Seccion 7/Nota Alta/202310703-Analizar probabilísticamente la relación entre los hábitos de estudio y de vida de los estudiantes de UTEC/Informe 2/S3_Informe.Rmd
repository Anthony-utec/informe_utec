---
title: "Informe"
output: html_document
date: "2023-07-07"
editor_options: 
  markdown: 
    wrap: 72
---

```{r,echo=FALSE, include = FALSE}
library(readr)
library(dplyr)
library(ggplot2)
```

```{r,echo=FALSE, include=FALSE}
DT1 <- read_csv("final.csv")

```


# 1. Introducción

## Relevancia

En el estudio anterior se analizaron los patrones estadísticos de alumnos de UTEC del ciclo 2022-2 respecto a sus hábitos, gestión del estrés y rendimiento académico. En este informe se da un paso más allá y se analizan estos datos bajo la probabilidad. Esto nos sirve como herramienta para encontrar numéricamente relaciones entre variables, probabilidades y generar modelos que nos permitan producir predicciones respecto al comportamiento de la población estudiada.

## Objetivos

Nuestro proyecto tiene los siguientes objetivos:

### Objetivo general:

Analizar probabilísticamente la relación entre los hábitos de estudio y de vida de los
estudiantes de UTEC durante el ciclo académico 2022-2, y cómo se
correlacionan con el manejo del estrés y el rendimiento académico.

### Objetivos específicos:

Identificar las probabilidades empíricas de variables estudiadas en la encuesta.

Estudiar la dependencia que puede existir entre hábitos y medidores de rendimiento académico.

Definir variables aleatorias discretas y continuas y generar modelos que nos permitan realizar predicciones probabilísticas

Profundizar de forma práctica en los conocimientos relacionados a la Probabilidad.

### Contexto

Este estudio está basado en la información recolectada anteriormente en el estudio estadístico. Para este informe, se aplicarán conocimientos de probabilidades. Una definición básica de esta área es el estudio de qué tan posible es que ocurra un evento determinado, bajo distintas herramientas de estudio. Se emplearán conceptos como probabilidad empírica, condicional, teorema de Bayes y Probabilidad Total, modelos de distribución de V.A. Discretas y modelos de distribución de V.A. Continuas y descriptores numéricos. Cada uno de estos temas se irá desarrollando a lo largo de este proyecto.


# 2. Análisis descriptivo.

## 2.1 Análisis descriptivo univariado

### Promedio Ponderado

Esta es una variable numérica continua y se describe como el promedio
obtenido en el ciclo pasado. Los valores son números no negativo con dos
cifras decimales

```{r,echo=FALSE}
#Graficamos histograma de la variable numérica continua "Promedio Ponderado", este nos permitirá visualizar como están distribuidos los datos, en este caso el promedio de los alumnos en el periodo 2022-2. 
hist(DT1$Promedio, main = "Promedio Ponderado", ylab = "Frecuencia", xlab = "Promedio", col = "green", breaks = 20, las = 2, xlim = c(10, 20))
abline(v = median(DT1$Promedio, na.rm = TRUE), col = "red", lwd = 3)
abline(v = mean(DT1$Promedio, na.rm = TRUE), col = "purple", lwd = 3)
legend(100, 140,
       x = "topleft",
       legend = c("MEDIA", "MEDIANA"),
       col = c("purple", "red"),
       lwd = 2)
```

-   **ANÁLISIS**

-   La gráfica muestra que el promedio oscila entre 10.51 y 18.75,
    [10.51 - 18.75]. Podemos decir que el mínimo promedio ponderado es
    de 10.51 mientras que el máximo es de 18.75 durante el ciclo
    académico 2022-2.

```{r,echo=FALSE}
rango_promedio <- range(na.omit(DT1$Promedio[DT1$Promedio != 0]))
rango_promedio
```

-   El valor central o mediana del promedio ponderado de los alumnos es
    de 15.32.

```{r,echo=FALSE}
mediana_promedio <- median(na.omit(DT1$Promedio))
mediana_promedio

```

-   El valor del promedio general o media aritmética de las notas es
    15.24

```{r,echo=FALSE}
media_promedio <- mean(na.omit(DT1$Promedio))
round(media_promedio,2) 
```

*Al comparar la mediana con la media aritmética del promedio Ponderado
de los alumnos, podemos apreciar que la mediana es ligeramente mayor que
la media, lo cual nos indica que la distribución de los valores tiende a
estar ligeramente inclinada o sesgada hacia la izquierda*

### Estrés

Esta es una variable categórica ordinal y se describe como el nivel de
estrés experimentado durante el ciclo. Las posibles respuestas son: 1.
Nada estresado / Tranquilo 2. Algo estresado 3. Estresado 4. Saquenme de
UTEC (Alto nivel de estrés).

```{r,echo=FALSE}
DT1$Estres <- factor(DT1$Estres)

tabla_estres <- table(DT1$Estres)
color <- c("blue", "green", "yellow", "red")
barplot(tabla_estres, cex.names = 0.5, ylim = c(0, 60), col = color, main = "Nivel de estrés durante el ciclo", xlab = "Nivel de estrés", ylab = "Cantidad")
```

-   **ANÁLISIS**

-En la gráfica de niveles de estrés durante el ciclo, podemos apreciar
que el nivel de estrés de los estudiantes en su mayoría es estresado o
algo estresado, además el nivel de estrés de una minoría de estudiantes
ha sido tranquilo.\
-La cantidad de estudiantes que estuvieron ***algo estresado*** de es
57, mientras que la cantidad de ***estresado*** es de 56.\
- Solo 7 alumnos del total de encuestados no sufrieron de ***Estrés***.

### ¿El estudiante cumplió sus expectativas?

Esta variable es categórica ordinal y muestra si el estudiante cumplió
sus expectativas durante del ciclo 2022-2. Las posibles respuestas
son: 1. 1 (No las cumplí) 2. 2 (No las cumplí pero estuve cerca) 3. 3
(Las cumplí) 4. 4 (Las superé) 5. 5 (Las superé por bastante)

```{r}
barplot(prop.table(table(DT1$cumplio_exp)), main= "Cumplió expectativas", ylab= "Frecuencia", xlab = "Cumplió expectativas")
```

Podemos observar cómo la opción con más respuestas es aquella de
simplemente **"cumplir sus expectativas"**.

### ¿El estudiante medita?

Esta es una variable categórica cualitativa y mide si el estudiante
medita o realiza alguna práctica de mindfullness

```{r}
barplot(prop.table(table(DT1$Medita)), ylab= "Frecuencia", xlab = "Medita")
```

A través de esta gráfica observamos cómo son la minoría los estudiantes
que tienen el hábito de meditar. Ocupan el 26,4% de la muestra.

### Cantidad de estudiantes por carrera

Esta es una variable categórica cualitativa. Pregunta por la carrera en
la que estudian los participantes del experimento. Las opciones son las
carreras ofrecidas por UTEC.

```{r,echo=FALSE}
ggplot(DT1,aes(x=Carrera))+geom_bar(fill="orange4")+coord_flip() + theme_classic()+labs(y="Cantidad")+ggtitle("Cantidad de estudiantes por carrera")+theme(axis.title.y = element_text(face="bold",vjust=0.5,color="red"))+theme(axis.title.x = element_text(face="bold",vjust=0.5,color="red"))

```

Del total de encuestados 48 estudiantes son de las carrera de ingeniería
industrial, es la carrera que más se repite y es la moda de nuestra
gráfica ***cantidad de estudiantes por carrera***, mientras que tuvimos
menos participación de los estudiantes de la carrera de administración y
negocios digitales, y de la carrera de Ing. de la Energía, puesto que
solo fueron 3 encuestados en ambas carreras.

### Cantidad de agua bebida a diario por los participantes del estudio (en mL)

Esta es una variable numérica continua. Los valores posibles son números
naturales.

```{r}
hist(pull(DT1[9]), prob = T, main = "Agua", xlab = "mL de agua diarios", ylab = "Frecuencia", col="orange",breaks = 30,las=2)
lines(density(pull(DT1[9]), na.rm = T), lwd = 2, col="red")
abline(v=median(pull(DT1[9]),na.rm = TRUE),col="blue",lwd=3)
abline(v=mean(pull(DT1[9]),na.rm = TRUE),col="green",lwd=3)
legend(100,140,
       x="topleft",
       legend=c("MEDIA","MEDIANA"),
       #inset = 0.1,
       col=c("blue","green"),
       lwd=2)

```

Aquí observamos el gráfico de distribución de la variable en análisis.
La media es 1326.86 y la mediana, 1000. El mínimo y máximo son 200 y
600, respectivamente

## Análisis descriptivo bivariado

### Cumplimiento de expectativas vs promedio obtenido

Este análisis se centra en comparar el rendimiento académico promedio de
los alumnos con su percepción sobre el cumplimiento de sus expectativas
académicas.

**GRÁFICA - Comparación entre cumplimiento de expectativas y promedio
ponderado**

```{r, echo=FALSE}
boxplot(DT1$Promedio ~ DT1$cumplio_exp, col = c("blue", "red", "green", "yellow"), xlab = "Cumplió expectativas", ylab = "Promedio")
```

-   **ANÁLISIS**

Este es el análisis bivariado más importante que se encontró en todo el
experimento. Muestra cómo efectivamente un mayor cumplimiento de
expectativas se relaciona directamente con un mayor promedio. Claramente
se observan variaciones, pero el patrón es visible.

### Cumplió expectativas vs tener el hábito de meditar

```{r}
mosaicplot(DT1$cumplio_exp~DT1$Medita, main="Cumplió expectativas vs tener el hábito de meditar", ylab="Medita", xlab="Cumplió expectativas")
```

**ANÁLISIS** En esta gráfica observamos cómo en realidad no existe una
relación marcada entre cumplir o no sus expectativas y tener el hábito
de meditar. Si esta relación existiese, esta gráfica de mosaico tendría
un patrón similar a una escalera.

# 3. Análisis probabilístico

## <span style="color:#03045e"> **Cálculo de probabilidades empíricas**

### <span style="color:#023e8a"> *1. Promedios de estudiantes en el ciclo 2022-2*

##### <span style="color:#0077b6"> **Experimento:** 

**Experimento:** Seleccionar un participante del estudio: "Análisis de
la relación entre los hábitos, la gestión del estrés y el rendimiento
académico en los estudiantes de UTEC en el ciclo académico 2022-2" y
observar si su promedio está en el rango de notas (0,4], (4,8], (8,12],
(12,16] o (16,20].

##### <span style="color:#0077b6"> **Espacio muestral:**

Ω = {(0,4] (4,8] (8,12] (12,16] (16,20]}

##### <span style="color:#0077b6"> **Donde cada evento atómico significa:**

|             |                                                                                                                                                                                                                                               |
|:----------------------------|:-----------------------------------------:|
| (0,4] -\>   |  Seleccionar un participante del estudio: "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que su promedio está entre 0 y 4.  |
| (4,8] -\>   |  Seleccionar un participante del estudio: "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que su promedio está entre 4 y 8.  |
| (8,12] -\>  | Seleccionar un participante del estudio: "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que su promedio está entre 8 y 12.  |
| (12,16] -\> | Seleccionar un participante del estudio: "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que su promedio está entre 12 y 16. |
| (16,20] -\> | Seleccionar un participante del estudio: "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que su promedio está entre 16 y 20. |
|             |                                                                                                                                                                                                                                               |

### <span style="color:#023e8a"> *Cálculo de las probabilidades empíricas de cada evento atómico*

```{r}
intervalos_promedios <- cut(DT1$Promedio, breaks = c(0, 4, 8, 12, 16, 20)) 
round(prop.table(table(intervalos_promedios)),2)
```

##### <span style="color:#0077b6"> **En este caso:**

|             |      |
|:------------|:----:|
| (0,4] -\>   | 0.00 |
| (4,8] -\>   | 0.00 |
| (8,12] -\>  | 0.05 |
| (12,16] -\> | 0.65 |
| (16,20] -\> | 0.31 |
|             |      |

Estos resultados nos muestran cómo la mayor parte de los estudiantes
obtuvieron calificaciones entre 12 y 16, por lo que las podemos
considerar como "Notas promedio". Por otro lado, ninguno tuvo notas
menores a 8 y solo 1 entre 8 y 12, lo que indica que es a lo mucho 1 el
estudiante que ha obtenido un promedio desaprobatorio

### <span style="color:#023e8a"> *2. El nivel de estrés del estudiante durante el ciclo 2022-2*

##### <span style="color:#0077b6"> **Experimento:**

Seleccionar un participante del estudio: "Análisis de la relación entre
los hábitos, la gestión del estrés y el rendimiento académico en los
estudiantes de UTEC en el ciclo académico 2022-2" y observar su
respuesta respecto a cuál fue su nivel de estrés durante el ciclo
2022-2.

##### <span style="color:#0077b6"> **Espacio muestral:**

Ω = {0,1,2,3}

##### <span style="color:#0077b6"> **Donde cada evento atómico significa:**

|     |                                                                                                                                                                                                                                          |
|:------------------|:---------------------------------------------------:|
| 0   |  Seleccionar un participante del estudio "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que no estuvo nada estresado.  |
| 1   |   Seleccionar un participante del estudio "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que estuvo algo estresado.    |
| 2   | Seleccionar un participante del estudio "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que estuvo bastante estresado.  |
| 3   | Seleccionar un participante del estudio "Análisis de la relación entre los hábitos, la gestión del estrés y el rendimiento académico en los estudiantes de UTEC en el ciclo académico 2022-2" y observar que estuvo demasiado estresado. |
|     |                                                                                                                                                                                                                                          |

### <span style="color:#023e8a"> *Cálculo de las probabilidades empíricas de cada evento atómico*

```{r}
round(prop.table(table(DT1$Estres)),2)
```

##### <span style="color:#0077b6"> **En este caso:**

|                             |      |
|:----------------------------|:----:|
| 0 (nada estresado) -\>      | 0.05 |
| 1 (algo estresado) -\>      | 0.37 |
| 2 (bastante estresado) -\>  | 0.36 |
| 3 (demasiado estresado) -\> | 0.23 |
|                             |      |

Estos datos nos muestran cómo son muy pocos los estudiantes que no han
estado nada estresados. Es decir, siempre presentan cierto nivel de
estrés, concentrado alrededor de algo y bastante estresado,
principalmente.

## <span style="color:#03045e"> **Cálculo de probabilidades condicionales**

#### <span style="color:#023e8a"> *Eventos dependientes (Superar por bastante sus expectativas y tener un promedio mayor o igual a 16)*

##### <span style="color:#0077b6"> **Definición de eventos:**

**A**: Seleccionar un participante del estudio "Análisis de la relación
entre los hábitos, la gestión del estrés y el rendimiento académico en
los estudiantes de UTEC en el ciclo académico 2022-2" y observar que ha
superado por bastante sus expectativas.

**B**: Seleccionar un participante del estudio "Análisis de la relación
entre los hábitos, la gestión del estrés y el rendimiento académico en
los estudiantes de UTEC en el ciclo académico 2022-2" y observar que
tiene un promedio mayor o igual a 16.

##### <span style="color:#0077b6"> **Probabilidades empíricas de estos eventos**

```{r}
round(prop.table(table(DT1$cumplio_exp==5)),2)
round(prop.table(table(DT1$Promedio >= 16)),2)
```

##### <span style="color:#0077b6"> **Validación de dependencia**

1.  Cálculo de probabilidad de la intersección de ambos eventos:

```{r}
DT1 %>%
  filter(cumplio_exp == 5 & Promedio >= 16) %>% 
  nrow() -> interseccion

round(interseccion / nrow(DT1),2)
```

2.  Cálculo de la multiplicación de la probabilidad de cada evento
    independientemente:

```{r}
supero <- sum(DT1$cumplio_exp == 5, na.rm=TRUE) / nrow(DT1)
nota <- sum(DT1$Promedio >= 16, na.rm=TRUE) / nrow(DT1)

round(supero * nota,2)
```

3.  Validación: Observamos que los resultados obtenidos son distintos
    (0.04 y 0.01). Esto nos indica que los eventos tienen un grado de
    dependencia

4.  Cálculo de la probabilidad de A dado que ocurre B

```{r}
subconjunto <- subset(DT1, Promedio >= 16)

round(prop.table(table(subconjunto$cumplio_exp == 5)),2)
```

Se observa que la probabilidad del evento A aumenta drásticamente si
ocurre B. Pasa de 0.04 a 0.11.

5.  Cálculo de la probabilidad de B dado que ocurre A (a posteriori)

```{r}
subconjunto <- subset(DT1, cumplio_exp == 5)

prop.table(table(subconjunto$Promedio >= 16))
```

**APLICACIÓN DEL TEOREMA DE BAYES Y PROBABILIDAD TOTAL**

Otra forma de calcular esta probabilidad es a través del empleo del
teorema de Bayes y la probabalidad total

Para ello, primero creamos una tabla de contingencia ayudándonos del
siguiente comando

```{r, results='hide'}
round(prop.table(table(DT1$Promedio >= 16, DT1$cumplio_exp == 5)),2)
```

| tabla de contingencia |  A'  |   A    | Total |
|:----------------------|:----:|:------:|------:|
| B'                    | 0.64 |  0.00  |  0.64 |
| B                     | 0.32 | 0\. 04 |  0.36 |
| Total                 | 0.96 |  0.04  |     1 |

Donde se P(A) = 0.04 también puede conseguirse también a través del
teorema de probabilidad total:
$$ P(A)=P(A|B) * P(B) + P(A|B') * P(B') $$

```{r}
pa <- ((0.04)/0.36)*0.36 + ((0.00)/0.64)*0.64
pa
```

Con estos datos aplicamos el teorema de Bayes
$$ P(B|A) = \frac{P(A|B) * B}{A} $$
$$ P(B|A) = \frac{0.11 * 0.36}{0.04} $$

```{r}
(0.11) * 0.36 / 0.04
```

$$ P(B|A) = \frac{0.11 * 0.36}{0.04} = 0.99 $$

**OBSERVACIONES:** Se observa que el evento B a posteriori de la
ocurrencia de A es, en este caso, **seguro**. Se muestra que siempre que
el participante haya superado por bastante sus expectativas, tendrá un
promedio mayor o igual a 16.

#### <span style="color:#023e8a"> *Eventos independientes (Superar expectativas dado que se medita)*

##### <span style="color:#0077b6"> **Definición de eventos:**

**A**: Seleccionar un participante del estudio "Análisis de la relación
entre los hábitos, la gestión del estrés y el rendimiento académico en
los estudiantes de UTEC en el ciclo académico 2022-2" y observar que
tiene más de 17 años.

**B**: Seleccionar un participante del estudio "Análisis de la relación
entre los hábitos, la gestión del estrés y el rendimiento académico en
los estudiantes de UTEC en el ciclo académico 2022-2" y observar que
tiene el hábito de meditar.

##### <span style="color:#0077b6"> **Probabilidades empíricas de estos eventos**

```{r}
round(prop.table(table(DT1$Edad > 17)),2)
round(prop.table(table(DT1$Medita == TRUE)),2)

```

##### <span style="color:#0077b6"> **Validación de dependencia**

1.  Cálculo de probabilidad de la intersección de ambos eventos:

```{r}
DT1 %>%
  filter(Edad > 17 & Medita == TRUE) %>% 
  nrow() -> interseccion

round(interseccion / nrow(DT1),2)
```

2.  Cálculo de la multiplicación de la probabilidad de cada evento
    independientemente:

```{r}
mayor <- sum(DT1$Edad > 17, na.rm=TRUE) / nrow(DT1)
medita <- sum(DT1$Medita == TRUE, na.rm=TRUE) / nrow(DT1)

round(mayor * medita,2)
```

3.  Validación: Observamos que los resultados obtenidos son muy
    similares (0.23 y 0.24). Esto nos indica que los eventos son
    independientes.

4.  Cálculo de la probabilidad de A dado que ocurre B

```{r}
subconjunto <- subset(DT1, Medita == TRUE)

round(prop.table(table(subconjunto$Edad > 17)),2)
```

Se observa que la probabilidad del evento no presenta un cambio
significativo por el hecho de que ocurra B. Pasa de 0.9 a 0.85.

5.  Cálculo de la probabilidad de B dado que ocurre A (a posteriori)

```{r}
subconjunto <- subset(DT1, Edad > 17)

round(prop.table(table(subconjunto$Medita == TRUE)),2)

round(0.85 /mayor * medita,2)
```

**APLICACIÓN DEL TEOREMA DE BAYES Y PROBABILIDAD TOTAL**

Otra forma de calcular esta probabilidad es a través del empleo del
teorema de Bayes y la probabalidad total

Para ello, primero creamos una tabla de contingencia ayudándonos del
siguiente comando

```{r, results = 'hide'}
round(prop.table(table(DT1$Medita == TRUE, DT1$Edad > 17)),2)
```

| tabla de contingencia |  A'  |  A   | Total |
|:----------------------|:----:|:----:|------:|
| B'                    | 0.06 | 0.67 |  0.73 |
| B                     | 0.04 | 0.23 |  0.27 |
| Total                 | 0.10 | 0.90 |     1 |

Donde se P(A) = 0.9 también puede conseguirse también a través del
teorema de probabilidad total:
$$ P(A)=P(A|B) * P(B) + P(A|B') * P(B') $$

```{r}
pa <- ((0.23)/0.27)*0.27 + ((0.67)/0.73)*0.73
pa
```

Con estos datos aplicamos el teorema de Bayes
$$ P(B|A) = \frac{P(A|B) * B}{A} $$
$$ P(B|A) = \frac{0.85 * 0.27}{0.9} $$

```{r}
(0.85) * 0.27 / 0.9
```

$$ P(B|A) = \frac{0.85 * 0.27}{0.9} = 0.255 $$

**OBSERVACIÓN** En este caso se observa que tampoco hay una diferencia
significativa en la probabilidad. Se pasa de 0.26 a 0.25.

### <span style="color:#1FB0DB">*Distribucion Binomial*

### <span style="color:#1FB0DB">*Variable Aleatoria Discreta: Nivel de estrés*

**OBJETIVO:** Analizar la variable **Nivel de estrés**

```{r,echo=FALSE}
round(prop.table(table(DT1$Estres)),2)
```

| <span style="color:#3F7281">*Niveles* | <span style="color:#3F7281">*Probabilidad* |           <span style="color:#3F7281">*Unidad*           |
|:-----------------:|:-----------------------:|:--------------------------:|
|           *Nada estresado*            |                    0.05                    | Probabilidad que se escoja el nivel ***Nada estresado*** |
|           *Algo estresado*            |                    0.37                    | Probabilidad que se escoja el nivel ***Algo estresado*** |
|              *Estresado*              |                    0.36                    |   Probabilidad que se escoja el nivel ***Estresado***    |
|            *Muy estresado*            |                    0.23                    | Probabilidad que se escoja el nivel ***Muy estresado***  |

```{r,echo=FALSE}
table(DT1$Estres)
```

#### **Variables aleatorias**

-   Números de estudiantes de la **UTEC** que se encuentra en los
    niveles de *algo o nada estresado* dentro de un conjunto de 55
    alumnos del estudio seleccionados al azar.

#### **Probabilidad de exito**

-   La variable X que cuenta el número de estudiantes que se encuentran
    en los niveles de algo o nada estresado sigue una distribución
    binomial con los parámetros n y p, donde n es el número total de
    pruebas (55) y p es la probabilidad de éxito, que se puede estimar a
    partir de los datos de la muestra. En este caso, p es igual al
    número de éxitos entre el número total de pruebas, es decir:

$$ p=\frac{(7 + 57)}{155}=\frac{64}{155}≈0.41 $$

Por lo tanto, la variable X sigue una distribución binomial con los
siguientes parámetros:

$$ X∼B(n,p) $$ $$ X∼B(55,0.41) $$

```{r,echo=FALSE}
X <- dbinom(x = 0:55, size = 55, prob = 0.413)
plot(X, type = "h", main = "Distribución binomial de X", xlab = "Número de éxitos", ylab = "Probabilidad",col=c("red4"))

```

#### **Verificacion de datos**

-   Por teoria: $$ E(X)=\sum    X*P(X)$$

```{r,echo=FALSE}
estres = c(0:55)
sum(dbinom(0:55,55, 0.41)*estres)
cat("La esperanza por teoria es: ",sum(dbinom(0:55,55, 0.41)*estres))
```

-   Por formula de binomial:

$$ E(X)= n*p$$

> n=55

> p=0,41

```{r,echo=FALSE}
cat("La esperanza por formula es: ",0.41*55 )

```

**Cálculo de la varianza** $$ V(X) = n*p/(1-p) = 38.7 $$

#### **Ejemplos:**

###### **Ejemplo 1**

-   Hallar el número de estudiantes que se encuentran en el nivel algo o
    nada estresado en el conjunto de 55 pruebas.

Como es una distribución binomio utilizaremos la formula:
$$ P(X=x)=\begin{vmatrix}
n \\
x\\
\end{vmatrix}p^x (1-p)^{n-x}$$

Donde **n** es el numero de pruebas, **x** es el numero de éxitos y
**p** es la probabilidad de éxito, entonces, sustituyendo los valores,
tenemos: $$ P(X=x)=\begin{vmatrix}
55 \\
x\\
\end{vmatrix}0.41^x (1-0.59)^{55-x}$$

Esta fórmula nos da la probabilidad de que haya exactamente **x**
estudiantes en el nivel ***algo o nada estresado*** en las 55 pruebas.
Si queremos hallar el número esperado de estudiantes en ese nivel,
debemos multiplicar la probabilidad por el número de pruebas. Es decir:
$$ E(X)=n.P(X=x)=55.\begin{vmatrix}
55 \\
x\\
\end{vmatrix}0.41^x (1-0.59)^{55-x}$$ Esta expresión nos da el número
esperado de estudiantes en el nivel ***algo o nada estresado*** para
cada valor posible de **x**. Si queremos hallar el valor más probable,
debemos buscar el valor de **x** que maximiza la expresión.En este caso,
el valor más probable es **x**=23, que nos da un número esperado de:

$$ E(X)=55.\begin{vmatrix}
55 \\
23\\
\end{vmatrix}0.41^{23} (1-0.59)^{32}≈ 22,71$$

Es decir, se espera que haya unos 23 estudiantes en el nivel algo o nada
estresado en las 55 pruebas.

###### **Ejemplo 2.**

-   Se selecciona al azar una muestra de 20 encuestados del total
    de 155. ¿Cuál es la probabilidad de que al menos 15 de ellos se
    encuentren en el nivel algo o nada estresado? ¿Y el número esperado
    de encuestados en ese nivel?

Para resolver este problema, usamos la variable discreta binomial y la probabilidad de éxito ya planteados. Es decir, la variable es el número de encuestados en el nivel algo o nada estresado en la muestra de 20, que puede tomar valores entre 0 y 20. Y la probabilidad de éxito es 0.41. Entonces, usando la fórmula de la distribución binomial, tenemos:

$$ P(X=x)=\begin{vmatrix}
n \\
x\\
\end{vmatrix}p^x (1-p)^{n-x}$$

Donde **n** es el número de encuestados en la muestra, que es 20, **x**
es el número de éxitos y **p** es la probabilidad de éxito. Entonces,
para hallar la probabilidad de que al menos 15 de ellos se encuentren en
el nivel algo o nada estresado, debemos sumar las probabilidades de que
haya exactamente 15, 16, 17, 18, 19 o 20 encuestados en ese nivel.

Para obtener el resultado más rápidamente, utilizamos el código de R:

```{r}
pbinom(14, 20, 0.41, lower.tail = FALSE)

```

### <span style="color:#023e8a"> *Distribución Geométrica:* 

#### <span style="color:#023e8a"> **Pregunta 1:**

**¿Cuál es la probabilidad de encontrar que un estudiante de ingeniería
industrial tenga un nivel de 3 de estrés en la prueba número 7?**

**Definición de variable aleatoria:** Número de ensayo en el que se
obtendrá el primer estudiante con un nivel de estrés 3 dentro de una
muestra de estudiantes de ingeniería industrial que participaron del
experimento

**Identificación de parámetros:** X \~ Geom(p)

Donde p es la probabilidad de éxito. El éxito está definido como que un
estudiante dentro de la muestra mencionada elegido al azar tenga un
nivel de estrés 3.

**Análisis de la variable** Cantidad de estudiantes de ingeniería
industrial entre los encuestados

```{r}
sum(DT1$Carrera == "Ing. Industrial")
```

```{r,echo=FALSE}
X <- dgeom(x = 0:48, prob = 0.104)
plot(X, type = "h", main = "Distribución geométrica de X", xlab = "Número de ensayos", ylab = "Probabilidad",col=c("red4"))

```

Dentro de los participantes que están en la carrera de ingeniería
industrial (total=48), hay 5 que tienen un nivel de estrés 3:
$$ P(éxito) \;=\; \frac{5}{48}=0.104 $$ **Validación de las
propiedades** $$ E = \frac{1}{p} = 9.62$$

$$ V = \frac{1-p}{p^2} = 82.84 $$

Con estos datos, empleamos el siguiente código para hallar la
probabilidad de la pregunta inicial

```{r}
Civ_tr <- dgeom(6,0.104)

porcent_civ_tr <- round(Civ_tr *100,2)
porcent_civ_tr
```

Obtenemos que la probabilidad de que si se elige al azar un estudiante
que estudia ingeniería industrial y que participó del experimento, se
obtenga uno que tenga un nivel 3 de estrés en el 7mo ensayo es de 5.38
%.

##### <span style="color:#0077b6"> **Respuesta:**

Se observa que la probabilidad que un estudiante de ingeniería civil
tenga un nivel de 3 de estrés después de 4 ensayos en una muestra de 50
estudiantes es 8.18%.

### <span style="color:#1FB0DB">*Variable Aleatoria-Continua*

> Variable de estudio: Promedio

<center>

#### **Gráfica de la variable aleatoria continua**

</center>

```{r echo=FALSE, eval=TRUE}
valor <- mean(DT1$Promedio, na.rm = TRUE)
DT1 %>% mutate(Promedio= ifelse(is.na(DT1$Promedio)==TRUE, valor , Promedio)) -> DT2

hist(DT2$`Promedio`, col = "#FF9900", main = "Gráfico: Distribución de Promedios", xlab = "Promedio", ylab = "Función de densidad", xlim = c(0, 20), ylim = c(0, 0.3), freq = FALSE, breaks = 20)

dx <-density(DT2$Promedio)
lines(dx,main = "PROMEDIO DE LOS ESTUDIANTES DE LA UTEC \n QUE PARTICIPARON EN LA INVESTIGACIÓN",xlab = " ", ylab = " ", cex.main=0.8, col="green", lwd=4,cex=1)
abline(v= mean((DT2$Promedio)),col="red3",lwd=5)
abline(v= median((DT2$Promedio)),col="blue3",lwd=5)
legend("topleft",legend=c("Media","Mediana"),col=c("red3","blue3"),lwd=4,cex=1)

```

<center>

#### ***Validación de una distribución normal***

<center/>

> **Primera Validación**

$$ X ≈ Me  $$ \> ***X*** *representa el promedio aritmetico*

```{r echo=F, eval=TRUE, results='asis'}
p_media  <- round(mean(DT1$Promedio),2)
p_mediana <- round(median(DT1$Promedio),2)
cat("La media de la variable continua establecida en el estudio es ", p_media, " \nAsimismo la mediana de la variable aleatoria es ", p_mediana)
```

La mediana y la media tiene una variación mínima por ello podemos
concluir que se aproxima a una distribución normal.

> ***Segunda forma de validación***

$$ E(x) = \int_{-\infty}^{\infty} X * f(x) {\ dx} $$

$$ μ(Base\ datos) = E(X)$$

```{r echo=F, eval=TRUE,results = 'asis'}
y <- c(0:155)
py <- dnorm(y, mean(DT1$Promedio, na.rm=TRUE), sd(DT1$Promedio, na.rm=TRUE))
esperanza <- (y*py)
cat('La esperanza de la variable aleatoria X es de: ',round(sum(esperanza),2))

```

```{r echo=F, eval=TRUE,results = 'asis'}
cat('\nLa media de la variable Promedio ponderado es de: ',round(mean(DT1$Promedio, na.rm=TRUE),2))
```

> **Tercera forma de validación**

$$ V(X) = \int_{\ - \infty}^{\infty} {(X-E[X]}\ )^2 \ * \ f(X) \, dx  $$

$$  V(X) = {σ(\ BD)}^2 = {desviación\ estandar\ base\ datos}^2   $$

```{r echo=F, eval=TRUE,results = 'asis'}

e3 <- (y^2*py)
varianza <- sum(e3)-sum(esperanza)^2
cat('La varianza de la ***variable aleatoria X*** es de: ',round((varianza),2))

```

```{r echo=F, eval=TRUE,results = 'asis'}

desviación_estanda_pro <-round(sd(DT1$Promedio)^2,2)
cat("\nLa varianza de la variable ***Promedio ponderado*** es: ", desviación_estanda_pro)
```

## Parámetros

$$ X \frac{~} \ {N(μ , σ)}$$

μ-\> Es la media

σ-\> Es la desviación estándar

```{r echo=F, eval=T}

μ <- round(mean(DT1$Promedio),2)

σ <- round(sd(DT1$Promedio),2)


cat("La media es:", μ , "y la desviacion estandar es:", σ  )

```

#### **Ejemplos:**

**Ejemplo 1:**

La variable promedio ponderado de los estudiantes de la UTEC lleva una
distribución normal con una media de 15.24 y una desviación estándar de
1.69. ¿Cuál es la probabilidad de que el promedio sea menor que 17?

$$ N(15.24 , 1.69) $$

$$  P( X \leq 17)  $$

-   Hallando la probabilidad en R

```{r, echo=T}
prob7<-round(pnorm(17,15.24,1.69),2)

cat("La probabilidad de que el promedio ponderado del estudiante sea menor a 17 es:", prob7 )
```

**Ejemplo 2:**

La variable promedio ponderado de los estudiantes de la UTEC lleva una
distribución normal con una media de 15.24 y una desviación estándar de
1.69. ¿Cuál es la probabilidad de que el promedio ponderado este entre
15 y 17?

-   Hallando la probabilidad en R

```{r echo=TRUE, eval=T}

pr<-round((pnorm(17,15.24,1.69) - pnorm(15,15.24,1.69) ) * 100,2)

cat("La probabilidad de que el pormedio ponderado este entre 15 y 17 es de :", pr)
```

### <span style="color:#1FB0DB">*Variable Aleatoria-Continua*

> Variable de estudio: Cantidad de agua consumida a diario

La variable continua que ahora hemos considerado es la cantidad de agua
consumida por los alumnos de UTEC, representada por la variable Q.

$$Q∼Nor(μx,σx)$$

*Parametros* Los parámetros μx y σx representan la media y la desviación
estándar de la variable *Agua*.

$$μx = 1.326863$$ 
$$σx = 0.9819881$$

```{r, echo=FALSE, include=FALSE}
agua_litros <- na.omit(DT1$Agua) / 1000

# Media de la variable continua "Agua"
μ_q <-  mean(agua_litros)
μ_q
media <- μ_q

#Desviación estándar de la variable "Agua"
σ_q <-  sd(agua_litros)
σ_q
desviacion <- σ_q

# Varianza de la variable "Agua"
var_q <- var(agua_litros)
var_q

```

Para dar mayor claridad a nuestro análisis, es importante destacar que
hemos realizado una transformación en los datos de la variable "Agua"
para expresar las cantidades en litros en lugar de mililitros. 


```{r echo=FALSE}
hist(agua_litros, col = "#A2D921", main = "Distribución del consumo de agua", xlab = "Cantidad de agua (litros)", ylab = "D
     Funcion de densidad", xlim = c(0, 6), ylim = c(0, 0.70), freq = FALSE, breaks = 20)

x <- seq(0, 6, length = 100)
y_teorica <- dnorm(x, mean = media, sd = desviacion)
densidad <- density(agua_litros)

lines(x, y_teorica, col = "#FFA500", lwd = 2) # Naranja
lines(densidad, col = "#2F549A", lwd = 2, lty = 2) # Azul claro

legend("topright", col = c("#FFA500", "#2F549A"), legend = c("Curva teórica (normal)", "Curva de densidad"), lwd = 2, bty = "n", cex = 0.8, lty = 1:2)
```

El gráfico muestra el histograma de la distribución de consumo de agua,
donde se representan las frecuencias de los diferentes intervalos de
consumo, sobre la cual se ha trazado la curva normal teórica.

Observaciones y análisis:

Después de analizar la variable "Agua", se observa que presenta una
distribución asimétrica positiva, indicando un sesgo hacia la derecha.
La mayoría de los alumnos (alrededor del 50%) consumen entre 0.5 y 2
litros de agua. Estos resultados revelan una concentración
significativa de consumidores en el rango de menor consumo.

**Caso probabilístico:**

Para ilustrar lo mencionado anteriormente acerca de la variable de
tiempo, se plantea un caso probabilístico: ¿Cuál es la probabilidad de
que los estudiantes de UTEC consuman agua entre 2.5 y 6 litros de agua
diariamente? La función de probabilidad correspondiente será la
siguiente:

Respondiendo el caso P(2.5 litros/semana \<X\<6
litros/semana)=P(X\<2.25)-P(X\<6)

```{r}
pnorm(6,μ_q,σ_q)-pnorm(2.5,μ_q,σ_q)
```

Se ha determinado que la probabilidad de que los estudiantes de UTEC
consuman entre 2.5 litros y 6 litros de agua por día es del 11.61%.
Esto indica que una proporción relativamente pequeña de
estudiantes se encuentra dentro de ese rango de consumo específico,
mientras que la mayoría tiende a consumir cantidades de agua más bajas.


```{r, echo=FALSE}
lb <- 2.5 # Límite inferior
ub <- 6   # Límite superior

x2 <- seq(2.5, 6, length = 100) # Nueva rejilla
y <- dnorm(x2, μ_q, σ_q) # Densidad
f <- dnorm(x, μ_q, σ_q)

plot(x, f, type = "l", lwd = 2, col = "#1F7E57", main = "Gráfico: Distribución de agua consumida", ylab = "Frecuencia de densidad", xlab = "Cantidad de agua (litros)")
abline(v = ub) 

polygon(c(lb, x2, ub), c(0, y, 0), col = rgb(0.12, 0.49, 0.34, alpha = 0.5))
text(1000, 0.01, "32.97%", srt = 90)

```

# Conclusiones

* Se consiguió determinar que la mayor parte de los promedios de la población encuestada están entre 12 y 16.

* Se observó que la mayor parte están o algo estresados o muy estresados, siendo muy pocos aquellos que indican estar "nada estresados".

* Se determinó que los eventos de superar por bastante sus expectativas y sacar un promedio alto (mayor o igual a 16) están fuertemente relacionados. Esta observación es importante porque nos permite comprobar una suposición lógica que muchos tenemos.

* Gracias a un modelo binomial, sabemos que si tomamos una muestra aleatoria de 55 personas, obtendremos en promedio 22.5 de ellas que se encuentran nada o algo estresados. 

* Gracias a una modelación normal, sabemos que aproximadamente el 85% de los estudiantes tendrán un promedio menor a 17, lo que equivale a decir que solo un 15% tendrá un promedio mayor a esta cifra.

* Gracias a otro modelo normal, se observó cómo aproximadamente solo un 11.61% de los participantes del estudio tomará más de 2,5 L de agua. Este es un dato de relevancia porque muestra cómo una gran parte de los estudiantes no toman el agua que necesitarían regularmente.

* Gracias a estos análisis, se profundizó en los conocimientos de probabilidad emírica, condicional, teorema de Bayes y Probabilidad Total, V.A. Discretas y V.A. Continuas.
