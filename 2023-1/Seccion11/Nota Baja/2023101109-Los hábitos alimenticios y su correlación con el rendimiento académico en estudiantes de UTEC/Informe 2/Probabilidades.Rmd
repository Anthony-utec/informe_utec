---
title: "S9 Presentación"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
---

# Tema: "Los hábitos alimenticios y su correlación con el rendimiento académico en estudiantes universitarios de UTEC, Barranco-Lima-Perú 2023"

<!-- ```{r} -->
<!-- install.packages("dplyr") -->
<!-- install.packages("ggplot2") -->
<!-- install.packages("readr") -->
<!-- install.packages("corrplot") -->
<!-- install.packages("fitdistrplus") -->
<!-- install.packages("plotrix") -->
<!-- install.packages("rriskDistributions") -->
<!-- install.packages("fastGraph") -->
<!-- ``` -->

```{r warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(readr)
library(corrplot)
library(fitdistrplus)
library(plotrix)
library(DescTools)
library(rriskDistributions)
library(fastGraph)
```

```{r}
DF1 <- read_csv("Base_de_datos_limpio_proyecto.csv")
```

# Objetivo General

 **- **

# Objetivos específicos

 - 
 - 
 - 

# Análisis probabilístico

## Probabilidades empíricas

### Variable Promedio

**Espacio de resultados**

```{r warning=FALSE, echo=FALSE , message=TRUE}
length(DF1$Promedio)
```

```{r warning=FALSE, echo=FALSE , message=TRUE}
fi=table(cut(DF1$Promedio, breaks = c(0, 10, 14, 17,20),labels = c("Deficiente", "Bueno", "Regular", "Excelente "), include.lowest = TRUE, right = FALSE))
pi=prop.table(fi)
cbind(fi,pi)
```


**Definiendo los eventos atómicos**

 - Evento A: Selecionar un estudiante cuyo promedio sea menor a 10.
 - Evento B: Selecionar un estudiante cuyo promedio sea mayor igual 10 y menor a 14 .
 - Evento C: Selecionar un estudiante cuyo promedio seamayor igual 14 y menor a 17.
 - Evento D: Selecionar un estudiante cuyo promedio sea mayor igual 17,

**Función de probabilidad**

Evento A

```{r warning=FALSE, echo=FALSE , message=TRUE}
Evento_A <- sum(DF1$Promedio <10)
Total_eventos <- length(DF1$Promedio)
P_eventoA <- Evento_A /Total_eventos
P_eventoA
```

Evento B

```{r warning=FALSE, echo=FALSE , message=TRUE}
Evento_B <- sum(DF1$Promedio >=10 & DF1$Promedio <14)
Total_eventos <- length(DF1$Promedio)
P_eventoB <- Evento_B /Total_eventos
P_eventoB
```

Evento C

```{r warning=FALSE, echo=FALSE , message=TRUE}
Evento_C <- sum(DF1$Promedio >=14 & DF1$Promedio <17)
Total_eventos <- length(DF1$Promedio)
P_eventoC <- Evento_C /Total_eventos
P_eventoC
```

Evento D

```{r warning=FALSE, echo=FALSE , message=TRUE}
Evento_D <- sum(DF1$Promedio >=18)
Total_eventos <- length(DF1$Promedio)
P_eventoD <- Evento_D /Total_eventos
P_eventoD
```

### Variable IMC

Primero se calcula cuántos valores distintos hay en la base de datos, de esa forma hallaremos el Espacio muestral (o también llamado espacio de resultados).

Para definir eventos atómicos en el IMC, agrupamos los valores del IMC en intervalos específicos y consideramos cada intervalo como un "evento atómico", este en el contexto de variables continuas son una manera de simplificar y agrupar los valores para facilitar su análisis y presentación, pero no son inherentemente parte de la naturaleza de la variable continua.

```{r echo=FALSE, message=TRUE, warning=FALSE}
fi=table(cut(DF1$IMC, breaks = c(0, 18.5, 24.9, 29.9, 100),labels = c("BAJO (menos de 18.5) ", "NORMAL (18.5 a 24.9) ", "SOBREPESO (25 a 29.9) ", "OBESIDAD (30 a más)"), include.lowest = TRUE, right = FALSE))
pi=prop.table(fi)
cbind(fi,pi)
```

**Define los eventos**

- El evento asociado al rango BAJO (menos de 18.5) sería: "Seleccionar a un estudiante que tenga un IMC en un rango menor a 18.5 en una muestra de tamaño 170". 

- El evento asociado al rango NORMAL (18.5 a 24.9) sería: "Seleccionar a un estudiante que tenga un IMC en el rango de 18.5 a 24.9 en una muestra de tamaño 170".

- El evento asociado al rango SOBREPESO (25 a 29.9) sería: "Seleccionar a un estudiante que tenga un IMC en el rango de 25 a 29.9 en una muestra de tamaño 170".

- El evento asociado al rango OBESIDAD (30 a más) sería: "Seleccionar a un estudiante que tenga un IMC en el rango de 30 a más en una muestra de tamaño 170".


**Cálculo de la función probabilidad de los eventos atómicos**

$$P(E) = n(E)/ n(S) $$

Probabilidad de que el valor del IMC se encuentre en el rango de BAJO (menos de 18.5): 

```{r  echo=FALSE, message=TRUE, warning=FALSE}
6/170
```

Probabilidad de que el valor del IMC se encuentre en el rango de NORMAL (18.5 a 24.9): 

```{r echo=FALSE, message=TRUE, warning=FALSE}
114/170
```


Probabilidad de que el valor del IMC se encuentre en el rango de SOBREPESO (25 a 29.9):
```{r echo=FALSE, message=TRUE, warning=FALSE}
46/170
```


Probabilidad de que el valor del IMC se encuentre en el rango de OBESIDAD (30 a más):
```{r echo=FALSE, message=TRUE, warning=FALSE}
4/170
```



Estas probabilidades halladas representan la proporción de registros en la base de datos que corresponden a cada rango específico de la variable "IMC".


### Variable: Actividad física - Género

**Tamaño de la muestra**

```{r echo=FALSE, message=TRUE, warning=FALSE}
Tamaño_muestra <- length(DF1$Actividad_Física)
print(Tamaño_muestra)
```

```{r echo=FALSE, message=TRUE, warning=FALSE}
fi1=(table(cut(DF1$Actividad_Física, breaks = c(0, 3, 6, 9, 12, 15), include.lowest = TRUE, right = FALSE), DF1$Gènero))
pi3=prop.table(fi1)
round(cbind(fi1,pi3),5)
```


**Definiendo los eventos atómicos**

 - Evento A: Probabilidad de seleccionar a un estudiante de género masculino que realice actividad física   en un rango mayor o igual a **0** y menor a **3** horas en una muestra de tamaño 170.
 - Evento B: Probabilidad de seleccionar a un estudiante de género femenino que realice actividad física en  un rango mayor o igual a **3** y menor a **6** horas en una muestra de tamaño 170.
 - Evento C: Probabilidad de seleccionar a un estudiante de género masculino  que realice actividad física  en un rango mayor o igual a **6** y menor a **9** horas en una muestra de tamaño 170.
 - Evento D: Probabilidad de seleccionar a un estudiante de género femenino que realice actividad física en  un rango mayor o igual a **9** y menor a **12** horas en una muestra de tamaño 170.
 - Evento E: Probabilidad de seleccionar a un estudiante de género masculino o femenino que realice actividad física en un rango mayor o igual a **12** y menor igual a **15** horas en una muestra de tamaño 170.

Proababilidad del evento A:
```{r warning=FALSE, echo=FALSE, message=TRUE}
Evento_A1 <- sum((DF1$Actividad_Física >= 0 & DF1$Actividad_Física < 3) & DF1$Gènero == "Masculino")
print(paste("Probabilidad:",round((Evento_A1/Tamaño_muestra), 5)))
```


Probabilidad del evento B:
```{r  echo=FALSE, message=TRUE, warning=FALSE}
Evento_A1 <- sum((DF1$Actividad_Física >= 3 & DF1$Actividad_Física < 6) & DF1$Gènero == "Femenino")
print(paste("Probabilidad:",round((Evento_A1/Tamaño_muestra ), 5)))
```

Probabilidad del evento C:

```{r  echo=FALSE, message=TRUE, warning=FALSE}
Evento_A1 <- sum((DF1$Actividad_Física >= 6 & DF1$Actividad_Física < 9)& DF1$Gènero == "Masculino")
print(paste("Probabilidad:",round((Evento_A1/Tamaño_muestra), 5)))
```

Probabilidad del evento D:
```{r  echo=FALSE, message=TRUE, warning=FALSE}
Evento_A1 <- sum((DF1$Actividad_Física >= 9 & DF1$Actividad_Física < 12)& DF1$Gènero == "Masculino")
print(paste("Probabilidad:",round((Evento_A1/Tamaño_muestra), 5)))
```


Probabilidad del evento E:
```{r  echo=FALSE, message=TRUE, warning=FALSE}
Evento_A1 <- sum(DF1$Actividad_Física >= 12 & DF1$Actividad_Física <= 15)
print(paste("Probabilidad:",round((Evento_A1/Tamaño_muestra), 5)))

```

## Probabilidades condicionales

### Evento dependiente

Utilizaremos las variables IMC y Promedio para crear eventos de interés para afirmar nuestros objetivos

```{r  echo=FALSE, message=TRUE, warning=FALSE}
tabla_cruzada <- round(prop.table(table(cut(DF1$IMC, breaks = c(0,18.5,25,30, 40), labels = c("Bajo[0,18.5)", "Normal[18.5,25)", "Sobrepeso[25,30)", "Obesidad[30,40]"), include.lowest = TRUE, right = FALSE), cut(DF1$Promedio, breaks = c(0,10,14,17,20), labels = c("Deficiente [0,10)", "Regular [10,14)", "Bueno [14,17)", "Excelente [17,20] "), include.lowest = TRUE, right = FALSE))), 5)



palabra <- "IMC - Promedio"
print(sprintf("%*s", nchar(palabra) + ((110 - nchar(palabra)) / 2), palabra))
print(tabla_cruzada)
```


- Evento A : Seleccionar un estudiante cuyo promedio  sea (>= 14)

- Evento B : Seleccionar un estudiante cuyo IMC saludable según la OMS (>= 18.5 y <= 24.9)


Entonces la probabilidad de éxito en nuestro evento A es :

```{r  echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad del evento A")
Evento_A<-sum(DF1$Promedio >= 14)
total_eventos <- length(DF1$Promedio)
P_eventoA <- round(Evento_A/total_eventos , 5)
P_eventoA
```
$$P(A)=0.81176$$

Y el complemento del evento A sería:

```{r  echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad de A' ")
P_complementoA = 1 - P_eventoA
P_complementoA
```
$$P(A')=0.18824$$


A continuación hallaremos la probabilidad del evento B

```{r  echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad del evento B")  #>= 18.5 y <= 24.9
Evento_B<-sum(DF1$IMC >= 18.5 & DF1$IMC <=25)
total_eventos <- length(DF1$IMC)
P_eventoB <- round(Evento_B/total_eventos , 5)
P_eventoB

```
$$ P(B)=0.68235$$

Y el complemento del evento B  sería:

```{r echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad de B' ")
P_complementoB = 1 - P_eventoB
P_complementoB
```
$$P(B')=0.31765$$

Entonces hallaremos P(A ∩ B)

```{r echo=FALSE, message=FALSE, warning=FALSE}
evento_A_interseccion_B <- sum(DF1$Promedio >= 14 & DF1$IMC >= 18.5 & DF1$IMC < 25)
total_eventos <- nrow(DF1)
P_evento_A_interseccion_B <- round((evento_A_interseccion_B/total_eventos), 5)
P_evento_A_interseccion_B
```
$$ P(A ∩ B)=0.55294$$
P(A)*P(B)
```{r  echo=FALSE, message=FALSE, warning=FALSE}
round(P_eventoA*P_eventoB, 5)
```
$$P(A)*P(B)=0.55390$$

Verificamos si cumple lo siguiente: 

$$P(A ∩ B) ≠ P(A)*P(B)$$

Por lo tanto:
$$0.55294 ≠ 0.55390$$

Observamos que las probabilidades tanto de P(A ∩ B) y P(A)*P(B son diferentes, por lo que decimos que sí se verificó que son eventos dependientes.

**Teorema de Bayes:**

La probabilidad de seleccionar un estudiante cuya nota sea (>= 14) es:

```{r echo=FALSE, message=FALSE, warning=FALSE}
P_eventoA #P(A)
```
$$P(A) = 0.81176$$

La probabilidad de seleccionar un estudiante que tenga un promedio (>= 14) y su IMC se encuentra entre los rangos de (>= 18.5 y <= 24.9)

```{r echo=FALSE, message=FALSE, warning=FALSE}
(P_evento_B_si_evento_A <- round(P_evento_A_interseccion_B/P_eventoA, 5)) #P(A|B)
```

$$P(A|B) = P(A ∩ B)/P(B)$$ 
$$P(A|B) = 0.66667$$ 
 La probabilidad de seleccionar un estudiante que tengo un promedio mayor igual a 14 y su IMC es "no" está dentro del rango de (>= 18.5 y <= 24.9)
 
```{r echo=FALSE, message=FALSE, warning=FALSE}
(P_evento_A_si_evento_B <- round(P_evento_A_interseccion_B/P_eventoB, 5)) #P(B|A)
```

$$P(B|A) = P(B ∩ A)/P(A)$$  
$$P(B|A) = 0.79311$$ 
La probabilidad de seleccionar un estudiante que tengo un promedio mayor a 15:

```{r echo=FALSE, message=FALSE, warning=FALSE}
round(P_eventoB,5) #P(B) 
round((Probabilidad_B <- 0.81176*0.66667/0.79311),5) #P(B)
```

$$P(A|B) = P(B|A)*P(A) / P(B)$$
$$P(B) = P(B|A)*P(A) / P(A|B)$$
$$P(B) = 0.79311*0.81176 / 0.66667$$
$$P(B) = 0.4663$$
```{r echo=FALSE, message=FALSE, warning=FALSE}
0.79311 *0.81176/0.66667
```



### **Evento independientes**

Utilizaremos las variables Promedio y horas de actividad física 

- Evento A : Seleccionar un estudiante cuyo promedio sea (>= 17)

- Evento B : Seleccionar un estudiante que realiza horas de actividad  (>= 6 y <= 9)


```{r echo=FALSE, message=TRUE, warning=FALSE}
tabla_cruzada <- round(prop.table(table(cut(DF1$Promedio, breaks = c(0,10,14,17,20), labels = c("Deficiente [0,10)", "Regular [10,14)", "Bueno [14,17)", "Excelente [17,20] "), include.lowest = TRUE, right = FALSE), cut(DF1$Actividad_Física, breaks = c(0, 3, 6, 9, 12, 15), include.lowest = TRUE, right = FALSE))), 5)

palabra <- "Promedio - Actividad Física"
print(sprintf("%*s", nchar(palabra) + ((110 - nchar(palabra)) / 2), palabra))
print(tabla_cruzada)
```

 - Evento A: Evento A: Probabilidad de que un alumno tenga un promedio entre un rango mayor o igual a 10 y  menor a 14
 - Evento B: Probabilidad de que un alumno realice actividad física entre un rango mayor o igual a 3 y      menor a 6 horas

```{r echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad del evento A")
Evento_A<-sum(DF1$Promedio >= 10 & DF1$Promedio < 14)
total_eventos <- length(DF1$Promedio)
P_eventoA <- round(Evento_A/total_eventos , 5)
P_eventoA
```
$$P(A)=0.18824$$

A continuación hallaremos la probabilidad del evento B

```{r echo=FALSE, message=FALSE, warning=FALSE}
print("Probabilidad del evento B")  
Evento_B<-sum(DF1$Actividad_Física>= 3 & DF1$Actividad_Física < 6)
total_eventos <- length(DF1$IMC)
P_eventoB <- round(Evento_B/total_eventos , 5)
P_eventoB

```
$$ P(B)=0.25882$$

Entonces hallaremos P(A ∩ B)

Probabilidad de que un alumno tenga un promedio entre un rango mayor o igual a 10 y menor a 14 además que realice  actividad física entre un rango mayor o igual a 3 y menor a 6 horas

```{r echo=FALSE, message=FALSE, warning=FALSE}
evento_A_interseccion_B <- sum((DF1$Promedio >= 10  & DF1$Promedio < 14) & (DF1$Actividad_Física >= 3 & DF1$Actividad_Física < 6))
total_eventos <- nrow(DF1)
P_evento_A_interseccion_B <- round((evento_A_interseccion_B/total_eventos), 5)
P_evento_A_interseccion_B
```

$$ P(A ∩ B)=0.04118$$
P(A)*P(B)
```{r echo=FALSE, message=FALSE, warning=FALSE}
round(P_eventoA*P_eventoB, 5)
```
$$P(A)*P(B)=0.04872$$
Para que el evento sea independiente tiene que cumplir las siguientes 3 condiciones:

**Condición 1:**
$$P(A ∩ B) = P(A)*P(B)$$
**Condición 2:**
$$P(A/B) =  P(A)$$
**Condición 3**
$$P(B/A) =  P(B)$$

Verificamos la primera condición

$$P(A ∩ B) = P(A)*P(B)$$

$$ 0.04118=0.18824*0.25882$$
 
$$P(A ∩ B)  ≠  P(A)*P(B)$$
Observando el resultado notamos que no cumple con la primera condicón

*Verificamos la segunda condición*


```{r echo=FALSE, message=TRUE, warning=FALSE}
# Probabilidad de A dado B
print("Probabilidad de A dado B")
P_A_dado_B <- round(P_evento_A_interseccion_B / P_eventoB, 5)
P_A_dado_B

```

$$0.15911 = 0.18824$$
Por lo tanto:
$$P(A/B) ≠ P(A)$$
Observando el resultado notamos que no cumple con la segunda condición

*Verificamos la tercera condición*

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Probabilidad de A dado B
print("Probabilidad de A dado B")
P_B_dado_A <- round(P_evento_A_interseccion_B / P_eventoA, 5)
P_B_dado_A

```


$$0.21876 = 0.25882$$
Por lo tanto:

$$P(B/A) ≠ P(B)$$
Observando el resultado notamos que no cumple con la tercera condición


*Conclusión*

Del anterior análisis podemos concluir que las variables de nuestro estudio no son eventos independientes por lo tanto no podemos obtener probabilidades de eventos independientes.



## **DISTRIBUCIÓN PROBABILÍSTICA DISCRETA**

### **Variable Mayor_consumo**

Analizaremos la variable Mayor_consumo(Variable categórica nominal), y definiremos un modelo probabilistico discreto binomial, para ello crearemos una tabla de frecuencia y definiremos nuestra variable aleatoria discreta.

```{r echo=FALSE, message=TRUE, warning=FALSE}
fi=table(DF1$Mayor_Consumo)
pi=round(prop.table(fi)*100,2)
cbind(fi,pi)
```

```{r echo=FALSE, message=TRUE, warning=FALSE}
fi=table(DF1$Mayor_Consumo)
pi=round(prop.table(fi),4)
cbind(fi,pi)
```
En donde nuestro éxito será los estudiantes que consumen en mayor medida grasas, y nuestro fracaso el resto de casos, es por ello que guiándonos de la tabla:

**P(éxito):0.0690**
**P(fracaso):0.931**

Definiendo nuestros parámetros donde X es nuestra variable aleatoria:

**R~x~:{Carbohidratos, Frutas y verduras, Grasas, Productos lácteos, Proteínas}**

**X: **Número de personas que consumen en mayor medida Grasas

**n: **Número de estudiantes elegidas al azar

Gráfico de densidad:


```{r echo=FALSE, message=TRUE, warning=FALSE}
n<-170
p<-0.0690
q<-09310
probabilidad <- dbinom(0:170, size = 10, prob = 0.0690)
x<- 0:170
# Graficar la función de densidad
plot(x, probabilidad, type = "h", lwd = 2, col = "blue",
     xlab = "Número de éxitos", ylab = "Densidad de probabilidad",
     main = "Función de Densidad Binomial")
```



```{r echo=FALSE, message=TRUE, warning=FALSE}
a<-table(DF$mayor_consumo)
barplot(a)
```
Calculamos la varianza, esperanza y coeficiente de variación:
$$E(x)=n*P$$
$$V(x)=n*p*q$$
$$CV(x)=sqrt(V(x))$$
```{r echo=FALSE, message=TRUE, warning=FALSE}
E= 170 * 0.0690
V=170*0.0690*0.9310
```

**Ejemplo con el modelo probabilistico**

Los nutriologos recomiendan una alimentación balanceada según la pirámide alimenticia, recomiendan que se consuma más vitaminas y carbohidratos en estudiantes pues ayuda a la concentración y fatiga, y recomiendan que se deben de consumir grasas en pocas cantidades.¿ Cuál es la probabilidad de que de 170 estudiantes encuestados, por lo menos 20 no sigan esta recomendación?

```{r  echo=FALSE, message=TRUE, warning=FALSE}
print("Probabilidad hallada")
dbinom(20,170,0.069,F)

```

Al ser la probabilidad baja(0.006873816), podemos concluir de que los estudiantes de UTEC tienen un hábito alimenticio saludable referente en el tipo de alimento que consumen.


### variable Comidas_Rápidas


**Definir distribución a usar**

Se ha elegido la variable de tipo numérica discreta

X: número de veces que un estudiante de UTEC consume comidas rápidas a la semana.

```{r  echo=FALSE, message=TRUE, warning=FALSE}
fi=table(DF1$Comidas_Rápidas)
pi=round(prop.table(fi)*100,2)
cbind(fi,pi)
```

Donde:
X: número de veces que un estudiante de UTEC consume comidas rápidas a la semana
Rx=[0,1,2,3,4,5]

**Función de probabilidad de X**

```{r  echo=FALSE, message=TRUE, warning=FALSE}
fi=table(DF1$Comidas_Rápidas)
pi=prop.table(fi)
pi
```

```{r echo=FALSE, message=TRUE, warning=FALSE}
plot(table(DF1$Comidas_Rápidas), 
las = 2, ylim = c(0, 80), col = 2:7, main = "Gráfico 6 
     Consumo de comidas rápidas", xlab = " Cantidad de consumo de comidas rápidas(semana)", ylab = " Frecuencia ")
```



Observando la gráfica, se sospecha de que se esta frente a una
*distribución Poisson*

$$
X ∼ P(λ)
$$


X : Numero de ocurrencias en un intervalo de longitud especificada
λ = Cantidad promedio de ocurrencias por unidad especificada, λ > 0



$$ E(X) = λ$$
$$Var(X) = λ$$
**Construir Variable Aleatoria: **

X: número de veces que un estudiante de UTEC consume comidas rápidas a la semana
Rx=[0,1,2,3,4,5]


**Identificar  parámetros y validar propiedades** 


Para ello verificaremos el valor esperado y la varianza de nuestra variable X

*Valor Esperado= Esperanza matemática = Promedio* 


$$E\left(X\right)=\sum X\cdot P\left(X\right)$$

```{r  echo=FALSE, message=TRUE, warning=FALSE}
X=c(0:5)
P=c(0.02352941,0.40588235,0.30000000,0.15882353,0.07058824,0.04117647 )
(E=sum(X*P))
```

*Varianza*

$$V\left(X\right)=E\left(X^2\right)-E\left(X\right)^2$$


donde:

$$E\left(X^2\right)=\sum X^2\cdot P\left(X\right)$$


```{r  echo=FALSE, message=TRUE, warning=FALSE}
(V=sum(X^2*P)-E^2)
```

Teóricamente el valor esperado debería coincidir con el valor de la
varianza, es decir Lambda (λ). Pero como se observa, ambos valores son
diferentes, pero se aproximan.


$$1.970588 ≈ 1.3109$$

**Verificar gráficamente **

```{r  echo=FALSE, message=TRUE, warning=FALSE}
shadeDist(5, "dpois", 1.970588)
```


Con la gráfica anterior podemos asumir que si se asemeja a una distribución Poisson, por lo que para efectos de aplicación en el estudio, consideraremos a X como una Poisson.

**Representación Gráfica-Modelo Poisson**

```{r  echo=FALSE, message=TRUE, warning=FALSE}
o2<-mean(DF1$Comidas_Rápidas)
x=c(0:10)
lambda <-o2
plot(dpois(x, lambda), type = "h", lwd = 5,
     main = "Función de masa de probabilidad", 
     ylab = "P(X = x)", xlab = " Número de veces que un estudiante de UTEC consume comidas rápidas a la semana")
```


Por lo que con la información anteriormente hallada:

**Parámetros de la Distribución Poisson**

X: número de veces que un estudiante de UTEC consume comidas rápidas a la semana

X ∼ P(λ)

Asumimos para fines prácticos que: 

• E(X) = λ = 1.970588

• Var(X) = λ = 1.970588


**Plantear ejercicios**


En base a lo hallado, se supone que el número de veces que un estudiante de UTEC consume comidas rápidas a la semana sigue una distribución Poisson con un promedio de 1.970588. 


Entonces teniendo en consideración esto nuestro modelo se puede representar como 
$$X ∼ P(1.970588)$$


1. Determine la probabilidad de que  un estudiante de UTEC consuma comida rápida exactamente 3 veces a la semana
P (X = 3) 

```{r  echo=FALSE, message=TRUE, warning=FALSE}
dpois(3,1.970588 )
```


La probabilidad de que un estudiante de UTEC consuma comida rápida 3 veces a la semana es 0.1777546


Análisis: Esto significa que aproximadamente el 17.78% los 170 alumnos de UTEC encuestados tienen una probabilidad de consumir comida rápida exactamente 3 veces a la semana, según el modelo de distribución de Poisson utilizado.

2. Determine la probabilidad de que un estudiante de UTEC consuma comida rápida más de 4 veces a la semana

P (X > 4) 

```{r  echo=FALSE, message=TRUE, warning=FALSE}
1 - ppois(4, 1.970588)
```
La probabilidad de que un estudiante de UTEC consuma comida rápida más de 4 veces a la semana es 0.05003838

Análisis: Esto significa que aproximadamente el 5.00% de los 170 alumnos de UTEC encuestados tienen una probabilidad de consumir comida rápida más de 4 veces a la semana, según el modelo de distribución de Poisson utilizado.



3. Determine la probabilidad de que la cantidad de veces que un estudiante de UTEC consume comida rápida a la semana se encuentre en un rango desde 2 a 4 veces
P(2 ≤ X ≤ 4)


```{r  echo=FALSE, message=TRUE, warning=FALSE}
ppois(4, 1.970588) - ppois(1, 1.970588)
```
La probabilidad de que la cantidad de veces que un estudiante de UTEC consuma comida rápida a la semana se encuentre en un rango desde 2 a 4 veces es de
0.5359363 

Análisis: Esto significa que aproximadamente el 53.59% de los 170 alumnos de UTEC encuestados tienen una probabilidad de consumir comida rápida entre 2 y 4 veces a la semana, según el modelo de distribución de Poisson utilizado.


### **Variable Alimentación_universitaria**

1.La distribución binomial se eligió para modelar la variable "Alimento Universitario" debido a que se trata de una variable binaria que puede tomar dos posibles respuestas: "Sí" o "No". Utilizando esta distribución, podemos calcular la probabilidad de que los estudiantes consideren tener acceso a alimentos saludables en el campus universitario. Esta elección nos permite obtener estimaciones de la proporción de estudiantes con acceso a alimentos saludables y comprender mejor su percepción en relación con los alimentos disponibles en el campus.


la variable n se considera la cantidad total de muestras
```{r  echo=FALSE, message=TRUE, warning=FALSE}
n <- nrow(DF1[!is.na(DF1$Alimento_Universitario), ])
print(n)
```
Contamos el número de estudiantes que respondieron "Sí" y "No" en relación al acceso a alimentos saludables en el campus universitario, utlilizamos la función table() .

```{r  echo=FALSE, message=TRUE, warning=FALSE}
tabla_respuestas <- table(DF1$Alimento_Universitario)

#Sí y No
cat("Número de estudiantes que dijeron Sí:", tabla_respuestas["Sí"], "\n")
cat("Número de estudiantes que dijeron No:", tabla_respuestas["No"], "\n")

```

Consideramos como éxito a los estudiantes que Sí consideran que tienen opciones de alimentos saludables dentro del campus.
Hallamos la probabilidad de que eligan Sí
```{r  echo=FALSE, message=TRUE, warning=FALSE}
frecuencia_si <- sum(DF1$Alimento_Universitario == "Sí")
total_estudiantes <- nrow(DF1)

probabilidad_si <- frecuencia_si / total_estudiantes

cat("Probabilidad de que elijan Sí:", probabilidad_si, "\n")

```
2.#Caso:
X: numero de estudiantes que eligieron sí en el conjunto de los 170 encuestados de los estudiantes de la UTEC.

```{r  echo=FALSE, message=TRUE, warning=FALSE}
library(ggplot2)
ggplot(DF1, aes(x=Alimento_Universitario)) + 
    geom_bar() +
    xlab("Acceso a Alimentos Saludables (Sí/No)") +
    ylab("Cantidad de Estudiantes") +
    ggtitle("Acceso a Alimentos Saludables en Campus Universitario")

```

3. Identificamos los parámetros
```{r  echo=FALSE, message=TRUE, warning=FALSE}
p <- sum(DF1$Alimento_Universitario == "Sí") / nrow(DF1)
cat("Probabilidad de éxito (p):", p, "\n")

n <- nrow(DF1)
cat("Tamaño de la muestra (n):", n, "\n")

```
4. Hacemos la gráfica de la función densidad
```{r  echo=FALSE, message=TRUE, warning=FALSE}
p <- 0.5764706 
n <- 170

k <- 0:n  # Valores de k desde 0 hasta n
densidad <- dbinom(k, size = n, prob = p)

plot(k, densidad, type = "h", lwd = 2, col = "blue", 
     xlab = "Número de éxitos (k)", ylab = "Densidad",
     main = "Función de Densidad Binomial")


```
Interpretación del gráfico:

La variable "Alimentación_universitaria" se modela como una distribución binomial con una probabilidad de éxito de 0.5632184 y un tamaño de muestra de 174 estudiantes.

Al interpretar el gráfico de la función de densidad binomial, podemos observar lo siguiente en relación a la variable "Alimentación_universitaria":
La altura de cada barra en el gráfico representa la probabilidad relativa de obtener un número específico de éxitos, es decir, la probabilidad de que un estudiante elija "Sí" en relación al acceso a alimentos saludables en el campus universitario.
El número de éxitos más probable se encuentra en el valor de "k" donde la densidad es máxima. Este valor corresponde al número más probable de estudiantes que consideran tener acceso a alimentos saludables.
A medida que nos alejamos del valor más probable, la probabilidad de obtener ese número de éxitos disminuye gradualmente. Esto indica que la probabilidad de que un número menor o mayor de estudiantes elijan "Sí" en relación al acceso a alimentos saludables en el campus universitario disminuye a medida que nos alejamos del valor más probable.
El gráfico proporciona una representación visual de cómo se distribuye la probabilidad en la variable "Alimentación_universitaria" según la distribución binomial. 

5. Validamos las propiedades
```{r  echo=FALSE, message=TRUE, warning=FALSE}
p <- 0.5764706 
n <- 170

esperanza <- n * p
cat("Esperanza (media):", esperanza, "\n")

varianza <- n * p * (1 - p)
cat("Varianza:", varianza, "\n")

coeficiente_variacion <- sqrt(varianza) / esperanza
cat("Coeficiente de Variación:", coeficiente_variacion, "\n")

```
6.Cuál es la probabilidad de que más del 50% de los estudiantes consideren de que "No" hay opciones de alimentos saludables dentro del campus.

```{r  echo=FALSE, message=TRUE, warning=FALSE}
p <- 0.5764706 
n <- 170
porcentaje_limite <- 0.5

probabilidad <- 1 - pbinom(floor(n * porcentaje_limite), size = n, prob = p)
cat("Probabilidad de que más del 50% de los estudiantes elijan No:", probabilidad, "\n")

```



## **Distribución continua**


### **Variable IMC**

Determinar la variable aleatoria continua:

```{r  echo=FALSE, message=TRUE, warning=FALSE}
fit.cont(DF1$IMC)
```
**Definir la hipótesis nula y alterna**
H0: Hipótesis Nula
H1: Hipótesis Alterna

H0: La distribución del IMC de los estudiantes de UTEC se aproxima a una distribución Normal
H1: La distribución del IMC de los estudiantes de UTEC es diferente a una distribución Normal

-Valor de P_value obtenida mediante kolmogorov-smirnov
$$Pvalue=0.09 $$
-Nivel de significancia
$$α=0.05$$
Se observa que P_value es mayor al nivel de significancia

$$0.09>0.05$$
$$Pvalue>α$$
Por lo tanto, mediante la regla general de la hipótesis concluimos lo siguiente:

-Regla general
$$Pvalue<α   --> RH0$$
$$Pvalue>=α   --> NRH0$$
De ello se concluye que la variable IMC se asemeja a una distribución Normal

X: IMC de estudiantes de los estudiantes de UTEC en kg/m^2
X~N(23.103412, 3.187812^2)

-Valor esperado según el rriskDistributions
$$E(X)=23.103412$$

-Desviación estándar según el rriskDistributions
$$sd(X)=3.187812$$
```{r,echo=FALSE}
densidad <- density(DF1$IMC)
plot(densidad, xlab = "IMC", ylab = "Densidad Estimada", main = "Gráfico 6
     Cuadro de densidad estimada de IMC",col = "black", lwd = 5)

x <- densidad$x
y <- densidad$y
polygon(x, y, col = "cyan")
```

**Validar la distribución Normal**

```{r  echo=FALSE, message=TRUE, warning=FALSE}
mean(DF1$IMC)
var(DF1$IMC)
sd(DF1$IMC)
```

-Valor esperado obtenido de la base de datos con el comado mean
$$E(X)=23.10341$$

-Desviación estándar obtenido la base de datos concon el comado sd

$$sd(X)=3.197229$$ 

Se observa que la media obtenida por el gráfico y por el cálculo de comando son aproximadamente semejantes. Mientras que la desviación estádar obtenida en ambos casos tienen una diferencia mínima, por lo que concluimos que la variable IMC se asemja a una distribución Normal.

-Media 
$$23.103412≈23.10341$$
-Desviación estándar 
$$3.187812≈3.197229$$

**Distribución Normal** 
$$µ=23.103412$$ 
$$σ^2=3.187812^2$$
$$X ∼ N(µ, σ^2)$$ 

$$X ∼  N(23.103412, 3.187812^2)$$

*Planteamiento de ejercicios*

Se realizó un estudio en la Universidad Tecnológica de UTEC, donde se recopilaron datos sobre el peso y talla que tiene un estudiante, luego de ello se calculó su IMC(Indice de Masa Corporal). Se encontró que el IMC sigue una distribución de Normal con parámetros µ = 23.103412 y σ= 3.187812

Determinar la probabilidad de que un estudiante tenga como mínimo un IMC (kg/m^2) de 25.

P(X>=25)

```{r}
1-pnorm(25, 23.103412, 3.187812)
```

```{r}
shadeDist(25, "dnorm", 23.103412, 3.187812, lower.tail=F)
```

Determinar que tan probable un estudiante tenga un IMC entre 18.5 y 30(kg/m^2

```{r}
pnorm(30, 23.103412, 3.187812) - pnorm(18.5, 23.103412, 3.187812)
```
```{r}
shadeDist(c(18.5,30) , "dnorm", 23.103412, 3.187812, lower.tail=F)
```
Determinar la probabilidad de que un estudiante tenga un IMC (kg/m^2) menor a 18.5.

P(X<18.5)

```{r}
pnorm(18.5, 23.103412, 3.187812)
```

```{r}
shadeDist(18.5, "dnorm", 23.103412, 3.187812, lower.tail=T)
```

Determinar el IMC en (kg/m^2) cuando se tenga un percentil 65

```{r}
qnorm(0.65, 23.103412, 3.187812)
```

### **Variable Promedio**


**Definición de variable:**

x: Promedio ponderado en el ciclo 2022-2 de los estudiantes de UTEC Barranco-Lima-Perú.


```{r  echo=FALSE, message=TRUE, warning=FALSE}
fit.cont(DF1$Promedio)
```

**Hipótesis**
H0: La distribución el promedio de los estudiantes de UTEC se aproxima a una distribución Gamma
H1: La distribución el promedio de los estudiantes de UTEC es diferente a una distribución Gamma

-Valor de P_value obtenida mediante kolmogorov-smirnov
$$Pvalue=0.10 $$
-Nivel de significancia
$$α=0.05$$
Se observa que P_value es mayor al nivel de significancia

$$0.10>0.05$$
$$Pvalue>α$$
Por lo tanto, mediante la regla general de la hipótesis concluimos lo siguiente:

-Regla general
$$Pvalue<α   --> RH0$$
$$Pvalue>=α   --> NRH0$$
De ello se concluye que la variable Promdio se asemeja a una distribución Gamma
**Sustentación de la elección de la distribución (Gamma)**

Se escogió la distribución Gamma para la variable promedio debido a que la densidad bajo la función de color rojo ocupaba una mayor área en la distribución Gamma que en los otros tipos de distribuciones.


Validación de parámetros:

```{r  echo=FALSE, message=TRUE, warning=FALSE}
media <- mean(DF1$Promedio)
varianza <- var(DF1$Promedio)
```

- Forma (shape o alpha): Representa el parámetro de forma de la distribución gamma. Controla la forma de la distribución y debe ser un número real positivo.

- Tasa (rate o beta): Representa el parámetro de tasa de la distribución gamma. Controla la tasa de ocurrencia de los eventos y también debe ser un número real positivo.

Para verificar los parámetros shape y rate de la distribución Gamma podemos ayudarnos de la media y la varianza de nuestra variable y validar que se cumplan las siguientes formulas->

$$Shape\:=\:\frac{media^2}{varianza}$$
$$Rate\:=\:\frac{media}{varianza}$$
comprobamos valor de Shape-> 

```{r  echo=FALSE, message=TRUE, warning=FALSE}
print(paste("Shape calculado ->",(media^2)/varianza))
```
Podemos notar que Shape nos da aproximadamente el mismo valor que en la gráfica de la distribución Gamma

$$64.17983983\:\approx \:63.514406$$
comprobamos valor de Rate-> 

```{r  echo=FALSE, message=TRUE, warning=FALSE}
print(paste("Rate calculado ->",media/varianza))
```
Podemos notar que Rate nos da aproximadamente el mismo valor que en la gráfica de la distribución Gamma

$$4.18149766\:\approx \:4.138217$$

Una vez comprobado los parámetros (Sahe y Rate) de la gráfica Gamma podemos afirmar que es correcto usar este tipo de distribución para nuestro análisis de variable aleatoria continua.

**Planteamiento de casos de la V.A.C. ->**

Caso 1: Determinar que tan probable es que un estudiante de UTEC tenga como mínimo un promedio ponderado igual a 15 en el ciclo 2022-2.

```{r  echo=FALSE, message=TRUE, warning=FALSE}
probabilidad = (1 - pgamma(15,63.514406,4.138217))
print(paste("La probabilidad es ->", probabilidad))
```

Caso 2: Determinar que tan probable es que un estudiante de UTEC tenga como máximo un promedio ponderado igual a 15 en el ciclo 2022-2.

```{r  echo=FALSE, message=TRUE, warning=FALSE}
probabilidad =pgamma(15,63.514406,4.138217)
print(paste("La probabilidad es ->", probabilidad))
```
Notar:
```{r  echo=FALSE, message=FALSE, warning=FALSE}
0.444212903183386+0.555787096816615
```
$$0.444212903183386+0.555787096816615=1$$
Caso 3: Determinar que tan probable es que un estudiante de UTEC tenga como maximo un promedio ponderado igual a 17 en el ciclo 2022-2.

```{r echo=FALSE, message=TRUE, warning=FALSE}
probabilidad =pgamma(17,63.514406,4.138217)
print(paste("La probabilidad es ->", probabilidad))
```




# Bibliografía

Viva mi salud.(6 octubre, 2020). *6 alimentos para mejorar la memoria y el aprendizaje*. Recuperado de: https://www.vivamisalud.com/alimentos-memoria-aprendizaje/

Rojas, G. (2022, abril 18). *Consejos para alimentarse correctamente en la etapa universitaria. Universidad Científica del Sur*. Recuperado de: https://100.cientifica.edu.pe/consejos-para-alimentarse-correctamente-en-la-etapa-universitaria/

Centers for Disease Control and Prevention. (2021, 30 agosto).*Cómo evaluar su peso*.  https://www.cdc.gov/healthyweight/spanish/assessing/index.html#:~:text=Si%20su%20IMC%20es%20entre,dentro%20del%20rango%20de%20obesidad

Ibarra Mora, J., Hernández Mosqueira, C. M., & Ventura-Vall-Llovera, C. (2019). *Hábitos alimentarios y rendimiento académico en escolares adolescentes de Chile*. Revista española de nutrición humana y dietética, 23(4), 292–301. Recuperado de: https://doi.org/10.14306/renhyd.23.4.804 

Centro medico en valencia.(2022, marzo 16).*Cómo influye la alimentación en el rendimiento académico*  https://centromedicomedcare.com/blog/como-influye-la-alimentacion-en-el-rendimiento-academico/


https://www.gob.pe/14806-calcular-indice-de-masa-corporal-imc-en-adultos


















