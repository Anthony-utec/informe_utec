---
title: " Gestión del presupuesto semanal de los estudiantes UTEC del ciclo 2023-1 "
subtitle: " Análisis de gasto, ahorro y presupuesto semanal"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
    html_document:
      anchor_sections: TRUE
      number_sections: TRUE
      code_folding: show
      theme: journal
      toc: yes
      toc_depth: 4
      toc_float: yes
editor_options: 
  markdown: 
    wrap: 72
---

# Introduccion

## Contexto

El ahorro es una necesidad en la planificación financiera de todos los
individuos y los hogares. También es relevante para los estudiantes
universitarios para tener recursos que les permitan atender necesidades
asociadas con la educación, como son textos escolares, materiales,
transporte y alimentación y tener recursos para la diversión y el
entretenimiento.En particular la conducta económica de los estudiantes
universitarios está determinada por el ingreso que perciben, el cual se
espera que provenga principalmente de sus padres y familiares dado que
la universidad es de carácter privado. Esto podría explicar los hábitos
de administración financiera, la importancia que le dan los alumnos a
sus gastos, así como los hábitos del ahorro.(Reus, Arroyare & Bedoya,
2007)


## Relevancia

La gestión del presupuesto personal es fundamental para la estabilidad
financiera y decisiones acertadas sobre gastos y ahorros de los
estudiantes de la UTEC. Evaluar la gestión de su presupuesto semanal
permitirá identificar áreas de mejora y brindarles herramientas para
desarrollar hábitos financieros, que serán útiles en su carrera y vida
profesional. En la UTEC, es común que los estudiantes realicen proyectos
grupales con presupuestos limitados, esto simula situaciones reales que
enfrentarán en su vida laboral. Una formación económica temprana, evita
dificultades para gestionar recursos asignados en proyectos más grandes.
Una buena gestión del presupuesto personal implica equilibrar ingresos,
gastos, establecer prioridades y ahorrar. Estas habilidades son
transferibles a proyectos grupales, donde decisiones financieras
acertadas marcan la diferencia. En conclusión, evaluar la gestión del
presupuesto semanal de los estudiantes de la UTEC es relevante con su
formación y carrera. Desarrollar hábitos financieros tempranos
beneficiará su bienestar económico, personal y los prepara para
enfrentar proyectos grupales en ciclos superiores y vida laboral. La
eficiente gestión de recursos es clave para el éxito.

## Objetivos:

> Objetivo general: Evaluar el conocimiento y la aplicación de la
> gestión financiera en los estudiantes matriculados en la UTEC durante
> el ciclo 2023-1.

Como *objetivos específicos* del presente proyecto, se tienen los
siguientes: 

-   Determinar si los estudiantes matriculados en la UTEC durante el ciclo 2023-1 tienen conocimientos sobre Gestión financiera.

-   Evaluar si se están aplicando los conocimientos de gestión financiera a través del análisis de la cantidad típica de gastos semanales.

-   Analizar el presupuesto semanal de los estudiantes de la UTEC según
    su escala de pago asignada y si este se relaciona con respecto a los ahorros que se obtienen semanalmente.

## Instalacion de paquetes

<!-- ```{r} -->
<!-- install.packages('psych') -->
<!-- install.packages('dplyr') -->
<!-- install.packages('readr') -->
<!-- install.packages('DescTools') -->
<!-- install.packages('car') -->
<!-- install.packages('tidyr') -->
<!-- install.packages('ggplot2') -->
<!-- install.packages('remotes') -->
<!-- install.packages('ganttrify') -->
<!-- ``` -->

Si hay problemas con la instalación, consultar el siguiente enlace.[Enlacedeayuda](https://rpubs.com/dafealos/645524)
```{r}
library(remotes)
remotes::install_github("giocomai/ganttrify")
library(ganttrify)
```


```{r}
library(psych)
library(dplyr)
library(readr)
library(DescTools)
library(car)
library(readr)
library(tidyr)
library(ggplot2)
library(remotes)
library(ganttrify)
```

## Planificacion
Para manejar la distribución de nuestro proyecto entre todos, elaboramos
un Diagrama de Gantt

```{r,echo=FALSE}
crono <- read_delim("BD20231.csv", delim = ",", 
    escape_double = FALSE, col_types = cols(start_date = col_date(format = "%d/%m/%Y"), 
        end_date = col_date(format = "%d/%m/%Y")), 
    trim_ws = TRUE)
```

```{r,echo=FALSE}
ganttrify(crono,
          by_date = T,
          size_text_relative = 1, 
          font_family = "sans",
          mark_quarters = TRUE,
          exact_date = T,
          colour_palette = c("orange2","blue3", "red","pink2"),
          month_number_label = T,
          month_date_label = T,
          axis_text_align = "right"
          ) +
  labs(title="Diagrama de Gantt",subtitle="Elaboración propia",caption = "Tiempo en meses",xlab="A",tag = "Gráfico 1")
```

# Datos

## Proceso de recolección de datos

Trabajamos con datos de una encuesta importante sobre la realidad de los estudiantes de esta universidad. Analizamos gráficamente la dependencia económica de los estudiantes que estudian y los que estudian y trabajan. Se determinaron variables y se elaboraron preguntas para recopilar respuestas. Revisamos en grupo las restricciones a las variables y mejoramos la claridad de algunas preguntas.

## Enlace a encuesta

Para acceder a la encuesta, acceda al siguiente enlace
[Encuesta](https://docs.google.com/forms/d/e/1FAIpQLSeitnsLrSGw2S-478NG1Lmlbsfi4r9biMMMKFnfgNkvhMqmfg/viewform)

## Población, muestra y muestreo

La población de estudio es la comunidad de UTEC y la unidad muestral son los estudiantes matriculados en el 2023-01. El tamaño de la muestra es de 170 observaciones. El tipo
de muestreo es aleatorio simple (MAS) ya que nuestra muestra será
escogida al azar. La representatividad consta de
estudiantes de diferentes ciclos de UTEC y algunos que
también trabajan, lo que nos permitirá realizar un análisis
representativo.

## Variables

+ Variables de estudio
    + |Variable | Tipo1       | Tipo2       | Restricción |
|---------------|-------------|-------------|-------------|
|Ingreso a la Universidad|Categórica|Ordinal|Entre los ciclos 18-1 y 23-1|
|Estudia y Trabaja|Categórica|Nominal|Opciones: Si,No|
|Escala|Categórica|Nominal|Opciones: A,B,C,D,E|
|Beca|Categórica|Nominal|Ninguna|
|Presupuesto Semanal|Numérica|Discreta|Valores enteros|
|Cantidad de Almuerzos|Numérica|Discreta|Número entre 0 y 6|
|Precio máximo de almuerzos|Numérica|Continua|Numero decimal entre 5 y 30 |
|Tipo de Transporte|Categórica|Nominal|Opciones: Metropolitano o tren, carro particular, taxi, otros|
|Gasto Semanal en Transporte|Numérica|Continua|Número decimal entre 1 y 100|
|Plan Móvil|Categórica|Nominal|"Soy pospago" o "soy prepago"|
|Asistencia a la Universidad|Numérica|Discreta|Entero menor que 7|
|Gasto Extra|Categórica|Nominal|Valores menores a 500|
|Planificación de gasto Semanal|Categórica|Nominal|Opciones: Si,No|
|Conocimiento Financiero|Categórica|Nominal|4 categorías|
|Frecuencia de Aprendizaje|Categórica|Ordinal|5 niveles|
|Medio de Información|Categórica|Nominal|6 categorías|
|Ahorro Semanal|Numérica|Continua|Numero entero|
|Organización|Numérica|Discreta|5 niveles|
|Nivel de Administración|Categórica|Nominal|4 niveles|
|Cantidad de Talleres|Numérica|Discreta|Opciones de texto largo (5 en total)|
|Satisfacción del presupuesto Semanal|Categórica|Ordinal|4 niveles|
|Gasto Cubierto|Numérica|Discreta|Valor entero menor a 5|
|Eficiencia de Planificación|Categórica|Nominal|4 niveles|
|Gasto Plan Móvil|Numérica|Discreta|Valores menores a 100|


# Limpieza base de datos
Leemos nuestra base de datos.
```{r}
BD <- read_csv('GyP semanal.csv')
```

## Eliminar columnas inservibles

```{r}
BD %>%  dplyr::select(-1,-2,-7,-9,-22,-24,-31,-32,-33,-34,-35) -> BD
```
Con la funcion select quitamos las columnas inservibles.
## Renombramos variables
Utilizamos la funcion names.
```{r}
names(BD)
```
Con la funcion rename renombramos a las variables. 
```{r}
BD = rename(BD,IngresoUniversidad ='¿Cuál es tu año de ingreso a la universidad?',
               EstudiayTrabaja ='¿Estudias y trabajas al mismo tiempo?',
               Escala = '¿A qué escala de crédito perteneces?',
               Beca = '¿Eres becado? ¿Cuentas con un crédito educativo?, si es así selecciona el valor de tu porcentaje.',
               PresupuestoS = '¿De cuánto es tu presupuesto semanal en soles? Ingresar un número sin símbolos. Si es decimal, usar el punto (.)',
               CantidadAlmuerzos = '¿Cuántas veces a la semana compras almuerzo en la UTEC o cerca a la UTEC?',
               PrecioMaxAlmuerzos = 'Si compras almuerzo, ingresa el monto máximo que pagas por uno.',
               TipodeTransporte = '¿Cómo te transportas a la universidad? Si usas Metropolitano o tren además de bus, selecciona la primera opción.',
               GastoSemanalTransporte = '¿Cuánto gastas a la semana en transporte?\nEn caso, vayas en carro particular ingresa el monto que gastas en combustible a la semana.',
               PlanMovil= '¿Tienes línea celular postpago o prepago?',
               AsistenciaUniversidad= '¿Cuántas veces a la semana asistes presencialmente a la UTEC?',
               GastoExtra = '¿A parte de los gastos básicos que haces, semanalmente, que tanto sueles gastar adicionalmente el monto restante o prefieres ahorrarte ese monto ?',
               PlanificacionGastosS= '¿Realizas una planificación semanal sobre tus gastos?',
               ConociminetoFinanciero = '¿Tiene conocimientos de hábitos financieros?',
               FrecuenciaAprendizajeFi = '¿Qué tan a menudo se informa sobre cómo mejorar sus finanzas? (Asistir a eventos, talleres o cursos, leer revistas, tik toks, etc)',
               MedioInformacionFi = '¿Por qué medio suele informarse más acerca de cómo manejar sus finanzas?',
               AhorroSemanal = '¿Cuánto aproximadamente ahorra a la semana? En soles.',
               Organizacion= 'Elija la opción más recurrente con la cual las organiza:',
               NiveldeAdministraicon = '¿Considera usted que administra bien su dinero?',
               CantidadTalleresFi = '¿Ha llevado algún curso o taller sobre finanzas y/o finanzas personales fuera o dentro de la UTEC? Indique la cantidad.',
               SatisfaccionPresupuestoS= '¿Siente que su presupuesto semanal cumple con sus necesidades básicas?',
               GastoCubierto = 'De sus gastos mensuales (Vivienda, transporte, alimentación, mensualidad y servicios) cuantos cubre usted?',
               EficienciaPlanificacion = '¿Qué tan eficiente crees que es tu planificación y registro semanal de gastos ?',
               GastoPlanMovil= 'Si eres prepago: ¿Cuánto es el monto semanal que gastas en megas? Si eres postpago, escribe 0.'
               )
```
Comprobamos.
```{r}
names(BD)
```
## Tratar datos NA
Analizamos la cantidad de NAs en cada variables.
```{r}
sum(is.na(BD))
sapply(BD,function(BD) sum(is.na(BD)))
```
Al visualizar la base de datos vemos que los datos faltantes en cada variable se da por una observación que esta completamente vacía.
```{r}
BD %>% filter(!is.na(IngresoUniversidad)) -> BD
```
Visualizamos la base para confirmar si se quito la fila de NAs.
```{r}
sapply(BD,function(BD) sum(is.na(BD)))
```
Vemos la base de datos y vemos que la primera fila que era la de NAs ya no se visualiza.
## Correccion de variables
```{r}
glimpse(BD)
```
Usamos la función glimpse para ver que tipo de variable se a asignado a cada variable, y en caso no este bien asignado lo modificaremos.
### Variable IngresoUniversidad
Existen distintos tipos de formato para las respuestas por lo que lo estandarizaremos como 20XY-Z
```{r}
unique(BD$IngresoUniversidad)
BD %>% mutate( IngresoUniversidad=
       ifelse(IngresoUniversidad %in% c("201810"), "2018-1",              
       ifelse(IngresoUniversidad %in% c("201910"), "2019-1",              
       ifelse(IngresoUniversidad %in% c("201920"),"2019-2",
       ifelse(IngresoUniversidad %in% c("202010"), "2020-1",
       ifelse(IngresoUniversidad %in% c("202026","202020"), "2020-2",
       ifelse(IngresoUniversidad %in% c("202110"), "2021-1",
       ifelse(IngresoUniversidad %in% c("202120"), "2021-2",       
       ifelse(IngresoUniversidad %in% c("202210"), "2022-1",
       ifelse(IngresoUniversidad %in% c("202220"), "2022-2", IngresoUniversidad   
)))))))))) -> BD
BD %>% count(IngresoUniversidad)
```
Usamos la función mutate para reasiganarle su valor equivalente en el formato deseado.
### Variable EstudiayTrabaja
```{r}
unique(BD$EstudiayTrabaja)
BD$EstudiayTrabaja <- as.character(BD$EstudiayTrabaja)
```
Respuestas deseadas.
### Variable Escala
```{r}
unique(BD$Escala)
```
Para la variable escala se tienen las 5 respuestas deseadas.
### Variable Beca
```{r}
unique(BD$Beca)
BD %>% mutate(Beca=
              ifelse(Beca %in% c("Soy becado"), "Becado",
              ifelse(Beca %in% c("50%","25%","75%"), "Credito educativo",
              ifelse(Beca %in% c("No tengo crédito educativo ni cuento con beca."), "No becado", Beca
              )))) -> BD
table(BD$Beca)
```
Las respuestas dadas son respuestas deseadas.
### Variable PresupuestoS
```{r}
BD$PresupuestoS <- as.numeric(BD$PresupuestoS)
table(BD$PresupuestoS)
```
Corregimos los datos atipicos con la funcion mutate.  
```{r}
BD <- BD[(BD$PresupuestoS > 5),]
BD <- BD[(BD$PresupuestoS < 900),]
table(BD$PresupuestoS)
show(BD)
```
### Variable CantidadAlmuerzos
```{r}
unique(BD$CantidadAlmuerzos)
BD$CantidadAlmuerzos <- as.integer(BD$CantidadAlmuerzos)
```
En el caso de esta variable observamos que los datos dados estan dentro de las respuestas deseados, y al convertimos a enteros.  
### Variable PrecioMaxAlmuerzos
```{r}
unique(BD$PrecioMaxAlmuerzos)
```
Los datos dados para los precios que pagan los alumnos pueden considerarse reales.
### Variable TipodeTransporte
```{r}
unique(BD$TipodeTransporte)
```
Los datos dados son los deseados.
### Variable GastoSemanalTransporte
Convertimos la variable GastoSemanalTransporte de character a numeric
```{r}
BD$GastoSemanalTransporte <- as.numeric(BD$GastoSemanalTransporte)
unique(BD$GastoSemanalTransporte)
```
No es necesario cambiar los datos.
### Variable PlanMovil
```{r}
unique(BD$PlanMovil)
BD %>% mutate(PlanMovil=
              ifelse(PlanMovil %in% c("76"), "Soy postpago",
              ifelse(PlanMovil %in% c("5","Prepago"), "Soy prepago", PlanMovil
              )))-> BD
table(BD$PlanMovil)
```
Encontramos 2 obervaciones en distinto formato por lo que usamos mutate.
### Variable AsistenciaUniversidad
```{r}
unique(BD$AsistenciaUniversidad)
BD$AsistenciaUniversidad <- as.integer(BD$AsistenciaUniversidad)
```
Los dias que asisten los alumnos estan dentro de los parametros deseados 
### Variable GastoExtra
```{r}
unique(BD$GastoExtra)
BD %>% mutate(GastoExtra=
              ifelse(GastoExtra %in% c(1), "No ahorra",
              ifelse(GastoExtra %in% c(2), "Ahorra casi nada",
              ifelse(GastoExtra %in% c(3), "Ahorra un poco",
              ifelse(GastoExtra %in% c(4), "Ahorra casi todo",
              ifelse(GastoExtra %in% c(5), "Ahorra todo", GastoExtra
                      )))))) -> BD
table(BD$GastoExtra)
```
Este tipo de variable nos da la opcion de marcar entre 1 y 5 para saber que hacen los alumnos con el dinero restante de su presupuesto semanal, para el analisis de cuanto ahorran los alumnos por semana les asignamos niveles de ahorro siendo 1 no ahorra y 5 ahorra todo.
### Variable PlanificacionGastosS
```{r}
  BD$PlanificacionGastosS <- as.character(BD$PlanificacionGastosS)
```
### Variable ConociminetoFinanciero
```{r}
unique(BD$ConociminetoFinanciero)
BD %>% mutate(ConociminetoFinanciero=
                ifelse(ConociminetoFinanciero %in% c("No, no suelo administrar mi dinero." ), "No conoce, no administra",
                ifelse(ConociminetoFinanciero %in% c("No, pero tengo una buena administración de mi presupuesto semanal" ),"No conoce, si administra",
                ifelse(ConociminetoFinanciero %in% c("Sí, pero me es dificil aplicarlos"  ), "Si conoce, no administra" ,
                ifelse(ConociminetoFinanciero %in% c("Sí, los aplico en mi día a día"),"Si conoce, si administra" ,ConociminetoFinanciero
                ))))) -> BD
table(BD$ConociminetoFinanciero)
```
Para simplificar la respuestas largas y mejorar su comprensión, acortamos las respuestas.

### Variable FrecuenciaAprendizajeF
```{r}
unique(BD$FrecuenciaAprendizajeFi)
BD %>% mutate(FrecuenciaAprendizajeFi=
              ifelse(FrecuenciaAprendizajeFi %in% c(1), "Casi nunca",
              ifelse(FrecuenciaAprendizajeFi %in% c(2), "Rara vez",       
              ifelse(FrecuenciaAprendizajeFi %in% c(3), "A veces",
              ifelse(FrecuenciaAprendizajeFi %in% c(4), "Casi siempre",
              ifelse(FrecuenciaAprendizajeFi %in% c(5), "Siempre", FrecuenciaAprendizajeFi       
                     )))))) -> BD
table(BD$FrecuenciaAprendizajeFi)
```
Esta variable en la base original responde a la pregunta "¿Qué tan a menudo se informa sobre cómo mejorar sus finanzas?, modificamos las respuestas en la base de datos para tenerlo representado con sus equivalencias.
### Variable MedioInformacionFi
```{r}
unique(BD$MedioInformacionFi)
```
Los medios de información están bien escritos.
### Variable AhorroSemanal
```{r}
unique(BD$AhorroSemanal)
BD %>% mutate(AhorroSemanal=
              ifelse(AhorroSemanal %in% c("0 - 5"), 5,
              ifelse(AhorroSemanal %in% c("5 - 10"), 7.5, 
              ifelse(AhorroSemanal %in% c("10 - 20"), 15, 
              ifelse(AhorroSemanal %in% c("20 a más"), 35,       
              ifelse(AhorroSemanal %in% c("-50"), 50, AhorroSemanal       
              )))))) -> BD
table(BD$AhorroSemanal)
```
Para lograr que los datos esten dentro de los parametros deseados, convertimos los rangos en un promedio para poder analziarlos.
```{r}
BD$AhorroSemanal <- as.numeric(BD$AhorroSemanal)
BD <- BD[(BD$AhorroSemanal<200),]
```
### Variable Organizacion
```{r}
unique(BD$Organizacion)
BD %>% mutate(Organizacion=
              ifelse(Organizacion %in% c("Lo tengo todo en mi mente."),0,
              ifelse(Organizacion %in% c("Excel","Apps de finanzas","Block personal/cuaderno","Block personal/cuaderno, Lo tengo todo en mi mente.","Excel, Lo tengo todo en mi mente.","Lo tengo todo en mi mente., Apps de finanzas"), 1,
              ifelse(Organizacion %in% c( "Notion, documentos google.", "Excel, Apps de finanzas", "Block personal/cuaderno, Excel" ,"Block personal/cuaderno, Apps de finanzas", "Block personal/cuaderno, Excel, Lo tengo todo en mi mente.","Block personal/cuaderno, Lo tengo todo en mi mente., Apps de finanzas","Lo tengo todo en mi mente., Notion, documentos google."), 2,
              ifelse(Organizacion %in% c("Block personal/cuaderno, Notion, documentos google.","Block personal/cuaderno, Excel, Apps de finanzas","Block personal/cuaderno, Excel, Lo tengo todo en mi mente., Apps de finanzas","Excel, Lo tengo todo en mi mente., Notion, documentos google.","Excel, Notion, documentos google.","Block personal/cuaderno, Lo tengo todo en mi mente., Notion, documentos google."),3,
              ifelse(Organizacion %in% c("Block personal/cuaderno, Excel, Notion, documentos google."),4,
              ifelse(Organizacion %in% c("Block personal/cuaderno, Excel, Apps de finanzas, Notion, documentos google."),5,Organizacion
                     
              )))))))-> BD
table(BD$Organizacion)
BD$Organizacion <- as.integer(BD$Organizacion)
```
En la variable organización las respuestas dadas por los encuestados fue que aplicaciones usaban para organizarse y dieron mas de una por lo que convertimos las respuestas a cuantas aplicaciones usaba cada alumno para organizarse.
### Variable NiveldeAdministraicon
```{r}
unique(BD$NiveldeAdministraicon)
BD %>% mutate(NiveldeAdministraicon=
              ifelse(NiveldeAdministraicon %in% c(1), "Muy mala",
              ifelse(NiveldeAdministraicon %in% c(2), "Mala",
              ifelse(NiveldeAdministraicon %in% c(3), "Regular",
              ifelse(NiveldeAdministraicon %in% c(4), "Buena",
              ifelse(NiveldeAdministraicon %in% c(5), "Excelente",  NiveldeAdministraicon     
              )))))) -> BD
table(BD$NiveldeAdministraicon)
```
Esta variable responde a la pregunta '¿Considera usted que administra bien su dinero?', por lo que se dio un rango de respuesta de 1 a 5, para el analisis le asignamos escalas como a 1 que es muy mala y a 5 que es excelente.
### Variable CantidadTalleresFi
```{r}
unique(BD$CantidadTalleresFi)
```
No modificamos las respuestas.
### Variable SatisfaccionPresupuestoS
Con mutates unimos las variantes de si y no.
```{r}
unique(BD$SatisfaccionPresupuestoS)
BD %>% mutate(SatisfaccionPresupuestoS=
              ifelse(SatisfaccionPresupuestoS %in% c("Sí cumple con mis gastos","Sí siento que cumple.","Si Cumple","Sí cumple" ,"Sí, en lo basico.","si creo que cubre mis necesidades"), "Sí",
              ifelse(SatisfaccionPresupuestoS %in% c("No, considero que no es suficiente","No, siempre me falta"), "No" , SatisfaccionPresupuestoS  
              ))) -> BD
table(BD$SatisfaccionPresupuestoS)
BD$SatisfaccionPresupuestoS <- as.character(BD$SatisfaccionPresupuestoS)
```
### Variable GastoCubierto
```{r}
unique(BD$GastoCubierto)
BD %>% mutate(GastoCubierto=
              ifelse(GastoCubierto %in% c("Ninguno"), 0,
              ifelse(GastoCubierto %in% c("Transporte","Servicios","Vivienda","Mensualidad","Alimentación","Alimentación, Ninguno"),1,       
              ifelse(GastoCubierto %in% c("Transporte, Servicios" ,"Alimentación, Servicios","Vivienda, Alimentación","Vivienda, Transporte","Transporte, Alimentación","Alimentación, Mensualidad" ,"Transporte, Mensualidad"), 2,
              ifelse(GastoCubierto %in% c("Vivienda, Alimentación, Mensualidad","Transporte, Alimentación, Mensualidad","Alimentación, Mensualidad, Servicios","Transporte, Alimentación, Servicios","Vivienda, Transporte, Alimentación","Vivienda, Alimentación, Servicios","Transporte, Mensualidad, Servicios"),3,
              ifelse(GastoCubierto %in% c("Vivienda, Transporte, Alimentación, Servicios","Transporte, Alimentación, Mensualidad, Servicios","Vivienda, Transporte, Alimentación, Mensualidad","Vivienda, Alimentación, Mensualidad, Servicios"),4,
              ifelse(GastoCubierto %in% c("Vivienda, Transporte, Alimentación, Mensualidad, Servicios","Vivienda, Transporte, Alimentación, Mensualidad, Servicios, Ninguno"),5, GastoCubierto 
              ))))))) -> BD
table(BD$GastoCubierto)
BD$GastoCubierto <- as.integer(BD$GastoCubierto)
```
Para el analisis de esta variable no es necesario saber en que tipo de gastos son cubiertos por los alumnos sino en la cantidad de gastos cubiertos.
### Variable EficienciaPlanificacion
```{r}
unique(BD$EficienciaPlanificacion)
BD %>% mutate(EficienciaPlanificacion=
              ifelse(EficienciaPlanificacion %in% c(1), "Ineficiente",
              ifelse(EficienciaPlanificacion %in% c(2), "Poco eficiente",
              ifelse(EficienciaPlanificacion %in% c(3), "Ni eficiente, ni ineficiente",
              ifelse(EficienciaPlanificacion %in% c(4), "Eficiente",
              ifelse(EficienciaPlanificacion %in% c(5), "Muy eficiente",  EficienciaPlanificacion     
              )))))) -> BD
table(BD$EficienciaPlanificacion)
```
En nuestra encuesta se da un rango de 1 a 5 para responder que tan eficiente es su forma de planificacion.
### Variable GastoPlanMovil
Vemos que en esta variable estan ubicados los 10 NAs restantes los cuales al visualizarlos en la tabla son postpago por lo que estos datos vacios deben completarse con 0
```{r}
unique(BD$GastoPlanMovil)
BD %>% mutate(GastoPlanMovil=
                ifelse(GastoPlanMovil %in% c(NA), 0, GastoPlanMovil)) -> BD
table(BD$GastoPlanMovil)
BD <- BD[(BD$GastoPlanMovil < 41),]
```
### Variable Escala especial
```{r}
unique(BD$Escala)
BD %>% mutate(Escala=
              ifelse(Escala %in% c("A"), "ABC",
              ifelse(Escala %in% c("B"), "ABC",
              ifelse(Escala %in% c("C"), "ABC",Escala
              )))) -> BD4
table(BD4$Escala)
```

```{r}
BD$Escala <-factor(BD$Escala)
BD$GastoExtra <-factor(BD$GastoExtra)

levels(BD$GastoExtra)
BD$GastoExtra <- factor (BD$GastoExtra, levels = c("No ahorra","Ahorra casi nada","Ahorra un poco","Ahorra casi todo","Ahorra todo"))
levels(BD$GastoExtra)

BD$FrecuenciaAprendizajeFi <-factor(BD$FrecuenciaAprendizajeFi)
levels(BD$FrecuenciaAprendizajeFi)
BD$FrecuenciaAprendizajeFi <- factor (BD$FrecuenciaAprendizajeFi, levels = c("Casi nunca","Rara vez","A veces","Casi siempre","Siempre"))
levels(BD$FrecuenciaAprendizajeFi)

BD$NiveldeAdministraicon <-factor(BD$NiveldeAdministraicon)
levels(BD$NiveldeAdministraicon)
BD$NiveldeAdministraicon <- factor (BD$NiveldeAdministraicon, levels = c("Muy mala","Mala","Regular","Buena","Excelente"))
levels(BD$NiveldeAdministraicon)

BD$EficienciaPlanificacion <-factor(BD$EficienciaPlanificacion)
levels(BD$EficienciaPlanificacion)
BD$EficienciaPlanificacion <- factor (BD$EficienciaPlanificacion, levels = c("Ni eficiente, ni ineficiente","Ineficiente","Poco eficiente","Eficiente","Muy eficiente"))
levels(BD$EficienciaPlanificacion)

BD$IngresoUniversidad<-factor(BD$IngresoUniversidad)
levels(BD$IngresoUniversidad)

```
Finalmente visualizamos la base de datos ya limpia, la cual cuenta con 171 observaciones y 24 variables, comprobamos que no existen NAs en toda la base de datos con la función sum(is.na(BD)), por lo tanto nuestra base de datos tiene todos los casos completos.
```{r}
sum(is.na(BD))
sum(complete.cases(BD))
```
Comprobamos que todos nuestros casos estén completos vemos que la función sum(complete.cases(BD)) nos da la misma cantidad que la cantidad de observaciones de la base de datos.
```{r}
str(BD)
```
Comprobamos que cada variables este bien asignada con su tipo ya sea character o numeric.

```{r}
summary(BD)
```
## Exportar la base de datos limpia
```{r}
write_csv(BD, "GyP semanalLimpio.csv")
```
Exportamos la base de datos limpia para poder trabajar la siguiente parte del proyecto
```{r}
BD2 <- read_csv("GyP semanalLimpio.csv")
```

```{r}
summary(BD2)
```

---------------------------------------------------

# Análisis descriptivo:

## Descriptores numéricos:

### Ciclo de ingreso a la universidad. 

```{r}
val_2 <- BD %>% 
  group_by(IngresoUniversidad) %>% 
  count() %>% 
  ungroup() %>% 
  mutate(val_2 = `n` / sum(`n`) * 100) 

ggplot(val_2, aes(x = IngresoUniversidad, y = val_2, fill = IngresoUniversidad)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(val_2, 1), "%")), 
            position = position_stack(vjust = 0.5), color = "black") +
  coord_flip() +
  theme_minimal() +
  labs(x = "Ingreso por ciclo", y = "Frecuencia", title = "GRÁFICA 1:Ingreso de estudiantes por cada ciclo desde 2018 hasta 2023")
```

La mayor parte de estudiantes encuestados ingresaron en el ciclo 2021-2. Asimismo, existe menor cantidad de estudiantes que ingresaron en el ciclo 2018-2, lo que se entiende ya que la mayoría de los estudiantes que ingresaron en dicho ciclo egresaron. La mayoría de los estudiantes que fueron encuestados pertenecen a los 5 ciclos más recientes, en donde la mayor cantidad recae en los ciclos 2022-1 (10.5%), 2022-2 (14.6%) y 2021-2 (33.3%).


### Escala económica: 

```{r}
proporcion <- BD2 %>%
  count(Escala) %>%
  mutate(proporcion = n / sum(n) * 100)

ggplot(proporcion, aes(x =0.90, y = proporcion, fill = Escala)) +
  geom_bar(stat = "identity") +
  coord_polar(theta = "y") +
  theme_void() +
  labs(x = NULL,
       y = NULL,
       title = " GRÁFICO 2: Distribución de estudiantes según su escala económica") +
  geom_text(aes(x = 1.4, label = paste0(round(proporcion, 1), "%")),
            position = position_stack(vjust = 0.5)) +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "right")
```

La mayoría de los estudiantes  se encuentran en la categoría "Escala E", lo que indica que tienen menos recursos económicos. Por otro lado, un porcentaje muy bajo de estudiantes se encuentra en la categoría "Escala A" y "Escala B", son quienes tienen mayores recursos económicos independientemente de si estudian y trabajan al mismo tiempo.  Esto puede tener implicaciones en aspectos como la capacidad de afrontar gastos, acceder a ciertos servicios o enfrentar desafíos financieros durante su vida universitaria.

### Presupuesto semanal según la escala de pago
```{r}
boxplot(BD4$PresupuestoS ~ BD4$Escala , ylab = "Presupuesto Semanal", xlab = "Escala de pago", col=colorRampPalette(c(rgb(0.68, 0.85, 0.9),'red2'))(4),main=" GRÁFICO 3: Presupuesto semanal según la escala de pago")
```

```{r}
by(BD4$PresupuestoS,BD4$Escala,median)
```
La mediana es igual en las escalas ABC y E, pero difiere en 10 unidades en la escala D, donde hay mayor heterogeneidad y no hay datos atípicos. La escala D tiene un mayor presupuesto semanal en comparación con las escalas ABC y E. Esta variable tiene una fuerte influencia en el presupuesto semanal debido a las diferencias significativas en los boxplots.


### Grafico de Presupuesto semanal 

Como existen datos atipicos, procedemos a crear una nueva base de datos considerando a los datos atípicos como NAs y nos queda lo siguiente:
```{r}
BD2 %>% mutate(PresupuestoS=
              ifelse(PresupuestoS>300, NA,PresupuestoS
              )) -> BD6
boxplot(BD6$PresupuestoS, 
        main = "GRAFICO 4: Presupuesto Semanal",horizontal = TRUE,
        boxwex = 0.5,col="lightblue",na.rm=T, ylab = "Cantidad")
```
```{r, echo=FALSE}
cat('Resumen de Boxplot de la variable Presupuesto semanal:\n\n')
round(median(BD6$PresupuestoS,na.rm=T),2)
names(which.max(table(BD2$PresupuestoS)))
round((sd(BD6$PresupuestoS,na.rm=T)/mean(BD6$PresupuestoS,na.rm=T))*100,2)
```
El 50% de alumnos encuestados tiene un presupuesto semanal mayor o igual a 100 soles y la mayoría de alumnos tiene un presupuesto de 100 soles en comparación con otros valores.  Se presenta una asimetría positiva donde el sesgo se encuentra hacia la derecha. Como el coeficiente de variación es 66.79%, la muestra presenta datos heterogéneos, lo que reafirma que la media no es representativa, sino la mediana para esta variable.

### Gasto máximo de almuerzos:
```{r}
boxplot(BD2$PrecioMaxAlmuerzos , 
        main = "GRAFICO 5:  Precio máximo pagado por un almuerzo",horizontal = TRUE,
        boxwex = 0.5,col="lightgreen", ylab = "Cantidad")
```

```{r}
cat("Desviacion Estandar:",sd(BD2$PrecioMaxAlmuerzos),"\n")
cat("Mediana:",median(BD2$PrecioMaxAlmuerzos),"\n")
```

Existen 20 datos atípicos en total, se entiende la existencia de dichos datos puesto que los alumnos con mayor presupuesto semanal, son quienes podrían acceder a comprar un almuerzo más caro.
Al existir estos datos atípicos, la mediana se convierte en lo representativo por lo que podemos decir que los alumnos de la UTEC tienden a gastar 13.58 soles aproximadamente en almuerzo.

### Gasto semanal en transporte:

```{r}
boxplot(BD2$GastoSemanalTransporte , 
        main = "GRAFICO 6: Gasto semanal en transporte",horizontal = TRUE,
        boxwex = 0.5,col="pink", ylab = "Cantidad")
```

```{r}
summary(BD2$GastoSemanalTransporte)
cat("Desviacion Estandar:",sd(BD2$GastoSemanalTransporte),"\n")
cat("Mediana:",median(BD2$GastoSemanalTransporte),"\n")
```

Observamos que existen 9 datos atípicos. Se entiende la existencia de dichos datos atípicos puesto que existen alumnos que se movilizan en taxis y/o transporte particular, lo que implica un gasto más fuerte ya sea por el taxi o por el gasto en combustible. En nuestra encuesta especificamos que en caso tengas carro particular coloquen su gasto semanal en combustible.
Al existir estos datos atípicos, la mediana se convierte en lo representativo por lo que podemos decir que los alumnos de la UTEC tienden a gastar 20 soles aproximadamente.


### Relación entre los gastos de transporte y comida:

```{r}
ggplot(BD2, aes(x = BD2$GastoSemanalTransporte , y = BD2$PrecioMaxAlmuerzos)) +
  geom_point() +
  labs(title = "GRAFICO 7: Relación entre los gastos transporte y comida", x = "Gasto en transporte", y = "Gasto en almuerzo")

x=BD2$GastoSemanalTransporte
y=BD2$PrecioMaxAlmuerzos
correlacion <- cor(x,y)
cat("Correlación:", correlacion, "\n")

modelo <- lm(y ~ x, data = BD2)
summary(modelo)

```
Las variables Gasto transporte y Gasto comida presentan una correlación directamente proporcional o positiva débil con ecuacion $Y = 12.86+0.03X $ y $R = 0.03 $, significa que este modelo de regresión es poco significativo y no es muy práctico. Modelar la función es muy complicado ya que no se aprecia a simple vista una relación conocida. Al no existir una relación lineal, se deduce que el gasto en uno y en otro puede depender a varias circunstancias que se presenten y no necesariamente si el alumno tiene un mayor gasto en comida, implica que tiene un mayor o menor gasto o en transporte.

### Plan movil 
```{r}
barplot(table(BD2$PlanMovil), ylab = "Frecuencia", xlab = "Plan Movil", col = colorRampPalette(c('pink', 'lightgreen'))(5), main = "Gráfico 8: Plan Movil", ylim = c(0, 120))
grid(nx = NA, ny = NULL, lty = 3, col = "gray",lwd=1)
```

```{r}
summary(BD2$PlanMovil)
cat("Moda:",names(which.max(table(BD2$PlanMovil))),"\n")
```
La mayoria de alumnos encuestados cuentan con un plan movil postpago, por lo que este gasto no entraria a su presupuesto semanal. Existe una minoria que es prepago en la cual si afecta su presupuesto semanal, sin embargo ese gasto e smenor a 10 soles y puede variar en cada semana. 

### Asistencia a la Universidad VS Presupuesto semanal:

```{r}
boxplot(BD2$PresupuestoS ~ BD2$AsistenciaUniversidad , ylab = "Presupuesto Semanal", xlab = "Número de días que asiste", col=colorRampPalette(c(rgb(0.68, 0.85, 0.9),'lightgreen'))(5),main="GRÁFICO 9: Presupuesto semanal por días asistidos a la universidad")
```

```{r}
summary(BD2$AsistenciaUniversidad)
cat("Moda:",names(which.max(table(BD2$AsistenciaUniversidad))),"\n")
by(BD$PresupuestoS,BD$AsistenciaUniversidad,median)
```
Como se tiene valores de coeficientes de variación amplios para cada categoría, implica que los datos están más dispersos con respecto a la media, motivo por el cual, esta no puede ser representativa al ser poco robusta. La mediana se elige, al ser más robusta y menos sensible a los datos atípicos. Se observa que el 50% superior de los alumnos que asisten 5 y 6 días a la universidad tienen como presupuesto al menos 100 soles.

### Ahorros en el control de gastos de los estudiantes: 

```{r}
mosaicplot(table(BD2$GastoExtra,BD2$PlanificacionGastosS),
           col=c("#ffe1ff","#e0ffff"),
           xlab="Gasto Extra",
           ylab="Control de gastos",
           main="GRAFICO 10: Control de ahorro según control de gastos")
```
Vemos que son más los alumnos que ahorran un poco. La mayoría de alumnos que ahorra mayor parte o todo en lugar de gastarlo en algún adicional son quienes planifican sus gastos semanales. Además, la mayoría de quienes ahorran poco o casi nada no planifican sus gastos semanales. Finalmente, existe una mayor cantidad de alumnos que sí planifica sus gastos pero no ahorra en comparación con las demás columnas que sí lo hacen.


### Nivel financiero según frecuencia de aprendizaje.:   

```{r}
BD2$FrecuenciaAprendizajeFi <- factor (BD2$FrecuenciaAprendizajeFi, levels = c("Casi nunca","Rara vez","A veces","Casi siempre","Siempre"))
BD2$ConociminetoFinanciero  <- factor (BD2$ConociminetoFinanciero , levels = c("Si conoce, si administra","Si conoce, no administra","No conoce, si administra","No conoce, no administra"))
mosaicplot(table(BD2$ConociminetoFinanciero ,BD2$FrecuenciaAprendizajeFi),
           col=c("pink","yellow","purple","lightgreen"),
           main="GRAFICO 11:
Nivel financiero según su frecuencia de aprendizaje.",cex.axis = 0.54, xlab="Nivel de conocimiento financiero",ylab="Frecuencia de aprendizaje financiero",off=3)

```

La mayoría de alumnos no conocen de finanzas, pero administran su dinero. Los estudiantes si es que
que conocen acerca del buen manejo de finanzas o si es que administran su dinero, se preocupan por mantener una frecuencia de aprendizaje
financiero intermedia, pero los estudiantes que no conocen acerca de dicho tema y no administran adecuadamente su dinero,
presentan poco interés por aprender a hacerlo.

### Ahorro semanal por cada escala economica:

```{r}
boxplot(AhorroSemanal ~ Escala, data = BD4, main = "GRAFICO 12: Ahorro Semanal por Escala Económica", xlab = "Escala", ylab = "Ahorro Semanal", col = "lightsalmon")
```
Como se ve una variación significativa entre los boxplot para cada categoría, concluimos que la escala de pago asignada sí influye en el ahorro semanal de los alumnos encuestados.

### Ahorro semanal por condicion laboral
La variable "EstudiayTrabaja" separa a los que si trabajan durante el ciclo 2023-1 y los que no durante este periodo. 
```{r}
boxplot(BD2$AhorroSemanal~ BD2$EstudiayTrabaja , ylab = "Ahorro Semanal", xlab = "Condición laboral", col=colorRampPalette(c(rgb(0.68, 0.85, 0.9),'yellow'))(5),main="GRÁFICO 13: Ahorro Semanal por condición laboral")
```
La condición laboral no es muy influyente en la variación de datos de la variable Ahorro Semanal ya que los boxplot para ambas categorías no presentan mucha diferencia.

### Grafica de ahorro semanal:
```{r}
boxplot(BD4$AhorroSemanal,main = "GRAFICO 14: Ahorro Semanal", ylab = "Cantidad", col = "lightgreen",horizontal = TRUE)
```
En promedio la cantidad de ahorro semanal de los estudiantes es de 15 soles. También, observamos la existencia de datos atípicos, esto se debe a que algunos estudiantes trabajan y tienen más ingresos para ahorrar.

### Relación entre el presupuesto y el ahorro semanal:

```{r}
ggplot(BD2, aes(x = BD2$PresupuestoS , y = BD2$AhorroSemanal)) +
  geom_point() +
  labs(title = "GRAFICO 15: Relación entre el presupuesto semanal y el ahorro semanal", x = "Presupuesto Semanal", y = "Ahorro semanal")

x=BD2$PresupuestoS
y=BD2$AhorroSemanal

correlacion <- cor(x,y)
cat("Correlación:", correlacion, "\n")

modelo <- lm(y ~ x, data = BD2)
summary(modelo)

```

Las variables Ahorro Semanal y Presupuesto Semanal presentan una correlación directamente proporcional o positiva débil con ecuacion $Y = 14.17 + 0.05X$. Ya que $R = 0.06$, este modelo de regresión lineal simple es poco significativo y no es muy práctico. Modelar la función es muy complicado ya que no se aprecia a simple vista una relación conocida.
Al no existir una relación lineal, se deduce que no necesariamente si el alumno tiene un mayor ahorro semanal, implica que tiene un mayor presupuesto semanal o un menor presupuesto semanal.

### Relación entre el presupuesto y el gasto plan móvil:
Se considera solamente a los alumnos con gasto plan móvil prepago porque los valores son diferentes a 0.
```{r} 
library(ggplot2)
BD5=BD2 

BD5[which(BD2$GastoPlanMovil<1), 24]
BD5[which(BD2$GastoPlanMovil<1), 24] <- NA
BD5[which(BD2$GastoPlanMovil>21), 24] <- NA
```

```{r}
datos_filtrados <- BD5[complete.cases(BD5$GastoPlanMovil, BD5$PresupuestoS), ]

library(ggplot2)
ggplot(datos_filtrados, aes(x = GastoPlanMovil, y = PresupuestoS)) +
  geom_point() +
  labs(x = "Gasto Plan Movil", y = "Presupuesto Semanal") +
  ggtitle("GRAFICO 16: Relacion del Gasto Plan Movil con el Presupuesto Semanal")

x=BD2$GastoPlanMovil
y=BD2$PresupuestoS

correlacion <- cor(x,y)
cat("Correlación:", correlacion, "\n")

modelo <- lm(y ~ x, data = BD2)
summary(modelo)

```
Las variables Ahorro Semanal y Presupuesto Semanal presentan una correlación directamente proporcional o positiva débil con ecuacion $Y = 113.43 + 2.12X$. Ya que $R = 0.04$, este modelo de regresión lineal simple es poco significativo y no es muy práctico. Modelar la función es muy complicado ya que no se aprecia a simple vista una relación conocida.
Al no existir una relación lineal, se deduce que no necesariamente si el alumno tiene un mayor gasto de plan prepago de celular, tendrá un mayor presupuesto semanal.



### Organización del estudiante:
```{r}
tabla_frec <- table(BD2$Organizacion)
df_frec <- data.frame(Organizacion = as.numeric(names(tabla_frec)), Frecuencia = as.vector(tabla_frec))
df_frec <- df_frec[order(df_frec$Organizacion), ]
ggplot(df_frec, aes(x = Organizacion, y = Frecuencia, color = "Frecuencia")) + geom_line(size = 2) + labs(x = "Cantidad", y = "Frecuencia", title ="                    GRÁFICA 17: Cantidad de formas en las que se organizan") + scale_color_manual(values = "orange", name = NULL) + theme_minimal() + theme(legend.position = "top")
```
La mayor parte de alumnos no organizan sus finanzas y solo algunos utilizan una o dos formas de organización. A medida que aumenta el número de formas de organización, la cantidad de estudiantes que las utilizan disminuye. Menos de diez personas encuentran hasta cinco formas de organizarse.  Aunque muchos alumnos desconocen de finanzas, aun así administran su dinero. Aquellos que tienen conocimientos o administran su dinero muestran interés en aprender más. Sin embargo, los estudiantes que no conocen ni administran su dinero muestran poco interés en aprender.

### Satisfacción de presupuesto por el nivel de administración:

```{r}
mosaicplot(table(BD2$NiveldeAdministraicon ,BD2$SatisfaccionPresupuestoS ),
           col=c("purple","cyan3"),
           main="GRAFICO 18: 
Satisfacción de presupuesto por el nivel de administración",cex.axis = 0.54, xlab="Nivel de administración",ylab="Satisfacción del presupuesto",off=5)
```
El gráfico muestra que la mayoría de los estudiantes tienen un nivel de administración regular de su presupuesto semanal. Además, se observa que, en general, los estudiantes están satisfechos con su presupuesto, independientemente de su nivel de administración. Sin embargo, existe una minoría que se muestra insatisfecha con su presupuesto y considera que su nivel de administración es malo o muy malo.


### Eficiencia de planificación:

```{r}

x <- BD2$EficienciaPlanificacion
y <-BD2$Organizacion

mosaicplot(table(x, y), main = "GRÁFICO 19: 
           Eficiencia por la cantidad de formas de organización ", xlab = "Eficiencia de planificación ",ylab = "Cantidad de maneras para organizarse",color = c("#0c7e7e", "#c5f7f0"))
```

En el gráfico se observa que la mayoría de los encuestados prefieren organizarse de una o ninguna manera. Esto indica que la planificación de sus finanzas es ineficiente para aquellos que no tienen organización, mientras que aquellos con una forma de organizar sus finanzas la consideran neutral. También, la mayoría de los estudiantes no tienen al menos dos formas de organización y consideran que su planificación no es lo suficientemente eficiente para reducir gastos o ahorrar parte de su presupuesto semanal.


# Bibliografía

Reus,N., Reus,T., Arroyave,E. & Bedoya, D. Análisis del comportamiento económico de los estudiantes universitarios de la ciudad de Medellín. **Revista Espacios**, 38(50),16-20.[DOI](https://www.revistaespacios.com/a17v38n50/17385017.html)





























