---
title: "S4 Gestion del presupuesto semanal personal"
date: "2023-07-07"
output:
  ioslides_presentation: default
  slidy_presentation: default
  beamer_presentation: default
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```



```{r, include=FALSE}
library(psych)
library(dplyr)
library(readr)
library(DescTools)
library(car)
library(tidyr)
library(ggplot2)
library(fastGraph)
library(rriskDistributions)
```

```{r,include =FALSE}
BD <- read_csv("GyP semanalLimpio.csv")
```

```{r, include = FALSE}
BD2 <- read_csv("GyP semanalLimpio.csv")
```

```{r,include= FALSE}
unique(BD$Escala)
BD %>% mutate(Escala=
              ifelse(Escala %in% c("A"), "ABC",
              ifelse(Escala %in% c("B"), "ABC",
              ifelse(Escala %in% c("C"), "ABC",Escala
              )))) -> BD4
table(BD4$Escala)
```  

## 1. Grafica de ahorro semanal:
En promedio la cantidad de ahorro semanal de los estudiantes es de 15 soles. También, observamos la existencia de datos atípicos, esto se debe a que algunos estudiantes trabajan y tienen más ingresos para ahorrar.  


```{r, echo=FALSE}
boxplot(BD4$AhorroSemanal,main = "GRAFICO 14: Ahorro Semanal", ylab = "Cantidad", col = "lightgreen",horizontal = TRUE)
```                   
```{r, echo = FALSE}
ggplot(BD2, aes(x = BD2$PresupuestoS , y = BD2$AhorroSemanal)) +
  geom_point() +
  labs(title = "GRAFICO 15: Relación entre el presupuesto semanal y el ahorro semanal", x = "Presupuesto Semanal", y = "Ahorro semanal")
```

Las variables Ahorro Semanal y Presupuesto Semanal presentan una correlación directamente proporcional o positiva débil con ecuacion $Y = 14.17 + 0.05X$. Ya que $R = 0.06$, este modelo de regresión lineal simple es poco significativo y no es muy práctico. Modelar la función es muy complicado ya que no se aprecia a simple vista una relación conocida.
Al no existir una relación lineal, se deduce que no necesariamente si el alumno tiene un mayor ahorro semanal, implica que tiene un mayor presupuesto semanal o un menor presupuesto semanal.

## 2. Grafica de Organización del estudiante:
La mayor parte de alumnos no organizan sus finanzas y solo algunos utilizan una o dos formas de organización. A medida que aumenta el número de formas de organización, la cantidad de estudiantes que las utilizan disminuye. Menos de diez personas encuentran hasta cinco formas de organizarse.  Aunque muchos alumnos desconocen de finanzas, aun así administran su dinero. Aquellos que tienen conocimientos o administran su dinero muestran interés en aprender más. Sin embargo, los estudiantes que no conocen ni administran su dinero muestran poco interés en aprender

```{r, echo=FALSE}
tabla_frec <- table(BD2$Organizacion)
df_frec <- data.frame(Organizacion = as.numeric(names(tabla_frec)), Frecuencia = as.vector(tabla_frec))
df_frec <- df_frec[order(df_frec$Organizacion), ]
ggplot(df_frec, aes(x = Organizacion, y = Frecuencia, color = "Frecuencia")) + geom_line(size = 2) + labs(x = "Cantidad", y = "Frecuencia", title ="                    GRÁFICA 16: Cantidad de formas en las que se organizan") + scale_color_manual(values = "orange", name = NULL) + theme_minimal() + theme(legend.position = "top")
```

```{r}

x <- BD2$EficienciaPlanificacion
y <-BD2$Organizacion

mosaicplot(table(x, y), main = "GRÁFICO 17: 
           Eficiencia por la cantidad de formas de organización ", xlab = "Eficiencia de planificación ",ylab = "Cantidad de maneras para organizarse",color = c("#0c7e7e", "#c5f7f0"))
```

En el gráfico se observa que la mayoría de los encuestados prefieren organizarse de una o ninguna manera. Esto indica que la planificación de sus finanzas es ineficiente para aquellos que no tienen organización, mientras que aquellos con una forma de organizar sus finanzas la consideran neutral. También, la mayoría de los estudiantes no tienen al menos dos formas de organización y consideran que su planificación no es lo suficientemente eficiente para reducir gastos o ahorrar parte de su presupuesto semanal.

## 3. Probabilidades empiricas  
Para la probabilidad empírica elijo 2 variables interesantes que son la variable Ahorro Semanal y Presupuesto Semanal, para ello para ambas variables las coloco en intervalos. 

 5.1 Primera varibale
```{r, , include=FALSE}
unique(BD2$AhorroSemanal)
BD2 %>% mutate( AhorroSemanal=
       ifelse(AhorroSemanal %in% c(0.0,1.0,2.0,4.0,5.0,6.0,7.0,7.5,8.0,10.0), "0-10",
       ifelse(AhorroSemanal %in% c(12.0,14.0,15.0,18.0,20,0,25.0, 30.0),"11-30",
       ifelse(AhorroSemanal %in% c(35.0,40.0, 50.0,70.0 ), "31-70", AhorroSemanal))))-> BD2 

BD2 %>% count(AhorroSemanal) %>% arrange(match(AhorroSemanal, c("0-10", "11-30", "31-70"))) 
```
**Espacio muestral**

$\Omega = \{ AhorroS\ entre\ 0 \ y \ 10 \ soles \ , \  AhorroS \ entre \ 11 \ y \ 30 \ soles \ , \  AhorroS \ entre \ 31 \ y \ 70 \ soles \}$

**Definiendo los eventos atómicos**
Evento A: Elegir a un estudiante que ahorre entre 0 y 10  soles semanalmente en
una muestra de tamaño 170

Evento B: Elegir a un estudiante que ahorre entre 11 y 30 soles semanalmente en
una muestra de tamaño 170

Evento C: Elegir a un estudiante que ahorre entre 31 y 70 soles semanalmente en
una muestra de tamaño 170
**calculando la probabilidad para cada evento** 

$P(X) = \frac{Casos \ favorables}{Casos \ totales}$

- Para el primer evento
Determinar la  probabilidad de  seleccionar un estudiante que ahorre semanalmente  entre 0 y 10 soles en una muestra de tamaño 170? 

$P(A) = \frac{73}{170} = 0.4294118$

```{r, include=FALSE}
# Probabilidad del Ahorro semanal entre el valor de  0 y 10 soles 
(73/170)

```
- Para el segundo evento
Determinar la probabilidad de  seleccionar un estudiante que ahorre semanalmente  entre 11 y 30 soles en una muestra de tamaño 170? 

$P(B) = \frac{63}{170} = 0.3705882$

```{r, include=FALSE}
# Probabilidad del Ahorro semanal entre el valor de 11 y 30 soles 
(63/170)
```
- Para el tercer evento
Determinar la probabilidad de  seleccionar un estudiante que ahorre semanalmente  entre 31 y 70  soles en una muestra de tamaño 170? 

$P(C) = \frac{34}{170} = 0.2$

```{r, include=FALSE}
# Probabilidad del presupuesto semanal entre el valor de 31 y 70 soles 
(34/170)
```
## 3. Probabilidades empiricas
5.2 Para la segunda variable
```{r, include=FALSE}
unique(BD2$PresupuestoS)
BD2 %>% mutate( PresupuestoS=
       ifelse(PresupuestoS %in% c(10.00,14.40,15.00,20.00,25.00,30.00,35.00,40.00,50.00,55.00,60.00,70.00,72.00,73.00,75.00,80.00,87.00,100.00),"10-100",          
       ifelse(PresupuestoS %in% c(105.89,110.00,120.00,125.00,130.00,140.00,150.00,153.00,160.00,180.00,200.00,240.00,250.00,300.00), "101-300",
       ifelse(PresupuestoS %in% c(300.00,325.00,350.00,400.00,500.00), "301-500", PresupuestoS   
))))-> BD2
BD2 %>% count(PresupuestoS) %>% arrange(match(PresupuestoS, c("10-100", "101-300", "301-500")))
```
**Espacio muestral**

$\Omega = \{ PresupuestoS\ entre\ 10 \ y \ 100 \ soles \ , \ PresupuestoS \ entre \ 101 \ y \ 300 \ soles \ , \ PresupuestoS\ entre \ 301 \ y \ 500 \ soles \}$

**Definiendo los eventos atómicos**

Evento D : Elegir a un estudiante que ahorre entre 10 y 100  soles semanalmente en
una muestra de tamaño 170

Evento E: Elegir a un estudiante que ahorre entre 101 y 300 soles semanalmente en
una muestra de tamaño 170

Evento F: Elegir a un estudiante que ahorre entre 301y 500 soles semanalmente en
una muestra de tamaño 170

**calculando la probabilidad para cada evento** 

$P(X) = \frac{Casos \ favorables}{Casos \ totales}$

- Para el primer evento
Determinar  la probabilidad de  seleccionar un estudiante que tenga un presupuesto semanal entre 10 y 100  soles en una muestra de tamaño 170? 

$P(D) = \frac{101}{170} =  0.5941176$

```{r, include=FALSE}
# Probabilidad del presupuesto semanal entre el valor de  10 y 100 soles 
(101/170)

```
- Para el segundo evento
Determinar la probabilidad de  seleccionar un estudiante que tenga un presupuesto semanal entre 101 y 300  soles en una muestra de tamaño 170? 

$P(E) = \frac{62}{170} = 0.3647059$

```{r, include=FALSE}
# Probabilidad del presupuesto semanal entre el valor de 101 y 300 soles 
(62/170)
```

- Para el tercer evento
Determinar  la probabilidad de  seleccionar un estudiante que tenga un presupuesto semanal entre 31 y 500 soles en una muestra de tamaño 170 

$P(F) = \frac{7}{170} = 0.04117647$

```{r, include=FALSE}
# Probabilidad del presupuesto semanal entre el valor de 301 y 500 soles 
(7/170)
```

##  4. Probabilidad condicional
**Par de evento dependientes**  
   Asistencia: "Seleccionar una asistencia de 6 dias por semana a la universidad",    Espacio muestral: {Asitencia de 6 dias} 
```{r, include=FALSE}
 probAsistencia <- table(BD2$AsistenciaUniversidad)
 probAsistencia
```
   Presupuesto: "Seleccionar presupuesto semanal que sea mayor a 100  soles y menor o igual 300 soles",    Espacio muestral: {Presupuesto semanal mayor a 100 y menor igual a 300 soles} 
```{r, include=FALSE}
 probPresupuestoS <- table(BD2$PresupuestoS)
 probPresupuestoS
```  
```{r, include=FALSE}
   Pasistencia <- probAsistencia/sum(probAsistencia)
 P_1 <- data.frame(Evento = c(2,3,4,5,6), Probabilidad1= c(Pasistencia))
 P_1
```

```{r, include=FALSE}
   PpresupuestoS <- probPresupuestoS/sum(probPresupuestoS)
 P_2 <- data.frame(Evento = c("10-100","101-300","301-500"), Probabilidad= c(PpresupuestoS ))
 P_2
```
  * Tabla de doble entrada de las probabilidades de asistencia y presupuesto semanal.
```{r}
Asistencia <- c(Pasistencia)
Presupuesto <- c(PpresupuestoS)
# Crear una matriz multiplicando los valores de los vectores
matrizAxP <- outer(Presupuesto, Asistencia, "*")

# Convertir la matriz en un data frame
dataframeAxP <- as.data.frame(matrizAxP)

# Asignar los nombres de las filas y columnas
rownames(dataframeAxP) <- names(Presupuesto)
colnames(dataframeAxP) <- names(Asistencia)

# Imprimir el data frame resultante
dataframeAxP
```
* Calculamos la probabiidad de que ambos ocurran a la vez y calculas la multiplicacion de ambas probabilidades independientes  
```{r}
# Probabilidades marginales
P_Masistencia <- sum(dataframeAxP[1:3,5])
P_Mpresupuesto <- sum(dataframeAxP[2,1:5])

# Probabilidad conjunta
P_MayMp <- (nrow(filter(BD2,PresupuestoS == "101-300" & AsistenciaUniversidad==6)))/170

# Imprimir resultado
P_MayMp
P_Masistencia*P_Mpresupuesto
```
Al guiarnos de la formula de P(Ainterceptado B) = P(A)P(B) al ser diferentes en este caso podríamos decir que son dependientes.   
**Par de eventos dependientes**    
Ahorros: "Seleccionamos ahorros mayores a 30 soles",  Espacio muestral: {Ahorro mayor a 30 soles}
```{r, include=FALSE}
 probAhorro <- table(BD2$AhorroSemanal)
 probAhorro
```  
Presupuesto: "Seleccionar presupuesto semanal que sea mayor a 100  soles y menor o igual 300 soles",    Espacio muestral: {Presupuesto semanal mayor a 100 y menor igual a 300 soles}
```{r, include=FALSE}
 probPresupuestoS <- table(BD2$PresupuestoS)
 probPresupuestoS
```
```{r, include=FALSE}
    PahorroS <- probAhorro/sum(probAhorro)
P_3 <- data.frame(Evento = c("0-10","11-30","31-70"), Probabilidad= c(PahorroS ))
P_3
```

```{r, include=FALSE}
   PpresupuestoSe <- probPresupuestoS/sum(probPresupuestoS)
 P_4 <- data.frame(Evento = c("10-100","101-300","301-500"), Probabilidad= c(PpresupuestoSe ))
 P_4
```
 * Tabla de doble entrada de la probabilidad de ahorro semanal y presupuesto semanal
```{r}
Ahorro <- c(PahorroS)
PresupuestoS <- c(PpresupuestoSe)
# Crear una matriz multiplicando los valores de los vectores
matrizAhxP <- outer(PresupuestoS, Ahorro, "*")

# Convertir la matriz en un data frame
dataframeAhxP <- as.data.frame(matrizAhxP)

# Asignar los nombres de las filas y columnas
rownames(dataframeAhxP) <- names(PresupuestoS)
colnames(dataframeAhxP) <- names(Ahorro)

# Imprimir el data frame resultante
dataframeAhxP
```
* Calculamos la probabiidad de que ambos ocurran a la vez y calculas la multiplicacion de ambas probabilidades independientes  
```{r}
# Probabilidades marginales
P_Mahorro <- sum(dataframeAhxP[1:3,3])
P_Mpresupuesto1 <- sum(dataframeAhxP[2,1:3])

# Probabilidad conjunta
P_MahyMp1 <-  (nrow(filter(BD2, PresupuestoS == "101-300" & AhorroSemanal == "31-70")))/170

# Imprimir resultado
P_MahyMp1
P_Mahorro * P_Mpresupuesto1
```   
Al guiarnos de la formula de P(Ainterceptado B) = P(A)P(B) al ser diferentes en este caso podríamos decir que son dependientes.   

## 5. Variables discretas
- Primera variable: Para el análisis de variables discretas usaremos la variable Organización  
```{r, include=FALSE}
fi = table(BD2$Organizacion)
pi=round(prop.table(fi)*100,2)
cbind(fi,pi)
```
**Función de probabilidad**  
Con hist verifico a que variable se asemeja mi variable Organización para así poder saber que distribución usar
```{r}
fi = table(BD2$Organizacion)
pi=round(prop.table(fi),4)
pi
```    

```{r}
hist(BD2$Organizacion)
```  

Según la gráfica que obtuve, podría decir que mi variable organización  sería una distribución geométrica  
**Realizamos el éxito y el fracaso**  
Éxito:  Estudiantes  de la UTEC que se organizan de 1 forma , Fracaso : Estudiantes de la UTEC que se organicen más de 1  forma  
**Probabilidad de éxito y fracaso**  
```{r}
61/170
1-0.36
```
**Variable aleatoria**  
X : N° de intentos necesarios para encontrar el primer estudiante de la UTEC que  se organice de una sola forma, Rx = {0,1,2,3,4,5}  
**Identifico parámetros**
X ~G(p), entonces: X~G(0.36) 




## 5. Variables discretas  

**Gráficamos**  
```{r}
# Definir parámetro de la distribución geométrica
p <- 0.3588235
 # Probabilidad de éxito

# Generar valores de x para la distribución geométrica
x <- 0:10

# Calcular los valores de probabilidad para cada x
prob <- dgeom(x, prob = p)

# Crear un data frame con los valores de x y prob
data <- data.frame(x, prob)

# Graficar la distribución geométrica y la línea de esperanza
ggplot(data, aes(x)) +
  geom_bar(aes(y = prob), stat = "identity", fill = "lightblue") +
  geom_vline(xintercept = 1 / p, color = "red", linetype = "dashed", size = 1) +
  labs(title = "Distribución Geométrica",
       x = "x",
       y = "Probabilidad") +
  theme_minimal()
```  

**Calculamos la esperanza: **   Con la ayuda de la esperanza determinaremos el valor promedio de intentos para para encontrar el primer estudiante de la UTEC que  se organice de una sola forma , calculamos la esperanza E(x) = 
```{r}
1/0.36
```  
**cálculos de probabilidades: **¿Cual es la probabilidad de hallar al primer  estudiante  que tenga una sola forma de organizar al quinto intento?, P(x=5) = dgeom(5-1,p)  
```{r}
dgeom(4,0.36)
```  
¿Cual es la probabilidad de que un estudiante tenga 5 formas de organizarse después de 6 intento?, Primero calculo el éxito :  
```{r}
1/170
```  
P(X>6) =   
```{r}
pgeom(6,0.006, lower.tail = F)
```  

## 5. Variables discretas  

-Segunda variable: Variable a usar es la de GastoCubierto **(Distribución a usar es la distribución Binomial)**  
```{r, include=FALSE}
fi = table(BD2$GastoCubierto)
pi=prop.table(fi)*100
cbind(fi,pi)
```  
**Calculo del éxito: ** Determinar la probabilidad que un estudiante de la UTEC tenga 5 gastos cubiertos, P(E) =   
```{r}
15 / sum(fi) 
```  
**Construir la variable aleatoria (VA)**
X: Número de estudiantes de la UTEC que tienen 5 gastos cubiertos.  
**Identifico parámetros: ** X ~B(n,p)    
P(E) :  Probabilidad de éxito, definido como tener exactamente 5 gastos cubiertos, n : Tamaño de la muestra   
**Probabilidad de éxito, definido como tener exactamente 5 gastos cubiertos: **    Sea X ∼ B(n = 170, p = 0.08823529),  calcular:
```{r}
pbinom(5,170,0.08823529)
```  
**Construir la densidad**  
```{r}
# Número total de ensayos
n <- 170
# Probabilidad de éxito en cada ensayo
p <- 0.08823529
# Vector con los valores desde 0 hasta n (170)
x <- 0:n
# Calculamos las probabilidades de cada valor en x en una distribución binomial
y <- dbinom(x, n, p)
barplot(y, names.arg = x, xlab = "Número de la muestra", ylab = "Probabilidad", col = "blue", ylim = c(0, max(y) * 1.12), main = "Distribución de Gastos Cubiertos")
``` 

El valor de la varianza nos indica la dispersión de los datos con respecto a la media. En nuestro caso, al ser 13.67647, podemos decir que los datos tienen una dispersión moderada en relación con la media de 15, El valor esperado representa el valor promedio que se espera obtener. En nuestro caso, la esperanza es igual a 15, lo que significa que se espera que 15 estudiantes tengan 5 gastos cubiertos, La desviación estándar nos proporciona una medida de dispersión de los datos alrededor de la media. En nuestro caso, la desviación estándar es de 3.698171.

## 6. Variables continuas
1era variable  
* VARIABLE PRECIO DE ALMUERZO: Análisis de tipo de distribución de la variable Precio de almuerzo.    
```{r, include=FALSE}
PMA <- BD2$PrecioMaxAlmuerzos[BD2$PrecioMaxAlmuerzos>= 15]
fit.cont(PMA)
```  
X: Representa el monto mayor a 15 soles que pagarían los estudiantes encuestados por un almuerzo. X ~ N(18.818, 4.758352)   
Media, varianza y desviacion estandar.
```{r}
mean(PMA) ## Media
var(PMA) ## Varianza
sd(PMA) ## Desviacion estandar
```
```{r}
shadeDist(15,"dnorm",18.818, 4.758352,F)
```  
```{r}
shadeDist(10,"dnorm",18.818, 4.758352,T)
```

Determinar que tan probable es que un alumno de UTEC pague un monto menor o igual a 10 soles. P(X<=10)   
```{r}
pnorm(10, 18.818, 4.758352, lower.tail = TRUE)
```  

## 6. Variables continuas  
2da variable:   
* VARIABLE GASTO DE TRANSPORTE:  Análisis de tipo de distribución de la variable Gasto de transporte.      
```{r, include=FALSE}
GST <- BD2$GastoSemanalTransporte[BD2$GastoSemanalTransporte <=10]
fit.cont (GST)
```    
Y: Representa el monto menor igual a 10 soles que gastan los estudiantes encuestados en su movilidad. Y ~ N(4.267925, 3.967820 )  
Media, varianza y desviacion estandar.  
```{r}
mean(GST)
var(GST)
sd(GST)   
``` 
```{r}
shadeDist(10,"dnorm",4.267925, 4.00579,F)

shadeDist(xshade = 20,"dnorm",4.267925, 3.967820,F)
```

Determinar que tan probable es que un alumno de UTEC pague como mínimo 20 soles. P(Y>=20)  
```{r}
1-pnorm(20, 4.267925, 3.967820)
```  

```{r, include=FALSE}  

fi = table( BD2$GastoSemanalTransporte[BD2$GastoSemanalTransporte >=20])
pi=round(prop.table(fi),4)
#pi
cbind(fi,pi)
```

## 7.Conclusiones

—Se ha observado que los estudiantes de UTEC tienden a aplicar sus conocimientos financieros al organizarse, mostrando una preferencia hacia una única forma de organización en lugar de considerar múltiples opciones.

—Se ha observado que los estudiantes de la UTEC tienen una baja probabilidad de tener cinco gastos semanales, ya que se encontró que en promedio solo quince estudiantes tienen esos cinco gastos, mientras que la mayoría tiene menos de cinco gastos.

—Con respecto a la probabilidad condicional que si la ocurrencia o la no ocurrencia de uno de los eventos afecta de alguna forma la probabilidad del otro.

—Las variables aleatorias continuas tiene la capacidad para describir y analizar fenómenos complejos, en este caso nos permitió estimar la probabilidad de que un evento ocurra dentro de un rango específico. Se determinó la probabilidad del gasto mayor o igual a 15 soles que un alumno de UTEC puede gastar en un almuerzo siempre y cuando asista a la universidad. Se comprobó que existe una alta probabilidad que los estudiantes gasten más de 15 soles, sin embargo, esta probabilidad baja para aquellos que gasten un monto menor o igual a 10 soles.

—Se determinó la probabilidad del gasto menor o igual a 15 soles que un alumno de UTEC puede gastar en transporte
siempre y cuando sea para llegar a la universidad. En donde tambien se obtuvo una muy baja probabilidad que los alumnos de UTEC no excedan un monto mayor a 20 soles, ya que este monto está muy alejado de la media de gastos en transporte.






