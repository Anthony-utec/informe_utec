---
title: '**PG1: S1 Exportaciones de cobre en el Perú en el 2021 y 2022**'
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
---

<center>![](UTEC.png){width="20%"}</center>

```{=html}
<style type="text/css">
#TOC {
  color: gray; 
}

.respuesta {color: #211A23;
            background:#EDF7FF;
            border-color:#7C9DBF;
            border-left: 5px solid #7C9DBF;
            padding: 0.5em}
</style>
```

# **1. Estudio**

## 1.1. Introducción

> El Perú es uno de los principales países exportadores de minerales en el mundo, tuvo como años fructíferos **2021 y 2022** en la exportación de **cobre** ,ese hecho fue comunicado por el **MINEN(Ministerio de Energía y Minas)**, por lo que vimos conveniente obtener datos acerca de estas exportaciones formando de esa manera los siguientes objetivos para este proyecto.

## 1.2.Relevancia

> Este enfoque se centra en el análisis específico de las exportaciones de cobre, que es uno de los productos más importantes del sector minero peruano. Además, el enfoque en el análisis de las exportaciones permite explorarlos patrones y tendencias en la venta de cobre al extranjero durante los dos años en cuestión.

## 1.3. Objetivos {.tabset}

### 1.3.1. Objetivo General

> -   Analizar las exportaciones de cobre del sector minero peruano en los años 2021 y 2022"

### 1.3.2. Objetivos específicos:

> -   Comparar el número de exportaciones del sector minero con respecto a otros sectores económicos
> -   Determinar a qué países de destino vendemos más cobre y qué cantidad.
> -   Comparar la cantidad de cobre que se exporta con respecto a otros minerales.
> -   Comparar la variación de números de registros de exportación del cobre durante los años 2021 y 2022 respectivamente.
> -   Identificar qué empresa exportadora de cobre genera mayores ingresos de divisas al Perú.
> -   Comparar el precio del cobre promedio mensual por toneladas entre los años 2021 y 2022.

## 1.4. Elaboración del informe

```{r}
if (!require("ggplot2", character.only = TRUE)) {
  install.packages("ggplot2")
}
if (!require("ggthemes", character.only = TRUE)) {
  install.packages("ggthemes")
}
```

```{r}
ggplot(data, aes(x=start, xend=end, 
                 y=name, yend=name, color= Actividades)) +
  theme_bw()+
  geom_segment(size=8) +
  labs(title='Elaboración del informe PG1', x='Semanas', y='Responsables') +
  theme_economist() + 
  theme_update(plot.title = element_text(hjust = 0.5), axis.title = element_text(hjust=0.5))

```

# **2. Datos**

## 2.1. Recolección de datos

> Utilizamos los datos de exportaciones de ***cobre*** tanto en el año 2021 y 2022, otra carpeta de ***países destino*** en el cual se encuentra la información de todos los países a las cuales exportamos cobre y finalmente se encuentra la carpeta de ***sectores económicos*** el cual nos servirá para cumplir uno de los objetivos planteados.

## 2.2. Reconocimiento de variables

> Identificamos diferentes tipos de cada variable categóricas y numéricas, con sus respectivas restricciones.

### 2.2.1. Variables Cuantitativas

```         
+---------------------------------+--------------------+----------------------------------------------------+
|      Variable                   |      Tipo          |        Restricción(Característica)                 |
|                                 |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
|                                 |                    |     Es continua porque se puede medir en una       |
|Cantidad de minerales exportados |                    |     escala de valores numéricos infinita           |
|durante 2021-2022 en *kilogramos*|   Continua         |     y no hay saltos o interrupciones en los        |
|                                 |                    |     valores posibles.                              |
+---------------------------------+--------------------+----------------------------------------------------+
|Cantidad de cobre exportado      |   Continua         |     Porque representa una cantidad numérica        |
|en *kilogramos*                  |                    |     medible en una escala  y la medida está        | 
|                                 |                    |     en kilogramos.                                 |
+---------------------------------+--------------------+----------------------------------------------------+
|Total de ingresos generados por  |                    |     Cuantitativa continua porque representa        |
|la exportación de minerales por  |   Continua         |     una cantidad numérica de ingresos en una       |
|cada año en soles                |                    |     escala.                                        |
+---------------------------------+--------------------+----------------------------------------------------+
|Total de ingresos recaudados por |                    |     Porque representa una cantidad numérica        |                           
|la exportación de cobre en cada  |   Continua         |     ingresos en una escala                         |               
|año en soles                     |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
|                                 |                    |    Porque representa una cantidad numérica medible |
|                                 |   Discreta         |    y la medida está en número de empresas          |
|Número total de empresas         |                    |    exportadoras. Además, es discreta porque los    |
|exportadoras de cobre            |                    |    valores posibles son números enteros            |   
|                                 |                    |    y no hay valores fraccionarios o continuos.     |
+---------------------------------+--------------------+----------------------------------------------------+
|Número total de registro de      |                    |                                                    |
|exportaciones                    |   Discreta         |    Ya que son cantidades exactas                   |
|                                 |                    |    en el que no incluye números fraccionarios.     |
+---------------------------------+--------------------+----------------------------------------------------+
|Total de minerales exportados    |   Discreta         |    Es una variable cuantitativa discreta ya que    |
|                                 |                    |    son cantidades exactas.                         |
+---------------------------------+--------------------+----------------------------------------------------+
|Años 2021 y 2022.                |  Discreta          |    Representa a un tiempo determinado.             |
|                                 |                    |    Asimismo, el analisis del año 2021, permitirá   |
|                                 |                    |    la comparación respecto al siguiente año.       |
+---------------------------------+--------------------+----------------------------------------------------+
```

### 2.2.2. Variables Cualitativas

```         
+---------------------------------+--------------------+----------------------------------------------------+
|      Variable                   |      Tipo          |        Restricción(Característica)                 |
|                                 |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
| Países de destino               |    Nominal         |Es una variable catégorica nominal ya que los       |
|                                 |                    |países se pueden clasificar en diferentes           |
|                                 |                    |categorías sin una escala numérica que los ordene.  |
|                                 |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
| Empresas exportadoras.          |    Nominal         |Porque se puede analizar cuales fueron las empresas |
|                                 |                    |que exportaron mas y cuales no                      |  
|                                 |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
|Minerales.                       |    Nominal         |Es una variable catégorica nominal porque se puede  |
|                                 |                    |clasificar en diferentes categorias, por lo que, se | 
|                                 |                    |pueden  analizar y comparar las distintas           |  
|                                 |                    |cualidadesque estos presentan..                     |
+---------------------------------+--------------------+----------------------------------------------------+
|Sectores económicos.             |    Nominal         |Porque se puede clasificar en diferentes categorias |
|                                 |                    |y con ello podemos analizar la estructura económica |
|                                 |                    |del sector minero en el año 2021, y 2022.           |
|                                 |                    |                                                    |
+---------------------------------+--------------------+----------------------------------------------------+
|Meses del año.                   |     Ordinal        |Es una variable catégorica ordinal ya que tienen una|  
|                                 |                    |escala numérica que permite ordenar las categorías  | 
|                                 |                    |en una jerarquía.                                   |
+---------------------------------+--------------------+----------------------------------------------------+
|Empresas con más divisas.        |    Ordinal         |ya que se pueden ordenar las empresas según la      |
|                                 |                    |cantidad de divisas que generan o manejan,          |
|                                 |                    |es decir,hay una jerarquía de por medio.            |      
+---------------------------------+--------------------+----------------------------------------------------+
```

# **3. Limpieza de datos**

Explicaremos de manera concisa todos los criterios utilizados para poder garantizar que nuestra base de datos final, sirve para cumplir con los objetivos del proyecto.

## 3.1. Decargamos los paquetes

```{r}
if (!require("readr", character.only = TRUE)) {
  install.packages("readr")
}
if (!require("readxl", character.only = TRUE)) {
  install.packages("readxl")
}
if (!require("dplyr", character.only = TRUE)) {
  install.packages("dplyr")
}
if (!require("stringr", character.only = TRUE)) {
  install.packages("stringr")
}
if (!require("plotrix", character.only = TRUE)) {
  install.packages("plotrix")
}
if (!require("scales", character.only = TRUE)) {
  install.packages("scales")
}
if (!require("ggplot2", character.only = TRUE)) {
  install.packages("ggplot2")
}
if (!require("ggthemes", character.only = TRUE)) {
  install.packages("ggthemes")
}
```

## 3.2. Cargamos los paquetes

Es necesario que corra el siguiente fragmento de código para evitar errores en la ejecución de los gráficos y otros. Las librerías son **readr**, **dplyr**, **readxl**,\***stringr**.

```{r}

library(dplyr);
library(readr);
library(readxl);
library(stringr);
library(plotrix);
library(scales);
library(ggplot2);
library(ggthemes);

```

## 3.3. Leemos los archivos

Se asignó un nombre a cada base de datos que se usa en el estudio. Usamos el comando ***read_csv2*** y ***read_excel*** para poder manipular los datos del archivo.

```{r}


#destinos <- read_excel("destino3.xlsx")
export <- read_excel("export.xlsx")
items <- read_excel("items.xlsx")
minerales <- read_excel("minerales.xlsx")
sector <- read_excel("sector.xlsx")
paises<- read.csv2("destino31.csv",header =T,sep =';')
```

## 3.4. Datos faltantes

Primero, se verificó que no se cuente con datos o casos faltantes en nuestra base de datos. Para verificar, se usaron los comandos ***is.na*** y ***!complete.cases***. Se verificó que no hay ni datos ni casos faltantes.

Para export:

```{r}
datos_faltantes <- sum(is.na(export))
casos_faltantes <- sum(!complete.cases(export))
```

Para items:

```{r}
datos_faltantes1 <- sum(is.na(items))
casos_faltantes1 <- sum(!complete.cases(items))
```

Para minerales:

```{r}
datos_faltantes2 <- sum(is.na(minerales))
casos_faltantes2 <- sum(!complete.cases(minerales))
```

Hacemos un recorte a la fila NA(innecesaria de Sector):

```{r}
sector = sector[-c(1), ] #Borro el NA que estobarba de sector
```

```{r}
datos_faltantes3 <- sum(is.na(sector))
casos_faltantes3 <- sum(!complete.cases(sector))
```

## **a. Países Destino**

1.  Limpieza de NA's de columnas y filas innecesarias de Paises(Destinos)

```{r}
paises = paises[-c(260:993), ] #Borro las filas que quedaron en NA

paises = select(paises,País.Destino,Año,Meses,Total.registros,Total.KG,US.KG,US)
##Veo los names de paises
names(paises)
```

2.  Rename de Base de datos **Países Destinos** y segundo vuelvo a tomar las columnas que necesito (solo por seguridad)

```{r}
paises = rename(paises,Pais_Destino = "País.Destino",Anio = "Año",Total_Registros = "Total.registros",Total_KG = "Total.KG",US_Dolar = "US",US_KG = "US.KG")

paises = select(paises,Pais_Destino,Anio,Meses,Total_Registros,Total_KG,US_KG,US_Dolar)
names(paises)
```

3.  Verifico los cambios

```{r}
names(paises)
str(paises)
```

4.  Transformo las variables que necesitan ser convertidas a números o enteros.

-   **Total Registros** -\> **integer**

-   **Total_KG** -\> **numeric**

-   **US_KG** -\> **numeric**

-   **US_Dolar** -\> **DOLAR**

```{r}
paises$Total_Registros = as.integer(paises$Total_Registros)
paises$Total_KG = as.numeric(paises$Total_KG)
paises$US_KG = as.numeric(paises$US_KG)
paises$US_Dolar = as.numeric(paises$US_Dolar)
```

```{r}
str(paises)
```

5.  Esta es otra forma de hacerlo para el cambio del tipo de variable de "Total de registros", de ***"double"*** a \***"int"**

```{r}
paises <- mutate(paises, `Total_Registros`= as.integer(`Total_Registros`))
```

```{r}
str(paises)
```

6.  Verificamos cada una de las variables para detectar anomalías

```{r}
summary(paises$Meses)
print("Total Registros Range:")
range(paises$Total_Registros)
print("Total KG Range:")
range(paises$Total_KG)
print("US_KG Range:")
range(paises$US_KG)
print("US_DOLAR Range:")
range(paises$US_Dolar)
```

7.  Verificamos los tipos de variable que tiene nuestra base de datos

```{r}
str(paises)
```

8.  Verificamos si hay casos imcompletos en Paises Destinos:

```{r}
sum(is.na(paises))
sum(!complete.cases(paises))
```

9.  Unique Paises

```{r}
unique(paises$Anio)
unique(paises$Meses)
unique(paises$Total_Registros)
```

## **b. Export**

```{r}
names(export)
```

1.  Renombro en **export**

```{r}
export = rename(export,Anio = "AÑO",Total_Registros = "Total registros",Total_KG = "Total KG",US_KG = "US$ / KG",US_Dolar = "US$")
names(export)
```

```{r}
str(export)
```

2.  Convierto Total_Registros y Anio a -\> **Integer**

```{r}
export <- mutate(export,`Total_Registros` = as.integer(`Total_Registros`),`Anio` = as.integer(`Anio`))
```

3.  Verificamos cada una de las variables para detectar anomalías

```{r}
summary(export$Exportador)
summary(export$Meses)
range(export$Total_Registros)
range(export$Total_KG)
range(export$US_KG)
range(export$US_Dolar)
```

```{r}
str(export)
```

4.  Verificamos si hay casos imcompletos:

```{r}
sum(is.na(export))
sum(!complete.cases(export))
```

## **c. Minerales**

```{r}
str(minerales)
names(minerales)
```

1.  Rename a la data Minerales (solo los necesarios)

```{r}
minerales = rename(minerales,US_Dolar = "US $", Anio = "Año");
```

2.  Convertimos **Año** -\> **Integer**

```{r}
minerales$Anio = as.integer(minerales$Anio);
```

3.  Verificamos cada una de las variables para detectar anomalías

```{r}
summary(minerales$Minerales)
summary(minerales$Meses)
range(minerales$Anio)
range(minerales$US_Dolar)
```

4.  Verificamos si hay casos imcompletos:

```{r}
sum(is.na(minerales))
sum(!complete.cases(minerales))
```

```{r}
unique(minerales$Minerales)
unique(minerales$Anio)
unique(minerales$Meses)
unique(minerales$US_Dolar)
```

## **d. Sector**

```{r}
str(sector)
names(sector)
```

1.  Verificamos cada una de las variables para detectara anomalías

```{r}
summary(sector$Sector)
summary(sector$Producto)
```

2.  Verificamos si hay casos imcompletos y omites NA en caso haya quedado alguno:

```{r}
sum(is.na(sector))# verificamos si hay datos incompletos y se obtuvo 14
sum(!complete.cases(sector))# Se encontro una fila incompleta
sector=na.omit(sector)#Eliminamos la fila
sector=data.frame(sector, row.names = NULL)# Reordenamos el orden numerico de los datos
```

3.  Unique Sector

```{r}
unique(sector$Sector)
unique(sector$Producto)
unique(sector$Enero)
unique(sector$Febrero)
unique(sector$Marzo)
unique(sector$Abril)
unique(sector$Mayo)
unique(sector$Junio)
unique(sector$Julio)
unique(sector$Agosto)
unique(sector$Setiembre)
unique(sector$Octubre)
unique(sector$Noviembre)
unique(sector$Diciembre)
```

## **e. Producto**

```{r}
str(items)
```

1.  Renombramos variables de Items

```{r}
items = rename(items,Descrip_Part_Aduanera = "Descripción Partida Aduanera",
               Anio = "Año",
               Total_Registros = "Total registros",
               Total_KG = "Total KG",
               US_KG = "US$ / KG",
               US_Dolar = "US$")
```

2.  Pasamos **Anio** a **integer**

```{r}
items$Anio = as.integer(items$Anio)
items$Total_Registros = as.integer(items$Total_Registros)
```

-   Reviso algunos datos importantes con summary y analizo

```{r}
summary(items$Anio);
summary(items$Meses);
summary(items$Total_Registros)
summary(items$Total_KG)
summary(items$US_KG)
summary(items$US_Dolar)
```

3.  Reviso que no tenga datos faltantes

```{r}
sum(is.na(items))# verificamos si hay datos incompletos y se obtuvo 14
sum(!complete.cases(items))
```

4.  Unique items

```{r}
unique(items$Anio)
unique(items$Meses)
unique(items$Total_Registros)
```

5.  Última vista a items

```{r}
str(items)
```

# **4. Análisis descriptivo**

## **4.1. Descriptores numéricos**

### **4.1.1 Caja de Bigotes de cada base de datos y sus respectivos descriptores**

#### **Exportadores**

##### **Exportadores 2021**

```{r}
export %>% filter(Anio == 2021) %>% group_by(Meses) %>% summarise(sumTotalKGFull = sum(Total_KG),sumTotalDolar = sum(US_Dolar),sumRegistros = sum(Total_Registros)) -> mesescomparacion2021
export %>% filter(Anio == 2022) %>% group_by(Meses) %>% summarise(sumTotalKGFull= sum(Total_KG),sumTotalDolar = sum(US_Dolar),sumRegistros = sum(Total_Registros)) -> mesescomparacion2022

```

###### 1.Analizamos el comportamiento de nuestros datos en relacion al numero de registros de cada mes.

```{r}
boxplot(mesescomparacion2021$sumRegistros, main="Número de registros por mes en el 2021" ,horizontal = TRUE)
```

-   Después de realizar el diagrama de caja y bigotes realizaremos el análisis mediante el uso de algunos descriptores numéricos:

#### **Descriptores numéricos**

```{r}
round(mean(mesescomparacion2021$sumRegistros),0)
round(median(mesescomparacion2021$sumRegistros),2)
```

##### **Interpretación 1**

-   Dado que nuestra variable presenta valores no atípicos, podemos tomar al promedio como análisis.

-   Al tratarse de una variable cuantitativa discreta podemos decir que el promedio de cada mes durante el 2021 es de 111 registros de exportaciones de cobre.

-   La mediana obtenida nos permite corroborar la no presencia de datos atípicos puesto que si este dato excede notoriamente al promedio no podríamos hacer un análisis mediante el uso del promedio.

###### 2.Analizamos el comportamiento de nuestros datos en relacion al ingresos de divesas por empresa.

```{r}
#2021
export %>% filter(Anio == 2021 )%>%group_by(Exportador) %>% summarise(TotalDolaresFull = sum(US_Dolar)) -> comparacionexport2021
#2022
export %>% filter(Anio == 2022 )%>%group_by(Exportador) %>% summarise(TotalDolaresFull = sum(US_Dolar)) -> comparacionexport2022
```

```{r}
comparacionexport2021$newDollarsMillion = round(comparacionexport2021$TotalDolaresFull/1000000 , 4)
comparacionexport2022$newDollarsMillion = round(comparacionexport2022$TotalDolaresFull/1000000 , 4)  
```

```{r}
boxplot(comparacionexport2021$newDollarsMillion, main= "Ingreso de divisas por empresa en el 2021" , horizontal = TRUE)
```

-   Una vez realizada el diagrama de caja y bigotes, podemos ver claramente la presencia de datos atípicos por ello analizaremos los siguientes descriptores:

```{r}
diff(range(comparacionexport2021$newDollarsMillion))
round(median(comparacionexport2021$newDollarsMillion),2)
round(quantile(comparacionexport2021$newDollarsMillion, c(0.25, 0.75)),2)
```

##### **Interpretación 2**

-   El rango de nuestros datos es 3879.96 ,lo que nos permite tener una ida de la amplitud de nuestros datos, en este caso es un numero demasiado grande casi igual al máximo entonces hay presencia de datos atípicos, de esta manera corroboramos lo obtenido por el boxpolt.

-   La media nos indica que el 50% de las empresas exportadoras generan un ingreso menor o igual 2.79 millones de dolares respecto a las importaciones de cobre.

-   A partir del percentil calculado solo un *25%* de las empresas exportadoras de cobre genera un ingreso mayor a *271.60* millones de dolares

##### Exportadores 2022

###### 1.Analizamos el comportamiento de nuestros datos en relacion al numero de registros de cada mes.

```{r}
boxplot(mesescomparacion2022$sumRegistros, main="Número de registros por mes en el 2022" ,horizontal = TRUE)
```

-   Después de realizar el diagrama de caja y bigotes realizaremos el análisis mediante el uso de algunos descriptores numéricos:

#### **Descriptores numéricos**

```{r}
round(mean(mesescomparacion2022$sumRegistros),0)
round(median(mesescomparacion2022$sumRegistros),2)
```

##### **Interpretación 1**

\`\` - Dado que nuestra variable presenta valores no atípicos, podemos tomar al promedio como análisis.

-   Al tratarse de una variable cuantitativa discreta podemos decir que el promedio de cada mes durante el 2022 es de 111 registros de exportaciones de cobre si comparamos respecto al año anterior, podemos afirmara que no hubo cambios significativos respecto al numero de exportaciones por cada mes en los dos años.

-   La mediana obtenida nos permite corroborar la no presencia de datos atípicos puesto que si este dato excede notoriamente al promedio no podríamos hacer un análisis mediante el uso del promedio.

###### 2.Analizamos el comportamiento de nuestros datos en relacion al ingresos de divesas por empresa.

```{r}
boxplot(comparacionexport2022$newDollarsMillion,main= "Ingreso de divisas por empresa en el 2022", horizontal = TRUE)
```

-   Una vez realizada el diagrama de caja y bigotes, podemos ver claramente la presencia de datos atípicos por ello analizaremos los siguientes descriptores:

```{r}
round(diff(range(comparacionexport2022$newDollarsMillion)),2)
round(median(comparacionexport2022$newDollarsMillion),2)
round(quantile(comparacionexport2022$newDollarsMillion, c(0.25, 0.75)),2)
```

##### **Interpretación 2**

El rango de nuestros datos es 3406.05 ,lo que nos permite tener una ida de la amplitud de nuestros datos, en este caso es un numero demasiado grande casi igual al máximo entonces hay presencia de datos atípicos, de esta manera corroboramos lo obtenido por el boxpolt.

La media nos indica que el 50% de las empresas exportadoras generan un ingreso menor o igual 3.82 millones de dolares respecto a las importaciones de cobre.

A partir del percentil calculado solo un *25%* de las empresas exportadoras de cobre genera un ingreso mayor a *171.72* millones de dolares

## **4.2. Descriptores gráficos**

### **4.2.1. Análisis gráficos de acuerdo a los objetivos propuestos**

#### **Objetivo 1**

-   Comparar el numero de dolares del sector Minero con los otros sectores
-   Gráfico Utilizado: Gráficos de barras
-   ¿Por qué? Utilizar un diagrama de barras nos permitirá comparar fácilmente la cantidad de millones de dólares obtenidas en cada uno de los sectores como el agrícola,minero,pesquero,petróleo y resto o demás. Cada barra nos estaría representando un sector y la altura de la barra es proporcional a la cantidad de dólares que han obtenido.

##### **Gráfico 0: Exportaciones de sectores económicos 2021**

```{r}
sector %>% group_by(Sector) %>% summarise(sumi = sum(Enero + Febrero + Marzo + Abril + Junio + Julio + Agosto + Setiembre + Octubre+ Noviembre + Diciembre)) -> comparacionSectors2021
```

```{r}
#Entre 1000 toneladas
comparacionSectors2021$newToneladas = round(comparacionSectors2021$sumi/1000000,2)
```

```{r, eval = FALSE}
barplot(comparacionSectors2021$newToneladas,names = c("Agricolas","Minero","Pesquero","Petroleo","Resto"),col =c("red", "blue", "green", "yellow","skyblue"),ylab = "Cantidad de Dolares /1 millon de $",xlab = "Sectores",ylim = c(0,40000), main = "GR0: EXPORTACIÓN DE SECTORES ECONÓMICOS DEL 2021")
```

```{r, eval = FALSE}
comparacionSectors2021 %>% slice_max(sumi) %>% pull(Sector)
max(comparacionSectors2021$sumi)/1000000
```

##### **Interpretación_GR0 :**

-   En este gráfico observamos como el sector minero sobrepasa con creces a los demás sectores como el agrícola , pesquero , petroleo y resto con \$34,196.45 millones de dólares. De acuerdo a ello, podemos concluir que el sector minero es el que genera mayores ingresos de divisas, en consecuencia, reactiva más la economía del Perú ,debido a que se necesitará mayor mano de obra para poder satisfacer la demanda de cobre.

#### **Objetivo 2**

-   Determinar que países de destino vendemos más cobre y que cantidad.
-   Gráficos Usados: BoxPlot y Gráficos circulares
-   ¿Por qué? Los boxplot nos permiten determinar la distribución de un conjunto de datos e identificar los valores atípicos y los gráficos circulares porque nos dan una mejor visualización de la proporción y porcentajes , además de que son fáciles de interpretar.

##### **Gráfico 1: Cantidad de registros en cada país en 2021(GRÁFICO DE CAJA Y BIGOTES DE PAÍSES DESTINO 2021)**

```{r}
paises %>% filter(Anio == 2021) %>% group_by(Pais_Destino) %>% summarise(TotalesRegistrosFull = Total_Registros) %>% summarise(CantidadRegistrosPorAño = sum(TotalesRegistrosFull)) ->paisesxregistrosfull2021
```

```{r}
# Crear el gráfico de caja y bigotes
boxplot(paisesxregistrosfull2021$CantidadRegistrosPorAño ,
        col = "pink",
        ylab = "Cantidad de Registros",
        xlab = ".",
        main = "GR1: Cantidad de registros según cada país en 2021",
   las=2)

```

##### **Interpretación Grafico 1 :**

-   Aqui utilizamos diagramas de caja y bigotes porque proporcionan una representación más adecuada de la distribución y los patrones en los datos del numero de registros de 2021.El valor a atipicó más grande obtenido es China con 970 numeros de registros

##### **Gráfico 2: Destinos de exportación 2021**

```{r}
paisesxregistrosfull2021 = paisesxregistrosfull2021[order(paisesxregistrosfull2021$CantidadRegistrosPorAño,decreasing = TRUE),]
otros<-data.frame(Pais_Destino = "Otros",CantidadRegistrosPorAño = sum(paisesxregistrosfull2021[6:nrow(paisesxregistrosfull2021), "CantidadRegistrosPorAño"]))
paisesxregistrosfull2021V2 = rbind(paisesxregistrosfull2021[1:5,],otros)
```

```{r}
# Pie Chart with Percentages
slices <- c(paisesxregistrosfull2021V2$CantidadRegistrosPorAño)
lbls <- c(unique(paisesxregistrosfull2021V2$Pais_Destino))
pct <- round(slices/sum(slices)*100,2)
lbls <- paste(lbls, pct) # add percents to labels
lbls <- paste(lbls,"%",sep="") # ad % to labels
pie(slices,labels = lbls, col=c("blue", "green", "yellow", "red","gray","skyblue"),
   main="GR2:Destinos de exportación 2021")
```

```{r}
paisesxregistrosfull2021 %>% slice_max(CantidadRegistrosPorAño) %>% pull(Pais_Destino)
max(paisesxregistrosfull2021$CantidadRegistrosPorAño)
```

##### **Interpretación Grafico 2:**

-   Como podemos ver en el siguiente gráfico en el 2021 , China es el país destino al que más exportamos cobre según el numero de registros , con 970 registros y con un porcentaje de participación en el mercado internacional peruano de cobre de 72.55%.

##### **Gráfico 3: Cantidad de registros según cada país en 2022(GRÁFICO DE CAJA Y BIGOTES DE PAÍSES DESTINO 2022)**

```{r}
paises %>% filter(Anio == 2022) %>% group_by(Pais_Destino) %>% summarise(TotalesRegistrosFull = Total_Registros) %>% summarise(CantidadRegistrosPorAño = sum(TotalesRegistrosFull)) ->paisesxregistrosfull2022
```

```{r}
# Crear el gráfico de caja y bigotes
boxplot(paisesxregistrosfull2022$CantidadRegistrosPorAño,
        col = "pink",
        ylab = "Cantidad de Registros",
        xlab = ".",
        main = "GR3:Cantidad de registros según cada país en 2022",
   las=2)
```

##### **Interpretación Gráfico 3:**

-   Llegamos a la conclusión según este gráfico de cajas y bigotes que nuestro dato más predominante, y nuestro dato atípico seria China con 1005 registros con respecto a los otros países en el año 2022.

##### **Gráfico 4: Destinos de exportación 2022**

```{r}
paisesxregistrosfull2022 = paisesxregistrosfull2022[order(paisesxregistrosfull2022$CantidadRegistrosPorAño,decreasing = TRUE),]
otros2<-data.frame(Pais_Destino = "Otros",CantidadRegistrosPorAño = sum(paisesxregistrosfull2022[6:nrow(paisesxregistrosfull2022), "CantidadRegistrosPorAño"]))
paisesxregistrosfull2022V2 = rbind(paisesxregistrosfull2022[1:5,],otros2)
```

```{r}
# Pie Chart with Percentages
slices2 <- c(paisesxregistrosfull2022V2$CantidadRegistrosPorAño)
lbls2 <- c(unique(paisesxregistrosfull2022V2$Pais_Destino))
pct2 <- round(slices2/sum(slices2)*100,2)
lbls2 <- paste(lbls2, pct2) # add percents to labels
lbls2 <- paste(lbls2,"%",sep="") # ad % to labels
pie(slices2,labels = lbls2, col=c("blue", "green", "yellow", "red","gray","skyblue"),
   main="GR4 :Destinos de exportación 2022")
```

```{r}
paisesxregistrosfull2022 %>% slice_max(CantidadRegistrosPorAño) %>% pull(Pais_Destino)
max(paisesxregistrosfull2022$CantidadRegistrosPorAño)
```

##### **Intepretación Grafico 4:**

-   Como podemos ver en el siguiente gráfico en el 2022, China lidera en el país importador de cobre en Perú y representa el 75.68% de los países que compran cobre en Perú. Hay que hacer énfasis de como China influye en la economía peruana con la compra de minerales como es el caso del cobre.

#### **Objetivo 3**

-   Comparar la cantidad de dolares\$ de cobre que se consigue al exportar respecto a otros minerales
-   Graficos Usados: Graficos de barras
-   ¿Por qué? Al ser nuestras cantidades expresadas en millones de dálares, un gráfico de barras nos proporciona una mejor facilidad de comparación y de lectura, pero también podemos interpretar magnitudes como por ejemplo si existe una gran diferencia de dolares obtenido en cada mineral mediante el grafico.

```{r}
minerales %>% filter(Anio==2021)%>% group_by(Minerales)%>% summarise(cantDolarsFull = sum(US_Dolar)) -> comparDolarMine2021
minerales %>% filter(Anio==2022)%>% group_by(Minerales)%>% summarise(cantDolarsFull = sum(US_Dolar)) -> comparDolarMine2022
```

```{r}
comparDolarMine2021$newDolarsMillion = round(comparDolarMine2021$cantDolarsFull/1000000 , 2)
comparDolarMine2022$newDolarsMillion = round(comparDolarMine2022$cantDolarsFull/1000000 , 2)
```

##### **Gráfico 5: Exportación del sector minero del 2021**

```{r}
barplot(comparDolarMine2021$newDolarsMillion,names =c("Cobre","Estaño","Hierro","Oro","Plata","Plom","Rest","Zinc"),col = colorRampPalette(c("blue", "green", "yellow", "red"))(8),ylab = "Millones de dólares ",ylim = c(0,25000),xlab = "Minerales", main = "GR5: EXPORTACIÓN DEL SECTOR MINERO DEL 2021")
length(unique(comparDolarMine2021$Minerales))
comparDolarMine2021 %>% slice_max(cantDolarsFull) %>% pull(Minerales)
max(comparDolarMine2021$cantDolarsFull)
```

##### **Interpretación Gráfico 5**

-   El gráfico de barras nos da una idea de clara de la participación de los minerales en los mercados internacionales, podemos llegar a la conclusión que el cobre que mayor se exporta con respecto a otros minerales en el año 2021.Por otro lado, el mineral que menos se exporta es plata.
-   Como segundo punto la venta de cobre genera un ingreso de divisas de un monto de \$20,663.83 millones de dólares.En segundo lugar, tenemos al oro que asciende a un valor de \$7,815.18 millones de dólares.

#### **Objetivo 4**

-   Comparar que empresa exportadora de cobre genera mayores ingresos de divisas en el Perú
-   Graficos Usados: Graficos circulares
-   ¿Por qué? Usamos los gráficos circulares debido a que cada empresa genera una cantidad de divisas diferente y conforman un todo, por lo que al dividirlo en proporciones y porcentajes de ese total de divisas de cada 2021 y 2022 nos sera más sencillo y simple identificar que empresa a generado el mayor ingreso de divisas.




```{r}
comparacionexport2021= comparacionexport2021[order(comparacionexport2021$TotalDolaresFull,decreasing = TRUE),]
otrosexport1<-data.frame(Exportador = "Otros",TotalDolaresFull = sum(comparacionexport2021[9:nrow(comparacionexport2021), "TotalDolaresFull"]),newDollarsMillion = sum(comparacionexport2021[9:nrow(comparacionexport2021), "newDollarsMillion"]))
comparacionexport2021V2 = rbind(comparacionexport2021[1:8,],otrosexport1)
```

##### **Gráfico 6: Proporción de ingresos de sociedades exportadoras en el 2021**

```{r}
# Pie Chart with Percentages
slices3 <- c(comparacionexport2021V2$newDollarsMillion)
lbls3 <- c("C.Mine.Antamina","Soc.Mine.Cerro Verde","Mine.Las Bambas","Comp. Mine. Antapaccay","Trafigura Peru S.A.C","Mine. Chinalco Perú","Southern Peru Copper Corp.","HUDBAY PERU S.A.C","Otros")
pct3 <- round(slices3/sum(slices3)*100,2)
lbls3 <- paste(lbls3, pct3) # add percents to labels
lbls3 <- paste(lbls3,"%",sep="") # ad % to labels
pie(slices3,labels = lbls3, col=colorRampPalette(c("blue", "green", "yellow", "red"))(length(unique(comparacionexport2021V2$Exportador))),
   main="GR6:Sociedades Exportadoras en el 2021")
```

```{r}
max(comparacionexport2021$TotalDolaresFull)
max(comparacionexport2021$newDollarsMillion)
```

##### **Interpretación Gráfico 6:**

-   De acuerdo a la tabla con respecto al año *2021* podemos llegar a la conclusión, que la empresa exportadora que genero mayores ingresos de divisas al Perú fue COMPAÑÍA MINERA ANTAMINA S.A. y la segunda empresa es SOCIEDAD MINERA CERRO VERDE S.A.A.

-   La COMPAÑÍA MINERA ANTAMINA S.A. es el líder con respecto a las sociedades exportadoras de cobre peruanas en los mercados internacionales ha generado en el año 2021 un monto de \$3879.96 millones de dólares.

##### **Gráfico 7: Proporción de ingresos de empresas exportadoras en el 2022**

```{r}
comparacionexport2022 %>% arrange(desc(TotalDolaresFull))
```

```{r}
comparacionexport2022= comparacionexport2022[order(comparacionexport2022$TotalDolaresFull,decreasing = TRUE),]
otrosexport2<-data.frame(Exportador = "Otros",TotalDolaresFull = sum(comparacionexport2022[9:nrow(comparacionexport2022), "TotalDolaresFull"]),newDollarsMillion = sum(comparacionexport2022[9:nrow(comparacionexport2022), "newDollarsMillion"]))
comparacionexport2022V2 = rbind(comparacionexport2022[1:8,],otrosexport2)
```

```{r}
# Pie Chart with Percentages
slices4 <- c(comparacionexport2022V2$newDollarsMillion)
lbls4 <- c("Soc.Min.Cerro Verde","C.Mine.Antamina.","Mine. Las Bambas","Trafigura PERU S.A.C.","Comp. Mine. Antapaccay S.A.","Mine. Chinalco Perú S.A","Hudbay Perú S.A.C.","Glencore Perú S.A.C","Otros")
pct4 <- round(slices4/sum(slices4)*100,2)
lbls4 <- paste(lbls4, pct4) # add percents to labels
lbls4 <- paste(lbls4,"%",sep="") # ad % to labels
pie(slices4,labels = lbls4, col=colorRampPalette(c("blue", "green", "yellow", "red"))(length(unique(comparacionexport2022V2$Exportador))),
   main="GR7: Proporción de ingresos de empresas exportadoras en el 2022")
```

```{r}
max(comparacionexport2022$TotalDolaresFull)
max(comparacionexport2022$newDollarsMillion)
```

##### **Interpretación Gráfico 7:**

-   Entre las sociedades la que generó mayores ventas por la exportación de cobre en el año 2022 fue SOCIEDAD MINERA CERRO VERDE S.A.A. con un monto de \$3406.05 millones de dólares. Tanto la empresa CMine Antamina y Soc.,Min.Cerro Verde son las sociedades más solicitadas por los ofertantes y juntan representa casi el 41% del mercado exportador de cobre.

-   Obs: En esta tabla se refleja la cantidad de dolares generadas por cada empresa exportadora de cobre. De acuerdo, podemos decir que la segunda empresa que generó mayores ventas en el año *2022* fue COMPAÑIA MINERA ANTAMINA S.A. con \$2792.43 millones de dólares.

```{r}
comparacionexport2022 %>% arrange(desc(TotalDolaresFull))
```

#### **Objetivo 5**

-   Comparar la cantidad de cobre por mes en kilo toneladas metricas(kTM) entre los años 2021 y 2022
-   Gráficos Usados: Graficos de barras y grafico de barras de doble comparación
-   ¿Por qué? Usamos los graficos de barras de doble comparación porque nos permite ver la tendencia o patrón que pueden estar siguiendo la cantidad de kTM de cobre que está siendo demandada en cada mes del año 2021 y 2022 , incluyendo los 12 meses de Enero a Diciembre



```{r}
mesescomparacion2021 <- mesescomparacion2021[order(match(mesescomparacion2021$Meses,c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"))),]
mesescomparacion2022 <- mesescomparacion2022[order(match(mesescomparacion2022$Meses,c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"))),]
```

```{r}
mesescomparacion2021$newKgTon = round(mesescomparacion2021$sumTotalKGFull/1000000 , 4)
mesescomparacion2022$newKgTon= round(mesescomparacion2022$sumTotalKGFull/1000000 , 4)
mesescomparacion2021$newDolarMillion = round(mesescomparacion2021$sumTotalDolar/1000000,4)
mesescomparacion2022$newDolarMillion = round(mesescomparacion2022$sumTotalDolar/1000000,4)
```

##### **Gráfico 8: Demanda de cobre del 2021 Mensual**

```{r}
barplot(mesescomparacion2021$newKgTon,names = c("En.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ag.","Sep.","Oct","Nov.","Dic."),col = colorRampPalette(c("blue", "green", "yellow", "red"))(12),ylim = c(0,max(mesescomparacion2021$newKgTon)+100),ylab = "Cobre(kTM) ",xlab = "Meses", main = "GR 8: DEMANDA DEL COBRE DEL 2021")
length(unique(mesescomparacion2021$Meses))
mesescomparacion2021 %>% slice_max(sumTotalKGFull) %>% pull(Meses)
max(mesescomparacion2021$sumTotalKGFull)
max(mesescomparacion2021$newKgTon)
```

##### **Interpretación Gráfico 8:**

-   Como podemos observar la cantidad de kilogramos alcanzo su punto más alto en Noviembre y Diciembre , y la menor cantidad de cobre(kTM) importada en 2021 fue en Octubre una de las posibles respuesta es que el tipo de cambio que es el dólar valía menos con respecto a su moneda nacional, esto significa que la empresa importadora necesita más dolares para costear el cobre importado de Perú, una de las consecuencia es que reduce su capacidad adquisitiva en la compra de la mercancía.

##### **Gráfico 9: Demanda del cobre del 2022 Mensual**

```{r}
barplot(mesescomparacion2022$newKgTon,names = c("En.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ag.","Sep.","Oct","Nov.","Dic."),col = colorRampPalette(c("blue", "green", "yellow", "red"))(12),ylim = c(0,max(mesescomparacion2022$newKgTon)+100),ylab = "Cobre(kTM)",xlab = "Meses", main = "GR9: DEMANDA DEL COBRE DEL 2022")
length(unique(mesescomparacion2022$Meses))
mesescomparacion2022 %>% slice_max(sumTotalKGFull) %>% pull(Meses)
max(mesescomparacion2022$sumTotalKGFull)
```

##### **Interpretación Gráfico 9:**

-   Como podemos observar la demanda de cobre cantidad alcanzó su punto más alto en Junio y Septiembre , y la menor cantidad de kg importada en 2022 fue en Noviembre , interpretando la grafica ques esto se debió al bajo precio de cobre por kilogramo que incentivo a que las empresas importadoras demanden más cobre.

##### **Gráfico 10: Comparación de la demanda del cobre del 2021 y 2022**

```{r}
# Crear el gráfico de barras de doble barras
barplot(rbind(mesescomparacion2022$newKgTon,mesescomparacion2021$newKgTon), beside = TRUE, names.arg = c("En.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ag.","Sep.","Oct","Nov.","Dic."),ylim = c(0,max(mesescomparacion2022$newKgTon)+100), legend.text = c("2022", "2021"),col = colorRampPalette(c("blue", "green", "yellow", "red"))(2) ,xlab = "Meses" ,ylab = "Cobre(kTM)",main = "GR10: DEMANDA DEL COBRE ENTRE 2022 Y 2021")
```

#### *Objetivo 6*

-   Comparar el precio del cobre promedio mensual por toneladas entre los años 2021 y 2022.
-   Graficos Usados: Graficos de doble comparación y grafico de función de variación
-   ¿Por que? En este objetivo tambien recurrimos al uso de grafico de barras de doble comparación para poder visualizar de forma más sencilla que que tanto vario el promedio del precio de un mes tanto del 2021 y 2022 , la funciones de variación expresadas en graficos fue empleada por que nos permiten visualizar que tanto se encontraba variando el precio y la cantidad de millones de dolares en cada mes del año

```{r}
items %>% filter(Anio == 2021) %>% group_by(Meses) %>% summarise(Promedio = round(mean(US_KG),3)) ->Kilo_DolarComparacion2021
items %>% filter(Anio == 2022) %>% group_by(Meses) %>% summarise(Promedio = round(mean(US_KG),3)) ->Kilo_DolarComparacion2022
```

```{r}
Kilo_DolarComparacion2021 <- Kilo_DolarComparacion2021[order(match(Kilo_DolarComparacion2021$Meses,c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"))),]
Kilo_DolarComparacion2022 <- Kilo_DolarComparacion2022[order(match(Kilo_DolarComparacion2022$Meses,c("Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"))),]
```

##### **Gráfico 11: Precio promedio del cobre entre 2021 y 2022**

```{r}
# Crear el gráfico de barras de doble barras
barplot(rbind(Kilo_DolarComparacion2021$Promedio,Kilo_DolarComparacion2022$Promedio), beside = TRUE, names.arg = c("En.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ag.","Sep.","Oct","Nov.","Dic."),ylim = c(0,max(Kilo_DolarComparacion2021$Promedio)+1), legend.text = c("2021", "2022"),col = colorRampPalette(c("blue", "green", "yellow", "red"))(2) ,xlab="Meses", ylab = "Precio promedio(US$)",main = " GR11: PRECIO PROMEDIO DEL COBRE ENTRE 2021 Y 2022")
```

##### **Interpretación Grafico 11:**

-   De acuerdo al diagrama de barras podemos decir que en el año 2021 el precio promedio fue mayor con respecto al 2022 en la mayoría de meses, podemos llegar a una conclusión, si bien en el año 2022 hubo un mayor ventas de cobre, pero no fue acompañado con el precio del cobre, ya que se vendió a menor precio con respecto al 2021. Además que en el año 2022 los precios ve venta era menor con respecto al 2021 en está gráfica se observa que en el año 2022 hubo mayor demanda y producción de cobre a diferencia del 2021.

##### **Gráfico 12: Oscilación del precio promedio del cobre en 2021**

```{r}
plot(c(1:length(Kilo_DolarComparacion2021$Meses)),Kilo_DolarComparacion2021$Promedio ,type = "b",ylab = "Precio promedio (US$)",xlab = "Meses(número)",col = "pink",lwd = 3,pch = 21,bg = "red",cex = 1.5,main = "GR12:OSCILACIÓN DEL PRECIO PROMEDIO DEL COBRE 2021")
text(x = c(1:length(Kilo_DolarComparacion2021$Meses)),y =Kilo_DolarComparacion2021$Promedio,round(unique(Kilo_DolarComparacion2021$Promedio),2),col = "black"  )
```

##### **Interpretación Grafico 12:**

-   De acuerdo al gráfico de línea que me da una idea clara de como ha fluctuado el precio promedio del cobre durante todo el año 2021, donde alcanzo su pico alto en el mes de octubre con un precio de \$2.49 dólares por 1 kg de cobre.Sin embargo, con un pico bajo en el mes de enero \$1.98 dolares por kg de cobre. Observamos que en el año 2021, el precio del cobre no ha es estable ha ido fluctuando durante todos los meses.

##### **Gráfico 13: Fluctuación del precio promedio del cobre del año 2022**

```{r}
plot(c(1:length(Kilo_DolarComparacion2022$Meses)),Kilo_DolarComparacion2022$Promedio ,type = "b",ylab = "Precio promedio",xlab = "Meses(número)",col = "skyblue",lwd = 3,pch = 21,bg = "red",cex = 1.5,main = "GR13:FLUCTUACIÓN DEL PRECIO PROMEDIO DEL COBRE 2022")
text(x = c(1:length(Kilo_DolarComparacion2022$Meses)),y =Kilo_DolarComparacion2022$Promedio,round(unique(Kilo_DolarComparacion2022$Promedio),2),col = "black"  )
```

##### **Interpretación Gráfico 13:**

-   De acuerdo al gráfico de línea que me da una idea clara de como ha fluctuado el precio promedio del cobre durante todo el año 2022, donde alcanzo su pico alto en el mes de febrero con un precio de \$2.28 dólares por 1 kg de cobre.Sin embargo, con un pico bajo en el mes de setiembre \$1.84 dolares por kg de cobre. Observamos que en el año 2022, el precio del cobre no ha estado estable ha ido fluctuando durante todos los meses y ha tenido un precio más bajo que en el 2021.

##### **Total de dolares promedio en meses 2021 y 2022**

```{r}
items %>% filter(Anio == 2021) %>% select(Meses,US_Dolar) ->comparacionDolarTotalItems2021
items %>% filter(Anio == 2022) %>% select(Meses,US_Dolar) ->comparacionDolarTotalItems2022
```

```{r}
comparacionDolarTotalItems2021$US_Dolar = round(comparacionDolarTotalItems2021$US_Dolar/1000000,2)
comparacionDolarTotalItems2022$US_Dolar = round(comparacionDolarTotalItems2022$US_Dolar/1000000,2)
```

##### **Gráfico 14: Comparación de millones de dolares mensual entre año 2021 y 2022**

```{r}
# Crear el gráfico de barras de doble barras

barplot(rbind(comparacionDolarTotalItems2021$US_Dolar,comparacionDolarTotalItems2022$US_Dolar), beside = TRUE, names.arg = c("En.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ag.","Sep.","Oct","Nov.","Dic."), ylim = c(0,2000),legend.text = c("2021", "2022"),col = colorRampPalette(c("blue", "green", "yellow"))(2) ,xlab = "Meses", ylab = "Millones de dólares(US$)",main = "GR14:Comparación de millones de dólares mensual entre el año 2021 y 2022")
```

##### **Gráfico 15: Variación de Millones de dólares mensuales del año 2021**

-   Aqui creamos un gráfico para poder ver la variación de millones en dolares por meses evaluado en el año 2021

```{r}

plot(c(1:length(comparacionDolarTotalItems2021$Meses)),comparacionDolarTotalItems2021$US_Dolar ,type = "b",ylab = "Millones de dólares",xlab = "Meses(número)",main = "Variación de Millones de dólares del año 2021",col = "greenyellow",lwd = 3,pch = 21,bg = "red",cex = 1.5)
text(x = c(1:length(comparacionDolarTotalItems2021$Meses)),y =comparacionDolarTotalItems2021$US_Dolar,unique(comparacionDolarTotalItems2021$US_Dolar),col = "black"  )
```

##### **Gráfico 16: Variación de Millones de dólares mesuales del año 2022**

-   Aqui creamos un gráfico para poder ver la variación de millones en dolares por meses evaluado en el año 2022

```{r}
plot(c(1:length(comparacionDolarTotalItems2022$Meses)),comparacionDolarTotalItems2022$US_Dolar ,type = "b",ylab = "Millones de dólares",xlab = "Meses(número)",main = "Variación de Millones de dólares del año 2022",col = "skyblue",lwd = 3,pch = 21,bg = "green",cex = 1.5)
text(x = c(1:length(comparacionDolarTotalItems2022$Meses)),y =comparacionDolarTotalItems2022$US_Dolar,unique(comparacionDolarTotalItems2022$US_Dolar),col = "black"  )
```

## **4.3. Regresión lineal**

### **Total de cobre (kTM) vs Millones US**

1.  Creación del modelo de regresión lineal (Total de cobre (kTM) vs Millones US\$)

```{r}

modelo <- lm(mesescomparacion2022$newDolarMillion ~ mesescomparacion2022$newKgTon)

```

```{r}
plot(mesescomparacion2022$newKgTon, mesescomparacion2022$newDolarMillion,xlab="Cobre(kTM)",ylab="Millones US$",main=" TOTAL DE COBRE (kTM) VS Millones US$",col.main = "blue")
abline(modelo,col="red")

```

2.  Hallamos la correlación de Total de cobre (kTM) y Millones US

```{r}
cor(mesescomparacion2022$newKgTon,mesescomparacion2022$newDolarMillion,use = "pairwise.complete.obs")
```

3.  Resumen del modelo

```{r}
summary(modelo)
```

#### **Interpretación 1**

-   Analizando la correlación entre **"Total de cobre (kTM)" VS "Millones US"** , tenemos un valor **0.9186374**, lo que me indicaría que hay una relación positiva fuerte entre "Total de cobre (kTM)" y "Millones US".

#### **Escenario positivo**

-   Esto implica que a medida que aumente "Total de cobre (kTM)" es probable que también aumente "los Millones US".

-   Si tiene sentido porque si aumenta la cantidad de cobre que se exporta a los países destino, esto implicará un aumento de el número de divisas al Perú.

#### **Resumen del modelo**

-   De acuerdo al resumen del modelo, podemos indicar con respecto a las estimaciones que por cada 1(kTM) de cobre que se exporta se recibe 2.039 millones de dólares.

-   R-cuadrado múltiple de 0.8439 indica que aproximadamente el 84.39% de la variabilidad de la variable "Millones US". Por otro, el Multiple R-squared o el R al cuadrado es **0.8439** es cercano a 1 por lo que el modelo tiene un buen ajuste a los datos y explica la mayoría de las variaciones en la variable dependiente que es "Total de cobre (kTM)" a través de la relación lineal con la variable independiente que es "Millones US".

### **Total de registros vs Total de cobre (kTM)**

1.  Creación del modelo de regresión lineal

```{r}

modelo2<- lm(mesescomparacion2021$newKgTon ~ mesescomparacion2021$sumRegistros)

```

```{r}
plot(mesescomparacion2021$sumRegistros, mesescomparacion2021$newKgTon,xlab="Totales de registro",ylab="Total de cobre (kTM)",main=" TOTALES DE REGISTRO VS TOTAL DE COBRE (kTM)",col.main = "blue")
abline(modelo2,col="red")
```

2.  Hallamos la correlación de Total de cobre (kTM) y Millones US

```{r}
cor(mesescomparacion2021$sumRegistros,mesescomparacion2021$newKgTon,use = "pairwise.complete.obs")
```

3.  Resumen del modelo

```{r}
summary(modelo2)
```

#### **Interpretación 2**

-   La correlación hallada determina que existe una correlación positiva moderada entre las variable \*\*"Total de registro VS"Total de cobre (kTM)"\*\* , con un valor de **0.5248361** lo que sugiere que tienden a variar en la misma dirección de manera muy estrecha. Esto implica que cuando los valores de"Total de kg" aumentan, es altamente probable que los valores de "US" también aumenten, y viceversa.

#### **Resumen del modelo**

-   De acuerdo al resumen del modelo podemos decir que por 1 registro de exportación se vende 1.705(kTM) de cobre "Multiple R-squared" es 0.2755, indica que aproximadamente el 27.55% de la variabilidad de "Total de cobre (kTM)" puede ser explicada por el modelo de regresión múltiple y no por una regresión lineal. Esto se debe que el R-cuadrado es relativamente bajo, lo que sugiere que el modelo de regresión múltiple, ya que tiene un ajuste limitado de los datos y no puede explicar una gran parte de la variabilidad observada en la variable "Total de cobre (kTM)".
