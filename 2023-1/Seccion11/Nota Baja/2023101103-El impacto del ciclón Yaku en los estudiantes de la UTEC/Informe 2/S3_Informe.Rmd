---
title: Estudio del impacto del ciclón Yaku en los estudiantes de la Universidad de
  Ingeniería y Tecnología. Lima, abril 2023.
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    css: assets/style.css
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    highlight: default
    theme: flatly
---

------------------------------------------------------------------------

## [Instalación inicial]{.underline}

Para poder ejecutar todos nuestros chunks es necesario instalar una lista de paquetes. En búsqueda de agilizar el proceso de interpretación y mantenimineto del proyecto, estos chunks permiten de manera sencilla ejecutar las instrucciones de instalación. No obstante están diseñados para ejecutarse automáticamente si no cuentas con ellos localmente.

```{r message=FALSE, warning=FALSE}
if(!require(dplyr)) { install.packages("dplyr") }
if(!require(ggplot2)) { install.packages("ggplot2") }
if(!require(readr)) { install.packages("readr") }
if(!require(pheatmap)) { install.packages("pheatmap") }
```

```{r}
library(dplyr)
library(ggplot2)
library(readr)
library(descr)
library(pheatmap)
```

------------------------------------------------------------------------

# 1. [Introducción]{.underline}

## 1.1 Relevancia

Los estudiantes se encontraron en medio de desafíos considerables tras la aparición del ciclón "Yaku". Aunque no todos experimentaron las consecuencias de forma directa, muchos tienen seres queridos que sí se vieron significativamente afectados por este devastador fenómeno natural. El impacto del ciclón podría haber alterado la vida de los estudiantes de diversas formas, ya sea en términos económicos, psicológicos o físicos. Este proyecto tiene como objetivo proporcionar una visión completa de la naturaleza y el alcance del impacto sufrido por los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Asimismo, se espera que estos hallazgos sirvan para guiar a las autoridades y a los ciudadanos en la anticipación de situaciones similares en el futuro, minimizando así los daños potenciales en la sociedad.

## 1.2 Objetivos

### 1.2.1 Objetivo general

Investigar y analizar el impacto del ciclón Yaku en los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC) en Lima, en abril de 2023, con el fin de comprender la magnitud de las consecuencias generadas por este fenómeno natural. Esto incluirá evaluar la situación actual de los estudiantes, determinar la proporción de estudiantes afectados, identificar los departamentos más afectados, y explorar cómo la tragedia ha influido en sus estudios, estado de ánimo, y actitud ante la situación. Además, el estudio busca valorar la respuesta y las medidas tomadas por el gobierno y organizaciones de ayuda, la preparación de los estudiantes ante un suceso de esta magnitud, y establecer si han sufrido pérdidas materiales, económicas y ambientales como resultado del ciclón Yaku.

### 1.2.2 Objetivos específicos

1.  Conocer la situación en la que se encuentran los estudiantes de UTEC después del fenómeno natural Yaku.
2.  Determinar el porcentaje de alumnos afectados.
3.  Conocer los departamentos más afectado por el ciclón Yaku.
4.  Determinar si el ciclón Yaku afectó el rendimiento académico y estado de ánimo de los estudiantes de UTEC.
5.  Conocer la actitud que tomaron los estudiantes ante el ciclón Yaku.
6.  Conocer de qué forma afectó el ciclón Yaku a los estudiantes de la UTEC.
7.  Evaluar la respuesta por parte del Gobierno y Organizaciones de ayuda frente a daños causados por el ciclón Yaku.
8.  Evaluar la preparación de los estudiantes de la UTEC ante un fenómeno natural.
9.  Determinar si los estudiantes de UTEC tuvieron perdidas materiales, económicas y ambientales a causa del ciclón Yaku.

## 1.3 Contexto

Después de cuatro décadas, el norte de Perú fue azotado por un ciclón, un fenómeno natural bautizado como "Yaku", un término que proviene de la lengua quechua y significa "agua". Este ciclón, caracterizado por su rápida rotación, dejó un rastro de devastación a su paso. Entre las catástrofes provocadas por este suceso, destacaron inundaciones resultantes de las intensas lluvias. Estas afectaron a miles de familias, conduciendo a la pérdida de innumerables bienes materiales.

En respuesta a la magnitud de los daños, las autoridades peruanas declararon un estado de emergencia en varias regiones y movilizaron equipos de rescate y asistencia humanitaria. Su objetivo: brindar apoyo a las numerosas personas damnificadas, las cuales quedaron en situaciones de extrema vulnerabilidad tras el paso del ciclón "Yaku". A partir de este contexto, nace nuestro estudio estadístico que tiene como objetivo profundizar en la naturaleza y el alcance del impacto sufrido por los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC).

------------------------------------------------------------------------

# [**2. Datos**]{.underline}

## 2.1 Recolección de datos

Los datos se obtuvieron por medio de encuestas digitales, por medio de la plataforma *Google Forms*. El propósito de estas encuestas fue conocer el impacto que el ciclón Yaku tuvo en los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Nuestra encuesta digital se enfocó en los estudiantes de pregrado de UTEC que están cursando el ciclo 2023-1, por lo tanto optamos por compartir nuestra encuestra en grupos de Whatsapp y Telegram relacionados a la Universidad. Por otro lado, también solicitamos que se complete nuestra encuesta de manera presencial, para lo cual facilitamos un código QR para acceder a ella. Siguiendo todas estas consideraciones logramos completar las 150 observaciones mínimas necesarias para proceder con nuestro análisis.

-   Es importante mencionar que en cada encuesta realizada, se le pidió al usuario responder con sinceridad y juicio crítico. Esto, pues buscamos disminuir cualquier posibilidad de sesgo asociado a su respuesta.
-   Priorizamos encuestar a gente *aleatoria* por la universidad (a excepción de grupos de estudiantes) con el objetivo de no guardar un sesgo de muestras, es decir evitamos dirigirnos a grupos de personas de la misma carrera, pues afectaría a nuestras estadísticas.
-   Por otro lado, la encuesta no recopiló dirección de correo, ni código de estudiante, simplemente carrera, edad, género y ciclo académico. Esto lo hicimos con el principal objetivo de no recopilar información innecesaria y sensible, no obstante la encuesta perteneció cerrada para estudiantes de la Universidad de Ingeniería y Tecnología (UTEC) sin recopilación de correos.

## 2.2 Población, muestra y muestreo

### 2.2.1 Población de estudio

Los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Unidad muestral: Los estudiantes que respondieron adecuadamente a la encuesta realizada a través de Google Forms (117 estudiantes)

### 2.2.2 Representatividad

La muestra se considera representativa debido a que se envió de forma masiva a la comunidad estudiantil de pregrado de UTEC a través de grupos de WhatsApp, lo que permitió alcanzar a un número significativo de estudiantes de diferentes carreras y edades. Al obtener 117 observaciones, se logra tener una muestra considerablemente representativa de la población de estudiantes de UTEC.

### 2.2.3 Tipo de muestreo

En este caso, se utilizó un tipo de muestreo no probabilístico denominado muestreo por conveniencia.Está trata en la disponibilidad y accesibilidad de los elementos de la población. En este caso, se aprovechó la cercanía y la facilidad de comunicación con los estudiantes de UTEC a través de grupos de WhatsApp y el uso de un formulario en línea (Google Forms) para obtener las respuestas. Aunque este tipo de muestreo no garantiza una selección aleatoria y puede presentar sesgos, en este caso, se hizo el esfuerzo de llegar a una muestra representativa dentro de las posibilidades disponibles.

| Variable                                          | Tipo de Variable   | Restricciones                                                                                                                                                                                                                                                                                                                                                                                                                |
|:-------------|:-------------|:--------------------------------------------|
| Género                                            | Categórica Nominal | El usuario debe elegir obligatoriamente una de las dos opciones, que son femenino o masculino.                                                                                                                                                                                                                                                                                                                               |
| Edad                                              | Numérica Discreta  | El usuario debe responder obligatoriamente, el número tiene que un entero y no negativo.                                                                                                                                                                                                                                                                                                                                     |
| Carrera                                           | Categórica Nominal | El usuario responderá obligatoriamente 1 de las 12 opciones las cuales son Administración y Negocios Digitales, Bioingeniería, Ciencia de Datos, Ciencia de la Computación, Ingeniería Civil, Ingeniería de la Energía, Ingeniería Mecánica, Ingeniería Ambiental, Ingeniería industrial, Ingeniería electrónica, Ingeniería Química e Ingeniería Mecatrónica ya que son las únicas carreras que brinda la universidad UTEC. |
| Lugar Residencial                                 | Categórica Nominal | El usuario debe responder obligatoriamente una entre estas opciones: División política Norte (Tumbes, Piura, Lambayeque, La Libertad); Centro (Ancash, Lima, Ica, Junín, Huancavelica, Pasco); Sur (Arequipa, Moquegua, Tacna, Ayacucho, Apurímac, Cusco, Puno); Oriente (Loreto, Ucayali, Madre de Dios).                                                                                                                   |
| ¿De qué forma le afectó?                          | Categórica Nominal | Solo se puede elegir dos opciones entre "si o no".                                                                                                                                                                                                                                                                                                                                                                           |
| Tipo de vivienda                                  | Categórica Nominal | El usuario responderá obligatoriamente una de las tres opciones, las cuales son: casa, departamento y otro.                                                                                                                                                                                                                                                                                                                  |
| Localidad                                         | Categórica Nominal | El usuario responderá una entre estas dos opciones las cuales son rural o urbana.                                                                                                                                                                                                                                                                                                                                            |
| Estado de ánimo                                   | Categórica Nominal | El usuario responderá a una de las cuatro opciones, las cuales son estrés, enojo, depresión y ninguna de las anteriores.                                                                                                                                                                                                                                                                                                     |
| Forma de apoyo                                    | Categórica Nominal | El usuario responderá originariamente una de las seis opciones, las cuales son ayuda financiera, servicio médico y psicológico, refugio y alojamiento, donación de recursos materiales, ayuda voluntaria y no brindé apoyo.                                                                                                                                                                                                  |
| Grado de afectación del ciclón                    | Categórica Ordinal | El usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa nada afectado, y el diez, extremadamente afectado.                                                                                                                                                                                                                                                                                  |
| Nivel socio económico                             | Categórica Ordinal | El usuario responderá obligatoriamente una de las cinco opciones, las cuales son A,B,C,D y E.                                                                                                                                                                                                                                                                                                                                |
| Grado de satisfacción a la respuesta del Gobierno | Categórica Ordinal | El usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa malo y el diez, excelente.                                                                                                                                                                                                                                                                                                          |
| Nivel de preparación ante un fenómeno natural     | Categórica Ordinal | El usuario responderá obligatoriamente a una de las tres opciones, las cuales son mínima, intermedia y avanzada.                                                                                                                                                                                                                                                                                                             |
| Número de personas en la vivienda                 | Numérica Discreta  | El usuario responderá obligatoriamente a una de las diez opciones, las cuales indican respectivamente el número de personas.                                                                                                                                                                                                                                                                                                 |
| Gasto total de los daños                          | Numérica Continua  | El usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |
| Gasto ayuda                                       | Numérica Continua  | El usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |
| Gasto ayuda                                       | Numérica Continua  | el usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |

------------------------------------------------------------------------

# [**3. Limpieza de base de datos**]{.underline}

Todas las encuestas realizadas por estudiantes se encuentran dentro de la plataforma de Google Forms guardadas en la nube. Para poder trabajar con aquellas respuestas fue necesario exportarlas a un formato fácil de manipular: `csv.`

## 3.1 Carga de la base de datos

Para trabajar en este proyecto, definimos la variable `DB` como la responsable de almacenar el dataframe obtenido en formato `csv`, transformado por medio de la librería `readr`, en conjunto con su función de lectura `read.csv()` .

```{r}
# cargar base de datos localizada en directorio actual.
DB <- read.csv("./database.csv")
```

## 3.2 Información inicial

A modo de entender nuestra base de datos, es necesario como primer paso ver la información que ha sido recogida, los tipos de datos, cuántas observaciones (filas) y variables (columnas) están presentes e identificar si existe algún tipo de datos que no corresponde a alguna variable dada, para así corregirlo..

```{r}
# identificar observaciones
ncol(DB)
nrow(DB)

# identificar nombres de variables
colnames(DB)
```

Es así que a partir de las anteriores instrucciones, definimos que nuestra Base de Datos cuenta con 21 columnas y 251 observaciones. Además con el comando `colnames(DB)` obtuvimos un tipo vector con la lista de nombres de cada variable de acuerdo a su posición.

## 3.3 Renombrar columnas

Ahora, que ya conocemos las variables, procedemos a eliminar ciertos carácteres prohubidos ó que interfieren en la limpieza e incluso no cumplen con las *mejores prácticas*. Entre estos criterios, consideramos eliminar tildes, espacios, términos en blanco y signos de pregunta (*Google Forms los transformaba a "X"*). Además consideramos apropiado eliminar la variable de marcaTemporal, la cual guardaba registro del día que se realizó la encuesta, pues no es una variable representativa a nuestro objetivo.

```{r}
# eliminar marca temporal (fecha que se envió la encuesta)
DB$Marca.temporal <- NULL

# leer nombre de columnas actuales
colnames(DB)

# actualizar nombre de columnas respetando criterios mencionados.
colnames(DB) <- c(
  "fueAfectado",
  "carrera",
  "genero",
  "edad",
  "personasEnVivienda",
  "sectorNacimiento",
  "afectoEconomicamente",
  "tuvoProblemaSalud",
  "interrupcionTransporte",
  "interrupcionEducacion",
  "tipoVivienda",
  "tipoLocalidad",
  "animoDurante",
  "animoDespues",
  "formaApoyo",
  "gradoAfectacion",
  "nivelSocioeconomico",
  "satisfaccionRespuestaGobierno",
  "nivelPreparacionFenomeno",
  "gastoDañosCiclon",
  "apoyoAfectados"
)

# verificar que se realizó sobreescritura con éxito.
colnames(DB)
```

## 3.4 Corregir tipos de datos

Ahora, que ya hemos corregido nuestras variables, y es más sencillo el acceder a ellas, procedemos a analizar cada tipo de dato de ellas para corregirlo en caso sea necesario. Para realizar esto evaluamos primero con la función `str(DB)` los tipos actuales, y posteriormente lo actualizamos de acuerdo a nuestro criterio..

```{r}
# actualizar variables con valores correctos
DB$apoyoAfectados <- as.numeric(DB$apoyoAfectados);
DB$gastoDañosCiclon <- as.numeric(DB$gastoDañosCiclon);
DB$satisfaccionRespuestaGobierno <- as.integer(DB$satisfaccionRespuestaGobierno);
DB$gradoAfectacion <- as.integer(DB$gradoAfectacion);
DB$personasEnVivienda <- as.integer(DB$personasEnVivienda);
DB$edad <- as.integer(DB$edad);
DB$sectorNacimiento <- as.character(DB$sectorNacimiento);
DB$genero <- as.character(DB$genero);

# logica para covertir a valores booleanos
DB$interrupcionEducacion <- ifelse(DB$interrupcionEducacion=="Si", TRUE, FALSE);
DB$interrupcionTransporte <- ifelse(DB$interrupcionTransporte=="Si", TRUE, FALSE);
DB$tuvoProblemaSalud <- ifelse(DB$tuvoProblemaSalud=="Si", TRUE, FALSE);
DB$afectoEconomicamente <- ifelse(DB$afectoEconomicamente=="Si", TRUE, FALSE);
DB$fueAfectado <- ifelse(DB$fueAfectado=="Sí", TRUE, FALSE);
```

En el caso expuesto corregimos las variables: *apoyoAfectados, gastoDañosCiclón, satisfaccionRespuestaGobierno, gradoAfectacion, personasEnVivienda, edad, sectorNacimiento, genero.* En su mayoría a variables numéricas, enteras ó del tipo carácter.

Por otro lado para ciertas variables del tipo pregunta binaria, corregimos su tipo a booleanos, pues es más sencillo evaluar un **TRUE**, **FALSE**. Las implicadas son: *interrupcionEducacion, interrupcionTransporte, tuvoProblemaSalud, afectoEconomicamente, fueAfectado.*

## 3.5 Corregir error de NA's

Para verificar si nuestra Base de Datos almacena valores NA es decir, valores no aplicables al tipo de variable, valores vacíos ó valores sin relación con la pregunta. Para ello, primero debemos aclarar que nuestra base de datos tiene una *pregunta filtro*, es la encargada de determinar si el estudiante fue afectado ó no.

A partir de esta pregunta podemos filtrar los NA para estudiantes afectados, por lo que debemos de evaluar esa condición primero. Por otro lado en campo de texto abiertos (el usuario ingresa la data, no la marca) es necesario filtrar aquellos que están vacíos, como es el caso de la variable `gastoDañosCiclon(DB)`.

```{r}
# verificar sobreescritura de datos
summary(DB)
```

## 3.6 Corregir errores con cuantiles

### 3.6.1 Variable gastoDañosCiclón

En el transcurso de nuestro estudio sobre las relaciones y valores, encontramos que el primer cuartil Q1 (25%) y el tercer cuartil Q3 (75%) coinciden. Esto nos permitió deducir que la mayoría de los datos están concentrados en un rango entre S/. 99.25 y S/. 402.5, correspondiente al gasto por daños ocasionados a causa del ciclón Yaku.

```{r}
IQR(DB$gastoDañosCiclon, na.rm=TRUE); # 303.25, se encuentran 50% de datos
quantile(DB$gastoDañosCiclon, 0.25, na.rm = TRUE) # 25% de datos <= 99.25
quantile(DB$gastoDañosCiclon, 0.75, na.rm = TRUE) # 75% de datos <= 402.5
```

Utilizando el diagrama de cajas y bigotes (boxplot), pudimos visualizar esta concentración de datos y la dispersión que existe fuera de este rango. En consecuencia, justificadamente decidimos eliminar los valores atípicos, ya que estos aportaban una variabilidad excesiva que podía distorsionar nuestros análisis.

```{r}
# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoGastoDanosCiclon <- boxplot(DB$gastoDañosCiclon)$out

# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- DB;
DB_FINAL <- subset(DB, !gastoDañosCiclon %in% atipicoGastoDanosCiclon)
```

En el último apartado gracias a nuestra visualización del diagrama **boxplot**, fue posible eliminar valores atípicos, que estaban fuera del rango intercuartil y además no eran representativos, gracias a su eliminación nuestra muestra sigue siendo representativa.

```{r}
cat("* Antes: \n")
summary(DB$gastoDañosCiclon)

cat("* Después: \n")
summary(DB_FINAL$gastoDañosCiclon)
```

-   Antes de la eliminación de los valores atípicos, la media era de $S/. 394.6$ y el valor máximo era de $S/. 4,000$. El primer y tercer cuartil se situaban en $S/. 97.0$ y $S/. 402.0$, respectivamente.

-   Después de eliminar los valores atípicos, la media disminuyó a $S/. 218.1$ y el valor máximo se redujo a $S/. 800$. El primer cuartil disminuyó a $S/. 76.0$ y el tercer cuartil bajó a $S/. 347.0$.

### 3.6.2 Variable apoyoAfectados

En cuanto al apoyo brindado a las personas afectadas por el ciclón Yaku, podemos observar a través de la relación entre los cuartiles y el gráfico boxplot una considerable dispersión de los datos. En este caso, vemos que el 25% de los datos son menores o iguales a S/. 8, mientras que el 75% de los datos son menores o iguales a S/. 333.5.

```{r}
IQR(DB$apoyoAfectados, na.rm=TRUE) # 325.5, se encuentran 50% de datos
quantile(DB$apoyoAfectados, 0.25, na.rm = TRUE) # 25% de datos <= 8
quantile(DB$apoyoAfectados, 0.75, na.rm = TRUE) # 75% de datos <= 333.5
```

Por otro lado, es notable que la cifra de S/. 2000 se encuentra bastante alejada del rango intercuartil, mostrando una alta dispersión. Dada esta observación, estamos justificados en eliminar este valor de nuestra muestra. Esta decisión se toma porque su inclusión podría sesgar o distorsionar nuestro análisis, dado que este valor no parece ser representativo de la mayoría de los datos recogidos.

```{r}
# diagrama de boxplot.
boxplot(DB$apoyoAfectados);

# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoApoyoAfectados <- boxplot(DB_FINAL$apoyoAfectados)$out

# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- subset(DB_FINAL, !apoyoAfectados %in% atipicoApoyoAfectados)
```

Ahora, podemos utilizar la función `summary()` que nos permitirá comparar entre las dos Base de Datos (`DB`, `DB_FINAL`) para la misma variable: `apoyoAfectados`, de esa forma será sencillo notar los cambios que ocasionó la limpieza de boxplot. Además a partir de ello es posible determinar las siguientes conclusiones.

```{r}
cat("* Antes: \n")
summary(DB$apoyoAfectados);

cat("* Después: \n")
summary(DB_FINAL$apoyoAfectados)
```

-   Antes de la eliminación de los valores atípicos, la media era de $S/. 193.1$ y el valor máximo era de $S/. 2000$. El primer y tercer cuartil se situaban en $S/. 4.0$ y $S/. 331.2$, respectivamente.
-   Después de eliminar los valores atípicos, la media se mantuvo prácticamente igual en $S/. 195.2$, y el valor máximo se mantuvo en $S/. 2000$. El primer cuartil aumentó a $S/. 16.0$, y el tercer cuartil aumentó a $S/. 338.0$.

------------------------------------------------------------------------

# [4**. Análisis Descriptivo**]{.underline}

## 4.1 Variable edad

```{r}
TABLA_FINAL <- table(DB_FINAL$edad[!is.na(DB_FINAL$edad)]);
# verificacion 
#frecuencia <- table(edad_no_na)
#valor_mas_repetido <- as.numeric(names(frecuencia)[which.max(frecuencia)])
barplot(
  TABLA_FINAL,
  main = "Edad de los estudiantes de UTEC", 
  xlab = "Edad", 
  ylab = "Frecuencia", 
  col = "lightblue"
)
```

Como se puede apreciar el barplot nos muestra que los estudiantes con mayor frecuencia tienen 19 años. Si bien el gráfico de barras es utilizado para variables categóricas también puede ser empleado para variables numéricas discretas ya que se puede agrupar en rangos o categorías y las barras representan la proporción de cada categoría de está manera este gráfico nos ayuda con la comparación y visualizar tendencias en los datos.

### 4.1.1 Descriptores numéricos

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable edad:', sum(complete.cases(DB_FINAL$edad)),'\n')
boxplot(DB_FINAL$edad, main = "Edad de los estudiantes de UTEC")
```

Es posible notar que el número de observaciones es **237** y el número de casos completos de la variable edad es menor, por lo que la muestra selectiva para el análisis de esta variable es **102** observaciones. Por medio del diagrama de cajas se puede visualizar los outliers aquellos valores poco representativos : estudiantes que tienen 26 años.

### 4.1.2 Estadística general

```{r}
df_edad = DB_FINAL$edad[!is.na(DB_FINAL$edad)];

cat('1. Mediana de la variable edad:',round(median(df_edad, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable edad:',18 ,'\n')
cat('3. Varianza de la variable edad:',round(var(df_edad, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable edad:',round(sd(df_edad, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable edad:', round((sd(df_edad, na.rm=TRUE)/mean(df_edad, na.rm=TRUE))*100,2),'\n')
```

-   A partir de lo realizado podemos mencionar que la mitad de los encuestados tiene una edad mayor o igual que 19 y la otra mitad, menor a este número (*mediana*).
-   La mayor parte de encuestados tiene 19 años de edad. Asimismo, podemos ver que las edades no varían mucho respecto a su media, por lo que las edades de los estudiantes de UTEC tienden a estar agrupados cerca de su media.
-   Además, el coeficiente de variación es 9.47, lo que significa que la variable edad tiene una dispersión baja, así los datos son considerados homogéneos (poca variabilidad).

## 4.2 Variable Género

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$genero);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("Femenino", "Masculino");

pie(
  TABLA_FINAL,
  main = "\n Análisis comparativo del género de los estudiantes \n de UTEC quienes fueron afectados directa ó \n indirectamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

Este tipo de gráfico analiza las variables categóricas , nos muestra la proporción de cada categoría y es fácil de comprender y visualizar los porcentajes y así inferir en un análisis coherente.

De este gráfico de torta se evidencia que la muestra de estudio han participado más **mujeres**, ya que estamos trabajando con 102 observaciones de las cuales 55 fueron del género femenino, a comparación del género masculino que fueron 47.

### 4.2.1 Descriptores numéricos

El número total de observaciones es 205 y el número de casos completos de la variable género es 102, sólo tenemos la mitad de información completa sobre la variable género. Es por ello que aún existe un subconjunto de la muestra que no proporciona información sobre el género de los individuos, por lo que consideramos que esta muestra no es selectiva, pues no representa completamente la población objetivo.

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable género:', sum(nchar(DB_FINAL$genero) > 0),'\n')
```

### 4.2.2 Estadística general

Se visualiza de la variable cualittiva género que de el total de encuestados de nuestro estudio el género más frecuente es el **femenino**

```{r}
categorias <- DB_FINAL$genero[DB_FINAL$genero != ""];
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)];

# obtener cantidad de observaciones del tipo femenino
obs_categoria_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Femenino"]) 
obs_categoria_segunda_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Masculino"]) 

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Género más frecuente:', categoria_mas_frecuente, '\n')
cat('2. Observaciones del género más frecuente:', obs_categoria_frecuente, '\n')
cat('3. Observaciones del género menos frecuente:', obs_categoria_segunda_frecuente, '\n')
```

## 4.3 Variable Sector de Nacimiento

Este gráfico de barras analiza variables categóricas, se puede visualizar las tendencias en los datos y hacer una comparación con ello se obtener una fácil interpretación, por lo que se evidencia que hubieron más encuestados pertenecientes al sector **centro** del país que en nuestro formulario abarcaba los siguientes departamentos:

-   Ancash
-   Lima
-   Ica
-   Huánuco
-   Pasco
-   Junín

```{r}
TABLA<-table(DB_FINAL$sectorNacimiento);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]

# Crear una nueva tabla solo con los elementos no vacíos
TABLA_FINAL <- TABLA[elementos_no_vacios]
# names(TABLA_FINAL) -> Obtener orden de labels.

# Obtener orden de los nombres de las categorías
orden_nombres <- names(TABLA_FINAL)

# Truncar los nombres a la longitud máxima
nombres_cortados <- sapply(strsplit(orden_nombres, " "), function(x) x[[1]])

barplot(
  TABLA_FINAL, 
  main = "Sector de nacimiento de los estudiantes de UTEC",
  xlab = "Sector geográfico",
  ylab = "Frecuencia",
  names.arg = nombres_cortados,
  col = c("lightblue"))
```

### 4.3.1 Descriptores numéricos

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable lugar de residencia:', sum(nchar(DB_FINAL$sectorNacimiento) > 0),'\n') # utilizar nchar pues es character.
```

Lo que se puede inferir del siguiente resultado es que obtenemos valores completos debajo de la mitad de nuestros encuestados , por lo que nuestro estudio carece de información , cierto sesgo en nuestro análisis , lo que afecta a la representatividad en la muestra y no se pueda tener una confiabilidad en los resultados.

### 4.3.2 Estadística general

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$sectorNacimiento[DB_FINAL$sectorNacimiento != ""]
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Categoría más frecuente (MODA) en "sectorNacimiento":', categoria_min, '\n')
```

## 4.4 Variable Fue Afectado

```{r}
DB_FINAL

afectados <- sum(DB$fueAfectado == TRUE)
noAfectados <- sum(DB$fueAfectado == FALSE)


afectadosVector <- c(afectados,noAfectados)
categoria <- c("Sí","No");

tablaAfectados <- data.frame(afectadosVector,categoria)
tablaAfectados$porcentaje <- round(tablaAfectados$afectadosVector / sum(tablaAfectados$afectadosVector) * 100,2)


ggplot(tablaAfectados, 
  col = colores,
       aes(
  x = "", 
  y = afectadosVector, fill = categoria)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(fill = "Respuestas") +
  geom_label(aes(label = paste0(porcentaje, "%")), position = position_stack(vjust = 0.5)) +
  ggtitle("¿Usted fue afectado de manera directa ó indirecta por el ciclón Yaku?") +
  guides(fill = guide_legend(override.aes = list(label = "")))

```

Este tipo de gráficos nos muestra porcentajes y propociones con ello se puede realizar una adecuada interpretación , al ver el gráfico de torta se evidencia que que la mayor parte de nuestros nuestros encuestados respondió que si fue afectado por el ciclón yaku y además se nota que no es mucho la diferencia entre el uno y el otro.

### 4.4.1 Descriptores numéricos

```{r}
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes no fueron afectados:', sum(afectados_df),'\n')
 cat('2. Número de casos completos que los estudiantes fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
```

Se puede observar que al obtener muchos casos incompletos , la afirmación que se de a cierto análisis no sea del todo cierto porque que al haber casos incompletos afecta la representatividad y se obtenga una respuesta no del todo confiable.

### 4.4.2 Estadística general

A partir de los resultados obtenidos, es posible determinar que para la mayoría de encuestados (población) no se vieron afectados directa ó indirectamente por el ciclón Yaku.

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$fueAfectado
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Respuesta más frecuente, para variable "fue afectado":', categoria_min, '\n')
```

## 4.5 Variable Afectado Económicamente

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$afectoEconomicamente);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("No afectados", "Afectados");

pie(
  TABLA_FINAL,
  main = "\n Proporción de estudiantes \n de UTEC que se vieron afectados  \n económicamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

A partir del gráfico de torta se observa la distribución de cada categoría percibiendo así que en mayor proporción los encuestados respondieron que no se vieron afectados económicamente .

### 4.5.1 Descriptores numéricos

```{r}
casos_completos <- complete.cases(DB_FINAL$fueAfectado);
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes afectados:', sum(afectados_df),'\n')
 cat('3. Número de casos completos que los estudiantes que no fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
 
 
porcentaje_afectados = round((sum(afectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes afectados económicamente:', porcentaje_afectados,'%\n')

porcentaje_noafectados = round((sum(noafectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes no afectados económicamente:', porcentaje_noafectados,'%\n')
```

A partir de los resultados de la variable se puede inferir que al tener pocos casos completos en los estudiantes afectados y algunos casos incompletos en los que respondieron no fueron afectados, la credibilidad con respecto a esta variable no sea del todo confiable y los análisis no sean muy verídicos produciendo que se tenga sesgo y distorsión en los resultados . Al tener pocos casos completos hay una falta de robustez, existe un mayor riesgo que los resultados se vean influenciados por outliers o casos extremos.

## 4.6 Variable Gasto total en daños

```{r}
library(ggplot2)
TABLA <- (DB_FINAL$gastoDañosCiclon)

# Filtrar y ajustar los valores de gasto por daños
gasto_danos <- DB_FINAL$gastoDañosCiclon
gasto_danos[gasto_danos < 0] <- 0
gasto_danos[gasto_danos > 800] <- 800

# Crear los rangos de valores
rangos <- cut(gasto_danos, breaks = c(0, 200, 400, 600, 800))

# Crear el data frame para el gráfico
data <- data.frame(Gasto = gasto_danos, Rango = rangos)

# Definir los colores para cada rango
colores <- c("lightblue")

# Crear el histograma con colores agrupados por rangos
hist(
  x = TABLA,
  xlab = "Gasto en soles S/.",
  ylab = "Frecuencia",
  main = "Frecuencia de gasto en soles por daños ocasionados \n por el fenómeno Yaku. ",
  col = colores
)
```

El gráfico de barras nos proporciona un resumen de datos, con ello hacer un análisis comparativo se puede distinguir la barra más sobresaliente entre todas es cuando el gasto se ubica en **0-100**\$ lo que nos da una idea que el gasto en soles ocasionado por el fenómeno Yaku más frecuente no fue muy alto.

### 4.6.1 Descriptores numéricos

```{r}
df_gasto_danos = DB_FINAL$gastoDañosCiclon[!is.na(DB_FINAL$gastoDañosCiclon)];

cat('1. Mediana de la variable gasto daños:',round(median(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable gasto daños:',18 ,'\n')
cat('3. Varianza de la variable gasto daños:',round(var(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable gasto daños:',round(sd(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable gasto daños:', round((sd(df_gasto_danos, na.rm=TRUE)/mean(df_gasto_danos, na.rm=TRUE))*100,2),'\n')
```

A partir de lo obtenido, deducimos que al tener una varianza, coeficiente de variación y desviación de estándar alta nos indica que hay una dispersión con relación a la media y pueden estar dispersos a lo largo del rango , lo que nos podría indicar que existe una gran variabilidad y posiblemente se tenga valores atípicos o extremos en el conjunto de datos.

------------------------------------------------------------------------

# [5. Análisis probabilístico]{.underline}

## 5.1 Probabilidad empírica

### 5.1.1 Fueafectado y Sector de Nacimiento

Para nuestro análisis, empleamos dos variables: "*fueAfectado*" y "*sectorNacimiento*". Esto nos permitirá determinar, de manera probabilística, cuáles sectores de nacimiento de los estudiantes fueron más afectados.

```{r}
tabla_nacimiento <- crosstab(DB_FINAL$fueAfectado,DB_FINAL$sectorNacimiento,plot=FALSE)

tabla_nacimiento
```

Para facilitar nuestro análisis, adoptaremos la siguiente notación: N representará "No fue afectado", mientras que S indicará "Sí fue afectado". Los distintos sectores de nacimiento estarán definidos de la siguiente manera:

```{r}
sum(complete.cases(DB_FINAL)) + sum(!complete.cases(DB_FINAL))
```

-   **L1:** Residencia en Central [*48 veces*]

    ```{r}
    L1 <- round(sum(complete.cases(DB_FINAL[DB_FINAL$sectorNacimiento == "Centro (Ancash, Lima, Ica, Huánuco, Pasco, Junín)",])) / (sum(complete.cases(DB_FINAL)) + sum(!complete.cases(DB_FINAL))),2);

    L1 # 48/237 -> 0.2
    ```

-   **L2:** Residencia en Norte [*28 veces*]

    ```{r}
    L2 <- round(sum(complete.cases(DB_FINAL[DB_FINAL$sectorNacimiento == "Norte (Tumbes, Piura, Lambayeque, La Libertad, Cajamarca)",])) / (sum(complete.cases(DB_FINAL)) + sum(!complete.cases(DB_FINAL))),2);

    L2 # 28/237 -> 0.12
    ```

-   **L3:** Residencia en Oeste [*10 veces*]

    ```{r}
    L3 <- round(sum(complete.cases(DB_FINAL[DB_FINAL$sectorNacimiento == "Oriente (Amazonas, San Martín, Loreto, Ucayali, Madre de Dios)",])) / (sum(complete.cases(DB_FINAL)) + sum(!complete.cases(DB_FINAL))),2);

    L3 # 10/237 -> 0.04
    ```

-   **L4:** Residencia en Sur [*16 veces*]

    ```{r}
    L4 <- round(sum(complete.cases(DB_FINAL[DB_FINAL$sectorNacimiento == "Sur (Arequipa, Moquegua, Tacna, Ayacucho, Huancavelica, Apurímac, Cusco, Puno)",])) / (sum(complete.cases(DB_FINAL)) + sum(!complete.cases(DB_FINAL))),2);

    L4 # 16/102 -> 0.07
    ```

Respecto al análisis, los eventos atómico asociados a Residencia en [Central, Norte, Oeste y Sur] están dados por: "*Seleccionar una persona de Residencia [Central, Norte, Oeste y Sur] en una muestra de tamaño 237*".

Ahora procedemos a realizar el gráfico, para ello con las variables (L1, L2, L3, L4) que obtuvimos anteriormente procederemos a guardarlos en un vector que se plasmará en un gráfico del tipo barplot posteriormente.

```{r}
lista = c(L1, L2, L3, L4)
sectores = c("Central", "Norte", "Oeste", "Sur")
```

```{r}
barplot(
  lista, 
  names.arg = sectores, 
  xlab = "Sector de Nacimiento", 
  ylab = "Probabilidad", 
  main = "Probabilidad de ser afectado por el ciclón Yaku por sector de nacimiento", 
  col = "lightblue"
)
```

Análisis del resultado: Luego de haber calculado mediante probabilidades, obtuvimos que la mayor proporción de estudiantes proporcionados provienen del sector denominado L1, es decir, el sector **Centro** (L1). Este sector abarca los distritos: *Ancash, Lima, Ica, Huánuco, Pasco, Junín*.

### 5.1.2 Edad y Personas en Vivienda

Para nuestro análisis, empleamos dos variables: "edad" y "personasViviendo". Esto nos permitirá saber de manera probabilística la probabilidad que para estudiantes de un cierto rango de edad: 17 a 21 años, vivan en casa con un cierto número de personas (menos de 5). Para ello realizamos el siguiente análisis:

```{r}
db_afectados = DB_FINAL[DB_FINAL$fueAfectado == TRUE, ]

# Estudiantes de 17 a 21 años
estudiantes_rango_edad <- db_afectados %>% filter(edad >= 17, edad <= 21)

# Estudiantes que viven en una casa con mas de 5 personas
estudiantes_condicion <- estudiantes_rango_edad %>% filter(personasEnVivienda <= 5)

# Probabilidad empírica
probabilidad_empirica <- round(nrow(estudiantes_condicion) / nrow(db_afectados), 2)
probabilidad_empirica
```

En este caso obtuvimos $0.56$, es decir según nuestros datos, el $56\%$ de los estudiantes están en un rango entre 17 y 21 años, tal que viven en una casa 5 o menos personas. Por otro lado desarrollamos un gráfico para interpretar esto.

```{r}
# Estudiante vive en una casa con más de 5 personas
db_afectados$vivienda_mas_5 <- ifelse(db_afectados$personasEnVivienda > 5, "Más de 5", "5 o menos")

# Edad del estudiante está entre 17 y 21 años
db_afectados$edad_rango <- ifelse(db_afectados$edad >= 17 & db_afectados$edad <= 21, "17 a 21", "Otro rango")

# Crear el gráfico de barras
ggplot(db_afectados, aes(x = edad_rango, fill = vivienda_mas_5)) +
  geom_bar(position = "dodge") +
  labs(x = "Rango de Edad", y = "Cantidad de Estudiantes", fill = "Personas en Vivienda") +
  ggtitle("Cantidad de Estudiantes por Rango de Edad y Número de Personas en la Vivienda")
```

## 5.2 Probabilidad condicional

### 5.2.1 Grado de Afectación y Nivel de Preparación

Para nuestro análisis, empleamos dos variables: "*fueAfectado*" y "nivelPreparacion". Esto nos permitirá determinar, de manera probabilística, cual fue el grado de afectación más común respecto a las estadísticas y cómo se relaciona con el nivel de preparación de los estudiantes. Acaso estudiantes más preparados tuvieron un menor grado de afectación?. Para ello realizamos nuestra tabla.

$$P(A|B) = \frac{P(A \cap B)}{P(B)}$$

```{r}
DB_FINAL_afectados <- subset(DB_FINAL, fueAfectado == TRUE)
tabla_afectacion <- table(DB_FINAL_afectados$gradoAfectacion, DB_FINAL_afectados$nivelPreparacionFenomeno)

tabla_afectacion
```

A partir de la tabla de contingencia generada como subconjunto de la base de datos donde fueAfectado `fueAfectado == true` , es decir analizar sólo estudiantes afectados, podemos observar fácilmente que las filas representan el grado de afectación (del 1 al 10) y las columnas el tipo de preparación (avanzada, intermedia y mínima). Es así que aquellas fila-columna representan aquellas observaciones que cumplan con esa combinación. Por ejemplo, aquellas personas que registraron un nivel de afectación de nivel "1" contaban con un nivel de preparación "Avanzada".

```{r}
# Probabilidades independientesX
P_A <- round(sum(tabla_afectacion[5,]) / sum(tabla_afectacion), 2) # 0.14
P_B <- round(sum(tabla_afectacion[,"Mínima"]) / sum(tabla_afectacion), 2) # 0.48

P_A * P_B

# Calcular P(A ∩ B)
A_inter_B <- round(tabla_afectacion[5, "Mínima"] / sum(tabla_afectacion), 2) # 0.07

# Calcular P(A|B)
A_given_B <- round(A_inter_B / P_B, 2)
A_given_B

# Independiente
if (A_inter_B == P_A * P_B) {
  print("Los eventos son independientes")
} else {
  print("Los eventos son dependientes")
}
```

Entonce llegamos a la probabilidad de que si seleccionamos aleatoriamente a una persona de un grupo que tienen preparación "Mínima" (total 47) entonces un 15% experimentó un grado de afectación de 5. Esto matemáticamente lo vemos como de un total de 47 personas con preparación mínima, la tabla indica que 7 sufrieron un grado de afectación de 5, por lo que se representa como $7 / 47 \approx 0.15$. Por otro lado se comprueba que los eventos son dependientes, pues se cumple que $P(A \cap B) = P(A) * P(B)$.

En este contexto, significa que la ocurrencia de uno afecta la probabilidad del otro, de modo que el nivel de preparación del estudiante tiene un impacto en el grado de afectación del ciclón. Por el siguiente mapa de calor, nos de acuerdo a todos los afectados encontrar patrones (zonas de calor) dependiendo el nivel de preparación y su grado de afectación.

```{r}
pheatmap(
  tabla_afectacion, 
  angle_col = 45, 
  angle_row = 0
)
```

### 5.2.2 Sexo y estado de ánimo

La siguiente probabilidad está relacionado con uno de nuestros objetivos. ¿De qué manera afecto el ciclón Yaku a los estudiantes? Por medio de esta probabilidad se pretende conocer como afecto su estado de ánimo . en este caso conocer la probabilidad de que una estudiante mujer tenga estrés después de haber ocurrido el fenómeno natural (Yaku). Determinar la probabilidad de que un estudiante sea del sexo femenino si su estado de ánimo fue de estrés después de haber ocurrido el ciclón yaku.

$$P(A|B) = \frac{P(A \cap B)}{P(B)}$$

Se comprueba que si es **independiente** o **dependiente** , por medio de $$P(A \cap B) = P(A) \cdot P(B)$$

Si no se cumple , entonces es dependiente por lo cual para hallar su probalidad se halla de la siguiente manera $P(A / B) = \frac{P(A \cap B)}{P(B)}$. Si fuera independiente , es fácil darse cuenta que se cumple $P(A / B) = P(A)$.

**A=Estudiante del sexo femenino** , y **B=Estudiante con estrés después de haber ocurrido el ciclón yaku**.

```{r}
## Calcular P(A)
PA <- round(table(DB_FINAL$genero)/nrow(DB_FINAL),digits=2)["Femenino"] # -> 0.23
## Calcular P(B)
PB <- round(table(DB_FINAL$animoDespues)/nrow(DB_FINAL),digits=2)["Estrés"] # -> 0.08
## Calcular C 
C <- PA*PB     # -> 0.0184

# Calcular P(A ∩ B)
P1 <- nrow(DB_FINAL[DB_FINAL$genero == "Femenino" & DB_FINAL$animoDespues == "Estrés",]) / nrow(DB_FINAL)

# Imprimir en consola que son distintos C != P1
cat(C, " != ", P1)
```

Se comprueba que la probabilidad es dependiente ya que $P(A)P(B) = 0.0184$ es diferente a $P(A \cap B) = 0.0375$. Como sabemos que la fórmula para hallar una probabilidad condicional es: $P(A|B)=P(A ∩ B)/P(B)$.

```{r}
# P(A|B)=P(A ∩ B)/P(B):
P <- round(P1/PB, digits = 2)  # ->  0.47
```

Rpta : Se obtiene que la probabilidad de que una estudiante sea mujer y si tuvo estrés después de haber ocurrido el ciclón yaku es de **0.47**.

### 5.2.3 Estudiante, Lugar de Residencia y Preparación

La siguiente probabilidad está relacionado con uno de nuestros objetivos. Evaluar la preparación de los estudiantes de la UTEC ante un fenómeno natural .Por medio de esta probabilidad se pretende conocer la preparación avanzada de los estudiantes pertenecientes al lugar de residencia Centro ante un fenómeno natural. Determinar la probabilidad de que un estudiante pertenezca al lugar de residencia Centro si su preparación de nivel de preparación ante un fenómeno natural fue avanzado.

**A=Estudiante perteneciente al lugar de residencia Centro** y **B= Estudiante con nivel de preparación avanzada ante un fenómeno natural**

Primero se busca saber si la probabilidad es independiente o dependiente mediante $P(A \cap B) = P(A) \cdot P(B)$.

```{r}
## Calcular P(A)
PA1 <- round(table(DB_FINAL$sectorNacimiento)/nrow(DB_FINAL),digits=2)["Centro (Ancash, Lima, Ica, Huánuco, Pasco, Junín)"] # -> 0.21

## Calcular P(B)
PB1 <- round(table(DB_FINAL$nivelPreparacionFenomeno)/nrow(DB_FINAL),digits=2)["Avanzada"] # -> 0.08

## Calcular C1 

C1 <- PA1*PB1     # -> 0.0168

# Calcular P(A ∩ B)
P2 <- nrow(DB_FINAL[DB_FINAL$sectorNacimiento == "Centro (Ancash, Lima, Ica, Huánuco, Pasco, Junín)" & DB_FINAL$nivelPreparacionFenomeno == "Avanzada",]) / nrow(DB_FINAL)


# Imprimir en consola que son distintos C != P1
cat(C1, " != ", P2)

```

Se comprueba que la probabilidad es dependiente ya que $P(A)P(B) = 0.01684$ es diferente a $P(A \cap B) = 0.03333$. Como sabemos que la fórmula para hallar una probabilidad condicional es: $P(A|B)=P(A ∩ B)/P(B)$,

```{r}
# P(A|B)=P(A ∩ B)/P(B):
P <- round(P2/PB1, digits = 2)  # ->  0.42
```

Rpta : Se obtiene que la probabilidad de que una estudiante con lugar de residencia Centro y si tuvo una preparación avanzada ante un fenómeno natural es de **0.42**.

------------------------------------------------------------------------

## 5.3 Variable Discreta

### 5.3.1 Variable *fueAfectado*

#### 5.3.1.1 Distribución Binomial

La variable fueAfecta es una variable *dicotómica*, es decir que sólo tiene dos posibles valores. Por ello se adapta al modelo de distribución binomial (*si/no*). Es así que respecto a los $240$ alumnos de la UTEC que fueron entrevistados, incluimos una pregunta *filtro* que nos permitía saber si fue afectado o no.

Para ello acudimos a nuestra base de datos, pues necesitamos calcilar la probabilidad de éxito $p$, que nos indica cuál es la proporción de estudiantes que fueron afectados. En este caso $p$ está definido como $0.43$.

Ahora, ya contamos tanto con $p$, como con $n$, por lo que es hora de hallar la probabilidad de que $x$ estudiantes hayan sido afectados utilizando la función de distribución binomial, en R. En este caso $x=10$, por lo que estamos buscando la probabilidad de que $10$ estudiantes hayan sido afectados.

$$
X\:~\:DBinom\left(x,n,p\right) \\
X\:~\:Binom\left(10,240,0.43\right)
$$

```{r}
# Asegúrate de que 'fueAfectado' es numérico
afectado_numeric <- as.numeric(DB_FINAL$fueAfectado)

summary(afectado_numeric)

# probabilidad de exito
p <- mean(afectado_numeric, na.rm = TRUE)

# numero de ensayos
n <- sum(!is.na(afectado_numeric))

# probabilidad de que 100 estudiantes han sido afectados
x <- 100

# distribucion binomial
prob <- round(dbinom(x, size=n, prob=p), 3)
prob
```

-   $X$ : Cantidad de Alumnos de la UTEC que se vieron afectados por el fenómeno natural Yaku.

-   $n$ : 240 encuestados totales.

-   $x$ : Probabilidad que 10 alumnos se vieron vieron afectados por el fenómeno Yaku.

-   $p$ : Probabilidad de éxito que un estudiante se viera afectado por el fenómeno Yaku.

```{r}
range = 0:n

barplot(dbinom(range, size = n, prob = p), 
        names.arg = range, 
        main = "Distribución binomial de 'fueAfectado'", 
        xlab = "Cantidad de estudiantes afectados", 
        ylab = "Probabilidad"
        )
```

En conclusión el gráfico de la **distribución binomial** muestra que la cantidad de estudiantes afectados más probables están enmarcados en el rango de $73$ a $125$ aproximadamente. Los números fuera de este rango tienen una probabilidad muy baja. No obstante, determinamos que si entrevistamos a 240 estudiantes, el número **más probable** de estudiantes afectados es aproximadamente $104$, pues representa el producto de $n \cdot p$: el tamaño de la muestra por la probabilidad de éxito.

### 5.3.2 Variable *tuvoProblemaSalud*

#### 5.3.2.1 Distribucion Geométrica

En este caso, la distribución geométrica en una distribución de probabilidad discreta busca que a partir de una serie de ensayos (*experimentos*) seamos capaces de saber cuántos debemos realizar antes de obtener nuestro primer éxito, dicho así hemos obtado por la variable *tuvoProblemaSalud*, pues lo podemos interpretar como un éxito (tuvo problema de salud) ó fallo (no tuvo problema salud) de manera binaria. A continuación hallaremos cada uno de los elementos de la distribución geométrica.

$$X\:~\:DGeom\left(x-1,p\right)$$

$$X\:~\:DGeom\left(10 - 1, 0.196\right)$$

```{r}
# determinar 1 si es exito, para fallo definimos 0 
DB_FINAL$tuvoProblemaSalud_binario <- ifelse(DB_FINAL$tuvoProblemaSalud == TRUE, 1, 0);

# probabilidad de exito
p <- round(mean(DB_FINAL$tuvoProblemaSalud_binario), 4) # 0.196

# probabilidad geometrica
x <- 10

prob <- round(dgeom(x - 1, p), 4) # 0.0275
```

-   $X$ : Cantidad de Alumnos de la UTEC que tuvieron problemas de salud durante el fenómeno natural Yaku.

-   $p$ : Probabilidad de éxito que un estudiante tuviera problemas de salud por el fenómeno Yaku.

-   $x$: Probabilidad que el primer estudiante que tuvo un problema de salud ocurra en el 10º estudiante entrevistado.

```{r}
barplot(dgeom(0:50, p), names.arg = 0:50, 
        main = "Distribución geométrica de 'tuvoProblemaSalud'", 
        xlab = "Número de estudiantes entrevistados antes del primer problema de salud", 
        ylab = "Probabilidad")
```

En conclusión, la probabilidad más alta está en 0 alumnos entrevistados **antes del primer problema de salud**, lo que significa que es más probable que el **primer estudiante** entrevistado haya tenido un problema de salud. A medida que el número de estudiantes entrevistados **antes** del primer problema de salud aumenta, la probabilidad disminuye, lo cual es consistente con la forma de la distribución geométrica.

------------------------------------------------------------------------

## 5.4 Variable Aleatoria Continua

### 5.4.1 Análisis de variable Gasto de daños por el Ciclón

```{r}
gasto_ciclon <- as.numeric(DB_FINAL$gastoDañosCiclon)
```

Para proceder debemos eliminar filas con valores faltantes

```{r}
gasto_ciclon <- na.omit(gasto_ciclon)
```

A continuación, vamos a hacer un resumen estadístico de la variable usando *summary*.

```{r}
summary(gasto_ciclon)
```

-   En este caso el rango que toma la variable aleatoria continua está enmarcado entre los límites $[0.0, 800.0]$.

Gráfico de densidad para el Grado de Afectación

```{r}
pdf_densidad <- density(gasto_ciclon, na.rm = TRUE)

plot(
  pdf_densidad, 
  main = "Gráfico de densidad de gastoDañosCiclon",
  xlab="Gasto de daño por ciclon",
  ylab="Densidad de probabilidad"
)
```

```{r}
# Calcular la densidad
densidad <- density(DB_FINAL$gastoDañosCiclon, na.rm = TRUE)

# Crear el histograma
hist(DB_FINAL$gastoDañosCiclon, main = "Histograma y densidad de gastoDañosCiclon", xlab = "Gasto daños por el ciclón (Nuevos soles)", freq = FALSE, col = "lightblue")

# Agregar la curva de densidad al gráfico
lines(densidad, col = "red")
```

Validamos si la media se aproxima a la mediana

```{r}
media <- round(mean(gasto_ciclon), 3)
mediana <- round(median(gasto_ciclon), 3)
cat("Media:", media, "\n")
cat("Mediana:", mediana, "\n")
```

La media con un valor de $220.223$ nos proporciona una medida de la ubicación central de los datos de *gastoDañosCiclón* y la mediana que tiene un valor de $200$ nos proporciona el valor que divide la distribución en dos partes iguales, siendo útil para evaluar si los datos están **sesgados**, y podemos comprobar que no se aproximan porque la diferencia es grande y esto implica que está sesgada hacia la derecha (positivamente sesgada). significa que hay valores más altos en el extremo derecho de la distribución que están influyendo en el valor promedio (media) y desplazando su valor hacia arriba. La mediana, por otro lado, representa el valor en el centro de la distribución, y como es más bajo que la media, indica que la mitad de los datos está por debajo de ese valor.

seguimos validando y calculamos la varianza utilizando la fórmula de $sd^{2}$

```{r}
varianza <- sd(gasto_ciclon)^2
cat("Varianza:", varianza, "\n")
```

Ahora, necesitamos calcular la esperanza (*media*)

```{r}
esperanza <- mean(gasto_ciclon)
cat("Esperanza:",esperanza, "\n")
```

Al hallar la esperanza observamos que si cumple con la aproximación a la media esto implica que los valores de la variable se distribuyen simétricamente alrededor de este valor promedio.

```{r}

media <- mean(gasto_ciclon)
sd <- sd(gasto_ciclon)

cat("Parámetros de la variable gastoDañosCiclon:\n")
cat("Media (mu):", media, "\n")
cat("Desviación Estándar (sigma):", sd, "\n")

```

En este ejemplo, los encuestados gastaron en promedio $220.223$ soles S/. en daños causados por el ciclón con una mediana de $200$ unidades y una considerable variabilidad de gastos.

#### 5.4.1.1 Ejercicios con variable gasto de daños

-   Determinar la probabilidad de que el gasto por los daños ocasionados por el ciclón Yaku sea de 100 o menos soles. En este caso, P(X \<= 100)

    ```{r}
    pnorm(100, mean=media, sd= sd) # 23%
    ```

<!-- -->

-   Determinar probabilidad de que el gasto por los daños ocasionados por el ciclón yaku sea mayor a 500 soles. P(X \>= 5000)

    ```{r}
    (1 - pnorm(500, mean=media, sd=sd)) * 100 # 5 %
    ```

### 5.4.2 para la Variable Edad Gasto Ayuda

```{r}
DB$apoyoAfectados <- as.integer(DB$apoyoAfectados)
```

Para proceder debemos eliminar filas con valores faltantes

```{r}
DB <- na.omit(DB)
```

A continuación, vamos a hacer un resumen estadístico de la variable usando *summary*.

```{r}
summary(DB_FINAL$apoyoAfectados)
```

Gráfico de densidad para el Grado de Afectación

```{r}
densidad <- density(DB_FINAL$apoyoAfectados, na.rm = TRUE)
plot(densidad, main = "Gráfico de densidad de apoyoAfectados")
```

```{r}
# Calcular la densidad
densidad <- density(DB_FINAL$apoyoAfectados, na.rm = TRUE)

# Graficar el histograma
hist(DB_FINAL$apoyoAfectados, main = "Histograma y densidad de apoyoAfectados", xlab = "Apoyo a los damnificados (Nuevos soles)", freq = FALSE, ylim = c(0, max(densidad$y)), col = "aquamarine2")

# Agregar la densidad al gráfico
lines(densidad, col = "red")
```

Validamos si la media se aproxima a la mediana

```{r}
media <- round(mean(DB$apoyoAfectados), 3)
mediana <- round(median(DB$apoyoAfectados), 3)
cat("Media:", media, "\n")
cat("Mediana:", mediana, "\n")
```

La media con un valor de \$194.701 \$ nos proporciona una medida de la ubicación central de los datos de *apoyoAfectados* y la mediana que tiene un valor de \$112 \$ nos proporciona el valor que divide la distribución en dos partes iguales, siendo útil para evaluar si los datos están **sesgados**, y podemos comprobar que tampoco se aproximan estos datos. Para ello seguiremos calculamos la varianza utilizando la fórmula de $sd^{2}$

$$
V(X) = sd^2(Variable)
$$

```{r}
varianza <- sd(DB$apoyoAfectados)^2
cat("Varianza:", varianza, "\n")
```

Ahora, necesitamos calcular la esperanza (*media*)

```{r}
esperanza <- mean(DB$apoyoAfectados)
cat("Esperanza:",esperanza, "\n")
```

```{r}

mu <- mean(DB$apoyoAfectados)
sigma <- sd(DB$apoyoAfectados)

cat("Parámetros de la variable Edad:\n")
cat("Media (mu):", mu, "\n")
cat("Desviación Estándar (sigma):", sigma, "\n")

```

Determinar la probabilidad de que el monto de ayuda brindado por una persona a los damnificados por el ciclón Yaku sea minimo a 500 soles?

Determinar que tan probable una persona ha ayudado a los afectados por el yaku con un minimo de 500 soles. P(X\>=500)

```{r}
1-pnorm(500,194.7009,241.0878)
```

# [**6. Bibliografía**]{.underline}

-   Redacción Gestión.29 de Marzo del 2023. ¿Qué es el ciclón Yaku y por qué afecta a la costa de Perú?.Gestión. <https://gestion.pe/peru/ciclon-yaku-que-es-y-como-se-genera-peru-nnda-nnlt-noticia/?outputType=amp>
