---
title: "R Notebook"
output:
  pdf_document: 
    fig_caption: yes
    highlight: espresso
    toc_depth: 4
  html_document:
    df_print: paged
---

------------------------------------------------------------------------

### [Información]{.underline}

-   **Universidad:** *Universidad de Ingeniería y Tecnología - UTEC*
-   **Docente:** *Muñoz Grados de Flores, Jessica Cleofe*
-   **Curso:** *Estadística y Probabilidades I*

### [Integrantes del equipo]{.underline}

-   *Román Felix, Valery Patricia - 202210617*
-   *Allaucca Huaripaucar, Rocio Celina - 202120068*
-   *Bruce Jair Apaza Isidro - 202120083*
-   *Lazo Mera, Kalos Brayan - 202210184*
-   *Adrian Antonio Auqui Perez - 202120101*

### [Librerías utilizadas]{.underline}

```{r}
library(readr)
library(dplyr)
library(ggplot2)
```

------------------------------------------------------------------------

### [Tema]{.underline}

*El impacto del ciclón Yaku en los estudiantes de la Universidad de Ingeniería y Tecnología. Lima, abril 2023*

### [Objetivos]{.underline}

1.  Conocer la situación en la que se encuentran los estudiantes de UTEC después del fenómeno natural Yaku.
2.  Determinar el porcentaje de cuántos alumnos fueron afectados.
3.  Conocer los departamentos más afectado por el fenómeno natural (Yaku).
4.  Determinar si los estudiantes de UTEC se vieron afectados con sus estudios a partir del fenómeno natural Yaku y si afectó su estado de ánimo.
5.  Conocer la actitud que tomaron los estudiantes ante el ciclón Yaku
6.  Conocer de qué forma afectó el ciclón Yaku a los estudiantes de la UTEC.
7.  Evaluar la respuesta por parte del Gobierno y Organizaciones de ayuda frente a daños causados por el ciclón Yaku.
8.  Evaluar la preparación de los estudiantes de la UTEC ante un fenómeno natural.
9.  Determinar si los estudiantes de UTEC tuvieron perdidas materiales, econÓmicas y ambientales a causa del ciclón Yaku.

------------------------------------------------------------------------

### [Relevancia]{.underline}

Los estudiantes atravesaron momentos difíciles con la llegada del ciclón "yaku" , si bien no todos salieron afectados directamente, muchos quizás tienen familiares que sí han sido muy afectados por este fenómeno natural. La llegada de este ciclón pudo haber afectado a los estudiantes ya sea económicamente, psicológicamente o físicamente. Con este proyecto lo que se busca es tener un panorama de cómo y de qué manera fueron afectados los estudiantes de UTEC y puede servir para que en un futuro las autoridades o los mismos ciudadanos prevean este tipo de situaciones y no terminen repercutiendo muchos daños en la sociedad.

------------------------------------------------------------------------

### [Factibilidad]{.underline}

El proyecto es factible porque para la obtención de información necesaria se tendrá como población a los estudiantes de UTEC y para su obtención de datos se hará uso de formularios de google enviando a los grupos de telegram , whatsapp o por medio de un QR . Además este proyecto no tiene costo alguno ya que se hará uso del Rstudio , las variable a utilizar son las cualitativas y cuantitativas.

------------------------------------------------------------------------

### [Planificación]{.underline}

```{r}
planificacion <- data.frame(
  actividad = c("Planificacion del Tema y Objetivos a tratar","Creacion de la Encuesta Virtual","Recoleccion de datos por medio de la Encuesta Virtual", "Informe Final"),
  inicio = as.Date(c("2023-04-03","2023-04-17","2023-04-24","2023-05-08")),
  fin = as.Date(c("2023-04-10","2023-04-24","2023-05-05","2023-05-15"))
)

ggplot(planificacion, aes(y = actividad, x = inicio, xend = fin, yend = actividad, color = actividad)) +
  geom_segment(linewidth = 10) +
  scale_x_date(labels = scales::date_format("%Y-%m-%d")) +
  labs(title = "Planificación en Lapsos de Tiempo", x = "Fecha", y = "Actividad") +
  theme_minimal() +
  guides(color = "none")
```

------------------------------------------------------------------------

### [Datos]{.underline}

#### *1. Recolección de datos*

Los datos se obtendrán por medio de encuestas , estas fueron hechas por medio de google forms. El propósito de estás encuestas es conocer el impacto que tuvo el ciclón Yaku en los estudiantes de la Universidad de Ingeniería y Tecnología. Para conseguir los datos se envió de forma masiva a la comunidad estudiantil de pregrado de UTEC por medio de grupos de whatsapp y así obtener las variables que conformarían nuestra base de datos, también aprovechando la cercanía con los estudiantes se hace uso del QR con ello se facilita el acceso a nuestro formulario y conseguir las 150 observaciones.

#### *2. Población, muestra y muestreo*

##### 2.1 Muestra

La población viene a ser los estudiantes de la Universidad de Ingeniería y Tecnología, por lo que nuestra muestra proviene de estos estudiantes. Se puede especificar que nuestra muestra es todos los estudiantes que respondieron de manera adecuada nuestra encuesta. Se pretende conseguir una \*\*unidad muestral\*\* de un total de 200 personas en este caso serían los estudiantes de UTEC.

##### 2.2 Muestreo

Se puede afirmar que nuestra muestra es representativa ya que se obtiene datos de los estudiantes de diferentes carreras con edades diferentes , además con diferentes puntos de vista logrando tener una mayor información y una idea sobre el impacto del ciclón yaku hacia los estudiantes de UTEC.

### *3. Variables*

-   **Carrera**: Es una variable categórica nominal y su restricción es que solo el usuario responderá obligatoriamente 1 de las 12 opciones las cuales son Administración y Negocios Digitales, Bioingeniería, Ciencia de Datos, Ciencia de la Computación, Ingeniería Civil, Ingeniería de la Energía, Ingeniería Mecánica, Ingeniería Ambiental, Ingeniería industrial, Ingeniería electrónica, Ingeniería Química e Ingenería Mecatrónica.
-   **Género**: Es una variable categórica nominal y su restricción es que solo el usuario responderá obligatoriamente una de las dos opciones, que son femenino o masculino.
-   **Lugar Residencial:** Es una variable categórica nominal y su restricción es que solo el usuario responderá obligatoriamente una entre estas opciones:
-   **División política:**
    -   Norte (Tumbes, Piura, Lambayeque, La Libertad)
    -   Centro (Ancash, Lima, Ica, Junín, Huancavelica, Pasco)
    -   Sur (Arequipa, Moquegua, Tacna, Ayacucho, Apurímac, Cusco, Puno)
    -   Oriente (Loreto, Ucayali, Madre de Dios).
-   **De qué forma le afectó:** Es una variable catégorica nominal y lo dividimos en cuatro preguntas para que respondan sí o no
-   **Tipo de vivienda:** Es una variable categórica nominal y su restricción es que solo el usuario responderá obligatoriamente una de las tres opciones, las cuales son casa, departamento y otro.
-   **Localidad:** Es una variable categórica nominal y su restricción es que solo el usuario responderá una entre estas dos opciones las cuales son rural o urbana.
-   **Estado de ánimo:** Es una variable categórica nominal y su restricción es que solo el usuario responderá a una de las cuatro opciones, las cuales son estrés enojo, depresión y ninguna de las anteriores.
-   **Forma de apoyo:** Es una variable categórica nominal y su restricción es que solo el usuario responderá originariamente una de las seis opciones, las cuales son ayuda financiera, servicio médico y psicológico, refugio y alojamiento, donación de recursos materiales, ayuda voluntaria y no brindé apoyo.
-   **Grado de afectación del ciclón:** Es una variable categórica ordinal y su restricción es que el usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa nada afectado, y el diez, extremadamente afectado.
-   **Nivel socio económico:** Es una variable categórica ordinal y su restricción es que el usuario responderá obligatoriamente una de las cinco opciones, las cuales son A,B,C,D y E.
-   **Grado de satisfacción a la respuesta del Gobierno:** Es una variable categórica ordinal y su restricción es que el usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa malo y el diez, excelente.
-   **Nivel de preparación ante un fenómeno natural:** Es una variable categórica ordinal y su restricción es que el usuario responderá obligatoriamente a una de las tres opciones, las cuales son mínima, intermedia y avanzada.
-   **Edad:** Es una variable numérica discreta y su restricción es que el usuario responderá obligatoriamente y el número sea un entero no negativo.
-   **Número de personas en la vivienda:** Es una variable numérica discreta y su restricción es que el usuario responderá obligatoriamente a una de las diez opciones, las cuales indican respectivamente el número de personas.
-   **Gasto total de los daños:** Es una variable numérica continua y su restricción es que el usuario responderá obligatoriamente y que el monto sea en nuevos soles.
-   **Gasto ayuda:** Es una variable numérica continua y su restricción es que el usuario responderá obligatoriamente y que el monto sea en nuevos soles.

#### *4. Limpieza de datos*

#### 4.1 Carga de la base de datos

Vamos a cargar la base de datos en formato csv, exportado a través del GoogleForms

```{r}
# cargar base de datos localizada en directorio actual.
DB <- read.csv("./database.csv")
```

#### 4.2 Renombrar columnas

```{r}
# eliminar marca temporal (fecha)
DB$Marca.temporal <- NULL
# leer columnas actuales
colnames(DB);

# pasar vector con nombre de nuevas columnas
colnames(DB) <- c(
  "fueAfectado",
  "carrera",
  "genero",
  "edad",
  "personasEnVivienda",
  "sectorNacimiento",
  "afectoEconomicamente",
  "tuvoProblemaSalud",
  "interrupcionTransporte",
  "interrupcionEducacion",
  "tipoVivienda",
  "tipoLocalidad",
  "animoDurante",
  "animoDespues",
  "formaApoyo",
  "gradoAfectacion",
  "nivelSocioeconomico",
  "satisfaccionRespuestaGobierno",
  "nivelPreparacionFenomeno",
  "gastoDañosCiclon",
  "apoyoAfectados"
);

# verificar sobreescritura
colnames(DB)
```

#### 4.3 Corregir tipos de datos

```{r}
# verificar tipos de datos
str(DB)

# sobreescribir valores correctos
DB$apoyoAfectados <- as.numeric(DB$apoyoAfectados);
DB$gastoDañosCiclon <- as.numeric(DB$gastoDañosCiclon);
DB$satisfaccionRespuestaGobierno <- as.integer(DB$satisfaccionRespuestaGobierno);
DB$gradoAfectacion <- as.integer(DB$gradoAfectacion);
DB$personasEnVivienda <- as.integer(DB$personasEnVivienda);
DB$edad <- as.integer(DB$edad);
DB$sectorNacimiento <- as.character(DB$sectorNacimiento);
DB$genero <- as.character(DB$genero);

# logica para covertir a valores booleanos
DB$interrupcionEducacion <- ifelse(DB$interrupcionEducacion=="Si", TRUE, FALSE);
DB$interrupcionTransporte <- ifelse(DB$interrupcionTransporte=="Si", TRUE, FALSE);
DB$tuvoProblemaSalud <- ifelse(DB$tuvoProblemaSalud=="Si", TRUE, FALSE);
DB$afectoEconomicamente <- ifelse(DB$afectoEconomicamente=="Si", TRUE, FALSE);
DB$fueAfectado <- ifelse(DB$fueAfectado=="Sí", TRUE, FALSE);
```

#### *5. Corregir datos atípicos*

#### 5.1 Corregir error de NA's

```{r}
# Encontrar columna donde fue afectado y los gastos son N.A
filNA <- which(DB$fueAfectado == TRUE & (is.na(DB$gastoDañosCiclon)))
# Eliminar fila atipica en la base de datos
DB <- DB[-filNA, ]
```

```{r}
# Verificar sobreescritura de datos
summary(DB)
```

#### 5.2 Corregir errores con cuantiles

Realizando un estudio acerca de las relaciones y valores que coincide tanto el primer cuartil Q1(25%) y tercer cuartil Q3(75%) podemos deducir que la mayoría de datos están concentrados en un rango entre S/. 99.25 y S/. 402.5 para la cantidad de gasto por daños ocasionados tras el ciclón Yaku. De esta forma usando boxplot (diagrama de cajas y bigotes) podemos realizar la eliminación de estos valores atípicos \*\*justificadamente\*\*, pues existe mucha dispersión entre ellos.

```{r}
# ===: variable gastoDañosCiclon
IQR(DB$gastoDañosCiclon, na.rm=TRUE); # 303.25, se encuentran 50% de datos
quantile(DB$gastoDañosCiclon, 0.25, na.rm = TRUE) # 25% de datos <= 99.25
quantile(DB$gastoDañosCiclon, 0.75, na.rm = TRUE) # 75% de datos <= 402.5
# diagrama de boxplot para variables a observar.
boxplot(DB$gastoDañosCiclon);
# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoGastoDanosCiclon <- boxplot(DB$gastoDañosCiclon)$out
# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- DB;
DB_FINAL <- subset(DB, !gastoDañosCiclon %in% atipicoGastoDanosCiclon)
```

Para el caso de apoyo a afectados por el ciclón Yaku, es posible notar por la relación de los cuartiles y el gráfico boxplot que existe una gran dispersión de datos, donde 25% son menores iguales a S/. 8 y 75% menores iguales a S/. 333.5. Por otro lado podemos notar que la cantidad S/. 2000 es sumamente dispersa del rango intercuartil, por lo que \*\*justificadamente\*\* podemos eliminarla de la muestra, ya que no es representativa.

```{r}
# ===: variable apoyoAfectados
IQR(DB$apoyoAfectados, na.rm=TRUE); # 325.5, se encuentran 50% de datos
quantile(DB$apoyoAfectados, 0.25, na.rm = TRUE) # 25% de datos <= 8
quantile(DB$apoyoAfectados, 0.75, na.rm = TRUE) # 75% de datos <= 333.5
# diagrama de boxplot para variables a observar.
boxplot(DB$apoyoAfectados);
# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoApoyoAfectados <- boxplot(DB_FINAL$apoyoAfectados)$out
# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- subset(DB_FINAL, !apoyoAfectados %in% atipicoApoyoAfectados)
```

```{r}
# mostrar summary, después de eliminación de datos atipicos.
cat("===: COMPARACIÓN -> APOYO AFECTADOS\n\n");
cat("\n* Antes \n");
summary(DB$apoyoAfectados);
cat("\n* Después\n")
summary(DB_FINAL$apoyoAfectados)

cat("\n\n===: COMPARACIÓN -> GASTO DAÑOS")
cat("\n* Antes\n")
summary(DB$gastoDañosCiclon)
cat("\n* Después\n")
summary(DB_FINAL$gastoDañosCiclon)
```

------------------------------------------------------------------------

### [Análisis descriptivo]{.underline}

#### [1. Edad]{.underline}

#### 1.1 Análisis multivariado

Gracias al siguiente gráfico, podemos mencionar que la mayor parte de encuestados tiene 18 años.

```{r}
TABLA_FINAL <- table(DB_FINAL$edad[!is.na(DB_FINAL$edad)]);
# verificacion 
#frecuencia <- table(edad_no_na)
#valor_mas_repetido <- as.numeric(names(frecuencia)[which.max(frecuencia)])
barplot(
  TABLA_FINAL,
  main = "Edad de los estudiantes de UTEC", 
  xlab = "Edad", 
  ylab = "Frecuencia", 
  col = "lightblue"
)
```

#### 1.2 Descriptores numéricos

Es posible notar que el número de observaciones es **237** y el número de casos completos de la variable edad es menor, por lo que la muestra selectiva para el análisis de esta variable es **102** observaciones.

Por otro lado, gracias a el diagrama caja bigotes podemos observar que existen valores extremos poco representativos: aquellos estudiantes que tienen 26 años.

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable edad:', sum(complete.cases(DB_FINAL$edad)),'\n')
boxplot(DB_FINAL$edad, main = "Edad de los estudiantes de UTEC")
```

```{r}
boxplot(DB_FINAL$edad, main = "Edad de los estudiantes de UTEC")
```

#### 1.3 Datos estadísticos generales

-   A partir de lo realizado podemos mencionar que la mitad de los encuestados tiene una edad mayor o igual que 19 y la otra mitad, menor a este número (*mediana*).

<!-- -->

-   La mayor parte de encuestados tiene 19 años de edad. Asimismo, podemos ver que las edades no varían mucho respecto a su media, por lo que las edades de los estudiantes de UTEC tienden a estar agrupados cerca de su media.
-   Además, el coeficiente de variación es 9.47, lo que significa que la variable edad tiene una dispersión baja, así los datos son considerados homogéneos (poca variabilidad).

```{r}
df_edad = DB_FINAL$edad[!is.na(DB_FINAL$edad)];

cat('1. Mediana de la variable edad:',round(median(df_edad, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable edad:',18 ,'\n')
cat('3. Varianza de la variable edad:',round(var(df_edad, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable edad:',round(sd(df_edad, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable edad:', round((sd(df_edad, na.rm=TRUE)/mean(df_edad, na.rm=TRUE))*100,2),'\n')
```

------------------------------------------------------------------------

#### [2. Género]{.underline}

#### 2.1 Análisis multivariado

De este gráfico de barras se evidencia que la muestra de estudio han participado más **mujeres**, ya que estamos trabajando con 102 observaciones de las cuales 55 fueron del género femenino, a comparación del género masculino que fueron 47.

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$genero);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("Femenino", "Masculino");

pie(
  TABLA_FINAL,
  main = "\n Análisis comparativo del género de los estudiantes \n de UTEC quienes fueron afectados directa ó \n indirectamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

#### 2.2 Descriptores numéricos

Si el número total de observaciones es 205 y el número de casos completos de la variable género es 102, sólo tenemos la mitad deinformación completa sobre la variable género. Es por ello que aún existe un subconjunto de la muestra que no proporciona información sobre el género de los individuos, por lo que consideramos que esta muestra no es selectiva, pues no representa completamente la población objetivo.

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable género:', sum(nchar(DB_FINAL$genero) > 0),'\n')
```

#### 2.3 Datos estadísticos generales

La variable género es una variable cualitativa por lo que se determina que el género más frecuente en el estudio es femenino.

```{r}
categorias <- DB_FINAL$genero[DB_FINAL$genero != ""];
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)];

# obtener cantidad de observaciones del tipo femenino
obs_categoria_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Femenino"]) 
obs_categoria_segunda_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Masculino"]) 

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Género más frecuente:', categoria_mas_frecuente, '\n')
cat('2. Observaciones del género más frecuente:', obs_categoria_frecuente, '\n')
cat('3. Observaciones del género menos frecuente:', obs_categoria_segunda_frecuente, '\n')
```

------------------------------------------------------------------------

#### [3. Lugar residencial]{.underline}

#### 3.1 Análisis multivariado

De este gráfico de barras se evidencia que hubieron mas encuestados pertenecientes al sector **centro** del país que en nuestro formulario abarcaba los siguientes departamentos:

-   Ancash
-   Lima
-   Ica
-   Huánuco
-   Pasco
-   Junín

```{r}
TABLA<-table(DB_FINAL$sectorNacimiento);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]

# Crear una nueva tabla solo con los elementos no vacíos
TABLA_FINAL <- TABLA[elementos_no_vacios]
# names(TABLA_FINAL) -> Obtener orden de labels.

# Obtener orden de los nombres de las categorías
orden_nombres <- names(TABLA_FINAL)

# Truncar los nombres a la longitud máxima
nombres_cortados <- sapply(strsplit(orden_nombres, " "), function(x) x[[1]])

barplot(
  TABLA_FINAL, 
  main = "Sector de nacimiento de los estudiantes de UTEC",
  xlab = "Sector geográfico",
  ylab = "Frecuencia",
  names.arg = nombres_cortados,
  col = c("lightblue"))
```

#### 3.2 Descriptores numéricos

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable lugar de residencia:', sum(nchar(DB_FINAL$sectorNacimiento) > 0),'\n') # utilizar nchar pues es character.
```

#### 3.3 Datos estadísticos generales

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$sectorNacimiento[DB_FINAL$sectorNacimiento != ""]
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Categoría más frecuente (MODA) en "sectorNacimiento":', categoria_min, '\n')
```

------------------------------------------------------------------------

#### [4. Fue afectado indirecta ó directamente]{.underline}

#### 4.1 Análisis multivariado

```{r}
afectados <- nrow(filter(DB_FINAL,`fueAfectado`== TRUE))
noAfectados <- nrow(filter(DB_FINAL, `fueAfectado`== FALSE))
noAfectados
afectadosVector <- c(afectados,noAfectados)
categoria <- c("Sí","No")

tablaAfectados <- data.frame(afectadosVector,categoria)
tablaAfectados$porcentaje <- round(tablaAfectados$afectadosVector / sum(tablaAfectados$afectadosVector) * 100,2)
#tablaAfectados


ggplot(tablaAfectados, 
  col = colores,
       aes(
  x = "", 
  y = afectadosVector, fill = categoria)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(fill = "Respuestas") +
  geom_label(aes(label = paste0(porcentaje, "%")), position = position_stack(vjust = 0.5)) +
  ggtitle("¿Usted fue afectado de manera directa ó indirecta por el ciclón Yaku?") +
  guides(fill = guide_legend(override.aes = list(label = "")))

```

#### 4.2 Descriptores numéricos

```{r}
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes no fueron afectados:', sum(afectados_df),'\n')
 cat('2. Número de casos completos que los estudiantes fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
```

#### 4.3 Datos estadísticos generales

A partir de los resultados obtenidos, es posible determinar que para la mayoría de encuestados (población) no se vieron afectados directa ó indirectamente por el ciclón Yaku.

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$fueAfectado
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Respuesta más frecuente, para variable "fue afectado":', categoria_min, '\n')
```

------------------------------------------------------------------------

#### [5. Afectados económicamente]{.underline}

#### 5.1 Análisis multivariado

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$afectoEconomicamente);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("No afectados", "Afectados");

pie(
  TABLA_FINAL,
  main = "\n Proporción de estudiantes \n de UTEC que se vieron afectados  \n económicamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

#### 5.2 Descriptores numéricos

```{r}
casos_completos <- complete.cases(DB_FINAL$fueAfectado);
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes afectados:', sum(afectados_df),'\n')
 cat('3. Número de casos completos que los estudiantes que no fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
 
 
porcentaje_afectados = round((sum(afectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes afectados económicamente:', porcentaje_afectados,'%\n')

porcentaje_noafectados = round((sum(noafectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes no afectados económicamente:', porcentaje_noafectados,'%\n')
```

#### 5.3 Datos estadísticos generales

------------------------------------------------------------------------

#### [6. Gasto por daños ocasionados por el fenómeno Yaku]{.underline}

#### 6.1 Análisis multivariado

```{r}
library(ggplot2)
TABLA <- (DB_FINAL$gastoDañosCiclon)

# Filtrar y ajustar los valores de gasto por daños
gasto_danos <- DB_FINAL$gastoDañosCiclon
gasto_danos[gasto_danos < 0] <- 0
gasto_danos[gasto_danos > 800] <- 800

# Crear los rangos de valores
rangos <- cut(gasto_danos, breaks = c(0, 200, 400, 600, 800))

# Crear el data frame para el gráfico
data <- data.frame(Gasto = gasto_danos, Rango = rangos)

# Definir los colores para cada rango
colores <- c("lightblue")

# Crear el histograma con colores agrupados por rangos
hist(
  x = TABLA,
  xlab = "Gasto en soles S/.",
  ylab = "Frecuencia",
  main = "Frecuencia de gasto en soles por daños ocasionados \n por el fenómeno Yaku. ",
  col = colores
)
```

#### 6.2 Descriptores numéricos

```{r}
df_gasto_danos = DB_FINAL$gastoDañosCiclon[!is.na(DB_FINAL$gastoDañosCiclon)];

cat('1. Mediana de la variable gasto daños:',round(median(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable gasto daños:',18 ,'\n')
cat('3. Varianza de la variable gasto daños:',round(var(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable gasto daños:',round(sd(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable gasto daños:', round((sd(df_gasto_danos, na.rm=TRUE)/mean(df_gasto_danos, na.rm=TRUE))*100,2),'\n')
```

#### 6.3 Datos estadísticos generales

```{r}

```

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------
