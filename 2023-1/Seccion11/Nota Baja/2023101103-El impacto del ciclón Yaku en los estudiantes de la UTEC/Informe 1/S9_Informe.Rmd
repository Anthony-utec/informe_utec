---
title: "El impacto del ciclón Yaku en los estudiantes de la Universidad de Ingeniería y Tecnología. Lima, abril 2023."
output:
  html_document:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    theme: journal
    number_sections: no
  pdf_document: 
    fig_caption: yes
    highlight: espresso
    toc_depth: 4
---

## Instalación de paquetes

```{r message=FALSE, warning=FALSE}
if(!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}

```

```{r message=FALSE, warning=FALSE}
if(!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}
```

```{r message=FALSE, warning=FALSE}
if(!require(readr)) {
  install.packages("readr")
  library(readr)
}
```

------------------------------------------------------------------------

# [**1. Introducción**]{.underline}

## 1.1 Relevancia

Los estudiantes se encontraron en medio de desafíos considerables tras la aparición del ciclón "Yaku". Aunque no todos experimentaron las consecuencias de forma directa, muchos tienen seres queridos que sí se vieron significativamente afectados por este devastador fenómeno natural. El impacto del ciclón podría haber alterado la vida de los estudiantes de diversas formas, ya sea en términos económicos, psicológicos o físicos. Este proyecto tiene como objetivo proporcionar una visión completa de la naturaleza y el alcance del impacto sufrido por los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Asimismo, se espera que estos hallazgos sirvan para guiar a las autoridades y a los ciudadanos en la anticipación de situaciones similares en el futuro, minimizando así los daños potenciales en la sociedad.

## 1.2 Objetivos

### 1.2.1 Objetivo general

Investigar y analizar el impacto del ciclón Yaku en los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC) en Lima, en abril de 2023, con el fin de comprender la magnitud de las consecuencias generadas por este fenómeno natural. Esto incluirá evaluar la situación actual de los estudiantes, determinar la proporción de estudiantes afectados, identificar los departamentos más afectados, y explorar cómo la tragedia ha influido en sus estudios, estado de ánimo, y actitud ante la situación. Además, el estudio busca valorar la respuesta y las medidas tomadas por el gobierno y organizaciones de ayuda, la preparación de los estudiantes ante un suceso de esta magnitud, y establecer si han sufrido pérdidas materiales, económicas y ambientales como resultado del ciclón Yaku.

### 1.2.1 Objetivos específicos

1.  Conocer la situación en la que se encuentran los estudiantes de UTEC después del fenómeno natural Yaku.
2.  Determinar el porcentaje de alumnos afectados.
3.  Conocer los departamentos más afectado por el ciclón Yaku.
4.  Determinar si el ciclón Yaku afectó el rendimiento académico y estado de ánimo de los estudiantes de UTEC.
5.  Conocer la actitud que tomaron los estudiantes ante el ciclón Yaku.
6.  Conocer de qué forma afectó el ciclón Yaku a los estudiantes de la UTEC.
7.  Evaluar la respuesta por parte del Gobierno y Organizaciones de ayuda frente a daños causados por el ciclón Yaku.
8.  Evaluar la preparación de los estudiantes de la UTEC ante un fenómeno natural.
9.  Determinar si los estudiantes de UTEC tuvieron perdidas materiales, económicas y ambientales a causa del ciclón Yaku.

## 1.3 Contexto

Después de cuatro décadas, el norte de Perú fue azotado por un ciclón, un fenómeno natural bautizado como "Yaku", un término que proviene de la lengua quechua y significa "agua". Este ciclón, caracterizado por su rápida rotación, dejó un rastro de devastación a su paso. Entre las catástrofes provocadas por este suceso, destacaron inundaciones resultantes de las intensas lluvias. Estas afectaron a miles de familias, conduciendo a la pérdida de innumerables bienes materiales.

En respuesta a la magnitud de los daños, las autoridades peruanas declararon un estado de emergencia en varias regiones y movilizaron equipos de rescate y asistencia humanitaria. Su objetivo: brindar apoyo a las numerosas personas damnificadas, las cuales quedaron en situaciones de extrema vulnerabilidad tras el paso del ciclón "Yaku". A partir de este contexto, nace nuestro estudio estadístico que tiene como objetivo profundizar en la naturaleza y el alcance del impacto sufrido por los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC)

------------------------------------------------------------------------

# [**2. Datos**]{.underline}

## 2.1 Proceso de recolección de datos

Los datos se obtuvieron por medio de encuestas digitales, por medio de la plataforma *Google Forms*. El propósito de estas encuestas fue conocer el impacto que el ciclón Yaku tuvo en los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Nuestra encuesta digital se enfocó en los estudiantes de pregrado de UTEC que están cursando el ciclo 2023-1, por lo tanto optamos por compartir nuestra encuestra en grupos de Whatsapp y Telegram relacionados a la Universidad. Por otro lado, también solicitamos que se complete nuestra encuesta de manera presencial, para lo cual facilitamos un código QR para acceder a ella. Siguiendo todas estas consideraciones logramos completar las 150 observaciones mínimas necesarias para proceder con nuestro análisis.

-   Es importante mencionar que en cada encuesta realizada, se le pidió al usuario responder con sinceridad y juicio crítico. Esto, pues buscamos disminuir cualquier posibilidad de sesgo asociado a su respuesta.
-   Priorizamos encuestar a gente *aleatoria* por la universidad (a excepción de grupos de estudiantes) con el objetivo de no guardar un sesgo de muestras, es decir evitamos dirigirnos a grupos de personas de la misma carrera, pues afectaría a nuestras estadísticas.
-   Por otro lado, la encuesta no recopiló dirección de correo, ni código de estudiante, simplemente carrera, edad, género y ciclo académico. Esto lo hicimos con el principal objetivo de no recopilar información innecesaria y sensible, no obstante la encuesta perteneció cerrada para estudiantes de la Universidad de Ingeniería y Tecnología (UTEC) sin recopilación de correos.

## 2.2 Población, muestra y muestreo

-   [**Población de estudio:**]{.underline} Los estudiantes de la Universidad de Ingeniería y Tecnología (UTEC). Unidad muestral: Los estudiantes que respondieron adecuadamente a la encuesta realizada a través de Google Forms (117 estudiantes)

-   [**Representatividad de la muestra:**]{.underline} La muestra se considera representativa debido a que se envió de forma masiva a la comunidad estudiantil de pregrado de UTEC a través de grupos de WhatsApp, lo que permitió alcanzar a un número significativo de estudiantes de diferentes carreras y edades. Al obtener 117 observaciones, se logra tener una muestra considerablemente representativa de la población de estudiantes de UTEC.

-   [**Tipo de muestreo:**]{.underline} En este caso, se utilizó un tipo de muestreo no probabilístico denominado muestreo por conveniencia.Está trata en la disponibilidad y accesibilidad de los elementos de la población. En este caso, se aprovechó la cercanía y la facilidad de comunicación con los estudiantes de UTEC a través de grupos de WhatsApp y el uso de un formulario en línea (Google Forms) para obtener las respuestas. Aunque este tipo de muestreo no garantiza una selección aleatoria y puede presentar sesgos, en este caso, se hizo el esfuerzo de llegar a una muestra representativa dentro de las posibilidades disponibles.

## 2.3 Variables

| Variable                                          | Tipo de Variable   | Restricciones                                                                                                                                                                                                                                                                                                                                                                                                                |
|:------------------|:------------------|:---------------------------------|
| Género                                            | Categórica Nominal | El usuario debe elegir obligatoriamente una de las dos opciones, que son femenino o masculino.                                                                                                                                                                                                                                                                                                                               |
| Edad                                              | Numérica Discreta  | El usuario debe responder obligatoriamente, el número tiene que un entero y no negativo.                                                                                                                                                                                                                                                                                                                                     |
| Carrera                                           | Categórica Nominal | El usuario responderá obligatoriamente 1 de las 12 opciones las cuales son Administración y Negocios Digitales, Bioingeniería, Ciencia de Datos, Ciencia de la Computación, Ingeniería Civil, Ingeniería de la Energía, Ingeniería Mecánica, Ingeniería Ambiental, Ingeniería industrial, Ingeniería electrónica, Ingeniería Química e Ingeniería Mecatrónica ya que son las únicas carreras que brinda la universidad UTEC. |
| Lugar Residencial                                 | Categórica Nominal | El usuario debe responder obligatoriamente una entre estas opciones: División política Norte (Tumbes, Piura, Lambayeque, La Libertad); Centro (Ancash, Lima, Ica, Junín, Huancavelica, Pasco); Sur (Arequipa, Moquegua, Tacna, Ayacucho, Apurímac, Cusco, Puno); Oriente (Loreto, Ucayali, Madre de Dios).                                                                                                                   |
| ¿De qué forma le afectó?                          | Categórica Nominal | Solo se puede elegir dos opciones entre "si o no".                                                                                                                                                                                                                                                                                                                                                                           |
| Tipo de vivienda                                  | Categórica Nominal | El usuario responderá obligatoriamente una de las tres opciones, las cuales son: casa, departamento y otro.                                                                                                                                                                                                                                                                                                                  |
| Localidad                                         | Categórica Nominal | El usuario responderá una entre estas dos opciones las cuales son rural o urbana.                                                                                                                                                                                                                                                                                                                                            |
| Estado de ánimo                                   | Categórica Nominal | El usuario responderá a una de las cuatro opciones, las cuales son estrés, enojo, depresión y ninguna de las anteriores.                                                                                                                                                                                                                                                                                                     |
| Forma de apoyo                                    | Categórica Nominal | El usuario responderá originariamente una de las seis opciones, las cuales son ayuda financiera, servicio médico y psicológico, refugio y alojamiento, donación de recursos materiales, ayuda voluntaria y no brindé apoyo.                                                                                                                                                                                                  |
| Grado de afectación del ciclón                    | Categórica Ordinal | El usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa nada afectado, y el diez, extremadamente afectado.                                                                                                                                                                                                                                                                                  |
| Nivel socio económico                             | Categórica Ordinal | El usuario responderá obligatoriamente una de las cinco opciones, las cuales son A,B,C,D y E.                                                                                                                                                                                                                                                                                                                                |
| Grado de satisfacción a la respuesta del Gobierno | Categórica Ordinal | El usuario responderá obligatoriamente a una de las diez opciones, el cual uno significa malo y el diez, excelente.                                                                                                                                                                                                                                                                                                          |
| Nivel de preparación ante un fenómeno natural     | Categórica Ordinal | El usuario responderá obligatoriamente a una de las tres opciones, las cuales son mínima, intermedia y avanzada.                                                                                                                                                                                                                                                                                                             |
| Número de personas en la vivienda                 | Numérica Discreta  | El usuario responderá obligatoriamente a una de las diez opciones, las cuales indican respectivamente el número de personas.                                                                                                                                                                                                                                                                                                 |
| Gasto total de los daños                          | Numérica Continua  | El usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |
| Gasto ayuda                                       | Numérica Continua  | El usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |
| Gasto ayuda                                       | Numérica Continua  | el usuario responderá obligatoriamente y que el monto sea en nuevos soles.                                                                                                                                                                                                                                                                                                                                                   |

------------------------------------------------------------------------

# [**3. Limpieza de base de datos**]{.underline}

Todas las encuestas realizadas por estudiantes se encuentran dentro de la plataforma de Google Forms guardadas en la nube. Para poder trabajar con aquellas respuestas fue necesario exportarlas a un formato fácil de manipular: `csv.`

## 3.1 Carga de la base de datos

Para trabajar en este proyecto, definimos la variable `DB` como la responsable de almacenar el dataframe obtenido en formato `csv`, transformado por medio de la librería `readr`, en conjunto con su función de lectura `read.csv()` .

```{r}
# cargar base de datos localizada en directorio actual.
DB <- read.csv("./database.csv")
```

## 3.2 Información inicial

A modo de entender nuestra base de datos, es necesario como primer paso ver la información que ha sido recogida, los tipos de datos, cuántas observaciones (filas) y variables (columnas) están presentes e identificar si existe algún tipo de datos que no corresponde a alguna variable dada, para así corregirlo.

```{r}
# identificar observaciones
ncol(DB)
nrow(DB)

# identificar nombres de variables
colnames(DB)
```

Es así que a partir de las anteriores instrucciones, definimos que nuestra Base de Datos cuenta con 21 columnas y 251 observaciones. Además con el comando `colnames(DB)` obtuvimos un tipo vector con la lista de nombres de cada variable de acuerdo a su posición.

## 3.3 Renombrar columnas

Ahora, que ya conocemos las variables, procedemos a eliminar ciertos carácteres prohubidos ó que interfieren en la limpieza e incluso no cumplen con las *mejores prácticas*. Entre estos criterios, consideramos eliminar tildes, espacios, términos en blanco y signos de pregunta (*Google Forms los transformaba a "X"*). Además consideramos apropiado eliminar la variable de marcaTemporal, la cual guardaba registro del día que se realizó la encuesta, pues no es una variable representativa a nuestro objetivo.

```{r}
# eliminar marca temporal (fecha que se envió la encuesta)
DB$Marca.temporal <- NULL

# leer nombre de columnas actuales
colnames(DB)

# actualizar nombre de columnas respetando criterios mencionados.
colnames(DB) <- c(
  "fueAfectado",
  "carrera",
  "genero",
  "edad",
  "personasEnVivienda",
  "sectorNacimiento",
  "afectoEconomicamente",
  "tuvoProblemaSalud",
  "interrupcionTransporte",
  "interrupcionEducacion",
  "tipoVivienda",
  "tipoLocalidad",
  "animoDurante",
  "animoDespues",
  "formaApoyo",
  "gradoAfectacion",
  "nivelSocioeconomico",
  "satisfaccionRespuestaGobierno",
  "nivelPreparacionFenomeno",
  "gastoDañosCiclon",
  "apoyoAfectados"
)

# verificar que se realizó sobreescritura con éxito.
colnames(DB)
```

## 3.4 Corregir tipos de datos

Ahora, que ya hemos corregido nuestras variables, y es más sencillo el acceder a ellas, procedemos a analizar cada tipo de dato de ellas para corregirlo en caso sea necesario. Para realizar esto evaluamos primero con la función `str(DB)` los tipos actuales, y posteriormente lo actualizamos de acuerdo a nuestro criterio.

```{r}
# actualizar variables con valores correctos
DB$apoyoAfectados <- as.numeric(DB$apoyoAfectados);
DB$gastoDañosCiclon <- as.numeric(DB$gastoDañosCiclon);
DB$satisfaccionRespuestaGobierno <- as.integer(DB$satisfaccionRespuestaGobierno);
DB$gradoAfectacion <- as.integer(DB$gradoAfectacion);
DB$personasEnVivienda <- as.integer(DB$personasEnVivienda);
DB$edad <- as.integer(DB$edad);
DB$sectorNacimiento <- as.character(DB$sectorNacimiento);
DB$genero <- as.character(DB$genero);

# logica para covertir a valores booleanos
DB$interrupcionEducacion <- ifelse(DB$interrupcionEducacion=="Si", TRUE, FALSE);
DB$interrupcionTransporte <- ifelse(DB$interrupcionTransporte=="Si", TRUE, FALSE);
DB$tuvoProblemaSalud <- ifelse(DB$tuvoProblemaSalud=="Si", TRUE, FALSE);
DB$afectoEconomicamente <- ifelse(DB$afectoEconomicamente=="Si", TRUE, FALSE);
DB$fueAfectado <- ifelse(DB$fueAfectado=="Sí", TRUE, FALSE);
```

En el caso expuesto corregimos las variables: *apoyoAfectados, gastoDañosCiclón, satisfaccionRespuestaGobierno, gradoAfectacion, personasEnVivienda, edad, sectorNacimiento, genero.* En su mayoría a variables numéricas, enteras ó del tipo carácter.

Por otro lado para ciertas variables del tipo pregunta binaria, corregimos su tipo a booleanos, pues es más sencillo evaluar un TRUE, FALSE. Las implicadas son: *interrupcionEducacion, interrupcionTransporte, tuvoProblemaSalud, afectoEconomicamente, fueAfectado.*

## 3.5 Corregir error de NA's

Para verificar si nuestra Base de Datos almacena valores NA es decir, valores no aplicables al tipo de variable, valores vacíos ó valores sin relación con la pregunta. Para ello, primero debemos aclarar que nuestra base de datos tiene una *pregunta filtro*, es la encargada de determinar si el estudiante fue afectado ó no.

A partir de esta pregunta podemos filtrar los NA para estudiantes afectados, por lo que debemos de evaluar esa condición primero. Por otro lado en campo de texto abiertos (el usuario ingresa la data, no la marca) es necesario filtrar aquellos que están vacíos, como es el caso de la variable `gastoDañosCiclon(DB)`.

```{r}
# verificar sobreescritura de datos
summary(DB)

# No existen datos faltantes.
(sum(is.na(DB))/(nrow(DB)*ncol(DB))*100)
```

## 3.6 Corregir errores con cuantiles

### 3.6.1 Variable gastoDañosCiclón

En el transcurso de nuestro estudio sobre las relaciones y valores, encontramos que el primer cuartil Q1 (25%) y el tercer cuartil Q3 (75%) coinciden. Esto nos permitió deducir que la mayoría de los datos están concentrados en un rango entre S/. 99.25 y S/. 402.5, correspondiente al gasto por daños ocasionados a causa del ciclón Yaku.

```{r}
IQR(DB$gastoDañosCiclon, na.rm=TRUE); # 303.25, se encuentran 50% de datos
quantile(DB$gastoDañosCiclon, 0.25, na.rm = TRUE) # 25% de datos <= 99.25
quantile(DB$gastoDañosCiclon, 0.75, na.rm = TRUE) # 75% de datos <= 402.5
```

Utilizando el diagrama de cajas y bigotes (boxplot), pudimos visualizar esta concentración de datos y la dispersión que existe fuera de este rango. En consecuencia, justificadamente decidimos eliminar los valores atípicos, ya que estos aportaban una variabilidad excesiva que podía distorsionar nuestros análisis.

```{r}
# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoGastoDanosCiclon <- boxplot(DB$gastoDañosCiclon)$out

# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- DB;
DB_FINAL <- subset(DB, !gastoDañosCiclon %in% atipicoGastoDanosCiclon)
```

En el último apartado gracias a nuestra visualización del diagrama **boxplot**, fue posible eliminar valores atípicos, que estaban fuera del rango intercuartil y además no eran representativos, gracias a su eliminación nuestra muestra sigue siendo representativa.

```{r}
cat("* Antes: \n")
summary(DB$gastoDañosCiclon)

cat("* Después: \n")
summary(DB_FINAL$gastoDañosCiclon)
```

-   Antes de la eliminación de los valores atípicos, la media era de $S/. 394.6$ y el valor máximo era de $S/. 4,000$. El primer y tercer cuartil se situaban en $S/. 97.0$ y $S/. 402.0$, respectivamente.

-   Después de eliminar los valores atípicos, la media disminuyó a $S/. 218.1$ y el valor máximo se redujo a $S/. 800$. El primer cuartil disminuyó a $S/. 76.0$ y el tercer cuartil bajó a $S/. 347.0$.

### 3.6.2 Variable apoyoAfectados

En cuanto al apoyo brindado a las personas afectadas por el ciclón Yaku, podemos observar a través de la relación entre los cuartiles y el gráfico boxplot una considerable dispersión de los datos. En este caso, vemos que el 25% de los datos son menores o iguales a S/. 8, mientras que el 75% de los datos son menores o iguales a S/. 333.5.

```{r}
IQR(DB$apoyoAfectados, na.rm=TRUE) # 325.5, se encuentran 50% de datos
quantile(DB$apoyoAfectados, 0.25, na.rm = TRUE) # 25% de datos <= 8
quantile(DB$apoyoAfectados, 0.75, na.rm = TRUE) # 75% de datos <= 333.5
```

Por otro lado, es notable que la cifra de S/. 2000 se encuentra bastante alejada del rango intercuartil, mostrando una alta dispersión. Dada esta observación, estamos justificados en eliminar este valor de nuestra muestra. Esta decisión se toma porque su inclusión podría sesgar o distorsionar nuestro análisis, dado que este valor no parece ser representativo de la mayoría de los datos recogidos.

```{r}
# diagrama de boxplot.
boxplot(DB$apoyoAfectados);

# almacenar valores atípicos del diagrama boxplot (circulos)
atipicoApoyoAfectados <- boxplot(DB_FINAL$apoyoAfectados)$out

# quitar valores atípicos de los datos (4000, 3000, 2000, 1000)
DB_FINAL <- subset(DB_FINAL, !apoyoAfectados %in% atipicoApoyoAfectados)
```

Ahora, podemos utilizar la función `summary()` que nos permitirá comparar entre las dos Base de Datos (`DB`, `DB_FINAL`) para la misma variable: `apoyoAfectados`, de esa forma será sencillo notar los cambios que ocasionó la limpieza de boxplot. Además a partir de ello es posible determinar las siguientes conclusiones.

```{r}
cat("* Antes: \n")
summary(DB$apoyoAfectados);

cat("* Después: \n")
summary(DB_FINAL$apoyoAfectados)
```

-   Antes de la eliminación de los valores atípicos, la media era de $S/. 193.1$ y el valor máximo era de $S/. 2000$. El primer y tercer cuartil se situaban en $S/. 4.0$ y $S/. 331.2$, respectivamente.
-   Después de eliminar los valores atípicos, la media se mantuvo prácticamente igual en $S/. 195.2$, y el valor máximo se mantuvo en $S/. 2000$. El primer cuartil aumentó a $S/. 16.0$, y el tercer cuartil aumentó a $S/. 338.0$.

------------------------------------------------------------------------

# [4**. Análisis Descriptivo**]{.underline}

## 4.1 Variable edad

```{r}
TABLA_FINAL <- table(DB_FINAL$edad[!is.na(DB_FINAL$edad)]);
# verificacion 
#frecuencia <- table(edad_no_na)
#valor_mas_repetido <- as.numeric(names(frecuencia)[which.max(frecuencia)])
barplot(
  TABLA_FINAL,
  main = "Edad de los estudiantes de UTEC", 
  xlab = "Edad", 
  ylab = "Frecuencia", 
  col = "lightblue"
)
```

Como se puede apreciar el barplot nos muestra que los estudiantes con mayor frecuencia tienen 19 años. Si bien el gráfico de barras es utilizado para variables categóricas también puede ser empleado para variables numéricas discretas ya que se puede agrupar en rangos o categorías y las barras representan la proporción de cada categoría de está manera este gráfico nos ayuda con la comparación y visualizar tendencias en los datos.

### 4.1.1 Descriptores numéricos

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable edad:', sum(complete.cases(DB_FINAL$edad)),'\n')
boxplot(DB_FINAL$edad, main = "Edad de los estudiantes de UTEC")
```

Es posible notar que el número de observaciones es **237** y el número de casos completos de la variable edad es menor, por lo que la muestra selectiva para el análisis de esta variable es **102** observaciones. Por medio del diagrama de cajas se puede visualizar los outliers aquellos valores poco representativos : estudiantes que tienen 26 años.

### 4.1.2 Datos Estadísticos generales

```{r}
df_edad = DB_FINAL$edad[!is.na(DB_FINAL$edad)];

cat('1. Mediana de la variable edad:',round(median(df_edad, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable edad:',18 ,'\n')
cat('3. Varianza de la variable edad:',round(var(df_edad, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable edad:',round(sd(df_edad, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable edad:', round((sd(df_edad, na.rm=TRUE)/mean(df_edad, na.rm=TRUE))*100,2),'\n')
```

-   A partir de lo realizado podemos mencionar que la mitad de los encuestados tiene una edad mayor o igual que 19 y la otra mitad, menor a este número (*mediana*).
-   La mayor parte de encuestados tiene 19 años de edad. Asimismo, podemos ver que las edades no varían mucho respecto a su media, por lo que las edades de los estudiantes de UTEC tienden a estar agrupados cerca de su media.
-   Además, el coeficiente de variación es 9.47, lo que significa que la variable edad tiene una dispersión baja, así los datos son considerados homogéneos (poca variabilidad).

## 4.2 Variable Género

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$genero);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("Femenino", "Masculino");

pie(
  TABLA_FINAL,
  main = "\n Análisis comparativo del género de los estudiantes \n de UTEC quienes fueron afectados directa ó \n indirectamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

Este tipo de gráfico analiza las variables categóricas , nos muestra la proporción de cada categoría y es fácil de comprender y visualizar los porcentajes y así inferir en un análisis coherente.

De este gráfico de torta se evidencia que la muestra de estudio han participado más **mujeres**, ya que estamos trabajando con 102 observaciones de las cuales 55 fueron del género femenino, a comparación del género masculino que fueron 47.

### 4.2.1 Descriptores numéricos

El número total de observaciones es 205 y el número de casos completos de la variable género es 102, sólo tenemos la mitad de información completa sobre la variable género. Es por ello que aún existe un subconjunto de la muestra que no proporciona información sobre el género de los individuos, por lo que consideramos que esta muestra no es selectiva, pues no representa completamente la población objetivo.

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable género:', sum(nchar(DB_FINAL$genero) > 0),'\n')
```

### 4.2.2 Datos Estadísticos generales

Se visualiza de la variable cualittiva género que de el total de encuestados de nuestro estudio el género más frecuente es el **femenino**

```{r}
categorias <- DB_FINAL$genero[DB_FINAL$genero != ""];
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)];

# obtener cantidad de observaciones del tipo femenino
obs_categoria_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Femenino"]) 
obs_categoria_segunda_frecuente <- length(DB_FINAL$genero[DB_FINAL$genero == "Masculino"]) 

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Género más frecuente:', categoria_mas_frecuente, '\n')
cat('2. Observaciones del género más frecuente:', obs_categoria_frecuente, '\n')
cat('3. Observaciones del género menos frecuente:', obs_categoria_segunda_frecuente, '\n')
```

## 4.3 Variable Sector de Nacimiento

Este gráfico de barras analiza variables categóricas, se puede visualizar las tendencias en los datos y hacer una comparación con ello se obtener una fácil interpretación, por lo que se evidencia que hubieron más encuestados pertenecientes al sector **centro** del país que en nuestro formulario abarcaba los siguientes departamentos:

-   Ancash
-   Lima
-   Ica
-   Huánuco
-   Pasco
-   Junín

```{r}
TABLA<-table(DB_FINAL$sectorNacimiento);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]

# Crear una nueva tabla solo con los elementos no vacíos
TABLA_FINAL <- TABLA[elementos_no_vacios]
# names(TABLA_FINAL) -> Obtener orden de labels.

# Obtener orden de los nombres de las categorías
orden_nombres <- names(TABLA_FINAL)

# Truncar los nombres a la longitud máxima
nombres_cortados <- sapply(strsplit(orden_nombres, " "), function(x) x[[1]])

barplot(
  TABLA_FINAL, 
  main = "Sector de nacimiento de los estudiantes de UTEC",
  xlab = "Sector geográfico",
  ylab = "Frecuencia",
  names.arg = nombres_cortados,
  col = c("lightblue"))
```

### 4.3.1 Descriptores numéricos

```{r}
cat('Número de observaciones:', nrow(DB_FINAL),'\n')
cat('Número de casos completos de la variable lugar de residencia:', sum(nchar(DB_FINAL$sectorNacimiento) > 0),'\n') # utilizar nchar pues es character.
```

Lo que se puede inferir del siguiente resultado es que obtenemos valores completos debajo de la mitad de nuestros encuestados , por lo que nuestro estudio carece de información , cierto sesgo en nuestro análisis , lo que afecta a la representatividad en la muestra y no se pueda tener una confiabilidad en los resultados.

### 4.3.2 Datos Estadísticos generales

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$sectorNacimiento[DB_FINAL$sectorNacimiento != ""]
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Categoría más frecuente (MODA) en "sectorNacimiento":', categoria_min, '\n')
```

## 4.4 Variable Fue Afectado

```{r}
DB_FINAL

afectados <- sum(DB$fueAfectado == TRUE)
noAfectados <- sum(DB$fueAfectado == FALSE)


afectadosVector <- c(afectados,noAfectados)
categoria <- c("Sí","No");

tablaAfectados <- data.frame(afectadosVector,categoria)
tablaAfectados$porcentaje <- round(tablaAfectados$afectadosVector / sum(tablaAfectados$afectadosVector) * 100,2)


ggplot(tablaAfectados, 
  col = colores,
       aes(
  x = "", 
  y = afectadosVector, fill = categoria)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(fill = "Respuestas") +
  geom_label(aes(label = paste0(porcentaje, "%")), position = position_stack(vjust = 0.5)) +
  ggtitle("¿Usted fue afectado de manera directa ó indirecta por el ciclón Yaku?") +
  guides(fill = guide_legend(override.aes = list(label = "")))

```

Este tipo de gráficos nos muestra porcentajes y propociones con ello se puede realizar una adecuada interpretación , al ver el gráfico de torta se evidencia que que la mayor parte de nuestros nuestros encuestados respondió que si fue afectado por el ciclón yaku y además se nota que no es mucho la diferencia entre el uno y el otro.

### 4.4.1 Descriptores numéricos

```{r}
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$fueAfectado == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes no fueron afectados:', sum(afectados_df),'\n')
 cat('2. Número de casos completos que los estudiantes fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
```

Se puede observar que al obtener muchos casos incompletos , la afirmación que se de a cierto análisis no sea del todo cierto porque que al haber casos incompletos afecta la representatividad y se obtenga una respuesta no del todo confiable.

### 4.4.2 Datos Estadísticos generales

A partir de los resultados obtenidos, es posible determinar que para la mayoría de encuestados (población) no se vieron afectados directa ó indirectamente por el ciclón Yaku.

```{r}
# Calcular la frecuencia de cada categoría en la variable "sectorNacimiento"
# Utilizando nzchar obtenemos los strings no vacíos.
categorias <- DB_FINAL$fueAfectado
frec <- table(categorias)

categoria_mas_frecuente <- names(frec)[frec == max(frec)]
categoria_min <- strsplit(categoria_mas_frecuente, " ")[[1]][1]

# Mostrar las estadísticas descriptivas de la variable "sectorNacimiento"
cat('1. Respuesta más frecuente, para variable "fue afectado":', categoria_min, '\n')
```

## 4.5 Variable Afectado Económicamente

```{r}
par(pty = "s")  # Configura el área de trazado para ser cuadrada

TABLA<-table(DB_FINAL$afectoEconomicamente);

# Filtrar solo los elementos no vacíos
elementos_no_vacios <- names(TABLA)[nzchar(names(TABLA))]
TABLA_FINAL <- TABLA[elementos_no_vacios]

# names(TABLA) -> ORDEN: False, True
colores <- c("lightpink", "lightblue");
labels <- c("No afectados", "Afectados");

pie(
  TABLA_FINAL,
  main = "\n Proporción de estudiantes \n de UTEC que se vieron afectados  \n económicamente por el fenómeno Yaku.\n",
  col = colores,
  col.main = "black",
  labels = labels
);

# leyenda
legend("bottomleft", legend = labels, fill = colores, cex = 0.9)
```

A partir del gráfico de torta se observa la distribución de cada categoría percibiendo así que en mayor proporción los encuestados respondieron que no se vieron afectados económicamente .

### 4.5.1 Descriptores numéricos

```{r}
casos_completos <- complete.cases(DB_FINAL$fueAfectado);
afectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == TRUE]);
noafectados_df <- complete.cases(DB_FINAL$fueAfectado[DB_FINAL$afectoEconomicamente == FALSE]);

cat('1. Número de observaciones:', nrow(DB_FINAL),'\n')
cat('2. Número de casos completos que los estudiantes afectados:', sum(afectados_df),'\n')
 cat('3. Número de casos completos que los estudiantes que no fueron afectados:', sum(noafectados_df),'\n')# utilizar nchar pues es character.
 
 
porcentaje_afectados = round((sum(afectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes afectados económicamente:', porcentaje_afectados,'%\n')

porcentaje_noafectados = round((sum(noafectados_df) / sum(casos_completos)) * 100, 2) ;
  cat('4. Porcentaje de estudiantes no afectados económicamente:', porcentaje_noafectados,'%\n')
```

A partir de los resultados de la variable se puede inferir que al tener pocos casos completos en los estudiantes afectados y algunos casos incompletos en los que respondieron no fueron afectados, la credibilidad con respecto a esta variable no sea del todo confiable y los análisis no sean muy verídicos produciendo que se tenga sesgo y distorsión en los resultados . Al tener pocos casos completos hay una falta de robustez, existe un mayor riesgo que los resultados se vean influenciados por outliers o casos extremos.

## 4.6 Variable Gasto total en daños

```{r}
library(ggplot2)
TABLA <- (DB_FINAL$gastoDañosCiclon)

# Filtrar y ajustar los valores de gasto por daños
gasto_danos <- DB_FINAL$gastoDañosCiclon
gasto_danos[gasto_danos < 0] <- 0
gasto_danos[gasto_danos > 800] <- 800

# Crear los rangos de valores
rangos <- cut(gasto_danos, breaks = c(0, 200, 400, 600, 800))

# Crear el data frame para el gráfico
data <- data.frame(Gasto = gasto_danos, Rango = rangos)

# Definir los colores para cada rango
colores <- c("lightblue")

# Crear el histograma con colores agrupados por rangos
hist(
  x = TABLA,
  xlab = "Gasto en soles S/.",
  ylab = "Frecuencia",
  main = "Frecuencia de gasto en soles por daños ocasionados \n por el fenómeno Yaku. ",
  col = colores
)
```

El gráfico de barras nos proporciona un resumen de datos, con ello hacer un análisis comparativo se puede distinguir la barra más sobresaliente entre todas es cuando el gasto se ubica en **0-100**\$ lo que nos da una idea que el gasto en soles ocasionado por el fenómeno Yaku más frecuente no fue muy alto.

### 4.6.1 Descriptores numéricos

```{r}
df_gasto_danos = DB_FINAL$gastoDañosCiclon[!is.na(DB_FINAL$gastoDañosCiclon)];

cat('1. Mediana de la variable gasto daños:',round(median(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('2. Moda de la variable gasto daños:',18 ,'\n')
cat('3. Varianza de la variable gasto daños:',round(var(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('4. Desviación estándar de la variable gasto daños:',round(sd(df_gasto_danos, na.rm=TRUE),2),'\n')
cat('5. Coeficiente de variación de la variable gasto daños:', round((sd(df_gasto_danos, na.rm=TRUE)/mean(df_gasto_danos, na.rm=TRUE))*100,2),'\n')
```

A partir de lo obtenido, deducimos que al tener una varianza, coeficiente de variación y desviación de estándar alta nos indica que hay una dispersión con relación a la media y pueden estar dispersos a lo largo del rango , lo que nos podría indicar que existe una gran variabilidad y posiblemente se tenga valores atípicos o extremos en el conjunto de datos.

------------------------------------------------------------------------

# [**7. Bibliografía**]{.underline}

-   Redacción Gestión.29 de Marzo del 2023. ¿Qué es el ciclón Yaku y por qué afecta a la costa de Perú?.Gestión. <https://gestion.pe/peru/ciclon-yaku-que-es-y-como-se-genera-peru-nnda-nnlt-noticia/?outputType=amp>
