---
title: "NECESIDADES DE IMPLEMENTACIÓN DE AMBIENTES EN EL CAMPUS UTEC"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 2
  pdf_document:
    toc: yes
    toc_depth: '2'
editor_options: 
  markdown: 
    wrap: 72
---

```{r}
# install.packages("readr")
# install.packages("ggplot2")
# install.packages("car")
# install.packages("dplyr")
# install.packages("DescTools")
# install.packages("reshape2")
# install.packages("fitdistrplus")
library(ggplot2)
library(reshape2)
library(fitdistrplus)
library(readr)
library(car)
library(dplyr)
library(DescTools)
```

# Introducción

Este trabajo tiene como objetivo principal realizar un análisis
estadístico y probabilístico de las preferencias de ambientes por parte
de los estudiantes de UTEC, con el fin de identificar las necesidades de
implementación de espacios en el nuevo campus de la universidad, ya que según
Lazo, S., & Omar, C. (2016) de la Universidad Nacional de Piura la 
comodidad con el campus universitario influye en el rendimiento académico de 
los alumnos.

# Relevancia

Este trabajo tiene como objetivo principal realizar un análisis
estadístico y probabilístico de las preferencias de ambientes por parte
de los estudiantes de UTEC, con el fin de identificar las necesidades de
implementación de espacios en el nuevo campus de la universidad. 

# Contexto

Actualmente, se encuentra en proceso la construcción de la ampliación
del campus UTEC, lo cual ha generado grandes expectativas entre los
estudiantes. 

![Construcción](campus.png)

# Objetivos

### Objetivo general

Analizar de forma estadística y probabilística la preferencia de
ambientes por los estudiantes de UTEC e identificar las necesidades de
implementación en el nuevo campus de la UTEC.

## Población, Muestra y Muestreo

-   **Población**: Estudiantes de la UTEC en el periodo 2023-1.

-   **Muestra**: Se encuestó a aproximadamente 213 estudiantes.

-   **Muestreo**: Probabilístico (Muestreo Aleatorio Simple).

## Variables y tipo de variables
| Variable                               | Tipo                           |
|----------------------------------------|--------------------------------|
| Sexo                                   | Variable cualitativa nominal   |
| Edad                                   | variable cuantitativa discreta |
| Carrera                                | Variable cualitativa nominal   |
| Ciclo                                  | Variable cualitativa ordinal   |
| Tiempo en la universidad               | variable cuantitativa continua |
| Lugares de preferencia                 | Variable cualitativa nominal   |
| Preferencia de ambientes               | Variable cualitativa nominal   |
| Tiempo de encontrar lugar de estudio   | Variable cuantitativa continua |
| Satisfacción Áreas verdes              | Variable cualitativa ordinal   |
| Satisfacción Salas de estudio          | Variable cualitativa ordinal   |
| Satisfacción Biblioteca                | Variable cualitativa ordinal   |
| Satisfacción Zonas recreativas         | Variable cualitativa ordinal   |
| Satisfacción laboratorios              | Variable cualitativa ordinal   |
| Satisfacción cubículos                 | Variable cualitativa ordinal   |
| Tiempo de uso de biblioteca            | Variable cuantitativa continua |
| Tiempo de uso de sala de estudio       | Variable cuantitativa continua |
| Tiempo de uso espacios recreativos     | Variable cuantitativa continua |
| Tiempo de uso cubículos                | Variable cuantitativa continua |
| Ambientes de preferencia a implementar | Variable cualitativa nominal   |
| Número de áreas verdes                 | Variable cuantitativa discreta |
| Número de salas de estudio             | Variable cuantitativa discreta |
| Número cubículos                       | Variable cuantitativa discreta |
| Número de zonas recreativas            | Variable cuantitativa discreta |

```{r}
DatosProyecto1 <- read_csv("ESTADÍSTICA BASE DE DATOS (1).csv")
DatosProyecto=DatosProyecto1
DatosProyecto=rename(DatosProyecto,sexo="Sexo, según DNI.",carrera="¿Qué carrera estás estudiando actualmente?",ciclo="¿En qué ciclo te encuentras actualmente ?",tiempou="¿Cuánto tiempo estás en la universidad? (Horas promedio por día) Ejemplo: 5 , 6.30. Determina el decimal con punto.",Edad="¿Qué edad tienes ?",lugar="¿Qué lugares prefieres usar dentro de la universidad?",ambientes="¿Qué ambientes te gustaría que se implementen en el nuevo campus UTEC?",Nrecreativos="¿Cuántos lugares recreativos cree que sería conveniente tener la nueva ampliación de la universidad?",Erecreativos="¿Cree usted que se debería de implementar espacios recreativos?", SSalaE="Salas de estudio (piso 1 y piso11)",SBiblioteca="Biblioteca...13", SAreaVerde="Áreas verdes...11", SZonaR="Zonas recreativas...14", SLaboratorio="Laboratorios", SCubiculos="Cubículos...16",TiempoBuscar="¿Cuánto tiempo te demoras en encontrar un lugar para estudiar? (Horas promedio por día)  (Determina el decimal con un punto ejemplo: 0.5 ,1 , 3)", NAreasVerdes="Áreas verdes...17", NSalaEs="Salas de estudio",NCubiculo="Cubículos...19",NZonaR="Zonas recreativas...20",HoraEspacionR="Espacios recreativos",HoraSalaE="Sala de estudio",HoraCubi="Cubículos...23",HoraBiblio="Biblioteca...24")
DatosProyecto$SAreaVerde <- dplyr::recode(DatosProyecto$SAreaVerde, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosProyecto$SBiblioteca <- dplyr::recode(DatosProyecto$SBiblioteca, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosProyecto$SSalaE<- dplyr::recode(DatosProyecto$SSalaE, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosProyecto$SZonaR<- dplyr::recode(DatosProyecto$SZonaR, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosProyecto$SLaboratorio<- dplyr::recode(DatosProyecto$SLaboratorio, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosProyecto$SCubiculos<- dplyr::recode(DatosProyecto$SCubiculos, "1" = "Nada satisfecho", "2" = "Poco satisfecho", "3" = "Medianamente satisfecho", "4" = "Bastante satisfecho", "5" = "Muy satisfecho")
DatosPLimpios = DatosProyecto
 DatosPLimpios<- DatosPLimpios %>% slice(-2,-1)
DatosPLimpios<- mutate(DatosPLimpios, HoraBiblio=as.numeric(HoraBiblio))
DatosPLimpios<- mutate(DatosPLimpios, tiempou=as.numeric(tiempou))
DatosPLimpios <- DatosPLimpios[DatosPLimpios$tiempou >1 ,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$TiempoBuscar<4,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$NAreasVerdes<=10,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$NSalaEs<11,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$NCubiculo<=30,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$NZonaR<=5,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$HoraEspacionR<=5,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$HoraSalaE<=5,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$HoraCubi<=5,]
DatosPLimpios <- DatosPLimpios[DatosPLimpios$HoraBiblio<=5,]
niveles<- c("Nada satisfecho", "Poco satisfecho", "Medianamente satisfecho", "Bastante satisfecho","Muy satisfecho")
DatosPLimpios<- mutate(DatosPLimpios, SAreaVerde=factor(DatosPLimpios$SAreaVerde, levels = niveles),SSalaE=factor(DatosPLimpios$SSalaE, levels = niveles),SBiblioteca=factor(DatosPLimpios$SBiblioteca, levels = niveles),SZonaR=factor(DatosPLimpios$SZonaR, levels = niveles),SLaboratorio=factor(DatosPLimpios$SLaboratorio, levels = niveles),SCubiculos=factor(DatosPLimpios$SCubiculos, levels = niveles))
ciclo_orden <-c(1,2,3,4,5,6,7,8,9,10)
DatosPLimpios<- mutate(DatosPLimpios, ciclo=factor(ciclo, levels = ciclo_orden))
table(DatosPLimpios$ciclo)
DatosPLimpios$sexo = recode(DatosPLimpios$sexo, 'F'='Femenino', 'M'='Masculino')
```

# ANÁLISIS DESCRIPTIVO

OJO: En esta entrega solo se están presentando las principales gráficas
del análisis descriptivo.

### Primero analizaremos brevemente con gráficas la distribución de la muestra que tenemos según sexo, edad y carrera:

```{r}
# Asumiendo que tu data frame se llama DatosPLimpios

# Crear la gráfica
p <- ggplot(DatosPLimpios, aes(x=sexo, fill=sexo))

# Añadir capas de gráficas: barras y texto
p + geom_bar(color="black", width = 0.5) +
  geom_text(stat='count', aes(label=..count..), vjust=-0.25) +
  scale_fill_manual(values = c("Femenino" = "pink", "Masculino" = "skyblue")) +
  theme_minimal() +
  labs(x="Sexo", y="Número de estudiantes", title="Gráfica 1 -Distribución de estudiantes por sexo") +
  theme(plot.title = element_text(hjust = 0.5), 
        text = element_text(size=15),
        legend.position = "none")

```

```{r}
#se hace el boxplot y el summary
par(mar = c(6, 2, 5, 2))
boxplot(DatosPLimpios$Edad, horizontal = TRUE, main="Gráfica 2 - Distribución de la edad de los estudiantes entrevistados",xlab="Edades(años cumplidos)",col="lightblue")
summary(DatosPLimpios$Edad)
```

```{r}
C <- table(DatosPLimpios$carrera)
#se hace el gráfico de barras
par(mar = c(4, 16, 5, 3)) # Determinante de margen 
barplot(C,las=2,horiz= TRUE,cex.names = 1, col = rainbow(13),  main="Gráfica 3 - Distribución de los estudiantes 
        entrevistados según carrera", xlab="N° de personas")

```

```{r}
table(DatosPLimpios$carrera)
```

```{r echo=FALSE}
mosaicplot(table(DatosPLimpios$sexo, DatosPLimpios$carrera), las= 1, col= rainbow(13), main= "Gráfica 4 - Mosaico de la distribución del sexo
           de los estudiantes por carrera")
```

## Análisis del tiempo que los alumnos pasan en la universidad y los espacios que prefieren para estudiar

```{r echo=FALSE}

#se hace el boxplot y el summary
par(mar = c(6, 2, 5, 2))
boxplot(DatosPLimpios$tiempou, horizontal = TRUE, main="Gráfica 5 - Distribución de tiempo de estadía en la universidad",xlab="Tiempo en la universidad(horas al día)",col="lightblue")
summary(DatosPLimpios$tiempou)
```

## Análisis del tiempo que los alumnos pasan en la universidad

```{r echo=FALSE}
(U<-IQR(DatosPLimpios$tiempou))
# Valor mínimo esperado
quantile(DatosPLimpios$tiempou, 0.25)-1.5*U
# Valor máximo esperado
quantile(DatosPLimpios$tiempou, 0.75)+1.5*U

```

## Preferencia de ambientes a implementar en el nuevo campus

> #### Creamos una función para analizar las variables con opción múltiple

```{r}
contar_lugares = function(lugares_preferidos) {
  lugares_completo = c()
  for(lugares in lugares_preferidos){
    lugares_lista = strsplit(lugares, ", ")[[1]]
    for(lugar in lugares_lista){
      lugares_completo = append(lugares_completo, lugar)
    }
  }
  return(lugares_completo)
}

#se usa la funcion contar_lugares para extraer todos los lugares preferidos
lugares_preferidos = contar_lugares(DatosProyecto$lugar)
```
```{r echo=FALSE}
(LP<-table(lugares_preferidos))
```
```{r echo=FALSE}
#se hace el grafico de barras
par(mar = c(4, 12, 2, 10)) # Determinante de margen 
barplot(LP,las=2,horiz=TRUE,cex.names = 1, col = rainbow(9), main="Gráfica 6 - Distribución de preferencia de zonas de estudio
        según votos(opción múltiple)", xlab="N° de votos")
```

```{r echo=FALSE}
#se extrae todos los lugares deseados con la función contar_lugares
lugares_deseados = contar_lugares(DatosPLimpios$ambientes)
```

```{r echo=FALSE}
(LD <- table(lugares_deseados))
```

```{r echo=FALSE}
#se hace el barplot
par(mar = c(4, 12, 2, 10)) # Determinante de margen 
barplot(LD,las=2,horiz=TRUE,cex.names = 1, col = rainbow(13), main="Gráfica 7-Distribución de  
        ambientes a implementar en el nuevo campus según votos", xlab="N° de votos")
```

```{r echo=FALSE}
# Segunda forma para hallar el número de votos que obtuvo Gimnasio
length(DatosPLimpios$ambientes[grepl("Gimnasio",DatosPLimpios$ambientes)])
```

## Análisis de tiempo que les toma a los estudiantes buscar un lugar de estudio dentro del campus UTEC

```{r echo=FALSE}
par(mar = c(6, 2, 5, 2))
boxplot(DatosPLimpios$TiempoBuscar, horizontal = TRUE, main="Gráfica 8 - Distribución de tiempo para buscar un lugar de estudio",xlab="Tiempo(horas)",col="yellow")
round(summary(DatosPLimpios$TiempoBuscar),2)
```

## Análisis de satisfacción de los alumnos con los principales ambientes de la UTEC

### Satisfacción de biblioteca

```{r echo=FALSE}
L4<-table(DatosPLimpios$SBiblioteca)


#se hace el gráfico de barras
par(mar = c(4, 12, 2, 10)) # Determinante de margen 
barplot(L4,las=2,horiz=TRUE,cex.names = 1, col = rainbow(9), main="Gráfico 9 - Satisfacción con la Bliblioteca de la universidad", xlab="N° de personas")
```

### Satisfacción de cubículos

```{r echo=FALSE}
L7 <- table(DatosPLimpios$SCubiculos)

#se hace el gráfico de barras
par(mar = c(4, 12, 2, 10)) # Determinante de margen 
barplot(L7,las=2,horiz=TRUE,cex.names = 1, col = rainbow(9), main="Gráfica 10 - Satisfacción con los cubículos de la universidad", xlab="N° de personas")
```

### Satisfacción de los alumnos con el cubículo en relación al ciclo al que pertenecen

```{r echo=FALSE}
ggplot(DatosPLimpios, aes(ciclo, SCubiculos)) +labs(title="Gráfica 11 - Satisfacción de los alumnos con el cubículo 
          en relación al ciclo al que pertenercen",x="Ciclo en el que se encuentra el estudiante",y="Grado de satisfacción con los cubículos", col= rainbow(10))+ geom_jitter()
```

##Se analiza el uso de los espacios
```{r echo=FALSE}
h <- hist(DatosPLimpios$HoraCubi,plot = FALSE)
h
```

```{r echo=FALSE}
x.pol <- c(min(h$breaks),h$mids,max(h$breaks))
x.pol
y.pol=c(0,h$counts,0)
y.pol
```

```{r echo=FALSE}
plot(x.pol,y.pol,
     type = "b",col=2,lwd=2,pch=16,
     xlab="Tiempo en horas",
     ylab="Número de estudiantes",
     main="Gráfica 12 - Polígono Frecuencias
     - tiempo total (horas) - Los estudiantes en los cubículos")
abline(v=mean(DatosPLimpios$HoraCubi), col ="pink",lwd=3)
     abline(v=Mode(DatosPLimpios$HoraCubi), col ="red",lwd=6)
     abline(v=median(DatosPLimpios$HoraCubi), col ="green",lwd=3)
     summary(DatosPLimpios$HoraCubi)
```



```{r echo=FALSE}
hist(DatosPLimpios$HoraBiblio,
     xlab="Tiempo en horas",
     ylab="Número de estudiantes",
     main="Gráfica 13 - Histograma de las horas
     que pasan los estudiantes en la biblioteca", col = "orange"
)
     abline(v=mean(DatosPLimpios$HoraBiblio), col ="pink",lwd=3)
     abline(v=Mode(DatosPLimpios$HoraBiblio), col ="red",lwd=6)
     abline(v=median(DatosPLimpios$HoraBiblio), col ="green",lwd=3)
     summary(DatosPLimpios$HoraBiblio)


```

##Analizamos el número de espacios que es necesario implementar en el nuevo campus

```{r echo=FALSE}
#se hacen los boxplots
par(mar = c(4, 8, 3, 0))
boxplot(DatosPLimpios$NAreasVerdes,DatosPLimpios$NSalaEs, DatosPLimpios$NCubiculo, DatosPLimpios$NZonaR, col=rainbow(4), main="Gráfica 14- Número de ambientes necesarios
        a implementar", names=c("Areas verdes","Salas de estudio","Cubiculos","Zonas recreativas"), las=2, horizontal = TRUE, xlab="N° de ambientes")
summary(DatosPLimpios$NAreasVerdes)
summary(DatosPLimpios$NSalaEs)
summary(DatosPLimpios$NCubiculo)
summary(DatosPLimpios$NZonaR)
sd(DatosPLimpios$NAreasVerdes)
sd(DatosPLimpios$NSalaEs)
sd(DatosPLimpios$NCubiculo)
sd(DatosPLimpios$NZonaR)
```

```{r echo=FALSE}
plot(x= DatosPLimpios$ciclo, y = DatosPLimpios$NCubiculo, main = "
     Gráfica 15 - Relación del número de cubículos
     a implementar según el ciclo en el que se encuentren", ylab="Número de cubículos que necesitan que se implemente según ciclo del alumno", xlab="Ciclo al que pertenecen los estudiantes" )
```

# ANÁLISIS PROBABILÍSTICO

### Diagrama de Gantt
```{r}
# Crea un conjunto de datos de ejemplo
datos <- data.frame(
  Actividad = c("1.-Probabilidad Empírica", "2.-Probabilidad Condicional", "3.-Análisis de la variable discreta ","4.-Análisis de la variable continua", "5.-Elaboración de la PG2 informe","6.-Elaboración de diapositivas PG2"),
  Inicio = as.Date(c("23-06-20", "23-06-22","23-06-24","23-06-28","23-06-30","23-07-03")),
  Fin = as.Date(c("23-06-24", "23-06-27","23-06-30","23-07-04","23-07-05","23-07-06"))
)

# Calcula la duración de cada tarea
datos$Duracion <- as.numeric(datos$Fin - datos$Inicio)

# Crea el diagrama de Gantt utilizando ggplot2
ggplot(datos, aes(col="orange",x = Inicio, xend = Fin, y = Actividad, yend = Actividad)) +
  geom_segment(size = 12) +
  geom_text(aes(x = Inicio + Duracion/10, label = Duracion)) +
  scale_x_date(date_breaks = "3 day", date_labels = "%Y-%m-%d") +
  labs(x = "Fecha", y = "Actividad") + 
  theme_minimal()
```

## Objetivos:

1.  Analizar probabilísticamente el tiempo de estadía de un estudiante
    en el campus de UTEC.

2.  Analizar la probabilidad del tiempo que se demora un estudiante de 
    UTEC en buscar un lugar de estudio.

3.  Analizar la probabilidad del tiempo de estadía de un estudiante de
    UTEC en la biblioteca. 

4.  Analizar probabilísticamente la relación de búsqueda de un espacio
    para estudiar con el tiempo que pasan los alumnos en la universidad.


## Probabilidad Empírica

En nuestro estudio, analizamos el **tiempo que les toma a los alumnos de
la UTEC encontrar un espacio para estudiar**

**Experimento aleatorio**: Seleccionar un estudiante de los 150
encuestados y analizar el tiempo (en horas) que les toma encontrar un
espacio para estudiar.

**Muestra**: 150 alumnos de la UTEC seleccionados por muestreo aleatorio
simple.

**Espacio muestral**: Ω = [0,2.6]

**Eventos**:

A: Si se demora de 0.1 a 0.6 horas en buscar un espacio para estudiar.
$$P(A) = \frac{93}{150} = 0.62000000$$ B: Si se demora más de 0.6 a 1.1
horas en buscar un espacio para estudiar.
$$P(B) = \frac{40}{150} = 0.26666667$$ C: Si se demora más de 1.1 a 1.6
horas en buscar un espacio para estudiar.
$$P(C) = \frac{6}{150}  = 0.04000000$$ D: Si se demora más de 1.6 a 2.1
horas en buscar un espacio para estudiar.
$$P(D) = \frac{5}{150}  = 0.03333333$$ E: Si se demora más de 2.1 a 2.6
horas en buscar un espacio para estudiar.
$$P(E) = \frac{2}{150}  = 0.01333333$$

```{r echo=FALSE}
# Convertir TiempoBuscar a numérico
DatosPLimpios$TiempoBuscar <- as.numeric(DatosPLimpios$TiempoBuscar)

# Crear los intervalos de 1 unidad de tiempo
DatosPLimpios$TiempoBuscar_intervalo <- cut(DatosPLimpios$TiempoBuscar, breaks = seq(from = min(DatosPLimpios$TiempoBuscar), to = max(DatosPLimpios$TiempoBuscar), by = 0.5), include.lowest = TRUE)

# Crear una tabla de frecuencias
tabla_frecuencias_TiempoBuscar <- DatosPLimpios %>%
  count(TiempoBuscar_intervalo) %>%
  mutate(Probabilidad = n / sum(n))

# Imprimir la tabla de frecuencias
print(tabla_frecuencias_TiempoBuscar)

```

Nuestros resultados, según la muestra, evidencian que la mayoría de los estudiantes
pasa entre 0.1 y 0.6 unidades(horas) de tiempo buscando un espacio para estudiar.
Esto sugiere que los estudiantes pasan una cantidad significativa de
tiempo buscando espacios para estudiar dentro de la universidad.



En nuestro estudio, analizamos el **tiempo que los alumnos pasan en la
biblioteca de la universidad**

**Experimento aleatorio** : Seleccionar un estudiante de los 150
encuestados y analizar el tiempo (en horas) que pasan en la biblioteca
de la UTEC. 

**Muestra**: 150 alumnos de la UTEC seleccionados por muestreo
aleatorio simple.

**Espacio muestral**: Ω = [0;5]

Eventos:

A: Si pasa de 0.1 a 1 hora en la biblioteca de la universidad.
$$P(A) = \frac{53}{150} = 0.3533333$$

B: Si pasa más de 1, hasta 2 horas en la biblioteca de la universidad.
$$P(B) = \frac{35}{150} = 0.2333333$$

C: Si pasa más de 2, hasta 3 horas en la biblioteca de la
universidad.
$$P(C) = \frac{29}{150} = 0.1933333$$

D: Si pasa más de 3, hasta 4 horas en la biblioteca de la universidad.
$$P(D) = \frac{15}{150} = 0.1000000$$

E: Si pasa más de 4, hasta 5 horas en la biblioteca de la universidad.
$$P(E) = \frac{18}{150} = 0.1200000$$

```{r echo=FALSE}
# Cargar la librería dplyr
library(dplyr)

# Convertir HorasBiblio a numérico
DatosPLimpios$HorasBiblio <- as.numeric(DatosPLimpios$HoraBiblio)

# Crear los intervalos de 1 hora
DatosPLimpios$HorasBiblio_intervalo <- cut(DatosPLimpios$HoraBiblio, breaks = seq(from = min(DatosPLimpios$HoraBiblio), to = max(DatosPLimpios$HoraBiblio), by = 1), include.lowest = TRUE)

# Crear una tabla de frecuencias
tabla_frecuencias <- DatosPLimpios %>%
  count(HorasBiblio_intervalo) %>%
  mutate(Probabilidad = n / sum(n))

# Imprimir la tabla de frecuencias
print(tabla_frecuencias)
```

La mayoría de los estudiantes (35.3%) pasan entre 0 y 1 hora en la
biblioteca. Un 23.3% de los estudiantes pasan más de 1 hora y hasta 2
horas en la biblioteca, mientras que un 19.3% pasan más de 2 horas
hasta 3 horas. Un menor porcentaje de estudiantes pasan más de 3 horas
en la biblioteca, con un 10% pasando más de 3 horas hasta 4 horas,
y un 12% pasando más de 4 horas hasta 5 horas.

Estos resultados sugieren que la mayoría de los estudiantes de la UTEC
utilizan la biblioteca por períodos de tiempo relativamente cortos. Sin
embargo, hay una proporción significativa de estudiantes que pasan
varias horas en la biblioteca, lo que indica que la biblioteca es un
recurso importante para el estudio y el aprendizaje.


## Probabilidad Condicional

Para verificar si dos eventos son independientes, necesitamos comprobar
si la probabilidad de que ocurra un evento es la misma
independientemente de si el otro evento ocurre o no. En términos de
probabilidad condicional, esto se traduce en la siguiente igualdad:

P(A\|B) = P(A)

Si esta igualdad se cumple, entonces podemos decir que los eventos A y B
son independientes. Si no se cumple, entonces los eventos son
dependientes.

En el contexto del estudio, podríamos definir los siguientes eventos:

Evento A: Un estudiante pasa cierto número de horas en la biblioteca.
Evento B: Un estudiante pasa cierto tiempo buscando un espacio para
estudiar. 
Para verificar si estos eventos son independientes,
necesitaríamos calcular la probabilidad condicional de A dado B
(P(A\|B)) y la probabilidad de A (P(A)), y luego compararlas.

```{r echo=FALSE}
prob_conjunta <- DatosPLimpios %>%
  count(HorasBiblio_intervalo, TiempoBuscar_intervalo) %>%
  mutate(Probabilidad_Conjunta = n / nrow(DatosPLimpios))

# Calcular la probabilidad marginal de HorasBiblio
prob_marginal_HorasBiblio <- DatosPLimpios %>%
  count(HorasBiblio_intervalo) %>%
  mutate(Probabilidad_HorasBiblio = n / nrow(DatosPLimpios))

prob_marginal_TiempoBuscar <- DatosPLimpios %>%
  count(TiempoBuscar_intervalo) %>%
  mutate(Probabilidad_TiempoBuscar = n / nrow(DatosPLimpios))

prob_condicional <- left_join(prob_conjunta, prob_marginal_TiempoBuscar, by = "TiempoBuscar_intervalo")


prob_condicional <- prob_condicional %>%
  mutate(Probabilidad_Condicional = Probabilidad_Conjunta / Probabilidad_TiempoBuscar)

# Unir las tablas de probabilidad condicional y marginal
prob_condicional_marginal <- left_join(prob_condicional, prob_marginal_HorasBiblio, by = "HorasBiblio_intervalo")

# Verificar si los eventos son independientes
prob_condicional_marginal <- prob_condicional_marginal %>% mutate(Son_independientes = abs(Probabilidad_Condicional - Probabilidad_HorasBiblio) < 0.01)

# Imprimir la tabla
print(prob_condicional_marginal)
```

El análisis de probabilidad condicional puede ser una forma efectiva de
descubrir relaciones entre variables entre nuestros datos. Podemos hallar la
probabilidad condicional siguiente manera:

P(A\|B) = P(A ∩ B) / P(B)

Esto se lee como "la probabilidad de A dado B es igual a la probabilidad
de A y B dividida por la probabilidad de B". En otras palabras, estamos
buscando la probabilidad de que ocurra un evento (A) dado que ya sabes
que otro evento (B) ha ocurrido.


En este caso estamos interesados en la probabilidad condicional de que
un estudiante pase más de 6 horas en la UTEC dado que pasa más de una
hora buscando un lugar para estudiar.

Para realizar esto, procederemos con el análisis. Primero calcularemos
la probabilidad de cada evento

```{r}
# Crea un subconjunto para los estudiantes que pasan más de una hora buscando un lugar para estudiar
# Crea un subconjunto para los estudiantes que pasan más de 6 horas en UTEC
tiempou_mayor_6 <- DatosPLimpios$tiempou > 6

tiempo_buscar_mayor_1 <- DatosPLimpios$TiempoBuscar > 1
# Calcula la probabilidad de cada evento
prob_tiempo_buscar_mayor_1 <- mean(tiempo_buscar_mayor_1)
prob_tiempou_mayor_6 <- mean(tiempou_mayor_6)

```

$A$ es el evento de que un estudiante pase más de 6 horas en la UTEC.
$B$ es el evento de que un estudiante pase más de una hora buscando un
lugar para estudiar.

Ahora calcularemos la probabilidad conjunta y condicional.

```{r echo=FALSE}
# Cálculo de probabilidades
tiempo_buscar_mayor_1 <- DatosPLimpios$TiempoBuscar > 1
tiempou_mayor_6 <- DatosPLimpios$tiempou > 6
prob_tiempo_buscar_mayor_1 <- mean(tiempo_buscar_mayor_1)
prob_tiempou_mayor_6 <- mean(tiempou_mayor_6)
prob_ambos <- mean(tiempo_buscar_mayor_1 & tiempou_mayor_6)
prob_condicional <- prob_ambos / prob_tiempo_buscar_mayor_1

```

\$\$
\text{A es el evento de que un estudiante pase más de 6 horas en la UTEC.}\\
\text{B es el evento de que un estudiante pase más de una hora buscando un lugar para estudiar.}\\
P(A) = 0.493\\ P(B) = 0.113\\ P(A\cap B) = 0.053\\ P(A \| B) = 0.471
\$\$ 
P(A) = 0.493: Esta es la probabilidad de que un estudiante pase más
de 6 horas en UTEC. Esto indica que aproximadamente la mitad de los
estudiantes pasa más de 6 horas en UTEC, lo que sugiere que los
estudiantes pueden pasar mucho tiempo en la universidad, ya sea
estudiando, asistiendo a clases o participando en otras actividades.

P(B) = 0.113: Esta es la probabilidad de que un estudiante pase más de
una hora buscando un lugar para estudiar. Esto indica que sólo alrededor
del 11% de los estudiantes pasan más de una hora buscando un lugar para
estudiar. Esto podría indicar que la mayoría de los estudiantes tienen
un lugar preferido para estudiar o que la universidad tiene suficientes
espacios de estudio para acomodar a los estudiantes.

P(A $\cap$ B) = 0.053: Esta es la probabilidad de que un estudiante pase
más de 6 horas en UTEC y más de una hora buscando un lugar para
estudiar. Aproximadamente el 5% de los estudiantes caen en esta
categoría. Esta es una fracción bastante pequeña de los estudiantes, lo
que indica que estos dos comportamientos no suelen ocurrir
simultáneamente.

P(A \| B) = 0.471: Esta es la probabilidad de que un estudiante pase más
de 6 horas en UTEC, dado que pasa más de una hora buscando un lugar para
estudiar. Esto indica que casi la mitad de los estudiantes que pasan más
de una hora buscando un lugar para estudiar también pasan más de 6 horas
en la UTEC. Esto podría sugerir que los estudiantes que necesitan pasar
más tiempo buscando un lugar para estudiar también son más propensos a
pasar más tiempo en la universidad.

En resumen, estos resultados indican que la mayoría de los estudiantes
en UTEC pasan una cantidad significativa de tiempo en la universidad,
pero sólo un pequeño porcentaje pasa una cantidad considerable de tiempo
buscando un lugar para estudiar. Para aquellos estudiantes que sí pasan
mucho tiempo buscando un lugar para estudiar, es más probable que
también pasen una cantidad significativa de tiempo en la universidad.
Esta información podría ser útil para la administración de UTEC al
considerar cómo asignar y gestionar los espacios de estudio en la
universidad.

```{r}
# Crear el gráfico
library(ggplot2)

df <- data.frame(
  HorasBiblio_intervalo = prob_condicional_marginal$HorasBiblio_intervalo,
  TiempoBuscar_intervalo = prob_condicional_marginal$TiempoBuscar_intervalo,
  Probabilidad_Condicional = prob_condicional_marginal$Probabilidad_Condicional,
  Probabilidad_HorasBiblio = prob_condicional_marginal$Probabilidad_HorasBiblio
)

ggplot(df, aes(x=HorasBiblio_intervalo, y=Probabilidad_Condicional, fill=TiempoBuscar_intervalo))+
  geom_bar(stat="identity") +
  geom_text(aes(label=sprintf("%.2f", Probabilidad_Condicional)), position=position_stack(vjust=0.5), size=3) + 
  ylab("Probabilidad condicional") + 
  labs(title="Gráfica 16 - Probabilidad condicional por horas en la biblioteca en función del tiempo de búsqueda")+
  theme_minimal() +
  labs(fill = "Tiempo de búsqueda")
```


## Variables Aleatorias Discretas

### Preferencia de Lugar

Ahora procederemos a analizar la variable de preferencia de lugar. Esta
variable es particularmente importante para nuestro estudio debido a que
expresa la preferencia de los estudiantes a la hora de buscar un lugar
para estudiar. La variable muestra la preferencia de los estudiantes de
acuerdo a los votos.

```{r echo=FALSE}
lugares_divididos <- strsplit(DatosPLimpios$lugar, ", ")
primer_lugar <- sapply(lugares_divididos, "[[", 1)
table(primer_lugar)


```

Como podemos ver, la biblioteca es el lugar favorito de los estudiantes
y luego le siguen las aulas vacías. En este caso, queremos saber la
probabilidad de que un estudiante elija la biblioteca como primera
opción para estudiar. Como el evento escoger la biblioteca es excluyente
de los demás eventos (un estudiante no puede tener dos primeras
opciones), podemos usar probabilidad empírica para formar un proceso
Bernoulli.

Definiremos los parámetros de nuestra variable aleatoria como: $$
\text{Definimos A como la elección de la biblioteca un estudiante como lugar preferido para estudiar  }\\
\text{Siendo p = P(A) = Probabilidad de que un estudiante encuestado escogido al azar responda como lugar favorito la biblioteca }\\
\text{q = 1-p}
$$ Definiremos el éxito como la elección de la biblioteca como éxito y
le asignaremos 1 a este éxito; 0 al fracaso. Siendo caracterizada de
esta forma.

Definimos la variable aleatoria Y como: 
$$
Y \sim \text{ Variable aleatoria que representa la elecciòn de un estudiante al azar }\\
Y = 
\begin{cases} 
1 & \text{si el estudiante elige la biblioteca} \\
0 & \text{si el estudiante elige cualquier otro lugar}
\end{cases}
\\Y \sim Bernulli(p=0.4667)
$$

```{r echo=FALSE}
# Contamos cuántas veces 'Biblioteca' es la primera opción
biblioteca_primera <- sum(primer_lugar == "Biblioteca")

# Obtenemos el número total de observaciones
total_observaciones <- length(primer_lugar)

# Calculamos la probabilidad empírica
probabilidad_biblioteca <- biblioteca_primera / total_observaciones

# Imprimimos el resultado
cat("La probabilidad de que un estudiante escoja la biblioteca como primera opcion es:", probabilidad_biblioteca)
```

Ahora supongamos que tenemos n estudiantes y cada estudiante elige de
manera independiente si su lugar preferido para estudiar es la
biblioteca (con probabilidad p) o no. Entonces, podemos definir una
nueva variable aleatoria X, que es el número total de estudiantes que
eligen la biblioteca como su lugar favorito para estudiar. Esta sigue
una distribución binomial con parámetros n y p.

Una distribución binomial se puede considerar como la suma de n
variables aleatorias independientes, cada una de las cuales sigue una
distribución de Bernoulli. Si tienes una variable aleatoria X que sigue
una distribución de Bernoulli con parámetro p (Y \~ Bernoulli(p)),
entonces la suma de n de estas variables aleatorias independientes
seguirá una distribución binomial.

$$
X \sim \text{ Número de estudiantes que eligen la biblioteca como lugar favorito para estudiar }\\
X \sim \text{Binomial}(n, p)
$$

Una vez que se tiene la variable aleatoria X definida de esta manera,
podemos calcular varias cantidades de interés. Por ejemplo, se puede
calcular la probabilidad de que exactamente k estudiantes elijan la
biblioteca como su lugar preferido para estudiar utilizando la función
de probabilidad de la distribución binomial:

$$
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}
$$

#### Preguntas importantes

Asumiendo que la encuesta es representativa, podemos hacer el siguiente
análisis:

Si le preguntamos a 10 estudiantes si la biblioteca es su lugar
preferido, determinamos la probabilidad de que 6 o más nos digan que la
biblioteca es su lugar favorito para estudiar.

#### Caracterizando la variable aleatoria

$$
P(X \geq 6) = 1 - P(X \leq 5)\\
Siendo\ X \sim \text{Binomial}(10, 0.4667)
$$

Como sabemos, la distribución binomial es una distribución de
probabilidad discreta que nos indica el porcentaje en que es probable
obtener un resultado entre dos posibles al realizar un número n de
pruebas.

En este caso haremos 10 ensayos (10 encuestados) y contaremos la
cantidad de positivos.

```{r}
cat("La probabilidad de que 6 de 10 estudiantes respondan que la biblioteca es su lugar favorito es:",pbinom(5,10,probabilidad_biblioteca,lower.tail = FALSE))
```

Podemos graficar la función de probabilidad.

```{r echo=FALSE}
# Crear una secuencia de números del 1 al 10 (número de éxitos)
x <- 1:10

# Calcular las probabilidades correspondientes utilizando la función dbinom
y <- dbinom(x, 10, probabilidad_biblioteca)

# Crear un gráfico de puntos sin eje x
plot(x, y, xlab = "Número de éxitos", ylab = "Probabilidad",
     main = "Distribución Binomial", pch = 19, xlim = c(1, 10), xaxt = 'n')

# Añadir segmentos desde el eje x hasta los puntos
segments(x0 = x, y0 = 0, x1 = x, y1 = y)

# Añadir explícitamente los ticks del eje x
axis(1, at = 1:10)

```

## Variables aleatorias continuas


### Tiempo en buscar un lugar para estudiar

La primera variable a analizar probabilísticamente es TiempoBuscar. Esta
variable modela el tiempo que un estudiante se demora en encontrar un
lugar o espacio para estudiar. Por teoría, sabemos que los tiempos entre
llegadas se pueden modelar como una variable aleatoria exponencial.
Haremos un histograma para analizar gráficamente esta variable y
determinar si se aproxima a una variable aleatoria exponencial.

```{r echo=FALSE}
hist(DatosPLimpios$TiempoBuscar,  xlab="TiempoBuscar",
     ylab="Frecuencia",
     main="Gráfica 17 - Histograma de Tiempo para buscar un lugar de estudio", col = "lightgreen"
)
```

Como podemos observar, la variable se parece a una distribución
exponencial. Ahora buscaremos caracterizar la variable como una
distribución exponencial.

#### Caracterizando la variable

El único parámetro de una distribución exponencial es la media.

```{r echo=FALSE}
cat("La media de Tiempo Buscar es:", mean(DatosPLimpios$TiempoBuscar),"horas.")
```

Usaremos este valor para generar numeros que sigan esta distribucion
para asi compararla graficamente con esta variable.

```{r echo=FALSE}
var1 <- DatosPLimpios$TiempoBuscar
hist(var1,breaks = 5, probability = TRUE,xlab="TiempoBuscar",
     ylab="Densidad",
     main="Gráfica 18 - Histograma de Tiempo para buscar un lugar de estudio", col = "skyblue")
x <- seq(0,max(var1,length.out = 10))
y <- dexp(x,rate=mean(var1))
lines(x,y,col = "blue")
```

Como podemos observar en las gráficas superpuestas, la variable que fue
obtenida del muestreo se asemeja a la variable generada con la función
generadora de números de R.

Ahora, para comprobar finalmente que la variable se puede modelar con
una distribución exponencial, usaremos el gráfico **Cullen y Frey**. Este
gráfico compara la curtosis y simetría de las variables más conocidas y
nos da una estimación comparada a nuestra variable.

```{r echo=FALSE}
descdist(DatosPLimpios$TiempoBuscar)
```

Como podemos observar, el punto azul que representa nuestra variable,se
encuentra muy cerca al cuadrado con una x. Por lo tanto, podemos decir
que nuestra variable, según Cullen y Frey, se puede caracterizar como
una distribución exponencial. Ahora, después de presentar esta
evidencia, podemos caracterizar nuestra variable como exponencial con
media 0.7669 horas.

$$
X \approx Exp(0.7669)
$$ Siendo X Tiempo de búsqueda de un espacio para estudiar en UTEC.

#### Preguntas Importantes

Analizamos la probabilidad de que un estudiante en UTEC pase mas de 1 hora
buscando un lugar para estudiar.

```{r echo=FALSE}
var4 = pexp(1,mean(DatosPLimpios$TiempoBuscar),lower.tail = FALSE)
```

```{r echo=FALSE}
cat("La probabilidad de que un estudiante en UTEC pase mas de una hora buscando lugar para estudiar es",var4)
```

### Tiempo en la Universidad

El tiempo que un estudiante pasa en la universidad es importante para
determinar el uso de los ambientes dentro de UTEC. Haremos el ajuste de
esta distribución primero haciendo un análisis visual.

```{r echo=FALSE}
hist(DatosPLimpios$tiempou, freq = FALSE, main = "Gráfica 19 - Distribución de Tiempo 
     en Universidad", 
     xlab = "Horas", ylab = "Densidad", col="orchid", ylim = c(0, max(density(DatosPLimpios$tiempou)$y)))
```

#### Caracterización de la variable

Ahora que podemos sospechar que la variable horas en la universidad se
asemeja a una distribución normal, podemos hacer un gráfico con la curva
de densidad teórica basada en la media y la desviación estándar de
nuestros datos.

```{r echo=FALSE}
hist(DatosPLimpios$tiempou, freq = FALSE, main = "Gráfica 20 - Distribución de Tiempo en Universidad", 
     xlab = "Horas", ylab = "Densidad",col = "mistyrose",ylim = c(0, max(density(DatosPLimpios$tiempou)$y)))

# Estimación de parámetros para la distribución normal
mu <- mean(DatosPLimpios$tiempou)
sigma <- sd(DatosPLimpios$tiempou)

# Generar datos normales teóricos
x <- seq(min(DatosPLimpios$tiempou), max(DatosPLimpios$tiempou), length.out = 100)
y <- dnorm(x, mu, sigma)

# Agregar la curva normal al histograma
lines(x, y, col = "blue")
```

Para asegurarnos de que nuestros datos se asemejan a una distribución
normal, vamos a realizar un gráfico Cullen and Frey para analizar la
simetría y la curtosis y compararla con una de una distribución normal

```{r echo=FALSE}
descdist(DatosPLimpios$tiempou)
```

Como podemos observar en el gráfico Cullen y Frey, nuestros datos se
asemejan a una distribución normal. Usando estas pruebas, podemos
caracterizar la variable como normal y hacernos preguntas.

#### Caracterizando la variable

Como sabemos, la distribución normal tiene como parámetros la media y la
desviación estándar. Entonces, para nuestra variable, estos son los
parámetros:

```{r echo=FALSE}
cat("La media es:", mean(DatosPLimpios$tiempou), "y desviación estandar:",sd(DatosPLimpios$tiempou))
```

$$
X \sim \text{Tiempo que pasan los estudiantes en la universidad al día}\\
X \sim Norm(6.7186,2.0226)
$$

#### Preguntas Importantes

Ahora que hemos caracterizado la variable aleatoria, podemos hacernos
preguntas sobre nuestros encuestados. Una pregunta relevante para el
estudio es la probabilidad de que un estudiante al azar pase más de 6
horas en la universidad. Usamos el valor de 2 horas debido a que
consideramos que un estudiante que va a la universidad por más de 6
horas va a tener que sí o sí usar algún ambiente externo a las aulas.

Analizamos la probabilidad de que un estudiante al azar pase más de 6
horas al día en UTEC. Usaremos la función de R pnorm para calcular este
valor.

```{r echo=FALSE}
cat("La probabilidad de que un estudiante pase más de 6 horas al día en UTEC es de:", pnorm(6,mean(DatosPLimpios$tiempou),sd(DatosPLimpios$tiempou),lower.tail = FALSE))
```

$$
P[X >= 6] = Norm(6.7186,2.0226)
$$ \
## Conclusiones del Estudio

1.  **Tiempo que los estudiantes pasan en UTEC:** Se descubrió que
    alrededor del 63.9% de los estudiantes pasan más de 6 horas al día
    en UTEC. Este resultado sugiere que una gran parte de la población
    estudiantil pasa una considerable cantidad de su tiempo diario en la
    universidad, implicando un uso activo de las instalaciones y
    servicios de la universidad.

2.  **Tiempo buscando lugar para estudiar:** Es notable que
    aproximadamente el 46.4% de los estudiantes gasta más de una hora al
    día buscando un lugar para estudiar en UTEC. Esta proporción es
    significativamente alta y podría señalar la necesidad de que la
    universidad proporcione más espacios de estudio, o mejore la
    visibilidad y accesibilidad de los espacios de estudio existentes.

3.  **Tiempo que los estudiantes pasan en la biblioteca:** Se encontró
    que cerca del 86.1% de los estudiantes se retiran de la biblioteca
    en el minuto 120 o después. Esto sugiere que la biblioteca es un
    espacio comúnmente utilizado por los estudiantes para pasar largos
    periodos de tiempo, lo que podría indicar que los estudiantes
    encuentran la biblioteca útil para sus actividades académicas.

4.  **Preferencia por la biblioteca:** La probabilidad de que 6 de cada
    10 estudiantes respondan que la biblioteca es su lugar favorito para
    estudiar es aproximadamente del 29.8%. Aunque esto muestra que la
    biblioteca es un lugar popular, también indica que un número
    significativo de estudiantes tiene preferencia por otros espacios en
    la universidad.

Estas conclusiones brindan información valiosa sobre cómo los
estudiantes de UTEC utilizan las instalaciones de su campus. Esta
información podría ser utilizada para guiar mejoras en los servicios y
recursos proporcionados por la universidad.
