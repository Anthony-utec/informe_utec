---
title: "***S9 Impacto de los factores al escoger una carrera univeritaria en su bienestar academico actual***"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  html_document:
    toc: true
    tod_depth: 10
    toc_float:
      collapsed: false
      smooth_scroll: true
---
> TEMA : **FACTORES AL MOMENTO DE ELEGIR UNA CARRERA UNIVERSITARIA Y SU IMPACTO EN EL BIENESTAR ACADÉMICO DE ALUMNOS UTEC DEL SEGUNDO AL DECIMO CICLO**

## **1.INTRODUCCIÓN**

### 1.1 RELEVANCIA

La elección de una carrera universitaria es una de las decisiones más importantes y a la vez difíciles de la vida de cualquier persona. De esta decisión depende la satisfacción profesional y personal, la estabilidad económica y sobre todo el tipo de impacto y contribución que se le puede brindar a la sociedad. 

Asimismo, al ser una decisión que se toma a una edad relativamente temprana, los factores que se consideran, muchas veces, no responden a la visión propia de la persona, si no que, dependen de la situación y contexto de cada una. Analizar cómo estos factores que influyen en la elección de una carrera se relacionan con el bienestar del estudiante, nos permite indagar y reconocer cuales de ellos, probablemente, son los más adecuados y correctos de tomar en cuenta para tener una elección satisfactoria. De esa manera, se busca compartir esta información con el fin de que los estudiantes, próximos a tomar esta decisión, puedan tener una guía de que factores serían los más adecuados de considerar en la elección de su carrera universitaria.

### 1.2 OBJETIVOS

**General**

- Determinar cuáles son los principales factores que influyen al escoger una carrera en los estudiantes utecsinos.

**Específicos**

- Determinar el impacto del tiempo tomado para escoger una carrera universitaria en relación con su nivel de satisfacción

- Relacionar si algunos factores al elegir una carrera tienen mayor influencia negativa en el desarrollo del alumno

- Determinar la importancia de recibir orientación vocacional para una elección satisfactoria de la carrera

- Identificar el porcentaje de estudiantes que estudian una carrera universitaria por vocación.

### 1.3 CONTEXTO

A la actualidad la elección de una carrera es un proceso complejo que implica considerar múltiples factores, como intereses personales, aptitudes, expectativas socioeconómicas, campo laboral, presión familiar, entre otros. Dicha decisión puede tener un impacto significativo en el bienestar académico de los estudiantes. Con este ultimo nos referimos a la satisfacción, adaptación al entorno educativo, calificaciones y salud mental. Por lo que se puede inferir que un estudiante que elige una carrera alineada a sus intereses y habilidades probablemente experimentara un mayor bienestar académico.

## **2.DATOS**

### 2.1 RECOLECCION DE DATOS

- **Método de recolección de datos:** 
Para llegar recopilar la información de manera concreta y específica , se optó por el uso de una encuesta  hecha en google forms, la cual se muestra en el siguiente [link](https://forms.gle/FjfqgRSb4xtjQPDR7),esto  resulta ser un sistema sencillo, rápido, asequible y accesible para los estudiantes de UTEC.

- **Medio y vía para la recopilación:**
Se decidió realizarlo en línea y difundir la encuesta a través de las redes sociales populares entre los académicos y el correo electrónico institucional de la universidad UTEC. Asimismo de forma presencial en los espacios mas concurridos por los alumnos dentro de la universidad, como sala de estudios, terraza, piso 6, entre otros. 

- **Número mínimo de observaciones:**
Se propuso recolectar una cantidad mínima de 200 observaciones para el estudio a realizar, ya que posteriormente la información obtenida será vaciada a un formato excel, sabiendo que será posible conseguir con la cantidad de datos requeridos, siendo esta mayor a 150 datos limpios.

- **Número de variables a utilizar:** 
Con dicha recolección se obtendrá información en lo que respecta a cada una de las variables, tanto variables cuantitativas y cualitativas , siendo en total de 16 variables.

- **Ejecutar el plan de recolección:** 
La recolección se hizo a través de un código QR y un enlace , utilizando estrategias favorables (recompensa al final de la encuesta ) hacia nuestro público objetivo para que culminen la encuestas de manera satisfactoria 

- **Condiciones para realizar la encuesta:**
La condición establecida para elaborar la encuesta es que nuestro público objetivo  solo seria de segundo a décimo ciclo y  así mismo estaría delimitado con un mínimo de 200 personas

### 2.2 POBLACIÓN, MUESTRA Y MUESTREO

- **Población de estudio:** 
Alumnos de UTEC, que estén cursando entre el segundo y décimo ciclo en el 2023. 
- **Muestra:** 
159 alumnos de pre-grado de UTEC. Alumnos desde el segundo al décimo ciclo de las doce (12) carreras brindadas por la Institución superior para el pre-grado con edades que oscilan desde los 17 hasta los 50 años.
- **Muestreo:** 
En esta investigación, se utilizó el método de muestreo por conveniencia. La elección de este enfoque se basó en la extensa población de la universidad, lo cual dificultaba la aplicación de un muestreo totalmente aleatorio debido al tiempo requerido. En lugar de eso, se decidió seleccionar como muestra a jóvenes del entorno cercano de los investigadores. Esto incluye personas con las que comparten clases, amigos, compañeros de actividades extracurriculares y estudiantes que frecuentan lugares comunes con los integrantes del grupo.
 
### 2.3 VARIABLES

***PREGUNTAS GENERALES:***

1. **¿Cuántos años tienes? (Numérica - Discreta)** : Edad en años cumplidos del alumnos hasta el 2023 (Entre 17 y 50)
2. **Año de egreso del colegio (Numérica - Discreta)** : Año en que se graduó de la secundaria
3. **Ciclo de ingreso a la universidad (Categórica - Nominal)**: Ciclo en el cual empezó la universidad. Por ejemplo: 2022-2, 2022-1
4. **Género (Categórica - Nominal)**: Genero del alumno, hay opciones múltiples entre femenino, masculino y otros.
5. **¿En qué ciclo estás actualmente? (Categórica - Nominal)**: Ciclo que cursa en el presente semestre el alumno (se excluye el ciclo 1) 
6. **¿Qué carrera estudias? (Categórica - Nominal)**: Carrera universitaria actual que estudia en UTEC

***PREGUNTAS ESPECÍFICAS:***

7. **¿Tuviste orientación vocacional? (Categórica - Nominal)**: De opciones múltiples, pero solo puede escoger entre si y no 
8. **¿Qué influyó en la elección de tu carrera? (Categórica - Nominal)**: De opciones múltiples y pues marcar varias o poner otro
9. **¿Cuánto tiempo diario te dedicas a estudiar fuera de las horas de clases? (Numérica - Continua)**: Horas de estudio por alumno menor a las 24 horas, este incluye decimales. Por ejemplo 2.5 para representar a 2 horas y media.
10. **¿Cuál es el monto de salario mensual que esperas después de graduarte? (Numérica - Continua)**: Monto de salario que considere o cree ganar el alumno al egresar de la universidad, este debe oscilar entre los 1000 y 36000 soles, incluye decimales. 
11. **¿Te encuentras en riesgo académico? (Categórica - Nominal)**: De dos únicas opciones, si y no.
12. **¿Alguna vez pensaste en retirarte de tu carrera? (Categórica - Nominal)**: De dos únicas opciones si y no
13. **Si tuvieras la oportunidad de volver a estudiar una carrera.¿Estudiarías tu carrera actual? (Categórica - Nominal)** De dos únicas opciones si y no
14. **Del 1 al 10 qué tan satisfecho te encuentras con la carrera que estudias?(Categórica - Ordinal)**: Únicamente podrá marca el numero que cree conveniente a la respuesta de la pregunta, aquella respuesta se encuentra delimitada entre 1 y 10, sin embargo se considera como cualitativo dado que no es posible hacer operaciones con ellas.
15. **¿Cuál es tu promedio ponderado exacto del semestre pasado? (Numérica - Continua)**: Promedio ponderado del semestre pasado, también incluye números decimales. 
16. **Según la siguiente escala. ¿Cómo consideras que se encuentra tu salud mental? (Categórica - Ordinal)** De opciones múltiples, solo puede marcar uno.


### 2.4 LIMPIEZA DE BASE DE DATOS

 - **Descargamos e instalamos las librerías necesarias**
```{r}
library(readr)
library(dplyr)
```
 
 - **Importamos la base de datos**

```{r}
library(readr)
DA <- read_csv("DatosProyecto.csv")
View(DA)
```

 - **Eliminamos la primera columna dado que no es variable importante para nuestra investigación**
 
```{r}
DA<-DA[,-1]
```

```{r}
summary(DA) #Resumen general de nuestra base de datos
```

 - **Visualizamos los nombres de cada variable en nuestra base de datos para un posterior renombramiento**

```{r}
names(DA)
```

 - **Renombramos variables a unas mas cortas en una nueva base de datos denominado DN**
 
```{r}
DN=rename(DA, Edad ='¿Cuántos años tienes? (Ingrese un valor entero)', EColegio='Año de egreso del colegio (Ingrese un valor entero. Ejem 2020)',CIngreso = 'Ciclo de ingreso a la universidad (Ejem. 2022.1, 2021.2)', Ciclo = '¿En qué ciclo estás actualmente? (del 2 al 10)', Carrera = '¿Qué carrera estudias?', OrientacionVoc = '¿Tuviste orientación vocacional antes de elegir la carrera que actualmente estudias?', Influencia = '¿Qué influyó en la elección de tu carrera? (Puedes marcar más de una)', TiempoEstudio = '¿Cuánto tiempo le dedicas a estudiar al dia ? (Escribir en horas y si requiere de decimales usar el punto.  Ejem: 2.5 => 2 h 30min)', SalarioEsperado = '¿Cuál es el monto mensual de salario que esperas después de graduarte? (Usa punto decimal)',RiesgoAcademico = '¿Te encuentras en riesgo académico?', RetiroCarrera = '¿Alguna vez pensaste en retirarte de la carrera que actualmente estudias en UTEC?', Satisfaccion = 'Del 1 al 10 qué tan satisfecho te encuentras con la carrera que estudias?', PromedioPonderado = '¿Cuál es tu promedio ponderado exacto del semestre pasado? Use punto decimal (0 al 20)', SaludMental = 'Según la siguiente escala. ¿Cómo consideras que se encuentra tu salud mental?', Genero = 'Género biológico', Oportunidad = 'Si tuvieras la oportunidad de volver a estudiar una carrera.¿Estudiarías tu carrera actual de UTEC?')
```

 - **CORRECCION DE DATOS POR VARIABLE**
 
 - *CIngreso: Ciclo de ingreso a la universidad*
 
```{r}
unique(DN$CIngreso) 
```

```{r}
DN %>% mutate(CIngreso =
               ifelse(CIngreso == "2022.1","2022-1",
               ifelse(CIngreso =="2019.1","2019-1",
               ifelse(CIngreso == "2020.1","2020-1",
               ifelse(CIngreso == "2021.1","2021-1",
               ifelse(CIngreso == "2021.0","2021-0",
               ifelse(CIngreso == "2016.1","2016-1",
               ifelse(CIngreso == "2018.1","2018-1",
               ifelse(CIngreso == "2019.2","2019-2",
               ifelse(CIngreso == "2021.2","2021-2",
               ifelse(CIngreso %in% c("2022-II","2022.2"),"2022-2",
               ifelse(CIngreso == "Ninguno" , NA, 
               ifelse(CIngreso == "2022" , NA,
               ifelse(CIngreso == "2020", NA, 
               ifelse(CIngreso == "2021", NA,
               ifelse(CIngreso == "2019", NA,
               ifelse(CIngreso == "626262655151,554251616,6717 ¡¡no pongan la opción de escribir!!", NA, CIngreso
               ))))))))))))))))) -> DN
DN %>% count(CIngreso)
```

 - *Ciclo: Ciclo actual en la universidad*

```{r}
unique(DN$Ciclo)
```

```{r}
DN %>% mutate(Ciclo =
              ifelse(Ciclo == "5to", "5",
              ifelse(Ciclo == "1", NA,Ciclo
              ))) -> DN
DN %>% count(Ciclo)
```

 - *Edad*

```{r}
unique(DN$Edad)
```

```{r}
DN %>% mutate(Edad =
              ifelse(Edad == "21.162.527",NA,
              ifelse(Edad == "1" , NA, Edad
              ))) -> DN
DN %>% count(Edad)
```

 - *Genero*
 
```{r}
unique(DN$Genero)
```

```{r}
DN %>% mutate(Genero =
              ifelse(Genero == "Helicóptero",NA,
              ifelse(Edad == "Soy un Pokémon que se identifica como una iguana extraterrestre con género macho y hembra a la vez" , NA, Genero
              ))) -> DN
DN %>% count(Genero)
```

 - *Carrera*

```{r}
unique(DN$Carrera)
```

```{r}
DN %>% mutate(Carrera =
              ifelse(Carrera == "Ingeniería Eléctrica","Ingeniería Electrónica", Carrera
              )) -> DN
DN %>% count(Carrera)
```

```{r}
unique(DN$TiempoEstudio)
```

- *TiempoEstudio*

```{r}
DN %>% mutate(TiempoEstudio =
              ifelse(TiempoEstudio == "100.000.000.000.000.000.000",NA, TiempoEstudio
              )) -> DN
DN %>% count(TiempoEstudio)
```

 - *SalarioEsperado*

Se sabe que según el portal de estadística salarial salaryexpert, un ingeniero puede ganar en el extranjero hasta 7333 dolares como máximo, mientras que un científico de la computación y uno de datos puede ganar hasta 9542 dolares, por esa razón excluiremos y convertiremos en na's a los datos de la variable SalarioEsperado donde se muestren valores mayores a los mencionado, pondremos de forma general como un mínimo de 1000 soles y como máximo 36000 soles.

```{r}
unique(DN$SalarioEsperado)
```

```{r}
DN %>% mutate(SalarioEsperado =
              ifelse(SalarioEsperado == "1000000",NA, 
              ifelse(SalarioEsperado == "100000000000000", NA, 
              ifelse(SalarioEsperado == "100000", NA, 
              ifelse(SalarioEsperado == "3.500", "3500", 
              ifelse(SalarioEsperado == "4.5", "4500",
              ifelse(SalarioEsperado == "7.000", "7000",
              ifelse(SalarioEsperado == "2.500", "2500",
              ifelse(SalarioEsperado == "20.000", "20000",
              ifelse(SalarioEsperado == "12.0000", "12000",
              ifelse(SalarioEsperado == "10.000", "10000",
              ifelse(SalarioEsperado == "10.000.000.000.000.000.000.000.000.000.000", NA,
              ifelse(SalarioEsperado == "4.000", "4000",
              ifelse(SalarioEsperado == "200.000", NA,
              ifelse(SalarioEsperado == "3.200", "3200",
              ifelse(SalarioEsperado == "5.000", "5000",
              ifelse(SalarioEsperado == "3", NA, 
              ifelse(SalarioEsperado == "1.500", "1500", SalarioEsperado
              ))))))))))))))))))-> DN
DN %>% count(SalarioEsperado)
```

 - *EColegio: Año de egreso del colegio*
 
```{r}
unique(DN$EColegio)
```

```{r}
DN %>% mutate(EColegio =
              ifelse(EColegio == "16",NA,
              ifelse(EColegio == "2022", NA, EColegio
              ))) -> DN
DN %>% count(EColegio)
```


 - **CONVERTIMOS LAS VARIABLES DE ACUERDO A SU TIPO, NUMERICAS DISCRETAS (int) Y CONTINUAS (num), Y CATEGORICAS (char)**

```{r}
DN$EColegio= as.integer(DN$EColegio)
DN$Edad= as.integer(DN$Edad)
DN$TiempoEstudio= as.numeric(DN$TiempoEstudio)
DN$Satisfaccion=as.character(DN$Satisfaccion)
DN$SalarioEsperado= as.numeric(DN$SalarioEsperado)
DN$PromedioPonderado= as.numeric(DN$PromedioPonderado)
```


**Finalizando nuestra limpieza de datos nos quedamos con 159 observaciones limpias, cumpliendo así con la mínima requerida**
```{r}
sum(complete.cases(DN)) 
sum(!complete.cases(DN))
```
**Guardamos únicamente los datos limpios en una nueva base llamada DC**
```{r}
DC <- subset(DN, complete.cases(DN))
```

```{r}
str(DC)
```

## **3.ANALISIS DESCRIPTIVO** 

En este parte de nuestro proyecto realizamos un análisis de las variables mas importantes dentro de nuestra base de datos, dicho análisis se dará a partir de los objetivos planteados inicialmente.

 - **Descargamos e instalamos las librerías necesarias**
```{r}
library(readxl)
library(car)
library(DescTools)
library(raster)
```

### 3.1 OBJETIVO GENERAL 

Determinar cuáles son los principales factores que influyen al escoger una carrera en los estudiantes utecsinos.

### 3.2 OBJETIVO ESPECIFÍCO 1 

Determinar el impacto del tiempo tomado para escoger una carrera universitaria en relación con su nivel de satisfacción 

 - **Hallar y agregar a la data aquel tiempo tomado para escoger una carrera universitaria en UTEC**
 
Para ello se tuvo que filtrar y apartar en una base únicamente las variables CIngreso y EColegio, siendo ambas restadas para obtener el tiempo tomado para escoger una carrera, previo a ello hicimos los cambios necesarios para implementar esta nueva variable, como el cambio de las categorías de la variable CIngreso y su conversión a un tipo de variable numérica. 

```{r}
DCB <- DC[, c("CIngreso", "EColegio")]
```

```{r}
unique(DCB$CIngreso)
```

```{r}
DCB %>% mutate(CIngreso =
               ifelse(CIngreso == "2022-1","2022",
               ifelse(CIngreso =="2022-2","2022.5",
               ifelse(CIngreso == "2021-2","2021.5",
               ifelse(CIngreso == "2020-2","2020.5",
               ifelse(CIngreso == "2019-1","2019",
               ifelse(CIngreso == "2020-1","2020",
               ifelse(CIngreso == "2004-1","2004",
               ifelse(CIngreso == "2021-0","2021",
               ifelse(CIngreso == "2016-1","2016",
               ifelse(CIngreso == "2019-2","2019.5",
               ifelse(CIngreso == "2018-1","2018", 
               ifelse(CIngreso == "2021-1","2021", CIngreso
               ))))))))))))) -> DCB
DCB %>% count(CIngreso)
```

```{r}
str(DCB)
```

```{r}
DCB$CIngreso= as.numeric(DCB$CIngreso)
```

```{r}
Valores <- DCB$CIngreso - DCB$EColegio
```

Insertamos la nueva variable Tiempo_escogercarrera a nuestra base original DC
```{r}
DC <- cbind(DC, Tiempo_escogercarrera = Valores)
```

 - **ANALISIS DE NUESTRA NUEVA VARIABLE TIEMPO PARA ESCOGER UNA CARRERA**

GRÁFICO 1

```{r}
caja <- boxplot(DC$Tiempo_escogercarrera, horizontal = T, main="Tiempo tomado para escoger una carrera universitaria",xlab = "Tiempo (años) ", ylab = " ", las = 1) 
caja
abline(v=0.0,col ="red" )
abline(v=1.5,col ="green" )
abline(v=5.5,col ="blue" )
```

La linea roja corresponde al mínimo datos de la variable analizada dado que no hay datos atípicos a la izquierda
La linea verde representa a la mediana  
La linea es el bigote que propone el boxplot 

ANALISIS: Dada la presencia de datos atípicos es preferible hallar las medidas como la media y mediana de forma separada, primero tomando en cuenta los valores atípicos y segundo excluyendo los mismos 

- **MEDIA Y MEDIANA**

```{r}
summary(DC$Tiempo_escogercarrera)
```
- **MEDIA Y MEDIANA EXCLUYENDO LOS VALORES ATIPICOS**

- FILTROS PARA DATOS ATIPICOS:

```{r}
filtro <- DC$Tiempo_escogercarrera > 5.5 | is.na(DC$Tiempo_escogercarrera)
```

```{r}
mean(DC$Tiempo_escogercarrera[!filtro])
median(DC$Tiempo_escogercarrera[!filtro])
```
- Medida de dispersión

```{r}
cv(DC$Tiempo_escogercarrera)
```
A partir de dicha medida, se demuestra principalmente que el coeficiente de variación es muy alta en comparación de su media, por lo tanto hay mayor dispersión entre los datos.

- Medidas de posición 

```{r}
quantile(DC$Tiempo_escogercarrera,0.85)
```
El 85% de los alumnos encuestados tienen como máximo 3.5 años para escoger la carrera que ellos desean 

- Coeficiente de asimetría 

```{r}
Skew(DC$Tiempo_escogercarrera)
```

Al ser positivo, muestra un sesgo hacia la derecha de parte de esta variable, ademas se puede corroborar aquello teniendo en cuenta que la media es mayor que la mediana. 

 - **ANALISIS DE LA VARIABLE SATISFACCION**

```{r}
DC %>% count(DC$Satisfaccion) %>% arrange(-n)
```


```{r}
Mode(DC$Satisfaccion)
```
Los niveles de satisfaccion con mayor frecuencia son 10 y 8. De ello se deduce que los alumnos de UTEC se encuentran en su mayor parte satisfechos con la carrera que actualmente estudian. 

 - **ANALISIS DE NUESTRO OBJETIVO ENTRE LAS VARIABLES TIEMPO PARA ESCOGER UNA CARRERA Y NIVEL DE SATISFACCION**

```{r}
niveles_Satisfacción = c("1","2","3","4","5","6","7","8","9","10")
labels_Satisfacción= c("1","2","3","4","5","6","7","8","9","10")
Satisfaccion_ordenado = factor(DC$Satisfaccion, ordered = TRUE, levels = niveles_Satisfacción, labels = labels_Satisfacción)
X <- DC$Tiempo_escogercarrera
Y <- Satisfaccion_ordenado
```

GRÁFICO 2

```{r}
Caja2 <- boxplot(X ~ Y, horizontal = F, varwidth = T, main="Nivel de satisfacción respecto al tiempo tomado para escoger una carrera", col = c("#99cc99", "#6989cc"), xlab = "Nivel de satisfaccion", ylab = "Tiempo (años)", ylim= c(0,20), las = 2)
Caja2 
```

El boxplot realizado entre el tiempo para escoger la carrera y el nivel de satisfacción da a conocer la presencia de datos atípicos cuando el nivel de satisfacción es igual a 5, 6, 7, 8 y 9, por lo que no es posible hacer el análisis de un todo, es decir hallar el tiempo promedio para escoger la carrera y que tiempo se muestra como el mas adecuado, tomando en cuenta el nivel de satisfacción mas alto.

 - **COMPARACION DE MEDIA CON Y SIN DATOS ATIPICOS POR NIVEL DE SATISFACCION RESPECTO AL TIEMPO**

```{r}
DC %>% filter(Satisfaccion == 1) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 1 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 3) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 3 & Tiempo_escogercarrera <= 2.5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 4) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 4 & Tiempo_escogercarrera <= 2) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 5) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 5 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 6) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 6 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 7) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 7 & Tiempo_escogercarrera <= 4) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 8) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 8 & Tiempo_escogercarrera <= 4.5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 9) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 9 & Tiempo_escogercarrera <= 5) %>% pull(Tiempo_escogercarrera) %>% mean
```

```{r}
DC %>% filter(Satisfaccion == 10) %>% pull(Tiempo_escogercarrera) %>% mean
DC %>% filter(Satisfaccion == 10 & Tiempo_escogercarrera <= 5) %>% pull(Tiempo_escogercarrera) %>% mean
```

 - **COMPARACION DE MEDIANA  CON Y SIN DATOS ATIPICOS POR NIVEL DE SATISFACCION RESPECTO AL TIEMPO**

```{r}
DC %>% filter(Satisfaccion == 1) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 1 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 3) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 3 & Tiempo_escogercarrera <= 2.5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 4) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 4 & Tiempo_escogercarrera <= 2) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 5) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 5 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 6) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 6 & Tiempo_escogercarrera <= 1.5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 7) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 7 & Tiempo_escogercarrera <= 4) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 8) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 8 & Tiempo_escogercarrera <= 4.5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 9) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 9 & Tiempo_escogercarrera <= 5) %>% pull(Tiempo_escogercarrera) %>% median
```

```{r}
DC %>% filter(Satisfaccion == 10) %>% pull(Tiempo_escogercarrera) %>% median
DC %>% filter(Satisfaccion == 10 & Tiempo_escogercarrera <= 5) %>% pull(Tiempo_escogercarrera) %>% median
```

La comparación entre la media y la mediana con y sin datos atipicos, nos brinda la mejor medida para estblecer un valor central de tiempo para escoger una carrera en años por nivel de satisfacción. 

Por lo que para cada categoría de la variable satisfacción tenemos los siguiente resultados:

- Si la media varia con y sin datos atipicos, la mediana sera el mas adecuado como medida de tendencia central para el analisis de dicho tiempo en su respectivo nivel de satisfaccion, por lo que: 

    - Niveles con datos atipicos: Variacion de la media, por lo tanto uso de la mediana
    
         Nivel 5, 7, 8 y 9

    - Niveles sin datos atipicos: Permanencia de valores en las medidas media y mediana con y sin datos atipicos, usaremos la media. 

         Nivel 1, 3, 4 y 10 
         
    - Inusuales: 
    
        Nivel 2: No hay presencia de casos que hayan validado como una de sus respuestas a la encuesta un nivel de satisfaccion de 2 
        
        Nivel 6: Tanto la mediana y media varian, por lo que se compara ambas medidas siendo la mediana mas adecuada por su menor variacion, tomaremos en consideracion al valor con datos atipicos
    
    
 - **Tabulacion de nivel de satisfacción versus el valor central del tiempo tomado para escoger una carrera**


```{r}
Nivel_de_satisfaccion <- c(1, 3, 4, 5, 6, 7, 8, 9, 10)
Tiempo_para_escoger_una_carrera <- c(1.25, 2.5, 1.75, 1.5, 1.5, 1.5, 2, 2.5, 2)
DF<- data.frame(Nivel_de_satisfaccion, Tiempo_para_escoger_una_carrera)
DF %>% arrange(-Nivel_de_satisfaccion)
```

El impacto del tiempo tomado para escoger una carrera resulta a la actualidad muy importante y en términos matemáticos este se analiza mediante nuestro proyecto, en donde a partir de nuestra gráfica adquirimos valores centrales que representan al tiempo en años que demora un alumno al escoger su carrera y el nivel de satisfacción que actualmente tienen. 

Con la ultima data frame:
- El menor nivel de satisfacción (1) tiene una tiempo de 1.25 años 
- El mayor nivel de satisfacción (10) de 2 años.
- El mayor tiempo es de 2.5 años con un nivel de satisfacción de 9 que consideramos es bastante alto y 3 bastante bajo, en esta parte encontramos un contraste u oposición entre ambos valores, dado que del 100% de personas validadas en nuestra base de datos el 18.87% marcan un nivel de satisfacción de 9, mientras que el 0.63% valida su nivel de satisfacción de 3. De ello se infiere que al haber mayor cantidad con nivel de satisfacción en 9 respecto al mayor tiempo central encontrado (2.5 años), se considera el mas apropiado para escoger una carrera universitaria y estar satisfechos con la misma. 

De aquellos resultados podemos dar a conocer que en promedio el tiempo que se debe de tomar para escoger una carrera debe de oscilar entre 2 y 2.5 años para obtener un nivel de satisfacción alto entre 8 y 10.

### 3.2 OBJETIVO ESPECIFÍCO 2
Relacionar si algunos factores al elegir una carrera tienen mayor influencia negativa en el desarrollo del alumno

 - **Instalamos y descargamos librerias**
 
```{r}
library(stringr)
library(tidyr) 
library(car)
``` 

 - **Relacionamos entre los factores al elegir una carrera y la salud mental**
 
 Observamos como esta cada dato de la variable Influencia
```{r}
unique(DC$Influencia)
```

Separamos los datos que tienen comas para poner formar otra base de datos en donde cada dato tenga solo una opcion. Por lo que tendremos más observaciones 
```{r}
nuevadata <- DC %>%                
  separate_rows(Influencia, sep=",") 
nuevadata                         
```

Ahora podremos visualizar que los datos ya no tienen "," . Pero vemos que hay un dato vació y los otros datos tienen el mismo nombre pero con espacio en blanco
```{r}
unique(nuevadata$Influencia)
```

En esta parte colocamos para poner eliminar el espacio en blanco y que R lo lea los otros datos como uno solo y sin espacio

```{r}
nuevadata %>% mutate(Influencia =
              ifelse(Influencia == "",NA, 
              ifelse(Influencia == " Campo laboral","Campo laboral", 
              ifelse(Influencia == " Habilidades", "Habilidades", 
              ifelse(Influencia == " Intereses", "Intereses", 
              ifelse(Influencia == " Ubicación de la universidad", "Ubicación de la universidad",
              ifelse(Influencia == " Salario", "Salario",
              ifelse(Influencia == "Presión familiar" , " Presión familiar",
              ifelse(Influencia == " Test vocacional","Test vocacional",
              ifelse(Influencia == " Posibilidad de obtener una beca", "Posibilidad de obtener una beca", Influencia
            
              ))))))))))-> nuevadata
nuevadata %>% count(Influencia)
```


 - **Al hacer el conteo, efectivamente nos sale que tenemos 502 observaciones y dentro de ellas esta el NA**

```{r}
nrow(nuevadata)
```
-Lo visualizamos con unique
```{r}
unique(nuevadata$Influencia)
```

- Ahora como no trabajaremos con NA, llamamos a una nueva base de datos en donde solo tenga los casos completos
```{r}
NV <- subset(nuevadata, complete.cases(nuevadata))
```

 - **Visualizamos que ahora tendremos 501 datos completos**

```{r}
nrow(NV)
```


TABLA 1:  FACTORES AL ELEGIR SU CARRERA Y SU SALUD MENTAL ACTUAL

- Hacemos una tabla donde podremos ver cuantos de los que votaron por factores tienen su respectiva salud mental
```{r}
table(NV$Influencia, NV$SaludMental)
```


TABLA 2: SUMA DE TABLA DE FACTORES AL ELEGIR SU CARRERA Y SU SALUD MENTAL ACTUAL
- Hacemos la suma
```{r}
addmargins(table(NV$Influencia, NV$SaludMental))
```

TABLA 3: PORCENTAJE DE TABLA DE FACTORES AL ELEGIR SU CARRERA Y SU SALUD MENTAL ACTUAL
- Imprime el porcentaje de factores con respecto a la salud mental que marcaron
```{r}
round(table(NV$Influencia, NV$SaludMental)/rowSums(table(NV$Influencia, NV$SaludMental))*100,digits=2)
```

TABLA 4: PORCENTAJE DE TABLA DE FACTORES AL ELEGIR SU CARRERA Y SU SALUD MENTAL ACTUAL DEL TOTAL DE OBSERVACIONES
- Imprime el porcentaje que le corresponde a cada factor con salud mental del total de todas las observaciones
```{r}
round(prop.table(table(NV$Influencia, NV$SaludMental))*100,2)
```


```{r}
Mode(NV$Influencia)
```
```{r}
Mode(NV$SaludMental)
```
```{r}
by(NV$Influencia,NV$SaludMental,Mode)
```
- Aparentemente el factor que más influyó en una buena salud mental son los intereses. Asimismo, hay un gran porcentaje en el cual el factor que más influyó son los intereses pero con una salud mental Mala, Muy mala, Regular y muy buena. 

GRÁFICO 3
```{r}
SaludMental = c("Muy malo", "Malo","Regular","Bueno", "Muy bueno")
labels_SM = c("Muy malo", "Malo","Regular","Bueno", "Muy bueno")
NV$SaludMental = factor(NV$SaludMental, ordered = TRUE, levels = SaludMental, labels = labels_SM)
mosaicplot(NV$SaludMental ~ NV$Influencia, main=" Salud Mental según los factores al elegir su carrera", xlab="Salud Mental", ylab="Factores", col = c("#cc9999", "#9c9c9c", "#96195c", "#6989cc","#99cc99"), las=1)
```

 - **RELACIÓN DE LOS FACTORES CON EL PROMEDIO PONDERADO**
 
TABLA 5
```{r}
table(nuevadata$Influencia)
```

TABLA 6
```{r}
table(nuevadata$PromedioPonderado)
```

```{r}
unique(nuevadata$PromedioPonderado)
```

- **Convertimos los promedios ponderados en enteros para tener una mejor visualización en la tabla cruzada**

```{r}
nuevadata %>% mutate(PromedioPonderado = 
                             ifelse(PromedioPonderado  %in% c("12.1","12.21","12.3","12.33","12.42"),"12",
                             ifelse(PromedioPonderado  == "10.35","10",
                             ifelse(PromedioPonderado  %in% c("12.5","12.85","12.94","12.98","13.12","13.15","13.2","13.45"),"13",
                             ifelse(PromedioPonderado  %in% c("13.5","13.54","13.6","13.63","13.7","13.8","13.85","14.13","14.16","14.2","14.29","14.31"),"14",
                             ifelse(PromedioPonderado  %in% c("14.5","14.6","14.69","14.7","14.75","14.78","14.8","14.9","14.94","15.14","15.16","15.24","15.25","15.3","15.32","15.34"),"15",
                             ifelse(PromedioPonderado  %in% c("15.5","15.6","15.65","15.68","15.69","15.7","15.82","15.83","15.85","15.89","16.15","16.32","16.4","16.45"),"16",
                             ifelse(PromedioPonderado  %in% c("16.5","16.64","16.8","16.9","16.95","17.1","17.2","17.45"),"17", 
                             ifelse(PromedioPonderado  %in% c("17.5","17.56","17.62","17.89","18.15"),"18",
                             ifelse(PromedioPonderado  %in% c("18.65","18.7"),"19", PromedioPonderado
                             )))))))))) -> nuevadata
                                    
```

```{r}
nuevadata$PromedioPonderado = as.numeric(nuevadata$PromedioPonderado)
```

 - **Tabla cruzada**
 
TABLA 7
```{r}
tablacruzada <- xtabs(~nuevadata$Influencia + nuevadata$PromedioPonderado, data = nuevadata)
addmargins(tablacruzada)
```


 - **Realizamos un Barplot para visualizar la variable Influencia**

GRÁFICO 4
```{r}
tabla1 <- table(nuevadata$Influencia)
barplot(tabla1, col = "purple", xlab ='Influencias que llevaron a escoger la carrera', ylab='Frecuencia relativa',las=1)
```

- Para la visualización de la variable Promedio Ponderado utilizamos un Histograma. Al cual se le agrega la mediana y la media

```{r}
media <- mean(DC$PromedioPonderado)
```

```{r}
mediana <- median(DC$PromedioPonderado)
```

GRÁFICO 5
```{r}
hist(DC$PromedioPonderado,breaks = "Sturges", col = "red", main = "Histograma Promedio Ponderado", xlab= "Promedio Ponderado", ylab = "Frecuencia")
abline(v = media, col = "green", lwd =2)
abline(v = mediana, col = "purple", lwd =2)
```

 - **Instalamos y descargamos**

```{r}
library(ggplot2)
```

-Para la visualización de la relación entre influencias y el Promedio Ponderado hemos utilizado un gráfico de puntos.
GRÁFICO 6
```{r}
ggplot(nuevadata, aes(x = Influencia, y = PromedioPonderado)) +
       geom_point() +
       xlab("Influencias") +
       ylab("Promedio Ponderado") +
       ggtitle("Relación entre Influencias y el Promedio Ponderado")
```


 - **Interpretación del Gráfico**

Se observa en el gráfico la relación entre las Influencias por las que se eligió una carrera y el Promedio Ponderado. Dentro de lo que podemos observar que todas las influencias tienen una distribución similar. Sin embargo se ve que en el caso de haber escogido la carrera por Presión familiar, no hay nota mayor a 16, mientras que en todas las demás influencias si encontramos una nota mayor a 16. Con lo que podemos decir que cuando uno es forzado a escoger una carrera, tiende a no esforzarse tanto en su rendimiento académico. 
 
GRÁFICO 7
```{r}
ggplot(nuevadata, aes(x = Influencia, y = PromedioPonderado)) +
  geom_violin() +
  xlab("Influencias") +
  ylab("Promedio ponderado") +
  ggtitle("Relación entre Influencias y Promedio ponderado")
```


```{r}
quantile(DC$PromedioPonderado, 0.3)
```


```{r}
sd(DC$PromedioPonderado)
```
```{r}
sd(DC$PromedioPonderado) / mean(DC$PromedioPonderado) * 100
```

### 3.4 OBJETIVO ESPECIFÍCO 3 

Determinar la importancia de recibir orientación vocacional para una elección satisfactoria de la carrera

 - **Tablas y gráficos**

 TABLA 8: ORIENTACIÓN VOCACIONAL

```{r}
VO = table(DC$OrientacionVoc) #CONTEO DE ESTUDIANTES QUE RECIBIERON Y NO ORIENTACIÓN VOCACIONAL
VP = round(prop.table(VO)*100,2) #PORCENTAJE DE ESTUDIANTES QUE RECIBIERON Y NO ORIENTACIÓN VOCACIONAL
cbind(VO,VP)
DOV <- cbind(VO, VP)
```
De esta tabla podemos determinar que 106 encuestados, es decir, el 65.43% del total, recibieron orientación vocacional. Asimismo, 56 encuestados no recibieron orientación vocacional, es decir, el 34.57% del total.


 - **SATISFACCIÓN CON RESPECTO A SU CARRERA**

Considerando los siguientes parámetros para agrupar el nivel de satisfacción:
- De 1 a 2: muy insatisfecho con su carrera (MINS)
- De 3 a 4: insatisfecho con su carrera (INS)
- De 5 a 6: neutral (N)
- De 7 a 8: satisfecho con su carrera (ST)
- De 9 a 10: muy satisfecho con su carrera (MST)

```{r}
DG<- DC
```


```{r}
DG %>% mutate(Satisfaccion =
        ifelse(Satisfaccion %in% c("1", "2"), "MUY INSATISFECHO",
        ifelse(Satisfaccion %in% c("3", "4"), "INSATISFECHO",
        ifelse(Satisfaccion %in% c("5", "6"), "NEUTRO",
        ifelse(Satisfaccion %in% c("7", "8"), "SATISFECHO",
        ifelse(Satisfaccion %in% c("9","10"),"MUY SATISFECHO", Satisfaccion))))))-> DG
DG %>% count(Satisfaccion)
```


```{r}
niveles_Satisfacción = c("MUY INSATISFECHO", "INSATISFECHO","NEUTRO","SATISFECHO", "MUY SATISFECHO")
labels_Satisfacción = c("MUY INSATISFECHO", "INSATISFECHO","NEUTRO","SATISFECHO", "MUY SATISFECHO")
DG$Satisfaccion = factor(DG$Satisfaccion, ordered = TRUE, levels = niveles_Satisfacción, labels = labels_Satisfacción)
```



TABLA 9: SATISFACCIÓN CON RESPECTO A SU CARRERA

```{r}
VS = table(DG$Satisfaccion) #CONTEO DE ESTUDIANTES QUE RECIBIERON Y NO ORIENTACIÓN VOCACIONAL
PS = round(prop.table(VS)*100,2) #PORCENTAJE DE ESTUDIANTES QUE RECIBIERON Y NO ORIENTACIÓN VOCACIONAL
cbind(VS,PS)
```

De esta tabla podemos determinar que el nivel de satisfacción con mayor porcentaje es SATISFECHO, es decir, el 41,98% de estudiantes está satisfecho con su carrera.


 - **MODA DE ORIENTACIÓN VOCACIONAL**

```{r}
Mode(DC$OrientacionVoc)
```

La categoría de Orientación vocacional que se da con mayor frecuencia es sí, es decir, la mayoría de estudiantes SI recibió orientación vocacional.

 - **MODA DE LA SATISFACCIÓN CON RESPECTO A SU CARRERA**

```{r}
Mode(DG$Satisfaccion)
```

La categoría de Satisfacción que se da con mayor frecuencia es SATISFECHO.

 - **MODA DE ORIENTACIÓN VOCACIONAL CON RESPECTO A EL NIVEL DE SATISFACCIÓN**

```{r}
by(DC$OrientacionVoc, DG$Satisfaccion,Mode)
```

En base ello, podemos determinar que: 

- Los estudiantes que se sienten MUY INSATISFECHOS con respecto a su carrera son en mayor frecuencia aquellos que NO recibieron orientación vocacional.

- Los estudiantes que se sienten INSATISFECHOS con respecto a su carrera son en mayor frecuencia aquellos que SI recibieron orientación vocacional.

- Los estudiantes que se sienten NEUTROS (ni satisfechos ni insatisfechos) con respecto a su carrera son en mayor frecuencia aquellos que NO recibieron orientación vocacional.

- Los estudiantes que se sienten SATISFECHOS con respecto a su carrera son en mayor frecuencia aquellos que SI recibieron orientación vocacional.

- Los estudiantes que se sienten MUY SATISFECHOS con respecto a su carrera son en mayor frecuencia aquellos que SI recibieron orientación vocacional.


TABLA 10: CANTIDAD DE ESTUDIANTES QUE RECIBIERON O NO ORIENTACIÓN VOCACIONAL SEGÚN CADA NIVEL DE SATISFACCIÓN
```{r}
table(DC$OrientacionVoc, DG$Satisfaccion)
```

```{r}
addmargins(table(DC$OrientacionVoc, DG$Satisfaccion))
```

TABLA 11: PORCENTAJE DE ESTUDIANTES QUE RECIBIERON O NO ORIENTACIÓN VOCACIONAL CON RESPECTO SU NIVEL DE SATISFACCIÓN
```{r}
round(prop.table(table(DC$OrientacionVoc,DG$Satisfaccion), margin=2)*100,2)
```

Enfoncandonos en los niveles más altos de satisfacción (SATISFECHO Y MUY SATISFECHO) podemos indicar que, del total de estudiantes que se sienten SATISFECHOS con respecto a su carrera, el 73,53% SI recibieron orientación vocacional. 

De la misma manera,del total de estudiantes que se sienten MUY SATISFECHOS con respecto a su carrera, el 65,67% SI recibieron orientación vocacional. 


TABLA 12: PORCENTAJE DE ESTUDIANTES SEGÚN LA VARIABLE ORIENTACIÓN VOCACIONAL CON RESPECTO A SU NIVEL DE SATISFACCIÓN (TOTAL)

```{r}
round(prop.table(table(DC$OrientacionVoc,DG$Satisfaccion))*100,2)
```

GRAFICO 8 
```{r}
DG$Satisfaccion = factor(DG$Satisfaccion, ordered = TRUE, levels = niveles_Satisfacción, labels = labels_Satisfacción)
mosaicplot(DC$OrientacionVoc ~ DG$Satisfaccion, main="Satisfacción hacia la carrera según la toma de orientación vocacional", xlab="Orientación Vocacional", ylab="Satisfacción con respecto a la carrera", col = c("#99cc99", "#cc9999", "#6989cc", "#9c9c9c","#96195c"), las=1)
```

En la actualidad, recibir orientación vocacional es una herramienta muy importante y fundamental para la correcta elección de una carrera. Lo cual podemos corroborar a través de nuestro proyecto, donde, del total de estudiantes que se sienten SATISFECHOS con respecto a su carrera, el 73,13% SI recibieron orientación vocacional. De la misma manera,del total de estudiantes que se sienten MUY SATISFECHOS con respecto a su carrera, el 65,67% SI recibieron orientación vocacional. 

Asimismo, podemos apoyar esta idea con nuestra gráfica donde se aprecia que la mayor cantidad de estudiantes, el 30,86%, SI recibieron orientación y se encuentran SATISFECHOS con su carrera. Además, el 27,67% de estudiantes se encuentran MUY SATISFECHOS y SI recibieron orientación vocacional.
De la misma manera, se puede evidenciar ningún estudiante que SI recibió orientación vocacional se siente MUY INSATISFECHO con su carrera.

De esta forma, aparentemente existe una relación directa entre tener un nivel de satisfacción alto con respecto a la carrera (SATISFECHO Y MUY SATISFECHO) con el recibir orientación vocacional. Es decir, se puede inferir que las personas que tienen un nivel de SATISFACCIÓN ALTO, en su mayoría, son aquellas que SI recibieron orientación vocacional. 


### 3.5 OBJETIVO ESPECIFÍCO 4
Identificar el porcentaje de estudiantes que estudian una carrera universitaria por vocación.  

TABLA 13: Porcentaje de estudiantes que estudian una carrera universitaria por vocación.

```{r}
# Crear una nueva variable respuesta_SI usando ifelse
Df <- ifelse(grepl("Test vocacional", DC$Influencia, ignore.case = TRUE), "SI", "NO")
table(Df)
# Calcular el porcentaje de respuestas "SI"
porcentaje_SI <- prop.table(table(Df))["SI"] * 100
round(porcentaje_SI,2)
```
Después de haber realizado el estudio , evaluamos el porcentaje de numero de alumnos que estudian su carrera universitaria por vocacion , ese porcentaje es equivalente al 31.45% , lo cual podemos inferir que menos de la mitad de estudiantes encuestados estudian su carrera universitaria porque realmente les gusta y se ha demostrado con este porcentaje que mas de la mitad de estudiantes de la UTEC estudian su carrera por influencia de otros factores.





