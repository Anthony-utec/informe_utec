---
title: "Informe"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r include=FALSE, paged.print=FALSE, results=FALSE}
list.of.packages <- c("readr", "dplyr", "modeest", "Rlab", "knitr")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)

library(readr)
library(dplyr)
library(modeest)
```

![](Utec.jpg){width="400" height="400" style="display: block; margin: 0 auto"}

# ***Impacto de la Música en la salud mental de las personas***

## Introducción

En el presente proyecto se abarcará el tema de la relación entre la música y de que forma influye en la salud mental de las personas específicamente en la ansiedad, depresión, insomnio y TOC (Trastorno Obsesivo Compulsivo). Para ello usaremos una base de datos, que es el resultado de una encuesta publicada en varias plataformas web, realizada desde el 27/08/2022 hasta el 09/11/2022.

### Relevancia

La música está presente en todas las etapas de la vida, con diversos géneros y artistas. Al escuchar música, regulamos nuestras emociones y experimentamos felicidad, relajación y tristeza. La música forma parte de momentos memorables con familia, amigos o simplemente cuando la disfrutamos en solitario.

Estudios demuestran que la música estimula el cerebro, mejora el estado de ánimo y libera emociones negativas. También beneficia el sueño, la memoria y reduce el estrés, promoviendo la salud mental. Este proyecto busca explorar la influencia del consumo de música en el estado emocional.

Durante el desarrollo del proyecto, se observó que la música es importante para todas las edades. La muestra incluyó personas de 12 a 80 años, revelando su papel crucial en el desarrollo humano. El análisis de datos reveló una correlación entre trastornos emocionales y el tiempo dedicado a escuchar música diariamente.

### Justificación

Esta investigación busca comprender cómo la música influye en el bienestar psicológico. Adoptamos un enfoque estadístico, analizando datos relevantes de una muestra representativa obtenida a través de una encuesta dirigida al público general. Nos enfocamos en personas de 12 a 80 años para encontrar vínculos entre el consumo de música y trastornos como ansiedad, insomnio, OCD y depresión.

Esperamos que este proyecto aporte nueva información sobre la relación entre música, estado de ánimo y trastornos, promoviendo la conciencia sobre el papel de la música en la salud mental. Con una comprensión más clara, podremos desarrollar estrategias para mejorar el bienestar de quienes sufren estos trastornos.

### Objetivos

#### Objetivo General

En este estudio, nos proponemos definir y analizar la relación entre el consumo de música y el estado emocional de las personas. Reconocemos que la música tiene el poder de evocar emociones, y queremos comprender cómo esta influencia puede variar según diferentes factores.

#### Objetivos Específicos

-   Identificar que género musical es el que influye más en cada estado de salud mental.

-   Determinar si la edad es un factor influyente al género de música que se escucha.

-   Demostrar si las horas de consumo de música al día inciden en el comportamiento de las personas.

-   Estimar cual es el rango de edad de las personas que presentan problemas con su estado emocional.

### Contexto

En 2022, durante la salida de la pandemia, se observaron problemas de insomnio, ansiedad, depresión y trastorno obsesivo-compulsivo (TOC). Este análisis busca estudiar la relación entre música y salud mental.

Previo al proyecto, se investigó el tema, se establecieron los objetivos y se determinó la relevancia de cada variable. Debido a la amplia cantidad de datos disponibles, nos enfocamos en personas de 12 a 80 años, según una clasificación que se explicará próximamente.

## Datos

### Recolección de datos

Catherine Rasgaitis, de la universidad de Washington, Estados Unidos, se encargó de recolectar datos a través de un formulario de Google, sin restricciones de edad o ubicación para los encuestados.

El formulario se difundió en varios foros de Reddit, servidores Discord y plataformas de redes sociales. Además, se utilizaron carteles y "tarjetas de visita" para promocionar el formulario en bibliotecas, parques y otros lugares públicos.

El formulario fue diseñado de manera concisa para aumentar la probabilidad de que los encuestados completaran la encuesta. Las preguntas más desafiantes, como el BPM, se dejaron como opcionales por la misma razón.

### Población, muestra y muestreo

En nuestro proyecto estadístico, utilizamos una base de datos obtenida de Internet con una amplia población de más de 700 observaciones iniciales. La encuesta abarcó personas de diversas edades, incluyendo mayores de 80 años y diferentes nacionalidades.

Es importante destacar que no realizamos la etapa de recolección de datos, como la selección de una muestra específica o el uso de encuestas. Por lo tanto, no tenemos información detallada sobre dicho proceso.

No obstante, llevamos a cabo la limpieza de los datos, cuyos detalles se explicarán más adelante.

### Variables

| Variable                     | Tipo de variable   | Descripción                                                                                                                                                                                                                                                                          |
|-----------------|-----------------|--------------------------------------|
| `Age`                        | Numérica discreta  | Toma valores del intervalo [12, 80]. Representa la edad en años cumplidos de cada                                                                                                                                                                                                    |
| `Primary_streaming_service`  | Categórica nomina  | Toma valores de las posibles principales plataformas de música(o ninguna) que escuchen las personas: {Spotify, YouTube Music, Apple Music, Other streaming service, Pandora, I do not use a streaming service}. Representa la principal plataforma de música que escucha una persona |
| `Hours_per_day`              | Numérica Continua  | Variable aleatoria que representa el tiempo que una persona escucha música durante el día                                                                                                                                                                                            |
| `While_working`              | Categórica nominal | Toma valores lógicos `Yes` o `No`. Representa si la persona escucha música mientras trabaja                                                                                                                                                                                          |
| `Instrumentalist`            | Categórica nominal | Toma valores lógicos `Yes` o `No`. Representa si la persona toca instrumentos                                                                                                                                                                                                        |
| `Composer`                   | Categórica nominal | Toma valores lógicos `Yes` o `No`. Representa si la persona compone música                                                                                                                                                                                                           |
| `Fav_genre`                  | Categórica nominal | Toma valores entre los distintos géneros musicales favoritos de las personas: {Classical, Country, EDM, Folk, Gospel, HipHop, Jazz, Kpop, Latin, Lofi, Metal, Pop, R_B, Rap, Rock, Video game}. Representa el género musical favorito de la persona                                  |
| `Exploratory`                | Categórica nominal | Toma valores lógicos `Yes` o `No`. Representa si la persona escucha nuevos géneros o artistas, diferentes a los que suele escuchar                                                                                                                                                   |
| `Foreign_languages`          | Categórica nominal | Toma valores lógicos `Yes` o `No`. Representa si la persona suele escuchar música con letra en un idioma que no domina                                                                                                                                                               |
| `Frequency_Classical`        | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música clásica (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.             |
| `Frequency_Country`          | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música country (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.             |
| `Frequency_EDM`              | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música EDM (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                 |
| `Frequency_Folk`             | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música folk (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                |
| `Frequency_Gospel`           | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música gospel (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.              |
| `Frequency_HipHop`           | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música hiphop (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.              |
| `Frequency_Jazz`             | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música jazz (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                |
| `Frequency_K_pop`            | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música kpop (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                |
| `Frequency_Latin`            | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música latina (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.              |
| `Frequency_Lofi`             | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música lofi (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                |
| `Frequency_Metal`            | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música metal (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.               |
| `Frequency_Pop`              | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música pop (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                 |
| `Frequency_R_B`              | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música R_B (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                 |
| `Frequency_Rap`              | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música rap (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                 |
| `Frequency_Rock`             | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música rock (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.                |
| `Frequency_Video_game_music` | Categórica ordinal | Toma valores de escala de frecuencia en que se escucha el género de música de videojuegos (tomando solo las palabras clave de frecuencia en que se escucha el género): {Never, Rarely, Sometimes, Very frequently}. Representa la frecuencia con la que se escucha este género.      |
| `Anxiety`                    | Numérica discreta  | Define el nivel de ansiedad de la persona(en una horquilla del 1 al 10)                                                                                                                                                                                                              |
| `Depression`                 | Numérica discreta  | Define el nivel de depresión de la persona(en una horquilla del 1 al 10)                                                                                                                                                                                                             |
| `Insomnia`                   | Numérica discreta  | Define el nivel de Insomnio de la persona(en una horquilla del 1 al 10)                                                                                                                                                                                                              |
| `OCD`                        | Numérica discreta  | Define el nivel de OCD(Trastorno obsesivo compulsivo) de la persona(en una horquilla del 1 al 10)                                                                                                                                                                                    |
| `Music_effects`              | Categórica nominal | Toma valores que definen si la música mejora o no la salud mental de una persona:{Improve, Worse, No effect}                                                                                                                                                                         |

No estamos considerando las siguientes variables:

-   `Timestamp` : representa la fecha en la que una persona respondió el formulario. Es irrelevante para este proyecto
-   `BPM` : representa la velocidad con la que se reproducen las canciones del género favorito de una persona. Era una pregunta opcional en el formulario ya que por lo general las personas no tienen conocimiento de qué significa, por lo que hay muchos datos faltantes en la columna de esta variable en el data frame. Además, nos parece irrelevante para este proyecto, por lo que no la consideramos.
-   `Permissions` : Define si la persona autoriza o no publicar sus datos. Es irrelevante para este proyecto.

### Limpieza de base de datos

#### Información relevante sobre la base de datos

```{r}
BD <- read_csv("mxmh_survey_results.csv")
```

```{r}
#observaciones
nrow(BD)
#columnas
ncol(BD)
#datos incompletos y porcentaje
a<- sum(is.na(BD))
a
di = round((sum(is.na(BD))*100)/(ncol(BD)*nrow(BD)),2)
di
#casos incompletos y porcentaje
sum(!complete.cases(BD))
ci = round((sum(!complete.cases(BD))*100)/nrow(BD),2)
ci
```

La base de datos tiene un total de 736 observaciones y 33 variables(solo se usarán 30). Hay 129 datos incompletos, que representan el 0.53% del total de datos, y 120 casos incompletos, que representan el 16.3% de casos.

#### Limpieza

Como primer paso, se eliminaran las columnas de las variables que no se usarán en el proyecto. Posteriormente, se eliminarán los casos incompletos para desarrollar un análisis mas preciso.

```{r}
#Eliminar observaciones incompletas
DFF2 <- BD
DFF2$BPM <- NULL
DFF2$Timestamp <- NULL
DFF2$Permissions <- NULL
DFF2 <- na.omit(DFF2) 
```

Consideraremos la siguiente clasificación de edad para el presente proyecto:

-   Adolescente(12-17 años)
-   Joven(18-29 años)
-   Adulto(30-59 años)
-   Adulto mayor(60 a más)

*Esto según la clasificación de edades estándar en Perú*

Consideramos que a partir de la adolescencia, las personas tienen conocimientos básicos sobre problemas de salud mental como ansiedad, depresión, insomnio y OCD (trastorno obsesivo compulsivo). Por lo tanto, en nuestro data frame, consideraremos la edad a partir de los 12 años.

Además, en promedio, una persona duerme 8 horas al día. Eliminaremos los valores atípicos en la variable `Hours_per_day` que sean mayores a 16, ya que es improbable que una persona escuche música mientras duerme.

Para obtener resultados más uniformes en nuestro análisis, convertiremos algunas variables numéricas de tipo double a int.

```{r}
#Eliminar datos atípicos
DFF2 = DFF2[DFF2$Age >=12,] # Consideramos edad a partir de 12 años (adolescentes, jóvenes, adultos y adultos mayores)

DFF2 <- DFF2[DFF2$`Hours per day` <= 16 & DFF2$`Hours per day` > 0,] # Elimina valores atípicos de la variable Hours per day
#cambiar tipo de dato a entero en las siguientes variables:
DFF2$`Hours per day`= as.integer(DFF2$`Hours per day`) # convertir variable horas por día a entero
DFF2$`Anxiety`= as.integer(DFF2$`Anxiety`) # convertir variable NIVEL DE ANSIEDAD a entero
DFF2$`Depression`= as.integer(DFF2$`Depression`) # convertir variable NIVEL DE DEPRESION a entero
DFF2$`Insomnia`= as.integer(DFF2$`Insomnia`) # convertir variable NIVEL DE INSOMNIA a entero
DFF2$`OCD`= as.integer(DFF2$`OCD`) # convertir variable NIVEL DE OCD a entero
```

Ahora que ya tenemos nuestra base de datos limpia, procederemos a renombrar variables con el fin de que sean más accesibles

```{r}
DFF2=rename(DFF2,While_working="While working",Foreign_languages="Foreign languages",Primary_streaming_service="Primary streaming service",Hours_per_day="Hours per day",Fav_genre="Fav genre",Music_effects="Music effects",Frequency_Country= "Frequency [Country]",Frequency_HipHop="Frequency [Hip hop]",Frequency_Lofi="Frequency [Lofi]",Frequency_Rap="Frequency [Rap]",Frequency_EDM="Frequency [EDM]",Frequency_Jazz="Frequency [Jazz]",Frequency_Metal="Frequency [Metal]",Frequency_Rock="Frequency [Rock]",Frequency_Folk="Frequency [Folk]", Frequency_K_pop = "Frequency [K pop]",Frequency_Pop="Frequency [Pop]",Frequency_Video_game_music="Frequency [Video game music]",Frequency_Classical="Frequency [Classical]",Frequency_Gospel="Frequency [Gospel]",Frequency_Latin="Frequency [Latin]",Frequency_R_B="Frequency [R&B]")
```

Finalmente renombraremos los valores de algunos datos de la columna `Fav_genre` en donde la respuesta sea `Video game music`, la cuál será reemplazada por `Video Game`. Esto para obtener una mejor visualización en los gráficos que se realizarán más adelante.

```{r}
for(i in 1:sum(complete.cases(DFF2))){
  if(DFF2$Fav_genre[i] == "Video game music"){
    DFF2$Fav_genre[i] = "Video       Game"
  }
}
  
```

## Análisis

*Las variables no utilizadas en el análisis de datos y análisis descriptivo se reservarán para la segunda entrega del informe, que abordará el concepto de Probabilidad*

### Análisis de datos

Para el análisis de datos, usaremos los siguientes descriptores:

-   Promedio: Es la media aritmética. Se calcula sumando todos los valores en el conjunto y luego dividiendo esa suma por el número total de elementos.
-   Mediana: Se define como el valor que se encuentra en el centro de un conjunto de datos cuando están dispuestos en orden ascendente o descendente.
-   Moda: Representa el valor o los valores que ocurren con mayor frecuencia en un conjunto de datos.
-   Cuantil percentil, cuartiles: Los cuantiles percentiles dividen los datos en 100 partes iguales. Por ejemplo el percentil 50 viene a ser la media, divide los datos en 2 partes iguales, donde el 50% de los datos se ecuentra por encima de la media, y el otro 50% por debajo. Los cuartiles dividen los datos en 4 partes iguales, 25% cada una, donde Q1 = 25%, Q2 = 50%, Q3 = 75%.
-   Rango intercuartil: Se calcula restando Q3 con Q1.
-   Varianza: Indica que tan dispersos están los valores con respecto a la media. Se calcula sumando las diferencias al cuadrado entre cada valor y la media, y luego dividiendo por el número de observaciones.
-   Desviación estándar: Viene a ser la raíz cuadrada de la varianza. Ambas representan la dispersión de datos respecto a la media, pero la varianza esta en unidades al cuadrado, y la desviación estándar en las unidades originales. Además, usaremos tablas para las variables categóricas.

Con la información que obtengamos, podremos usar descriptores gráficos en la parte de Análisis Descriptivo.

#### Análisis de la variable Edad

Justificación:

-   Se utilizó la variable Edad ya que esta representa la edad en años cumplidos de las personas y se considera de 12 a más.

**Edad promedio**

```{r}
mean(DFF2$Age)
```

**Mediana de edad**

```{r}
median(DFF2$Age)
```

**Edad más frecuente**

```{r}
mfv(DFF2$Age)
```

**Cuantiles**

```{r}
quantile(DFF2$Age, 0.25)
```

```{r}
quantile(DFF2$Age, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$Age)
```

**Desviación estándar de la variable edad**

```{r}
sd(DFF2$Age)
```

**Varianza de la variable edad**

```{r}
var(DFF2$Age)
```

#### Análisis de la variable Hours_per_day

Justificación:

-   Se usará la variable `Hours_per_day` ya que nos permite identificar la cantidad de horas que una persona escucha música al día.

**Hours_per_day promedio**

```{r}
mean(DFF2$Hours_per_day)
```

**Mediana de Hours_per_day**

```{r}
median(DFF2$Hours_per_day)
```

**Hours_per_day más frecuente**

```{r}
mfv(DFF2$Hours_per_day)
```

**Cuantiles**

```{r}
quantile(DFF2$Hours_per_day, 0.25)
```

```{r}
quantile(DFF2$Hours_per_day, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$Hours_per_day)
```

**Desviación estándar de la variable Hours_per_day**

```{r}
sd(DFF2$Hours_per_day)
```

**Varianza de la variable Hours_per_day**

```{r}
var(DFF2$Hours_per_day)
```

#### Análisis de la variable Anxiety

Justificación:

-   Se usará la variable `Anxiety` ya que define el nivel de ansiedad de una persona en una horquilla del 1 al 10

**Anxiety promedio**

```{r}
mean(DFF2$Anxiety)
```

**Mediana de Anxiety**

```{r}
median(DFF2$Anxiety)
```

**Anxiety más frecuente**

```{r}
mfv(DFF2$Anxiety)
```

**Cuantiles**

```{r}
quantile(DFF2$Anxiety, 0.25)
```

```{r}
quantile(DFF2$Anxiety, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$Anxiety)
```

**Desviación estándar de la variable Anxiety**

```{r}
sd(DFF2$Anxiety)
```

**Varianza de la variable Anxiety**

```{r}
var(DFF2$Anxiety)
```

#### Análisis de la variable Insomnia

Justificación:

-   Se usará la variable `Insomnia` ya que define el nivel de insomnio de una persona en una horquilla del 1 al 10

**Insomnia promedio**

```{r}
mean(DFF2$Insomnia)
```

**Mediana de Insomnia**

```{r}
median(DFF2$Insomnia)
```

**Insomnia más frecuente**

```{r}
mfv(DFF2$Insomnia)
```

**Cuantiles**

```{r}
quantile(DFF2$Insomnia, 0.25)
```

```{r}
quantile(DFF2$Insomnia, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$Insomnia)
```

**Desviación estándar de la variable Insomnia**

```{r}
sd(DFF2$Insomnia)
```

**Varianza de la variable Insomnia**

```{r}
var(DFF2$Insomnia)
```

#### Análisis de la variable Depression

Justificación:

-   Se usará la variable `Depression` ya que define el nivel de depresión de una persona en una horquilla del 1 al 10

**Depression promedio**

```{r}
mean(DFF2$Depression)
```

**Mediana de Depression**

```{r}
median(DFF2$Depression)
```

**Depression más frecuente**

```{r}
mfv(DFF2$Depression)
```

**Cuantiles**

```{r}
quantile(DFF2$Depression, 0.25)
```

```{r}
quantile(DFF2$Depression, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$Depression)
```

**Desviación estándar de la variable Depression**

```{r}
sd(DFF2$Depression)
```

**Varianza de la variable Depression**

```{r}
var(DFF2$Depression)
```

#### Análisis de la variable OCD

Justificación:

-   Se usará la variable `OCD` ya que define el nivel de ansiedad de una persona en una horquilla del 1 al 10

**OCD promedio**

```{r}
mean(DFF2$OCD)
```

**Mediana de OCD**

```{r}
median(DFF2$OCD)
```

**OCD más frecuente**

```{r}
mfv(DFF2$OCD)
```

**Cuantiles**

```{r}
quantile(DFF2$OCD, 0.25)
```

```{r}
quantile(DFF2$OCD, 0.75)
```

**Rango intercuartil**

```{r}
IQR(DFF2$OCD)
```

**Desviación estándar de la variable OCD**

```{r}
sd(DFF2$OCD)
```

**Varianza de la variable OCD**

```{r}
var(DFF2$OCD)
```

#### Tablas

##### Tabla de las frecuencias de los géneros musicales

Justificación:

-   Se usarán las variables de frecuencia de géneros musicales(`Frecuency_...`) ya que nos permiten saber qué géneros se escuchan con mayor o menor frecuencia.

```{r warning=FALSE}
df_freq = data.frame(c(1:4))
df_freq[1]<-NULL
for(i in 10:25){
  tabla <- select(DFF2, i)
  tabla <- prop.table(table(tabla))*100
  tabla = c(tabla[1],tabla[2],tabla[3],tabla[4])
  df_freq<- cbind(df_freq,tabla )
}
nomb = c("Classical","Country","EDM","Folk", "Gospel","HipHop","Jazz","K pop","Latin","Lofi","Metal","Pop","R&B","Rap","Rock","Video game")
names(df_freq)=nomb

df_freq
```

De esta tabla de frecuencias relativas de cada género musical se puede observar que el genero rock y pop tiene en su mayoría frecuencias de "very_frequently" y "sometimes", por lo que se infiere que son los géneros más escuchados

##### Tabla de clasificación de características de personas

Justificación:

-   Se usarán las variables `While_working`,`Instrumentalist`,`Composer`,`Exploratory`, `Foreign_languages`, para identificar y clasificar a las personas por sus características(referidas a la música)

```{r}
df_car_p = data.frame(c(1:2))
df_car_p[1]<-NULL
for(i in 4:8){
if (i>6) {i=i+1}
  tabla <- select(DFF2, i)
  tabla <- prop.table(table(tabla))*100
  tabla = c(tabla[1],tabla[2])
  df_car_p<- cbind(df_car_p,tabla )
}
names(df_car_p)=c(names(DFF2[4]),names(DFF2[5]),names(DFF2[6]),names(DFF2[8]),names(DFF2[9]))

df_car_p
```

De esta tabla se puede observar que la mayoría de personas compone música y escucha música mientras trabaja.

### Análisis descriptivo

Para esta parte, usaremos los valores obtenido en la sección previa de análisis de datos. Para ello usaremos gráficos como barplots, pies, mosaicplots, plots, hists.

Usaremos la siguiente paleta de colores para mantener uniformidad:

```{r}
colors1 = c("#207498", "#2bb4c8", "#26ba8f", "#a7db8a", "#e2e2a3", "#e5e5e5")
```

#### Análisis de Edad(`Age`)

```{r}
hist(DFF2$Age, col = colors1, main = "Gráfico 1: Histograma de la variable edad", xlab = "Edad (años cumplidos)", ylab = "Frecuencia" )
abline(v=mean(DFF2$Age,), col = "red", lwd=4,lty=2)
abline(v=median(DFF2$Age,), col = "orange", lwd=4,lty=2)
abline(v=mfv(DFF2$Age,), col = "green", lwd=4,lty=2)
legend("topright",legend=c("media", "mediana", "moda"),col=c("red", "orange","green"),lwd=2)
```

En el siguiente gráfico se puede observar que el rango de edad de la mayoría de observaciones en la base de datos se encuentra entre 12 y 40 años, lo cuál abarca adolescentes(12-17), jóvenes(18-29) y cierta cantidad de personas adultas(de 30 a 40). En adelante, las observaciones con edades mayores a 40 años son mucho menores, sin embargo consideraremos esos casos para no disminuir el rango de edad. Además, el hecho de que la media, mediana y moda sean relativamente cercanas, significa que la distribución de datos es aproximadamente simétrica.

#### Análisis de las frecuencias de géneros musicales

Para el siguiente gráfico, usaremos la tabla de frecuencias relativas por género musical creada previamente.

```{r}
barplot(as.matrix(df_freq), beside=TRUE,las = 2,col=c(colors1[1],colors1[2],colors1[3],colors1[4]), cex.names = 0.8, main = "Gráfico 2: Frecuencia relativa de cada género musical",xlab="Género musical", ylab = "Frecuencia relativa(%)")
legend("topright", legend = c("Nunca","Rara vez", "A veces", "Con mucha frecuencia"), col = colors1,pch = 15, cex = 0.8)
```

Del siguiente gráfico se puede observar que tanto el Rock como el Pop son géneros musicales que la mayoría de personas suele escuchar con mucha frecuencia, y que el Gospel y música latina son géneros que la mayoría de personas nunca escucha. Además se observa que en 11 de los 16 géneros musicales, el porcentaje del valor "Nunca" es mayor, por lo que se podría inferir que la mayoría de personas escucha uno o solo algún grupo de géneros musicales, es decir, no hay mucha gente que suela escuchar de todo.

#### Análisis del género musical favorito respecto al trastorno de la persona

Agruparemos en un data frame a las personas en donde uno de los trastornos tiene un nivel estrictamente mayor a los demás.

```{r}
DFF2_AD = DFF2
TPR = c(1:nrow(DFF2))
TPR = as.character(TPR)
TPR = TPR
for (i in 1:nrow(DFF2)){
  if(DFF2$Anxiety[i]>DFF2$Insomnia[i] & DFF2$Anxiety[i]>DFF2$Depression[i] & DFF2$Anxiety[i]>DFF2$OCD[i]){
    TPR[i] = "Anxiety"
  }
  else if(DFF2$Insomnia[i]>DFF2$Anxiety[i] & DFF2$Insomnia[i]>DFF2$Depression[i] & DFF2$Insomnia[i]>DFF2$OCD[i]){
    TPR[i] = "Insomnia"
  }
  else if(DFF2$Depression[i]>DFF2$Anxiety[i] & DFF2$Depression[i]>DFF2$Insomnia[i] & DFF2$Depression[i]>DFF2$OCD[i]){
    TPR[i] = "Depression"
  }
  else if(DFF2$OCD[i]>DFF2$Anxiety[i] & DFF2$OCD[i]>DFF2$Depression[i] & DFF2$OCD[i]>DFF2$Insomnia[i]){
    TPR[i] = "OCD"
  }
}
DFF2_AD$TPRD = TPR
DFF2_AD = DFF2_AD[DFF2_AD$TPRD == "Anxiety" | DFF2_AD$TPRD == "Insomnia" | DFF2_AD$TPRD == "Depression" | DFF2_AD$TPRD == "OCD",]
```

```{r}
mosaicplot(DFF2_AD$Fav_genre ~DFF2_AD$TPRD ,main = "Gráfico 3: Influencia del género musical favorito en cada trastorno", col = colors1,las = 2, cex.axis = 0.8 , xlab = "Género musical favorito", ylab = "Trastorno(de mayor nivel)", dir = "h")
```

De este gráfico se puede asegurar que tanto el rock como el pop son los géneros favoritos predominantes(de forma similar se observó que ambos son géneros con mayor frecuencia en el anterior gráfico). Además, que el trastorno que suele tener mayor nivel que los demás en la mayoría de géneros es la ansiedad. También podemos inferir que el folk y el kpop suelen repercutir en niveles altos de ansiedad, el hiphop en niveles altos de depresión, la música latina y gospel en niveles altos de insomnio, y el rap en niveles altos de OCD.

#### Análisis de la distribución de la edad por género musical favorito

Para el siguiente gráfico, se agrupó la edad de acuerdo a la clasificación en rangos escogida previamente.

```{r}
DFF2_GA = DFF2
DFF2_GA$Age <- as.character(DFF2_GA$Age)
for (i in 1:sum(complete.cases(DFF2)) ){
  if (DFF2$Age[i] <= 17){
    DFF2_GA$Age[i] = "  12-17"
  }
  else if (DFF2$Age[i] >=18  & DFF2$Age[i] <= 29){
    DFF2_GA$Age[i] = "  18-29"
  }
  else if (DFF2$Age[i] >= 30 & DFF2$Age[i]<=59){
    DFF2_GA$Age[i] = "  30-59"
  }
  else{
    DFF2_GA$Age[i] = "  60+"
  }
 
}
```

```{r}
mosaicplot(DFF2_GA$Fav_genre ~ DFF2_GA$Age,main = "Gráfico 4: Distribución de la edad por género musical favorito", col = colors1,las = 2, cex.axis = 0.8, xlab = "Género musical", ylab = "Edad (en rangos)", dir = "h")
legend("topleft", legend = c("Adolescente","Joven", "Adulto", "Adulto mayor"), col = colors1,pch = 15, cex = 0.54)
```

En este gráfico se puede observar que el rango de edad predominante está entre 18 y 29 años, lo cual también se pudo corroborar en el primer gráfico. Se puede inferir que las personas, en su mayoría, tiene como género musical favorito al rock. También se puede inferir que el kpop es el suele ser favorito de adolescentes y jóvenes. De igual forma el Rap.

#### Análisis del nivel de trastorno respecto la cantidad de horas de consumo de música

```{r}

DFPAH = DFF2
for(i in 1:nrow(DFF2)){
  val = DFPAH$Hours_per_day[i] 
  DFPAH$Anxiety[i] = round(mean((DFF2[DFF2$Hours_per_day == val,])$Anxiety),2) 
  DFPAH$Insomnia[i] = round(mean((DFF2[DFF2$Hours_per_day == val,])$Insomnia),2) 
  DFPAH$Depression[i] = round(mean((DFF2[DFF2$Hours_per_day == val,])$Depression),2) 
  DFPAH$OCD[i] = round(mean((DFF2[DFF2$Hours_per_day == val,])$OCD),2) 
}

```

```{r}


plot(DFPAH$Anxiety ~ DFPAH$Hours_per_day, main = "Gráfico 5.1: Nivel asiedad promedio por cantidad de horas de escucha", xlab = "Horas de consumo de música al día", ylab = "Ansiedad (nivel promedio)", col = "black",pch = 19)



plot(DFPAH$Insomnia ~ DFPAH$Hours_per_day, main = "Gráfico 5.2: Nivel insomnio promedio por cantidad de horas de escucha", xlab = "Horas de consumo de música al día", ylab = "Insomnio (nivel promedio)", col = "blue",pch = 19)



plot(DFPAH$Depression ~ DFPAH$Hours_per_day, main = "Gráfico 5.3: Nivel depresión promedio por cantidad de horas de escucha", xlab = "Horas de consumo de música al día", ylab = "Depresión (nivel promedio)", col = "orange",pch = 19)



plot(DFPAH$OCD ~ DFPAH$Hours_per_day, main = "Gráfico 5.4: Nivel OCD promedio por cantidad de horas de escucha", xlab = "Horas de consumo de música al día", ylab = "OCD (nivel promedio)", col = "red",pch = 19)



Conf2x2 = matrix(c(1:4), nrow=2, byrow=FALSE)
layout(Conf2x2)


m = nrow(DFF2_AD[DFF2_AD$Music_effects=="Improve" & DFF2_AD$TPRD=="Anxiety",])
e = nrow(DFF2_AD[DFF2_AD$Music_effects=="Worsen" & DFF2_AD$TPRD=="Anxiety",])
i = nrow(DFF2_AD[DFF2_AD$Music_effects=="No effect" & DFF2_AD$TPRD=="Anxiety",])
val = c(m,i,e)
percents = round(100*val/sum(val),1)

pie(table(DFF2_AD[(DFF2_AD$TPRD=="Anxiety"),]$Music_effects), col = colors1, labels = paste0(percents,"%"),main = "Efecto de la música en la Ansiedad", cex = 0.8)
legend("bottomleft", c("Mejora","Irrelevante", "Empeora"), pch=15, col = colors1, cex = 0.75)

m = nrow(DFF2_AD[DFF2_AD$Music_effects=="Improve" & DFF2_AD$TPRD=="Insomnia",])
e = nrow(DFF2_AD[DFF2_AD$Music_effects=="Worsen" & DFF2_AD$TPRD=="Insomnia",])
i = nrow(DFF2_AD[DFF2_AD$Music_effects=="No effect" & DFF2_AD$TPRD=="Insomnia",])
val = c(m,i,e)
percents = round(100*val/sum(val),1)


pie(table(DFF2_AD[(DFF2_AD$TPRD=="Insomnia"),]$Music_effects), col = colors1, labels = paste0(percents,"%"), main = "Efecto de la música en el insomnio")
legend("bottomleft", c("Mejora","Irrelevante", "Empeora"), pch=15, col = colors1, cex = 0.75,)

m = nrow(DFF2_AD[DFF2_AD$Music_effects=="Improve" & DFF2_AD$TPRD=="Depression",])
e = nrow(DFF2_AD[DFF2_AD$Music_effects=="Worsen" & DFF2_AD$TPRD=="Depression",])
i = nrow(DFF2_AD[DFF2_AD$Music_effects=="No effect" & DFF2_AD$TPRD=="Depression",])
val = c(m,i,e)
percents = round(100*val/sum(val),1)


pie(table(DFF2_AD[(DFF2_AD$TPRD=="Depression"),]$Music_effects), col = colors1, labels = paste0(percents,"%"),main = "Efecto de la música en la Depresión")
legend("bottomleft", c("Mejora","Irrelevante", "Empeora"), pch=15, col = colors1, cex = 0.75,)

m = nrow(DFF2_AD[DFF2_AD$Music_effects=="Improve" & DFF2_AD$TPRD=="OCD",])
e = nrow(DFF2_AD[DFF2_AD$Music_effects=="Worsen" & DFF2_AD$TPRD=="OCD",])
i = nrow(DFF2_AD[DFF2_AD$Music_effects=="No effect" & DFF2_AD$TPRD=="OCD",])
val = c(m,i,e)
percents = round(100*val/sum(val),1)


pie(table(DFF2_AD[(DFF2_AD$TPRD=="OCD"),]$Music_effects), col = colors1, labels = paste0(percents,"%"),main = "Efecto de la música en el OCD")
legend("bottomleft", c("Mejora","Irrelevante", "Empeora"), pch=15, col = colors1, cex = 0.75,)
```

En los siguientes gráficos se puede observar que, para ansiedad, no hay una tendencia clara, es decir, la cantidad de horas de consumo de música al día no repercute en el nivel de ansiedad. En cuanto a insomnio, si se observa cierta tendencia, y se puede inferir que la cantidad de horas si aumenta los niveles de insomnio. Y de forma más clara se observa para las variables depresión y OCD, ya que la tendencia es más notoria, a pesar de ciertos valores atípicos. En los últimos gráficos de tortas, se observa que, de un subgrupo(usado en la gráfica 3) de estas personas, en las que uno de los trastornos tiene mayor nivel que los demás, por lo general la mayoría cree que escuchar música mejora su salud mental, pero también podemos observar que en cuanto a depresión, el porcentaje de personas que cree que la música empeora su trastorno crece, lo cuál se podría relacionar al hecho de que las personas con depresión suelen ser más pesimistas y negativas.

#### Análisis de la edad respecto al nivel de trastornos

```{r}
grupo <- ifelse(DFF2$Age >= 18 & DFF2$Age < 30, "18-29",
                 ifelse(DFF2$Age >= 30 & DFF2$Age < 60 , "30-59",
                         ifelse(DFF2$Age >= 60 , "60+",
                            "12-17")))
plot(DFF2$Anxiety ~ DFF2$Age, pch = 19,col = factor(grupo), main = "Gráfico 6.1: Dispersión de la Edad respecto al nivel de Ansiedad",xlab =  "Edad (Años cumplidos)" , ylab = "Nivel de ansiedad")
legend("topright", legend = levels(factor(grupo)), col = factor(levels(factor(grupo))), pch = 19, cex = 0.68)

plot(DFF2$Insomnia ~ DFF2$Age, pch = 19,col = factor(grupo), main = "Gráfico 6.2: Dispersión de la Edad respecto al nivel de Insomnio",xlab =  "Edad (Años cumplidos)" , ylab = "Nivel de Insomnio" )
legend("topright", legend = levels(factor(grupo)), col = factor(levels(factor(grupo))), pch = 19, cex = 0.68)

plot(DFF2$Depression ~ DFF2$Age, pch = 19,col = factor(grupo), main = "Gráfico 6.3: Dispersión de la Edad respecto al nivel de Depresión",xlab =  "Edad (Años cumplidos)" , ylab = "Nivel de Depresión" )
legend("topright", legend = levels(factor(grupo)), col = factor(levels(factor(grupo))), pch = 19, cex = 0.68)

plot(DFF2$OCD ~ DFF2$Age, pch = 19,col = factor(grupo), main = "Gráfico 6.4: Dispersión de la Edad respecto al nivel de OCD", xlab =  "Edad (Años cumplidos)" , ylab = "Nivel de OCD")
legend("topright", legend = levels(factor(grupo)), col = factor(levels(factor(grupo))), pch = 19, cex = 0.68)
```

Del primer gráfico se puede inferir que aún en personas mayores hay niveles altos de ansiedad. Lo mismo ocurre con la variable insomnio, aunque con cierta cantidad menor de datos en los picos a comparación de ansiedad. En cuanto a depresión se observa cierta disminución de nivel conforme más años tiene una persona, y de forma más notoria en el trastorno OCD, a pesar de algunos valores atípicos. De estas gráficas se podría inferir que la edad de las personas no es un factor influyente en el nivel de ansiedad o insomnio. Sin embargo, si lo es en cuanto a depresión y OCD, con niveles más bajos conforme avanza la edad.
