---
title: <center>  Expectativas laborales de los estudiantes de UTEC en el ciclo 2023-1. </center>
author: <center> Estadística y Probabilidades </center>
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---



### **Relevancia:**

<H4>En el contexto actual el empleo/trabajo llega a ser muy importante o casi imprescindible en la vida de un adulto, ya que estos nos vinculan con la sociedad y la economía en la que vivimos. Dado que en el momento de la búsqueda de uno, influyen muchos factores característicos de persona en persona como la experiencia, preparación, el deseo propio, incluso la edad en algunos casos. En relación a este tema se busca analizar y comparar los diversos factores que influyen en la expectativa o anhelo que tengan los estudiantes de la UTEC respecto a futuros empleos en los que deseen postular.
.</H4>

### **Objetivo General:**

<H4>Analizar las expectativas laborales de los estudiantes de la UTEC durante el periodo 2023-1..</H4>

### **Objetivo específicos:**

<H4>*Examinar el cambio de las expectativas laborales respecto a variaciones de edad o ciclo académico de los estudiantes..</H4>

<H4>*Estudiar el comportamiento de la tendencia en cuanto a los rubros/campos laborales que atraigan a los estudiantes..</H4>

<H4>*Examinar la tendencia de la predilección de los estudiantes en cuanto al espacio geográfico en el que desean trabajar en un futuro..</H4>

<H4>*Analizar en qué magnitud afecta el salario a las preferencias laborales de los estudiantes..</H4>

<H4>*Identificar qué factores influyen en las expectativas de los estudiantes...</H4>

### **Contexto:**

<H4>Este estudio será factible a través del uso de la encuesta. Por un lado, tenemos la facilidad de interactuar con todos los miembros presentes en los varios grupos, donde se encuentra un gran número de estudiantes de UTEC. Esto es importante debido a que nuestra investigación se centra en las expectativas laborales de los mismos estudiantes de nuestra universidad. En este sentido, nuestra muestra deberá abarcar a los mismos estudiantes de la Universidad de Ingeniería y Tecnología y en virtud de ello promoveremos la representatividad.
</H4>

## Datos 

### Proceso de recoleccion:

<H4>Decidimos como grupo utilizar una combinación de métodos para recolectar datos, incluyendo encuestas virtuales y presenciales, con el fin de obtener una muestra representativa. Con el objetivo de incentivar la participación, ofrecimos un pequeño incentivo en forma de caramelos a los participantes. Además, en consenso con todo el grupo, decidimos realizar un sorteo de un premio  entre los participantes como un estímulo adicional para animar su participación. Como resultado de estas estrategias, logramos recolectar un total de 152 encuestas.
</H4>

### Población, muestra y muestreo:


<H4> Población: Estudiantes de la Universidad de Ingeniería y Tecnología (UTEC) que se encuentran en el ciclo 2023-1<H4>
 
<H4> Unidad muestral: Estudiantes de diferentes ciclos de UTEC<H4>

<H4> Muestreo:El método de muestreo utilizado fue el muestreo por conveniencia, en el cual seleccionamos a los estudiantes que se encontraban desocupados o en horas libres para participar en nuestra encuesta. Al acercarnos a ellos dentro del campus, les pedíamos amablemente si podían hacerles algunas preguntas. Preferentemente, seleccionamos a estudiantes que estaban en ciclos medios o superiores( esto ocurrió en las encuestas presenciales). Al final del recorrido contamos con un total de 152 observaciones contando entre las virtuales y presenciales.


### Variables 

|Variable|Tipo|Escala|Restricción
|:-------|:------|:-------|:---------
|Edad                   |Numérica    |Discreta  |Es un número entero positivo de 16 a mas 
|Ciclo                  |Numérica    |Discreta  |Es un numero entero positivo de 1 a 10 
|Sexo                   |Categórica  |Nominal   |Existen 4 opciones Mujer, intersexual, hombre o otra, depende lo que se consideren 
|Carrera                |Categórica  |Nominal   |Solo se puede elegir una de las 12 opciones presentadas, ya que son las únicas carreras que brinda la universidad UTEC
|Expectativa salarial   |Numérica    |Continua  |Es un numero entero positivo
|Campo especializado    |Categórica  |Nominal   |Marcar una de las opciones que se encuentran en la encuesta  y/o redactar una
|Habilidades            |Categórica  |Nominal   |Marcar una de las opciones que se encuentra y tener como referencia el cuadro que se muestra en la encuesta
|Tiempo de experiencia  |Numérica    |Continua  |Es un numero entero positivo, acerca de los meses de experiencia
|Espacio geofráfico     |Categórica  |Nominal   |Solo se puede elegir una de las  tres opciones que se mencionan en la encuesta
|Beneficios laborales   |Categórica  |Nominal   |Se puede marcar uno o mas beneficios laborales que se esperan recibir
|Nivel educativo        |Categórica  |Ordinal   |Se puede marcar uno o  mas acerca del nivel educativo que se espera lograr


## Limpieza de base de datos 

Para una correcta ejecución del proyecto ejecutamos los siguientes comandos para una correcta instalación de todas las librerías necesarias.

```{r}
if(!require(ggplot2)){install.packages('readr')} 
if(!require(ggplot2)){install.packages('dplyr')} 
if(!require(ggplot2)){install.packages('vcd')} 
if(!require(ggplot2)){install.packages('ggplot2')} 
if(!require(ggplot2)){install.packages('Mediana')} 
if(!require(ggplot2)){install.packages('plotrix')} 
```

Procedemos con el llamado de estas librerías.

```{r}
rm(list=ls())
library(readr)
library(dplyr)
library(vcd)
library(ggplot2)
library(Mediana)
library(plotrix)
```

Continuamos con la lectura del archivo que contiene todos los datos resultantes de la encuesta realizada anteriormente.

```{r}
DF <- read_csv("Encuesta(datos).csv", show_col_types = FALSE)
```

Revisamos que el archivo tenga datos completos o datos incompletos que puedan afectar a una correcta ejecución:

Datos incompletos:
```{r}
sum(is.na(DF))
```

Datos completos:
```{r}
sum(!is.na(DF))
```
Procedemos a eliminar la vaiable "Marca temporal" ya que su existencia no afecta el desarrollo del proyecto:
```{r}
DF %>% select(-1) -> DF
```

Nombres iniciales de las variables:
```{r}
names(DF)
```

Continuamos con el cambio de nombres de las variables para un manejo eficiente e intuitivo de las mismas:
```{r}
DF %>% rename(edad=`Edad`, correo= `Correo electrónico`, ciclo=`¿En que ciclo de carrera te encuentras?(Solo en numeros ejm:1 )`, carrera=`¿Qué carrera estudias?`, promedio=`Promedio ponderado. (Usar el punto como separador decimal)`, exp_sueldo=`¿Cuál es tu expectativa de sueldo al egresar de UTEC? (Solo el valor numérico y en soles mensual)`, rubro=`¿En qué campo/rubro laboral deseas postular en un futuro?`, habilidades=`De acuerdo al siguiente cuadro: ¿Con cuántas habilidades cuentas?, sabiendo que son habilidades que las empresas actuales buscan.`, t_exper=`¿Cuánto tiempo de experiencia laboral tienes en el rubro que elegiste? (En meses)`, ubic_des=`¿Dónde te gustaría trabajar? ¿En una zona rural, urbana o en el extranjero?`, benef=`¿Qué beneficios laborales esperas?`, niv_ed_des=`¿Qué nivel educativo esperas alcanzar?`) ->DFN
```

#### Primero,debido a que R estudio toma los . como si fuera miles, tenemos que arreglar esto,es por esto que tenemos que usar el mutate para que los valore de promedio esten bien:
```{r}
DFC<-mutate(DFN,promedio=case_when(promedio>100~promedio/10,promedio<100~promedio))
```
Una segunda vez para asegurarnos y que todo este bien:
```{r}
DFC<-mutate(DFC,promedio=case_when(promedio>100~promedio/10,promedio<100~promedio))
```
Vimos que hay un dato que R lo toma como NA al ponerlo en numerico, entonces lo cambiamos antes de cambiar la variable de exp_sueldo a numerico.
```{r}
DFC <- mutate(DFC, exp_sueldo = case_when(exp_sueldo == "15.000.000" ~ "1500", exp_sueldo != "" ~ exp_sueldo))
```

Vemos que expectativa de sueldo(exp_sueldo) no es númerico por lo que lo tenemos que cambiar antes de limpiar estos datos:
```{r}
DFC <- DFC %>% mutate(exp_sueldo = as.numeric(exp_sueldo))
```

Ahora no queremos tener personas que esperan un sueldo mayor a 9999, entonces le quitamos un 0 a estos datos, suponiendo que la gente puso un 0 de mas a la hora de poner su expectativa de sueldo.
```{r}
DFC<-mutate(DFC,exp_sueldo=case_when(exp_sueldo>0~round(exp_sueldo)))
DFC<-mutate(DFC,exp_sueldo=case_when(exp_sueldo>9990~exp_sueldo/10,exp_sueldo<=9990~exp_sueldo))
```





## Analisis Descriptivo 

#### Objetivo 1

Examinar el cambio de las expectativas laborales respecto a variaciones de edad o ciclo académico de los estudiantes.

Observamos primeramente el gráfico rubro vs edad:
```{r}
boxplot(DFC$edad~DFC$rubro, col = c("orange3", "yellow3","green", "pink","lightblue"), main="Gráfico 1", xlab="Rubro", ylab="Edad", par(cex.lab = 1, cex.axis = 0.4))

```
```{r}
cat('Media de la variable edad:',round(mean(DFC$edad),2),'\n')
```


Del gráfico podemos interpretar que las personas que eligieron el rubro "otros" son los poseen una mayoría de edad estando por encima de la media si los comparamos con los demás, mientras que las medianas de edad de los que escogieron los otros rubros se mantienen casi al mismo nivel considerando los datos atípicos.


Continuamos con el gráfico rubro vs ciclo:

```{r}
boxplot(DFC$ciclo~DFC$rubro, col = c("orange3", "yellow3","green", "pink","lightblue"), main="Gráfico 2", xlab="Rubro", ylab="Ciclo", par(cex.lab = 1, cex.axis = 0.4))
```
```{r}
cat('Media de la variable ciclo:',round(mean(DFC$ciclo),2),'\n')
```

En este gráfico podemos apreciar que los que se inclinan más para el rubro "Comercio Internacional" tienden a pertenecer a ciclos más bajos estando por debajo de la media:



#### Objetivo 2

Estudiar el comportamiento de la frecuencia en cuanto a los rubros/campos laborales que atraigan a los estudiantes de diferentes carreras.


###### Gráfico 3

```{r}
dx <- data.frame(Rubro = DFC$rubro, Carrera = DFC$carrera)

ggplot(dx, aes(x = Carrera, fill = Rubro)) +
  geom_bar() + 
  labs(x = "Carreras", y = "Número de estudiantes", fill = "Rubros") +
  theme(plot.title = element_text(size = 12, face = "bold"),
        axis.text.x = element_text(angle = 45, hjust = 1),
        axis.text.y = element_text(size = 10),
        legend.text = element_text(size = 10),
        legend.title = element_text(size = 10, face = "bold"),
        plot.margin = margin(-1, 0, 0, 0, "cm"))
```

De todos los estudiantes la mayor cantidad de estudiantes encuestados fueron de la carrera de ingeneria civil y prefieren el rubro relacionado a la ingeneria, observamos que la menor cantidad de estudiantes encuestados son de la carrera de Ingeniería de la energía y tambien les interesa el rubro de Campos relacionados con la ingeniería; sin embargo, este rubro no es predominante en todas las carreras, observamos una variacion por cada carrera de Ing mecatronica predomina el rubro de sector tecnologico y esto ocurre tambien en otras carreras



#### Objetivo 3

Identificar el mayor valor relativo de los rubros de acuerdo a cada espacio geográfico deseado a futuro.


```{r}
ggplot(dx, aes(x = DFC$ubic_des)) +
  geom_bar(fill="lightblue") + ggtitle("Gráfico 4")+
  labs(x = "Rubro", y = "N° de estudiantes")+
  theme(plot.title = element_text(size = 10, face = "bold"), 
        axis.text = element_text(size = 7),                      
        legend.text = element_text(size = 6),                    
        legend.title = element_text(size = 5, face = "bold"),     
        plot.margin = margin(1, 0, 0, 0, "cm"))
```


Expresamos la moda en cuanto a la ubicación geográfica más deseada.

```{r}
names(table(DFC$ubic_des))[table(DFC$ubic_des) == max(table(DFC$ubic_des))]
```


Podemos concluir que más de la mitad de los encuestados desea trabajar en el extranjero en un futuro, mientras que la zona rural es la que menos prefieren.


```{r}
mosaicplot(table(DFC$ubic_des,DFC$rubro), col = c("green", "pink","lightblue", "orange", "yellow"),las = 1, main = "Gráfico 5")
```



```{r}
tabla_rubro_ubic <- table(DFC$rubro,DFC$ubic_des)

prop.table(x=tabla_rubro_ubic, margin = 2)
```

Podemos identificar observando la gráfica y tabla que la mayoría de personas; en este caso, el 51.1% que desean a futuro trabajar en el extranjero y que a la vez optan por los campos relacionados con la ingeniería.




#### Objetivo 4

Analizar en qué magnitud afecta el salario a las preferencias laborales de los estudiantes.


```{r}
mean(DFC$exp_sueldo,na.rm=T)#media/promedio
```


```{r}
sd(DFC$exp_sueldo,na.rm=T)#desviación estándar
```

```{r}
median(DFC$exp_sueldo,na.rm=T)#mediana
```

```{r}
table(DFC$exp_sueldo) 
```


```{r}
#La moda es 3000 con 26 personas
atipicos_superiores<-quantile(DFC$exp_sueldo,0.75,na.rm=T)+1.5*IQR(DFC$exp_sueldo,na.rm=T)
DFC %>% filter(exp_sueldo >atipicos_superiores) ->DFC1_superiores
atipicos_inferiores<-quantile(DFC$exp_sueldo,0.25,na.rm=T)-1.5*IQR(DFC$exp_sueldo,na.rm=T)
DFC %>% filter(exp_sueldo <atipicos_inferiores) ->DFC1_inferiores
#Ahora quitamos los datos atípicos
DFC %>% filter(exp_sueldo<=atipicos_superiores & exp_sueldo>=atipicos_inferiores) ->DFCSIN
mean(DFCSIN$exp_sueldo,na.rm=T)
```


```{r}
sd(DFCSIN$exp_sueldo,na.rm=T)#desviación estándar
```

```{r}
median(DFCSIN$exp_sueldo,na.rm=T)
```


Calculamos la moda en cuanto al rubro laboral más deseado por los encuestados



```{r}
names(table(DFN$rubro))[table(DFN$rubro) == max(table(DFN$rubro))]
```

```{r}
DFC %>% filter(rubro ==  "Campos relacionados con la ingeniería")-> DatosfiltradoscampoIng
DatosfiltradoscampoIng
```

```{r}
#hist(DatosfiltradoscampoIng$exp_sueldo)
boxplot(DatosfiltradoscampoIng$exp_sueldo, col="PINK", main="Gráfico 6", horizontal = FALSE)
```

```{r}
boxplot.stats(DatosfiltradoscampoIng$exp_sueldo)
# stats -> contiene el extremo del bigote inferior, la 'bisagra' inferior, la mediana, la 'bisagra' superior y el extremo del bigote superior.
# n -> cantidad de datos
# conf -> Extremos de la muesca # intervalos de confianza
# out -> datos atipicos
```





```{r}
boxplot(DFC$exp_sueldo ~ DFC$rubro, col = c("orange3", "yellow3", "green", "pink", "lightblue"), xlab= "Rubro", ylab = "Expectativa de sueldo", main = "Gráfico 7: Expectativa de sueldo en relación al rubro" ,cex.axis = 0.4)
```

Gracias al diagrama de cajas, tenemos una mejor perspectiva de la opinión sobre la expectativa de sueldos de las personas, porque nos centramos en los cuartiles y no consideramos a los atípicos para calculo como la mediana, De la gráfica podemos decir el rubro de comercio internacional se espera una mejor expectativa de sueldo, porque su mediana es la mas alta, mientras que en el rubro de Otro se tiene una expectativa de sueldo bajo.


#### Objetivo 5

Identificar qué factores influyen en las expectativas laborales de los estudiantes de acuerdo con los datos obtenidos.

Los factores que mas influyen en la expectativas de los estudiantes son la expectativa de sueldo, que los estudiantes esperan recibir al ingresar al mercado laboral es un factor clave . Además, la percepción de un sueldo adecuado a sus habilidades y esfuerzos juega un papel significativo en la formación de sus expectativas. También tienen preferencias en cuanto al rubro en el que desean trabajar, basándose en sus intereses, habilidades y perspectivas de empleo. Las oportunidades de progresar en su carrera y adquirir experiencia relevante son consideraciones importantes que influyen en sus expectativas. Finalmente la ubicación geográfica en la que los estudiantes desean trabajar también desempeña un papel importante en sus expectativas. Algunos estudiantes prefieren trabajar en su ciudad natal o en un lugar específico que ofrezca un estilo de vida deseado.

## Tabla de descriptores de las Variables 

```{r}
summary(DFC$edad)
```


```{r}
summary(DFC$promedio)
```

```{r}
summary(DFC$exp_sueldo, rm.na = T)
```

```{r}
summary(DFC$habilidades)
```

```{r}
summary(DFC$t_exper)
```

```{r}
var(DFC$edad)
```

```{r}
var(DFC$promedio)
```

```{r}
var(DFC$exp_sueldo, na.rm = TRUE)
```

```{r}
var(DFC$habilidades)
```

```{r}
var(DFC$t_exper)
```

```{r}
sd(DFC$edad)
```

```{r}
sd(DFC$promedio)
```

```{r}
sd(DFC$exp_sueldo, na.rm = TRUE)
```

```{r}
sd(DFC$habilidades)
```

```{r}
sd(DFC$t_exper)
```


|Variable |Media |Mediana |Min   |Max    |Varianza|Desviacion estandar|Coeficiente de Variacion|1er Quantil|3er Quantil|Rango intercuantil
|:--------|:------|:------|:------|:------|:------|:------             |:------                |:------                |:------                |:------                |
|Edad     |19.22  |19.00 |16.00|24.00|2.303547|1.517744|0.07896691|18.00|20.00|2.00
|Promedio Ponderado|14.51  |14.50 |10.35|18.75|2.558714|1.599598|0.11024108|13.50|15.42|1.92
|Expectativa Salarial|2982.00  |2800.00 |3.00|8000.00|2575721|1604.905|0.53819752|2000.00|4000.00|2000.00
|Habilidades Buscadas|5.355  |5.00 |1.00|10.00|4.376264|2.091952|0.39065397|4.00|7.00|3.00
|Tiempo de Experiencia|3.487  |0.00 |0.00|24.00|37.68194|6.138562|1.76041356|0.00|4.00|4.00

```{r}
 boxplot(DFC$edad, 
        main = "Gráfico 8:  Edad",horizontal = TRUE,
        boxwex = 0.7,col="lightblue")
```

Podemos ver que hay un solo dato atípico, esto es normal, ya que la mayoría de estudiantes son mas jóvenes, en este caso el dato atipico es 24.
```{r}
hist1<-hist(DFC$edad,
            main="Gráfico 9: Edad de los estudiantes de UTEC",
            col=rainbow(8),xlab="Edad",
            ylab="Num de estudiantes") 
abline(v=mean(DFC$edad),   
       col="orange",    
       lwd=5)        
abline(v=median(DFC$edad),
       col="blue",
       lwd=5)
```
De este gráfico vemos que la mayoría de estudiantes que encuestamos son de entre 18 a 19 años de edad.


```{r}
hist(DFC$habilidades,
     xlab = "Habilidades",
     ylab = "numero de estudiantes",
     main = "Gráfico 10: Habilidades de los estudiantes",
     col = "green",
     border = "white",
     breaks = "Sturges")
abline(v = mean(DFC$habilidades), col = "red", lwd = 2)
legend("topright", legend = "Media", col = "red", lwd = 2)
```

En el gráfico de habilidades se logra observar que mas de 30 estudiantes, cuentan con 4 habilidades que las empresas buscan para contratar a un trabajador, por otro lado también se logra identificar que la media oscila entre 4 y 6.


```{r}

hist1<-hist(DFC$t_exper,
            main="Gráfico 11: Tiempo de experiencia laboral",
            col=rainbow(8),xlab="Tiempo (en meses)",
            ylab="Num de estudiantes") 

```
De este gráfico observamos que la mayoría de estudiantes que se encuestó no tienen algun tipo de experiencia laboral aún; sin embargo, hay algunos que tienen experiencia laboral de entre 1 a 10 meses, mientras unos poco tienen de 15 a 20 meses y uno que otro tiene una experiencia de 36 meses.



```{r}
boxplot(DFC$edad~DFC$ubic_des, col = c("orange3", "pink","lightblue"), main="Gráfico 12: Edad vs Ubicación", xlab="Ubicación", ylab="Edad", par(cex.lab = 1, cex.axis = 0.8))

```

```{r}
library(vcd)

par(mar = c(5, 4, 4, 12))  
mosaicplot(table(DFC$carrera, DFC$Sexo),
           col = c("green", "pink", "lightblue", "orange", "yellow"),
           main = "Gráfico 13: Sexo vs Carrera",
           cex.axis = 0.45,
           las = 1.1
)
```

De este gráfico visualizamos que el sexo mas predominante en las carreras es el de los hombres; sin embargo, las carreras  en que predominan las mujeres son en: Ingenieria Química, Ingeniería Industrial y Bioingeniería.
