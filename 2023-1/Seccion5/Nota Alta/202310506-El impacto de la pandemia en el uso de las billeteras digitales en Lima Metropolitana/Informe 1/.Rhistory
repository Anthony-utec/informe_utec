maxpre <- quantile(DD$`Gasto promedio diario pre-pandemia con método principal de pago`,0.75,na.rm=TRUE)+3*iqpre
maxpost <- quantile(DD$`Gasto promedio diario actual con método principal de pago`,0.75, na.rm=TRUE)+3*iqpost
DD3 <- filter(DD, DD$`Gasto promedio diario actual con método principal de pago` < maxpost)
DD3 <- filter(DD3, DD3$`Gasto promedio diario pre-pandemia con método principal de pago` < maxpost)
DD4 <- filter(DD3, (DD3$`Utilización de las billeteras digitales antes de la pandemia`== "No") | (DD3$`Conocimiento de la existencia de las billeteras digitales antes de la pandemia` == "No"))
ColoresG8 = c("#403F4C", "#E84855")
G8 <- plot(x = DD4$`Gasto promedio diario actual con método principal de pago`,
y = DD4$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 8: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, no usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG8[factor(DD4$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD4$`Billetera digital más usada`)), fill = ColoresG8, title = "Billetera digital \n a la que migraron")
DD4P <- filter(DD4, DD4$`Billetera digital más usada`=="Plin")
DD4Y <- filter(DD4, DD4$`Billetera digital más usada`=="Yape")
corrP1 <- cor(DD4P$`Gasto promedio diario actual con método principal de pago`, DD4P$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY1 <- cor(DD4Y$`Gasto promedio diario actual con método principal de pago`, DD4Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Plin es: %f", corrP1)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY1)
DD5 <- filter(DD3, DD3$`Billeteras digitales como principal método de pago` == "Sí")
DD5 <- filter(DD5, DD5$`Utilización de las billeteras digitales antes de la pandemia`== "Sí")
ColoresG9 = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE")
G9 <- plot(x = DD5$`Gasto promedio diario actual con método principal de pago`,
y = DD5$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 9: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG9[factor(DD5$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD5$`Billetera digital más usada`)), fill = ColoresG9, title = "Principal billetera \n digital usada")
DD5Y <- filter(DD5, DD5$`Billetera digital más usada`=="Yape")
corrV <- cor(DD5$`Gasto promedio diario actual con método principal de pago`, DD5$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY2 <- cor(DD5Y$`Gasto promedio diario actual con método principal de pago`, DD5Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY2)
sprintf("La covarianza de ambas variables para todos los usuarios: %f", corrV)
librerias <- c("dplyr",
"funModeling",
"modeest",
"readr",
"reshape",
"stringr")
# Comprobación de librerías
for (libreria in librerias) {
if (!require(libreria, character.only = TRUE)) {
install.packages(libreria)
}
library(libreria, character.only = TRUE)
}
DF <- read_csv("Encuesta.csv", show_col_types = FALSE)
names(DF)
Nombres_de_columnas<-c("Edad", "Sexo", "Distrito", "Ocupación","Conocimiento de la existencia de las billeteras digitales antes de la pandemia", "Utilización de las billeteras digitales antes de la pandemia", "Principal razón de la utilización de las billeteras digitales antes de la pandemia", "Principal razón de la NO utilización de las billeteras digitales antes de la pandemia", "Utilización de las billeteras digitales actualmente", "Billetera digital más usada", "Segunda billetera digital más usada", "Tiempo de utilización de la billetera digital", "Razones iniciales de uso", "Razones actuales de uso", "Billeteras digitales como principal método de pago", "Intención de utilización de billeteras digitales", "Método principal de pago", "Factores de impedimento para la utilización de billeteras digitales", "Gasto promedio diario pre-pandemia con método principal de pago", "Gasto promedio diario actual con método principal de pago", "Nivel de comodidad con el método principal de pago", "Nivel de creencia de la rapidez de las billeteras digitales", "Miembros de la familia que utilizan billeteras digitales")
DD <- select(DF, -'Marca temporal')
names(DD) = Nombres_de_columnas
names(DD)
glimpse(DD) # Nota: La clase de la variable se muestra a la derecha de su nombre
DD$`Nivel de comodidad con el método principal de pago` <- as.character(DD$`Nivel de comodidad con el método principal de pago`)
DD$`Nivel de creencia de la rapidez de las billeteras digitales`  <- as.character(DD$`Nivel de creencia de la rapidez de las billeteras digitales`)
glimpse(DD)
table(DD$`Billetera digital más usada`) # Contabilización de la billetera digital usada en primera instancia
table(DD$`Segunda billetera digital más usada`) # Contabilización de la billetera digital usada en segunda instancia (ej: Transacciones que no le permita la primera.)
DD$`Billetera digital más usada` <- replace(DD$`Billetera digital más usada`, DD$`Billetera digital más usada` == "APPLE WALLET", "Apple Wallet")
DD$`Segunda billetera digital más usada` <- replace(DD$`Segunda billetera digital más usada`, DD$`Segunda billetera digital más usada` == "Apple pay", "Apple Pay")
table(DD$`Billetera digital más usada`)
table(DD$`Segunda billetera digital más usada`)
Billeteras_con_límite <- c("Yape", "Tunki", "Plin", "Agora Pay")
Montos_límite <- c(950, 500, 1500, 1500)
for (i in range(length(Billeteras_con_límite))){
DD <- DD[!(DD$`Utilización de las billeteras digitales actualmente` == "Sí" & DD$`Billeteras digitales como principal método de pago` == "Sí" & DD$`Billetera digital más usada` == Billeteras_con_límite[i] & DD$`Gasto promedio diario actual con método principal de pago` > Montos_límite[i]), ]
}
df_status(DD, FALSE) # De esta manera, vemos el resumen de NA's. El dato es dado por q_na.
if ( length(grep("No", DD$`Conocimiento de la existencia de las billeteras digitales antes de la pandemia`)) == sum(is.na(DD$`Utilización de las billeteras digitales antes de la pandemia`)) ) {
print("No hay NA's a considerar: Las personas que no conocían las billeteras digitales prepandemia no respondieron la pregunta sobre el uso en el mismo periodo.")
}
if ( ( (dim(DD)[1] - length(grep("Sí", DD$`Utilización de las billeteras digitales antes de la pandemia`))) == sum(is.na(DD$`Principal razón de la utilización de las billeteras digitales antes de la pandemia`)))
& (dim(DD)[1] - (length(grep("No", DD$`Utilización de las billeteras digitales antes de la pandemia`))) ==  sum(is.na(DD$`Principal razón de la NO utilización de las billeteras digitales antes de la pandemia`))) ) {
print("No hay NA's a considerar: Tanto la gente que usaba las billeteras digitales prepandemia es la misma que la que explicó su razón. Quienes no usaron, explicaron la suya.")
}
Uso_actual_de_bd_comp <- c(
length(grep("Sí", DD$`Utilización de las billeteras digitales actualmente`)),
dim(DD)[1] - sum(is.na(DD$`Billetera digital más usada`)),
dim(DD)[1] - sum(is.na(DD$`Segunda billetera digital más usada`)),
dim(DD)[1] - sum(is.na(DD$`Tiempo de utilización de la billetera digital`)),
dim(DD)[1] - sum(is.na(DD$`Razones iniciales de uso`)),
dim(DD)[1] - sum(is.na(DD$`Razones actuales de uso`)),
dim(DD)[1] - sum(is.na(DD$`Billeteras digitales como principal método de pago`)))
if ( length(unique(Uso_actual_de_bd_comp)) == 1){
print("No hay NA's a considerar: No hay datos faltantes en las preguntas derivadas del uso actual de billeteras digitales.")
}
if ( length(grep("No", DD$`Utilización de las billeteras digitales actualmente`)) == (dim(DD)[1] - sum(is.na(DD$`Intención de utilización de billeteras digitales`))) ){
print("No hay NA's a considerar: Las personas que no usan billeteras digitales han respondido la pregunta acerca de su intención de uso.")
}
if ( (dim(DD)[1] - sum(is.na(DD$`Método principal de pago`))) ==  (dim(DD)[1] - sum(is.na(DD$`Factores de impedimento para la utilización de billeteras digitales`)))){
print("No hay NA's a considerar: Quienes usan un método de pago diferente han contestado la pregunta acerca del porqué no usan una billetera digital como principal.")
}
attach(DD)
T1 <- filter(DD, is.na(DD$`Tiempo de utilización de la billetera digital`) == FALSE)
G1 <- plot(density(T1$`Tiempo de utilización de la billetera digital`),
col = "#E84855",
main = "Gráfico 1: Tiempo de utilización de las billeteras digitales",
xlab = "Meses de uso",
ylab = "Densidad")
V1 <- mfv(DD$`Tiempo de utilización de la billetera digital`, na_rm = TRUE)
V2 <- round(sd(DD$`Tiempo de utilización de la billetera digital`, na.rm = TRUE), 2)
coef_var <- function(x, na.rm = FALSE) {
sd(x, na.rm = na.rm) / mean(x, na.rm = na.rm)
}
V3 <- round(coef_var(DD$`Tiempo de utilización de la billetera digital`, na.rm = TRUE), 2)
summary(DD$`Tiempo de utilización de la billetera digital`)
sprintf("La moda es: %d", V1)
sprintf("La desviación estándar es: %f", V2)
sprintf("El coeficiente de variación es: %f", V3)
G2 <- boxplot(DD$`Tiempo de utilización de la billetera digital`,
# Configuración del título
main = "Gráfico 2.1: Tiempo de utilización de las billeteras digitales",
# Configuración de los ejes
ylab = "Tiempo de uso (meses)",
# Configuración de los bloques
col = "#E84855")
iqtiempo <- IQR(DD$`Tiempo de utilización de la billetera digital`, na.rm=TRUE)
maxtiempo <- quantile(DD$`Tiempo de utilización de la billetera digital`,0.75,na.rm=TRUE)+1.5*iqtiempo
DT <- filter(DD, DD$`Tiempo de utilización de la billetera digital` < maxtiempo)
G2 <- boxplot(DT$`Tiempo de utilización de la billetera digital`,
# Configuración del título
main = "Gráfico 2.2: Tiempo de utilización de las billeteras digitales",
# Configuración de los ejes
ylab = "Tiempo de uso (meses)",
# Configuración de los bloques
col = "#E84855")
DD1 <- data.frame(`Conocimiento de la existencia de las billeteras digitales antes de la pandemia`, `Utilización de las billeteras digitales antes de la pandemia`)
DD1[is.na(DD1)] <- "No"
T3 <- table(DD1)
G3 <- mosaicplot(T3,
# Configuración del título
main = "Gráfico 3: Comparación entre el conocimiento de la existencia de las \nbilleteras digitales y su utilización (prepandemia)",
# Configuración de los bloques
col = c("#E84855", "#0091AD"),
# Configuración de los ejes
xlab = "Conocimiento",
ylab = "Utilización",)
T4 <- table(`Principal razón de la NO utilización de las billeteras digitales antes de la pandemia`)
G4 <- barplot(T4,
# Configuración del título
main = "Gráfico 4: Principal razón de la NO utilización de billeteras digitales \nprepandemia (usuarios que conocían el método de pago)",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 25),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T4),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD"),
cex = 0.75,
inset = c(0, -0.3),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G4, T4 + 1.5, labels = T4)
T5 <- table(str_split_fixed(DD$`Razones iniciales de uso`, ", ", 4))[2:6]
G5 <- barplot(T5,
# Configuración del título
main = "Gráfico 5: Razones iniciales de uso de billeteras digitales",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 100),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T5),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
cex = 0.75,
inset = c(0, -0.338),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G5, T5 + 7, labels = T5)
T6 <- table(str_split_fixed(DD$`Razones actuales de uso`, ", ", 4))[2:5]
G6 <- barplot(T6,
# Configuración del título
main = "Gráfico 6: Razones actuales de uso de billeteras digitales",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 100),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T6),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
cex = 0.75,
inset = c(0, -0.3),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G6, T6 + 5.5, labels = T6)
DD2 <- data.frame(`Nivel de comodidad con el método principal de pago`, `Método principal de pago`)
DD2[is.na(DD2)] <- "Billetera digital"
T7 <- table(DD2)
G7 <- mosaicplot(T7,
# Configuración del título
main = "Gráfico 7: Comodidad de los encuestados con su método principal \nde pago",
# Configuración de los ejes
xlab = "Nivel de comodidad",
ylab = "Método principal de pago",
# Configuración de los bloques
color = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
las = 1)
iqpre <- IQR(DD$`Gasto promedio diario pre-pandemia con método principal de pago`, na.rm=TRUE)
iqpost <- IQR(DD$`Gasto promedio diario actual con método principal de pago`, na.rm=TRUE)
maxpre <- quantile(DD$`Gasto promedio diario pre-pandemia con método principal de pago`,0.75,na.rm=TRUE)+3*iqpre
maxpost <- quantile(DD$`Gasto promedio diario actual con método principal de pago`,0.75, na.rm=TRUE)+3*iqpost
DD3 <- filter(DD, DD$`Gasto promedio diario actual con método principal de pago` < maxpost)
DD3 <- filter(DD3, DD3$`Gasto promedio diario pre-pandemia con método principal de pago` < maxpost)
DD4 <- filter(DD3, (DD3$`Utilización de las billeteras digitales antes de la pandemia`== "No") | (DD3$`Conocimiento de la existencia de las billeteras digitales antes de la pandemia` == "No"))
ColoresG8 = c("#403F4C", "#E84855")
G8 <- plot(x = DD4$`Gasto promedio diario actual con método principal de pago`,
y = DD4$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 8: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, no usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG8[factor(DD4$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD4$`Billetera digital más usada`)), fill = ColoresG8, title = "Billetera digital \n a la que migraron")
DD4P <- filter(DD4, DD4$`Billetera digital más usada`=="Plin")
DD4Y <- filter(DD4, DD4$`Billetera digital más usada`=="Yape")
corrP1 <- cor(DD4P$`Gasto promedio diario actual con método principal de pago`, DD4P$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY1 <- cor(DD4Y$`Gasto promedio diario actual con método principal de pago`, DD4Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Plin es: %f", corrP1)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY1)
DD5 <- filter(DD3, DD3$`Billeteras digitales como principal método de pago` == "Sí")
DD5 <- filter(DD5, DD5$`Utilización de las billeteras digitales antes de la pandemia`== "Sí")
ColoresG9 = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE")
G9 <- plot(x = DD5$`Gasto promedio diario actual con método principal de pago`,
y = DD5$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 9: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG9[factor(DD5$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD5$`Billetera digital más usada`)), fill = ColoresG9, title = "Principal billetera \n digital usada")
DD5Y <- filter(DD5, DD5$`Billetera digital más usada`=="Yape")
corrV <- cor(DD5$`Gasto promedio diario actual con método principal de pago`, DD5$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY2 <- cor(DD5Y$`Gasto promedio diario actual con método principal de pago`, DD5Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY2)
sprintf("La covarianza de ambas variables para todos los usuarios: %f", corrV)
librerias <- c("dplyr",
"funModeling",
"modeest",
"readr",
"reshape",
"stringr")
# Comprobación de librerías
for (libreria in librerias) {
if (!require(libreria, character.only = TRUE)) {
install.packages(libreria)
}
library(libreria, character.only = TRUE)
}
DF <- read_csv("Encuesta.csv", show_col_types = FALSE)
names(DF)
Nombres_de_columnas<-c("Edad", "Sexo", "Distrito", "Ocupación","Conocimiento de la existencia de las billeteras digitales antes de la pandemia", "Utilización de las billeteras digitales antes de la pandemia", "Principal razón de la utilización de las billeteras digitales antes de la pandemia", "Principal razón de la NO utilización de las billeteras digitales antes de la pandemia", "Utilización de las billeteras digitales actualmente", "Billetera digital más usada", "Segunda billetera digital más usada", "Tiempo de utilización de la billetera digital", "Razones iniciales de uso", "Razones actuales de uso", "Billeteras digitales como principal método de pago", "Intención de utilización de billeteras digitales", "Método principal de pago", "Factores de impedimento para la utilización de billeteras digitales", "Gasto promedio diario pre-pandemia con método principal de pago", "Gasto promedio diario actual con método principal de pago", "Nivel de comodidad con el método principal de pago", "Nivel de creencia de la rapidez de las billeteras digitales", "Miembros de la familia que utilizan billeteras digitales")
DD <- select(DF, -'Marca temporal')
names(DD) = Nombres_de_columnas
names(DD)
glimpse(DD) # Nota: La clase de la variable se muestra a la derecha de su nombre
DD$`Nivel de comodidad con el método principal de pago` <- as.character(DD$`Nivel de comodidad con el método principal de pago`)
DD$`Nivel de creencia de la rapidez de las billeteras digitales`  <- as.character(DD$`Nivel de creencia de la rapidez de las billeteras digitales`)
glimpse(DD)
table(DD$`Billetera digital más usada`) # Contabilización de la billetera digital usada en primera instancia
table(DD$`Segunda billetera digital más usada`) # Contabilización de la billetera digital usada en segunda instancia (ej: Transacciones que no le permita la primera.)
DD$`Billetera digital más usada` <- replace(DD$`Billetera digital más usada`, DD$`Billetera digital más usada` == "APPLE WALLET", "Apple Wallet")
DD$`Segunda billetera digital más usada` <- replace(DD$`Segunda billetera digital más usada`, DD$`Segunda billetera digital más usada` == "Apple pay", "Apple Pay")
table(DD$`Billetera digital más usada`)
table(DD$`Segunda billetera digital más usada`)
Billeteras_con_límite <- c("Yape", "Tunki", "Plin", "Agora Pay")
Montos_límite <- c(950, 500, 1500, 1500)
for (i in range(length(Billeteras_con_límite))){
DD <- DD[!(DD$`Utilización de las billeteras digitales actualmente` == "Sí" & DD$`Billeteras digitales como principal método de pago` == "Sí" & DD$`Billetera digital más usada` == Billeteras_con_límite[i] & DD$`Gasto promedio diario actual con método principal de pago` > Montos_límite[i]), ]
}
df_status(DD, FALSE) # De esta manera, vemos el resumen de NA's. El dato es dado por q_na.
if ( length(grep("No", DD$`Conocimiento de la existencia de las billeteras digitales antes de la pandemia`)) == sum(is.na(DD$`Utilización de las billeteras digitales antes de la pandemia`)) ) {
print("No hay NA's a considerar: Las personas que no conocían las billeteras digitales prepandemia no respondieron la pregunta sobre el uso en el mismo periodo.")
}
if ( ( (dim(DD)[1] - length(grep("Sí", DD$`Utilización de las billeteras digitales antes de la pandemia`))) == sum(is.na(DD$`Principal razón de la utilización de las billeteras digitales antes de la pandemia`)))
& (dim(DD)[1] - (length(grep("No", DD$`Utilización de las billeteras digitales antes de la pandemia`))) ==  sum(is.na(DD$`Principal razón de la NO utilización de las billeteras digitales antes de la pandemia`))) ) {
print("No hay NA's a considerar: Tanto la gente que usaba las billeteras digitales prepandemia es la misma que la que explicó su razón. Quienes no usaron, explicaron la suya.")
}
Uso_actual_de_bd_comp <- c(
length(grep("Sí", DD$`Utilización de las billeteras digitales actualmente`)),
dim(DD)[1] - sum(is.na(DD$`Billetera digital más usada`)),
dim(DD)[1] - sum(is.na(DD$`Segunda billetera digital más usada`)),
dim(DD)[1] - sum(is.na(DD$`Tiempo de utilización de la billetera digital`)),
dim(DD)[1] - sum(is.na(DD$`Razones iniciales de uso`)),
dim(DD)[1] - sum(is.na(DD$`Razones actuales de uso`)),
dim(DD)[1] - sum(is.na(DD$`Billeteras digitales como principal método de pago`)))
if ( length(unique(Uso_actual_de_bd_comp)) == 1){
print("No hay NA's a considerar: No hay datos faltantes en las preguntas derivadas del uso actual de billeteras digitales.")
}
if ( length(grep("No", DD$`Utilización de las billeteras digitales actualmente`)) == (dim(DD)[1] - sum(is.na(DD$`Intención de utilización de billeteras digitales`))) ){
print("No hay NA's a considerar: Las personas que no usan billeteras digitales han respondido la pregunta acerca de su intención de uso.")
}
if ( (dim(DD)[1] - sum(is.na(DD$`Método principal de pago`))) ==  (dim(DD)[1] - sum(is.na(DD$`Factores de impedimento para la utilización de billeteras digitales`)))){
print("No hay NA's a considerar: Quienes usan un método de pago diferente han contestado la pregunta acerca del porqué no usan una billetera digital como principal.")
}
attach(DD)
T1 <- filter(DD, is.na(DD$`Tiempo de utilización de la billetera digital`) == FALSE)
G1 <- plot(density(T1$`Tiempo de utilización de la billetera digital`),
col = "#E84855",
main = "Gráfico 1: Tiempo de utilización de las billeteras digitales",
xlab = "Meses de uso",
ylab = "Densidad")
V1 <- mfv(DD$`Tiempo de utilización de la billetera digital`, na_rm = TRUE)
V2 <- round(sd(DD$`Tiempo de utilización de la billetera digital`, na.rm = TRUE), 2)
coef_var <- function(x, na.rm = FALSE) {
sd(x, na.rm = na.rm) / mean(x, na.rm = na.rm)
}
V3 <- round(coef_var(DD$`Tiempo de utilización de la billetera digital`, na.rm = TRUE), 2)
summary(DD$`Tiempo de utilización de la billetera digital`)
sprintf("La moda es: %d", V1)
sprintf("La desviación estándar es: %f", V2)
sprintf("El coeficiente de variación es: %f", V3)
G2 <- boxplot(DD$`Tiempo de utilización de la billetera digital`,
# Configuración del título
main = "Gráfico 2.1: Tiempo de utilización de las billeteras digitales",
# Configuración de los ejes
ylab = "Tiempo de uso (meses)",
# Configuración de los bloques
col = "#E84855")
iqtiempo <- IQR(DD$`Tiempo de utilización de la billetera digital`, na.rm=TRUE)
maxtiempo <- quantile(DD$`Tiempo de utilización de la billetera digital`,0.75,na.rm=TRUE)+1.5*iqtiempo
DT <- filter(DD, DD$`Tiempo de utilización de la billetera digital` < maxtiempo)
G2 <- boxplot(DT$`Tiempo de utilización de la billetera digital`,
# Configuración del título
main = "Gráfico 2.2: Tiempo de utilización de las billeteras digitales",
# Configuración de los ejes
ylab = "Tiempo de uso (meses)",
# Configuración de los bloques
col = "#E84855")
DD1 <- data.frame(`Conocimiento de la existencia de las billeteras digitales antes de la pandemia`, `Utilización de las billeteras digitales antes de la pandemia`)
DD1[is.na(DD1)] <- "No"
T3 <- table(DD1)
G3 <- mosaicplot(T3,
# Configuración del título
main = "Gráfico 3: Comparación entre el conocimiento de la existencia de las \nbilleteras digitales y su utilización (prepandemia)",
# Configuración de los bloques
col = c("#E84855", "#0091AD"),
# Configuración de los ejes
xlab = "Conocimiento",
ylab = "Utilización",)
T4 <- table(`Principal razón de la NO utilización de las billeteras digitales antes de la pandemia`)
G4 <- barplot(T4,
# Configuración del título
main = "Gráfico 4: Principal razón de la NO utilización de billeteras digitales \nprepandemia (usuarios que conocían el método de pago)",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 25),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T4),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD"),
cex = 0.75,
inset = c(0, -0.3),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G4, T4 + 1.5, labels = T4)
T5 <- table(str_split_fixed(DD$`Razones iniciales de uso`, ", ", 4))[2:6]
G5 <- barplot(T5,
# Configuración del título
main = "Gráfico 5: Razones iniciales de uso de billeteras digitales",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 100),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T5),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
cex = 0.75,
inset = c(0, -0.338),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G5, T5 + 7, labels = T5)
T6 <- table(str_split_fixed(DD$`Razones actuales de uso`, ", ", 4))[2:5]
G6 <- barplot(T6,
# Configuración del título
main = "Gráfico 6: Razones actuales de uso de billeteras digitales",
cex.main = 1.1,
font.main = 2,
# Configuración de los ejes
ylim = c(0, 100),
ylab = "Cant. personas",
cex.lab = 0.95,
font.lab = 1,
# Barras
col = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
names.arg = FALSE)
legend(x = "bottom",
legend = rownames(T6),
fill = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
cex = 0.75,
inset = c(0, -0.3),
xpd = TRUE)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "gray")
text(G6, T6 + 5.5, labels = T6)
DD2 <- data.frame(`Nivel de comodidad con el método principal de pago`, `Método principal de pago`)
DD2[is.na(DD2)] <- "Billetera digital"
T7 <- table(DD2)
G7 <- mosaicplot(T7,
# Configuración del título
main = "Gráfico 7: Comodidad de los encuestados con su método principal \nde pago",
# Configuración de los ejes
xlab = "Nivel de comodidad",
ylab = "Método principal de pago",
# Configuración de los bloques
color = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE"),
las = 1)
iqpre <- IQR(DD$`Gasto promedio diario pre-pandemia con método principal de pago`, na.rm=TRUE)
iqpost <- IQR(DD$`Gasto promedio diario actual con método principal de pago`, na.rm=TRUE)
maxpre <- quantile(DD$`Gasto promedio diario pre-pandemia con método principal de pago`,0.75,na.rm=TRUE)+3*iqpre
maxpost <- quantile(DD$`Gasto promedio diario actual con método principal de pago`,0.75, na.rm=TRUE)+3*iqpost
DD3 <- filter(DD, DD$`Gasto promedio diario actual con método principal de pago` < maxpost)
DD3 <- filter(DD3, DD3$`Gasto promedio diario pre-pandemia con método principal de pago` < maxpost)
DD4 <- filter(DD3, (DD3$`Utilización de las billeteras digitales antes de la pandemia`== "No") | (DD3$`Conocimiento de la existencia de las billeteras digitales antes de la pandemia` == "No"))
ColoresG8 = c("#403F4C", "#E84855")
G8 <- plot(x = DD4$`Gasto promedio diario actual con método principal de pago`,
y = DD4$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 8: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, no usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG8[factor(DD4$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD4$`Billetera digital más usada`)), fill = ColoresG8, title = "Billetera digital \n a la que migraron")
DD4P <- filter(DD4, DD4$`Billetera digital más usada`=="Plin")
DD4Y <- filter(DD4, DD4$`Billetera digital más usada`=="Yape")
corrP1 <- cor(DD4P$`Gasto promedio diario actual con método principal de pago`, DD4P$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY1 <- cor(DD4Y$`Gasto promedio diario actual con método principal de pago`, DD4Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Plin es: %f", corrP1)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY1)
DD5 <- filter(DD3, DD3$`Billeteras digitales como principal método de pago` == "Sí")
DD5 <- filter(DD5, DD5$`Utilización de las billeteras digitales antes de la pandemia`== "Sí")
ColoresG9 = c("#403F4C", "#E84855", "#F9DC5C", "#0091AD", "#55D6BE")
G9 <- plot(x = DD5$`Gasto promedio diario actual con método principal de pago`,
y = DD5$`Gasto promedio diario pre-pandemia con método principal de pago`,
pch = 20,
# Configuración del título
main = "Gráfico 9: Pre vs postpandemia del promedio del gasto diario de los que usuarios \nactuales de billeteras digitales",
cex.main = 1,
# Configuración del subtitulo
sub = "* Nota: Usuarios que, prepandemia, usaban billeteras digitales",
cex.sub = 0.8,
# Configuración de los ejes
xlab = "Postpandemia",
ylab = "Prepandemia",
col = ColoresG9[factor(DD5$`Billetera digital más usada`)])
legend(x = "topleft", legend = levels(factor(DD5$`Billetera digital más usada`)), fill = ColoresG9, title = "Principal billetera \n digital usada")
DD5Y <- filter(DD5, DD5$`Billetera digital más usada`=="Yape")
corrV <- cor(DD5$`Gasto promedio diario actual con método principal de pago`, DD5$`Gasto promedio diario pre-pandemia con método principal de pago`)
corrY2 <- cor(DD5Y$`Gasto promedio diario actual con método principal de pago`, DD5Y$`Gasto promedio diario pre-pandemia con método principal de pago`)
sprintf("La covarianza de ambas variables para los usuarios de Yape es: %f", corrY2)
sprintf("La covarianza de ambas variables para todos los usuarios: %f", corrV)
