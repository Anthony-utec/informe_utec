---
title: "Estudio de la influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana en el año 2023"
format: html
editor: visual
---

## 1.Introducción

La influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana ha sido cada vez más notoria en los últimos años, y se espera que en este año 2023 esta tendencia continúe en ascenso. Desde la popularidad de los dispositivos móviles y las tabletas, hasta la creciente oferta de contenido en línea, los consumidores de información han cambiado la forma en que acceden y consumen material de lectura.

Con el aumento de opciones de libros electrónicos y aplicaciones móviles, cada vez más personas están optando por formatos digitales como su principal fuente de lectura, en lugar de los formatos tradicionales como los libros físicos. Estos cambios también han llevado a nuevas formas de interacción con el contenido, como la compartición de fragmentos de lectura en redes sociales y aplicaciones de mensajería.

En general, en el año 2023 se espera conocer su nivel de influencia y que a la vez sea un momento emocionante para los hábitos de lectura en Lima Metropolitana, para poder conocer si la tecnología digital esta liderando o no el camino. proporcionando una experiencia de lectura más interactiva e inmediata.

A través de este proyecto, hemos tratado de explorar estas preguntas y arrojar luz sobre un tema muy relevante en la actualidad. A través del análisis de datos y herramientas estadísticas, se espera profundizar en la comprensión de los cambios en los hábitos de lectura en el área metropolitana de Lima y los factores que promueven o ralentizan la adopción de la lectura digital en la región.

## 2.Relevancia

Este proyecto de estadística es relevante por varias razones. En primer lugar, permite conocer cómo la tecnología digital ha afectado uno de los hábitos más importantes para el desarrollo intelectual y cultural de las personas, como es la lectura. Al analizar la influencia de la lectura digital en Lima Metropolitana, se puede obtener información valiosa sobre las tendencias y patrones de consumo de contenido en la era digital, y así orientar la toma de decisiones de las instituciones encargadas de la promoción de la lectura.

Además, el proyecto es relevante para el sector editorial y los escritores, ya que proporciona información sobre cómo se está consumiendo la literatura en formato digital, qué tipo de contenidos son más populares en este formato, y cuáles son los factores que motivan o desmotivan la lectura en la tecnología digital.

Por último, este proyecto puede ser importante para los investigadores en el campo de la comunicación y la sociología, al brindar una visión general de cómo los avances tecnológicos están influyendo en los hábitos culturales de la población. En resumen, el análisis del uso de la lectura digital en Lima Metropolitana puede contribuir a una comprensión más profunda de los cambios en los hábitos de lectura y su relación con la era digital, lo que puede tener implicancias importantes en diferentes ámbitos de la sociedad.

## 3.1 Justificación Teórica

Se basa en el hecho de que cada vez más personas están optando por el uso de dispositivos móviles y tabletas para acceder a la información. Además, la creciente oferta de libros electrónicos y aplicaciones móviles, y la accesibilidad a contenido en línea, están cambiando la forma en la que las personas consumen material de lectura. Estos cambios en los hábitos de lectura también están llevando a nuevas formas de interacción con el contenido, incluyendo la compartición de fragmentos de lectura en redes sociales y aplicaciones de mensajería.

Hoy en día la tecnología digital afectan en gran magnitud a los lectores de Lima Metropolitana y se busca identificar si este cambio tiene relevancia o no, el proyecto serviría para poder analizar qué factores tanto positivos como negativos existen y de esa manera que el lector tenga una mejor perspectiva, para que de esta manera con todos los datos que llegaríamos a obtener ,se podría realizar un informe técnico.

## 3.2 Justificación Practica

Se basa en el hecho de que los usuarios tienen cada vez más acceso a dispositivos móviles y tabletas que les permiten acceder a contenidos digitales desde cualquier lugar y en cualquier momento . Además, la creciente oferta de libros electrónicos y aplicaciones móviles ha llevado a una mayor disponibilidad de contenido en línea, lo que hace que estos formatos sean cada vez más atractivos para los usuarios. Esto ha llevado a cambios en la forma en que las personas interactúan con el contenido.

En definitiva la tecnología digital en los hábitos de lectura radica en su capacidad para ofrecer una experiencia de lectura más accesible, interactiva e inmediata a los usuarios, lo que les permite consumir más contenido en línea y desde dispositivos móviles. Esto hace que la tecnología digital sea altamente relevante para los hábitos de lectura en Lima Metropolitana en el año 2023.

## 4.Objetivos

-Analizar el nivel de influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana en el 2023.

## 4.1 Objetivos específicos

-Identificar el nivel de influencia de la tecnología digital en Lima Metropolitana en el 2023.

-Evaluar el nivel de hábitos de lectura en Lima Metropolitana en el 2023.

-Conocer la percepción de las personas respecto al nivel de influencia de la tecnología digital en sus hábitos de lectura en Lima Metropolitana 2023.

## 5. Delimitacion de la investigacion

El presente estudio se centra en realizar el análisis del nivel de influencia de la tecnología digital en general referente a los hábitos de lectura en Lima metropolitana , durante el período del año 2023. Esta investigación se desarrolló dentro de la ciudad de Lima,mercados ,calles y centro comerciales. Se excluyeron a las personas que no deseaban participar de la encuesta o que presentaron datos incompletos en el test o menores de edad.

## 6. Proceso de recolección de datos

La información para nuestra base de datos fue recopilada a través de una ecuesta formulada en Google Forms, la cual nos permitio obtener una información de preguntas previamente diseñado la cual eran tomadas por las personas que viven en Lima metropolitana y digerida por Rstudio.Este mecanismo facilito el buen de la informacion de trabajo en tiempo real y más exacta a nuestras variables de estudio.Cabe resaltar que se tomó en cuenta que nuestra población contenga solamente personas que viven en lima metropolitana y que sean mayores de 16 años por delante y que cuenten con acceso a internet o con un dispositvo electronico para poder acceder a al llenado de la encuesta y saber de la influencia de la tecnoligia digital en sus habitos de lectura.

Además , nos aseguramos un alto porcentaje de llenado correcto por parte de las personas ya que se colocó, en la mayoría de preguntas, respuestas con opciones para marcar y en las que se escribían pusimos ejemplos, siendo esto un factor importante para un buen llenado y de beneficio para nosotros a la hora de hacer la limpieza. Es relevante mencionar que hemos conseguido llegar a una muestra de 178 personas con la estrategia de visitar avenidas concurridas ,mercados, y personas sentadas en parques compartiendo el enlace de la encuesta. De la misma manera, hicimos la petición a familiares para que lo compartan con sus groups de WhatsApp de estudio y trabajo pidiéndoles que realicen la encuesta. Finalmente, en cada petición de llenado se hizo el pedido de un llenado limpio y veraz.

1.  Creación de un formulario mediante el uso de Google Forms (<https://docs.google.com/forms/d/e/1FAIpQLSeW11BR0HeOhGwoDW_vagB6YAIx2S6TYqS7B0X4G3LJt8MO8A/viewform>) con preguntas definidas de acuerdo al objetivo del estudio.\n
2.  La difusión del cuestionario fue de manera presencial en Lima Metropolitana.

## Población, muestra y muestreo

En la elaboración de este estdudio hemos decidido trabajar con la población de \*Lima metropolitana año 2023, siendo la unidad muestral cada persona que vive en la ciudad. Asimismo, el tamaño de nuestra muestra es de **178 individuos, de los cuales hemos recolectado sus datos e información acerca de nuestro tema elegido, mediante una encuesta de Google Forms. Finalmente, nuestro** muestreo\* es *por conveniencia*, debido a que hemos recaudado información de manera directa a alas personas que se encontraban comprando,trancitando las calles de la ciudad de la muestra de la población y ellos decidían si dar o no la encuesta, para así fomentar la representatividad con información veraz.

## 7. Identificación de variables

-   Nivel de influencia.
-   Es el nivel en que afectó la era digital a sus hábitos relacionados a la lectura tradicional.
-   Cantidad de libros leídos al mes.
-   Número de libros que la persona tiene costumbre de leer por mes generalmente.
-   Preferencia al medio físico - digital.
-   Grado de relevancia al elegir un medio de lectura por su comodidad, estilo o practicidad.
-   Profesión - Trabajo.
-   Labor que desempeña en el mundo laboral ya sea formal o informalmente.
-   Sexo.
-   Grupo de características físicas, biológicas, fisiológicas y anatómicas que determinan a un ser humano si es hombre o mujer.
-   Edad.
-   Cantidad de años cumplidos desde su nacimiento.

# CLASIFICACIÓN DE VARIABLES:

+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Escala de medición | Variable                                               | Tipo de variable      | Indicadores                                                                                            |
+:==================:+:======================================================:+:=====================:+:======================================================================================================:+
| Discreta           | Edad                                                   | Cuantitativa Discreta | Edad en años                                                                                           |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Politómica         | Nivel de influencia                                    | Cualitativa Ordinal   | No influyó= 1 poco=2 regular=3 mucho= 4                                                                |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        |                       | demasiado = 5                                                                                          |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Cantidad de libros leídos al mes                       | Cuantitativa Discreta | Cantidad específica                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Preferencia al medio Impreso-digital(Online o Impreso) | Cualitativa           | Impreso = 0 Digital = 1                                                                                |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        | Nominal               |                                                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Ocupación                                              | Cualitativa           | Estudiante universitario = 0 Trabajador de construcción = 1 Empleado = 2 Comerciante = 3 Bachiller = 1 |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        | Nominal               |                                                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Sexo                                                   | Cualitativa nominal   | Masculino= 0 Femenino= 1                                                                               |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Edad                                                   | Cuantitativa Discreta | Edad en años                                                                                           |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Numérica           | Gasto en compra de libros online/Impreso               | Cuantitativa continua | Cantidad en soles                                                                                      |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Tecnologías digitales                                  | Cualitativa Ordinal   | influye en el tiempo                                                                                   |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómicas        | Motivación de lectura                                  | Cualitativa nominal   | motivos específicos                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Tipo de trama en los libros                            | Cualitativa nominal   | No puede ser medida con números                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Objetos de entretenimiento                             | Cualitativa Nominal   | Cantidad específica                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Numérica           | Costo del libro online/impreso                         | Cuantitativa continua | Cantidad en soles                                                                                      |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+

## Limpieza de Datos

```{r}
library(readr)
```

Nos permitira leer y cargar datos para su posterior analisis estadistico de nuestros varidad formatos.

```{r}
DF <- read_csv("EC23.csv" , col_types="ccccccccccccccccccnnnnnnnn")
```

Es uno de los primeros pasos clave en el análisis de datos y la estadística de nuestra muestra.

```{r}
spec(DF)
```

```{r}
names(DF)  # names devuelve el nombre de las variables del DataFrame
```

Es útil para conocer los nombres de las variables y para seleccionar las variables relevantes de nuestro conjunto de datos la cual nos permite el análisis y la visualización de datos estadísticamente.

```{r}
library(dplyr)
```

Con la función "select" sacaremos de nuestro \_dataframe\_ las primeras 2 variables porque son irrelevantes para nuestro estudio y se creará un subconjunto con 24 variables y será nuestro nuevo \`DF\`.

```{r}
select(DF, 3:26) -> DF
```

Cambiamos el nombre de las variables.

```{r}
DF %>% rename (Edad = `Qué edad tienes ? (Responde en años)`,Sexo=Sexo,Ocupación=Ocupación, Distraccion = `PREGUNTA 1:  Cuando tienes 15 minutos de tiempo libre o más y necesitas desestresarte ¿Qué objetos llevas contigo?`,Celular=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Celular]`,Laptop=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Laptop]`, Libro=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Biblioteca o Libro]`,Television=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Televisión]`,Videojuegos=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Videojuegos]`,Ebooks=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [E-books (Libros en internet)]`,Internet=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Internet]`, TD=`PREGUNTA 3: ¿Cuál es la tecnología digital que utilizas más en tu vida diaria?`,Lecturalibre =`PREGUNTA 4: ¿Acostumbras leer en tu tiempo libre?`,Lxsemana=`PREGUNTA 5. ¿Cuántas veces a la semana lees?`,Trama=`PREGUNTA 6. ¿Qué tipo trama en los libros te agrada?`,Motivacion=`PREGUNTA 7. ¿Cuál es el motivo principal por que lees?`,Online=`Online`,Impreso=`Impreso`,Lxmes=`PREGUNTA 9:  ¿Cuántos libros lees aproximadamente al mes?`,hrsem=`PREGUNTA 10:  ¿Cuántas horas a la semana le dedicas a la lectura, aproximadamente?`,Máximo=`Máximo`,Mínimo=`Mínimo`,CsUL=`PREGUNTA 12: ¿Cuánto te costó el último libro online o impreso que adquiriste, en soles? (Responda con un punto si el precio es número no entero, ej: 37.8 o 40.1 )`,InfluenciaTD=`PREGUNTA 13:   De una escala del 1 al 5 como influye la tecnología digital en tu vida con respecto a tus hábitos de lectura (1 es negativamente y 5 es positivamente)\n`)-> DFN
```

```{r}
DFN
```

Para saber cuántas observaciones o unidades muestrales se tienen, se puede usar la siguiente función.

```{r}
nrow(DFN)
```

Para saber cuántas columnas o variables tiene la base de datos.

```{r}
ncol(DFN)   # indica el número de variables que tiene la data  
```

La función dim vevuelve dos valores, el primero el números de filas (observaciones) y el segundo el número de columnas (variables) de la base de datos.

```{r}
dim(DFN)
```

Para acceder al valor que tiene una posición particular en la data.

```{r}
DFN[3,6]  # devuelve el valor que tiene el DataFrame en la posición (3,6)
```

Para saber cúantos datos faltantes (NA's) tiene el Dataframe:

```{r}
sum(is.na(DFN))
```

Si quisiéramos ver la cantidad de datos faltantes que hay y la cantidad de datos no faltantes que hay puedo usar la función table. Table da un resumen de los valores que toma is.na y cuánta cantidad hay de cada tipo.

```{r}
table(is.na(DFN))
```

```{r}
table(DFN$Sexo)
```

Para saber cuántas observaciones completas tiene la data.

```{r}
sum(complete.cases(DFN))
```

Hacemos el registro de los datos que tenemos hasta ahora con \`summary\`

```{r}
summary(DFN)
```

Para empezar la limpieza, identificamos los datos vacíos o NA por columna **(Justificación)**

```{r}
summarise_all(DFN, funs(sum(is.na(.))))
```

Eliminamos las filas con valores nulos

```{r}
DFN <- na.omit(DFN)
```

Hacemos la verificación de los datos completos

```{r}
sum(is.na(DFN))
```

Hagamos un resumen de observaciones completas e incompletas.

```{r}
table(complete.cases(DFN))
```

**LIMPIEZA**

Limpiamos la variable Edad

```{r}
summary(DFN$Edad)
unique(DFN$Edad)
DFN$Edad[DFN$Edad == "-"] <- NA
DFN$Edad <- strtoi(DFN$Edad)
summary(DFN$Edad)
```

**Datos Atípicos**

En al variable Lxmes deberían ser todos los valores enteros, pero no lo son

```{r}
is.integer(DFN$Lxmes)
```

Limpiamos Lxmes

```{r}
DFN %>% mutate(Lxmes =
         ifelse(Lxmes == 0.5,round(0.5,0), # round redondea al entero más cercano a 0.5 (el primer argumento es el número a redondear y el segundo la cantidad de dígitos decimales)
            Lxmes)) -> DFN
DFN$Lxmes <- strtoi(DFN$Lxmes) # convierte strings a enteros
summary(DFN$Lxmes)
```

Escalas de 1 a 5, por datos categóricos

```{r}
DFN %>% mutate(Online =
         ifelse(Online == 1,"Muy bajo",
         ifelse(Online == 2,"Bajo",
         ifelse(Online == 3,"Neutral",
         ifelse(Online == 4,"Alto",
         ifelse(Online == 5,"Muy alto",
            Online)))))) -> DFN
```

con este vector de la variable Online se obetendra valores del 1 al 5 cuyo valores se cubren en 5 categorías: "Muy bajo", "Bajo", "Neutral", "Alto" y "Muy alto". Por lo tanto, se utiliza una serie de condiciones ifelse anidadas para asignar los valores a cada categoría en función del valor de la variable Online. Es decir nos permirira conocer a detalle y ordenado la preferencia de las personas encuestadas, si prefieren oline y su determinado punto de uso al momento de efectuar su lectura.

```{r}
DFN %>% mutate(Impreso =
         ifelse(Impreso == 1,"Muy bajo",
         ifelse(Impreso == 2,"Bajo",
         ifelse(Impreso == 3,"Neutral",
         ifelse(Impreso == 4,"Alto",
         ifelse(Impreso == 5,"Muy alto",
            Impreso)))))) -> DFN
```

```{r}
DFN %>% mutate(InfluenciaTD =
         ifelse(InfluenciaTD == 1,"Muy baja",
         ifelse(InfluenciaTD == 2,"Baja",
         ifelse(InfluenciaTD == 3,"Neutral",
         ifelse(InfluenciaTD == 4,"Alta",
         ifelse(InfluenciaTD == 5,"Muy alta",
            InfluenciaTD)))))) -> DFN
```

La sintaxis que se muestra en este código se está utilizando para cambiar el tipo de dato de algunas variables en un conjunto de datos denominado "DFN". Por ejemplo, se utiliza la función "as.character()" para cambiar el tipo de dato de las variables "Sexo", "Ocupación", "Distracción", "Celular", "Laptop,"Libro", "Television", "Videojuegos", "Ebooks", "Internet", "TD", "Lecturalibre", "Trama", "Motivación" e "InfluenciaTD" a tipo de dato de texto o caracter.

Se utiliza la función "as.integer()" para cambiar el tipo de dato de la variable "Edad" a un tipo numérico entero. Además, se utiliza la función "as.numeric()" para cambiar el tipo de dato de las variables "Máximo", "Mínimo" y "CsUL" a tipo numérico decimal.En nuestra base de datos, en la parte de las variables de Maximo y Minimo, por simple lógica; los datos de máximo deberían ser mayores que lo mínimos, sin embargo eso no se cumple como se puede apreciar con las siguientes funciones.

```{r}
max(DFN$Máximo)
max(DFN$Mínimo)
```

La línea de código que se muestra devuelve el valor máximo de las variables "Máximo" y "Mínimo" en el conjunto de datos "DFN". Según la información proporcionada en la búsqueda, se sabe que el valor máximo para "Máximo" es de 400 y el valor máximo para "Mínimo" es de 5050. lo cual no tiene sentido, aplicamos un filtro para identificar esas filas.Desde una perspectiva estadística, la interpretación de estos valores sugiere que los valores máximo y mínimo son bastante diferentes entre sí, lo que puede indicar la presencia de valores atípicos o una amplia variabilidad en los datos. Además, el rango entre los valores mínimo y máximo son importante en la medida en que estos límites extremos del conjunto de datos pueden afectar la interpretación de los resultados y las conclusiones que se pueden obtener a partir del análisis.

{r} DFN$$DFN\$Mínimo\>400,$$

Y las eliminamos de \`DFN\` generando subconjuntos con los datos limpios

```{r}
DFN2 <- DFN[DFN$Mínimo!=1040,]
```

```{r}
DFN3 <- DFN2[DFN2$Mínimo!=5050,]
```

Agregaremos una nueva varible a nuestro estudio, la cual consiste en el promedio de gastos en libros (entre el máximo y el mínimo precio)

```{r}
Data_Final <- mutate(DFN3, PromedioGs = ((DFN3$Máximo + DFN3$Mínimo)/2))
```

**Descriptores numéricos**} <font size="3"> **6.1 Análisis de la edad** </font>

Con la función summary() bamos a identificar y a obtener estadísticas descriptivas como la media, la mediana, la desviación estándar y los cuartiles para cada una de nuestras variable solicitadas dentro de nuestro estudio.La cual nos permtira encontrar la moda y con la moda sabremos cual es la tendencia central del valor de la frecuencia de nuestro conjunto de datos observados .

```{r}
summary(Data_Final$Edad)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$Edad)
```

<font size="3"> Moda </font>}

```{r}
ModaCreada <- function(x) {
  DatosSinNulos <- na.omit(unique(x))
  tabulado <- tabulate(match(x, DatosSinNulos))
  DatosSinNulos[tabulado == max(tabulado) ]
}
ModaCreada(Data_Final$Edad)
```

Podemos observar que la moda de esta distribución es "18 años", ya que es el valor que se presenta con mayor frecuencia en el conjunto de datos . De esta manera, podemos interpretar la moda como la opción más popular entre las personas encuestadas en este estudio estadístico.

<font size="3"> **6.2 Análisis de la cantidad de libros leídos por mes** </font>

Con la función summary podemos obtener la mediana y media con los rangos intercuartiles de la variable solicitada (análisis de la variable por mes)

```{r}
summary(Data_Final$Lxmes)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$Lxmes)
```

<font size="3"> Moda </font>

```{r}
ModaCreada(Data_Final$Lxmes)
```

De nuestra base de datos, las personas leen un libro al mes

<font size="3"> **6.3 Análisis de la cantidad de horas a la semana de lectura** </font>

Con la función summary() podemos obtener conversión del tipo de datos ,la mediana y media con los rangos intercuartiles de la variable solicitada por estudio.

```{r}
summary(Data_Final$hrsem)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$hrsem)
```

<font size="3"> Moda </font>

```{r}
ModaCreada(Data_Final$hrsem)
```

En nuestra base de datos, las personas leen 2 horas a la semana.

PRUEBA DE DESCRIPTOR GRAFICO.\

VARIABLES Y SUS TIPOS

```{r}
# Iterar a través de los nombres de las variables
nombres_variables <- colnames(Data_Final)

# Iterar a través de los nombres de las variables
for (var in nombres_variables) {
  tipo <- class(Data_Final[[var]])
  mensaje <- paste(var, "es de tipo", tipo)
  print(mensaje)
}
```

```{r}

# Obtener la lista única de edades y ordenarlas
edades_unicas <- sort(unique(Data_Final$Edad))

# Filtrar las edades dentro del rango de 12 a 20
edades_filtradas <- edades_unicas[edades_unicas >= 12 & edades_unicas <= 20]

# Crear un vector de alturas para el gráfico
alturas <- rep(NA, length(edades_filtradas))

# Calcular las diferencias de precios y asignarlas a las alturas correspondientes
for (i in 1:length(edades_filtradas)) {
  edad <- edades_filtradas[i]
  alturas[i] <- max(Data_Final$Máximo[Data_Final$Edad == edad]) - min(Data_Final$Mínimo[Data_Final$Edad == edad])
}

# Reemplazar la variable "Edad" en el último descriptor gráfico
barplot(height = alturas, names.arg = edades_filtradas,
        col = "steelblue",
        xlab = "Edad", ylab = "Diferencia de precios",
        main = "Diferencia de precios de libros entre la edad de 12 y 20 años")

legend("topright", legend = c("Diferencia"), fill = "steelblue")


#Promedio de gasto
#Gasto máximo

#boxplot indexado por edad 

#cut() 5 partes iguales 

```

\

La justificación se basa en el análisis de la frecuencia de las variables representadas en el gráfico. Los resultados revelan que los jóvenes de 17 años son los que muestran un mayor gasto en la compra de libros, aproximadamente 400 soles al mes para adquirir su libro preferido. Les siguen los jóvenes de 18 años en términos de gasto, mientras que se puede concluir que los adolescentes de 14 años gastan menos de 100 soles. Esto se atribuye a su dependencia económica de sus padres, lo que limita su capacidad de gasto. Por otro lado, es posible que los jóvenes de 17 años dispongan de ingresos adicionales aparte de la asignación que reciben de sus padres, lo que explicaría su mayor capacidad de gasto.

```{r}
# Cargar las bibliotecas necesarias
library(dplyr)
library(ggplot2)

# Asignar valores a cada frecuencia
valores_frecuencia <- c( "Nunca" = 1, "Una vez al mes" = 2, "Casi nunca al mes" = 3,"Muchas veces al mes" = 4, "Casi siempre" = 5)


# Convertir las variables a factores y establecer el orden deseado
Data_Final$Celular <- factor(Data_Final$Celular, levels = names(valores_frecuencia))
Data_Final$Laptop <- factor(Data_Final$Laptop, levels = names(valores_frecuencia))
Data_Final$Libro <- factor(Data_Final$Libro, levels = names(valores_frecuencia))
Data_Final$Television <- factor(Data_Final$Television, levels = names(valores_frecuencia))
Data_Final$Videojuegos <- factor(Data_Final$Videojuegos, levels = names(valores_frecuencia))
Data_Final$Ebooks <- factor(Data_Final$Ebooks, levels = names(valores_frecuencia))
Data_Final$Internet <- factor(Data_Final$Internet, levels = names(valores_frecuencia))


Data_Final %>% mutate(Celular =
         ifelse(Celular == 1,"Muy baja",
         ifelse(Celular == 2,"Baja",
         ifelse(Celular == 3,"Neutral",
         ifelse(Celular == 4,"Alta",
         ifelse(Celular == 5,"Muy alta",
            Celular)))))) -> Data_Final

# Crear el dataframe de frecuencias y calcular la suma de cada columna
df_frecuencias <- data.frame(
  Categoria = c("Libro", "Videojuegos", "Television", "Ebooks", "Laptop", "Celular", "Internet"),
  Frecuencia = c(
    sum(valores_frecuencia[Data_Final$Libro]),
    sum(valores_frecuencia[Data_Final$Videojuegos]),
    sum(valores_frecuencia[Data_Final$Television]),
    sum(valores_frecuencia[Data_Final$Ebooks]),
    sum(valores_frecuencia[Data_Final$Laptop]),
    sum(valores_frecuencia[Data_Final$Celular]),
    sum(valores_frecuencia[Data_Final$Internet])
  )
)

# Reordenar el dataframe por frecuencia descendente
df_frecuencias <- df_frecuencias %>% arrange(desc(Frecuencia))

# Crear el gráfico de barras con rectángulos en orden descendente
grafico_barras <- ggplot(data = df_frecuencias, aes(x = reorder(Categoria, -Frecuencia), y = Frecuencia, fill = Categoria)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Categoría", y = "Suma de frecuencias", title = "Frecuencia de Uso de Dispositivos") +
  theme_minimal()

# Ajustar el ancho de las barras
grafico_barras <- grafico_barras + theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Asignar posiciones uniformes en el eje Y
posiciones_eje_y <- seq(max(df_frecuencias$Frecuencia), 0, length.out = length(valores_frecuencia))
etiquetas_eje_y <- rev(names(valores_frecuencia))

# Asignar posiciones y etiquetas en el eje Y
grafico_barras <- grafico_barras + scale_y_continuous(breaks = posiciones_eje_y, labels = etiquetas_eje_y, limits = c(0, max(df_frecuencias$Frecuencia)))

# Imprimir el gráfico de barras
print(grafico_barras)



#Cambiar a mosaico

#Reviar la naturaleza de las variables

```

\
Observando la gráfica generada y resuelta, se puede concluir que las personas encuestadas tienden a utilizar más celulares en su tiempo libre. Es importante destacar que la diferencia con respecto al uso de internet es mínima y que, según la muestra, el uso de libros y videojuegos es muy bajo. En resumen, se puede inferir que la influencia de la tecnología digital y la lectura de libros en el tiempo de ocio están casi equilibradas.

```{r}
table(Data_Final$Sexo, Data_Final$InfluenciaTD)

Colores<-{}
Colores["Azul"]<-"lightblue"
Colores["Verde"]<-"lightgreen"
Colores["Gris"]<-"gray"
Colores["Castaño"]<-"chocolate4"
Colores["Negro"]<-"orange"

datos <- matrix(c(5, 10, 15, 20, 25, 30), nrow = 2)
par(las = 1)

mosaicplot(table(Data_Final$Sexo,Data_Final$InfluenciaTD),col=c("chocolate4","darkgray","lightblue","lightgreen","orange","blue"),main="Nivel de hábitos de lectura en Lima Metropolitana en el 2023",
           xlab = "Sexo",
           ylab = "Influencia de las TEC")
            


```

De manera simple el codigo nos permite interpretar la muestra de la variable "nivel de habitos de lectura" de las personas encuestadas en Lima Metropolitana, la cual esta distribuida con categoricas "edad","sexo", nivel y influencia tecnologias digitales las cuales poseen una frecuencia de uso del 1 a 5 las cuales nos dieron un resultado.

Objetivo 1 **influencia online**

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  sexo = c(Data_Final$Sexo),
  Online = c(Data_Final$Online)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Online, datos$sexo)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Online", y = "Frecuencia", fill = "Sexo") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

De manera simple el codigo nos permite interpretar que son las mujeres las que tienen mayor nivel de influencia que los varones en sus habitos de lectura por parte de las tecnologias digitales.

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  sexo = c(Data_Final$Sexo),
  Impreso = c(Data_Final$Impreso)
)

#Ordenar los datos según el nivel de influencia
datos$Impreso <- factor(datos$Impreso, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Impreso, datos$sexo)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Tradicional", y = "Frecuencia", fill = "Sexo") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

En comparativa con el gráfico anterior podemos notar que pondera que la frecuencia de lectura física o tradicional de parte del sexo femino. Evidentemente, se puede concluir que la preferencia por el sexo femenino a la lectura física que virtual es alta; a diferencia que al sexo masculino.

OBJETIVO 3 (percepción por edad)

```{r}
# Crear un data frame de ejemplo con las variables Online y Edad
datos <- data.frame(
  Online = c(Data_Final$Online),
  Edad = c(Data_Final$Edad)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Crear el gráfico de cajas y bigotes
ggplot(datos, aes(x = Online, y = Edad)) +
  geom_boxplot(fill = "steelblue", color = "black", outlier.shape = NA) +
  labs(x = "Online", y = "Edad") +
  ggtitle("Relación entre Online y Edad") +
  theme_minimal()

```

De acuerdo a esta gráfica, podemos observar qué en el rango de edad de 20 a 30 prefieren leer de manera online y es una opción neutra. Esto se conlcuye a partir de la media, la cual se puede apreciar por medio de las lineas en medio del boxplot.

```{r}
# Cargar la biblioteca ggplot2 si aún no está cargada
library(ggplot2)

# Crear un data frame de ejemplo con las variables Online y Edad
datos <- data.frame(
  Online = c(Data_Final$Online),
  Edad = c(Data_Final$Edad)
)


datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Crear el gráfico de puntos con el eje Y limitado a valores entre 10 y 40
ggplot(datos, aes(x = Online, y = Edad)) +
  geom_point(color = "steelblue", size = 1.4) +  # Estilo de los puntos
  labs(x = "Online", y = "Edad") +
  ggtitle("Relación entre Edad y Online") +
  theme_minimal() +
  coord_cartesian(ylim = c(10, 40)) +
  theme(
    plot.title = element_text(size = 14, face = "bold"), 
    axis.title = element_text(size = 12, face = "bold"), 
    axis.text = element_text(size = 10),  
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()  
  )


```

GRÁFICO DE INFLUENCIA

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  Lecturalibre = c(Data_Final$Lecturalibre),
  Online = c(Data_Final$Online)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Online, datos$Lecturalibre)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Online", y = "Frecuencia", fill = "Lectura en tiempo libre") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

Según los resultados de la gráfica se puede interpretar que el nivel de influencia de la tecnología digital en el tiempo libre de las personas de lima metropolitana es a veces y es neutral. Es decir tiene una frecuencia de 33 %, siendo el 20 % que opinan que el uso de la tecnología es muy alto y que si influye en sus hábitos de lectura y están presentes sea por un table, celular o ordenador ya que son los únicos medios por donde pueden acceder a plataformas o contenidos de entretenimiento o información. Cabe recalcar car que hay un 8% que opina que la tecnología digital no influye en sus hábitos de lectura.

##Descripción En conclucion observamos que cada uno de nuestros objetivo cumplen con lo expresado en nuestro estudio de investigacion .Es decir la tecnologia digital esta prente en los habitos de lectura de las personas que viven en Lima metropolitana y que la poblacion que con mas frecuencia hace uso de ese medio somas mujeres que varones y lo hacer por distracion por que les gusta y acceden a ella por medio de instrumentos tecnologicos como laptop ,y celulares y son pocas las personas que ya suelen utilizar libros impresos y son los jovenes los que utilizan mas la opcion onlane .

## Bibliografía

-Jin Lee, D. (Ed.). (2019c). Modelos lineales y análisis de la varianza. En Curso de formación en R (capitulo 6 ed., pp. 6--6-7). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/modelos-lineales-y-analisis-de-la-varianza.html>

-Uso básico de Rstudio (2019 ) .Para la estadística descriptiva en ciencia sociales ( capitulo 4) <https://bookdown.org/gboccardo/manual-ED-UCH/uso-basico-de-rstudio.html#manejo-basico-de-la-sintaxis-de-r-creacion-de-objetos-inclusion-de-anotaciones-y-definicion-de-secciones>

-   Introducción al software estadístico R. (2019). En Curso de formacion en R (capitulo 2 ). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/intro.html>

-Introducción a la programación básica con R. (2019). En Cursos de formación en R (capitulo 4). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/introduccion-a-la-programacion-basica-con-r.html>
