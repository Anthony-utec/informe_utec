---
title: "Estudio de la influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana en el año 2023"
format: html
editor: visual
---

```{r}

```

## 1.Introducción

La influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana ha sido cada vez más notoria en los últimos años, y se espera que en este año 2023 esta tendencia continúe en ascenso. Desde la popularidad de los dispositivos móviles y las tabletas, hasta la creciente oferta de contenido en línea, los consumidores de información han cambiado la forma en que acceden y consumen material de lectura.

Con el aumento de opciones de libros electrónicos y aplicaciones móviles, cada vez más personas están optando por formatos digitales como su principal fuente de lectura, en lugar de los formatos tradicionales como los libros físicos. Estos cambios también han llevado a nuevas formas de interacción con el contenido, como la compartición de fragmentos de lectura en redes sociales y aplicaciones de mensajería.

En general, en el año 2023 se espera conocer su nivel de influencia y que a la vez sea un momento emocionante para los hábitos de lectura en Lima Metropolitana, para poder conocer si la tecnología digital esta liderando o no el camino. proporcionando una experiencia de lectura más interactiva e inmediata.

A través de este proyecto, hemos tratado de explorar estas preguntas y arrojar luz sobre un tema muy relevante en la actualidad. A través del análisis de datos y herramientas estadísticas, se espera profundizar en la comprensión de los cambios en los hábitos de lectura en el área metropolitana de Lima y los factores que promueven o ralentizan la adopción de la lectura digital en la región.

## 2.Relevancia

Este proyecto de estadística es relevante por varias razones. En primer lugar, permite conocer cómo la tecnología digital ha afectado uno de los hábitos más importantes para el desarrollo intelectual y cultural de las personas, como es la lectura. Al analizar la influencia de la lectura digital en Lima Metropolitana, se puede obtener información valiosa sobre las tendencias y patrones de consumo de contenido en la era digital, y así orientar la toma de decisiones de las instituciones encargadas de la promoción de la lectura.

Además, el proyecto es relevante para el sector editorial y los escritores, ya que proporciona información sobre cómo se está consumiendo la literatura en formato digital, qué tipo de contenidos son más populares en este formato, y cuáles son los factores que motivan o desmotivan la lectura en la tecnología digital.

Por último, este proyecto puede ser importante para los investigadores en el campo de la comunicación y la sociología, al brindar una visión general de cómo los avances tecnológicos están influyendo en los hábitos culturales de la población. En resumen, el análisis del uso de la lectura digital en Lima Metropolitana puede contribuir a una comprensión más profunda de los cambios en los hábitos de lectura y su relación con la era digital, lo que puede tener implicancias importantes en diferentes ámbitos de la sociedad.

## 3.1 Justificación Teórica

Se basa en el hecho de que cada vez más personas están optando por el uso de dispositivos móviles y tabletas para acceder a la información. Además, la creciente oferta de libros electrónicos y aplicaciones móviles, y la accesibilidad a contenido en línea, están cambiando la forma en la que las personas consumen material de lectura. Estos cambios en los hábitos de lectura también están llevando a nuevas formas de interacción con el contenido, incluyendo la compartición de fragmentos de lectura en redes sociales y aplicaciones de mensajería.

Hoy en día la tecnología digital afectan en gran magnitud a los lectores de Lima Metropolitana y se busca identificar si este cambio tiene relevancia o no, el proyecto serviría para poder analizar qué factores tanto positivos como negativos existen y de esa manera que el lector tenga una mejor perspectiva, para que de esta manera con todos los datos que llegaríamos a obtener ,se podría realizar un informe técnico.

## 3.2 Justificación Practica

Se basa en el hecho de que los usuarios tienen cada vez más acceso a dispositivos móviles y tabletas que les permiten acceder a contenidos digitales desde cualquier lugar y en cualquier momento . Además, la creciente oferta de libros electrónicos y aplicaciones móviles ha llevado a una mayor disponibilidad de contenido en línea, lo que hace que estos formatos sean cada vez más atractivos para los usuarios. Esto ha llevado a cambios en la forma en que las personas interactúan con el contenido.

En definitiva la tecnología digital en los hábitos de lectura radica en su capacidad para ofrecer una experiencia de lectura más accesible, interactiva e inmediata a los usuarios, lo que les permite consumir más contenido en línea y desde dispositivos móviles. Esto hace que la tecnología digital sea altamente relevante para los hábitos de lectura en Lima Metropolitana en el año 2023.

## 4.Objetivos

-Analizar el nivel de influencia de la tecnología digital en los hábitos de lectura en Lima Metropolitana en el 2023.

## 4.1 Objetivos específicos

-Identificar el nivel de influencia de la tecnología digital en Lima Metropolitana en el 2023.

-Evaluar el nivel de hábitos de lectura en Lima Metropolitana en el 2023.

-Conocer la percepción de las personas respecto al nivel de influencia de la tecnología digital en sus hábitos de lectura en Lima Metropolitana 2023.

## 5. Delimitacion de la investigacion

El presente estudio se centra en realizar el análisis del nivel de influencia de la tecnología digital en general referente a los hábitos de lectura en Lima metropolitana , durante el período del año 2023. Esta investigación se desarrolló dentro de la ciudad de Lima,mercados ,calles y centro comerciales. Se excluyeron a las personas que no deseaban participar de la encuesta o que presentaron datos incompletos en el test o menores de edad.

## 6. Proceso de recolección de datos

La información para nuestra base de datos fue recopilada a través de una ecuesta formulada en Google Forms, la cual nos permitio obtener una información de preguntas previamente diseñado la cual eran tomadas por las personas que viven en Lima metropolitana y digerida por Rstudio.Este mecanismo facilito el buen de la informacion de trabajo en tiempo real y más exacta a nuestras variables de estudio.Cabe resaltar que se tomó en cuenta que nuestra población contenga solamente personas que viven en lima metropolitana y que sean mayores de 16 años por delante y que cuenten con acceso a internet o con un dispositvo electronico para poder acceder a al llenado de la encuesta y saber de la influencia de la tecnoligia digital en sus habitos de lectura.

Además , nos aseguramos un alto porcentaje de llenado correcto por parte de las personas ya que se colocó, en la mayoría de preguntas, respuestas con opciones para marcar y en las que se escribían pusimos ejemplos, siendo esto un factor importante para un buen llenado y de beneficio para nosotros a la hora de hacer la limpieza. Es relevante mencionar que hemos conseguido llegar a una muestra de 178 personas con la estrategia de visitar avenidas concurridas ,mercados, y personas sentadas en parques compartiendo el enlace de la encuesta. De la misma manera, hicimos la petición a familiares para que lo compartan con sus groups de WhatsApp de estudio y trabajo pidiéndoles que realicen la encuesta. Finalmente, en cada petición de llenado se hizo el pedido de un llenado limpio y veraz.

1.  Creación de un formulario mediante el uso de Google Forms (<https://docs.google.com/forms/d/e/1FAIpQLSeW11BR0HeOhGwoDW_vagB6YAIx2S6TYqS7B0X4G3LJt8MO8A/viewform>) con preguntas definidas de acuerdo al objetivo del estudio.\n
2.  La difusión del cuestionario fue de manera presencial en Lima Metropolitana.

## Población, muestra y muestreo

En la elaboración de este estdudio hemos decidido trabajar con la población de \*Lima metropolitana año 2023, siendo la unidad muestral cada persona que vive en la ciudad. Asimismo, el tamaño de nuestra muestra es de **178 individuos, de los cuales hemos recolectado sus datos e información acerca de nuestro tema elegido, mediante una encuesta de Google Forms. Finalmente, nuestro** muestreo\* es *por conveniencia*, debido a que hemos recaudado información de manera directa a alas personas que se encontraban comprando,trancitando las calles de la ciudad de la muestra de la población y ellos decidían si dar o no la encuesta, para así fomentar la representatividad con información veraz.

## 7. Identificación de variables

-   Nivel de influencia.
-   Es el nivel en que afectó la era digital a sus hábitos relacionados a la lectura tradicional.
-   Cantidad de libros leídos al mes.
-   Número de libros que la persona tiene costumbre de leer por mes generalmente.
-   Preferencia al medio físico - digital.
-   Grado de relevancia al elegir un medio de lectura por su comodidad, estilo o practicidad.
-   Profesión - Trabajo.
-   Labor que desempeña en el mundo laboral ya sea formal o informalmente.
-   Sexo.
-   Grupo de características físicas, biológicas, fisiológicas y anatómicas que determinan a un ser humano si es hombre o mujer.
-   Edad.
-   Cantidad de años cumplidos desde su nacimiento.

# CLASIFICACIÓN DE VARIABLES:

+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Escala de medición | Variable                                               | Tipo de variable      | Indicadores                                                                                            |
+:==================:+:======================================================:+:=====================:+:======================================================================================================:+
| Discreta           | Edad                                                   | Cuantitativa Discreta | Edad en años                                                                                           |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Politómica         | Nivel de influencia                                    | Cualitativa Ordinal   | No influyó= 1 poco=2 regular=3 mucho= 4                                                                |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        |                       | demasiado = 5                                                                                          |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Cantidad de libros leídos al mes                       | Cuantitativa Discreta | Cantidad específica                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Preferencia al medio Impreso-digital(Online o Impreso) | Cualitativa           | Impreso = 0 Digital = 1                                                                                |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        | Nominal               |                                                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Ocupación                                              | Cualitativa           | Estudiante universitario = 0 Trabajador de construcción = 1 Empleado = 2 Comerciante = 3 Bachiller = 1 |
|                    |                                                        |                       |                                                                                                        |
|                    |                                                        | Nominal               |                                                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómica         | Sexo                                                   | Cualitativa nominal   | Masculino= 0 Femenino= 1                                                                               |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Edad                                                   | Cuantitativa Discreta | Edad en años                                                                                           |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Numérica           | Gasto en compra de libros online/Impreso               | Cuantitativa continua | Cantidad en soles                                                                                      |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Tecnologías digitales                                  | Cualitativa Ordinal   | influye en el tiempo                                                                                   |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Dicotómicas        | Motivación de lectura                                  | Cualitativa nominal   | motivos específicos                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Tipo de trama en los libros                            | Cualitativa nominal   | No puede ser medida con números                                                                        |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Discreta           | Objetos de entretenimiento                             | Cualitativa Nominal   | Cantidad específica                                                                                    |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+
| Numérica           | Costo del libro online/impreso                         | Cuantitativa continua | Cantidad en soles                                                                                      |
+--------------------+--------------------------------------------------------+-----------------------+--------------------------------------------------------------------------------------------------------+

## Limpieza de Datos

```{r}
library(readr)
```

Nos permitira leer y cargar datos para su posterior analisis estadistico de nuestros varidad formatos.

```{r}
DF <- read_csv("EC23.csv")
```

Es uno de los primeros pasos clave en el análisis de datos y la estadística de nuestra muestra.

```{r}
spec(DF)
```

```{r}
names(DF)  # names devuelve el nombre de las variables del DataFrame
```

Es útil para conocer los nombres de las variables y para seleccionar las variables relevantes de nuestro conjunto de datos la cual nos permite el análisis y la visualización de datos estadísticamente.

```{r}
library(dplyr)
```

Con la función "select" sacaremos de nuestro \_dataframe\_ las primeras 2 variables porque son irrelevantes para nuestro estudio y se creará un subconjunto con 24 variables y será nuestro nuevo \`DF\`.

```{r}
select(DF, 3:26) -> DF
```

Cambiamos el nombre de las variables.

```{r}
DF %>% rename (Edad = `Qué edad tienes ? (Responde en años)`,Sexo=Sexo,Ocupación=Ocupación, Distraccion = `PREGUNTA 1:  Cuando tienes 15 minutos de tiempo libre o más y necesitas desestresarte ¿Qué objetos llevas contigo?`,Celular=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Celular]`,Laptop=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Laptop]`, Libro=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Biblioteca o Libro]`,Television=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Televisión]`,Videojuegos=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Videojuegos]`,Ebooks=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [E-books (Libros en internet)]`,Internet=`PREGUNTA 2: Cuantas veces al mes has utilizado:  [Internet]`, TD=`PREGUNTA 3: ¿Cuál es la tecnología digital que utilizas más en tu vida diaria?`,Lecturalibre =`PREGUNTA 4: ¿Acostumbras leer en tu tiempo libre?`,Lxsemana=`PREGUNTA 5. ¿Cuántas veces a la semana lees?`,Trama=`PREGUNTA 6. ¿Qué tipo trama en los libros te agrada?`,Motivacion=`PREGUNTA 7. ¿Cuál es el motivo principal por que lees?`,Online=`Online`,Impreso=`Impreso`,Lxmes=`PREGUNTA 9:  ¿Cuántos libros lees aproximadamente al mes?`,hrsem=`PREGUNTA 10:  ¿Cuántas horas a la semana le dedicas a la lectura, aproximadamente?`,Máximo=`Máximo`,Mínimo=`Mínimo`,CsUL=`PREGUNTA 12: ¿Cuánto te costó el último libro online o impreso que adquiriste, en soles? (Responda con un punto si el precio es número no entero, ej: 37.8 o 40.1 )`,InfluenciaTD=`PREGUNTA 13:   De una escala del 1 al 5 como influye la tecnología digital en tu vida con respecto a tus hábitos de lectura (1 es negativamente y 5 es positivamente)\n`)-> DFN
```

```{r}
DFN
```

Para saber cuántas observaciones o unidades muestrales se tienen, se puede usar la siguiente función.

```{r}
nrow(DFN)
```

Para saber cuántas columnas o variables tiene la base de datos.

```{r}
ncol(DFN)   # indica el número de variables que tiene la data  
```

La función dim vevuelve dos valores, el primero el números de filas (observaciones) y el segundo el número de columnas (variables) de la base de datos.

```{r}
dim(DFN)
```

Para acceder al valor que tiene una posición particular en la data.

```{r}
DFN[3,6]  # devuelve el valor que tiene el DataFrame en la posición (3,6)
```

Para saber cúantos datos faltantes (NA's) tiene el Dataframe:

```{r}
sum(is.na(DFN))
```

Si quisiéramos ver la cantidad de datos faltantes que hay y la cantidad de datos no faltantes que hay puedo usar la función table. Table da un resumen de los valores que toma is.na y cuánta cantidad hay de cada tipo.

```{r}
table(is.na(DFN))
```

```{r}
table(DFN$Sexo)
```

Para saber cuántas observaciones completas tiene la data.

```{r}
sum(complete.cases(DFN))
```

Hacemos el registro de los datos que tenemos hasta ahora con \`summary\`

```{r}
summary(DFN)
```

Para empezar la limpieza, identificamos los datos vacíos o NA por columna **(Justificación)**

```{r}
summarise_all(DFN, funs(sum(is.na(.))))
```

Eliminamos las filas con valores nulos

```{r}
DFN <- na.omit(DFN)
```

Hacemos la verificación de los datos completos

```{r}
sum(is.na(DFN))
```

Hagamos un resumen de observaciones completas e incompletas.

```{r}
table(complete.cases(DFN))
```

**LIMPIEZA**

Limpiamos la variable Edad

```{r}
summary(DFN$Edad)
unique(DFN$Edad)
DFN$Edad[DFN$Edad == "-"] <- NA
DFN$Edad <- strtoi(DFN$Edad)
summary(DFN$Edad)
```

**Datos Atípicos**

En al variable Lxmes deberían ser todos los valores enteros, pero no lo son

```{r}
is.integer(DFN$Lxmes)
```

Limpiamos Lxmes

```{r}
DFN %>% mutate(Lxmes =
         ifelse(Lxmes == 0.5,round(0.5,0), # round redondea al entero más cercano a 0.5 (el primer argumento es el número a redondear y el segundo la cantidad de dígitos decimales)
            Lxmes)) -> DFN
DFN$Lxmes <- strtoi(DFN$Lxmes) # convierte strings a enteros
summary(DFN$Lxmes)
```

Escalas de 1 a 5, por datos categóricos

```{r}
DFN %>% mutate(Online =
         ifelse(Online == 1,"Muy bajo",
         ifelse(Online == 2,"Bajo",
         ifelse(Online == 3,"Neutral",
         ifelse(Online == 4,"Alto",
         ifelse(Online == 5,"Muy alto",
            Online)))))) -> DFN
```

con este vector de la variable Online se obetendra valores del 1 al 5 cuyo valores se cubren en 5 categorías: "Muy bajo", "Bajo", "Neutral", "Alto" y "Muy alto". Por lo tanto, se utiliza una serie de condiciones ifelse anidadas para asignar los valores a cada categoría en función del valor de la variable Online. Es decir nos permirira conocer a detalle y ordenado la preferencia de las personas encuestadas, si prefieren oline y su determinado punto de uso al momento de efectuar su lectura.

```{r}
DFN %>% mutate(Impreso =
         ifelse(Impreso == 1,"Muy bajo",
         ifelse(Impreso == 2,"Bajo",
         ifelse(Impreso == 3,"Neutral",
         ifelse(Impreso == 4,"Alto",
         ifelse(Impreso == 5,"Muy alto",
            Impreso)))))) -> DFN
```

```{r}
DFN %>% mutate(InfluenciaTD =
         ifelse(InfluenciaTD == 1,"Muy baja",
         ifelse(InfluenciaTD == 2,"Baja",
         ifelse(InfluenciaTD == 3,"Neutral",
         ifelse(InfluenciaTD == 4,"Alta",
         ifelse(InfluenciaTD == 5,"Muy alta",
            InfluenciaTD)))))) -> DFN
```

La sintaxis que se muestra en este código se está utilizando para cambiar el tipo de dato de algunas variables en un conjunto de datos denominado "DFN". Por ejemplo, se utiliza la función "as.character()" para cambiar el tipo de dato de las variables "Sexo", "Ocupación", "Distracción", "Celular", "Laptop,"Libro", "Television", "Videojuegos", "Ebooks", "Internet", "TD", "Lecturalibre", "Trama", "Motivación" e "InfluenciaTD" a tipo de dato de texto o caracter.

Se utiliza la función "as.integer()" para cambiar el tipo de dato de la variable "Edad" a un tipo numérico entero. Además, se utiliza la función "as.numeric()" para cambiar el tipo de dato de las variables "Máximo", "Mínimo" y "CsUL" a tipo numérico decimal.En nuestra base de datos, en la parte de las variables de Maximo y Minimo, por simple lógica; los datos de máximo deberían ser mayores que lo mínimos, sin embargo eso no se cumple como se puede apreciar con las siguientes funciones.

```{r}
max(DFN$Máximo)
max(DFN$Mínimo)
```

La línea de código que se muestra devuelve el valor máximo de las variables "Máximo" y "Mínimo" en el conjunto de datos "DFN". Según la información proporcionada en la búsqueda, se sabe que el valor máximo para "Máximo" es de 400 y el valor máximo para "Mínimo" es de 5050. lo cual no tiene sentido, aplicamos un filtro para identificar esas filas.Desde una perspectiva estadística, la interpretación de estos valores sugiere que los valores máximo y mínimo son bastante diferentes entre sí, lo que puede indicar la presencia de valores atípicos o una amplia variabilidad en los datos. Además, el rango entre los valores mínimo y máximo son importante en la medida en que estos límites extremos del conjunto de datos pueden afectar la interpretación de los resultados y las conclusiones que se pueden obtener a partir del análisis.

{r} DFN$$DFN\$Mínimo\>400,$$

Y las eliminamos de \`DFN\` generando subconjuntos con los datos limpios

```{r}
DFN2 <- DFN[DFN$Mínimo!=1040,]
```

```{r}
DFN3 <- DFN2[DFN2$Mínimo!=5050,]
```

Agregaremos una nueva varible a nuestro estudio, la cual consiste en el promedio de gastos en libros (entre el máximo y el mínimo precio)

```{r}
Data_Final <- mutate(DFN3, PromedioGs = ((DFN3$Máximo + DFN3$Mínimo)/2))
```

## **Descriptores numéricos**

**6.1 Análisis de la edad**

Con la función summary() bamos a identificar y a obtener estadísticas descriptivas como la media, la mediana, la desviación estándar y los cuartiles para cada una de nuestras variable solicitadas dentro de nuestro estudio.La cual nos permtira encontrar la moda y con la moda sabremos cual es la tendencia central del valor de la frecuencia de nuestro conjunto de datos observados .

```{r}
summary(Data_Final$Edad)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$Edad)
```

<font size="3"> Moda </font>}

```{r}
ModaCreada <- function(x) {
  DatosSinNulos <- na.omit(unique(x))
  tabulado <- tabulate(match(x, DatosSinNulos))
  DatosSinNulos[tabulado == max(tabulado) ]
}
ModaCreada(Data_Final$Edad)
```

Podemos observar que la moda de esta distribución es "18 años", ya que es el valor que se presenta con mayor frecuencia en el conjunto de datos . De esta manera, podemos interpretar la moda como la opción más popular entre las personas encuestadas en este estudio estadístico.

<font size="3"> **6.2 Análisis de la cantidad de libros leídos por mes** </font>

Con la función summary podemos obtener la mediana y media con los rangos intercuartiles de la variable solicitada (análisis de la variable por mes)

```{r}
summary(Data_Final$Lxmes)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$Lxmes)
```

<font size="3"> Moda </font>

```{r}
ModaCreada(Data_Final$Lxmes)
```

De nuestra base de datos, las personas leen un libro al mes

<font size="3"> **6.3 Análisis de la cantidad de horas a la semana de lectura** </font>

Con la función summary() podemos obtener conversión del tipo de datos ,la mediana y media con los rangos intercuartiles de la variable solicitada por estudio.

```{r}
summary(Data_Final$hrsem)
```

<font size="3"> Desviación estándar </font>

```{r}
sd(Data_Final$hrsem)
```

<font size="3"> Moda </font>

```{r}
ModaCreada(Data_Final$hrsem)
```

En nuestra base de datos, las personas leen 2 horas a la semana.

PRUEBA DE DESCRIPTOR GRAFICO.\

VARIABLES Y SUS TIPOS

```{r}
# Iterar a través de los nombres de las variables
nombres_variables <- colnames(Data_Final)

# Iterar a través de los nombres de las variables
for (var in nombres_variables) {
  tipo <- class(Data_Final[[var]])
  mensaje <- paste(var, "es de tipo", tipo)
  print(mensaje)
}
```

```{r}

# Obtener la lista única de edades y ordenarlas
edades_unicas <- sort(unique(Data_Final$Edad))

# Filtrar las edades dentro del rango de 12 a 20
edades_filtradas <- edades_unicas[edades_unicas >= 12 & edades_unicas <= 20]

# Crear un vector de alturas para el gráfico
alturas <- rep(NA, length(edades_filtradas))

# Calcular las diferencias de precios y asignarlas a las alturas correspondientes
for (i in 1:length(edades_filtradas)) {
  edad <- edades_filtradas[i]
  alturas[i] <- max(Data_Final$Máximo[Data_Final$Edad == edad]) - min(Data_Final$Mínimo[Data_Final$Edad == edad])
}

# Reemplazar la variable "Edad" en el último descriptor gráfico
barplot(height = alturas, names.arg = edades_filtradas,
        col = "steelblue",
        xlab = "Edad", ylab = "Diferencia de precios",
        main = "Diferencia de precios de libros entre la edad de 12 y 20 años")

legend("topright", legend = c("Diferencia"), fill = "steelblue")


#Promedio de gasto
#Gasto máximo

#boxplot indexado por edad 

#cut() 5 partes iguales 

```

\

La justificación se basa en el análisis de la frecuencia de las variables representadas en el gráfico. Los resultados revelan que los jóvenes de 17 años son los que muestran un mayor gasto en la compra de libros, aproximadamente 400 soles al mes para adquirir su libro preferido. Les siguen los jóvenes de 18 años en términos de gasto, mientras que se puede concluir que los adolescentes de 14 años gastan menos de 100 soles. Esto se atribuye a su dependencia económica de sus padres, lo que limita su capacidad de gasto. Por otro lado, es posible que los jóvenes de 17 años dispongan de ingresos adicionales aparte de la asignación que reciben de sus padres, lo que explicaría su mayor capacidad de gasto.

```{r}
# Cargar las bibliotecas necesarias
library(dplyr)
library(ggplot2)

# Asignar valores a cada frecuencia
valores_frecuencia <- c( "Nunca" = 1, "Una vez al mes" = 2, "Casi nunca al mes" = 3,"Muchas veces al mes" = 4, "Casi siempre" = 5)


# Convertir las variables a factores y establecer el orden deseado
Data_Final$Celular <- factor(Data_Final$Celular, levels = names(valores_frecuencia))
Data_Final$Laptop <- factor(Data_Final$Laptop, levels = names(valores_frecuencia))
Data_Final$Libro <- factor(Data_Final$Libro, levels = names(valores_frecuencia))
Data_Final$Television <- factor(Data_Final$Television, levels = names(valores_frecuencia))
Data_Final$Videojuegos <- factor(Data_Final$Videojuegos, levels = names(valores_frecuencia))
Data_Final$Ebooks <- factor(Data_Final$Ebooks, levels = names(valores_frecuencia))
Data_Final$Internet <- factor(Data_Final$Internet, levels = names(valores_frecuencia))


Data_Final %>% mutate(Celular =
         ifelse(Celular == 1,"Muy baja",
         ifelse(Celular == 2,"Baja",
         ifelse(Celular == 3,"Neutral",
         ifelse(Celular == 4,"Alta",
         ifelse(Celular == 5,"Muy alta",
            Celular)))))) -> Data_Final

# Crear el dataframe de frecuencias y calcular la suma de cada columna
df_frecuencias <- data.frame(
  Categoria = c("Libro", "Videojuegos", "Television", "Ebooks", "Laptop", "Celular", "Internet"),
  Frecuencia = c(
    sum(valores_frecuencia[Data_Final$Libro]),
    sum(valores_frecuencia[Data_Final$Videojuegos]),
    sum(valores_frecuencia[Data_Final$Television]),
    sum(valores_frecuencia[Data_Final$Ebooks]),
    sum(valores_frecuencia[Data_Final$Laptop]),
    sum(valores_frecuencia[Data_Final$Celular]),
    sum(valores_frecuencia[Data_Final$Internet])
  )
)

# Reordenar el dataframe por frecuencia descendente
df_frecuencias <- df_frecuencias %>% arrange(desc(Frecuencia))

# Crear el gráfico de barras con rectángulos en orden descendente
grafico_barras <- ggplot(data = df_frecuencias, aes(x = reorder(Categoria, -Frecuencia), y = Frecuencia, fill = Categoria)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Categoría", y = "Suma de frecuencias", title = "Frecuencia de Uso de Dispositivos") +
  theme_minimal()

# Ajustar el ancho de las barras
grafico_barras <- grafico_barras + theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Asignar posiciones uniformes en el eje Y
posiciones_eje_y <- seq(max(df_frecuencias$Frecuencia), 0, length.out = length(valores_frecuencia))
etiquetas_eje_y <- rev(names(valores_frecuencia))

# Asignar posiciones y etiquetas en el eje Y
grafico_barras <- grafico_barras + scale_y_continuous(breaks = posiciones_eje_y, labels = etiquetas_eje_y, limits = c(0, max(df_frecuencias$Frecuencia)))

# Imprimir el gráfico de barras
print(grafico_barras)



#Cambiar a mosaico

#Reviar la naturaleza de las variables

```

\
Observando la gráfica generada y resuelta, se puede concluir que las personas encuestadas tienden a utilizar más celulares en su tiempo libre. Es importante destacar que la diferencia con respecto al uso de internet es mínima y que, según la muestra, el uso de libros y videojuegos es muy bajo. En resumen, se puede inferir que la influencia de la tecnología digital y la lectura de libros en el tiempo de ocio están casi equilibradas.

```{r}
table(Data_Final$Sexo, Data_Final$InfluenciaTD)

Colores<-{}
Colores["Azul"]<-"lightblue"
Colores["Verde"]<-"lightgreen"
Colores["Gris"]<-"gray"
Colores["Castaño"]<-"chocolate4"
Colores["Negro"]<-"orange"

datos <- matrix(c(5, 10, 15, 20, 25, 30), nrow = 2)
par(las = 1)

mosaicplot(table(Data_Final$Sexo,Data_Final$InfluenciaTD),col=c("chocolate4","darkgray","lightblue","lightgreen","orange","blue"),main="Nivel de hábitos de lectura en Lima Metropolitana en el 2023",
           xlab = "Sexo",
           ylab = "Influencia de las TEC")
            


```

De manera simple el codigo nos permite interpretar la muestra de la variable "nivel de habitos de lectura" de las personas encuestadas en Lima Metropolitana, la cual esta distribuida con categoricas "edad","sexo", nivel y influencia tecnologias digitales las cuales poseen una frecuencia de uso del 1 a 5 las cuales nos dieron un resultado.

#### **Influencia online**

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  sexo = c(Data_Final$Sexo),
  Online = c(Data_Final$Online)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Online, datos$sexo)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Online", y = "Frecuencia", fill = "Sexo") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

De manera simple el codigo nos permite interpretar que son las mujeres las que tienen mayor nivel de influencia que los varones en sus habitos de lectura por parte de las tecnologias digitales.

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  sexo = c(Data_Final$Sexo),
  Impreso = c(Data_Final$Impreso)
)

#Ordenar los datos según el nivel de influencia
datos$Impreso <- factor(datos$Impreso, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Impreso, datos$sexo)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Tradicional", y = "Frecuencia", fill = "Sexo") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

En comparativa con el gráfico anterior podemos notar que pondera que la frecuencia de lectura física o tradicional de parte del sexo femino. Evidentemente, se puede concluir que la preferencia por el sexo femenino a la lectura física que virtual es alta; a diferencia que al sexo masculino.

OBJETIVO 3 (percepción por edad)

```{r}
# Crear un data frame de ejemplo con las variables Online y Edad
datos <- data.frame(
  Online = c(Data_Final$Online),
  Edad = c(Data_Final$Edad)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Crear el gráfico de cajas y bigotes
ggplot(datos, aes(x = Online, y = Edad)) +
  geom_boxplot(fill = "steelblue", color = "black", outlier.shape = NA) +
  labs(x = "Online", y = "Edad") +
  ggtitle("Relación entre Online y Edad") +
  theme_minimal()

```

De acuerdo a esta gráfica, podemos observar qué en el rango de edad de 20 a 30 prefieren leer de manera online y es una opción neutra. Esto se conlcuye a partir de la media, la cual se puede apreciar por medio de las lineas en medio del boxplot.

```{r}
# Cargar la biblioteca ggplot2 si aún no está cargada
library(ggplot2)

# Crear un data frame de ejemplo con las variables Online y Edad
datos <- data.frame(
  Online = c(Data_Final$Online),
  Edad = c(Data_Final$Edad)
)


datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Crear el gráfico de puntos con el eje Y limitado a valores entre 10 y 40
ggplot(datos, aes(x = Online, y = Edad)) +
  geom_point(color = "steelblue", size = 1.4) +  # Estilo de los puntos
  labs(x = "Online", y = "Edad") +
  ggtitle("Relación entre Edad y Online") +
  theme_minimal() +
  coord_cartesian(ylim = c(10, 40)) +
  theme(
    plot.title = element_text(size = 14, face = "bold"), 
    axis.title = element_text(size = 12, face = "bold"), 
    axis.text = element_text(size = 10),  
    panel.grid.major = element_blank(),  
    panel.grid.minor = element_blank()  
  )


```

### **Gráfico de influencia**

```{r}
# Cargar el paquete 'ggplot2'
if (!require(ggplot2)) {
  install.packages("ggplot2")
  library(ggplot2)
}

# Crear un data frame de ejemplo con las variables sexo y Online
datos <- data.frame(
  Lecturalibre = c(Data_Final$Lecturalibre),
  Online = c(Data_Final$Online)
)

#Ordenar los datos según el nivel de influencia
datos$Online <- factor(datos$Online, levels = c("Muy bajo", "Bajo", "Neutral", "Alto", "Muy alto"))

# Calcular la tabla de frecuencias cruzadas
tabla <- table(datos$Online, datos$Lecturalibre)

# Convertir la tabla en un data frame
df <- as.data.frame(tabla)

# Crear el gráfico de barras agrupadas
ggplot(df, aes(x = Var1, y = Freq, fill = Var2)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Lectura Online", y = "Frecuencia", fill = "Lectura en tiempo libre") +
  ggtitle("Nivel de influencia de la tecnología digital") +
  theme_minimal()

```

Según los resultados de la gráfica se puede interpretar que el nivel de influencia de la tecnología digital en el tiempo libre de las personas de lima metropolitana es a veces y es neutral. Es decir tiene una frecuencia de 33 %, siendo el 20 % que opinan que el uso de la tecnología es muy alto y que si influye en sus hábitos de lectura y están presentes sea por un table, celular o ordenador ya que son los únicos medios por donde pueden acceder a plataformas o contenidos de entretenimiento o información. Cabe recalcar car que hay un 8% que opina que la tecnología digital no influye en sus hábitos de lectura.

+Descripción En conclucion observamos que cada uno de nuestros objetivo cumplen con lo expresado en nuestro estudio de investigacion .Es decir la tecnologia digital esta prente en los habitos de lectura de las personas que viven en Lima metropolitana y que la poblacion que con mas frecuencia hace uso de ese medio somas mujeres que varones y lo hacer por distracion por que les gusta y acceden a ella por medio de instrumentos tecnologicos como laptop ,y celulares y son pocas las personas que ya suelen utilizar libros impresos y son los jovenes los que utilizan mas la opcion onlane .

## **Probalidades Empiricas**

Se sabe que la probabilidad empírica es la relación entre el número de resultados en los que ocurre un evento específico y el número total de intentos la cual ocurre en un evento 'E'. Donde :

\`P(E) = #de resultados E / #total de resultados.

Determinar el espacio de resultados teorico y la funcion de probalidad para los eventos atomicos de manera empirica para dos variables interesantes de trabajo.

### **Identification y definicion de variables**

Variables elegidas e interesantes: Nivel de influencia de la tecnologia digital Y preferencia de lectura de manera impresa.

### **Experimento**

Seleccionar a 1 persona de la una muestra 174 personas para observar el Nivel de influencia de la Tecnologia digital en los habitos de lectura de Lima Metropolitana 2023.

+Evaluamos el nivel de influencia de la tecnologia digital en los habitos de lectura en una escala o rango de 1-5.

Donde: 1: Muy baja 2: Baja 3: Neutral 4: Alta 5: Muy alta

Posibles resultados ,observar su nivel de influencia digital en los habitos de lectura de Lima metropolitana 2023:

***Definicion de eventos atomicos***

```{r}
Data_Final %>% mutate(InfluenciaTD =
      ifelse(InfluenciaTD %in% c("Muy baja"), "1",
      ifelse(InfluenciaTD %in% c("Baja"), "2",
      ifelse(InfluenciaTD %in% c("Neutral"), "3",
      ifelse(InfluenciaTD %in% c("Alta"), "4",
      ifelse(InfluenciaTD %in% c("Muy alta"), "5",InfluenciaTD
            )))))) -> Data_Final
Data_Final %>% count(InfluenciaTD)
```

***Espacio de resultado asociados al experimento*****.**

```{r}
# Variable: InfluenciaTD
# Espacio de resultados teórico
T_minima <- min(Data_Final$InfluenciaTD)
T_maxima <- max(Data_Final$InfluenciaTD)
espacio_resultados_T <- seq(T_minima, T_maxima)
print(espacio_resultados_T)
```

***Identificacion de eventos*****.**

A1: Seleccionar a una persona del presente estudio que tiene una influencia muy baja de las Tecnologia digitales en sus habitos de lectura en Lima metroplolitana 2023 .

A2: Selecciona una persona "X" del estudio que presenta influencia baja de las Tecnologia digitales en sus habitos de lectura en Lima metroplolitana 2023.

A3: Selecciona una persona "X" del estudio que presenta influencia neutral de las Tecnologia digitales en sus habitos de lectura en Lima metroplolitana 2023

A4: Selecciona una persona "X" del estudio que presenta influencia alta de las Tecnologia digitales en sus habitos de lectura en Lima metroplolitana 2023

A5: Selecciona una persona "X" del estudio que presenta influencia muy alta de las Tecnologia digitales en sus habitos de lectura en Lima metroplolitana 2023

#Probabilidad de cada evento atómico \<-- P(A) = F(A)/n.

```{r}
A1 <- round(7/174,2)
A2 <- round(16/174,2)
A3 <- round(56/174,2)
A4 <- round(60/174,2)
A5 <- round(35/174,2)
print(A1)
print(A2)
print(A3)
print(A4)
print(A5)
```

En conclusión: La mayor probabilidad es que el nivel de influencia de tecnologia digital resulta alta en los hábitos de lectura de las personas de Lima Metropolitana del 2023.

# **Experimento**

Experimento 2: Seleccionar a 1 persona de la una muestra 174 personas para observar el la preferencia de las personas por leer de manera impresa en Lima Metropolitana del 2023.

+Evaluamos la preferencia de lectura de manera impresa en los habitos de lectura en una escala o rango de 1-5.

Donde: 1: Muy baja 2: Baja 3: Neutral 4: Alta 5: Muy alta

Posibles resultados ,observar preferencia de lectura de manera impresa en los habitos de lectura de Lima metropolitana 2023:

***Definicion de eventos atómicos***

```{r}
Data_Final %>% mutate(Impreso =
      ifelse(Impreso %in% c("Muy bajo"), "1",
      ifelse(Impreso %in% c("Bajo"), "2",
      ifelse(Impreso %in% c("Neutral"), "3",
      ifelse(Impreso %in% c("Alto"), "4",
      ifelse(Impreso %in% c("Muy alto"), "5",Impreso
            )))))) -> Data_Final
Data_Final %>% count(Impreso)
```

***Espacio de resultado asociados al experimento*****.**

```{r}
A1 <- round(6/174,2)
A2 <- round(22/174,2)
A3 <- round(47/174,2)
A4 <- round(38/174,2)
A5 <- round(61/174,2)
print(A1)
print(A2)
print(A3)
print(A4)
print(A5)
```

*En conclusión:* La mayor probabilidad es que la influencia resulte Muy alta en leer de manera impresa enlos habitos bde lectura de Lima Metropolitana del 2023.

### **Teoria de Probalidades condicionales**

Encontrar dos pares de eventos dependientes y el otro de eventos idependientes en sus datos.

verificar de manera emperica que ocurre en cada caso calculando las probalidades apropiadas.

Variables : Edad y cantidad de libros leidos en su tiempo libre en el estudio de la influencia digital de los habitos de lectura de Lima Metropolitana 2023..

***Definimos los eventos.***

supongamos que una persona varon o mujer lea libros en su tiempo libre valor:"\>=2" y "\<2".

**A**: Seleccionar a una persona que tenga una cantidad de libros de leidos en su tiempo libre sea "\>=2 en el estudio de la influencia digital de los habitos de lectura de Lima Metropolitana 2023.

**B**: Seleccionar a una persona adulto/adulta, en el estudio de la influencia digital de los habitos de lectura de Lima Metropolitana 2023.

Donde :

-   Debemos verificar si cumple que a P(A ∩ B)=P(A)P(B).Si no cumple ,entonces es dependiente por lo cual seria p(A∩B)/P(B).

-   Si es independiente sera p(A/B)=P(A).

# **Validar Independencia**

```{r}
# Número de personas en el estudio
total_personas <- 174

# Evento A: Seleccionar a una persona que tenga una cantidad de libros de leidos en su tiempo libre sea "\>=2
personas_A <- 1

# Evento B: Seleccionar a una persona adulto/adulta en el estudio
personas_B <- 1

# Cálculo de las probabilidades
prob_A <- personas_A / total_personas
prob_B <- personas_B / total_personas
prob_A_interseccion_B <-2 / total_personas

# Verificar si los eventos A y B son independientes o dependientes
if (prob_A_interseccion_B == prob_A * prob_B) {
  cat("Los eventos A y B son independientes\n")
  cat("P(A ∩ B) =", prob_A_interseccion_B, "\n")
  cat("P(A)P(B) =", prob_A * prob_B, "\n")
} else {
  cat("Los eventos A y B son dependientes\n")
  cat("P(A ∩ B)/P(B) =", prob_A_interseccion_B / prob_B, "\n")
}
```

```{r}
# Cantidad de personas con >=2 libros leídos en su tiempo libre
personas_A <- 2

# Cantidad de personas adultas en el estudio
personas_B <- 1

# Cantidad de personas que cumplen ambas condiciones
personas_AyB <- 2

# Calcular la probabilidad condicional P(A/B)
prob_condicional <- personas_AyB / personas_B

# Imprimir el resultado
print(prob_condicional)
```

```{r}
# Número de personas  del total de la muestra del estudio nivel de influencia de tecnologia digital de Lima Metropolitana 2023
total_personas <-174

# Número de personas con >=2 libros leídos en su tiempo libre
personas_A <- 174

# Número de personas adultas en el estudio
personas_B <- 1

# Calcular P(A)
p_A <- personas_A / total_personas

# Calcular P(B)
p_B <- personas_B / total_personas

# Calcular P(B/A)
p_B_dado_A <- 1  # Supongamos que todas las personas que cumplen A son adultas

# Calcular P(A/B) utilizando el teorema de Bayes
p_A_dado_B <- (p_B_dado_A * p_A) / p_B

# Imprimir el resultado
print(p_A_dado_B)
```

### **Esquema de Teorema de Bayes**

![](cd1bebcc-a105-439c-95ab-db7a40ea6927.png)

# Modelos probabilísticos:

Utilizaremos la variable de cuantas veces has utilizado ebooks (libros por internet)

```{r}
barplot(prop.table(table(Data_Final$Ebooks)), main = "Cuantas veces al mes has utilizado E-books", ylab = "Probabilidad",cex.names =0.7, las=1)
```

**Construimos la variable**: Buscaremos perronas que lean "muchas veces al mes" por irternet para ver la influencia que tiene la tecnologia en los habitos de lectura en Lima Metropolotana en el año 2023.

```{r}
l_virtual<- as.factor(Data_Final$Ebooks)
levels(l_virtual)
```

Se observa en nuestra base de datos que 75 personas leen libros por internet del total de nuestra base de datos que son 174 Entonces la probabilidad de leer muchas veces al mes es : Probabilidad de leer muchas veces al mes =75/174=0.43

Aplicación #1: Mediante una encuesta a 174 personas de un estudio nivel de influencia digital en los habitos de lectura de Lima Metropolitana 2023, se sabe que los resultados de la encuesta.

Calcular la probabilidad de que 20 personas de 70 prefirieran leer virtualmente: éxito-\> personas que asistan de manera presencialmente: 0.4320388fracaso-\> personas que prefieran leer híbrido o virtual: 0.2038835+0.3640777 variable aleatoria--\> Numero de personas que prefieren leer de forma presencial. $P(X = 20)$ -\> valor único se llama función de masa "d" dbimon (número de éxitos, tamaño y probabilidad de éxito)

```{r}
dbinom(20,89,0.4320388)

plot(dbinom(c(0:20),89,0.4320388), main = "Probabilidad de asistencia presencial de 20 alumnos",ylab = "Probabilidad") ##distribución de Gauss
```

## **1.-Variables Aleatorias Discretas:**

**1.a.-Definimos que distribucion usaremos**

En un experimento que consiste en realizar "n" ensayos, donde solo son posibles dos resultados: Exito(E) o fracaso (P), estamos interesados en el numero de veces en que un evento puede ocurrir (definido como exito) en una prueba de "n" intentos, conviene utilizar una distribucion binomial. En este caso estamos interesados en estudiar cuantos libros lee aproximadamente una persona al mes.

**1.b.-Construimos la variable aleatoria discreta**

En el estudio acerca de la cantidad de libros que lee aproximadamente una persona al mes deifinimos nuestra variable aleatoria discreta:

X:"Numero de personas que no leen ningun libro al mes en el estudio de las 174 personas encuestadas en Lima Metropolitana"

**1.c.-Identificamos los parametros**

Definida la variable aleatoria discreta, identificamos los parametros a utilizar en nuestra distribucion: X-\>Bin(p,n)

```{r}
#A continuacion mostramos la cantidad de libros que lee aproximadamente una persona al mes
x<-table(DFN$Lxmes)
barplot(x,xlab="# de Libros leidos al mes",ylab="Frecuencia")

#Definimos p: Probabilidad de Exito, donde Exito es la persona que no lee ningun libro al mes
#q=probabilidad de fracaso=1-p
p<-((table(DFN$Lxmes)[1])/nrow(DFN))
paste("p=",p)
paste("q=",1-p)
```

**1.d.-Construimos la densidad**

A continuación, y haciendo uso de la distribucion binomial, construimos una grafica de la funcion de densidad de probabilidad para la variable discreta:

```{r}
x<-0:174
densidad<-dbinom(x,174,0.156424581005587)
plot(x,densidad,type="h",lwd=1,main="Funcion de Densidad de Probabilidad",xlab="Numero de personas que no leen ningun libro al mes",ylab="Probabilidad")
```

**1.e.-Validamos las propiedades**

Dado que conocemos los parametros mas importantes, verificaremos que cumplan las propiedades en una distribucion binomial:

```{r}
#En una distrubucion binomial, la esperanza es =n*p
p<-((table(DFN$Lxmes)[1])/nrow(DFN))
q<-1-p
n=nrow(DFN)
esperanza<-n*p
paste("Esperanza (formula)=",esperanza)
valor<-0:174
esperanza1<-sum(valor*dbinom(valor,n,p))
paste("Esperanza(definicion)=",esperanza1)
paste("Los resultados obtenidos de las esperanzas son iguales")
#En una distribucion binomial, la varianza es=n*q*p
varianza<-n*q*p
paste("Varianza(formula)=",varianza)
varianza1<-sum((valor^2)*dbinom(valor,n,p))-esperanza^2
paste("Varianza(definicion)=",varianza1)
paste("Los resultados obtenidos de las varianzas son muy cercanos, practicamente iguales")
```

**1.f.-Construimos ejemplos**

***EJEMPLO 01:***

En una feria del libro, se realizo una encuesta a un grupo de 200 personas acerca de cuantos libros leen al mes, el motivo de la encuesta es identificar si hay una buena practica de lectura, se desea conocer la probabilidad de que mas del 15% de los encuestados leen por lo menos 1 libro al mes, con el fin de poder incentivar más el habito de lectura. Se sabe que la probabilidad de que una persona no lea algun libro al mes es 0.156424581005587.

```{r}
#Se conoce el tamaño de la muestra
n<-200
#Sea la variable discreta:
#X:numero de personas que no leen ningun libro al mes
#Se desea conocer la probabilidad de que mas de 30 personas lean por lo menos un libro al mes, para ello usemos su complemento: la probabilidad de que a lo mucho 30 personas no leen ningun libro al mes
#Podemos usar una distribucion binomial donde la probabilidad de exito es igual a 0.156424581005587
p<-0.156424581005587
#Por lo tanto hallemos P(X<=30)
valorX<-0:30
probabilidad<-sum(dbinom(valorX,n,p))
paste("La probabilidad de que mas de 30 personas lean por lo menos un libro es: ",1-probabilidad)

```

***EJEMPLO 02:***

En una institucion educativa, debido al dia de libro, se consulto a 1790 estudiantes con que frecuencia leen un libro, si se sabe que la probabilidad de que una persona no lea algun libro al mes es 0.156424581005587, se desea hallar cuantas personas se espera que no hayan leido si quiera algun libro al mes.

```{r}
#El tamaño de la muestra es 200
n=1790
#Sea la variable aleatoria X:numero de personas que no leen ningun libro al mes
#Probabilidad de exito= 0.156424581005587
#Como se trata de una distribucion normal, para hallar el valor esperado podemos usar la formula E=n*p
esperanza<-n*p
paste("El numero esperado de alumnos que no leen ningun libro al mes es: ",esperanza)

```

**2.a.-Definimos que distribucion usaremos**

En una población de "N"elementos , en la que existe 2 clases mutuamente excluyentes: clase Exito(e) y clase Fracaso (f), si la clase exito tiene "k" elementos, entonces la clase fracaso tiene "N-k" elementos. Si tomamos una muestra de tamaño n, de tal manera que nos interesa conocer la la cantidad de elementos de la muestra que estan dentro de la clase exito, nos conviene utilizar una distribucion hipergeometrica. En este caso, deseamos estudiar si la persona promedia prefiere leer en su tiempo libre o hacer otra actividad.

**2.b.-Construimos la variable aleatoria discreta**

Como deseamos conocer acerca de la eleccion de una persona para leer cuando tiene un tiempo libre definimos la variable aleatoria.

X: "cantidad de personas dentro de una muestra que pertenecen a las 174 personas encuestadas en Lima Metropolitana, que acostumbran leer un libro en su tiempo libre"

**2.c.-Identificamos los parametros**

Definida la variable aleatoria discreta, identificamos los parametros a utilizar en nuestra distribucion: X-\>HG(N,k,n)

Donde N: es el tamaño de la poblacion, k: numero de elementos que pertenecen a la clase exito y n: es el tamaño de la muestra. Ademas el exito esta definido como la persona que acostumbra leer en su tiempo libre.

```{r}
N<-nrow(DFN)
paste("El tamaño de la polacion es: ",N)
#Presentamos la cantidad de  personas que prefieren medio digital o fisico para leer
x<-table(DFN$Lecturalibre)
barplot(x,xlab="Reapuesta",ylab="Frecuencia")
k<-table(DFN$Lecturalibre)[3]
paste("Cantidad de personas que pertenecen a la clase exito",k)

```

**2.d.-Construimos la densidad**

A continuación, y haciendo uso de la distribucion hipergeometrica, construimos una grafica de la funcion de densidad de probabilidad para la variable discreta:

```{r}
#Escogemos una muestra de 80 personas:
n=80
N=174
k=70
x<-0:80
densidad<-dhyper(x,k,N-k,n)
plot(x,densidad,type="h",lwd=1,main="Funcion de Densidad de Probabilidad",xlab="Numero de personas que acostumbran leer en su tiempo libre",ylab="Probabilidad")
```

**2.e.-Validamos las propiedades**

Dado que conocemos los parametros mas importantes, verificaremos que cumplan las propiedades en una distribucion binomial:

```{r}
#En una distrubucion hipergeometrica, la esperanza es =n*(k/N)
n<-80
k<-table(DFN$Lecturalibre)[3]
N<-nrow(DFN)
esperanza<-n*(k/N)
paste("Esperanza (formula)=",esperanza)
valor<-0:80
esperanza1<-sum(valor*dhyper(valor,k,N-k,n))
paste("Esperanza(definicion)=",esperanza1)
paste("Los resultados obtenidos de las esperanzas son iguales")
#En una distribucion binomial, la varianza es=(n)*(k/N)*(1-(k/N))*((N-n)/N-1)
varianza<-(n)*(k/N)*(1-(k/N))*((N-n)/(N-1))
paste("Varianza(formula)=",varianza)
varianza1<-sum((valor^2)*dhyper(valor,k,N-k,n))-esperanza^2
paste("Varianza(definicion)=",varianza1)
paste("Los resultados obtenidos de las varianzas son muy cercanos, practicamente iguales")

```

**2.f.-Construimos ejemplos**

***EJEMPLO 1:***

Luego de una breve encuesta realizada en Lima metropolitana, de un total de 174 personas encuestadas se sabe que solo 70 leen con frecuencia en sus tiempos libres, y el resto lo hace a menudo o prefiere hacer otras actividades. Si elegimos 80 personas al azar, nos interesa conocer la probabilidad de que menos de 30 personas acostumbren leer en su tiempo libre.

```{r}
#Numero de poblacion
N<-174
#Numero de personas de la poblacion que acostumbra leer en su tiempo libre
k<-70
#Tamaño de la muestra
n<-80
#Definimos nuestra variable aleatoria
#X:numero de personas de las 80 elegidas al azar que acostumbran leer en su tiempo libre
#Como deseamos hallamos la la probabilidad de que menos de 30 personas acostumbren leer en su tiempo libre, usamos una distribucion hipergeometrica, y hallamos P(X<=30)
x<-.0:30
probabilidad=sum(dhyper(x,k,N-k,n))
paste("la probabilidad de que menos de 30 personas acostumbren leer en su tiempo libre es: ",probabilidad)
```

***EJEMPLO 2:***

Luego de realizar la encuesta a las 174 personas sobre si prefieren leer o hacer otra actividad en sus tiempos libres, donde se obtuvo que 70 leen con frecuencia en sus tiempos libres, se escogio 80 personas al azar, y se desea saber el numero de personas esperado que prefieren leer un libro en su tiempo libre.

```{r}
#Numero de poblacion
N<-174
#Numero de personas de la poblacion que acostumbra leer en su tiempo libre
k<-70
#Tamaño de la muestra
n<-80
#Con los datos brindados, podemos hacer una distribucion hipergeometrica
#Como se desea hallar el valor esperado dentro de la muestra, podemos usar la expresion conocida
#Esperanza es =n*(k/N)
esperanza<-n*(k/N)
paste("El numero de personas esperado que prefieren leer en su tiempo libre es: ",esperanza)

```

## **3.Variables Aleatorias Continuas:**

### **3.a Análisis de variables continuas**

El objetivo de este análisis es identificar todas las POSIBLES variables continuas presentes en una tabla de datos. Las variables continuas son aquellas que pueden tomar un rango infinito de valores dentro de un intervalo específico, y su identificación es fundamental para aplicar análisis estadísticos adecuados.

```{r}
# Código para identificar variables continuas
columnas <- names(Data_Final)
variables_numericas <- c()

for (columna in columnas) {
  if (is.numeric(Data_Final[[columna]])) {
    variables_numericas <- c(variables_numericas, columna)
  }
}

variables_continuas <- c()

for (variable in variables_numericas) {
  valores_unicos <- unique(Data_Final[[variable]])
  diferencia_valores <- max(valores_unicos) - min(valores_unicos)
  if (length(valores_unicos) > 10 && diferencia_valores > 0) {
    variables_continuas <- c(variables_continuas, variable)
  }
}
print("Las variables continuas son las siguientes: ")
print(variables_continuas)

```

**Variable Edad**

```{r}
# Generar una variable aleatoria continua de 174 observaciones con una distribución normal
variable_aleatoria <- rnorm(Data_Final$Edad, mean = 10, sd = 2)

# Gráfico de histograma de la variable aleatoria
hist(variable_aleatoria, breaks = 25, col = "pink", main = "Histograma", xlab = "Edad", ylab = "Frecuencia")

# Gráfico de densidad de la variable aleatoria
plot(density(variable_aleatoria), col = "red", main = "Gráfico de densidad",xlab = "Edad", ylab = "Densidad")

```

Para la variable Edad se rechazan ambos modelos, por lo que podemos decir que no podria ser una variable continua.

**Variable hrsem**

```{r}
# Generar una variable aleatoria continua de 174 observaciones con una distribución normal
variable_aleatoria <- rnorm(Data_Final$hrsem, mean = 10, sd = 2)

# Gráfico de histograma de la variable aleatoria
hist(variable_aleatoria, breaks = 25, col = "pink", main = "Histograma", xlab = "Horas de lectura por semana", ylab = "Frecuencia")

# Gráfico de densidad de la variable aleatoria
plot(density(variable_aleatoria), col = "red", main = "Gráfico de densidad",xlab = "Horas de lectura por semana", ylab = "Densidad")

```

Para la variable hrsem, la cual representa la cantidad de horas leidas por semana, se rechazan ambos modelos, por lo que podemos decir que no podria ser una variable continua.

**Variable CsUL**

```{r}
# Generar una variable aleatoria continua de 174 observaciones con una distribución normal
variable_aleatoria <- rnorm(Data_Final$CsUL, mean = 10, sd = 2)

# Gráfico de histograma de la variable aleatoria
hist(variable_aleatoria, breaks = 25, col = "pink", main = "Histograma", xlab = "Horas de lectura por semana", ylab = "Frecuencia")

# Gráfico de densidad de la variable aleatoria
plot(density(variable_aleatoria), col = "red", main = "Gráfico de densidad",xlab = "Horas de lectura por semana", ylab = "Densidad")

```

Para la variable CsUL, la cual representa la cantidad de soles que gasta una persona para acceder a una lectura por medio digital o fisico, en la mayoria de los casos probados cumple con los requerimientos de los modelos para poder ser una variable continua.

**3.b Funcion de Densidad de Probabilidad de una Distribucion Continua**

Ubicada la variable continua CsUL, realizamos la funcion de densidad de probabilidad.

```{r}
media<-mean(DFN$CsUL)
varianza<-var(DFN$CsUL)
x<-seq(-3000,3000,5)
densidad<-dnorm(x,media,varianza)
plot(x,densidad,type="l",main="Funcion de Densidad de Probabilidad",col=3,lwd=3,xlab="Precio en soles",ylab="Probabilidad",xlim=c(-3000,3000),ylim=c(0,0.0003))
```

#### **3.c Validar la Normal de nuestra variable aleatoria**

Se sabe que una variable aleatoria normal se define por:

![](images/Captura495-01.PNG)

Donde nuestra variable cantidad de soles que gasta una persona para acceder a una lectura por medio digital o fisico tendra una curva de la distribución normal de campana simétrica alrededor de la media μ, lo que indica que la mayoría de los valores de la variable aleatoria se encuentran cerca de la media.

Y que su desviación estándar indicara la amplitud de la campana, siendo los valores más altos más anchos y los valores más bajos más estrechos.

```{r}
# Realizar la prueba de Shapiro-Wilk en "Ldxm"
shapiro_test <- shapiro.test(Data_Final$CsUL)

print("Resultado de la prueba de Shapiro-Wilk:")
print(shapiro_test)

# Verificar si la variable "Ldxm" sigue una distribución normal
if (shapiro_test$p.value >= 0.05) {
  print("La variable Ldxm sigue una distribución normal.")
} else {
  print("La variable Ldxm no sigue una distribución normal.")
}

```

Como podemos ver del resultado obtenido, el valor obtenido es menor a 0.05 por lo que no sigue una distribución normal.

**3.d Validar la Normal de nuestra media y mediana**

La prueba de Bartlett es una técnica estadística utilizada para verificar si un conjunto de muestras es de poblaciones que tienen varianzas iguales

Por sus propiedades aproximadamente.

```{r}
# Realizar la prueba de Bartlett:
bartlett.test(Data_Final$CsUL, Data_Final$Sexo)

# Si el p-value es mayor a 0.05, se acepta la hipótesis nula (la distribución tiene varianzas iguales)
# Si el p-value es menor a 0.05, se rechaza la hipótesis nula (la distribución tiene varianzas desiguales)

```

Como podemos ver del resultado obtenido, el valor obtenido es menor a 0.05 por lo que la distribución tiene varianzas desiguales.

**3.e Validamos la distribucion continua de nuestra variable**

```{r}
#Hallamos la media
varianza=var(DFN$CsUL)
varianza
media=mean(DFN$CsUL)
media
mediana=median(DFN$CsUL)
paste("Elvalor de la media es: ",media)
paste("El valor de la mediana es: ",mediana)
paste("La media y la mediana son valores cercanos")
x<--10000:10000
esperanza<-sum(x*dnorm(x,media,varianza))
paste("El valor de la esperanza es: ",esperanza)
paste("La media y la esperanza son muy cercanos")
varianza1<-(sum((x^2)*dnorm(x,media,varianza))-esperanza^2)^(0.5)
paste("El valor de la varianza es: ",varianza)
paste("El valor de la varianza de la base de datos es: ",varianza1)
paste("El valor de la varianza y la varianza de la base de datos son muy cercanos")
```

## **3.f Ejemplos probabilísticos**

***Ejemplo 1***: ¿Cuál es la probabilidad de que un valor de CsUL seleccionado al azar sea mayor a 50?

```{r}
media <- mean(Data_Final$CsUL)
varianza <- var(Data_Final$CsUL)

probabilidad_mayor_50 <- 1 - pnorm(50, media, sqrt(varianza))
probabilidad_mayor_50

```

***Ejemplo 2***: ¿Cuál es la probabilidad de que un valor de CsUL seleccionado al azar esté entre 30 y 70?

```{r}
probabilidad_entre_30_y_70 <- pnorm(70, media, sqrt(varianza)) - pnorm(30, media, sqrt(varianza))
probabilidad_entre_30_y_70


```

***Ejemplo 3***: ¿Cuál es la probabilidad de que un valor de CsUL seleccionado al azar sea menor o igual a 40?

```{r}
media <- mean(Data_Final$CsUL)
varianza <- var(Data_Final$CsUL)

probabilidad_menor_igual_40 <- pnorm(40, media, sqrt(varianza))
probabilidad_menor_igual_40


```

## **Conclusiones:**

-   Se evidencia que si hay tendencia a leer un libro en una persona sea mujer o varón a pesar de la influencia digital en los hábitos de lectura de Lima metropolitana 2023.

-   Las personas leen por motivación sea por el trabajo o por diversión y son mas la persona jovenes de entre 17 -18 años quienes practican mas este habito. +Las herramientas que utilizan con mas frecuencias son los celulares seguidos de laptos.

-   De acuerdo al estudio estadístico se observo que son del sexo femenino las que mas participan de la lectura atraves de libros físicos esto se debe a que leen por motivación,diversion ,estudio y trabajo.

-   La estadística permite hacer predicciones, por lo que se puede tomar nuestro estudio como punto de partida para poder generalizar resultados y verificar si realmente el nivel de influencia de la tecnología digital de Lima metropolitana influye en el rendimiento de sus hábitos de lectura. De esta forma, se pueden tomar medidas que permitan regularizar y saber si esto impacta positivamente o negativamente y tengan mejores resultados

## Bibliografía

-Jin Lee, D. (Ed.). (2019c). Modelos lineales y análisis de la varianza. En Curso de formación en R (capitulo 6 ed., pp. 6--6-7). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/modelos-lineales-y-analisis-de-la-varianza.html>

-Uso básico de Rstudio (2019 ) .Para la estadística descriptiva en ciencia sociales ( capitulo 4) <https://bookdown.org/gboccardo/manual-ED-UCH/uso-basico-de-rstudio.html#manejo-basico-de-la-sintaxis-de-r-creacion-de-objetos-inclusion-de-anotaciones-y-definicion-de-secciones>

Introducción al software estadístico R. (2019). En Curso de formacion en R (capitulo 2 ). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/intro.html>

-Introducción a la programación básica con R. (2019). En Cursos de formación en R (capitulo 4). GNU-GPL. <https://idaejin.github.io/courses/R/2019/euskaltel/introduccion-a-la-programacion-basica-con-r.html>
