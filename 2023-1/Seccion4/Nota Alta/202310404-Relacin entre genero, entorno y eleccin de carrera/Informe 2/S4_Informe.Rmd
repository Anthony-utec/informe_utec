---
title: "S4 “Relación entre género, entorno y elección de carrera de los estudiantes de ingeniería y ciencias de la universidad  UTEC.”"
date: "`r Sys.Date()`"
output:  
  html_document:
    number_sections: true
    toc: true
    toc_float: true
    df_print: paged

---


# Introducción

## Objetivo general:

-Analizar la relación entre el género, entorno y elección de carrera de los estudiantes de ingeniería y ciencias en UTEC.

## Objetivos:
- Identificar las carreras de ingeniería con mayor presencia femenina y masculina.
- Determinar los factores que influyen en la elección de carrera de los estudiantes de ingeniería, según su género.
- Buscar un patrón en la relación entre la elección de carrera y el rendimiento académico de los estudiantes de ingeniería, según su género.
- Identificar las principales barreras que los estudiantes perciben para el acceso y permanencia de los estudiantes en carreras de ingeniería.
- Analizar las causas que influyen en la elección de carrera en relación con su género y su entorno.
- Analizar el porcentaje de alumnos que consideran cambiar de carrera


Delimitados: Alumnos que han superado los cursos de primer ciclo de universidad

## Relevancia: 

Nuestro proyecto aborda la relación entre género, entorno y elección de carrera en estudiantes de ingeniería y ciencias en la Universidad UTEC. Comprender cómo estos factores influyen en la elección de carrera es fundamental para promover la equidad de género y la diversidad en estas áreas. Además, la elección de carrera es una decisión importante que afecta la vida de los estudiantes a largo plazo, y los resultados del proyecto pueden ayudar a la universidad a mejorar la experiencia educativa.

## Contexto:

Este estudio se lleva a cabo en la Universidad de Ingeniería y Tecnología (UTEC) para examinar cómo el género y el entorno pueden influir en la elección de carrera de los estudiantes de ingeniería y ciencias. Se basa en investigaciones previas que indican que estos factores pueden jugar un papel importante en la elección de carrera, pero se enfoca específicamente en el contexto de UTEC para llenar un vacío en el entendimiento actual.


## Variables:

| Variable | Tipo de Variable | Descripción |
|:---------|:---:|:------------|
| Promedio primer ciclo | Variable Numérica continua |Mediante este, obtenemos todos los promedios, el mayor, medio y menor|
| Créditos ciclo pasado | Variable Numérica discreta |Indica la cantidad de créditos que lleva un estudiante en un ciclo|
| Promedio ciclo pasado | Variable Numérica continua |Determina e promedio del ciclo pasado de cada estudiante, el máximo, media y mínimo|
| Numero decursos | Variable Numérica discreta | Indica la cantidad de cursos que cursa un estudiante durante el ciclo|
|Rendimiento académico | Variable Categórica ordinal |Indica el rendimiento académico, desde el inicio hasta el ciclo que se encuentran|
| Considera predominancia masculina | Variable categórica nominal | Son las carreras las cuales el individuo encuestado cree que existe una predominancia del sexo masculino notoria|
| Considera predominancia femenina | Variable categórica nominal | Son las carreras las cuales el individuo encuestado cree que existe una predominancia del sexo femenino notoria|
| Factores elección de carrera | Variable categórica ordinal | Los factores por los cuales el individuo encuestado ha elegido su carrera y las alternativas se han segmentado en razones Sociales, Interpersonal y otros|
| Considero cambiar de carrera | Variable categórica nominal | Responde a si el individuo ha considerado cambiarse de carrera puede elegir entre Sí y No|
| Carrera considero cambiarse | Variable categórica nominal | Si el individuo considero cambiarse de carrera elige entre las carreras de utec a las cuales tuvo la intención|
| Considero cambiarse de carrera | Variable categórica nominal | Responde a si el individuo ha considerado retirarse de la universidad puede elegir entre Sí y No|
| Razones considero retirarse universidad | Variable categórica nominal | El individuo elige la o las razones por las pensaron en retirarse de la universidad |

# Datos

## Recolección de Datos

El método de recolección de datos usado para este estudio, es de el de las encuestas cerradas, que normalmente son utilizados con la finalidad de recopilar datos autoinformados, lo que significa que cada encuestado proporciona información en tiempo real, para ello nos apoyamos del google forms que nos permite  crear encuestas y cuestionarios para cada usuario con sus respectivas delimitaciones.
Luego nos centramos en distribuir cada pregunta en el formato de acuerdo a nuestros objetivos, donde un cuestionario es una variable diferente para el desarrollo del estudio, de los cuales llegamos a tener 16 cuestionarios lo que significa que tenemos 16 variables para el desarrollo del proyecto.
Posteriormente empezamos a expandir el formulario por toda las comunidad de UTEC, mediante redes sociales (whatsapp, facebook, telegram), también incluir que se ha creado un código QR, lo que nos permite establecernos en el piso 1, piso 6 y piso 11, donde hay más aglomeración de estudiantes y realizar encuestas a cada estudiante de manera más directa, con el objetivo de llegar a la cantidad máxima de datos recopilados, de los cuales obtuvimos 170 datos encuestados.
Finalmente todos los datos recopilados mediante el forms, se descarga en formato csv, para seguir con el proceso a continuación.


## Encuestas 

De acuerdo a lo mencionado anteriormente usamos la encuesta como medio de recolección,  este método implica formular una serie de preguntas que se presentan a los participantes, cabe mencionar que realizamos preguntas en línea y nos apoyamos del google forms.
Aquí, los participantes eligen una respuesta de una lista predeterminada. Las opciones pueden ser de "sí/no", de opción múltiple o escalas de calificación (como el Likert), entre otros. 
Para no tener datos erróneos o información inservible o de exceso, se han realizado las restricciones posibles y necesarias para cada pregunta y por supuesto obtener información única de cada estudiante (que no se repita).
Optamos por los googles forms,  ya que nos ofrece una serie de ventajas que lo convierten en una opción atractiva para realizar encuestas. Este es de fácil uso, lo podemos personalizar de acuerdo a nuestra preferencia y recopilar datos en tiempo real, integra herramientas que nos permite restringir y así obtener información que nos permita desarrollar el proceso de manera eficaz y menos trabajoso, por otro lado es de manera compatible con cualquier dispositivo como tablet, celular, laptop, etc. finalmente nos permite obtener datos de carácter seguro y privado.

## Población, muestra y muestreo

**Población:** Para el desarrollo del proyecto, tomamos como población de estudio a todos los estudiantes en todas las carreras de UTEC, vigentes durante el periodo 2023-1, desde el ciclo I hasta el ciclo X.

**Muestra:** De acuerdo a los resultados de la recopilación de datos, tenemos 170 encuestas obtenidas, que representan la muestra para este caso. 

**Muestreo:**  Para el desarrollo de este proyecto tenemos el tipo de muestreo por conveniencia de tipo no probabilístico, ya que enviamos el link mediante las redes sociales, amigos, grupo de amigos, sección de clases, etc.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(dplyr)
library(readr)
library(crayon)
library(DescTools)
library(magrittr)
library(ggplot2)
library(modeest)
library(janitor)
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
pkg_list <- c("dplyr", "ggplot2", "readr") 
install_missing <- function(pkgs) {
  new_pkgs <- pkgs[!(pkgs %in% installed.packages()[,"Package"])]
  if (length(new_pkgs)) 
    install.packages(new_pkgs, dependencies = TRUE)
}
install_missing(pkg_list)

```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
data<-read.csv("BaseDeDatosLimpia.csv")
DF<-read_csv("BaseDeDatosLimpia.csv")
```


---------------------------------------------------------------------------------------------------------------------------------



# Análisis probabilístico

En esta parte del proyecto, se seleccionan 2 de las variables más importantes de nuestro estudio.

## Probabilidad Empírica

A continuación, se determina el espacio muestral teórico y se calcula la función de probabilidad para los eventos atómicos de manera empírica.


### Variable 01

de la siguiente base datos se selecciona la variable rendimiento académico, lo cual se observa en la siguiente tabla.
```{r, message=FALSE, warning=FALSE, echo=FALSE}
espacioM1 <- DF %>% distinct(Rendimiento_academico) %>% rename("Rendimiento Académico" = Rendimiento_academico)
espacioM1
table(data$Rendimiento_academico)
```






**Identificando nuestros eventos:**
A continuación se muestra los siguientes eventos, extraídos de la variable Rendimiento académico en los que se encuentra cada estudiante encuestado y son lo siguiente:

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tibble)
tabla_Rend <- table(data$Rendimiento_academico)
mensajes <- character(length(tabla_Rend))
for (i in 1:length(tabla_Rend)) {
  mensajes[i] <- paste("Evento del estudiante con rendimiento", names(tabla_Rend)[i])
}
df <- tibble(Eventos_atómicos = mensajes)
print(df)
```
Continuando calcularemos la probabilidad directa (frecuencia) que ocurre en cada evento atómico de nuestra variable importante elegido, por ello creamos una función, se muestra a continuación:

```{r, message=FALSE, warning=FALSE, echo=FALSE}
tabla_Rend <- table(data$Rendimiento_academico)
total_obs <- sum(tabla_Rend)
prob_empirica <- tabla_Rend / total_obs
for (i in 1:length(prob_empirica)) {
  cat("La probabilidad de un estudiante con rendimiento", names(prob_empirica)[i], "es", prob_empirica[i], "\n")
}
df <- data.frame(Rendimiento = names(prob_empirica),
                 Probabilidad = as.numeric(prob_empirica))
print(df)
```

Para tener un mejor entendimiento e interpretación creamos una gráfica de barras, en las que se muestra en lo siguiente:

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(RColorBrewer)

tabla_Rend <- table(data$Rendimiento_academico)
total_obs <- sum(tabla_Rend)
prob_empirica <- tabla_Rend / total_obs
df <- data.frame(Rendimiento = names(prob_empirica), Probabilidad = as.numeric(prob_empirica))

ggplot(df, aes(x = Rendimiento, y = Probabilidad, fill = Rendimiento)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = scales::percent(Probabilidad, accuracy = .01)), vjust = -0.3, size = 3.5) +
  labs(x = "Rendimiento académico", y = "Probabilidad empírica",
       title = "Probabilidad empírica de cada rendimiento académico") +
  theme_minimal() +
  scale_fill_brewer(palette = "Dark2")

```


interpretación: Según el gráfico generado, podemos ver claramente que la mayoría de los estudiantes encuestados en UTEC presentan un rendimiento académico entre 'Regular' y 'Bueno'. Esto puede implicar que los estudiantes tienden a tener un rendimiento promedio o ligeramente por encima del promedio en su desempeño académico, aproximadamente, el 57.14% de los estudiantes tiene un rendimiento académico 'Regular', mientras que el 36.02% de los estudiantes tiene un rendimiento académico 'Bueno'. Estas son las categorías de rendimiento más frecuentes en nuestra muestra de estudiantes, Por otro lado, las categorías de rendimiento 'Muy Bueno' y 'Mal' se encuentran en la minoría, representando aproximadamente el 3.11% y 3.73% respectivamente de los estudiantes. Esto significa que sólo una pequeña proporción de estudiantes en la muestra se destacan por tener un rendimiento excepcionalmente bueno o, por el contrario, un rendimiento por debajo del promedio, cabe destacar que estas interpretaciones se basan en datos empíricos y representan las tendencias observadas en esta muestra de estudiantes en la UTEC. 



### Variable 02 

Por otro lado vimos que la variable considero_cambiar_de_carrera, es importante debido a que nos informa la cantidad de estudiantes encuestados están seguros, dudando y los que estudian por otros medios. 


```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(dplyr)

espacioM2 <- DF %>%
  distinct(considero_cambiar_de_carrera) %>%
  rename("Considera Cambiar de Carrera" = considero_cambiar_de_carrera)

espacioM2

table(data$considero_cambiar_de_carrera)
```
**Identificando nuestros eventos:** Siguiendo el desarrollo del proyecto, al escoger la variable "Considera Cambiar de Carrera", identificamos los eventos que contiene, de los estudiantes encuestados en la base de datos.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tibble)
tabla_cambios <- table(data$considero_cambiar_de_carrera)
mensajes <- character(length(tabla_cambios))
for (i in 1:length(tabla_cambios)) {
  mensajes[i] <- paste("Evento del estudiante que considera cambiar de carrera", names(tabla_cambios)[i])
}
df <- tibble(Eventos_atómicos = mensajes)
print(df)

```

A continuación calcularemos la probabilidad directa (frecuencia) que ocurre en cada evento atómico de nuestra variable "Considera Cambiar de Carrera" importante, por ello creamos una función, se muestra a continuación:

```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(tibble)
tabla_cambios <- table(data$considero_cambiar_de_carrera)
total_obs <- sum(tabla_cambios)
prob_empirica <- tabla_cambios / total_obs
mensajes <- character(length(tabla_cambios))
for (i in 1:length(tabla_cambios)) {
  mensajes[i] <- paste("Evento del estudiante que", names(prob_empirica)[i], "considera cambiar de carrera, su probabilidad es de", prob_empirica[i])
}
df <- tibble(Eventos_atómicos = mensajes)
print(df)


```


```{r, message=FALSE, warning=FALSE, echo=FALSE}
tabla_cambios <- table(data$considero_cambiar_de_carrera)
total_obs <- sum(tabla_cambios)
prob_empirica <- tabla_cambios / total_obs
df <- data.frame(Decision = names(prob_empirica),
                 Probabilidad = as.numeric(prob_empirica))
print(df)

```

Creamos una gráfico para mejor entendimiento de la probabilidad directa, que se muestra a continuación.


```{r, message=FALSE, warning=FALSE, echo=FALSE}
ggplot(df, aes(x = Decision, y = Probabilidad, fill = Decision)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(round(Probabilidad * 100, 2), "%")), 
            vjust = -0.3,
            color = "black") +
  scale_fill_brewer(palette = "Pastel1") +
  theme_minimal() +
  labs(x = "Decisión de cambiar de carrera",
       y = "Probabilidad empírica",
       fill = "Decisión",  
       title = "Probabilidad empírica de la decisión de cambiar de carrera")

```

Interpretación: Según los datos obtenidos, existe una probabilidad empírica del 35.4% de que un estudiante de la muestra considere cambiar de carrera. Esto significa que, basado en nuestra muestra actual, si seleccionamos un estudiante al azar, hay un 35.4% de probabilidad de que ese estudiante está considerando cambiar de carrera, el (49.1%) no están considerando cambiar de carrera. Esto indica que a pesar de los diversos factores que podrían influir en la decisión de cambiar de carrera, como la dificultad de los cursos, la afinidad con la carrera, entre otros, casi la mitad de los estudiantes se sienten cómodos o están seguros de la elección actual y 15.5% de estudiantes que están indecisos sobre cambiar de carrera. Esta incertidumbre puede estar influenciada por varios factores, incluyendo la presión de sus compañeros, las expectativas de la familia, las perspectivas de empleo, entre otros. 






































## Probabilidad Condicional 



### Probabilidad condicional 1:
De tener un alto promedio (promedio mayor a 12) dado el rendimiento académico sea bueno o muy bueno : P(Alto promedio| buen rendimiento). 

La justificación de esta relación es relevante en el ámbito educativo, ya que permite orientar las intervenciones y el apoyo académico dirigido a los estudiantes. Si encontramos una fuerte relación entre un buen rendimiento académico y un alto promedio, podemos brindar apoyo adicional o recomendaciones específicas a los estudiantes con buen rendimiento para ayudarlos a alcanzar un promedio más alto. Además, esta relación nos permite identificar otros factores que podrían influir en el desempeño promedio, como la dedicación, la carga de trabajo o el enfoque en actividades extracurriculares. Al considerar estos factores, podemos ofrecer un enfoque más integral y personalizado para mejorar el rendimiento promedio de los estudiantes. En resumen, la probabilidad condicional de tener un alto promedio dado un rendimiento académico bueno o muy bueno es esencial para comprender la relación entre el rendimiento y el promedio, y para proporcionar orientación y apoyo académico eficaz a los estudiantes.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
table(DF$Promedio_ciclo_pasado)
table(DF$Rendimiento_academico)
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
#A Promedio alto
#B buen rendimiento
AnB2 <- subset(DF,(DF$Promedio_ciclo_pasado>='12' ) & (DF$Rendimiento_academico == '1. Muy Bueno' | DF$Rendimiento_academico == '2. Bueno'))
AnB2
ProbAnB2 <- (nrow(AnB2))/(nrow(DF))
ProbAnB2
ProbB2 <- (nrow(subset(DF, (DF$Rendimiento_academico == '1. Muy Bueno' | DF$Rendimiento_academico == '2. Bueno'))))/nrow(DF)
ProbB2
Prob_total2 <- ProbAnB2/ProbB2
Prob_total2
```
Probabilidad de A dado B (AnB = 0.3913043)
Probabilidad de B (B = 0.3913043)
probabilidad total del suceso (Prob_total = 1)


Como se puede observar la probabilidad de A dado B es la misma que la probabilidad de B por lo tanto inferimos que es un evento independiente.



### Probabilidad condicional 2:
Que el alumno no haya pensado en cambiarse de carrera dado que elogió su carrera por vocación  : P(no cambiarse de carrera|vocación). 

La búsqueda de la probabilidad condicional de que un alumno no haya considerado cambiarse de carrera, dado que eligió su carrera por vocación (P(no cambiarse de carrera | vocación)), es crucial para comprender la relación entre la elección vocacional y la estabilidad de esa elección a lo largo del tiempo. Esta búsqueda nos permite evaluar la probabilidad de que los estudiantes que eligieron su carrera por vocación no hayan pensado en cambiarla, lo cual es fundamental para comprender su satisfacción y compromiso con la carrera elegida. Además, esta relación es relevante para desarrollar programas de orientación y apoyo académico específicos, ya que proporciona una base sólida para fortalecer la conexión entre la vocación y la carrera, fomentando así una mayor estabilidad y éxito académico. En resumen, explorar la probabilidad condicional de no cambiar de carrera dada la elección vocacional nos permite comprender y promover la consistencia, satisfacción y compromiso de los estudiantes con su carrera elegida.

```{r, message=FALSE, warning=FALSE, echo=FALSE}
table(DF$considero_cambiar_de_carrera)
table(DF$Factores_eleccion_de_carrera)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
#A No considero cambiarse de carrera
#B eligió su carrera por vocación


AnB3 <- subset(DF,(DF$considero_cambiar_de_carrera =='2. No' ) & (DF$Factores_eleccion_de_carrera == '4. Vocación'))
AnB3

ProbAnB3 <- (nrow(AnB3))/(nrow(DF))
ProbAnB3

ProbB3 <- (nrow(subset(DF, (DF$Factores_eleccion_de_carrera == '4. Vocación'))))/nrow(DF)
ProbB3

Prob_total3 <- ProbAnB3/ProbB3
Prob_total3
```
Probabilidad de A dado B (AnB = 0.1490683)
Probabilidad de B (B = 0.2360248)
probabilidad total del suceso (Prob_total = 0.6315789)


Como se puede observar la probabilidad de A dado B no es la misma que la probabilidad de B por lo tanto inferimos que es un evento Dependiente.

## Distribuciones Discretas

###  variable: numero_de_cursos
   
1. Definiendo: La distribución que usaremos **Binomial**

2. Construir la variable aleatoria.

Consideremos que se selecciona al azar un conjunto de 10 estudiantes y queremos observar el número de cursos que cada uno está tomando.Por eso planteamos el éxito como si un estudiante lleve 2 o más cursos, ya que queremos estudiar esa tendencia.

X: número de cursos que llevan los estudiantes en el ciclo, mayores o iguales a 4 en el conjunto de la muestra del tamaño 161

3. Identificar los parámetros
$$X \sim Bin(p, n)$$

$$  P(E)=P(numCursos)/P(n)$$
p:Probabilidad de éxito

```{r, message=FALSE, warning=FALSE, echo=FALSE}
p <-nrow(data %>% filter(Numero_de_cursos >= 4))/nrow(data)
p
```

n: tamaño de la población
```{r, message=FALSE, warning=FALSE, echo=FALSE}
n<-sum(table(data$Numero_de_cursos))
n
```
4. Gráfica de densidad

$$X∼Bin(10,0.9254658)$$

```{r, message=FALSE, warning=FALSE, echo=FALSE}
n <- 161 # Definir n como el número de ensayos
p <- 0.9813665 # Definir p como la probabilidad de éxito
x <- 0:5 # Definir x como el número de éxitos
probabilidade <- dbinom(x, size = n, prob = p) # Calcular las probabilidades de cada valor
barplot(probabilidade, names.arg = x, xlab = "numero de cursos", ylab = "Probabilidad", main = "Distribución Binomial", col = rainbow(length(x)))  

```


```{r, message=FALSE, warning=FALSE, echo=FALSE}

datos <- data.frame(x = 0:n, probabilidad = dbinom(0:n, size = n, prob = p))

ggplot(datos, aes(x = x, y = probabilidad)) +
  geom_bar(stat = "identity", fill = "darkgreen", width = 0.9) +
  labs(title = "Distribución Binomial", x = "Número de cursos >= 4", y = "Probabilidad") +
  theme_minimal()
```







5.  Validación de propiedades

-Esperanza 
$$\sum_{i = 0}^{n} x_i \cdot p(x_i)$$
```{r, message=FALSE, warning=FALSE, echo=FALSE}
esp <- 0
for (i in 0:161) {
   esp <- esp + (i) * dbinom(i, n, p)
}
esp
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
mu <- n*p
mu 
```
-Varianza

$$\sum_{i = 0}^{n} (x_i-\mu)^2 \cdot p(x_i)$$


```{r, message=FALSE, warning=FALSE, echo=FALSE}
var <- 0
for (i in 0:n) {
   var <- var + (i - mu)^2 * dbinom(i, n, p)
}
var
```

-Desviación estándar

$$\sqrt{\sum_{i = 0}^{n} (x_i-\mu)^2 \cdot p(x)}$$
q: probabilidad de fracaso (1 - p)
```{r, message=FALSE, warning=FALSE, echo=FALSE}
varianza <- n * p * (1 - p)
varianza
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
sqrt(varianza)
#sqrt(var)
```
Si elegimos al azar un conjunto de 10 estudiantes encuestados y queremos observar el número de cursos que cada uno está tomando ¿Cuál es la probabilidad de que a lo mucho 2 de estos estén llevando 7 cursos?

```{r, message=FALSE, warning=FALSE, echo=FALSE}
pbinom(7, 10, p)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
plot(0:10, dbinom(0:10,size = 10, prob = p),
type='h',
main='Distribución Binomial',
ylab='Probabilidad',
xlab ='Número de cursos que lleva >= 4',
lwd=3, col = "blue")
```



###  variable: rendimiento_academico


1.  Distribución a utilizar: **Hipergeométrica**

-   Éxito: seleccionar a estudiantes con buen rendimiento académico

2.  Construir la variable aleatoria

Se sabe que en la base de datos existe una mayor cantidad de estudiantes que están regular en su rendimiento  académico . Se toma en cuenta el éxito como la selección de  estudiantes con buen rendimiento por tal motivo.

-   X: Cantidad de estudiantes con buen rendimiento académico en una muestra elegida aleatoria mente de 15 estudiantes de        la entrevista de tamaño 161.
    
```{r, message=FALSE, warning=FALSE, echo=FALSE}
table(data$Rendimiento_academico)
```

3.  Definición de parámetros

$$X \sim Hiper(n, m, k)$$

m: tamaño de la población 
n: número de estudiantes con buen rendimiento academico 
k: tamaño de la muestra

```{r, message=FALSE, warning=FALSE, echo=FALSE}
buenanota <- data %>% filter(Rendimiento_academico == "2. Bueno")
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
m <-nrow(data)
n <- nrow(buenanota)
k <- 15
m
n
k
```

$$X \sim Hiper(161, 58, 15)$$

4.  Gráfica de densidad

```{r, message=FALSE, warning=FALSE, echo=FALSE}
success<-0:161
plot(success,dhyper(0:161,m, n, 161) , type='h', main='Distribución Hipergeométrica', ylab='Probabilidad', xlab ='Número de intentos', lwd=3,  col="purple")
```





5.  Validación de propiedades

-   Esperanza

$$\sum_{i = 0}^{n} x_i \cdot p(x_i)$$

```{r, message=FALSE, warning=FALSE, echo=FALSE}
esp <- 0
for (i in 0:15) {
   esp <- esp + (i) * dhyper(i, n, 161-n, k)
}
esp
```

$$k \cdot p$$

p: es la proporción de éxitos

```{r, message=FALSE, warning=FALSE, echo=FALSE}
p <- n/m
mu <- k * p
mu
```

-   Varianza

$$\sum_{i = 0}^{n} (x_i-\mu)^2 \cdot p(x_i)$$

```{r, message=FALSE, warning=FALSE, echo=FALSE}
var <- 0
for (i in 0:n) {
   var <- var + (i - mu)^2 * dhyper(i, n, 161-n, k)
}
var
```

$$k \cdot p\cdot (1-p) \cdot (\frac{m - k}{m-1})$$


```{r, message=FALSE, warning=FALSE, echo=FALSE}
varianza<- k * p * (1 - p) * ((m-k)/(m-1))
varianza
```

- Coeficiente de variación

$$\sqrt{\sum_{i = 0}^{n} (x_i-\mu)^2 \cdot p(x)}$$
```{r, message=FALSE, warning=FALSE, echo=FALSE}
sqrt(varianza)
```

$$\sqrt{k \cdot p\cdot (1-p) \cdot (\frac{m - k}{m-1})}$$

```{r, message=FALSE, warning=FALSE, echo=FALSE}
sqrt(k * p * (1 - p) * ((m-k)/(m-1)))
```

6.  Construcción del ejemplo para validar

Se tienen 161 estudiantes  de las cuales 103 están entre muy bueno, regular y mal en el rendimiento academico. Si se selecciona una muestra de tamaño 15, ¿cuál es la probabilidad de seleccionar como 4 estudiantes con buen promedio?

```{r, message=FALSE, warning=FALSE, echo=FALSE}
k <- 4
fracaso <- 103
exito <- 161 - 103
muestra <- 15
dhyper(k, exito, fracaso, muestra)
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
s <- 0:5
exito <- 20   # Número de éxitos en la población
fracaso <- 30 # Número de fracasos en la población
tamaño_muestra <- 15

plot(s, dhyper(s, exito, fracaso, tamaño_muestra), type='h', main='Distribución Hipergeométrica', ylab='Probabilidad', xlab ='Número de estudiantes con buena nota', lwd=3,  col="blue")

```


## Distribuciones Continuas


### Variable aleatoria Promedio_primer_ciclo


```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Paso 1: Identificar el tipo de distribución

hist(DF$Promedio_primer_ciclo, breaks = 5, main = "HISTOGRAMA DEL PROMEDIO DE NOTAS DEL PRIMER CICLO", xlab= "Promedio de notas", ylab="Frecuencia absoluta", freq = FALSE, ylim = c(0,0.3))
abline(v=mean(DF$Promedio_primer_ciclo), col="green")
abline(v=median(DF$Promedio_primer_ciclo), col="red")
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Paso 2: Validar la distribución
# - Comparar media poblaciónal con la Mediana poblaciónal para garantizar que el 50% aproximadamente esta por encima y por debajo de la media
print('Diferencia entre media poblacional y mediana')
abs(mean(DF$Promedio_primer_ciclo)-median(DF$Promedio_primer_ciclo))
# - Comparar la media muestral con la media poblaciónal, generando 10 muestras de tamaño 30 sobre nuestra población
medias=rep(0,10)
for (i in 1:10) {
  indice=sample(1:161,30,replace=FALSE)
  muestra=DF$Promedio_primer_ciclo[indice]
  medias[i]=mean(muestra)
}
print('Media muestral')
mean(medias)
error_media_muestral=abs(mean(DF$Promedio_ciclo_pasado)-mean(medias))
print('error porcentual para la Media muestral')
error_media_muestral*100/(mean(DF$Promedio_primer_ciclo))

# - Comparar la desviación estandar de la media muestral con sd/raiz(n)
print('Desviación estandar muestral')
sd(medias)
error_sd_muestral=abs(sd(DF$Promedio_primer_ciclo)/30**0.5-sd(medias))
print('error porcentual para la desviación estandar de la Media muestral')
error_sd_muestral*100/(sd(DF$Promedio_primer_ciclo)/30**0.5)
```



```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Paso 3: Definir la variable Aleatoria X~Norm(mu,ds)
print('Definir la variable Aleatoria X~Norm(mu,ds)')
mu=mean(DF$Promedio_primer_ciclo)
sd=sd(DF$Promedio_primer_ciclo)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Paso 4: Ejemplo
# Se sabe que el quinto superior en los ultimos años esta definido por una nota mínima, la cual alberga al 20% de alumnos con notas superiores. Determinar la nota mínima para pertenecer al quinto superior
# Dado que nuestra población se distribuye Norm(mu,ds), podemos afirmar que:
NotaMin=qnorm(0.2,mu,sd,lower.tail = FALSE)
print('El promedio mínimo que debería haber  tenido un estudiante para estar dentro del 20% de los estudiantes que pertenecen quinto superior es: ')
NotaMin
round(NotaMin,2)
```
```{r}
table(DF$considero_cambiar_de_carrera)/161
```


```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Cual es la mínima nota para que el alumno no se cambie de carrera si se sabe que el 0.35% de alumnos terminan cambiándose de carrera
NotaMin1=qnorm(0.3540373,mu,sd)
print('El promedio mínimo que debería haber  obtenido  un estudiante para estar dentro del grupo de personas que no consideran retirarse de la universidad es: 
')
NotaMin1
round(NotaMin1,2)
```

### Variable  Promedio_ciclo_pasado

Separamos a las mujeres de los varones mediante la creacion de una nueva data, mujer_considera_cambiar

```{r, message=FALSE, warning=FALSE, echo=FALSE}
Promedios_CP_Mujeres=DF$Promedio_ciclo_pasado[DF$Genero=="Femenino"]
length(Promedios_CP_Mujeres)
Mujer_considera_cambiar=DF$considero_cambiar_de_carrera[DF$Genero=="Femenino"]
```
```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Paso 1: Identificar el tipo de distribución
hist(Promedios_CP_Mujeres, breaks = 5, main = "HISTOGRAMA DEL PROMEDIO DE NOTAS DEL PRIMER CICLO", xlab= "Promedio de notas", ylab="Frecuencia absoluta", freq = FALSE, ylim = c(0,0.3))
abline(v=mean(Promedios_CP_Mujeres), col="green")
abline(v=median(Promedios_CP_Mujeres), col="red")
```



```{r, message=FALSE, warning=FALSE, echo=FALSE}
#Paso 2: Validar la distribución
# - Comparar media poblacional con la Mediana poblacional para garantizar que el 50% aproximadamente esta por encima y por debajo de la media
print('Diferencia entre media poblacional y mediana')
abs(mean(Promedios_CP_Mujeres)-median(Promedios_CP_Mujeres))
# - Comparar la media muestral con la media poblacional, generando 10 muestras de tamaño 30 sobre nuestra población
medias=rep(0,10)
for (i in 1:10) {
  indice=sample(1:75,30,replace=FALSE)
  muestra=Promedios_CP_Mujeres[indice]
  medias[i]=mean(muestra)
}
print('promedio de las Medias muestrales')
mean(medias)
error_media_muestral=abs(mean(Promedios_CP_Mujeres)-mean(medias))
print('error porcentual para la Media muestral')
error_media_muestral*100/(mean(Promedios_CP_Mujeres))

# - Comparar la desviación estandar de la media muestral con sd/raiz(n)
print('Desviación estandar muestral')
sd(medias)
error_sd_muestral=abs(sd(Promedios_CP_Mujeres)/30**0.5-sd(medias))
print('error porcentual para la desviación estandar de la Media muestral')
error_sd_muestral*100/(sd(Promedios_CP_Mujeres)/30**0.5)
```


```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Paso 3: Definir la variable Aleatoria X~Norm(mu,ds)
print('Definir la variable Aleatoria X~Norm(mu,ds)')
mu=mean(Promedios_CP_Mujeres)
sd=sd(Promedios_CP_Mujeres)
```

```{r, message=FALSE, warning=FALSE, echo=FALSE}
table(Mujer_considera_cambiar)/75
```

##Paso 4:

```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Se sabe que el quinto superior en los ultimos años esta definido por una nota mínima, la cual alberga al 20% de alumnos con notas superiores. Determinar la nota mínima para pertenecer al quinto superior
# Dado que nuestra población se distribuye Norm(mu,ds), podemos afirmar que:
print('Nota mínima para estar en el quinto superior,es decir, dentro del 20% de las mujeres es: ')
NotaMin=qnorm(0.2,mu,sd,lower.tail = FALSE)
NotaMin
round(NotaMin,2)
```
```{r}
table(Mujer_considera_cambiar)/75
```


```{r, message=FALSE, warning=FALSE, echo=FALSE}
# Cual es la mínima nota para que el alumno no se cambie de carrera si se sabe que el 40% de alumnos terminan cambiándose de carrera
print('Nota mínima que deben tener las mujeres para no considerar cambiarse de carrera es: ')
NotaMin1=qnorm(0.4,mu,sd)
NotaMin1
round(NotaMin1,2)
```

# Conclusión 
En base a nuestros hallazgos, podemos concluir que existen factores específicos relacionados con el género y el entorno que influyen en la elección de carrera de los estudiantes de ingeniería y ciencias en UTEC. Se identificó una presencia diferenciada por género en ciertas carreras de ingeniería, sugiriendo que las percepciones y estereotipos de género pueden estar influyendo en las decisiones de los estudiantes.
La elección de carrera de los estudiantes está influenciada por una combinación de factores, que incluyen tanto sus propias habilidades y preferencias como las actitudes y expectativas sociales. Hemos observado que el rendimiento académico no es necesariamente un factor determinante para la elección de carrera, pero ciertos patrones se manifiestan en función del género del estudiante.
La identificación de barreras percibidas por los estudiantes para el acceso y permanencia en las carreras de ingeniería nos permite concluir que existen obstáculos que pueden estar desalentando la participación de ciertos grupos de estudiantes, especialmente las mujeres.
En cuanto al porcentaje de estudiantes que consideran cambiar de carrera, nuestros resultados indican que la decisión inicial de carrera puede ser incierta para muchos estudiantes, lo cual se ve influenciado por factores variados, incluyendo el género y el entorno.
Este estudio tiene importantes implicatorias para UTEC. Las percepciones y experiencias de los estudiantes proporcionan un valioso insight sobre cómo mejorar las políticas y prácticas de la universidad para apoyar una elección de carrera más informada y equitativa.
La realización de este estudio en UTEC ha contribuido al entendimiento de cómo el género y el entorno pueden influir en la elección de carrera, llenando una brecha en el conocimiento existente. Sin embargo, es importante considerar que estos hallazgos son específicos para UTEC y puede que no sean generalizables a otras instituciones o contextos. Por lo tanto, se recomienda continuar con investigaciones similares en otros entornos para una visión más amplia y completa.

