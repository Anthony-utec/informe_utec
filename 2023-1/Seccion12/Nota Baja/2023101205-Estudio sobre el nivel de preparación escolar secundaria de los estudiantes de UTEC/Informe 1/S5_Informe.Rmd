---
title: "Estudio sobre el nivel de preparación escolar secundaria de los estudiantes de UTEC inscritos en el periodo 2023-1"
format: 
  html:
    theme: cyborg
    toc: true
    toc-depth: 4
    number-sections: true
    
editor: visual
---

# Introducción:

------------------------------------------------------------------------

## Relevancia:

El estudio nos permitirá obtener información valiosa acerca del nivel de preparación que tienen los estudiantes antes de ingresar a la universidad, y cómo esto puede estar relacionado con su desempeño académico en la institución. Además, el proyecto también analizará la relación entre el colegio de procedencia y el éxito académico de los estudiantes en UTEC.

Este estudio será de gran ayuda ya que permitirá conocer las fortalezas y debilidades de los estudiantes en cuanto a su preparación escolar, y en base a ello se podrán diseñar estrategias pedagógicas que ayuden a mejorar el desempeño académico de los estudiantes en la universidad.

## Objetivos:

-   ***Relacionar*** el nivel académico de la preparación escolar secundaria con el desempeño académico, la seriedad con la que se tomaba el colegio y tipo de colegio (publico o privado) del estudiante de UTEC para saber si ha tenido una influencia, positiva o negativa.

-   ***Analizar*** la información sobre el nivel de preparación escolar secundaria, satisfacción, utilidad y nivel de ingles que tuvieron los estudiantes de UTEC de ciclo 2023-1.

-   ***Determinar*** la relación que existe entre el colegio de procedencia, preparación, satisfacción y utilidad del colegio con el éxito académico de los estudiantes de UTEC.

## Contexto:

Para estudiar el tema propuesto hemos encuestado a los estudiantes de UTEC del ciclo 2023-1 mediante preguntas para marcar. Hemos hecho preguntas clave referentes a nuestros objetivos de investigación.

Para analizar estos datos hemos aplicado los conocimientos que hemos adquirido para manejar los datos en R mediante descriptores numéricos y gráficos, para posteriormente analizarlos y relacionarlos entre sí.

# Datos:

## Proceso de recolección:

1.  Se plantearon las variables que se deberían recolectar.
2.  Se creo una encuesta en Google Forms con las preguntas adecuadas para obtener los datos de las variables planteadas.
3.  Compartimos la encuesta por grupos y encuestamos presencialmente a estudiantes de manera aleatoria.
4.  Fuimos recorriendo diversos pisos, en diferentes horarios y días. Esto con el objetivo de tener una muestra variada y que sea lo mas representativa de nuestra población.

## Población, Muestra y Muestreo:

Tenemos 181 observaciones y 36 variables.

1.  ***Población de estudio:*** Alumnos de la Universidad de Ingeniería y Tecnología (UTEC) que se encuentran en el periodo 2023-1.
2.  ***Unidad Muestral:*** Alumnos de diferentes ciclos de UTEC.
3.  ***Tamaño de Muestra:*** 181 estudiantes inscritos en el periodo 2023-1.
4.  ***Tipo de Muestreo:*** Muestreo Aleatorio Simple (MAS), probabilístico.

## Variables:

|                                        Variables                                        |       Tipos        |                                          Restricciones                                           |        Rename        |
|:----------------:|:----------------:|:-----------------:|:----------------:|
|                                         Genero                                          | Categórica Nominal |      Solo existen dos opciones hombre o mujer, debido a que es la que se indica en el DNI.       |        Genero        |
|                            Tipo del Colegio de Proveniencia                             | Categórica Nominal |                   Las opciones están limitadas por privado, público y militar                    |     ColegioTipo      |
|                          Ubicación del Colegio de Proveniencia                          | Categórica Nominal |                               Limitadas a las provincias del Perú                                |      ColegioUbi      |
|                          Modalidad de ingreso a la universidad                          | Categórica Nominal |                      Modalidades de ingreso que cuenta la universidad UTEC                       |   ModalidadIngreso   |
|                                     Cuenta con beca                                     | Categórica Nominal |                                    Solo respuestas de Si o No                                    |         Beca         |
|            ¿Estuviste en alguna academia antes de ingresar a la universidad?            | Categórica Nominal |                                    Solo respuestas de Si o No                                    |     AcademiaFlag     |
|                        ¿Por qué llevaste una academia adicional?                        | Categórica Nominal |   Lista de opciones planteadas por nosotros o la opción otros donde pueden escribir libremente   |    AcademiaRazon     |
|                      ¿Formaste habilidades blandas en el colegio?                       | Categórica Nominal |                                    Solo respuestas de Si o No                                    |    HabBlandasFlag    |
|                                ¿Qué habilidades formaste?                               | Categórica Nominal |                   Lista de opciones planteadas por nosotros o la opción otros                    |      HabBlandas      |
|                                Academia en la que estuvo                                | Categórica Nominal |                      Nombre de academia que exista y que esté bien escrita                       |    AcademiaNombre    |
|                           ¿En qué tipo de academia estuviste?                           | Categórica Nominal |  Las opciones están limitadas a cursos que se llevaron en la academia junto con la opción otros  |     AcademiaTipo     |
|                           ¿Llevaste inglés en tu secundaria?                            | Categórica Nominal |                                    Solo respuestas de Si o No                                    |    InglesSecFlag     |
|                      ¿Cuentas con alguna certificación de inglés?                       | Categórica Nominal |                                    Solo respuestas de Si o No                                    | InglesCertificacion  |
|                 ¿Qué situación se adecua más a tu nivel con el inglés?                  | Categórica Nominal |                      Solo respuestas de situaciones planteadas por nosotros                      |   InglesSituacion    |
|                           ¿Cursos más difíciles en el colegio?                          | Categórica Nominal | Listado de cursos obligatorios según MINEDU pero limitados a los cursos que queremos dar énfasis |   CursosDificiles    |
|                                  Correo institucional                                   | Categórica Nominal |                                correo que contenga \@utec.edu.pe                                 |        Correo        |
|                          ¿Está estudiando inglés actualmente?                           | Categórica Nominal |                                    Solo respuestas de Si o No                                    |      InglesFlag      |
|                                Ciclo cursado actualmente                                | Categórica Ordinal |                                   Ciclos limitados del 1 al 10                                   |        Ciclo         |
|                            Escala de pago en la universidad                             | Categórica Ordinal |                                  Escala de pago de la A a la E                                   |      EscalaPago      |
|                          Nivel de inglés al salir del colegio                           | Categórica Ordinal |                        Numeros del 1 al 10 donde 1 es malo y 10 es bueno                         |   InglesNivelCole    |
|                                 Nivel de inglés actual                                  | Categórica Ordinal |                        Numeros del 1 al 10 donde 1 es malo y 10 es bueno                         |  InglesNivelActual   |
|                   Nivel de utilidad de preparación general secundaria                   | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inutil y 5 util                             |  UtilidadGeneralSec  |
|                     Nivel de utilidad de preparación en matemáticas                     | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inutil y 5 util                             |     UtilidadMate     |
|                       Nivel de utilidad de preparación en letras                        | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inutil y 5 util                             |    UtilidadLetras    |
|                        Promedio ponderado actual (en intervalos)                        | Categórica Ordinal |                                      En intervalos de notas                                      |      Ponderado       |
|                       Nivel de utilidad de preparación en ciencias                      | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inutil y 5 util                             |   UtilidadCiencias   |
|                        ¿Que tan en serio te tomabas el colegio?                         | Categórica Ordinal |                       Escala del 1 al 10 donde 1 nada serio y 10 muy serio                       |     ColeSeriedad     |
|                                Horas de estudio diarias                                 | Numérica Continua  |                En formato de Hora:Minutos y que las horas no excedan las 12 horas                |   HorasEstudioUni    |
|                      Horas de estudio de algún idioma semanalmente                      | Numérica Continua  |               En formato de Hora:Minutos  y que las horas no excedan las 48 horas                |  HoraEstudioIngles   |
|                   Nivel de Satisfacción con la Preparación Secundaria                   | Numérica Discreta  |                      Escala del 1 al 5 donde 1 insatisfecho y 5 satisfecho                       | SatisfaccionPrepSec  |
|                     Nivel de satisfacción docente en la secundaria                      | Numérica Discreta  |                      Escala del 1 al 5 donde 1 insatisfecho y 5 satisfecho                       | SatisfaccionDocente  |
|                 ¿Consideras que sirvio para ingresar a la universidad?                  | Numérica Discreta  |           Escala del 1 al 5 donde 1 Totalmente en desacuerdo y 5 Totalmente de acuerdo           | UtilidadAcademia_Uni |
| ¿Sientes que tu preparación académica del colegio basta para ingresar a la universidad? | Numérica Discreta  |           Escala del 1 al 5 donde 1 Totalmente en desacuerdo y 5 Totalmente de acuerdo           |     PrepCole_Uni     |
|                                  ¿Cuántos años tienes?                                  | Numérica Discreta  |                                       de 14 años a 60 años                                       |         Edad         |
|                        ¿En qué año ingresaste a la universidad?                         | Numérica Discreta  |                     Antes del 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023                     |      AñoIngreso      |
|                        ¿Cuánto tiempo estuviste en la academia?                         | Numérica Discreta  |                      Menos de 1 mes, rangos de 2 meses hasta 12 meses a mas                      |    AcademiaTiempo    |

## Código Base:

En esta sección, nos enfocaremos en las herramientas fundamentales para nuestro proyecto, específicamente las librerías que utilizaremos y el proceso de lectura de nuestra base de datos.

------------------------------------------------------------------------

### Librerías a utilizar:

Para el análisis de los datos y para mostrarlos de manera adecuada utilizaremos las siguientes librerías `readr`, `dplyr`, `knitr`, `kableExtra`, `stringr`, `purrr`, `ggplot2`, `scales` y `tidyr`:

```{r, message=FALSE, warning=FALSE, echo=FALSE}

list_packages <- c("readr", "dplyr","knitr","kableExtra","stringr",
                    "purrr","ggplot2","scales", "tidyr")

new_packages <- list_packages[!(list_packages %in% 
                                      installed.packages()[,"Package"])]

if(length(new_packages)) install.packages(new_packages,
                                             repos='http://cran.us.r-project.org')

```

```{r, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(stringr)
library(purrr)
library(ggplot2)
library(scales)
library(tidyr)
```

### Lectura de datos:

Con la librería `readr` tenemos acceso a la función `read_csv()` la cual usaremos para cargar nuestros datos a la variable `DF`:

```{r message = FALSE, warning = FALSE}
DF <- read_csv("proyecto_estadistica_data.csv", col_names = TRUE,  
               locale = readr::locale(encoding = "UTF-8"))
```

### Limpieza:

En esta sección, nos adentraremos en el proceso de limpieza de variables en nuestro conjunto de datos, con el objetivo de asegurar su calidad y facilitar su manejo. A través de la aplicación de restricciones y el renombrado de variables, buscamos garantizar que los datos sean coherentes, comprensibles y aptos para su posterior análisis.

#### Rename de Variables:

Un paso importante que nos brindara comodidad y mejor accesibilidad a los datos es hacer el `rename` de cada una de ellas como vimos en la tabla ya tenemos definidos sus nuevos nombres, estas son algunas:

```{r}
DF %>% rename(
  Correo = `Escribe tu Correo institucional`, 
  Edad = `¿Cuántos años tienes?`,
  AñoIngreso = `¿En que año ingresaste a la universidad?`,
  Ciclo = `¿En qué ciclo te encuentras?`,
  ModalidadIngreso = `¿Cuál fue tu modalidad de ingreso a la universidad?`,
  BecaFlag = `¿Cuentas con beca?`) -> DF
```

```{r, echo=FALSE}
DF %>% rename(
  EscalaPago = `¿Cuál es tu escala de pago en la universidad?`,
  Ponderado = `¿Cuál es tu promedio ponderado entre los siguientes intervalos?`,
  ColegioUbi = `Provincia del colegio de proveniencia`,
  SatisfaccionDocente = `¿Qué tan satisfecho estuviste con los docentes en tu colegio?`,
  UtilidadCole_Uni = `¿Sientes que tu preparación académica del colegio basta para ingresar a la universidad?`,
  ColegioTipo = `¿En qué tipo de colegio estuviste?`,
  HabBlandasFlag = `¿En el colegio formaste habilidades blandas?`,
  HabBlandas = `Si la respuesta es si, ¿Qué habilidades blandas formaste?`,
  CursosDificiles = `¿Que cursos se te hacían más dificil en el colegio?`,
  UtilidadMate = `En el curso de matemáticas, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  UtilidadLetras = `En los cursos de letras ,como comunicación, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  UtilidadCiencias = `En los cursos de ciencias,como biología, física o química, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  InglesSecFlag = `¿Te enseñaron inglés durante tu educación secundaria?`,
  InglesCertificacion = `¿Cuentas con alguna certificación de inglés?`,
  InglesNivelCole = `Califica tu nivel de inglés del 1 al 10 cuando saliste del colegio`,
  InglesNivelActual = `Califica tu nivel de inglés del 1 al 10 ACTUAL`,
  InglesSituacion = `¿Que situación se adecua más a tu nivel con el inglés?`,
  ColeSeriedad=`Del 1 al 10, ¿Que tan serio te tomabas la secundaria en el colegio?`,
  AcademiaFlag= `¿Estuviste en alguna academia antes de ingresar a la universidad ?`,
  AcademiaRazon = `¿Por qué llevaste una academia adicional?`,
  AcademiaTiempo = `¿Cuánto tiempo estuviste en la academia?`,
  UtilidadAcademia_Uni = `¿Consideras que sirvio para ingresar a la universidad?`,
  AcademiaTipo = `¿En qué tipo de academia estuviste?`,
  AcademiaNombre = `¿En qué academia estuviste?`,
  HorasEstudioUni = `¿Cuantas horas estudias diariamente?`,
  InglesFlag = `¿Estás actualmente en alguna academia o curso de inglés?`,
  HorasEstudioIngles = `¿Cuántas horas le dedicas al inglés semanalmente?`,
  SatisfaccionPrepSec = `Del 1 al 10 que tan satisfecho estás con tu educación secundaria`,
  UtilidadGeneralSec = `En general, ¿Que tanto te ayudo la secundaria en el colegio para la universidad?`
) -> DF
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
provincia = DF$ColegioUbi
provincia = ifelse(provincia != "Lima", "Provincia", "Lima")
DF = cbind(DF, provincia)
observations = nrow(DF)
variables = ncol(DF) - 2
```

#### Limpieza de Datos:

Para empezar con la limpieza nos basaremos en las restricciones que definimos en la tabla vista anteriormente, solo se hará limpieza en las variables donde la respuesta tenia la posibilidad de ser escrita por el encuestado.

##### Variable -\> AcademiaRazon:

Para la limpieza de la variable `AcademiaRazon`, se creó una lista llamada **`opciones_AcademiaRazon`** con opciones predefinidas. Luego, se filtraron las filas que pertenecían a la opción "Otra..." del formulario. Para ello, se utilizó la función **`map_lgl()`** del paquete `plurrr` y la función **`str_split()`** del paquete `stringr` para dividir las respuestas separadas por comas. Se verificó si cada respuesta se encontraba en la lista de opciones y se asignaron aquellas que eran diferentes a la variable **`notCleanAcademiaRazon`**.

```{r, echo=FALSE}
opciones_AcademiaRazon <- c("Para estar mejor preparado en la universidad", "Porque no estuve satisfecho con mi educación secundaria", "Por obligación de padres", "Otro")

notCleanAcademiaRazon <- DF %>%
  filter(!is.na(AcademiaRazon)) %>%
  filter(map_lgl(str_split(AcademiaRazon, ", "), ~ any(!. %in% opciones_AcademiaRazon)))
```

De las respuestas filtradas, se consideró crear una nueva categoría llamada "Otros" para dos de ellas. Además, se identificó un error en una respuesta vacía. Para corregirlo, se utilizó el comando **`ifelse()`** en conjunto con **`grepl()`** para buscar y cambiar las respuestas específicas. Finalmente, se asignaron las respuestas limpias a la variable **`AcademiaRazonClean`**, omitiendo los valores NA.

```{r}
DF$AcademiaRazon <- ifelse(grepl("Me preparaba para ingresar a otra universidad más exigente en admisión.|Ciclero", DF$AcademiaRazon), "Otro", DF$AcademiaRazon)

DF$AcademiaRazon <- ifelse(grepl("Para estar mejor preparado en la universidad, Porque no estuve satisfecho con mi educación secundaria,", DF$AcademiaRazon), "Para estar mejor preparado en la universidad, Porque no estuve satisfecho con mi educación secundaria", DF$AcademiaRazon)
```

##### Variable -\> HabBlandas

```{r}
opciones_hab_blandas <- c("Liderazgo", "Pensamiento crítico", "Trabajo en equipo", "Comunicación acertiva", "Lógica", "Expresarse en público", "Mentalidad abierta", "Otro")

notCleanHabBlandas <- DF %>%
  filter(!is.na(HabBlandas)) %>%
  filter(map_lgl(str_split(HabBlandas, ", "), ~ any(!. %in% opciones_hab_blandas)))

```

Las 2 filas filtradas que obtenemos y almacenamos en la variable `notCleanHabBlandas` son las siguientes:

-   Mentalidad abierta, reflexivo

-   Mente Abierta

En este caso consideramos "Mentalidad abierta/Mente Abierta" las consideramos como "Mentalidad abierta" ambos y reflexivo lo colocaremos como "Otros".

```{r}
DF$HabBlandas <- ifelse(grepl("Pensamiento crítico, Lógica, Mente abierta", DF$HabBlandas), "Pensamiento crítico, Lógica, Mentalidad abierta", DF$HabBlandas)

DF$HabBlandas <- ifelse(grepl("Liderazgo, Pensamiento crítico, Trabajo en equipo, Comunicación acertiva, Lógica, Expresarse en público, Mentalidad abierta, reflexivo", DF$HabBlandas), "Liderazgo, Pensamiento crítico, Trabajo en equipo, Comunicación acertiva, Lógica, Expresarse en público, Mentalidad abierta, Otro", DF$HabBlandas)

HabBlandasClean <- DF$HabBlandas[!is.na(DF$HabBlandas)]
```

##### Variable -\> AcademiaNombre

Para este caso era totalmente respuesta libre del encuestado, lo cual provoca una limpieza mas profunda de la variable, empezaremos colocando en minúsculas todas las observaciones y a su vez quitando todas las variantes de las vocales principalmente las que tienen tilde. Usaremos `tolower` y `iconv`.

```{r}
opciones_academiaNombre <- c("aduni", "cesar vallejo", "cepre uni", "cepre utec", "cepre pucp", "pitagoras", "trilce", "pamer", "cepre cayetano")

DF$AcademiaNombre <- tolower(DF$AcademiaNombre)
DF$AcademiaNombre <- iconv(DF$AcademiaNombre, to="ASCII//TRANSLIT")

notCleanAcademiaNombre <- DF %>% 
  filter(!is.na(AcademiaNombre)) %>% 
  filter(!map_lgl((AcademiaNombre), ~ . %in% opciones_academiaNombre))
```

Vemos como resultado que aun hay algunas respuestas que entran dentro de nuestras opciones pero que fueron escritas diferente. Por lo tanto las modificaremos, para que entre dentro de lo que pre-establecimos, mientras que hay otras respuestas que englobaremos otras academias "sueltas" en el grupo de otros.

```{r}
DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% 
                              c("pre utec", "centro pre utec", "nivelacion utec", 
                                "pre de utec", "pre-utec", "la pre utec"), 
                            "cepre utec", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("ceprepucp", "ceprepuc"), 
                            "cepre pucp", DF$AcademiaNombre)

```

```{r, echo=FALSE}
DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("precayetano", "pre cayetano"), 
                            "cepre cayetano", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("pre uni", "cepre-uni", "cepre uni"), 
                            "cepre uni", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("aduni+"), 
                            "aduni", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("academia cesar vallejo", "vallejo"), 
                            "cesar vallejo", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("cpreuni, catolica"), 
                            c("cepre uni", "cepre pucp"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("pamer catolica"), 
                            c("pamer", "cepre pucp"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("matriz y trilce"), 
                            c("otros", "trilce"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("aduni y cesar vallejo"), 
                            c("aduni", "cesar vallejo"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("eureka", "prisma", "prolog",
                                                     "agroestudio", "profesor particular",
                                                     "de mi propio colegio", "promedio 21",
                                                     "rumbo agraria", "mateagraria", "las eras", 
                                        "lobachevski de pisco y con un profesor independiente.", 
                                                     "exitus", "goldbach", "no recuerdo", "elite",
                                                     "preuniversitaria", "vonex", 
                                                     "preuniversitaria - cursos generales", 
                                                     "no estuve", "la de mi barrio"),
                            "otros", DF$AcademiaNombre)


opciones_academiaNombre <- c("aduni", "cesar vallejo", "cepre uni", "cepre utec", "cepre pucp", "pitagoras", "trilce", "pamer", "cepre cayetano", "otros")

AcademiaNombreClean <- DF$AcademiaNombre[!is.na(DF$AcademiaNombre)]
```

Hacemos esto con cada uno y habremos limpiado correctamente esta variable.

##### Variable -\> HorasEstudioUni

Para hacer la limpieza en esta variable, modificaremos cada respuesta quitando la parte de segundos.

```{r}
DF$HorasEstudioUni <- gsub("^([0-9]{2}:[0-9]{2}).*$", "\\1", DF$HorasEstudioUni)
HorasEstudioUniClean <- ifelse(as.numeric(
  gsub("^([0-9]{2}):[0-9]{2}", "\\1", DF$HorasEstudioUni)) > 12,
  NA, DF$HorasEstudioUni)

HorasEstudioUniClean <- HorasEstudioUniClean[!is.na(HorasEstudioUniClean)]
```

En este caso hemos utilizado expresiones regulares para hacer la limpieza en base a nuestras restricciones, donde descartaríamos las respuestas que afirman estudiar mas de 12 horas diarias.

##### Variable -\> HorasEstudioIngles

```{r}
DF$HorasEstudioIngles <- gsub("^([0-9]{2}:[0-9]{2}).*$", "\\1", DF$HorasEstudioIngles)
HorasEstudioInglesClean <- ifelse(as.numeric(
  gsub("^([0-9]{2}):[0-9]{2}", "\\1", DF$HorasEstudioIngles)) > 24,
  NA, DF$HorasEstudioIngles)

HorasEstudioUniClean <- HorasEstudioUniClean[!is.na(HorasEstudioUniClean)]
```

A diferencia de la anterior variable a la que hicimos limpieza, en este caso limitamos las horas a 24 ya que hablamos semanalmente mientras que en el anterior era diario.

# Descriptores:

En el análisis de datos, los descriptores gráficos son herramientas esenciales para visualizar, explorar y comunicar relaciones y patrones en los datos.

*Nota: Todos los cálculos realizados a lo largo del informe se redondearán a 2 decimales.*

## Media, mediana, moda y desviación estándar de la edad:

```{r}
media_edad <- round(mean(DF$Edad, na.rm = TRUE), digits = 2)
mediana_edad <- round(median(DF$Edad, na.rm = TRUE), digits = 2)
moda_edad <- names(table(DF$Edad)[table(DF$Edad) == max(table(DF$Edad))])
devStd <- round(sd(DF$Edad), digits = 2)
```

```{r, echo=FALSE}
cat("La edad promedio es ", media_edad)
cat("La mediana de la edad es ", mediana_edad)
cat("La moda(s) de la edad es ", moda_edad)
cat("La desviación estándar es ", devStd)
```

El análisis estadístico reveló lo siguiente sobre los descriptores numéricos en la muestra:

-   La edad promedio es de 19.19 años, indicando la edad promedio de las personas en la muestra.

-   La mediana de la edad es de 19 años, lo que sugiere una distribución aproximadamente simétrica sin valores extremos significativos que afecten la mediana.

-   La moda de la edad es de 18 años, lo que indica que es la edad más común en la muestra.

-   La presencia de una única moda sugiere una distribución unimodal, sin una variación significativa en las edades.

-   La desviación estándar de las edades es de 1.72 años, lo que implica que las edades individuales tienden a variar alrededor de 1.72 años con respecto a la media. Una desviación estándar baja indica una distribución más concentrada de las edades.

En resumen, la muestra presenta una edad promedio de alrededor de 19 años, una distribución aproximadamente simétrica sin valores extremos significativos y una concentración de personas de 18 años como la edad más común.

## Procedencia geográfica del colegio de los encuestados:

Para mostrar los datos en esta ocasión, vamos a separar entre los estudiantes provenientes de colegios fuera de Lima y los que provienen de Lima. Esto con el objetivo de notar la variedad que encontraremos en la muestra.

```{r, echo=FALSE}
df_lima <- data.frame(
  Provincia = names(table(DF[DF$ColegioUbi == "Lima", 11])),
  Frecuencia = as.numeric(table(DF[DF$ColegioUbi == "Lima", 11]))                   
) 

df_otras_provincias <- data.frame(
  Provincia = names(table(DF[DF$ColegioUbi != "Lima", 11])),
  Frecuencia = as.numeric(table(DF[DF$ColegioUbi != "Lima", 11]))
)
```

### Diagrama de Barras (Excluyendo Lima):

```{r, echo=FALSE}
ggplot(df_otras_provincias, aes(x = Provincia, y = Frecuencia, fill = Provincia)) +
  geom_bar(stat = "identity", color = "white") +
  geom_text(aes(label = Frecuencia), position = position_stack(vjust = 0.5)) +
  labs(x = "Provincias", title = "Procedencia geográfica del colegio de los encuestados") +
  theme(axis.text.x = element_blank(), plot.title = element_text(margin = margin(b = 25)))

```

### Cantidad de estudiantes en Lima:

```{r, echo=FALSE}
ggplot(df_lima, aes(x = "", y = Frecuencia, fill = Provincia)) +
  geom_bar(stat = "identity", color = "white") +
  geom_text(aes(label = Frecuencia), position = position_stack(vjust = 0.5)) +
  geom_bar(
    data = df_lima, aes(x = "", y = Frecuencia), stat = "identity", color = "white"
          ) +
  geom_text(data = df_lima, aes(label = Frecuencia), 
            position = position_stack(vjust = 0.5)) + 
   labs(x = "Lima", title = "Cantidad de estudiantes que provienen de colegios en Lima")+
  theme(axis.text.x = element_blank(), plot.title = element_text(margin = margin(b = 15)))
```

El análisis de los datos revela que de la muestra de estudiantes, 131 son de Lima y 50 son de provincia. Esta distribución geográfica refleja la ubicación de UTEC en la capital peruana y su mayor atracción para los estudiantes locales.

La proporción relativa muestra que el 73% de los estudiantes son de Lima, mientras que el 27% son de provincia. Es importante considerar que esta proporción puede estar sesgada debido a la ubicación de la institución. Además, es relevante tener en cuenta que existen diferencias en las experiencias educativas y niveles de preparación escolar entre las diferentes regiones del país. La moda de los estudiantes de provincia se encuentra en Ica, con 7 estudiantes en la muestra. Aunque UTEC está ubicada en Lima, la cantidad de estudiantes de provincia en la muestra, que es de 44, es significativa y puede estar relacionada con el programa de captación de talento descentralizado de la universidad.

## Encuestados que llevaron, o no, academia con respecto al grado de utilidad del colegio:

```{r, echo=FALSE}
ggplot(DF) +
 aes(x = UtilidadCole_Uni, fill = AcademiaFlag) +
 geom_density(adjust = 1L) +
 scale_fill_manual(values = c(No = "#E73030", 
Sí = "#1EE4F3")) +
 theme_minimal() +
 theme(legend.position = "top")+
  labs(title = "Encuestados que llevaron, o no, academia con respecto al grado de utilidad del colegio", x = "Grado de utilidad \n(1 = No me ayudo en nada; 5 = Me ayudo mucho)", y = "Densidad\n", fill = "Llevaron academia")
```

En el estudio del nivel de preparación escolar de los estudiantes de UTEC en el periodo 2023-1, se utilizó un gráfico de densidad para analizar la utilidad percibida del colegio en relación a si llevaron educación complementaria previa a la universidad. El gráfico muestra una distribución suave en el eje horizontal, donde 0 representa la utilidad más baja y 5 la más alta.

El análisis del gráfico revela lo siguiente:

-   Forma de la distribución: Los estudiantes que llevaron academia se concentran en un grado de utilidad de 3, mientras que aquellos que no la llevaron se concentran en un grado de utilidad de 4. Esto indica una diferencia en la percepción de utilidad del colegio según la necesidad de educación complementaria.

-   Superposición de las distribuciones: Al superponer los gráficos de densidad de ambos grupos, se puede comparar la distribución entre los estudiantes que llevaron educación complementaria y los que no. Esto muestra una diferencia en el grado de utilidad del colegio entre los dos grupos, relacionada con la necesidad de educación adicional.

-   Áreas bajo la curva: Las áreas bajo las curvas de densidad representan la proporción relativa de estudiantes en diferentes niveles de utilidad asignados a sus colegios. Esto permite comparar las distribuciones de datos de manera suave y continua, facilitando la identificación de patrones y diferencias en la percepción de utilidad del colegio entre los dos grupos de estudiantes de UTEC.

## Grado de utilidad del colegio para la Universidad respecto al tipo de colegio (Publico o Privado):

```{r, echo=FALSE}
ggplot(DF) +
  aes(x = ColegioTipo, y = UtilidadCole_Uni) +
  geom_boxplot(fill = "#F4DC82") +
  labs(
    x = "Tipo de Colegio",
    y = "Grado de Utilidad del colegio para la universidad\n\n (1 = Nada Util; 5 = Muy Util)\n",
    title = "Grado de utilidad del colegio para la Universidad respecto al tipo de colegio"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12L,
    face = "bold",
    hjust = 0.5),
    axis.title.y = element_text(size = 10L),
    axis.title.x = element_text(size = 12L)
  )
```

El gráfico de boxplot compara el nivel de satisfacción secundaria entre dos grupos: "Colegios Públicos" y "Colegios Privados". La mediana representa la utilidad percibida del colegio para cada grupo. Se observa que los estudiantes de colegios privados perciben mayor utilidad que los de colegios públicos. El rango intercuartílico muestra la variabilidad en el grado de utilidad, siendo mayor en colegios privados. No se presentan valores atípicos. Este análisis permite visualizar y comparar las distribuciones de manera efectiva, determinando diferencias significativas en el grado de utilidad entre estudiantes de colegios públicos y privados en UTEC. Esto es relevante para comprender cómo la naturaleza del colegio influye en la percepción de utilidad y el nivel de preparación escolar secundaria.

## Satisfacción de la educación secundaria según la ubicación del colegio de proveniencia:

```{r, echo=FALSE}
ggplot(DF) +
  aes(x = provincia, y = SatisfaccionPrepSec) +
  geom_boxplot(fill = "#ED5615") +
  labs(
    x = "Lugar de Proveniencia",
    y = "Satisfacción de la Preparación secundaria\n\n (1 = Nada Satisfecho; 5 = Muy Satisfecho)\n",
    title = "Satisfacción de la educación secundaria respecto a Lugar de Proveniencia"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust = 0.5),
    axis.title.y = element_text(size = 10L),
    axis.title.x = element_text(size = 13L)
  ) +
  scale_y_continuous(breaks = seq(min(DF$SatisfaccionPrepSec), max(DF$SatisfaccionPrepSec), by = 1))
```

El gráfico de boxplot compara el nivel de satisfacción secundaria entre dos grupos: "Lima" y "Provincia". La mediana representa el nivel de satisfacción secundaria para cada grupo. No se observan diferencias significativas en el nivel de satisfacción entre los estudiantes de Lima y provincia, ya que ambas medianas son iguales a 7. El rango intercuartílico muestra la variabilidad en el nivel de satisfacción dentro de cada grupo. En Lima, la variabilidad está entre 6 y 8, mientras que en provincia está entre 5 y 8. Se identifican 2 valores atípicos en la muestra de Lima, pero ninguno en provincia. Este análisis, utilizando un gráfico de boxplot, permite visualizar y comparar las distribuciones de manera efectiva, y determinar si hay diferencias significativas en el nivel de satisfacción secundaria entre estudiantes de Lima y provincia en UTEC. La comparación se basa en la mediana y en la variabilidad dentro de cada grupo, lo que proporciona una visión clara y concisa de las diferencias o similitudes en el nivel de satisfacción secundaria.

## Tiempo de preparación que llevaron los estudiantes en la academia:

```{r, echo=FALSE}
AcademyTiempoFrecuency <- data.frame(
  AcademiaTiempo = names(table(DF$AcademiaTiempo)),
  Frecuencia = as.numeric( table(DF$AcademiaTiempo))
)

ggplot(AcademyTiempoFrecuency, aes(x="", y=Frecuencia, fill=AcademiaTiempo))+
  geom_bar(stat = "identity",
           color="white")+
    geom_text(aes(label=percent(Frecuencia/sum(Frecuencia))),
              position=position_stack(vjust=0.5),color="white",size=3)+
  coord_polar(theta = "y")+
    theme_bw() +
    theme(plot.title = element_text(size = 13L,
      face = "bold",
      hjust = 0.5)) +
    labs(title="Tiempo de preparación en academia", fill = "Tiempo en academia", x = "", y = "")
```

Se puede apreciar que el rango de estancia en academia más grande en porcentaje es de 1-3 meses con un 36.3%. Por otro lado, el rango con mejor porcentaje es de menos de 1 mes con 2.2%. Según la gráfica, en porcentaje de la muestra total, los estudiantes que estuvieron en una academia entre 3 a más de 12 meses son el 61.6%. Esto nos puede indicar que los estudiantes que necesitaban una academia, se inscribieron por un largo periodo de tiempo, ya que, probablemente, necesitaban más tiempo para nivelar su educación e ingresar a la universidad.

## Nivel de ingles Actual respecto al nivel al salir del colegio:

```{r, message=FALSE, echo=FALSE}
ggplot(DF) +
  aes(x = InglesNivelCole, y = InglesNivelActual) +
  geom_jitter(size = 1.5) +
  geom_smooth(method = "lm", se = FALSE, color = "#6CF585") +
  labs(title = 
         "Nivel de Ingles Actual respecto al Nivel al salir del colegio", 
       x = "Nivel al salir del colegio",
       y = "Nivel Actual\n\n (1 = Muy Bajo; 10 = Excelente)") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(min(DF$InglesNivelActual), max(DF$InglesNivelActual), by = 1)) +
  scale_x_continuous(breaks = seq(min(DF$InglesNivelCole), max(DF$InglesNivelCole), by = 1))
```

En la gráfica de dispersión, el eje horizontal representará el nivel de educación al salir del colegio y el eje vertical representará el nivel de inglés actual de los estudiantes (ambos van del grado del 1, más bajo, al 10, más alto). El análisis de la gráfica de dispersión puede proporcionar la siguiente información:

Tendencia general: Al observar la dispersión de los puntos en la gráfica, se puede identificar que los puntos han tendido a agruparse en una tendencia de dirección ascendente. Esto nos indicaría una relación positiva entre el nivel de educación y el nivel de inglés. Es decir, a medida que aumenta el nivel de educación, tiende a aumentar también el nivel de inglés.

Variabilidad: La dispersión de los puntos nos indica la variabilidad de la relación. En nuestro caso, están dispersos, lo que puede sugerir que el nivel de educación no tiene una influencia directa o fuerte en el nivel de inglés, o que hay otros factores que afectan la habilidad del estudiante para aprender el idioma.

Valores atípicos: Los datos atípicos, puntos que se desvían significativamente de la tendencia general, son pocos (5 de 181); por lo que no se considera que sea significativo para el análisis.

## Los cursos en los que los estudiantes presentan mayor dificultad en el colegio:

```{r, echo=FALSE}
# Crear una nueva columna para almacenar los cursos separados
DF_cd = DF
DF_cd <- DF_cd %>%
  mutate(CursosDificiles = strsplit(CursosDificiles, ", "))

# Expandir los elementos individuales en filas separadas
DF_cd <- DF_cd %>%
  unnest(CursosDificiles)

# Calcular las frecuencias de los cursos
frecuencias <- DF_cd %>%
  count(CursosDificiles, name = "Frecuencia")

names(frecuencias) = c("Cursos", "Frecuencia")
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Ciencias sociales (Historia)", "CCSS", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Ciudanadía y Cívica", "Civica", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Desarrollo Personal", "Des. Per", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Comunicación", "Com.", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Matemática", "Mat.", frecuencias$Cursos)

frecuencias %>%
 filter(Frecuencia >= 20L & Frecuencia <= 70L) %>%
 ggplot() +
  aes(x = Cursos, fill = Frecuencia) +
  labs(title = "Cursos con Mayor dificultad en el colegio", y = "") +
  geom_bar() +
  scale_fill_gradient(low = "#FFEF80", high = "#FF5700") +
  theme_minimal()
```

## Cursos en los cuales los estudiantes tienen preferencia en prepararse en una academia:

```{r, echo=FALSE}
# Crear una nueva columna para almacenar los cursos separados
DF_at = DF[!is.na(DF$AcademiaTipo), ]
DF_at <- DF_at %>%
  mutate(AcademiaTipo = strsplit(AcademiaTipo, ", "))

# Expandir los elementos individuales en filas separadas
DF_at <- DF_at %>%
  unnest(AcademiaTipo)

# Calcular las frecuencias de los cursos
frecuencias_at <- DF_at %>%
  count(AcademiaTipo, name = "Frecuencia")

names(frecuencias_at) = c("Cursos", "Frecuencia")

frecuencias_at %>%
 filter(Frecuencia >= 10L & Frecuencia <= 80L) %>%
 ggplot() +
  aes(x = Cursos, fill = Frecuencia) +
  labs(title = "Cursos del cual se llevo Academia", y = "") +
  geom_bar() +
  scale_fill_gradient(low = "#FFEF80", high = "#FF5700") +
  theme_minimal()
```

En este gráfico, como se detalla en la leyenda, se resalta con mayor intensidad los cursos que han presentado un mayor grado de dificultad en el colegio para los estudiantes. Se utiliza un color naranja intenso cuando existe una mayor frecuencia en ellos, mientras que se utiliza un color amarillo pastel cuando la frecuencia es baja. Estas frecuencias oscilan entre 20 y 52. Se puede apreciar claramente que hay un grupo de cursos que han presentado grandes dificultades, como CCSS (Historia), Com. (Comunicación), Biología y Desarrollo Personal, entre otros.

Sin embargo, se obtiene una contradicción con respecto a los estudiantes que asistieron a academias, ya que se observa que la mayoría de ellos eligió una academia especializada en matemáticas, física o química.

## Promedio ponderado respecto a la seriedad con la que los estudiantes se tomaban el colegio:

```{r, echo=FALSE}
DF$Ponderado = ifelse(DF$Ponderado == "menos de 11", "11 a 0", DF$Ponderado)

ggplot(DF) +
  aes(x = ColeSeriedad, y = Ponderado)+
  geom_boxplot(fill = "#EFCE2D") +
  labs(title = "Promedio ponderado respecto a la seriedad en el colegio", x = "Seriedad con la que se tomaban el colegio", y = "Promedio ponderado") +
  scale_x_continuous(breaks = seq(min(DF$ColeSeriedad), max(DF$ColeSeriedad), by = 1)) +
  theme_minimal()
```

Podemos ver que se ha generado un gráfico boxplot por cada promedio ponderado. Con ello, se puede apreciar que, en el caso del promedio más bajo (0-11) la mediana es de 5 de seriedad con la que se tomaban el colegio y el rango intercuartílico es de 5 a 6. Para el promedio más alto (más de 18), la mediana es de 9.5 de seriedad y el rango intercuartílico es de 8 a 10. Esto nos muestra una clara tendencia de aumento del promedio ponderado cuando un estudiante se toma más en serio sus estudios secundarios en su colegio. Sin embargo, es importante resaltar que no es definitiva que la relación sea una verdad absoluta, porque el término "seriedad en el colegio" puede ser interpretado diferente por cada estudiante y eso cambiará la perspectiva del análisis.

## Promedio ponderado según lugar de proveniencia:

### Promedio ponderado de los estudiantes provenientes de provincia:

```{r, message=FALSE, echo=FALSE}

DF$Ponderado = factor(DF$Ponderado)

DF %>%
 filter(provincia %in% "Provincia") %>%
 ggplot() +
  aes(x = provincia, fill = Ponderado) +
  geom_bar(position = "dodge") +
  scale_fill_hue(direction = 1) +
  scale_x_discrete(breaks = levels(DF$Ponderado)) +
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    x = "Ubicación",
    y = "Frecuencia\n",
    title = "Promedio ponderado de los estudiantes provenientes de provincia\n",
    fill = "Leyenda"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust=0.5)) +
  scale_fill_manual(values = c("11 a 13" = "#b79f00", "14 a 15" = "#00ba38", 
                               "16 a 17" = "#00bfc4", "17 a 18" = "#619cff", 
                               "más de 18" = "#f564e3"))

```

### Promedio ponderado de los estudiantes provenientes de la Capital:

```{r, echo=FALSE}
DF %>%
 filter(provincia %in% "Lima") %>%
 ggplot() +
  aes(x = provincia, fill = Ponderado) +
  geom_bar(position = "dodge") +
  scale_fill_hue(direction = 1) +
  labs(
    x = "Ubicación",
    y = "Frecuencia",
    title = "Promedio ponderado de los estudiantes provenientes de la capital\n",
    fill = "Leyenda"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust=0.5))
```

En base a estas dos gráficas, podemos observar los promedios ponderados en relación al colegio de procedencia. Notamos que existe una moda en el caso de las provincias, donde los promedios ponderados se encuentran principalmente en el rango de 14 a 15, seguidos por el intervalo de 16 a 17, y en tercer lugar el rango de 11 a 13. Hay muy pocos estudiantes con promedios entre 17 y 20.

En contraste, los estudiantes que estudiaron en la capital muestran una moda en el intervalo de 14 a 15, seguido por el rango de 16 a 17, y en tercer lugar el intervalo de 11 a 13. Esta comparación sugiere que los estudiantes de Lima tienen una mejor educación o una mayor preparación en comparación con los estudiantes provenientes de provincias. Esto podría ser una consecuencia de la centralización de la inversión estatal en educación, donde a menudo se descuida la educación fuera de la capital. Sin duda, esto es algo que debería corregirse.
