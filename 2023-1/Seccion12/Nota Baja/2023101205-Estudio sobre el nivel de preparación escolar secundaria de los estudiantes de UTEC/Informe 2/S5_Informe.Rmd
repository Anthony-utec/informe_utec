---
title: "Estudio sobre el nivel de preparación escolar secundaria de los estudiantes de UTEC inscritos en el periodo 2023-1"
format: 
  html:
    theme: cyborg
    toc: true
    toc-depth: 4
    number-sections: true
    
editor: visual
---

# Introducción:

------------------------------------------------------------------------

## Relevancia:

El estudio nos permitirá obtener información valiosa acerca del nivel de preparación que tienen los estudiantes antes de ingresar a la universidad, y cómo esto puede estar relacionado con su desempeño académico en la institución. Además, el proyecto también analizará la relación entre el colegio de procedencia y el éxito académico de los estudiantes en UTEC.

Este estudio será de gran ayuda ya que permitirá conocer las fortalezas y debilidades de los estudiantes en cuanto a su preparación escolar, y en base a ello se podrán diseñar estrategias pedagógicas que ayuden a mejorar el desempeño académico de los estudiantes en la universidad.

## Objetivos:

-   ***Relacionar*** el nivel académico de la preparación escolar secundaria con el desempeño académico, la seriedad con la que se tomaba el colegio y tipo de colegio del estudiante de UTEC.

-   ***Analizar*** la información sobre el nivel de preparación escolar secundaria, satisfacción, utilidad y nivel de ingles que tuvieron los estudiantes de UTEC de ciclo 2023-1.

-   ***Determinar*** la relación que existe entre el colegio de procedencia, preparación, satisfacción y utilidad del colegio con el éxito académico de los estudiantes de UTEC.

## Contexto:

Para estudiar el tema propuesto, se encuestó a estudiantes de UTEC del ciclo 2023-1 mediante preguntas para marcar. Se realizaron preguntas clave con referencia a nuestros objetivos de investigación. Para analizar dichos datos, aplicamos los conocimientos adquiridos en el manejo de datos con R mediante descriptores numéricos y gráficos. Así pudimos analizarlos y relacionarlos entre sí.

## Población, Muestra y Muestreo:

Tenemos 181 observaciones y 36 variables.

1.  ***Población de estudio:*** Alumnos de la Universidad de Ingeniería y Tecnología que se encuentran en el periodo 2023-1.
2.  ***Unidad Muestral:*** Alumnos de diferentes ciclos de UTEC.
3.  ***Tamaño de Muestra:*** 181 estudiantes inscritos en el periodo 2023-1.
4.  ***Tipo de Muestreo:*** Muestreo por conveniencia, no probabilístico.

## Variables:

|                                        Variables                                        |       Tipos        |                                          Restricciones                                           |        Rename        |
|:----------------:|:----------------:|:-----------------:|:----------------:|
|                                         Género                                          | Categórica Nominal |      Solo existen dos opciones hombre o mujer, debido a que es la que se indica en el DNI.       |        Genero        |
|                            Tipo del Colegio de Proveniencia                             | Categórica Nominal |                   Las opciones están limitadas por privado, público y militar                    |     ColegioTipo      |
|                          Ubicación del Colegio de Proveniencia                          | Categórica Nominal |                               Limitadas a las provincias del Perú                                |      ColegioUbi      |
|            ¿Estuviste en alguna academia antes de ingresar a la universidad?            | Categórica Nominal |                                    Solo respuestas de Si o No                                    |     AcademiaFlag     |
|                      ¿Formaste habilidades blandas en el colegio?                       | Categórica Nominal |                                    Solo respuestas de Si o No                                    |    HabBlandasFlag    |
|                           ¿En qué tipo de academia estuviste?                           | Categórica Nominal |  Las opciones están limitadas a cursos que se llevaron en la academia junto con la opción otros  |     AcademiaTipo     |
|                 ¿Qué situación se adecua más a tu nivel con el inglés?                  | Categórica Nominal |                      Solo respuestas de situaciones planteadas por nosotros                      |   InglesSituacion    |
|                          ¿Cursos más difíciles en el colegio?                           | Categórica Nominal | Listado de cursos obligatorios según MINEDU pero limitados a los cursos que queremos dar énfasis |   CursosDificiles    |
|                          Nivel de inglés al salir del colegio                           | Categórica Ordinal |                        Números del 1 al 10 donde 1 es malo y 10 es bueno                         |   InglesNivelCole    |
|                                    Nivel del colegio                                    | Categórica Ordinal |                        Números del 1 al 10 donde 1 es malo y 10 es bueno                         |     NivelColegio     |
|                   Nivel de utilidad de preparación general secundaria                   | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inútil y 5 útil                             |  UtilidadGeneralSec  |
|                     Nivel de utilidad de preparación en matemáticas                     | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inútil y 5 útil                             |     UtilidadMate     |
|                       Nivel de utilidad de preparación en letras                        | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inútil y 5 útil                             |    UtilidadLetras    |
|                        Promedio ponderado actual (en intervalos)                        | Categórica Ordinal |                                      En intervalos de notas                                      |      Ponderado       |
|                      Nivel de utilidad de preparación en ciencias                       | Categórica Ordinal |                            Escala del 1 al 5 donde 1 inútil y 5 útil                             |   UtilidadCiencias   |
|                        ¿Qué tan en serio te tomabas el colegio?                         | Categórica Ordinal |                       Escala del 1 al 10 donde 1 nada serio y 10 muy serio                       |     ColeSeriedad     |
|                                Horas de estudio diarias                                 | Numérica Continua  |                En formato de Hora:Minutos y que las horas no excedan las 12 horas                |   HorasEstudioUni    |
|                      Horas de estudio de algún idioma semanalmente                      | Numérica Continua  |                En formato de Hora:Minutos y que las horas no excedan las 48 horas                |  HoraEstudioIngles   |
|                   Nivel de Satisfacción con la Preparación Secundaria                   | Numérica Discreta  |                      Escala del 1 al 5 donde 1 insatisfecho y 5 satisfecho                       | SatisfaccionPrepSec  |
|                     Nivel de satisfacción docente en la secundaria                      | Numérica Discreta  |                      Escala del 1 al 5 donde 1 insatisfecho y 5 satisfecho                       | SatisfaccionDocente  |
|                 ¿Consideras qué sirvió para ingresar a la universidad?                  | Numérica Discreta  |           Escala del 1 al 5 donde 1 Totalmente en desacuerdo y 5 Totalmente de acuerdo           | UtilidadAcademia_Uni |
| ¿Sientes que tu preparación académica del colegio basta para ingresar a la universidad? | Numérica Discreta  |           Escala del 1 al 5 donde 1 Totalmente en desacuerdo y 5 Totalmente de acuerdo           |     PrepCole_Uni     |

```{r, message=FALSE, warning=FALSE, echo=FALSE}

list_packages <- c("readr", "dplyr","knitr","kableExtra","stringr",
                    "purrr","ggplot2","scales", "tidyr")

new_packages <- list_packages[!(list_packages %in% 
                                      installed.packages()[,"Package"])]

if(length(new_packages)) install.packages(new_packages,
                                             repos='http://cran.us.r-project.org')

```

```{r, echo=FALSE,message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(knitr)
library(kableExtra)
library(stringr)
library(purrr)
library(ggplot2)
library(scales)
library(tidyr)
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF <- read_csv("proyecto_estadistica_data_1.csv", col_names = TRUE,  
               locale = readr::locale(encoding = "UTF-8"))
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF %>% rename(
  Correo = `Escribe tu Correo institucional`, 
  Edad = `¿Cuántos años tienes?`,
  AñoIngreso = `¿En que año ingresaste a la universidad?`,
  Ciclo = `¿En qué ciclo te encuentras?`,
  ModalidadIngreso = `¿Cuál fue tu modalidad de ingreso a la universidad?`,
  BecaFlag = `¿Cuentas con beca?`) -> DF
```

```{r, echo=FALSE,message=FALSE, warning=FALSE}
DF %>% rename(
  EscalaPago = `¿Cuál es tu escala de pago en la universidad?`,
  Ponderado = `¿Cuál es tu promedio ponderado entre los siguientes intervalos?`,
  ColegioUbi = `Provincia del colegio de proveniencia`,
  SatisfaccionDocente = `¿Qué tan satisfecho estuviste con los docentes en tu colegio?`,
  UtilidadCole_Uni = `¿Sientes que tu preparación académica del colegio basta para ingresar a la universidad?`,
  ColegioTipo = `¿En qué tipo de colegio estuviste?`,
  HabBlandasFlag = `¿En el colegio formaste habilidades blandas?`,
  HabBlandas = `Si la respuesta es si, ¿Qué habilidades blandas formaste?`,
  CursosDificiles = `¿Que cursos se te hacían más dificil en el colegio?`,
  UtilidadMate = `En el curso de matemáticas, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  UtilidadLetras = `En los cursos de letras ,como comunicación, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  UtilidadCiencias = `En los cursos de ciencias,como biología, física o química, ¿Que tanto te ayudo lo enseñado en el colegio para la universidad?`,
  InglesSecFlag = `¿Te enseñaron inglés durante tu educación secundaria?`,
  InglesCertificacion = `¿Cuentas con alguna certificación de inglés?`,
  InglesNivelCole = `Califica tu nivel de inglés del 1 al 10 cuando saliste del colegio`,
  NivelColegio = `Califica el nivel de tu colegio del 1 al 10`,
  InglesSituacion = `¿Que situación se adecua más a tu nivel con el inglés?`,
  ColeSeriedad=`Del 1 al 10, ¿Que tan serio te tomabas la secundaria en el colegio?`,
  AcademiaFlag= `¿Estuviste en alguna academia antes de ingresar a la universidad ?`,
  AcademiaRazon = `¿Por qué llevaste una academia adicional?`,
  AcademiaTiempo = `¿Cuánto tiempo estuviste en la academia?`,
  UtilidadAcademia_Uni = `¿Consideras que sirvio para ingresar a la universidad?`,
  AcademiaTipo = `¿En qué tipo de academia estuviste?`,
  AcademiaNombre = `¿En qué academia estuviste?`,
  HorasEstudioUni = `¿Cuantas horas estudias diariamente?`,
  InglesFlag = `¿Estás actualmente en alguna academia o curso de inglés?`,
  HorasEstudioIngles = `¿Cuántas horas le dedicas al inglés semanalmente?`,
  SatisfaccionPrepSec = `Del 1 al 10 que tan satisfecho estás con tu educación secundaria`,
  UtilidadGeneralSec = `En general, ¿Que tanto te ayudo la secundaria en el colegio para la universidad?`
) -> DF
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
provincia = DF$ColegioUbi
provincia = ifelse(provincia != "Lima", "Provincia", "Lima")
DF = cbind(DF, provincia)
observations = nrow(DF)
variables = ncol(DF) - 2
```

```{r, echo=FALSE}
opciones_AcademiaRazon <- c("Para estar mejor preparado en la universidad", "Porque no estuve satisfecho con mi educación secundaria", "Por obligación de padres", "Otro")

notCleanAcademiaRazon <- DF %>%
  filter(!is.na(AcademiaRazon)) %>%
  filter(map_lgl(str_split(AcademiaRazon, ", "), ~ any(!. %in% opciones_AcademiaRazon)))
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF$AcademiaRazon <- ifelse(grepl("Me preparaba para ingresar a otra universidad más exigente en admisión.|Ciclero", DF$AcademiaRazon), "Otro", DF$AcademiaRazon)

DF$AcademiaRazon <- ifelse(grepl("Para estar mejor preparado en la universidad, Porque no estuve satisfecho con mi educación secundaria,", DF$AcademiaRazon), "Para estar mejor preparado en la universidad, Porque no estuve satisfecho con mi educación secundaria", DF$AcademiaRazon)
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
opciones_hab_blandas <- c("Liderazgo", "Pensamiento crítico", "Trabajo en equipo", "Comunicación acertiva", "Lógica", "Expresarse en público", "Mentalidad abierta", "Otro")

notCleanHabBlandas <- DF %>%
  filter(!is.na(HabBlandas)) %>%
  filter(map_lgl(str_split(HabBlandas, ", "), ~ any(!. %in% opciones_hab_blandas)))

```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF$HabBlandas <- ifelse(grepl("Pensamiento crítico, Lógica, Mente abierta", DF$HabBlandas), "Pensamiento crítico, Lógica, Mentalidad abierta", DF$HabBlandas)

DF$HabBlandas <- ifelse(grepl("Liderazgo, Pensamiento crítico, Trabajo en equipo, Comunicación acertiva, Lógica, Expresarse en público, Mentalidad abierta, reflexivo", DF$HabBlandas), "Liderazgo, Pensamiento crítico, Trabajo en equipo, Comunicación acertiva, Lógica, Expresarse en público, Mentalidad abierta, Otro", DF$HabBlandas)

HabBlandasClean <- DF$HabBlandas[!is.na(DF$HabBlandas)]
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
opciones_academiaNombre <- c("aduni", "cesar vallejo", "cepre uni", "cepre utec", "cepre pucp", "pitagoras", "trilce", "pamer", "cepre cayetano")

DF$AcademiaNombre <- tolower(DF$AcademiaNombre)
DF$AcademiaNombre <- iconv(DF$AcademiaNombre, to="ASCII//TRANSLIT")

notCleanAcademiaNombre <- DF %>% 
  filter(!is.na(AcademiaNombre)) %>% 
  filter(!map_lgl((AcademiaNombre), ~ . %in% opciones_academiaNombre))
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% 
                              c("pre utec", "centro pre utec", "nivelacion utec", 
                                "pre de utec", "pre-utec", "la pre utec"), 
                            "cepre utec", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("ceprepucp", "ceprepuc"), 
                            "cepre pucp", DF$AcademiaNombre)

```

```{r, echo=FALSE}
DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("precayetano", "pre cayetano"), 
                            "cepre cayetano", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("pre uni", "cepre-uni", "cepre uni"), 
                            "cepre uni", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("aduni+"), 
                            "aduni", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("academia cesar vallejo", "vallejo"), 
                            "cesar vallejo", DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("cpreuni, catolica"), 
                            c("cepre uni", "cepre pucp"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("pamer catolica"), 
                            c("pamer", "cepre pucp"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("matriz y trilce"), 
                            c("otros", "trilce"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("aduni y cesar vallejo"), 
                            c("aduni", "cesar vallejo"), DF$AcademiaNombre)

DF$AcademiaNombre <- ifelse(DF$AcademiaNombre %in% c("eureka", "prisma", "prolog",
                                                     "agroestudio", "profesor particular",
                                                     "de mi propio colegio", "promedio 21",
                                                     "rumbo agraria", "mateagraria", "las eras", 
                                        "lobachevski de pisco y con un profesor independiente.", 
                                                     "exitus", "goldbach", "no recuerdo", "elite",
                                                     "preuniversitaria", "vonex", 
                                                     "preuniversitaria - cursos generales", 
                                                     "no estuve", "la de mi barrio"),
                            "otros", DF$AcademiaNombre)


opciones_academiaNombre <- c("aduni", "cesar vallejo", "cepre uni", "cepre utec", "cepre pucp", "pitagoras", "trilce", "pamer", "cepre cayetano", "otros")

AcademiaNombreClean <- DF$AcademiaNombre[!is.na(DF$AcademiaNombre)]
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF$HorasEstudioUni <- gsub("^([0-9]{2}:[0-9]{2}).*$", "\\1", DF$HorasEstudioUni)
HorasEstudioUniClean <- ifelse(as.numeric(
  gsub("^([0-9]{2}):[0-9]{2}", "\\1", DF$HorasEstudioUni)) > 12,
  NA, DF$HorasEstudioUni)

HorasEstudioUniClean <- HorasEstudioUniClean[!is.na(HorasEstudioUniClean)]
```

```{r echo=FALSE,message=FALSE, warning=FALSE}
DF$HorasEstudioIngles <- gsub("^([0-9]{2}:[0-9]{2}).*$", "\\1", DF$HorasEstudioIngles)
HorasEstudioInglesClean <- ifelse(as.numeric(
  gsub("^([0-9]{2}):[0-9]{2}", "\\1", DF$HorasEstudioIngles)) > 24,
  NA, DF$HorasEstudioIngles)

HorasEstudioUniClean <- HorasEstudioUniClean[!is.na(HorasEstudioUniClean)]
```

# Análisis descriptivo:

En el análisis de datos, los descriptores gráficos son herramientas esenciales para visualizar, explorar y comunicar relaciones y patrones en los datos.

*Nota: Todos los cálculos realizados a lo largo del informe se redondearán a 2 decimales.*

## Media, mediana, moda y desviación estándar de la edad:

```{r}
media_edad <- round(mean(DF$Edad, na.rm = TRUE), digits = 2)
mediana_edad <- round(median(DF$Edad, na.rm = TRUE), digits = 2)
moda_edad <- names(table(DF$Edad)[table(DF$Edad) == max(table(DF$Edad))])
devStd <- round(sd(DF$Edad), digits = 2)
```

```{r, echo=FALSE}
cat("La edad promedio es ", media_edad)
cat("La mediana de la edad es ", mediana_edad)
cat("La moda(s) de la edad es ", moda_edad)
cat("La desviación estándar es ", devStd)
```

El análisis estadístico reveló lo siguiente sobre los descriptores numéricos en la muestra:

-   La edad promedio es de 19.19 años, indicando la edad promedio de las personas en la muestra.

-   La mediana de la edad es de 19 años, lo que sugiere una distribución aproximadamente simétrica sin valores extremos significativos que afecten la mediana.

-   La moda de la edad es de 18 años, lo que indica que es la edad más común en la muestra.

-   La presencia de una única moda sugiere una distribución unimodal, sin una variación significativa en las edades.

-   La desviación estándar de las edades es de 1.72 años, lo que implica que las edades individuales tienden a variar alrededor de 1.72 años con respecto a la media. Una desviación estándar baja indica una distribución más concentrada de las edades.

## Procedencia geográfica del colegio de los encuestados:

Vamos a separar entre los estudiantes provenientes de colegios fuera de Lima y los que provienen de Lima. Esto con el objetivo de notar la variedad que encontraremos en la muestra.

```{r, echo=FALSE}
df_lima <- data.frame(
  Provincia = names(table(DF[DF$ColegioUbi == "Lima", 11])),
  Frecuencia = as.numeric(table(DF[DF$ColegioUbi == "Lima", 11]))                   
) 

df_otras_provincias <- data.frame(
  Provincia = names(table(DF[DF$ColegioUbi != "Lima", 11])),
  Frecuencia = as.numeric(table(DF[DF$ColegioUbi != "Lima", 11]))
)
```

### Diagrama de Barras (Excluyendo Lima):

```{r, echo=FALSE}
ggplot(df_otras_provincias, aes(x = Provincia, y = Frecuencia, fill = Provincia)) +
  geom_bar(stat = "identity", color = "white") +
  geom_text(aes(label = Frecuencia), position = position_stack(vjust = 0.5)) +
  labs(x = "Provincias", title = "Procedencia geográfica del colegio de los encuestados") +
  theme(axis.text.x = element_blank(), plot.title = element_text(margin = margin(b = 25)))

```

El análisis de los datos revela que de la muestra de estudiantes, 131 son de Lima y 50 son de provincia. Esta distribución geográfica refleja la ubicación de UTEC en la capital peruana y su mayor atracción para los estudiantes locales.

La proporción muestra que el 73% de los estudiantes son de Lima, mientras que el 27% son de provincia.

## Grado de utilidad del colegio para la Universidad respecto al tipo de colegio (Publico o Privado):

```{r, echo=FALSE}
ggplot(DF) +
  aes(x = ColegioTipo, y = UtilidadCole_Uni) +
  geom_boxplot(fill = "#F4DC82") +
  labs(
    x = "Tipo de Colegio",
    y = "Grado de Utilidad del colegio para la universidad\n\n (1 = Nada Util; 5 = Muy Util)\n",
    title = "Grado de utilidad del colegio para la Universidad respecto al tipo de colegio"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 12L,
    face = "bold",
    hjust = 0.5),
    axis.title.y = element_text(size = 10L),
    axis.title.x = element_text(size = 12L)
  )
```

El gráfico de boxplot compara el nivel de satisfacción secundaria entre dos grupos: "Colegios Públicos" y "Colegios Privados". La mediana representa la utilidad percibida del colegio para cada grupo. Se observa que los estudiantes de colegios privados perciben mayor utilidad que los de colegios públicos. El rango intercuartílico muestra la variabilidad en el grado de utilidad, siendo mayor en colegios privados. No se presentan valores atípicos.

## Satisfacción de la educación secundaria según la ubicación del colegio de proveniencia:

```{r, echo=FALSE}
ggplot(DF) +
  aes(x = provincia, y = SatisfaccionPrepSec) +
  geom_boxplot(fill = "#ED5615") +
  labs(
    x = "Lugar de Proveniencia",
    y = "Satisfacción de la Preparación secundaria\n\n (1 = Nada Satisfecho; 5 = Muy Satisfecho)\n",
    title = "Satisfacción de la educación secundaria respecto a Lugar de Proveniencia"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust = 0.5),
    axis.title.y = element_text(size = 10L),
    axis.title.x = element_text(size = 13L)
  ) +
  scale_y_continuous(breaks = seq(min(DF$SatisfaccionPrepSec), max(DF$SatisfaccionPrepSec), by = 1))
```

El gráfico de boxplot compara el nivel de satisfacción secundaria entre dos grupos: "Lima" y "Provincia". La mediana representa el nivel de satisfacción secundaria para cada grupo. No se observan diferencias significativas en el nivel de satisfacción entre los estudiantes de Lima y provincia, ya que ambas medianas son iguales a 7. El rango intercuartílico muestra la variabilidad en el nivel de satisfacción dentro de cada grupo. En Lima, la variabilidad está entre 6 y 8, mientras que en provincia está entre 5 y 8. La comparación se basa en la mediana y en la variabilidad dentro de cada grupo, lo que proporciona una visión clara y concisa de las diferencias o similitudes en el nivel de satisfacción secundaria.

## Nivel de ingles Actual respecto al nivel al salir del colegio:

```{r, message=FALSE, echo=FALSE}
ggplot(DF) +
  aes(x = NivelColegio, y = InglesNivelCole) +
  geom_jitter(size = 1.5) +
  geom_smooth(method = "lm", se = FALSE, color = "#6CF585") +
  labs(title = 
         "Nivel de Ingles al salir del colegio respecto al nivel del colegio", 
       x = "Nivel del colegio",
       y = "Nivel de Ingles al salir del colegio\n\n (1 = Muy Bajo; 10 = Excelente)") +
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(min(DF$InglesNivelCole), max(DF$InglesNivelCole), by = 1)) +
  scale_x_continuous(breaks = seq(min(DF$NivelColegio), max(DF$InglesNivelCole), by = 1))
```

En la gráfica de dispersión, el eje horizontal representará el nivel de educación al salir del colegio y el eje vertical representará el nivel de inglés al salir del colegio de los estudiantes (ambos van del grado del 1, más bajo, al 10, más alto). El análisis de la gráfica de dispersión puede proporcionar la siguiente información:

Tendencia general: Al observar la dispersión de los puntos en la gráfica, se puede identificar que los puntos han tendido a agruparse en una tendencia de dirección ascendente. Esto nos indicaría una relación positiva entre el nivel de educación y el nivel de inglés. Es decir, a medida que aumenta el nivel de educación, tiende a aumentar también el nivel de inglés.

Variabilidad: La dispersión de los puntos indica la variabilidad de la relación. En nuestro caso, están semi-dispersos, lo que puede sugerir que el nivel de educación no tiene una influencia muy fuerte en el nivel de inglés, o hay otros factores que afectan la habilidad para aprender el idioma.

## Los cursos en los que los estudiantes presentan mayor dificultad en el colegio:

```{r, echo=FALSE,warning=FALSE}
# Crear una nueva columna para almacenar los cursos separados
DF_cd = DF
DF_cd <- DF_cd %>%
  mutate(CursosDificiles = strsplit(CursosDificiles, ", "))

# Expandir los elementos individuales en filas separadas
DF_cd <- DF_cd %>%
  unnest(CursosDificiles)

# Calcular las frecuencias de los cursos
frecuencias <- DF_cd %>%
  count(CursosDificiles, name = "Frecuencia")

names(frecuencias) = c("Cursos", "Frecuencia")
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Ciencias sociales (Historia)", "CCSS", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Ciudanadía y Cívica", "Civica", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Desarrollo Personal", "DPCC", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Comunicación", "Com", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Matemática", "Mat", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Química", "Quím.", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Biología", "Bio", frecuencias$Cursos)
frecuencias$Cursos = ifelse(frecuencias$Cursos == "Otros...", "otros", frecuencias$Cursos)
```

```{r}
colores <- ifelse(frecuencias$Cursos == "CCSS", "red", ifelse(frecuencias$Cursos == "Mat.", "blue", "skyblue"))
barplot(frecuencias$Frecuencia, names.arg = frecuencias$Cursos, col = colores,
        xlab = "Curso", ylab = "Frecuencia", main = "Dificultad de Cursos", ylim = c(0, max(frecuencias$Frecuencia) * 1.2),space = 1.5)
```

En este gráfico, se resalta con un color rojo intenso el curso con mayor dificultad en los estudiantes de nuestra muestra, mientras que se utiliza un color celeste cuando la frecuencia es baja. Se puede apreciar claramente que hay un grupo de cursos que han presentado grandes dificultades, como CCSS (Historia), Com. (Comunicación), Biología y Desarrollo Personal.

## Cursos en los cuales los estudiantes tienen preferencia en prepararse en una academia:

```{r, echo=FALSE}
# Crear una nueva columna para almacenar los cursos separados
DF_at = DF[!is.na(DF$AcademiaTipo), ]
DF_at <- DF_at %>%
  mutate(AcademiaTipo = strsplit(AcademiaTipo, ", "))

# Expandir los elementos individuales en filas separadas
DF_at <- DF_at %>%
  unnest(AcademiaTipo)

# Calcular las frecuencias de los cursos
frecuencias_at <- DF_at %>%
  count(AcademiaTipo, name = "Frecuencia")

names(frecuencias_at) = c("Cursos", "Frecuencia")

barplot(frecuencias_at$Frecuencia, names.arg = frecuencias_at$Cursos, xlab = "Cursos", ylab = "Frecuencia", main = "Cursos que se llevaron en los alumnos que llevaron academia", space=1,col = ifelse(frecuencias_at$Cursos=="De matematicas",'gold','skyblue'))
```

Se ve que los alumnos que llevaron academia priorizaron llevar una academia principalmente de matématicas.

## Promedio ponderado respecto a la seriedad con la que los estudiantes se tomaban el colegio:

```{r, echo=FALSE}
DF$Ponderado = ifelse(DF$Ponderado == "menos de 11", "11 a 0", DF$Ponderado)

ggplot(DF) +
  aes(x = ColeSeriedad, y = Ponderado)+
  geom_boxplot(fill = "#EFCE2D") +
  labs(title = "Promedio ponderado respecto a la seriedad en el colegio", x = "Seriedad con la que se tomaban el colegio", y = "Promedio ponderado") +
  scale_x_continuous(breaks = seq(min(DF$ColeSeriedad), max(DF$ColeSeriedad), by = 1)) +
  theme_minimal()
```

Podemos ver que se ha generado un gráfico boxplot por cada promedio ponderado. Con ello, se puede apreciar que, en el caso del promedio más bajo (0-11) la mediana es de 5 de seriedad con la que se tomaban el colegio y el rango intercuartílico es de 5 a 6. Para el promedio más alto (más de 18), la mediana es de 9.5 de seriedad y el rango intercuartílico es de 8 a 10. Esto nos muestra una clara tendencia de aumento del promedio ponderado cuando un estudiante se toma más en serio sus estudios secundarios en su colegio.

## Promedio ponderado según lugar de proveniencia:

### Promedio ponderado de los estudiantes provenientes de provincia:

```{r, message=FALSE, echo=FALSE}

DF$Ponderado = factor(DF$Ponderado)

DF %>%
 filter(provincia %in% "Provincia") %>%
 ggplot() +
  aes(x = provincia, fill = Ponderado) +
  geom_bar(position = "dodge") +
  scale_fill_hue(direction = 1) +
  scale_x_discrete(breaks = levels(DF$Ponderado)) +
  scale_y_continuous(expand = c(0, 0)) +
  labs(
    x = "Ubicación",
    y = "Frecuencia\n",
    title = "Promedio ponderado de los estudiantes provenientes de provincia\n",
    fill = "Leyenda"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust=0.5)) +
  scale_fill_manual(values = c("11 a 13" = "#b79f00", "14 a 15" = "#00ba38", 
                               "16 a 17" = "#00bfc4", "17 a 18" = "#619cff", 
                               "más de 18" = "#f564e3"))

```

### Promedio ponderado de los estudiantes provenientes de la Capital:

```{r, echo=FALSE}
DF %>%
 filter(provincia %in% "Lima") %>%
 ggplot() +
  aes(x = provincia, fill = Ponderado) +
  geom_bar(position = "dodge") +
  scale_fill_hue(direction = 1) +
  labs(
    x = "Ubicación",
    y = "Frecuencia",
    title = "Promedio ponderado de los estudiantes provenientes de la capital\n",
    fill = "Leyenda"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 13L,
    face = "bold",
    hjust=0.5))
```

En base a estas dos gráficas, podemos observar los promedios ponderados en relación al colegio de procedencia. Notamos que existe una moda en el caso de las provincias, donde los promedios ponderados se encuentran principalmente en el rango de 14 a 15, seguidos por el intervalo de 16 a 17, y en tercer lugar el rango de 11 a 13. Hay muy pocos estudiantes con promedios entre 17 y 20. En contraste, los estudiantes que estudiaron en la capital muestran una moda en el intervalo de 14 a 15, seguido por el rango de 16 a 17, y en tercer lugar el intervalo de 11 a 13.

# Probabilidad empírica:

## Variable: `Promedio ponderado`

-   **Experimento:** Seleccionar un estudiante `x` de UTEC del periodo 2023-1 y observar el `Promedio ponderado`

-   **Eventos Atómicos:**

    $${\color{Cyan} \Omega_{Exp}} = \left \{ 11 \text{ a } 0,\ 11 \text{ a } 13,\ 14 \text{ a } 15,\ 16 \text{ a } 17,\ 17 \text{ a } 18, \ \text{mas de } 18 \right \}$$

    A dichos eventos les asignaremos de la siguiente manera:

    $$
    {\color{Cyan} \Omega_{Exp}} = \left \{ A_1,\ A_2,\ A_3,\ A_4,\ A_5,\ A_6 \right \}
    $$

    Siendo:

    $$
    {\color{Cyan} A_1} = 11 \text{ a } 0
    $$

    $$
    {\color{Cyan} A_2} = 11 \text{ a } 13
    $$

    $$
    {\color{Cyan} A_3} = 14 \text{ a } 15
    $$

    $$
    {\color{Cyan} A_4} = 16 \text{ a } 17
    $$

    $$
    {\color{Cyan} A_5} = 17 \text{ a } 18
    $$

    $$
    {\color{Cyan} A_6} = \text{mas de } 18
    $$

-   **Identificación y Definición de Eventos:**

Ahora empecemos a definir cada evento atómico asociado a los valores de nuestro espacio muestral.

$$
{\color{Cyan} A_1}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado 0 } \leq x < 11
$$

$$
{\color{Cyan} A_2}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado 11 } \leq x \leq 13
$$

$$
{\color{Cyan} A_3}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado 14 } \leq x \leq 15
$$

$$
{\color{Cyan} A_4}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado 16 } \leq x < 17
$$

$$
{\color{Cyan} A_5}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado 17 } \leq x \leq 18
$$

$$
{\color{Cyan} A_6}: \text{Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que tengan un promedio ponderado x > 18}
$$

-   **Función de probabilidad asociada a cada evento:**

```{r echo=FALSE}
var_promedio = table(DF$Ponderado)
Size_Muestra = nrow(DF)
Probabilidad_empirica_promedio = round(as.numeric(var_promedio)/Size_Muestra, 2)
```

$$ {\color{Cyan}\mathbb{P}(A_1)} = \frac{3}{181} = `r Probabilidad_empirica_promedio[1]`$$ $$ {\color{Cyan}\mathbb{P}(A_2)} = \frac{39}{181} = `r Probabilidad_empirica_promedio[2]`$$

$$ {\color{Cyan}\mathbb{P}(A_3)} = \frac{83}{181} = `r Probabilidad_empirica_promedio[3]`$$ $$ {\color{Cyan}\mathbb{P}(A_4)} = \frac{44}{181} = `r Probabilidad_empirica_promedio[4]`$$

$$ {\color{Cyan}\mathbb{P}(A_5)} = \frac{8}{181} = `r Probabilidad_empirica_promedio[5]`$$

$$ {\color{Cyan}\mathbb{P}(A_6)} = \frac{4}{181} = `r Probabilidad_empirica_promedio[6]`$$

Por último, verifiquemos que la suma de las probabilidades nos de 1 (utilizaremos el comando `sum`):

$$ \mathbf{0.02 + 0.22 + 0.46 + 0.24 + 0.04 + 0.02 = `r sum(Probabilidad_empirica_promedio)`} $$

## Variable: `Utilidad del colegio para la universidad`

-   **Experimento:** Seleccionar un estudiante `x` de UTEC del periodo 2023-1 y observar la `Utilidad del colegio para la universidad`

-   **Eventos Atómicos:**

    $${\color{Cyan}\Omega_{Exp}} = \left \{ 1, \ 2, \ 3, \ 4, \ ,5\right \}$$

    A dichos eventos les asignaremos de la siguiente manera:

    $$
    {\color{Cyan}\Omega_{Exp}} = \left \{ A_1,\ A_2,\ A_3,\ A_4,\ A_5 \right \}
    $$

    Siendo:

    $$
    {\color{Cyan}A_1} = 1
    $$

    $$
    {\color{Cyan}A_2} = 2 
    $$

    $$
    {\color{Cyan}A_3} = 3
    $$

    $$
    {\color{Cyan}A_4} = 4
    $$

    $$
    {\color{Cyan}A_5} = 5
    $$

-   **Identificación y definición de eventos:**

Ahora empecemos a definir cada evento atómico asociado a los valores de nuestro espacio muestral. $${\color{Cyan}A_1} \text{ : Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que su nivel de utilidad del colegio para la universidad sea }1 $$ $${\color{Cyan}A_2} \text{ : Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que su nivel de utilidad del colegio para la universidad sea }2 $$ $${\color{Cyan}A_3} \text{ : Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que su nivel de utilidad del colegio para la universidad sea }3 $$ $${\color{Cyan}A_4} \text{ : Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que su nivel de utilidad del colegio para la universidad sea }4 $$ $${\color{Cyan}A_5} \text{ : Seleccionar a los estudiantes de UTEC inscritos en el periodo 2023-1 que su nivel de utilidad del colegio para la universidad sea }5 $$

-   **Función de probabilidad asociada a cada evento:**

```{r}
var_utl_coleUni = table(DF$UtilidadCole_Uni)
Probabilidad_empirica_utl_coleUni =
round(as.numeric(var_utl_coleUni)/Size_Muestra, 2)
```

$${\color{Cyan}\mathbb{P}(A_1)}=\frac{33}{181} = `r Probabilidad_empirica_utl_coleUni[1]`$$

$${\color{Cyan}\mathbb{P}(A_2)}=\frac{34}{181} = `r Probabilidad_empirica_utl_coleUni[2]`$$

$${\color{Cyan}\mathbb{P}(A_3)}=\frac{47}{181} = `r Probabilidad_empirica_utl_coleUni[3]`$$

$${\color{Cyan}\mathbb{P}(A_4)}=\frac{45}{181} = `r Probabilidad_empirica_utl_coleUni[4]`$$

$${\color{Cyan}\mathbb{P}(A_5)}=\frac{22}{181} = `r Probabilidad_empirica_utl_coleUni[5]`$$

Por ultimo, verifiquemos que la suma de las probabilidades nos de 1 (utilizaremos el comando `sum`): $$ \mathbf{0.18 + 0.19 + 0.26 + 0.25 + 0.12 = `r sum(Probabilidad_empirica_utl_coleUni)`}$$

# Probabilidad condicional - Eventos dependientes

Escogeremos un par de eventos de las variables **Utilidad del colegio para la universidad** y **promedio ponderado**

Vamos a definir el evento `A`, el cual es seleccionar una persona cuya utilidad del colegio para la universidad sea menor a 3, que representa que no le fue útil el colegio para la universidad.

Ahora definiremos el evento `B`, el cual sería seleccionar un estudiante que tenga un promedio ponderado menor o igual a 13.

$$ A = Utilidad\_Colegio < 3 $$ $$ B = Promedio\_ponderado \leq 13$$

## Validar Dependencia

Para trabajar de manera mas sencilla convertiremos los intervalos de notas en valores numéricos del 1 al 6:

```{r}
DF$Ponderado = as.numeric(DF$Ponderado)
```

$$1 = \text{11 a 0}$$ $$2 = \text{11 a 13}$$ $$3 = \text{14 a 15}$$ $$4 = \text{16 a 17}$$ $$5 = \text{17 a 18}$$ $$6 = \text{más de 18}$$

Debemos verificar que $P(A \ \cap \ B)=P(A)P(B)$.

Calculemos la probabilidad de A, lo asignaremos a la variable `P_A`:

```{r}
P_A = sum(as.numeric(table(DF$UtilidadCole_Uni[DF$UtilidadCole_Uni<3])))/Size_Muestra
```

Ahora definiremos la probabilidad de B, lo asignaremos a la variable `P_B`:

```{r}
P_B=sum(as.numeric(table(DF$Ponderado[DF$Ponderado < 3])))/Size_Muestra
```

Con estos dos eventos, calcularemos la multiplicación de ambos, lo asignaremos a la variable `P_AB`:

```{r}
P_AB=round(P_A*P_B, 2)
```

*Nota: Está redondeado a 2 decimales*

Y por último, necesitamos la probabilidad de la intersección de estos 2 eventos, lo cual asignaremos a la variable `P_A_and_B`:

```{r}
P_A_and_B = round(nrow(DF[(DF$UtilidadCole_Uni<3) & (DF$Ponderado < 3),])/181, 2)
```

*Nota: Está redondeado a 2 decimales*

Se verifica que $P(A)P(B)\neq P(A \cap B)$ ya que $P(A)P(B)=`r P_AB`$ y $P(A \cap B) =`r P_A_and_B`$ por lo que al no cumplirse la igualdad $`r P_AB` \neq `r P_A_and_B`$, los eventos son dependientes entre sí.

## Calculamos la probabilidad condicional

Primero hallaremos, $P(A|B)$ de la siguiente manera:

$$P(A|B)=\frac{P(A \cap B)}{P(B)}$$ Como vemos acá necesitamos las variables definidas anteriormente como: `P_A_and_B` y `P_B`

```{r}
PC_A_si_B = round(P_A_and_B/P_B, 2)
```

Concluimos que la probabilidad de escoger un estudiante de UTEC inscrito en el periodo 2023-1 que considere la utilidad del colegio para la universidad menor a 3 si su promedio ponderado es menor igual a 13 es de `r round(PC_A_si_B*100, 2)`%.

## Se halla la probabilidad de P(B\|A) por bayes

Empezamos hallando la probabilidad total que denotamos como: $$P(A)=P(A|B)P(B)+P(A|\bar{B})P(\bar{B})$$ Como se ve, necesitamos hallar 2 probabilidades que no tenemos aún que son las siguientes: $P(A|\bar{B})$ y $P(\bar{B})$, estos los asignaremos a las variables `PC_A_si_B_c` y `P_B_c` respectivamente.

Empecemos con $P(\bar{B})$:

```{r}
P_B_c = 1 - P_B
```

Terminamos con $P(A|\bar{B})$:

```{r}
PC_A_si_B_c = (P_A - P_A_and_B)/P_B_c
```

Con las 2 variables que nos faltaban podemos hallar la probabilidad total:

```{r}
P_T_A = PC_A_si_B*P_B + PC_A_si_B_c*P_B_c
```

Habiendo hallado la probabilidad total verificamos si es igual a la probabiidad del evento A: $P(A) = P(A|B)P(B)+P(A|\bar{B})P(\bar{B})$ estos valores serian respectivamente $`r round(P_A, 2)` = `r round(P_T_A, 2)`$

Habiendo obtenido la probabilidad total correctamente podemos hallar $P(B|A)$ que se denota de la siguiente manera:

$$\mathbb{P}(B|A)=\frac{\mathbb{P}(B)*\mathbb{P}(A|B)}{\mathbb{P}(A)}\hspace{0.1cm}$$

```{r}
PC_B_si_A = (P_B*PC_A_si_B)/P_T_A
```

Concluimos que la probabilidad de escoger un estudiante de UTEC inscrito en el periodo 2023-1 que tenga un promedio ponderado menor igual a 13 si considera que la utilidad del colegio para la universidad es menor a 3 es de `r round(PC_B_si_A*100, 2)`%.

# Probabilidad Condicional - Eventos independientes

Escogeremos otro par de eventos de las variables **Utilidad del colegio para la universidad** y **promedio ponderado**

Vamos a definir el evento `C`, el cual es seleccionar una persona cuya utilidad del colegio para la universidad sea mayor a 3, que representa que le fue útil el colegio para la universidad.

También definiremos el evento `D`, el cual sería seleccionar un estudiante que tenga un promedio ponderado menor a 11.

$$ C = Utilidad\_Colegio > 3 $$ $$ B = Promedio\_ponderado < 11$$

## Validar Independencia

Para trabajar de manera mas sencilla convertiremos los intervalos de notas en valores numéricos del 1 al 6:

```{r}
DF$Ponderado = as.numeric(DF$Ponderado)
```

$$1 = \text{11 a 0}$$ $$2 = \text{11 a 13}$$ $$3 = \text{14 a 15}$$ $$4 = \text{16 a 17}$$ $$5 = \text{17 a 18}$$ $$6 = \text{más de 18}$$

Debemos verificar que $P(C \ \cap \ D)=P(C)P(D)$.

Calculemos la probabilidad de C, lo asignaremos a la variable `P_C`:

```{r}
P_C = sum(as.numeric(table(DF$UtilidadCole_Uni[DF$UtilidadCole_Uni>3])))/Size_Muestra
```

Ahora definiremos la probabilidad de D, lo asignaremos a la variable `P_D`:

```{r}
P_D = sum(as.numeric(table(DF$Ponderado[DF$Ponderado < 2])))/Size_Muestra
```

Con estos dos eventos, calcularemos la multiplicación de ambos, lo asignaremos a la variable `P_CD`:

```{r}
P_CD = round(P_C*P_D, 2)
```

*Nota: Está redondeado a 2 decimales*

Y por último, necesitamos la probabilidad de la intersección de estos 2 eventos, lo cual asignaremos a la variable `P_C_and_D`:

```{r}
P_C_and_D = round(nrow(DF[(DF$UtilidadCole_Uni > 3) & (DF$Ponderado < 2),])/181, 2)
```

*Nota: Está redondeado a 2 decimales*

Se verifica que $P(C)P(D) = P(C \cap D)$ ya que $P(C)P(D)=`r P_CD`$ y $P(C \cap D) =`r P_C_and_D`$ al cumplirse la igualdad $`r P_CD` = `r P_C_and_D`$, los eventos son independientes entre sí.

## Calculamos la probabilidad condicional

Primero hallaremos, $P(C|D)$ de la siguiente manera:

$$P(C|D)=\frac{P(C \cap D)}{P(D)}$$ Como vemos acá necesitamos las variables definidas anteriormente como: `P_C_and_D` y `P_D`

```{r}
PC_C_si_D = round(P_C_and_D/P_D, 2)
```

Concluimos que la probabilidad de escoger un estudiante de UTEC inscrito en el periodo 2023-1 que considere la utilidad del colegio para la universidad mayor a 3 si su promedio ponderado es menor a 11 es de `r round(PC_C_si_D*100, 2)`%.

## Se halla la probabilidad de P(C\|D) por bayes

Empezamos hallando la probabilidad total que denotamos como: $$P(C)=P(C|D)P(D)+P(C|\bar{D})P(\bar{D})$$ Como se ve, necesitamos hallar 2 probabilidades que no tenemos aún que son las siguientes: $P(C|\bar{D})$ y $P(\bar{D})$, estos los asignaremos a las variables `PC_C_si_D_c` y `P_D_c` respectivamente.

Empecemos con $P(\bar{D})$:

```{r}
P_D_c = 1 - P_D
```

Terminamos con $P(C|\bar{D})$:

```{r}
PC_C_si_D_c = (P_C - P_C_and_D)/P_D_c
```

Con las 2 variables que nos faltaban podemos hallar la probabilidad total:

```{r}
P_T_C = PC_C_si_D*P_D + PC_C_si_D_c*P_D_c
```

Habiendo hallado la probabilidad total verificamos si es igual a la probabilidad del evento A: $P(C) = P(C|D)P(D)+P(C|\bar{D})P(\bar{D})$ estos valores serían respectivamente $`r round(P_C, 2)` = `r round(P_T_C, 2)`$

Habiendo obtenido la probabilidad total correctamente podemos hallar $P(C|D)$ que se denota de la siguiente manera:

$$\mathbb{P}(C|D)=\frac{\mathbb{P}(D)*\mathbb{P}(C|D)}{\mathbb{P}(C)}\hspace{0.1cm}$$

```{r}
PC_D_si_C = (P_D*PC_C_si_D)/P_T_C
```

Concluimos que la probabilidad de escoger un estudiante de UTEC inscrito en el periodo 2023-1 que tenga un promedio ponderado menor a 11 si considera que la utilidad del colegio para la universidad es mayor a 3 es de `r round(PC_D_si_C*100, 2)`%.

```{r}
Mosaic <- ggplot(DF, aes(x = UtilidadCole_Uni, y = Ponderado, fill = Ponderado)) +
  geom_tile(color = "white") +
  labs(x = "Utilidad", y = "Ponderado", fill = "Ponderado") +
  theme_minimal()

Disper <- ggplot(DF) +
  aes(x = UtilidadCole_Uni, y = Ponderado) +
  geom_jitter(size = 1.5) +
  theme_minimal()

Mosaic <- Mosaic + Disper$layers[1]
Mosaic <- Mosaic + annotate("rect", xmin=0.5, xmax=2.5, ymin=0.5 , ymax=2.5, alpha=0.2, color="red", fill="red")
Mosaic <- Mosaic + annotate("rect", xmin = 3.5, xmax = 5.5, ymin = 0.5, ymax = 1.5, alpha=0.2, color="green", fill="green")
Mosaic
```

# Variables aleatorias discretas

## Modelo binomial

$$\mathbb{X}=\text{Número de personas que no formaron habilidades blandas en el colegio en una muestra de `r nrow(DF)`}$$ Cuya probabilidad de éxito será

```{r}
X=as.numeric(table(DF$HabBlandasFlag)[1])
P_X=X/nrow(DF)#Probabilidad de que hayan personas que no formaron habilidades blandas en el colegio
```

### Definición de parámetros

Los parámetros de la binomial serán $\mathbb{X}\sim\mathsf{Bin}(n,p)$ Donde: $$n= `r nrow(DF)` \text{ alumnos de UTEC inscritos en el periodo 2023-1}$$ $$p=\text{Probabilidad de exito }`r P_X`$$

### Construir la densidad

```{r}
plot(dbinom(1:nrow(DF),nrow(DF),P_X), type = "h", lwd = 2, xlab = "Número de éxitos", ylab = "Densidad",
     main = "Función densidad binomial")
```

### Validación de propiedades

Vamos a validar las siguientes propiedades:

$$\text{La esperanza: }E(\mathbb{X})$$ $$\text{La varianza: }Var(\mathbb{X})$$ $$\text{El coficiente de variación: }CV(\mathbb{X})$$

```{r}
EB_X=nrow(DF)*P_X#esperanza: n*p
varB_X=nrow(DF)*P_X*(1-P_X) #varianza: n*p(1-p)
CVB_X=sqrt(varB_X)/EB_X #Coeficiente de variacion: raiz de Varianza/Esperanza
```

Entonces, las propiedades halladas quedan lo siguiente: $$E(\mathbb{X})=`r EB_X`$$ $$Var(\mathbb{X})=`r varB_X`$$ $$CV(\mathbb{X})=`r CVB_X`$$

### Ejemplo

Se realiza un estudio en la universidad UTEC en un salón aleatorio con el aforo lleno. ¿Cuál es la probabilidad de que más del 75% del salón no haya desarrollado habilidades blandas? Se define que $$\mathbb{X}=\text{Número de personas que no formaron habilidades blandas en el colegio en un salón lleno }$$ Se sabe que un salón lleno hay 45 alumnos. Entonces, el 75% de 45 es: $45*0.75=33.75$

Ahora hallaremos $\mathbb{P}(\mathbb{X}>33.75)$

```{r}
P_X_mayor_75=pbinom(45*0.75,nrow(DF),P_X)
```

Entonces, $\mathbb{P}(\mathbb{X}>33.75)= `r round(P_X_mayor_75*100,3)`$%

```{r}
plot(dbinom(1:nrow(DF),nrow(DF),P_X), type = "h", lwd = 2, xlab = "Número de éxitos", ylab = "Densidad",
     main = "Función densidad binomial")
abline(v=45*0.75,lwd=3, col="blue")
```

## Modelo Poisson

Definiremos $$\mathbb{X}=\text{Número de horas de estudio en los estudiantes de UTEC inscritos en el ciclo 2023-1 }$$

### Definición de parámetros

Para definir $\mathbb{X}\sim\mathsf{Poisson}(\lambda)$

Tenemos que hallar el promedio de horas de estudio por día el cual representa a $\lambda$

```{r echo=FALSE}
convertir_a_horas_numericas <- function(hora) {
  hora_dividida <- strsplit(hora, ":")[[1]]
  horas <- as.numeric(hora_dividida[1])
  minutos <- as.numeric(hora_dividida[2])
  return(horas + minutos / 60)
}
# Aplicar la función al data frame
DF$HorasEstudioUni <- sapply(DF$HorasEstudioUni, convertir_a_horas_numericas)
```

```{r}
lambd=sum(DF$HorasEstudioUni)/nrow(DF)
```

Entonces, $\lambda=4.01326\frac{horas}{día}$

### Construir la densidad

```{r}
plot(dpois(1:max(DF$HorasEstudioUni),lambd), type = "h", lwd = 2, xlab = "Horas de estudio al dia", ylab = "Densidad",
     main = "Función densidad de modelo Poisson")
```

### Validación de propiedades

Vamos a validar las siguientes propiedades, tomando a $x$ como un valor real y positivo.

$$\text{La esperanza: }E(\mathbb{X}=x)$$ $$\text{La varianza: }Var(\mathbb{X}=x)$$ $$\text{El coficiente de variación: }CV(\mathbb{X}=x)$$

```{r}
EP_X=lambd
varP_X=lambd
CVP_X=sqrt(lambd)/lambd
```

$$\text{La esperanza: }E(\mathbb{X}=x)=`r EP_X`$$ $$\text{La varianza: }Var(\mathbb{X}=x)= `r varP_X`$$ $$\text{El coficiente de variación: }CV(\mathbb{X}=x)=`r CVP_X`$$

### Ejemplo

Se sabe que en la UTEC, las horas de estudio promedio por día de los alumnos en un ciclo académico son `r lambd`, ¿cuál es la probabilidad que un alumno seleccionado al azar estudie 7 horas en un día? Lo que tenemos que hallar es $\mathbb{P}(\mathbb{X}=7)$ sabiendo que $\lambda= `r lambd`$.

```{r}
PX=dpois(7,lambd)
```

Entonces, $\mathbb{P}(\mathbb{X}=7)=`r PX`$ por lo que la probabilidad de que un estudiante seleccionado al azar en UTEC estudie 7 horas es del $`r round(PX*100,3)`$%

```{r echo=FALSE}
plot(dpois(1:max(DF$HorasEstudioUni),lambd), type = "h", lwd = 2, xlab = "Horas de estudio al dia", ylab = "Densidad",
     main = "Función densidad de modelo Poisson")
abline(h =0.0601331,lwd=2, col="red")
```

# Variables aleatorias continuas

```{r echo=FALSE}
convertir_a_horas_numericas <- function(hora) {
  hora_dividida <- strsplit(hora, ":")[[1]]
  horas <- as.numeric(hora_dividida[1])
  minutos <- as.numeric(hora_dividida[2])
  return(horas + minutos / 60)
}
# Aplicar la función al data frame
DF$HorasEstudioIngles <- sapply(DF$HorasEstudioIngles, convertir_a_horas_numericas)
```

## Variable continua exponencial

Vamos a graficar el histograma de la variable `horas de estudio ingles semanales` para ver si su densidad se asemeja a algún modelo tomando de intervalo $[0;8]$

```{r}
DF$HorasEstudioIngles=ifelse(is.na(DF$HorasEstudioIngles),0,DF$HorasEstudioIngles)
hist(DF$HorasEstudioIngles, 
     main = "Histograma de horas de estudio inglés",  # Título del histograma
     xlab = "Valores",     # Etiqueta del eje x
     ylab = "Frecuencia",  # Etiqueta del eje y
     col = "blue",         # Color de las barras
     border = "white",     # Color del borde de las barras
     breaks = 12,          # Número de intervalos (barras)
     xlim=c(0.5,8))
plot(density(DF$HorasEstudioIngles),xlim=c(0.5,8),main="Densidad de horas de estudio de inglés")

```

Vemos que del intervalo 0.5 a 8, la gráfica de su densidad se asemeja a un modelo exponencial. Por lo que ahora validaremos sus propiedades. Entonces definiremos que $$\mathbb{X}=\text{Horas de estudio semanales de inglés en los alumnos de UTEC inscritos en el ciclo 2023-1}$$

### Validación de propiedades

Debemos validar que $\mathbb{X}\sim \text{exp}(\beta)$.

Sabemos que: $$E(\mathbb{X})=\frac{1}{\lambda}=\beta$$ $$Var(\mathbb{X})=\frac{1}{\lambda^2}=\beta^2$$ Entonces definimos a $\lambda=\text{promedio}(\mathbb{X})$

```{r}
media=mean(DF$HorasEstudioIngles[DF$HorasEstudioIngles>=0.5 &DF$HorasEstudioIngles<=8])
E_Beta=1/media
Var_Beta=E_Beta^2
```

Entonces $$E(\mathbb{X})=\frac{1}{\lambda}=\beta=`r E_Beta`$$ $$Var(\mathbb{X})=\frac{1}{\lambda^2}=\beta^2=`r Var_Beta`$$ Sabemos que $x>0$ y $\beta >0$ siendo $[0;\infty+)$.

```{r}
func1<- function(x)(1/E_Beta)*(exp(-x/E_Beta))
func2<- function(x)(x/E_Beta)*(exp(-x/E_Beta))
integrate(func1,0.5,8)$value
integrate(func2,0.5,8)$value
E_Beta

```

Como los valores son positivos se comprueba que sí es una distribución exponencial ya que es mayor a 0.

### Ejemplo

El tiempo que los estudiantes le dedican a estudiar inglés se modela como exponencial con una media `r media`. ¿Cuál es la probabilidad de que un estudiante seleccionado al azar estudie al menos 4 horas semanales inglés? Definimos $\mathbb{X}=\text{Estudiante que estudie inglés al menos 4 horas semanales}$ Hallaremos $P(\mathbb{X})$ Esto quiere decir que queremos hallar la probabilidad de que un estudiante estudie más de 4 horas. Sabemos que la función de probabilidad acumulada es para un valor de $x>0$ es $F_{\mathbb{X}}(x)=1- e^{-\lambda x}$ Pero sabemos que si reemplazamos en la formula $x=4$, estaríamos hallando la probabilidad de que un estudiante no estudie al menos 4 horas. Por lo que debemos hallar su complemento.

```{r}
prob=1-(1-exp(-(1/media)*4))
```

Entonces, la probabilidad de que un estudiante estudie inglés al menos 4 horas semanales es $`r round(prob*100,3)`$%.

## Variable aleatoria continua normal

Vamos a graficar el histograma de la variable `Utilidad de las matematicas aprendidas en el colegio para la universidad`

```{r}
hist(DF$UtilidadMate, 
     main = "Histograma de nivel de utilidad de matemáticas del cole para la universidad",  # Título del histograma
     xlab = "Valores",     # Etiqueta del eje x
     ylab = "Frecuencia",  # Etiqueta del eje y
     col = "blue",         # Color de las barras
     border = "white",     # Color del borde de las barras
     breaks = 12,          # Número de intervalos (barras)
     )
plot(density(DF$UtilidadMate),main="Densidad de utilidad de matemáticas del colegio")
```

Vamos a proponer que este variable se asemeja a una variable aleatoria continua normal Definimos $\mathbb{X}=\text{Utilidad del curso de matemáticas del colegio para la universidad}$

### Definir propiedades

```{r}
mu=mean(DF$UtilidadMate)
sigma=sd(DF$UtilidadMate)
```

$$\mathbb{X}\sim\text{Norm}(\mu,\sigma)$$

$$\mu = Media=`r mu`$$ $$\sigma= \text{Desviacion estandar}=`r sigma`$$

```{r}
mediana=median(DF$UtilidadMate)
var=sigma^2
```

$$E(X)=`r mu`$$ $$Var(X)=`r var`$$ Calculamos que la mediana es $`r mediana`$ y la varianza es $`r var`$.

Ahora comprobaremos que se cumple el modelo definiendo las funciones de probabilidad normal

```{r}
func1<- function(x) 1/(sqrt(pi*2*(var))*exp(-(x-mu)^2/(2*var)))
func2<-function(x) x/(sqrt(pi*2*(var))*exp(-(x-mu)^2/(2*var)))
func3<-function(x) (x^2)/(sqrt(pi*2*(var))*exp(-(x-mu)^2/(2*var)))
```

```{r}
integrate(func1,mu,max(DF$UtilidadMate))
integrate(func2,min(DF$UtilidadMate),max(DF$UtilidadMate))
integrate(func3,min(DF$UtilidadMate),max(DF$UtilidadMate))
var_nueva=integrate(func3,min(DF$UtilidadMate),max(DF$UtilidadMate))$value-integrate(func2,min(DF$UtilidadMate),max(DF$UtilidadMate))$value^2
```

Se comprueba que la variable continua aleatoria no se puede modelar como distribución normal a pesar de que los valores de la media (`r mu`) y la mediana (`r mediana`) sean cercanos entre sí, ya que la varianza esperada mediante las integrales sale negativo (`r var_nueva`) y no se acerca al valor de la varianza real (`r var`).

### Ejemplo

En una población de 181 estudiantes de la UTEC, cual es la probabilidad de que un estudiante, seleccionado al azar, considere lo aprendido en el curso de matemáticas del colegio como "útil" para su desempeño en la universidad. Considerar la escala de utilidad como un rango del 1 al 5, donde útil es considerado el valor 4 de dicha escala. A su vez, se sabe que la media de dichos valores al azar es de 3.116.

Planteamos que $\mathbb{X}=\text{Utilidad de matematicas del colegio para la universidad}$ Queremos hallar $\mathbb{P}(\mathbb{X}=4)$

```{r}
probabilidad=dnorm(4,mu)
```

Entonces $\mathbb{P}(\mathbb{X}=4)= `r round(probabilidad*100,3)`$

Ahora compararemos el resultado de manera empírica.

```{r}
table(DF$UtilidadMate)
prob_emp=46/181#probabilidad
```

De manera empírica $\mathbb{P}(\mathbb{X}=4)= `r round(prob_emp*100,3)`$ De esta manera podríamos decir que nuestro modelo se asemeja a una distribución normal, mas no es exacta.

# Conclusiones

-   Se relacionó el nivel académico de la preparación escolar secundaria (utilidad, satisfacción, nivel de inglés) con el desempeño académico en UTEC (promedio ponderado).
-   Analizamos que existe una correlación significativa entre el nivel de preparación escolar propuestos de los estudiantes de UTEC.
-   Se logró determinar la relación que existe entre el colegio de procedencia con el éxito académico comparando los ponderados.
