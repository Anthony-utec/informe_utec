---
title: "Informe"
author: "Apprendizaje de Inglés"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
---


-   Tema delimitado:

Análisis de los factores involucrados y relaciones en el proceso de aprendizaje de inglés de los estudiantes de UTEC durante el periodo académico 2023-1.

# Introducción

## Relevancia

Nosotros hemos decidido realizar el tema por dos motivos principales:

-   Analizar cómo la carga académica de la malla curricular de cada estudiante afecta a la cantidad de tiempo y energía que los estudiantes de UTEC tienen disponible para dedicar al aprendizaje del inglés.

-   Entender los factores influyentes en el aprendizaje del inglés durante un ciclo regular, esta información es valiosa para maximizar el aprendizaje en entornos académicos con alta carga de trabajo, y también para la toma de decisiones en la planificación académica universitaria.

Es importante destacar que este estudio se centra en el periodo académico 2023-1 y en los estudiantes de UTEC. Esto nos permitirá obtener información específica y relevante para esta institución. Con estos datos, podremos realizar recomendaciones y conclusiones basadas en evidencia con el objetivo de mejorar el proceso de enseñanza-aprendizaje del inglés.

## Objetivos

-   Analizar las variables involucradas en el aprendizaje del inglés de los estudiantes de UTEC en el periodo 2023-1.

-   Identificar las dificultades, factores y circunstancias que enfrentan los estudiantes de UTEC y su relación con el aprendizaje del inglés durante el periodo 2023-1 en distintas instituciones que enseñan el inglés.

-   Informar al Centro de Idiomas Conversa Academics sobre los resultados académicos, incluyendo evaluaciones y nivel de competencia del idioma, que atraviesan sus estudiantes en comparación con otros centros de idiomas de inglés.

## Contexto:

Para facilitar un mejor aprendizaje del idioma, es importante tener en cuenta diversos aspectos, como los programas educativos, el periodo académico, la carga académica y las competencias lingüísticas necesarias para los estudiantes de UTEC. Con el fin de recopilar información sobre la correlación entre la carga académica del ciclo regular y el aprendizaje del inglés en los estudiantes de UTEC durante el periodo 2023-1, llevaremos a cabo este estudio.


# Análisis descriptivo

En este sección, presentaremos los análisis realizados en el informe pasado que nos sirvieron para realizar el siguiente ítem referido a probabilidad empírica , dependencia e independencia de eventos y el análisis de las variables discretas y continuas.

```{r}
library(readr)
library(dplyr)
DF <- read_csv("Data.csv")
```
```{r}
r <- function(n){
  round(n, 2)
}
```



```{r}
DF$Nivel_Competencia <- factor(DF$Nivel_Competencia, levels = c("Básico", "Intermedio", "Avanzado"), ordered = TRUE)

tail(DF$Nivel_Competencia)
```


## Nivel de Competencia por Instituto

```{r}

mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones de Inglés", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```

En nuestra muestra, el Instituto `Conversa Academics(UTEC)` tiene mas del 50% de sus estudiantes en el nivel Básico. Esto contrasta con los institutos `ICPNA` y `Británico` cuya mayoría de estudiantes se encuentra en Intermedio o Avanzado. Además, en nuestra muestra, Conversa no tiene estudiantes en nivel Avanzado.

## Promedio de inglés ante nivel de competencia

```{r}
boxplot(DF$Promedio_Ingles ~ DF$Nivel_Competencia
        , las = 1
        , varwidth = TRUE
        , col = c("lightgray", "lightblue" , "blue4" )
        
        ,main = "Promedio de Inglés de los Niveles de Competencia", 
        xlab = "Nivel de competencia del idioma",  
        ylab = "Promedio de inglés"  
        )

```

La gráfica sugiere que al menos el 75% (aproximadamente) de los estudiantes de nivel Avanzado poseen un promedio mayor o igual por lo menos el 75% (aproximadamente) de los estudiantes de nivel básico e intermedio.

## Nivel de Estrés contra Créditos

```{r}
boxplot(DF$Creditos ~ DF$Nivel_Estres , varwidth = T )
```

Si vemos solo los valores `3` , `4` y `5` de la variable `Nivel de Estres` por separado no encontramos una relación clara entre `Créditos` y `Nivel de Estres`. Por ello, a pesar de que al analizar los valores `1` y `2` de la variable `Nivel de Estres` podamos ver alguna relación, podríamos conseguir eventos independientes en base a estas dos variables 



# Análisi probabilistico

## Probabilidad Empírica

###Variable Nivel de Competencia

Definimos el siguiente experimento aleatorio:

`E1` : Escojo un estudiante de UTEC y observo el `Nivel de Compentencia` que presenta en el idioma Inglés.

Para determinar de manera correcta las probabilidades empíricas de los eventos atómicos mediante el uso de la muestra se tratará los `NA's` de la siguiente manera:

```{r}
DF <- DF %>% mutate(Nivel_Comp = coalesce(DF$Nivel_Competencia , "Indefinido"))
```

La columna `Nivel_Comp` tiene a los valores `NA` como indefinido. Puesto que en base a la muestra, al escoger al azar un estudiante de UTEC puede que no esté definido su `Nivel de Competencia`

```{r}
table(DF$Nivel_Comp)
```

#### Espacio de Resultados

Se definen los eventos atómicos: El estudiante tiene nivel Básico, El estudiante tiene nivel Intermedio y el estudiante tiene nivel Avanzado.

$$\Omega_{1} = \{Básico , Intermedio , Avanzado , Indefinido\}$$

$$F_{1} = 2^{|\Omega_{1}|} = 16$$

#### Cálculo de las probabilidades de los eventos atómicos

Calculamos las probabilidades atómicas.

```{r}
round(prop.table(table(DF$Nivel_Comp)), 2)
```

Se verifica que la suma de las probabilidades de los eventos atómicos de 1.

$$
\sum\mathbb{P}(Ea) = 1
$$

```{r}
sum(round(prop.table(table(DF$Nivel_Comp)), 2))
```

$$\mathbb{P}(Básico) = 0.31 \\ \mathbb{P}(Intermedio) = 0.39 \\ \mathbb{P}(Avanzado) = 0.26 \\ \mathbb{P}(Indefinido) = 0.04$$

Al escoger al azar un alumno de UTEC es más probable que sea del `Nivel Intermedio`. Además la probabilidad de que el alumno tenga un nivel `Indefinido` es baja en comparación al resto.



### Variable Nivel de Estrés

Justificación:

La variable nivel estrés está fuertemente relacionada con los objetivos número 1 y 2, el cual establece las dificultades y factores que podrían atravesar los estudiantes al momento de su aprendizaje de inglés, debido a que esta puede o no ser dependiente de otras variables del estudio y demostrar una relación con ellas.

`E2` : Escojo al azar un estudiante de UTEC y observo el `Nivel de Estres` que poseen en una escala del 1 al 5. Donde: 1 significa que tiene un nivel de estrés bajo y 5 significa que tiene un nivel de estrés alto.

Usamos nuestra muestra para representar los resultados del experimento `E2`

#### Espacio de Resultados

Los eventos atómicos para este experimento aleatorio son: El estudiante tiene el nivel 1, El estudiante tiene el nivel 2, el estudiante tiene el nivel 3, el estudiante tiene el nivel 4, El estudiante tiene el nivel 5.

$$\Omega_{2} = \{ 1 , 2 , 3 , 4 , 5\}$$ 


$$ {F}\_{2} = 2 ^ {\|\Omega{2}\|} = 32 $$

#### Cálculo de las probabilidades de los eventos atómicos

```{r}
table(DF$Nivel_Estres)
```


```{r}
round(prop.table(table(DF$Nivel_Estres)),2)
```


Se verifica que la suma de las probabilidades de los eventos atómicos de 1.


$$
\sum\mathbb{P}(Ea) = 1
$$


```{r}
sum(r(prop.table(table(DF$Nivel_Estres))))
```


$$\mathbb{P}(1) = 0.09 \\ \mathbb{P}(2) = 0.21 \\ \mathbb{P}(3) = 0.43 \\ \mathbb{P}(4) = 0.19 \\ \mathbb{P}(5) = 0.08$$

Si escojo al azar un alumno de UTEC lo más probable es que tenga un nivel de estrés medio (3 en la escala del 1 al 5).

## Eventos Dependientes e Independientes

Usaremos el siguiente criterio

$$|\mathbb{P}(AB) - \mathbb{P}(A)*\mathbb{P}(B)| < 0.01$$

para determinar la independencia de dos Eventos.

### Eventos Dependientes:

Inicialmente, las variables `Nivel de Competencia` e `Institución` no deberían estar relacionadas. Sin embargo, el `Gráfico de Mosaico` que se mostró en el apartado `Análisis Descriptivo` sugiere que sí tienen una relación.

Por ello, nos da una idea de que podría haber eventos relacionados a estas variables que sean dependientes.

`E3`: Escoger al azar un alumno de UTEC y anotamos su `Nivel de Competencia` y su `Institución`

Definimos los eventos A y B

`A` : Que el alumno sea de nivel Básico

`B` : Que el alumno sea del ICPNA

Los `NA` en la variable `Ins` son los alumnos que no están relacionados con ningún Instituto de Idiomas

```{r}
DF <- DF %>% mutate(Instituto = coalesce(DF$Ins , "Sin INS"))
```


```{r}
addmargins(table(DF$Nivel_Comp , DF$Instituto))
```

```{r}
PA<-(50/163)
PB<-(40/163)
PAB<-(8/163)
PA*PB
PAB
abs(PA*PB-PAB) < 0.01
```

La diferencia positiva entre la P(AB) y P(A)P(B) es mayor o igual a 0.01. Por lo tanto, son dependientes. Es decir, si escojo al azar un alumno de UTEC y tiene nivel `Básico`, esta premisa afecta en cierto sentido que el alumno provenga del instituto de idiomas `ICPNA`

Utilizamos Teorema de `Bayes`

```{r}
ProbAdadoB  <- 8/40
ProbBdadoA <- 8/50
```

Calculamos la $\mathbb{P}(A|B) $ con `Bayes`:

```{r}
ProbAdadoB

(ProbBdadoA*PA)/PB

PA
```

Probabilidad Total

Calcularemos la probabilidad B con la formula de probabilidad total

```{r}
PB
PA
ProbBdadoA
PAc <- 1 - PA
ProbBdadoAc <- 32/113

PA*ProbBdadoA + PAc*ProbBdadoAc
```

## Eventos independientes

Definimos el siguiente experimento aleatorio.

En base a lo mencionado en el apartado `Nivel de Estres contra Créditos` de la sección `Análisis descriptivo`, planteamos un experimento aleatorio y dos eventos asociados a esta variable. 

`E4`: Escoger un alumno al azar y fijarse en su número de `Créditos` y `Nivel de Estres`

Definimos los eventos E y F

`E`: Que el alumno tenga un nivel de estrés 5 (alto)

`F` : Que el alumno esté llevando un número de créditos académicos mayor o igual a 15


```{r}
DF$Rango_Creditos <- ifelse(DF$Creditos < 15, TRUE, FALSE)
addmargins(table(DF$Rango_Creditos , DF$Nivel_Estres))
```

```{r}
PE <- 13/163
PF <- 145/163

PEF  <-12/163

abs(PE*PF - PEF)  < 0.01 
```

La diferencia es menor que 0.01. Por lo tanto los eventos son aproximadamente Independientes. Es decir si selecciono al azar un alumno y este tiene un Promedio de Ingles mayor o igual a 15 no condiciona o afecta a que este tenga o no un nivel de estrés de 5.


```{r}
ProbEdadoF <- 12/145
ProbEdadoF
PE
```

$\mathbb{P}(E|F)$ es similar a $\mathbb{P}(E)$

Calculamos la $\mathbb{P}(E|F)$ con el teorema de `Bayes`:

```{r}
ProbEdadoF
ProbFdadoE <- 12/13
(ProbFdadoE*PE)/PF

PE
```

Notamos que la $\mathbb{P}(E|F)$ es similar a la $\mathbb{P}(E)$, se evidencia una vez más que son aproximadamente independientes.


## Variables Discretas

### Variable Meses de Estudio

Veamos el histograma de esta variable

```{r}
hist(DF$Meses_Estudio , prob = T,xlab="Meses de estudio", ylab="Densidad", main="Histograma: Meses de estudio general")
```
Notamos que tenemos datos por encima de los 36 meses que es el tiempo máximo de la duración de los principales programas de inglés. Por ello, estudiaremos a los alumnos que están entre 1 y 36 meses de estudio.

```{r}
data1 <- DF %>% filter(Meses_Estudio >= 1 & Meses_Estudio <= 36)

hist(data1$Meses_Estudio , prob = T, xlab="Meses de estudio", ylab="Densidad", main="Histograma: Meses de estudio reducido")
```
El histograma sugiere que podría asemejarse a un distribución `Geométrica`. 

Calculamos el parámetro `p` en base al valor esperado (Media).

```{r}
media <- mean(data1$Meses_Estudio)
media
p <- 1/media
p
var  <- var(data1$Meses_Estudio)
var
```


```{r}
var
Varx <- (1 -p)/(p*p)
Varx
```

```{r}
hist(data1$Meses_Estudio , prob = T, xlab="Meses de estudio", ylab="Densidad", main="Histograma: Meses de estudio reducido")
xs <- seq(0,35,1)
lines( xs , dgeom(xs , p) , col = "red")

```
La gráfica sugiere que podría haber una similitud con la Distribución `Geométrica`.

Sin embargo, no existe un experimento subyacente que pueda validar que esta similitud tenga sentido. No hay un éxito asociado a los valores de esta variable. Además, la variable `Meses de Estudio` no cuenta un número de intentos hasta la ocurrencia del primer éxito. 

### Variable NumCursos


```{r}
hist(DF$NumCursos , prob = T)
```
El histograma sugiere que podría ser semejante a una distribución `binomial`. Se procede a calcular sus parámetros

```{r}
media <- r(mean(DF$NumCursos))
media
var <- r(var(DF$NumCursos))
var
p <- 1 - (var/media)
p
n <- round((media/p))
n
```

Usamos la función `rbinom` para realizar un histograma y compararlo con el de la variable `Numero de Cursos`

```{r}
valores <- rbinom(163 , n , p)
hist(valores , breaks = 10 ,  prob = T,main = "Distribución Binomial" , xlab = "Valores" , ylab = "Frecuencias")
```
Notamos que los histogramas son similares. Sin embargo, no tiene sentido que la variable `Número de Cursos` sea binomial. No existe algún experimento subyacente asociado a esta variable que cuente el número de éxitos en `n` ensayos de Bernoulli. Por ello, no se puede decir que la variable siga una distribución binomial.

# Conclusiones

1) A través del análisis de la diferencia positiva entre la probabilidad conjunta P(AB) y la probabilidad P(A)P(B), siendo A: Que el alumno sea de nivel Básico y B:Que el alumno sea del ICPNA , que resulta ser mayor o igual a 0.01. Podemos afirmar que la intuición previa de que el nivel de competencia de un estudiante y la institución a la que pertenece no están relacionados puede ser refutada debido a la dependencia de los eventos anteriormente propuestos 

2) Mediante el análisis de la independencia de los eventos E y F:
E: Que el alumno tenga un nivel de estrés 5 (alto)
F : Que el alumno esté llevando un número de créditos académicos mayor o igual 15.
Se concluye que la intuición inicial de que el tener un estrés alto se relaciona con los créditos académicos cursados puede ser refutada, debido a la independencia de los eventos anteriormente propuestos. 










