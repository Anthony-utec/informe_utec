---
title: "Análisis de los factores involucrados y relaciones en el proceso de aprendizaje
  de inglés de los estudiantes de UTEC durante el periodo académico 2023-1."
output:
  ioslides_presentation:
    widescreen: yes
    smaller: yes
    css: styles.css
  slidy_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Datos previos
<br></br>
**Objetivos**

-   Analizar las variables involucradas en el aprendizaje del inglés de los estudiantes de UTEC en el periodo 2023-1.

-   Identificar las dificultades, factores y circunstancias que enfrentan los estudiantes de UTEC y su relación con el aprendizaje del inglés durante el periodo 2023-1 en distintas instituciones que enseñan el inglés.

-   Informar al Centro de Idiomas Conversa Academics sobre los resultados académicos, incluyendo evaluaciones y nivel de competencia del idioma, que atraviesan sus estudiantes en comparación con otros centros de idiomas de inglés.

**Población, muestra y muestreo**

-   Población : Estudiantes de UTEC

-   Muestra : 163 Estudiantes de UTEC que respondieron la encuesta

-   Muestreo : Muestreo por conveniencia.

<br></br>
<br></br>
 Variables

| Variables                                                                         | Tipo                 | Restricción                                                                                                                                                          |
|------------------|------------------|-----------------------------------|
| `Créditosacadémicos (Creditos)`                                                   | Numérica → Discreta  | Números enteros mayor o igual a 12 y menor igual a 26.                                                                                                               |
| `Número de cursos (NumCursos)`                                                    | Numérica → Discreta  | Números enteros positivos enteros mayor o igual a 3 y menor o igual que 9 cursos.                                                                                    |
| `Promedio ponderado de exámenes de inglés (Promedio_Ingles)`                      | Numérica → Discreta  | Números positivos mayor igual a 0 y menor o igual a 20.                                                                                                              |
| `Estado emocional (Nivel_Estres)`                                                 | Categórica → Ordinal | Nivel de estado emocional en una escala del 1 al 5.                                                                                                                  |
| `Nivel de competencia (Nivel_Competencia)`                                        | Categórica → Nominal | Básico, Intermedio o Avanzado .                                                                                                                                      |
| `Número de meses estudiando (Meses_Estudio)`                                      | Numérica → Discreta  | Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA.                      |
| `Cantidad de horas dedicadas en el estudio de ingles a la semana (Horas_Estudio)` | Categórica → Nominal | Rangos de horas: "0 h", "1 a 2h","3 a 4h", "más de 4h", en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. |

| `Instituto de idiomas donde estudias ingles (Instituto)` \| Categórica → Nominal \| Alternativas de instituto de idiomas: ICPNA, Británico, Conversa Academics y otros, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. \|
| `Calidad de enseñanza de tu formación del inglés (Calidad)` \| Categórica → Ordinal \| Alternativas desde Deficiente a Excelente en una escala del 1 al 5, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. \|
| `Dificultades para aprender inglés (Factor)` \| Categórica → Nominal \| Alternativas entre: Carga académica, Escasa motivación, Escasos recursos adecuados, otros. \|
| `Horario disponible para clases de inglés (Horario_estudio_ingles)` \| Categórica → Nominal \| Alternativas entre: Mañana, tarde y noche. \|
| `Día disponibles para clases de inglés (Dias_clases)` \| Categórica → Nominal \| Alternativas entre: Diario, Fines de semana e intermediario. \|
| `Clases asistidas (Clases_asistidas)` \| Numérica → Discreta \| Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. \|
| `Clases totales (Clases_totales)` \| Numérica → Discreta \| Números enteros mayor o igual a 1, en el caso que hayan respondido que sí estudiaron en un centro de idiomas, caso contrario es considerado NA. \|
| `Porcentaje de asistencia (Porcentaje_asist)` \| Numérica → Continua \| Números positivos mayor o igual a 0% y menor o igual a 100% \|
| `Números de tareas asignadas de la UTEC (Tareas_semana)` \| Numérica → Discreta \| Número enteros positivos mayor o igual a 1 y menor o igual a 15 tareas. \|


```{r}
library(readr)
library(dplyr)
DF <- read_csv("Data.csv")
```

```{r}
r <- function(n){
  round(n, 2)
}
```

```{r}
DF$Nivel_Competencia <- factor(DF$Nivel_Competencia, levels = c("Básico", "Intermedio", "Avanzado"), ordered = TRUE)

tail(DF$Nivel_Competencia)
```

Nivel de Competencia por Instituto

```{r}

mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones de Inglés", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```

En nuestra muestra, el Instituto `Conversa Academics(UTEC)` tiene mas del 50% de sus estudiantes en el nivel Básico. Esto contrasta con los institutos `ICPNA` y `Británico` cuya mayoría de estudiantes se encuentra en Intermedio o Avanzado. Además, en nuestra muestra, Conversa no tiene estudiantes en nivel Avanzado.

Promedio de inglés ante nivel de competencia

```{r}
boxplot(DF$Promedio_Ingles ~ DF$Nivel_Competencia
        , las = 1
        , varwidth = TRUE
        , col = c("lightgray", "lightblue" , "blue4" )
        
        ,main = "Promedio de Inglés de los Niveles de Competencia", 
        xlab = "Nivel de competencia del idioma",  
        ylab = "Promedio de inglés"  
        )

```

La gráfica sugiere que al menos el 75% (aproximadamente) de los estudiantes de nivel Avanzado poseen un promedio mayor o igual por lo menos el 75% (aproximadamente) de los estudiantes de nivel básico e intermedio.

Nivel de Estrés contra Créditos

```{r}
boxplot(DF$Creditos ~ DF$Nivel_Estres , varwidth = T )
```

Si vemos solo los valores `3` , `4` y `5` de la variable `Nivel de Estres` por separado no encontramos una relación clara entre `Créditos` y `Nivel de Estres`. Por ello, a pesar de que al analizar los valores `1` y `2` de la variable `Nivel de Estres` podamos ver alguna relación, podríamos conseguir eventos independientes en base a estas dos variables


## Probabilidad Empírica-Nivel de Competencia
<br></br>

<div class="columns">
  <div class="column">
  Gráfica 1:
    ```{r fig.width=5.5, fig.height=4}
mosaicplot(table(DF$Ins, DF$Nivel_Competencia), 
           las = 1, col = c("lightgray", "lightblue", "blue4")
        ,main = "Nivel de Competencia de Instituciones", 
        xlab ="Instituciones de Inglés",
        ylab = "Nivel de Competencia"  
        )
```
  </div>
  <div class="column">
  Gráfica 2:
    ```{r fig.width=5.5, fig.height=4}
boxplot(DF$Promedio_Ingles ~ DF$Nivel_Competencia
        , las = 1
        , varwidth = TRUE
        , col = c("lightgray", "lightblue" , "blue4" )
        
        ,main = "Promedio de Inglés de los Niveles de Competencia", 
        xlab = "Nivel de competencia del idioma",  
        ylab = "Promedio de inglés"  
        )
```
  </div>
</div>

```{r}
DF <- DF %>% mutate(Nivel_Comp = coalesce(DF$Nivel_Competencia , "Indefinido"))
```

## Datos para el experimento 1
**Espacio de Resultados**

Se definen los eventos atómicos: El estudiante tiene nivel Básico, El
estudiante tiene nivel Intermedio y el estudiante tiene nivel Avanzado.

$$\Omega_{1} = \{Básico , Intermedio , Avanzado , Indefinido\}$$

$$F_{1} = 2^{|\Omega_{1}|} = 16$$

**Cálculo de las probabilidades de los eventos atómicos**

```{r}
round(prop.table(table(DF$Nivel_Comp)), 2)
```

Se verifica que la suma de las probabilidades de los eventos atómicos de
1.

$$
\sum\mathbb{P}(Ea) = 1
$$

```{r echo=TRUE}
sum(round(prop.table(table(DF$Nivel_Comp)), 2))
```

## Datos para el experimento 2
#### Espacio de Resultados

Los eventos atómicos para este experimento aleatorio son: El estudiante
tiene el nivel 1, El estudiante tiene el nivel 2, el estudiante tiene el
nivel 3, el estudiante tiene el nivel 4, El estudiante tiene el nivel 5.

$$\Omega_{2} = \{ 1 , 2 , 3 , 4 , 5\}$$

$$ {F}\_{2} = 2 ^ {\|\Omega{2}\|} = 32 $$

```{r}
table(DF$Nivel_Estres)
```

```{r}
r(prop.table(table(DF$Nivel_Estres)))
```

Se verifica que la suma de las probabilidades de los eventos atómicos de
1.

$$
\sum\mathbb{P}(Ea) = 1
$$

```{r}
sum(r(prop.table(table(DF$Nivel_Estres))))
```


## Experimento aleatorio 1 Y 2

`E1` : Escojo un estudiante de UTEC y observo el `Nivel de Compentencia`  de idioma Inglés.

```{r include=FALSE}
DF <- DF %>% mutate(Nivel_Comp = coalesce(DF$Nivel_Competencia , "Indefinido"))
```

```{r include=FALSE}
table(DF$Nivel_Comp)
```


```{r include=FALSE}
round(prop.table(table(DF$Nivel_Comp)), 2)
```

```{r include=FALSE}
sum(round(prop.table(table(DF$Nivel_Comp)), 2))
```

$$\mathbb{P}(Básico) = 0.31 \\ \mathbb{P}(Intermedio) = 0.39 \\ \mathbb{P}(Avanzado) = 0.26 \\ \mathbb{P}(Indefinido) = 0.04$$

Al escoger al azar un alumno de UTEC es más probable que sea del `Nivel Intermedio`.

`E2` : Escojo al azar un estudiante de UTEC y observo el `Nivel de Estres` que poseen en una escala del 1 al 5. Donde: 1 significa que tiene un nivel de estrés bajo y 5 significa que tiene un nivel de estrés alto.


```{r include=FALSE}
table(DF$Nivel_Estres)
```

```{r include=FALSE}
r(prop.table(table(DF$Nivel_Estres)))
```

```{r include=FALSE}
sum(r(prop.table(table(DF$Nivel_Estres))))
```

$$\mathbb{P}(1) = 0.09 \\ \mathbb{P}(2) = 0.21 \\ \mathbb{P}(3) = 0.43 \\ \mathbb{P}(4) = 0.19 \\ \mathbb{P}(5) = 0.08$$

Si escojo al azar un alumno de UTEC lo más probable es que tenga un nivel de estrés medio (3 en la escala del 1 al 5).

## Eventos Dependientes e Independientes

Usaremos el siguiente criterio para determinar la independencia de dos Eventos.

$$|\mathbb{P}(AB) - \mathbb{P}(A)*\mathbb{P}(B)| < 0.01$$

Inicialmente, intuimos que un estudiante tenga un determinado `Nivel de Competencia` y pertenezca a una determinada `Institución` no deberían estar relacionados.

**Experimento 3**: Escoger al azar un alumno de UTEC y anotamos su `Nivel de Competencia` y su `Institución`

`Evento A` : Que el alumno sea de nivel Básico

`Evento B` : Que el alumno sea del ICPNA
```{r}
DF <- DF %>% mutate(Instituto = coalesce(DF$Ins , "Sin INS"))
```

```{r include=TRUE}
addmargins(table(DF$Nivel_Comp , DF$Instituto))
```

```{r include=TRUE}
PA<-(50/163)
PB<-(40/163)
PAB<-(8/163)
```

```{r echo=TRUE}
abs(PA*PB-PAB) < 0.01 
```

Teorema de Bayes en el experimento 3

```{r echo=FALSE}
ProbAdadoB  <- 8/40
ProbBdadoA <- 8/50
```

Calculamos la $\mathbb{P}(A\|B)$  con Bayes:

```{r echo=TRUE}
(ProbBdadoA*PA)/PB
PA
```

Probabilidad Total

Calcularemos la probabilidad B con la formula de probabilidad total

```{r echo=TRUE}
PB
PA
ProbBdadoA
PAc <- 1 - PA
ProbBdadoAc <- 32/113

PA*ProbBdadoA + PAc*ProbBdadoAc
```


## Eventos independientes

```{r include=FALSE}
DF$Rango_Creditos <- ifelse(DF$Creditos < 15, TRUE, FALSE)
```

<div class="columns">
  <div class="column">
  Grafica1:
    ```{r  fig.width=5.2, fig.height=3.5}
boxplot(DF$Creditos ~ DF$Nivel_Estres)
```
 
  </div>
  <div class="column">
    Aplicando addmargins con Créditos<15 y Nivel de estrés
    
    ```{r include=TRUE}
addmargins(table(DF$Rango_Creditos , DF$Nivel_Estres))
```

    ```{r echo=TRUE}
PE <- 13/163
PF <- 145/163
PEF  <-12/163
```
  </div>
</div>



`Evento_E`: Que el alumno tenga un nivel de estrés 5 (alto)

`Evento_F` : Que el alumno esté llevando un número de créditos académicos mayor o igual a 15

```{r echo=TRUE}
abs(PE*PF - PEF)  < 0.01 
```

Por lo tanto los eventos son aproximadamente independientes. Es decir, si selecciono al azar un alumno y este tiene un Promedio de Ingles mayor o igual a 15 no condiciona a que este tenga o no un nivel de estrés de 5.





```{r }
ProbEdadoF <- 12/145
ProbEdadoF
PE
```

$\mathbb{P}(E|F)$ es similar a $\mathbb{P}(E)$

 Utilizando Teorema de Bayes

Calculamos la $\mathbb{P}(E|F)$ con Bayes:

```{r echo=TRUE}
ProbEdadoF
ProbFdadoE <- 12/13
(ProbFdadoE*PE)/PF

PE
```

Notamos que la $\mathbb{P}(E|F)$ es similar a la $\mathbb{P}(E)$, se evidencia una vez más que son aproximadamente independientes


## Variables Discretas - Meses de Estudio
<div class="columns">
  <div class="column">
  Veamos el histograma de esta variable

```{r fig.width=5.5, fig.height=4}
hist(DF$Meses_Estudio , prob = T)
```

Notamos que tenemos datos por encima de los 36 meses que es el tiempo máximo de la duración de los principales programas de inglés. Por ello, estudiaremos a los alumnos que están entre 1 y 36 meses de estudio.

  </div>
  <div class="column">
    Grafica 2

```{r fig.width=5.5, fig.height=4}
data1 <- DF %>% filter(Meses_Estudio >= 1 & Meses_Estudio <= 36)
hist(data1$Meses_Estudio , prob = T)
```
  <h5>El histograma sugiere que podría asemejarse a un distribución `Geométrica`.</h5>
  </div>
</div>

## Media varianza y "p"
<div class="columns">
  <div class="column">
  Calculamos el parámetro `p` en base al valor esperado (Media).

```{r echo=TRUE}
media <- mean(data1$Meses_Estudio)
```

```{r include=TRUE}
media
```

```{r echo=TRUE}
p <- 1/media
```

```{r include=TRUE}
p
```

```{r echo=TRUE}
var  <- var(data1$Meses_Estudio)
```

```{r include=TRUE}
var
```


```{r echo=TRUE}
Varx <- (1 -p)/(p*p)
```

```{r include=TRUE}
Varx 
```

  </div>
  <div class="column">
    Gráfica 2
```{r fig.width=5.5, fig.height=4}
hist(data1$Meses_Estudio , prob = TRUE)
xs <- seq(1,36,1)
lines( xs , dgeom(xs , p) , col = "red")

```
  <h5>La gráfica sugiere que podría haber una similitud con la Distribución `Geométrica`. Sin embargo, no existe un experimento subyacente que pueda validar que esta similitud tenga sentido. No hay un éxito asociado a los valores de esta variable. Además, la variable `Meses de Estudio` no cuenta un número de intentos hasta la ocurrencia del primer éxito.</h5>
  </div>
</div>


## Variable Número de Cursos

<div class="columns">
  <div class="column">
  Gráfica 1
```{r fig.width=5.5, fig.height=4}
hist(DF$NumCursos , prob = T, xlab="Número cursos", ylab="Densidad", main="Gráfica")
```
El histograma sugiere que podría ser semejante a una distribución `binomial`. Se procede a calcular sus parámetros

```{r}
media <- r(mean(DF$NumCursos))
media
var <- r(var(DF$NumCursos))
var
p <- 1 - (var/media)
p
n <- round((media/p))
n
```

  </div>
  <div class="column">
    Usamos la función `rbinom` para realizar un histograma y compararlo con el de la variable `Numero de Cursos`

```{r fig.width=5.5, fig.height=4}
valores <- rbinom(163 , n , p)
hist(valores , breaks = 10 ,  prob = T,main = "Distribución Binomial" , xlab = "Valores" , ylab = "Frecuencias")
```
<h5>Notamos que los histogramas son similares. Sin embargo, no tiene sentido que la variable `Número de Cursos` sea binomial. No existe algún experimento subyacente asociado a esta variable que cuente el número de éxitos en `n` ensayos de Bernoulli. Por ello, no se puede decir que la variable siga una distribución binomial.</h5>
  </div>
</div>



## Conclusiones
<br></br>


1.  A través del análisis de la diferencia positiva entre la probabilidad conjunta P(AB) y la probabilidad marginal P(A)P(B), que resulta ser mayor o igual a 0.01, podemos afirmar que la intuición previa de que el nivel de competencia de un estudiante y la institución a la que pertenece es inválida. Estos dos eventos parecen ser dependientes. Esta conclusión sugiere que el nivel de competencia de un estudiante no está determinado por la institución a la que asiste, y viceversa.

2. Mediante el análisis de la independencia de los eventos E y F:
E: Que el alumno tenga un nivel de estrés 5 (alto)
F : Que el alumno esté llevando un número de créditos académicos mayor o igual 15.
Se concluye que la intuición inicial de que el tener un estrés alto se relaciona con los créditos académicos cursados puede ser refutada, debido a la independencia de los eventos anteriormente propuestos. 


