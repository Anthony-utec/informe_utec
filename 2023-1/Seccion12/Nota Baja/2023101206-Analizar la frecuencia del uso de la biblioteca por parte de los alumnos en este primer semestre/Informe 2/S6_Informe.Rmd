---
title: "Informe"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
    toc_deph: 5
    toc_float:
      collapsed: false
      smooth_scroll: true
editor: 
  markdown: 
    wrap: 72
---

**Tema: Analizar la frecuencia del uso de la biblioteca por parte de los
alumnos en el primer semestre educativo del año 2023** 

# **I.Introducción**

## Relevancia

El tema investigado en este proyecto es relevante, porque nos permite
saber si la biblioteca de UTEC sigue siendo la primera opción de los
alumnos para desarrollar actividades académicas, búsqueda de información
bibliográfica o uso del Internet.

## Objetivos

El objetivo general de esta investigación es analizar que tan concurrida
es la biblioteca de UTEC en este primer semestre del año 2023.\
Los objetivos específicos alineados a este trabajo son los siguientes:

1)  Determinar que tan seguido leen y que tipos de textos leen los
    alumnos de UTEC.
2)  Estudiar que otro lugar, dentro de la UTEC, prefieren los alumnos
    para desarrollar actividades académicas.
3)  Determinar cuáles son los factores que influyen en los alumnos para
    usar y no usar la biblioteca.
4)  Analizar si la biblioteca influye en las notas de los alumnos.

## Contexto

La biblioteca es un espacio imprescindible en una universidad, este
espacio tiene la finalidad de promover la información, el conocimiento y
la cultura. Almacena y ofrece diversos recursos de información, como
libros, revistas, periódicos, archivos digitales, audios, videos y otros
materiales de lectura o consulta. También ofrece a los visitantes
servicios de préstamos de materiales, espacios de estudio o acceso a
computadoras con Internet. Por lo cual no es necesario sobre pensar que
este lugar sea uno de los más concurridos en una universidad.

# **II.Datos**

## Recolección de datos

### 1.E**stablecer el método de recolección de datos**

Para obtener la información necesaria para nuestro proyecto, se optó por
trabajar con los métodos de recolección de datos primarios(Encuesta),
esto debido a que resulta más fácil y accesible la comunicación con
nuestro público objetivo.

### 2. **Elegir del medio y vía para la recopilación**

Se optó por hacerlo de 2 maneras: online, el cual fue difundido por las
redes sociales más usadas por los estudiantes en UTEC siendo estas
WhatsApp o Telegram. De igual manera, se llevó a cabo la recolección de
datos de manera presencial, distribuyéndonos en los pisos más
concurridos, siendo estos los pisos 1,6 y 11.

### 3. **Definir el número mínimo de observaciones**

Se propuso recolectar una cantidad mínima de 150 observaciones para
nuestro proyecto a realizar.

### 4. **Definir el número de variables a utilizar**

Se consideró trabajar con una cantidad importante de variables
cuantitativas y cualitativas, llegando a alcanzar un total de 19
variables con los cuales se procederá a trabajar.

### 5. **Ejecutar el plan de recolección**

La recolección se realizó de manera satisfactoria a través de un
enlace([Link de la encuesta](https://forms.gle/orDFFXxG82Z7kLH28)) de
manera online. A su vez se generó un código QR que los dirigía
automáticamente a la encuesta, a los alumnos que lo rellenaron de manera
presencial.

### 6. **Condiciones para realizar la encuesta**

La condición establecida para la recolección de datos fue que se debía
alcanzar un mínimo de 150 observaciones.

## Población, muestra y muestreo

### Población

La población de estudio se encuentra compuesta por estudiantes de UTEC
con edades entre los 16 y 28 años.

### Muestra

Nuestra muestra representativa es de 154 encuestados.

### Muestreo

Muestreo no probabilístico (muestreo intencional o por juicio), con este
método escogeremos a los estudiantes que formarán parte de nuestra
encuesta.

## Variables

| Variable          | Descripción                                                       | Tipo de Variable   | Restricciones                                                                                                                                    |
|------------|-------------|------------|----------------------------------|
| HorasAsis         | Horas de uso de la biblioteca                                     | Numérica continua  | Se pueden ingresar números positivos enteros o decimales redondeando a un solo decimal.                                                          |
| Edad              | Edad de los estudiantes UTEC                                      | Numérica discreta  | Cuenta con 13 alternativas cada una correspondiente a las diferentes edades del 16 al 28 y está limitado a solo marcar 1.                        |
| Acomputadoras     | Acciones al reservar una computadora                              | Categórica nominal | Cuenta con 4 opciones como por ejemplo realizar tareas o dar exámenes y esta limitado a solo marcar 1.                                           |
| ActPEr            | Actividades personales en la biblioteca                           | Categórica nominal | Cuenta con 3 opciones como por ejemplo hablar o reposar y esta limitado a solo marcar 1.                                                         |
| OtrosEspacios     | Qué espacios de estudio se utilizan aparte de la biblioteca       | Categórica nominal | Cuenta con 4 opciones como por ejemplo sala de estudio o salón vacío y esta limitado a solo marcar 1.                                            |
| Carrera           | Carrera que cursa el encuestado                                   | Categórica nominal | Cuenta con las carreras actuales de la UTEC.                                                                                                     |
| Asistencia        | ¿El encuestado va a la biblioteca?                                | Categórica nominal | Cuenta con 2 opciones entre sí y no , y esta limitado a solo marcar 1.                                                                           |
| Actividades       | Acciones que realiza en la biblioteca                             | Categórica nominal | Cuenta con 4 opciones entre las cuales se encuentran leer un libro o usar las computadoras , y esta limitado a solo marcar 1.                    |
| FrecuenciaLec     | Frecuencia de lectura del encuestado                              | Categórica ordinal | Cuenta con 5 opciones, ente los cuales se encuentran "Interdiario", "Diariamente", y esta limitado a una opción como respuesta.                  |
| Preferencias      | Tipos de libros que lees                                          | Categórica nominal | Cuenta con 2 opciones, entre los cuales se encuentra "Académicos" y "Literarios"; y esta limitada a una opción como respuesta.                   |
| Tipo de libros    | A que asignatura pertenece el libro que lee el encuestado         | Categórica nominal | Cuenta con 4 opciones, entre los cuales se encuentra "Química", "Matemática"; y esta limitada a una opción como respuesta.                       |
| Rendimiento1      | Mejora de notas al usar las computadoras en la biblioteca         | Categórica nominal | Esta limitada a dos opciones "Si" y "No".                                                                                                        |
| Implementaciones  | Mejoras a la biblioteca al usar las computadoras                  | Categórica nominal | Esta limitada a aparecer únicamente si anteriormente marcaste la opción de uso de computadoras.                                                  |
| Rendimiento 2     | Mejora de notas al usar los libros de la biblioteca               | Categórica nominal | Esta limitada a dos opciones "Si" y "No".                                                                                                        |
| Recomendaciones 1 | Mejoras a la biblioteca al usar libros                            | Categórica nominal | Esta limitada a aparecer únicamente si anteriormente marcaste la opción de uso de libros.                                                        |
| Rendimiento 3     | Mejora de notas al usar la biblioteca para actividades personales | Categórica nominal | Esta limitada a dos opciones "Si" y "No".                                                                                                        |
| Recomendaciones 2 | Mejoras a la biblioteca al usarla para actividades personales     | Categórica nominal | Esta limitada a aparecer únicamente si anteriormente marcaste la opción de actividades personales en la biblioteca.                              |
| Motivo            | ¿Por qué el encuestado no usa la biblioteca?                      | Categórica nominal | Cuenta con 4 opciones, entre los cuales se encuentra "Siempre lo veo lleno", "Prefiero estar solo"; y esta limitada a una opción como respuesta. |
| MejorasBiblio     | Mejoras a la biblioteca para asistir a ella                       | Categórica nominal | Esta limitada a aparecer únicamente si anteriormente marcaste la opción de no frecuentar la biblioteca.                                          |

```{r}
list.of.packages <- c("readr","dplyr","ggplot2","stringr","stringi","tidyverse","modeest")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)

```

```{r}
library(readr)
library(dplyr)
library(stringr)
library(stringi)
library(ggplot2)
library(tidyverse)
library(modeest)
```

```{r}
DF <- read_csv("Encuestados1.csv")
```

```{r}
DF$`Marca temporal` <- NULL
DF$`Dirección de correo electrónico` <- NULL
DF
```

```{r}
DF <- rename(DF, Edad = `¿Qué edad tienes?`, Carrera = `¿Que carrera estudias?`, Asistencia = `¿Sueles frecuentar la biblioteca`, HorasAsis = `¿Cuántas horas al día vas a la biblioteca ? (en horas; ejemplo: 3 horas y media=3.5 h)`, Actividades = `¿Qué acciones realizas en la biblioteca`, Motivo = `¿Por qué no usas la biblioteca?`, OtrosEspacios = `¿Qué otro lugar prefieres antes de la biblioteca?`, MejorasBiblio = `¿Qué mejorarías a la biblioteca para empezar a usarla?`, AComputadoras = `¿Qué acciones realizas al reservar una computadora?`, Rendimiento1 = `¿Tuviste una mejora en tus notas al utilizar este espacio educativo?...11`, Implementaciones = `¿Crees que la biblioteca puede ser mejor? ¿Qué mejoras implementarías?`, FrecuenciaLec = `¿Cuán seguido lees?`, Preferencias =`¿Qué tipo de libros lees más?\n`, Tipodelibros = `¿De qué asignatura son los libros académicos que sueles leer?\n`, Rendimiento2 = `¿Tuviste una mejora en tus notas al utilizar este espacio educativo?...16`, Recomendaciones1 = `¿Crees que la biblioteca puede ser mejor y que mejora le harías?...17`, ActPEr = `¿Qué actividades personales realizas en la biblioteca?`, Rendimiento3 = `¿Tuviste una mejora en tus notas al utilizar este espacio educativo?...19`, Recomendaciones2 = `¿Crees que la biblioteca puede ser mejor y que mejora le harías?...20`) 


```

```{r}
summary(DF)
```

```{r}
DFSi <- DF[grep("Sí", DF$Asistencia),]
DFSi
```

```{r}
DFSi %>% select(-6) %>% select(-6) %>% select(-6)-> DFSi
DFSi
```

```{r}
DFNo <- DF[grep("No", DF$Asistencia),]
DFNo
```

```{r}
DFNo <- DFNo[, -c(4,5,9,10,11,12,13,14,15,16,17,18,19)]
DFNo
```

```{r}
table(complete.cases(DFNo), useNA = "ifany")
```

```{r}
RendimientoTotal <- data.frame(cbind(DFSi$Rendimiento1,DFSi$Rendimiento2,DFSi$Rendimiento3))
RendimientoTotal[RendimientoTotal == "Sí"] <- "1"
RendimientoTotal[RendimientoTotal == "No"] <- "0"
RendimientoTotal[is.na(RendimientoTotal)] <- "0"
RendimientoTotal$X1 <- as.numeric(RendimientoTotal$X1)
RendimientoTotal$X2 <- as.numeric(RendimientoTotal$X2)
RendimientoTotal$X3 <- as.numeric(RendimientoTotal$X3)
DFSi <- cbind(DFSi,(RendimientoTotal$X1 + RendimientoTotal$X2 + RendimientoTotal$X3))
RendimientoTotalDF <- data.frame(cbind(DF$Rendimiento1,DF$Rendimiento2,DF$Rendimiento3))
RendimientoTotalDF[RendimientoTotalDF == "Sí"] <- "1"
RendimientoTotalDF[RendimientoTotalDF == "No"] <- "0"
RendimientoTotalDF[is.na(RendimientoTotalDF)] <- "0"
RendimientoTotalDF$X1 <- as.numeric(RendimientoTotalDF$X1)
RendimientoTotalDF$X2 <- as.numeric(RendimientoTotalDF$X2)
RendimientoTotalDF$X3 <- as.numeric(RendimientoTotalDF$X3)
DF <- cbind(DF,(RendimientoTotalDF$X1 + RendimientoTotalDF$X2 + RendimientoTotalDF$X3))
```

```{r}
DFSi %>% rename( RenTotal = `(RendimientoTotal$X1 + RendimientoTotal$X2 + RendimientoTotal$X3)`) -> DFSi
DFSi$RenTotal <- as.character(DFSi$RenTotal)
DFSi$`Rendimiento1` <- NULL
DFSi$`Rendimiento2` <- NULL
DFSi$`Rendimiento3` <- NULL
DFSi$RenTotal[DFSi$RenTotal == "1"] <- "Sí"
DFSi$RenTotal[DFSi$RenTotal == "0"] <- "No"
DF %>% rename( RendimientoTotal = `(RendimientoTotalDF$X1 + RendimientoTotalDF$X2 + RendimientoTotalDF$X3)`) -> DF
DF$RendimientoTotal <- as.character(DF$RendimientoTotal)
DF$`Rendimiento1` <- NULL
DF$`Rendimiento2` <- NULL
DF$`Rendimiento3` <- NULL
DF$RendimientoTotal[DF$RendimientoTotal == "1"] <- "Sí"
DF$RendimientoTotal[DF$RendimientoTotal == "0"] <- "No"
```

```{r}
DF %>% select(HorasAsis) %>% group_by(HorasAsis) %>% summarize(n()) 
```

```{r}
DFSi$HorasAsis = as.numeric(gsub("[^0-9.]+", "", DFSi$HorasAsis))
table(DFSi$HorasAsis)
which(DFSi$HorasAsis == "0.1")
which(DFSi$HorasAsis == "1.5")
which(DFSi$HorasAsis == "7.556")
which(DFSi$HorasAsis == "12")
```

```{r}
DFSi$HorasAsis[40] <- 1
DFSi$HorasAsis[42] <- 2
DFSi$HorasAsis[58] <- 8
DFSi$HorasAsis[59] <- 2
DFSi$HorasAsis[74] <- 2
```

```{r}
DFSi %>% select(HorasAsis) %>% group_by(HorasAsis) %>% summarize(n())
```

```{r}
DFSi$HorasAsis <- as.numeric(DFSi$HorasAsis)
```

```{r}
DFCom <- DFSi[grep("Usar la computadora", DFSi$Actividades),]
```

```{r}
DFlib <- DFSi[grep("Recoger un libro", DFSi$Actividades),]
```

```{r}
DFlib2 <- DFSi[grep("Leer un libro", DFSi$Actividades),]
```

```{r}
DFLibro <- rbind(DFlib, DFlib2)
```

```{r}
DFAP <- DFSi[grep("Actividades personales", DFSi$Actividades),]
```

```{r}
DFIn <- DFCom[grep("Investigar sobre trabajos de la universidad", DFCom$AComputadoras),]
```

```{r}
DFClass <- DFCom[grep("Recibir clases en ella", DFCom$AComputadoras),]
```

```{r}
DFEx <- DFCom[grep("Dar o realizar exámenes", DFCom$AComputadoras),]
```

```{r}
DFTar <- DFCom[grep("Realizar tareas", DFCom$AComputadoras),]
```

```{r}
DFAca <- DFLibro[grep("Académicos", DFLibro$Preferencias),]
```

```{r}
DFLiter <- DFLibro[grep("Literarios", DFLibro$Preferencias),]
```

```{r}
DFFis <- DFLibro[grep("Física", DFLibro$Tipodelibros),]
```

```{r}
DFQui <- DFLibro[grep("Química", DFLibro$Tipodelibros),]
```

```{r}
DFCS  <- DFLibro[grep("Ciencias de computadoras (programación)", DFLibro$Tipodelibros),]
```

```{r}
DFMate <- DFLibro[grep("Matemática", DFLibro$Tipodelibros),]
```

```{r}
DFHablar <- DFAP[grep("Hablar", DFAP$ActPEr),]
```

```{r}
DFDescan <- DFAP[grep("Reposar", DFAP$ActPEr),]
```

```{r}
DFBusca <- DFAP[grep("Buscar a un compañero", DFAP$ActPEr),]
```

# **III.Análisis descriptivo**

## Descriptores numéricos

### Univariado

#### Variables categóricas

El único descriptor numérico para las variables presentadas es la moda.

```{r}
cat("Moda de preferencia de otros lugares: ", mfv(DFNo$OtrosEspacios),'\n')
```

El lugar de preferencia de las personas que no frecuentan la biblioteca
es "salas de estudio o cubículos".

```{r}
cat("Moda de preferencia por actividades que se realizan en la biblioteca:",mfv(DFSi$Actividades),'\n')
```

La actividad más realizada por los encuestados al momento de frecuentar
la biblioteca es realizar "actividades personales" ,la cual consiste en
el uso del espacio como son las mesas , sofás , etc.

```{r}
cat("Moda de frecuencia de lectura por parte de los alumnos: ",mfv(DF$FrecuenciaLec, na_rm=T),'\n')
```

La frecuencia de lectura de los encuestados que asisten a la biblioteca
en busca de un libro es "Diariamente".

```{r}
cat("Moda del tipo de libro que lee el encuestado: ",mfv(DF$Preferencias, na_rm=T),'\n')
```

Los libros académicos son los libros de mayor preferencia para los
encuestados que tienen el hábito de leer.

```{r}
cat("Moda de la asignatura que pertenece el libro que lee el encuestado: ",mfv(DF$Tipodelibros, na_rm=T),'\n')
```

Los libros que más escogen los encuestados que frecuentan leer un libro
es de "Física"

```{r}
cat("Moda de que motivos influyen en el encuestado para no usar la biblioteca: ",mfv(DF$Motivo, na_rm=T),'\n')

```

Mayormente los encuestados no asisten a la biblioteca porque "Siempre lo
ven lleno"

#### Variables Numéricas: Las únicas variables que nuestra base de datos que nos podrían ayudar serían la variable edad y horas de la biblioteca

##### Edad:

Con la función "mean" se podrá calcular el promedio de la variable
elegida.

```{r}
round(mean(DF$Edad),2)
```

La `Edad` promedio de los encuestados es `19.18` .

```{r}
cat('Moda: ',mfv(DF$Edad),'\n' )
```

En su mayoría los estudiantes de UTEC que respondieron nuestra encuesta
tienen `19` años de `Edad` .

```{r}
cat('Mediana: ',median(DF$Edad),'\n' )
```

El valor central del total de encuestados es un alumno de UTEC con 19
años de `edad` .

```{r}
cat('Rango: ',range(DF$Edad),'\n' )
```

El rango de `edad` de los encuestados es 12 años , comprendidos entre el
valor mínimo que es 16 y el valor máximo que es 28.

```{r}
cat('Rango Intercuartil: ',round(IQR(DF$Edad),2),'\n' )
```

El rango intercuartil de la `edad` de los encuestados es 2.

##### HorasAsis

```{r}
round(mean(DFSi$HorasAsis),2)
```

Las `HorasAsis` promedio de los encuestados que sí van a la biblioteca
es `2.89 horas.`

```{r}
cat('Moda: ',mfv(DFSi$HorasAsis,na_rm=T),'\n' )
```

Mayormente los estudiantes de UTEC que frecuentan la biblioteca suelen
acudir `2` horas.

```{r}
cat('Mediana: ',median(DFSi$HorasAsis,na_rm=T),'\n' )
```

El valor central de horas que frecuenta la biblioteca un alumno de UTEC
es `2.`

```{r}
cat('Rango: ',range(DFSi$HorasAsis,na_rm=T),'\n' )
```

El rango de horas de asistencia a la biblioteca por parte de los
encuestados es 7, comprendidos entre el valor mínimo que es 1 y el valor
máximo que es 8.

```{r}
cat('Rango intercuartil: ',round(IQR(DFSi$HorasAsis),2),'\n')
```

El rango intercuartil de las horas que asisten los encuestados a la
biblioteca es 2.

## Descriptores Gráficos

### Univariado

```{r}
boxplot(DF$Edad,ylab="Edades", na.rm=T)
```

Se puede apreciar que la promedio de las edades de los encuestados se
encuentra entre los valores 18 y 20, siendo exactamente 19.18 la edad
promedio calculado ya anteriormente. Además, nos damos cuenta de que se
presenta 1 dato atípico.

```{r}
barplot(table(DF$Edad), main = "Edades de los encuestados"
                        , ylab = "Rango de encuestados"
                        , xlab = "Edades"
                        , col  = "lightgreen" ) 
```

La moda de `Edad` de los encuestados es 19 y en su distribución de datos
presenta un sesgo a la derecha debido a que la media es mayor a la
mediana, siendo estos valores 19.18 y 19 respectivamente.

```{r}
DF$HorasAsis <- as.numeric(DF$HorasAsis) 

boxplot(DFSi$HorasAsis,ylab="Horas Asistidas", na.rm=T)
```

Se puede apreciar que el promedio de las horas que asisten a la
biblioteca los encuestados se encuentra entre los valores 2 y 4, siendo
exactamente 2.89 calculado ya anteriormente. Además de ello, nos damos
cuenta de que se presenta 1 dato atípico.

```{r}
barplot(table(DFSi$HorasAsis), main = "Horas que se encuentran en la biblioteca"
                             , ylab = "Encuestados que dijeron que sí"
                             , xlab = "Horas"
                             , col = "skyblue")
```

La mayor cantidad de encuestados asiste alrededor de 2 horas a la
biblioteca y en su distribución de datos presenta un sesgo hacia la
izquierda debido a que la mediana es mayor que la media, siendo estos
valores 3 y 2.89 respectivamente.

```{r}
barplot(table(DF$FrecuenciaLec), main = "Frecuencia de Lectura por parte de los encuestados"
                             , ylab = "Cantidad de Encuestados"
                             , xlab = "Frecuencia de Lectura"
                             , col = "#FFA500")
```

La mayor cantidad de encuestados que asisten a la biblioteca para usar
un libro tienen frecuencia de lectura "diaria".

```{r}
barplot(table(DF$Preferencias), main = "Libros academicos o literarios"
                             , ylab = "Cantidad de encuestados"
                             , xlab = "Tipos de Libros"
                             , col = "#FFA500")
```

La mayor cantidad de encuestados, que asisten a la biblioteca para leer
un libro, usan libros "académicos". No obstante, es llamativo que
también hay alumnos que usen libros "literarios" ya sea por un trabajo o
la lectura, sea su pasatiempo favorito.

```{r}
barplot(table(DF$Tipodelibros), main = "Que libros de una asignatura prefieren leer los encuestados",width = c(4.8, 3,1, 1)

                             , ylab = "Cantidad de encuestados"
                             , xlab = "Asignatura"
                             , col = "#FFA500")
```

La mayor cantidad de encuestados que asisten a la biblioteca para leer
un libro usan libros de "Física" y los libros menos usados por los
alumnos en UTEC son los de "programación".

Podemos observar que el lugar de estudio que más prefieren los alumnos
que no asisten a la biblioteca es salas de estudio o cubículo y el menos
preferido es el comedor.

### Bivariado

```{r}
ggplot(DFLibro, aes(x = FrecuenciaLec, y = Edad, fill= FrecuenciaLec)) +
  stat_boxplot(geom = "errorbar", # Error
               width = 0.5) + # ancho
  geom_boxplot()+guides(fill = guide_legend(title = "Frecuencua de Lectura - Edad"))
table(DFLibro$FrecuenciaLec, DFLibro$Edad)
```

La gráfica presentada evidencia que los alumnos mayores de 20 y 22 años
aproximadamente tienen un mayor hábito de lectura(diariamente) a
comparación de las demás edades; además, se presenta un dato atípico en
la frecuencia diaria. Por otro lado, podemos ver que los encuestados que
van a la biblioteca tienden a practicar el hábito de lectura.

```{r}
ggplot(DFNo, aes(x = Motivo)) + geom_bar(aes(fill = OtrosEspacios), position = "dodge", width = 0.5) +  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

El mayor motivo por el que no frecuentan la biblioteca es porque siempre
para lleno y de los lugares que optan por estudiar las salas de estudio
y cubículo son las más frecuentes; además, el motivo menos votado por el
cual no frecuentan la biblioteca es que no encuentran el libro de su
preferencia y se van a su casa a estudiar.

```{r}
ggplot(DFSi, aes(x = RenTotal, y = HorasAsis, fill= RenTotal)) +
  stat_boxplot(geom = "errorbar", # Error
               width = 0.5) + # ancho
  geom_boxplot()+guides(fill = guide_legend(title = "Rendimiento - Horas de Asistencia")) + scale_fill_hue(labels = c("No aumentó", "Sí aumentó su rendimiento"))
```

Según la gráfica mostrada no todos los alumnos que estudian en la
biblioteca entre 2 a 3 horas aumentan su rendimiento a nivel
universitario en UTEC, sin embargo, los que le dedican más tiempo
tienden a tener buenas calificaciones.

```{r}
RenFrec<-table(DFLibro$FrecuenciaLec, DFLibro$RenTo)
mosaicplot(RenFrec,col=c("yellow","turquoise")
           , main = "Comparativa del rendimiento con la frecuencia de lectura")
```

Como se puede observar, los alumnos con frecuencia de lectura inter
diario tienen un mejor rendimiento que los otros alumnos con una
frecuencia diferente. Un dato no menor es que los que casi nunca leen
presentan un buen rendimiento académico, esto se podría deber a otros
métodos para reforzar su aprendizaje.

```{r}
RenFrec<-table(DFLibro$FrecuenciaLec, DFLibro$Preferencias)
mosaicplot(RenFrec,col=c("yellow","turquoise")
           , main = "Comparativa del Tipo de Libro con la frecuencia de lectura"
           )
```

Los alumnos con frecuencias de lectura `casi nunca` y `diario` solo usan
libros académicos, a diferencia de las otras frecuencias de lecturas que
utilizan tanto académicos como literarios, siendo mayor el uso de los
libros académicos. Este resultado es el esperado, debido a que la
población muestra son jóvenes universitarios.

# IV. Análisis de Probabilidades

## Probabilidad empírica

##Caso 1

### Variable Horas de Asistencia:

En primer lugar, definimos la muestra de nuestra variable:

```{r}
cat('La muestra para nuestra variable HorasAsis es: ',length(DFSi$HorasAsis),'\n')

```

###Experimento: Seleccionar a un estudiante y observamos las horas de
asistencia.

####Hallamos el espacio muestral de nuestra variable:

```{r}
cat('El espacio muestral para nuestra variable seleccionada es : ',length(table(DFSi$HorasAsis)),'\n')

```

Definimos los eventos atómicos:

```{r}
table(DFSi$HorasAsis)
```

```{r}
#A1: Seleccionar a un estudiante de UTEC cuyas horas sea 1 
#A2: Seleccionar a un estudiante de UTEC cuyas horas sea 2 
#A3: Seleccionar a un estudiante de UTEC cuyas horas sea 3 
#A4: Seleccionar a un estudiante de UTEC cuyas horas sea 4 
#A5: Seleccionar a un estudiante de UTEC cuyas horas sea 5 
#A6: Seleccionar a un estudiante de UTEC cuyas horas sea 6 
#A7: Seleccionar a un estudiante de UTEC cuyas horas sea 7 
#A8: Seleccionar a un estudiante de UTEC cuyas horas sea 8
```

Donde las probabilidades para cada valor de nuestra variable son:

```{r}
cat('1.La probabilidad de que un estudiante frecuente la biblioteca 1h es : ',10/length(DFSi$HorasAsis),'\n')
cat('2.La probabilidad de que un estudiante frecuente la biblioteca 2h es : ',30/length(DFSi$HorasAsis),'\n')
cat('3.La probabilidad de que un estudiante frecuente la biblioteca 3h es : ',21/length(DFSi$HorasAsis),'\n')
cat('4.La probabilidad de que un estudiante frecuente la biblioteca 4h es : ',13/length(DFSi$HorasAsis),'\n')
cat('5.La probabilidad de que un estudiante frecuente la biblioteca 5h es : ',5/length(DFSi$HorasAsis),'\n')
cat('6.La probabilidad de que un estudiante frecuente la biblioteca 6h es : ',3/length(DFSi$HorasAsis),'\n')
cat('7.La probabilidad de que un estudiante frecuente la biblioteca 7h es : ',1/length(DFSi$HorasAsis),'\n')
cat('8.La probabilidad de que un estudiante frecuente la biblioteca 8h es : ',1/length(DFSi$HorasAsis),'\n')
```

Es más probable encontrar alumnos que frecuenten la biblioteca 2 h y lo
menos probable es que encontremos alumnos que lo frecuenten 7 h u 8 h.

##Caso 2 ###Variable Edad En primer lugar, definimos la muestra de
nuestra variable:

```{r}
cat('La muestra para nuestra varibable Edad es: ',length(DFSi$Edad),'\n')
```

###Experimento: Seleccionar a un estudiante que frecuenta la biblioteca
y saber su edad.

####Hallamos el espacio muestral de nuestra variable:

```{r}
cat('El espacio muestral para nuestra variable seleccionada es : ',length(table(DFSi$Edad)),'\n')

```

Definimos los eventos atómicos:

```{r}
table(DFSi$Edad)
```

```{r}
#B1: Seleccionar a un estudiante de UTEC cuya edad sea 16 
#B2: Seleccionar a un estudiante de UTEC cuya edad sea 17 
#B3: Seleccionar a un estudiante de UTEC cuya edad sea 18
#B4: Seleccionar a un estudiante de UTEC cuya edad sea 19
#B5: Seleccionar a un estudiante de UTEC cuya edad sea 20 
#B6: Seleccionar a un estudiante de UTEC cuya edad sea 21 
#B7: Seleccionar a un estudiante de UTEC cuya edad sea 22 
#B8: Seleccionar a un estudiante de UTEC cuya edad sea 23
#B9: Seleccionar a un estudiante de UTEC cuya edad sea 28 

```

Donde las probabilidades para cada valor de nuestra variable son:

```{r}
cat('1.La probabilidad de que un estudiante tenga 16 años es : ',1/length(DFSi$Edad),'\n')
cat('2.La probabilidad de que un estudiante tenga 17 años es : ',6/length(DFSi$Edad),'\n')
cat('3.La probabilidad de que un estudiante tenga 18 años es : ',17/length(DFSi$Edad),'\n')
cat('4.La probabilidad de que un estudiante tenga 19 años es : ',30/length(DFSi$Edad),'\n')
cat('5.La probabilidad de que un estudiante tenga 20 años es : ',16/length(DFSi$Edad),'\n')
cat('6.La probabilidad de que un estudiante tenga 21 años es : ',9/length(DFSi$Edad),'\n')
cat('7.La probabilidad de que un estudiante tenga 22 años es : ',2/length(DFSi$Edad),'\n')
cat('8.La probabilidad de que un estudiante tenga 23 años es : ',2/length(DFSi$Edad),'\n')
cat('9.La probabilidad de que un estudiante tenga 28 años es : ',1/length(DFSi$Edad),'\n')
```

Es más probable encontrar alumnos de 19 años que frecuenten la
biblioteca y lo menos probable es que encontremos alumnos de 28 años que
la frecuenten.

## Probabilidad condicional

###Independientes 
A:Seleccionar un persona de 17 años
B:Seleccionar un persona que frecuente la biblioteca 2 horas
\* Validamos la independencia Para esto se debe cumplir que: 
1.P(A∩B)=P(A)\*P(B)
2.P(A\|B)=P(A)

Sabemos que: 
P(A\|B)=P(A∩B)/P(B) 
P(B\|A)=P(A\|B)\*P(B)/P(A)

Por la probabilidad total 
P(A)=P(A\|B).P(B)+P(A\|B').P(B')

```{r}

Interseccion<-nrow(filter(DFSi,Edad=="17" & HorasAsis=="2" ))/nrow(DFSi)
Pa<-nrow(filter(DFSi,HorasAsis=="2" ))/nrow(DFSi)
Pb<-nrow(filter(DFSi,Edad=="17" ))/nrow(DFSi)
PaA<-nrow(filter(DFSi,HorasAsis=="5" ))/nrow(DFSi)
PbB<-nrow(filter(DFSi,Edad=="20" ))/nrow(DFSi)
PabB<-nrow(filter(DFSi,Edad=="20" & HorasAsis=="2"  ))/nrow(filter(DFSi,Edad=="20" ))
Pab<-nrow(filter(DFSi,Edad=="17" & HorasAsis=="2"  ))/nrow(filter(DFSi,Edad=="17" ))
Pba<-nrow(filter(DFSi,Edad=="17" & HorasAsis=="2" ))/nrow(filter(DFSi,HorasAsis=="2" ))
#validacion de independencia

cat('La probabilidad condicional es : ',abs(Interseccion-(Pa*Pb)),'\n')




```

Como era de esperar, la frecuencia a la biblioteca no depende de la edad.

# Dependientes

A: Un encuestado va a la biblioteca a leer un libro.

B: Un encuestado mejora en su rendimiento.

-   Validamos la independencia Para esto se debe cumplir que:
    1.P(C∩D)=P(C)\*P(D) 2.P(C\|D)=P(C)

    Sabemos que: P(C\|D)=P(C∩D)/P(D) P(D\|C)=P(C\|D)\*P(D)/P(C)

    Por la probabilidad total P(C)=P(C\|D).P(D)+P(C\|D').P(D')

```{r}
Interseccion<-nrow(filter(DFSi,Actividades== "Leer un libro"& RenTotal=="Sí"))/nrow(DFSi)
Pc<-nrow(filter(DFSi,RenTotal=="Sí"))/nrow(DFSi)
Pd<-nrow(filter(DFSi,Actividades== "Leer un libro"))/nrow(DFSi)
PcC<-nrow(filter(DFSi,RenTotal=="No"))/nrow(DFSi)
PdD<-nrow(filter(DFSi,Actividades== "Actividades personales" ))/nrow(DFSi)
PcdD<-nrow(filter(DFSi,Actividades== "Actividades personales"  & RenTotal=="Sí" ))/nrow(filter(DFSi,Actividades== "Actividades personales"  ))
Pcd<-nrow(filter(DFSi,Actividades== "Leer un libro" & RenTotal=="Sí" ))/nrow(filter(DFSi,Actividades== "Leer un libro"))
Pdc<-nrow(filter(DFSi,Actividades== "Leer un libro" & RenTotal=="Sí" ))/nrow(filter(DFSi,RenTotal=="Sí"))
#validacion de independencia

cat('La probabilidad condicional es : ',Interseccion-(Pc*Pd),'\n')

```

Observamos una dependencia débil,esto se debe a que muchos estudiantes
aseguran que no ven necesario leer un libro para mejorar en el
rendimiento académico.

## Variable Aleatoria Discreta

### Primera variable

Para esta primera variable se hará uso de la variable `Edad`, esta
variable es categórica nominal .

El método a usar será de una forma binomial.

### Construcción de la V.A

n: Número de observaciones dentro de `DF`.

Éxito: Observaciones donde la respuesta a la variable `Edad` es menor a
18.

#### Probabilidad de éxito

```{r}
PExit <- sum(DF$Edad < 18)/nrow(DF)
PExit
```

A partir de esto se deduce que `x` : número de personas que tienen menos
de 18 años dentro de todo el estudio.

### Identificando parámetros

$X~Bin(p,n)$ p : Probabilidad de éxito, donde el éxito es si una persona
tiene menos de 18 años.

n : Tamaño de la muestra

```{r}
n <- nrow(DF)
```

```{r}
until <- 0:n
Px <- dbinom(until, n, PExit)
```

### Gráfica

```{r}
barplot(Px, names.arg = until, xlab = "Número de éxitos", ylab = "Probabilidad" )
```

### Validación de propiedades

```{r}
Ex <- n*PExit
Ex
Varian <- n*PExit*(1-PExit)
Varian
Coef.Var <- sqrt(Varian)/Ex
Coef.Var
```

### Ejemplo

En un día de la semana, dentro de una biblioteca, se desea saber cuál es
la probabilidad de que el 20% de los presentes sean mayores de edad.
Sabiendo que hay 154 personas dentro de ella.

```{r}
prob = 1 - pbinom( 30, n, PExit, lower.tail = T)
prob
```

### Segunda variable

Para este segundo ejemplo se usará la variable `RendimientoTotal` y se
usará una distribución de Bernoulli.

### Construcción de la V.A

Éxito: Encuestados que dijeron que sí mejoró su rendimiento de toda la
muestra.

#### Probabilidad de éxito

```{r}
values <- c(0, 1)
variable_bernoulli <- values[(DF$RendimientoTotal == "Sí") + 1]
PExit2 <- mean(variable_bernoulli)
PExit2 
```

x: Indica las personas que mejoraron su rendimiento y que también
asisten a la biblioteca.

### Validación de propiedades

```{r}
Ex2 <- PExit2
Ex2
var(variable_bernoulli)
```

### Gráfica

```{r}
frerc = table(DF$Asistencia)
barplot(prop.table(frerc), names.arg = c("No", "Sí"), xlab = "Variable de Asistencia", ylab = "Probabilidad")
```

## Variable Aleatoria Continua

### Primera variable

Para esta primera variable se usará la variable Horas de Asistencia

### Construcción de la variable

x: Cantidad de personas que asisten más de 4 horas a la biblioteca

```{r}
nrow(DFSi)
```

### Gráfica

```{r}
hist(DFSi$HorasAsis,breaks=6, freq=FALSE, main="Histograma de Horas Asistidas", xlab="Horas", col="orange")
u = mean(DFSi$HorasAsis, na.rm = T)
u
median(DFSi$HorasAsis, na.rm = T)
sig = sd(DFSi$HorasAsis, na.rm = T)
sig

```

### Normalidad

```{r}
mean(DFSi$HorasAsis, na.rm = T)
median(DFSi$HorasAsis, na.rm = T)
sd(DFSi$HorasAsis, na.rm = T)
```

Estos valores obtenidos tienen que ser similares a los siguientes:

```{r}
# Definir la función de densidad de la variable aleatoria continua
densidad <- function(x) {
  dnorm(x, u, sig)
}

esperanza <- integrate(function(x) {x * densidad(x)}, lower = -Inf, upper = Inf)$value
varianza <- integrate(function(x) {(x - esperanza)^2 * densidad(x)}, lower = -Inf, upper = Inf)$value
desviacion_estandar <- sqrt(varianza)
esperanza
```

Como coinciden, esto valida su normalidad

Veremos el ejemplo que nos pide más de 4 horas dentro de la biblioteca

```{r}
pnorm(4,u,sig,lower.tail = F)
```
