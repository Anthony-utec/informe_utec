---
title: "**Preferencias de los estudiantes UTEC al almorzar en la calle**"
output:
  html_document:
    toc: yes
    df_print: paged
  word_document:
    toc: yes
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    theme: yeti
  pdf_document:
    toc: yes
editor_options:
  markdown:
    wrap: sentence
---

# TEMA

***Preferencias de los estudiantes UTEC al almorzar en la calle***

# INTRODUCCIÓN

## Relevancia

-   Comer en la calle es algo muy común para muchos, es por eso que nuestro proyecto se basa en el análisis de los hábitos comestibles y alimenticios de los estudiantes al momento de comer en la calle.

## Objetivos del estudio

-   Objetivo general:

    Analizar y estudiar la información acerca del tipo de alimentación de los estudiantes, en cuanto a la frecuencia de consumir los alimentos fuera de su hogar, costos económicos y sus preferencias acerca de la comida en la calle.

-   Objetivo específico:

    -   Estudiar las preferencias a la hora de ir a comer en la calle de los estudiantes UTEC.

    -   Determinar dependencias e independencias entre las preferencias de los estudaintes respecto a sus características.

    -   Determinar las razones de la frecuencia de almuerzo en la calle y la cantidad de dinero que gastan los estudiantes UTEC.

## Contexto

Para comprender adecuadamente el tema propuesto sobre las preferencias de los estudiantes UTEC al almorzar en la calle, es importante tener en cuenta algunos conocimientos relevantes.
Aquí hay algunos aspectos que se deben considerar:

-   Hábitos alimenticios de los estudiantes universitarios: Los estudiantes universitarios a menudo tienen horarios ocupados y limitado tiempo para preparar comidas en casa. Por lo tanto, es común que busquen opciones de comida rápida y conveniente, como comer en la calle o pedir comida para llevar.

# DATOS

## Recolección de datos

Los datos se obtuvieron por medio de encuestas virtuales a través de Google Forms, ya que nos permite descargar toda la data recolectada directamente en formato '.csv', listo para poder trabajar en Rstudio.

## Población, muestra y muestreo

*Población:* Todos los estudiantes de pre grado de la UTEC que estén cursando el semestre 2023-1.

*Muestra:* El tamaño de nuestra muestra es de 159 estudiantes, lo que sugiere que es una muestra representativa que nos permitirá trabajar en el estudio que queremos.

*Muestreo:* El muestreo fue por conveniencia, porque antes de que pidiéramos a los estudiantes que llenaran nuestra encuesta, le preguntábamos `"¿Comen en la calle?"` para que su respuesta sea útil en el estudio que estábamos realizando

## Variables

Variables cuantitativas: 4

Variables cualitativas: 10

Restricciones: Todas las variables cuantitativas son números enteros no negativos.

| Variables                         | Descripción                                                                                         | Tipo                   |
|------------------|-------------------------------------|------------------|
| Edad                              | Edad actual de un alumno de UTEC (en años)                                                          | Cuantitativa discreta  |
| Ciclo                             | Ciclo actual en el que se encuentra el alumno                                                       | Cualitativa ordinal    |
| Carrera                           | Carrera de pre grado que estudia el alumno que contestó nuestra encuesta.                           | Cualitativa nominal    |
| Sexo                              | Determinamos con ello que el 62.26% de los encuestados fueron hombres.                              | Cualitativa nominal    |
| Frecuencia                        | Cantidad de días que come en la calle                                                               | Cuantitativa discreta  |
| Razones                           | Conocer el por qué suele comer en la calle                                                          | Cualitativas nominales |
| Tipo de comida                    | Clasificar los gustos por la comida en 5 grupos (criolla, marina, oriental, comida rápida y típica) | Cualitativas nominales |
| Gasto                             | Cantidad de dinero que gastan los estudiantes al comer en la calle                                  | Cuantitativa continua  |
| Medio de pago                     | Conocer los medios de pagos favoritos de loes estudiantes                                           | Cualitativa nominal    |
| Entrada                           | Saber si los estudiantes suelen comer con entrada su almuerzo                                       | Cualitativa nominal    |
| Postre                            | Saber si los estudiantes suelen comer con postre su almuerzo                                        | Cualitativa nominal    |
| Bebida                            | Saber si los estudiantes suelen pedir bebida con su almuerzo                                        | Cualitativa nominal    |
| Tiempo                            | Conocer el tiempo que se demora un estudiante comiendo                                              | Cuantitativa continua  |
| Satisfacción de comer en la calle | Saber si los estudiantes se sienten satisfechos de comer en la calle                                | Cualitativa nominal    |

```{r}
# Instalación de los paquetes:
if(!require(readr)){install.packages('readr')}
if(!require(dplyr)){install.packages('dplyr')}
if(!require(tables)){install.packages('tables')}
if(!require(ggplot2)){install.packages('ggplot2')}
```

```{r}
# Cargamos las librerías que usaremos:
library(readr)
library(dplyr)
library(tables)
library(ggplot2)
```

```{r}
DF <- read_csv("DL.csv")
```

# ANÁLISIS PROBABILÍSTICO:

# PROBABILIDAD EMPÍRICA

## Variable: Frecuencia de veces al almorzar en la calle

Experimento: Seleccionar a un estudiante de UTEC y observar la frecuencia de veces que almuerzan en la calle.

Espacio muestral:

A1: Seleccionar a un estudiante de UTEC que almuerza en la calle una vez a la semana.

A2 : Seleccionar a un estudiante de UTEC que almuerza en la calle dos veces a la semana.

A3: Seleccionar a un estudiante de UTEC que almuerza en la calle tres veces a la semana.

A4: Seleccionar a un estudiante de UTEC que almuerza en la calle cuatro veces a la semana.

A5: Seleccionar a un estudiante de UTEC que almuerza en la calle cinco veces a la semana.

A6: Seleccionar a un estudiante de UTEC que almuerza en la calle seis veces a la semana.

A7: Seleccionar a un estudiante de UTEC que almuerza en la calle siete veces a la semana.

$\Omega_1=\{A1,A2,A3,A4,A5,A6,A7\}$

Tabla con los ciclos y sus frecuencias relativas:

```{r}
length(DF$Frecuencia)

table(DF$Frecuencia)
```

Calcular la función de probabilidad para cada evento.

```{r}
Valores_F <- c(sort(unique(c(DF$Frecuencia)), decreasing = FALSE))
Probabilidad_F <- c(as.vector(table(DF$Frecuencia))/length(DF$Frecuencia))
Fraccion_F <- paste((table(DF$Frecuencia)), "/", length(DF$Frecuencia), sep = "")

C_Frec <- data.frame(Valores_F, Probabilidad_F, Fraccion_F)
C_Frec
```

Diagrama de barras de Frecuencia de veces al almorzar en la calle:

```{r}
barplot(table(DF$Frecuencia), col = "lightblue",main = "Frecuencia de veces al almorzar en la calle", xlab= "Frecuencia de veces al almorzar en la calle", ylab="N.° de estudiantes")
```

Nuestros resultados concuerdan con las frecuencias mostradas en la gráfica, a pesar de 6 no ser la mayor frecuencia de almorzar en la calle, es la menos popular entre los encuestados..

## Variable: Ciclo

Experimento: Seleccionar a un estudiante de UTEC y observar su ciclo.

Espacio muestral:

B1: Seleccionar a un estudiante de UTEC de primer ciclo.

B2: Seleccionar a un estudiante de UTEC de segundo ciclo.

B3: Seleccionar a un estudiante de UTEC de tercer ciclo.

B4: Seleccionar a un estudiante de UTEC de cuarto ciclo.

B5: Seleccionar a un estudiante de UTEC de quinto ciclo.

B6: Seleccionar a un estudiante de UTEC de sexto ciclo.

B7: Seleccionar a un estudiante de UTEC de séptimo ciclo.

B8: Seleccionar a un estudiante de UTEC de octavo ciclo.

B9: Seleccionar a un estudiante de UTEC de noveno ciclo.

$\Omega_2=\{B1,B2,B3,B4,B5,B6,B7\}$

Tabla con los ciclos y sus frecuencias relativas:

```{r}
length(DF$Ciclo)

table(DF$Ciclo)
```

Calcular la función de probabilidad para cada evento.

```{r}
Valores_C <- c(sort(unique(c(DF$Ciclo)), decreasing = FALSE))
Probabilidad_C <- c(as.vector(table(DF$Ciclo))/length(DF$Ciclo))
Fraccion_C <- paste((table(DF$Ciclo)), "/", length(DF$Ciclo), sep = "")

C_Ciclo <- data.frame(Valores_C, Probabilidad_C, Fraccion_C)
C_Ciclo
```

Diagrama de barras de Ciclo:

```{r}
barplot(table(DF$Ciclo), col = "lightblue",main = "Ciclo", xlab= "Ciclo", ylab="N.° de estudiantes")
```

Nuestros resultados concuerdan con las frecuencias mostradas en la gráfica, destacando al ciclo 4 como el más popular entre los encuestados.

# PROBABILIDAD CONDICIONAL

## Evento dependiente

¿Cuál es la probabilidad de que un estudiante de noveno ciclo almuerce más de 3 o más veces en la calle?

Evento A: El estudiante es de noveno ciclo.

Evento B: Estudiante que almuerza 3 o más veces en la calle.

```{r}
# Cantidad total de la muestra
cantidad_total <-length(DF$Frecuencia)

# Cantidad de personas en noveno ciclo
ciclo_igual9 <- sum(DF$Ciclo == 9)

# Cantidad de personas que almuerzan 3 o más veces en la calle
frecuencia_3_mas <- sum(DF$Frecuencia >= 3)

# Obtener la cantidad de personas en noveno ciclo y que almuerzan 3 o más veces en la calle
ciclo_9_frec_mas3 <- sum(DF$Ciclo == 9  & DF$Frecuencia >= 3)

# Calcular las probabilidades empíricas
P_A_1 <- ciclo_igual9 / cantidad_total
P_B_1 <- frecuencia_3_mas / cantidad_total
P_A_por_P_B_1 = P_A_1 * P_B_1
P_A_interseccion_B_1 <- ciclo_9_frec_mas3 / cantidad_total
P_A_dado_B_1 <- P_A_interseccion_B_1 / P_B_1



# Imprimir los resultados
cat("Probabilidad de A (noveno ciclo):              ", P_A_1, "\n")
cat("Probabilidad de B (almuerza 3 o más veces en la calle):", P_B_1, "\n")
cat("Probabilidad de A por Probabilidad de B:               ", P_A_por_P_B_1, "\n")
cat("Probabilidad de A intersección B:                      ", P_A_interseccion_B_1, "\n")

```

Como P(A) \* P(B) no se aproxima a P(A n B) estamos asumiendo de que son dependientes, por lo tanto se debería cumplir la relación: P(A \| B) = P(A n B)/P(B).

Para comprobar esto hallamos ambas:

```{r}

cat("Probabilidad de A (noveno ciclo):   ", P_A_1, "\n")
cat("Probabilidad de A dado B:                   ", P_A_dado_B_1, "\n")
```

Dado que proporcionalmente probabilidad de A y probabilidad de A dado B son distantes, se valida su dependencia.

```{r}
boxplot(DF$Frecuencia ~ DF$Ciclo, main= "Ciclo vs Frecuencia de almorzar", xlab= "Ciclo", ylab = "Frecuencia de almorzar", col= c("#BE2A3E","#DC5746","#E36148","#F17F4B","#F8A254","#FECEA3","#D6CA64","#87B560","#34854C"))
```

Se puede apreciar en la gráfica que los alumnos de noveno ciclo o mayor almuerzan más de 3 veces en la calle, validando nuestra dependencia.

## Evento independiente

¿Cuál es la probabilidad de que un estudiante mayor o igual a la edad de 18 años pague con tarjeta de crédito?

Evento A: El medio de pago usado es tarjeta.

Evento B: Estudiante con edad mayor o igual a 18 años

```{r}
P_A=sum(DF$MPago=="Tarjeta")/length(DF$MPago)
round(P_A,3)

P_B=sum(DF$Edad>17)/length(DF$Edad)
round(P_B,3)

P_B_A=P_A*P_B
round(P_B_A,3)

P_A_n_B = sum(DF$MPago=="Tarjeta" & DF$Edad>17)/length(DF$MPago)
round(P_A_n_B,3)

```

Observamos que P(A) \* P(B) es muy cercano a P(A n B) por lo que se demuestra su independencia.

Entonces calculamos P(A \| B) = P(A n B) / P(B)

```{r}
P_A_dado_B = P_A_n_B / P_B
P_A_dado_B
P_A
```

Se puede determinar que P(A \| B) es próximo a P(A).

```{r}
boxplot(DF$Edad~ DF$MPago, main= "Medio de pago vs Edad", xlab= "Medio de pago", ylab = "Edad", col= c("blue","orange","purple"))
```

En este gráfico se puede apreciar de que claramente son independientes, ya que aparentemente ninguna variable influye sobre la otra.

# VARIABLES ALEATORIAS DISCRETAS

## Distribución binomial:

La siguiente tabla muestra la intersección entre si un individuo está satisfecho al almorzar en la calle (No/Sí) y el sexo del individuo.

```{r}
SSa=table(DF$Sexo,DF$Satisfaccion)
SSa
```

Aquí se halla la probabilidad de la intersección entre si es hombre y está satisfecho al almorzar en la calle.

Prob = n_personas / n_total

```{r}
82 / nrow(DF)
```

Sabemos que en nuestra población tenemos una probabilidad del 51.6% que alguien sea del sexo masculino y esté satisfecho al almorzar en la calle.
Si de 10 encuestados tomamos a 2 personas, ¿cuál es la probabilidad de que sea varón y esté satisfecho con almorzar en la calle?

Aquí se muestra un data frame con las probabilidades de los casos

```{r}
#Proporción de probabilidad: 
prop.SSa<-round(prop.table(SSa),3)
prop.SSa
```

```{r}
prop.SSa["Masculino","Sí"]
```

Definimos nuestra distribución binomial, y hallamos la probabilidad usando la variable que hemos definido.

```{r}
Acierto=2
encuestados=15
proba=0.52
dbinom(Acierto,encuestados,proba)
```

Histograma de la función de densidad: Este histograma muestra el número de personas de sexo masculino que estén satisfechos en una muestra de tamaño 10000

```{r}
hist(rbinom(10000, 10, 0.52), breaks=10,col = "#376491",xlab = "Personas del sexo masculino satisfechas",ylab = "Frecuencia" ,main = "Número de personas de sexo masculino que estén satisfechos")
```

## Distribución binomial negativa:

Tabla de frecuencias por sexo:

```{r}
TSexo<-table(DF$Sexo)
TSexo
```

Probabilidad empírica por sexo:

```{r}
ProbaSexo<-round(prop.table(TSexo),3)
ProbaSexo
```

Siguiendo con una de las variables escogidas anteriormente, se sabe que el 35.8% son del sexo femenino.
Si se escoge de forma aleatoria, ¿cuál es la probabilidad de que buscando personas aleatorias, encuentre 15 hombres cuando halla encontrado 10 mujeres?

```{r}
n_exitos=15
n_fracasos=10
prob_dnb=0.358

dnbinom(n_exitos,n_fracasos,prob_dnb)
```

Función de densidad de: Numero de hombres encontrados hasta encontrar 10 mujeres

```{r}
hist(rnbinom(10000, 10, 0.358),col = "#43799F",xlab="Número de hombres encontrados",ylab="Frecuencia",main = "Función de densidad")
```

## Modelo Hipergeométrico

Nuestra población es de 159 estudiantes.
Entonces, si tomo una muestra de 60, ¿cuál es la probabilidad de que 48 estén satisfechos con almorzar en la calle?

```{r}
Satis<-table(DF$Satisfaccion)
#Calculamos su proporción de probabilidad
Satis
```

Hallamos la probabilidad de que 48 estudiantes si estén satisfechos en una muestra de 60

```{r}
n_exitos = 126
n_fallos = 33
hyp<-dhyper(48,n_exitos,n_fallos,60)
hyp
```

Graficando lo anterior:

```{r}
hist(rhyper(10000, 126, 33, 60),col="#2E5B88",xlab="Estudiantes satisfechos",ylab="Frecuencia",main="Funcion de probabilidad Hipergeométrica")
```

# VARIABLES ALEATORIAS CONTINUAS

## Gasto:

En este caso analizaremos la variable Gasto.
El gasto que los estudiantes gastan en una comida es muy importante para analizar los patrones de alimentación de los estudiantes, y posteriormente analizarlo y compararlo con otras variables.
Se puede ver el gráfico de campana de esta variable, a simple vista puede parecer confuso, pero se demostrará porque la gráfica sigue una distribución normal.

Gráfica de gastos menores a 30 soles por comida: (lo hacemos con valores menores a 30 ya que la cantidad de valores que exceden 30 son pocos y con este recorte se permite una mejor visualización de la gráfica)

```{r}
ggplot(data.frame(x = DF$Gasto[DF$Gasto < 30]), aes(x = x)) +
  geom_histogram(aes(y = after_stat(density)), binwidth = 2.1, fill = "skyblue", color = "black", alpha = 0.8) +
  geom_density(color = "red", size = 1) +
  geom_vline(aes(xintercept = median(DF$Gasto), color = "Mediana"), linetype = "dashed", size = 1) +
  labs(title = "Gráfico de Campana de Gasto", x = "Gasto", y = "Densidad") +
  theme_minimal()
```

```{r}
X_G <- median(DF$Gasto) #mediana
mu_G <- mean(DF$Gasto)   #media o esperanza
sigma_G <- sd(DF$Gasto)     #desviación estándar
var_G <- var(DF$Gasto)     #varianza
cat('mediana:', round(X_G,2), 'media:',round(mu_G,2), 'desviación estándar:', round(sigma_G,2), 'varianza:', round(var_G,2))
```

La media y la mediana se aproximan bastante, y la desviación estándar es baja también.
Por la forma del histograma, asumimos que se asemeja a una distribución normal.
Se puede apreciar que la gráfica es asimétrica a la derecha.

Ahora en un caso particular:

Calcule la probabilidad de que un alumno gaste más de 20 soles en su almuerzo

$$X ∼ N (µ, σ)$$ `X:` Gasto del estudiante

**`µ`** = 15.40252

**`σ`** = 6.102624

```{r}
pGasto <- round(pnorm(20, mu_G, sigma_G, lower.tail=F),2)
cat('La probabilidad de que un alumno gaste más de 20 soles en su almuerzo es:', pGasto)
```

## Edad:

Debido a que en nuestro estudio no hemos podido recolectar otra variable continua, vamos a estudiar la variable edad.

La edad es una variable útil para entender el comportamiento de los estudiantes por edad.

```{r}
ggplot(data.frame(x = DF$Edad), aes(x = x)) +
  geom_histogram(aes(y = after_stat(density)), binwidth = 1, fill = "skyblue", color = "black", alpha = 0.8) +
  geom_density(color = "red", size = 1) +
  geom_vline(aes(xintercept = median(DF$Edad), color = "Mediana"), linetype = "dashed", size = 1) +
  labs(title = "Gráfico de Campana de Edad", x = "Edad", y = "Densidad") +
  theme_minimal()
```

```{r}
X_E <- median(DF$Edad) #mediana
mu_E <- mean(DF$Edad)   #media o esperanza
sigma_E <- sd(DF$Edad)     #desviación estándar
var_E <- var(DF$Edad)     #varianza
cat('mediana:', round(X_E,2), 'media:',round(mu_E,2), 'desviación estándar:', round(sigma_E,2), 'varianza:', round(var_E,2))
```

La gráfica es bastante simétrica, y la media y la mediana son casi las mismas.
Esto nos indicaría que se presenta poco sesgo.

Ahora en un caso particular:

Calcule la probabilidad de que un alumno tenga menos de 18 años

$$X ∼ N (µ, σ)$$

`X:` Edad del estudiante

**`µ`** = 19.28302

**`σ`** = 1.501611

```{r}
pEdad <- round(pnorm(18, mu_E, sigma_E, lower.tail=T),3)
cat('La probabilidad de que un alumno tenga menos de 18 años es:', pEdad)
```
