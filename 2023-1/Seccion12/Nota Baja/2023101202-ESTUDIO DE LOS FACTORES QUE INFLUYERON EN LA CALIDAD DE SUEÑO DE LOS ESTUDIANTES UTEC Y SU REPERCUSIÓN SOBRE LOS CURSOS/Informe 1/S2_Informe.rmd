---
title: "ESTUDIO DE LOS FACTORES QUE INFLUYERON EN LA CALIDAD DE SUEÑO DE LOS ESTUDIANTES UTEC Y SU REPERCUSIÓN SOBRE LOS CURSOS QUE LLEVARON EN EL CICLO 2022-2"
output:
  html_document:
    toc: true
---

# [INTRODUCCIÓN]{style="color:deepskyblue"}

### RELEVANCIA

Como todos sabemos, el sueño es un aspecto fundamental para el bienestar y el rendimiento académico de los estudiantes, ya que está estrechamente relacionado con el funcionamiento cognitivo, la concentración y la capacidad de aprendizaje. Por ello, el presente informe se centra en analizar los factores que influyeron en la calidad de sueño de los estudiantes de la Universidad Tecnológica del Perú (UTEC) durante el ciclo `2022-2`, y cómo dicha calidad tuvo **repercusiones** en los cursos que llevaron.


### OBJETIVOS

#### OBJETIVO GENERAL

Analizar los factores que influyeron en la calidad de sueño de los estudiantes de la Universidad Tecnológica del Perú (UTEC) durante el ciclo `22-2`, y evaluar su repercusión en el desempeño académico de los cursos que llevaron.

#### OBJETIVOS ESPECÍFICOS

1.  Determinar la relación entre el número de cursos y la calidad del sueño de los estudiantes de UTEC durante el ciclo 22-2.

2.  Determinar las repercusiones de la mala calidad de sueño en el desempeño académico de los estudiantes durante el ciclo 22-2.

3.  Analizar los niveles de estrés que influyeron negativamente en la calidad de sueño de los estudiantes durante el ciclo 22-2.

4.  Determinar si existe alguna relación entre el género y el promedio de notas en el Ciclo 2022-2.

5.  Identificar los factores académicos que afectaron la calidad de sueño de los estudiantes de UTEC durante el ciclo 22-2.

6.  Proponer recomendaciones y estrategias para mejorar la calidad de sueño de los estudiantes y su rendimiento académico en futuros ciclos.


### CONTEXTO

Durante el ciclo académico `2022-2` en UTEC, se observó un patrón preocupante en la calidad del sueño de los estudiantes. Se identificaron diversos factores que influyeron negativamente en la calidad de sueño de los estudiantes, lo que a su vez afectó su desempeño en los cursos que cursaron durante dicho ciclo. Estos factores pueden clasificarse en tres categorías principales: académicos, personales y de sueño. Además, la falta de sueño adecuado se tradujo en dificultades para concentrarse en clase, menor retención de información, disminución de la productividad y, en última instancia, resultados académicos subóptimos.


# [DATOS]{style="color:deepskyblue"}


### RECOLECCIÓN DE DATOS

Bueno la recolección de datos se efectuó a través de un **muestro aleatorio simple** empleando como instrumento la **encuesta** realizada de manera electrónica mediante el sistema **Google forms**. Se consideraron **11 variables** dirigidas **exclusivamente a estudiantes de la UTEC**, las preguntas fueron diseñadas de modo que sean de fácil comprensión y respuesta por parte de los encuestados, así mismo, se implementaron mecanismos de control de calidad para minimizar errores en las respuestas. La encuesta se difundió a través de redes sociales.

![](Forms.jpeg){fig-alt="Encuesta realizada a través de Google forms" fig-align="center"}


### TABLA DE POBLACIÓN, MUESTRA Y MUESTREO

|                            Población                             |                    Muestra                     |     Muestreo     |
|:-----------------------------:|:---------------------:|:----------------:|
| Estudiantes de pregrado en UTEC que cursaron el semestre 2022-2. | El tamaño de la muestra es de 311 encuestados. | Aleatorio Simple |


### VARIABLES

#### NUMÉRICAS :

|                      Nombre CSV                      |       Tipo        | Nombre en R studio |               Restricción                |
|:----------------:|:-----------------:|:----------------:|:----------------:|
|                         Edad                         | Numérica discreta |        Edad        |            Entre 16 a 30 años            |
| Cursos que ha llevado el estudiante del ciclo 2022-2 | Numérica discreta |       Cursos       |             De 3 a 8 cursos              |
|         Promedio ponderado del ciclo 2022-2          | Numérica continua |      Promedio      | Máximo 19 el promedio en el ciclo 2022-2 |
|  Promedio de horas de sueño durante el ciclo 2022-2  | Numérica discreta |     HorasSueño     |            Entre 2 a 12 horas            |
|        Horas de ocio durante el ciclo 2022-2         | Numérica discreta |        Ocio        |              Máximo 9 horas              |

#### CATEGÓRICAS :

|                           Nombre CSV                           |        Tipo        | Nombre en R studio |                           Restricción                            |
|:----------------:|:-----------------:|:----------------:|:----------------:|
|                             Género                             | Categórica nominal |       Género       | Únicamente 3 opciones: masculino, femenino y prefiero no decirlo |
|           Calidad del sueño durante el ciclo 2022-2            | Categórica ordinal |      Calidad       |                   Desde pésima hasta excelente                   |
|            Nivel de estrés durante el ciclo 2022-2             | Categórica ordinal |       Estres       |                      Desde bajo hasta alto                       |
|                 Faltas durante el ciclo 2022-2                 | Categórica ordinal |       Faltas       |                  Desde nunca hasta regularmente                  |
|         Tiempo requerido para llegar a la universidad          | Categórica ordinal |   Tiempollegada    |          Desde menos de 30 minutos hasta más de 3 horas          |
| Dificultad con el tipo de evaluaciones durante el ciclo 2022-2 | Categórica nominal |    Evaluaciones    |                         Opción múltiple                          |


### CARGA BASE DE DATOS

Delimitamos librerías y directorio de trabajo.

```{r Librerias, echo=FALSE, message=FALSE}

if (! require (ggplot2)) {install.packages ('ggplot2')}
library(ggplot2)
```

```{r,echo=TRUE,message=FALSE}
library(readr)
library(dplyr)
library(plotly)
```

Cargamos el archivo y lo guardamos como una variable:

```{r,echo=TRUE,message=FALSE}
Datos <- read_csv("Grupo2.csv")
```


### LIMPIEZA DE BASE DE DATOS


#### Consideraciones para eliminar observaciones:

-   Información por número de NA.

-   Información irrelevante para el estudio.

-   Poca claridad en la información brindada.


#### PROCEDIMIENTO DE LIMPIEZA

Ahora vamos a cambiar los nombres de las variables de nuestro base de datos para poder trabajarlo de mejor manera:

```{r,echo=TRUE, results='hide'}
names(Datos)
```

Eliminamos la variable `Marca temporal` porque no aporta nada a nuestra investigación.

```{r,echo=TRUE,message=FALSE,include=FALSE}
Datos %>% select(`Marca temporal`)
Datos $`Marca temporal` <- NULL
```

```{r,echo=FALSE,message=TRUE}
Datos %>% rename( Genero = `Género`
                 , Cursos = `¿Cuántos cursos llevaste el ciclo 2022-2?`
                 , Promedio = `¿Cuál fue tu promedio ponderado del ciclo 2022-2? (Redondeado a las décimas / Punto como separador decimal) (Ejemplo: si tu ponderado fue de 15.88, la respuesta debería ser \"15.9\")\n`
                 , HorasSueño = `¿Cuántas horas diarias en promedio de sueño tuviste durante el ciclo 2022-2? (Ejemplo: si dormiste 5 horas en promedio, la respuesta debería ser \"5\")`
                 , Calidad = `¿Cómo describirías la calidad de tu sueño durante el ciclo 2022-2?`
                 , Estres = `¿Cómo describirías tu nivel de estrés durante el ciclo 2022-2?`
                 , Ocio = `¿Cuántas horas de ocio diarias tenías en promedio durante el ciclo 2022-2?  (Ejemplo: si tenías 3 horas de ocio en promedio, la respuesta debería ser \"3\")`
                 , Faltas = `¿Faltabas a clase durante el ciclo 2022-2 ?`
                 , Tiempollegada = `¿Cuánto tiempo necesitas para llegar a la universidad?`
                 , Evaluaciones = `¿Qué tipo de evaluaciones que has tenido durante el ciclo 2022-2, se te dificultaron más?`) -> Datos
names(Datos)
```

Ahora si podemos entender las variable con normalidad.

Nos damos cuenta que hay algunos errores en los tipos de variable:

```{r, echo=TRUE, results='hide'}
class(Datos$Genero)
class(Datos$Edad)
class(Datos$Cursos)
class(Datos$Promedio) # Debería ser numérica
class(Datos$HorasSueño) # Debería ser numérica
class(Datos$Calidad)  
class(Datos$Estres)
class(Datos$Ocio) # Debería ser numérica
class(Datos$Faltas)
class(Datos$Tiempollegada) 
class(Datos$Evaluaciones)
```

Eso significa que algo pasa por los datos y por lo tanto se debe de hacer una limpieza.


#### [Promedio:]{style="color:blue"}

```{r, echo=TRUE, results='hide'}
table(Datos$Promedio)
```

Como vemos que hay un valor que no coincide con los demás, vamos a ubicarlo y corregirlo:

```{r, echo=TRUE, results='hide'}
which(Datos$Promedio=="12 aprox")
which(Datos$Promedio=="trece punto seis de promedio ponderado")
```

Ahora vemos que la persona que puso dicha cifra no entendió bien las indicaciones, entonces reemplazamos dicho dato con solo su parte numérica:

```{r,echo=TRUE, results='hide'}
Datos$Promedio[57]="12"
Datos$Promedio[167]="13.6"
table(Datos$Promedio)
```

También vemos que hay unas comas en lugar de puntos, como se nos olvidó colocar el delimitador decimal es nuestro error. Así que vamos a solucionarlo reemplazando todas las comas por puntos:

```{r,echo=FALSE,message=TRUE,include=TRUE}
Datos$Promedio <- gsub(",", ".", Datos$Promedio)
table(Datos$Promedio)
```

```{r,echo=TRUE, results='hide'}
table(is.na(Datos$Promedio)) # Nuestro número de variables no ha cambiado y las comas se han corregido correctamente
```

Ahora vamos a cambiarle el tipo de variable:

```{r,echo=FALSE,message=TRUE,include=TRUE}
Datos$Promedio <- as.numeric(Datos$Promedio)
class(Datos$Promedio)
```

Vemos que el tipo de variable si se cambió con éxito. A continuación, redondearemos todos los valores al décimo, ya que hay algunos que están redondeados al centésimo cuando claramente se ve en las indicaciones que el dato se colocaba redondeado al décimo.

```{r,echo=FALSE,message=TRUE,include=TRUE}
Datos$Promedio <- round(Datos$Promedio, 1)
table(Datos$Promedio)
```

Podemos observar que todos los valores se redondearon con éxito al décimo. No podemos determinar la veracidad total de los datos brindados por los estudiantes; no obstante, gracias a la información brindada por el alumno que obtuvo el primer puesto del periodo 2022-2, cuyo promedio ponderado fue de `19`, además se sabe que ningún alumno tuvo un promedio de `0` ,por lo tanto podemos corroborar que hay dos datos que están erróneos en esa tabla. Procedemos a su eliminación:

```{r,echo=TRUE, results='hide'}
which(Datos$Promedio==20)
Datos$Promedio[21]=NA
```

```{r,echo=TRUE, results='hide'}
which(Datos$Promedio==0)
Datos$Promedio[168]=NA
```

Como se ha completado la limpieza de datos, vamos a graficar la variable:

```{r,echo=FALSE,message=FALSE}
hist(Datos$Promedio
     ,col = "steelblue"
        , xlab = "Promedio Ponderado"
        , ylab = "Cantidad de Alumnos"
        , main = "Promedio Ponderado de los alumnos durante el Periodo 2022-2"
        , sub = paste("Valores válidos:"
        , sum(!is.na(Datos$Promedio)), "de una muestra con", nrow(Datos), "observaciones.")
        , breaks = seq(from = min(Datos$Promedio, na.rm = TRUE)-1
                       , to = max(Datos$Promedio, na.rm = TRUE)+1, by = 0.1)
     )
```

De los datos obtenidos se sabe que el promedio más alto es de `19` y el promedio más bajo es de `5.7`,así también como la media de los promedios es `14.22`, así como la mediana es `14.2`. Además, podemos notar que hay una clara anormalidad en los valores enteros como el 14, 15 o 16. Y esto se debe principalmente al redondeo de las personas a la hora del llenado de la encuesta.

```{r,echo=TRUE,message=TRUE,include=FALSE}
max(Datos$Promedio,na.rm = TRUE)
min(Datos$Promedio,na.rm = TRUE)

round(mean(Datos$Promedio,na.rm = TRUE),2)
round(median(Datos$Promedio,na.rm = TRUE),2)
round(sd(Datos$Promedio,na.rm = TRUE),2)
IQR(Datos$Promedio,0.5,na.rm = TRUE)
```


#### [HorasSueño:]{style="color:blue"}

```{r,echo=TRUE, results='hide'}
table(Datos$HorasSueño)
```

Como estamos viendo, hay algunos datos que no son del todo numéricos, entonces vamos a corregirlos o eliminarlos:

```{r}
Datos$HorasSueño[grep("5 :c", Datos$HorasSueño)] <- 5 # Dejamos solo la variable numérica
Datos$HorasSueño[grep("Dormía 6 horas diarias", Datos$HorasSueño)] <- 6 # Dejamos solo la variable numérica
Datos$HorasSueño[grep("Muy poco", Datos$HorasSueño)] <- NA # En las indicaciones se especificó que se debía de colocar una variable numérica expresada en horas
Datos$HorasSueño[grep("6-7", Datos$HorasSueño)] <- NA # Como no podemos determinar que número colocar, eliminamos la variable
Datos$HorasSueño[grep("ocho horas diarias de sueño", Datos$HorasSueño)] <- 8 # Dejamos solo la variable numérica
table(Datos$HorasSueño)
```

Como nadie puede sobrevivir sin dormir tenemos que eliminar la variable 0, así como también un estudiante no puede dormir más de 12 horas diariamente.

redondearemos los valores que tienen decimales, debido a que vamos a trabajar con enteros.

```{r,echo=TRUE,message=TRUE,include=FALSE}
Datos$HorasSueño[grep("0", Datos$HorasSueño)] <- NA
Datos$HorasSueño <- as.numeric(Datos$HorasSueño)
Datos$HorasSueño <- ifelse(is.na(Datos$HorasSueño), NA, round(Datos$HorasSueño))
Datos$HorasSueño[Datos$HorasSueño>12]<-NA

```

```{r,echo=FALSE,message=TRUE,include=TRUE}
table(Datos$HorasSueño)
```

Como ya son horas razonables de sueño, vamos a graficar la variable:

```{r,echo=FALSE,message=FALSE}
barplot(table(Datos$HorasSueño)
     ,col="green"
     , xlab = "Horas de sueño"
     , ylab = "Cantidad de alumnos"
     , main = "Promedio de horas de sueño de los alumnos del ciclo 2022-2"
     , sub = paste("Valores válidos:"
     , sum(!is.na(Datos$HorasSueño)), "de una muestra con", nrow(Datos), "observaciones.")
     )
```

De los datos obtenidos se sabe que hay un estudiante que duerme `12h` y otros dos que duerme `2h`,así también como la media de la hora de sueño es de `6.08h`, así como la mediana es de `6h`.

```{r,echo=TRUE,message=TRUE,include=FALSE}
max(Datos$HorasSueño,na.rm = TRUE)
min(Datos$HorasSueño,na.rm = TRUE)

round(mean(Datos$HorasSueño,na.rm = TRUE),2)
round(median(Datos$HorasSueño,na.rm = TRUE),2)
round(sd(Datos$HorasSueño,na.rm = TRUE),2)
IQR(Datos$HorasSueño,0.5,na.rm = TRUE)
```


#### [Ocio:]{style="color:blue"}

```{r,echo=TRUE, results='hide'}
table(Datos$Ocio)
```

Primeramente, vamos a eliminar las cadenas de palabras cortas, puesto que no respondieron correctamente a la pregunta.También se deduce que un estudiante no puede tener más de 9h de ocio en promedio.

```{r,echo=TRUE,message=TRUE,include=FALSE}
Datos$Ocio[grep("A la semana máximo 1 día (fuera de semana de exámenes obviamente)", Datos$Ocio)] <- NA
```

```{r,echo=TRUE,message=TRUE,include=TRUE}

Datos$Ocio = as.numeric(gsub("[^0-9.]+", "", Datos$Ocio))
table(Datos$Ocio)
Datos$Ocio[Datos$Ocio>9]<-NA
table(Datos$Ocio)
```

Ahora que tenemos los datos ordenados, procedemos a convertir la variable en numérica y a gratificarla.

```{r,echo=FALSE,message=FALSE,include=TRUE}
Datos$Ocio <- as.numeric(Datos$Ocio)
barplot(table(Datos$Ocio)
     ,col="#00F3FF"
     , xlab = "Horas de ocio"
     , ylab = "Cantidad de alumnos"
     , main = "Promedio de horas de ocio de los alumnos del ciclo 2022-2"
     , sub = paste("Valores válidos:"
     , sum(!is.na(Datos$Ocio)), "de una muestra con", nrow(Datos), "observaciones.")
     
     )
```

De los datos obtenidos se sabe que hay tres estudiantes que tienen `9h` de ocio y uno que no tiene horas de ocio(`0h`),así también como la media de la horas de ocio es de `3.31h`, así como la mediana es de `3h`. De la gráfica podemos observar que la mayoría de personas tenía una cantidad aceptable de horas de ocio.

```{r,echo=TRUE,message=TRUE,include=FALSE}
max(Datos$Ocio,na.rm = TRUE)
min(Datos$Ocio,na.rm = TRUE)

round(mean(Datos$Ocio,na.rm = TRUE),2)
round(median(Datos$Ocio,na.rm = TRUE),2)
round(sd(Datos$Ocio,na.rm = TRUE),2)
IQR(Datos$Ocio,0.5,na.rm = TRUE)
```


#### [Edad:]{style="color:blue"}

```{r}
table(Datos$Edad)
```

La edad mínima en UTEC es de 16 años , así como la mayor edad no puede superar los 30 años.

```{r,echo=FALSE }
Datos$Edad[Datos$Edad<16]<-NA
Datos$Edad[Datos$Edad>30]<-NA
table(Datos$Edad)
```

Ahora que tenemos los datos ordenados , procederemos a graficar.

```{r,echo=FALSE,message=FALSE,include=TRUE}
barplot(table(Datos$Edad)
     ,col="#B348D1"
     , xlab = "Edad"
     , ylab = "Cantidad de alumnos"
     , main = "Edad de los alumnos del ciclo 2022-2"
     , sub = paste("Valores válidos:"
     , sum(!is.na(Datos$Edad)), "de una muestra con", nrow(Datos), "observaciones.")
     
     )
```

De los datos obtenidos se sabe que hay un alumno de `27` años y unos seis con `16` años,así también como la media de la edad es de `18.95`años, así como la mediana es de `19` años. Inclusive, podemos concluir que la mayoría de los estudiantes que llenaron la encuesta están cursando entre el tercer ciclo a el quinto ciclo, y esto se deduce a través de las tres edades más 'famosas' en la encuesta, que vendrían a ser el 18, 19 y 20.

```{r,echo=TRUE,message=TRUE,include=FALSE}
max(Datos$Edad,na.rm = TRUE)
min(Datos$Edad,na.rm = TRUE)

round(mean(Datos$Edad,na.rm = TRUE),2)
round(median(Datos$Edad,na.rm = TRUE),2)
round(sd(Datos$Edad,na.rm = TRUE),2)
IQR(Datos$Edad,0.5,na.rm = TRUE)
```


#### [Cursos:]{style="color:blue"}

Para ser considerado un alumno regular debe conseguir una cierta cantidad de créditos que a lo mucho se consigue con mínimo 3 cursos

```{r}
table(Datos$Cursos)
Datos$Cursos[Datos$Cursos<3]<-NA
table(Datos$Cursos)
```

```{r,echo=FALSE,message=FALSE,include=TRUE}
barplot(table(Datos$Cursos)
     ,col="#FAFF5C"
     , xlab = "Cursos"
     , ylab = "Cantidad de alumnos"
     , main = "cantidad de Cursos de los alumnos del ciclo 2022-2"
     , sub = paste("Valores válidos:"
     , sum(!is.na(Datos$Cursos)), "de una muestra con", nrow(Datos), "observaciones.")
     
     )
```

De los datos obtenidos se sabe que se llevan como máximo `8` cursos y como mínimo `3` cursos y que la mayoría de los encuestados llevan `7` cursos

```{r,echo=TRUE,message=TRUE,include=FALSE}
max(Datos$Cursos,na.rm = TRUE)
min(Datos$Cursos,na.rm = TRUE)

round(mean(Datos$Cursos,na.rm = TRUE),2)
round(median(Datos$Cursos,na.rm = TRUE),2)
round(sd(Datos$Cursos,na.rm = TRUE),2)
IQR(Datos$Cursos,0.5,na.rm = TRUE)

```


#### [Evaluaciones:]{style="color:blue"}

Como nuestros datos aparecen juntos vamos a separarlos y graficar el total de cada tipo de evaluación

```{r}
Datos$TipoExamen <- FALSE
Datos$TipoExamen[grep("Examenes", Datos$Evaluaciones)] <- TRUE

Datos$TipoTrabajosG <- FALSE
Datos$TipoTrabajosG[grep("Trabajos grupales", Datos$Evaluaciones)] <- TRUE

Datos$TipoTest <- FALSE
Datos$TipoTest[grep("Test", Datos$Evaluaciones)] <- TRUE

Datos$TipoTareas <- FALSE
Datos$TipoTareas[grep("Tareas", Datos$Evaluaciones)] <- TRUE

Datos$TipoProyectos <- FALSE
Datos$TipoProyectos[grep("Proyectos", Datos$Evaluaciones)] <- TRUE
```

```{r,echo=FALSE,message=FALSE,include=TRUE}
Tipos<-c("Examenes", "Trabajos Grupales", "Tests", "Tareas", "Proyectos")
cantidad<-c(sum(Datos$TipoExamen)
            ,sum(Datos$TipoTrabajosG)
            ,sum(Datos$TipoTest)
            ,sum(Datos$TipoTareas)
            ,sum(Datos$TipoProyectos)
            )
dataf=data.frame(Tipos,cantidad)
plot_ly(dataf,x=Tipos,y=cantidad,type = "bar", color =Tipos)%>%
  layout(xaxis = list(title = "Evaluaciones"), yaxis = list(title = "Cantidad de alumnos"))
```

De la gráfica se deduce que los alumnos del ciclo 2022-2 sienten que la evaluaciones más difíciles para ellos fueron los exámenes (parciales y finales), así como una similitud en dificultad con las tareas, quizes (tests) y trabajos grupales.


# [ANALISÍS DESCRIPTIVO]{style="color:deepskyblue"}

Nuestro análisis se va desarrollar en base a los objetivos planteados:

1.  Determinar la relación entre el número de cursos y la calidad del sueño de los estudiantes de UTEC durante el ciclo 22-2.

2.  Determinar las repercusiones de la mala calidad de sueño en el desempeño académico de los estudiantes durante el ciclo 22-2.

3.  Analizar los niveles de estrés que influyeron negativamente en la calidad de sueño de los estudiantes durante el ciclo 22-2.

4.  Determinar si existe alguna relación entre el género y el promedio de notas en el Ciclo 2022-2.

5.  Identificar los factores que afectaron la calidad de sueño de los estudiantes de UTEC durante el ciclo 22-2.

6.  Proponer recomendaciones y estrategias para mejorar la calidad de sueño de los estudiantes y su rendimiento académico en futuros ciclos.

------------------------------------------------------------------------

```{r,echo=TRUE, results='hide'}
table(complete.cases(Datos))
DatosL<-Datos[complete.cases(Datos),]
head(DatosL)

```

```{r,echo=TRUE, results='hide'}
str(DatosL)
```

```{r}
nrow(DatosL)
```

Trabajaremos con las observaciones completas de nuestra base de datos limpia, en este caso son: 297 observaciones.


#### 1.- Determinar la relación entre el número de cursos y la calidad del sueño de los estudiantes de UTEC durante el ciclo 22-2

Para ello, tendremos que organizar la variable `Calidad` y compararla con el `Número de cursos`:

```{r}
DatosL$Calidad <- factor(DatosL$Calidad, levels = c("Excelente","Buena","Regular","Mala","Pésima"))
```

```{r,echo=FALSE,message=FALSE,include=TRUE}
ggplot(data = DatosL, aes(x = Cursos, y = Calidad)) +
  geom_point() +
  labs(x = "Número de Cursos", y = "Calidad del Sueño", title = "Relación entre Número de Cursos y Calidad del Sueño")+ theme(plot.title = element_text(hjust = 0.5,size=15))
```

Al ver gráfico de dispersión, podemos ver que las variables `Cursos` y `Calidad` no guardan relación alguna. Entonces, podemos suponer que el **número de cursos** no implica una **mala calidad de sueño**. Sin embargo, para tener una idea más clara recurriremos a una tabla de contingencia donde podemos relacionar estos valores de una mejor manera:

```{r}
table(DatosL$Calidad, DatosL$Cursos)
```

A través de esta tabla, podemos observar que la calidad predominante entre los estudiantes que llevan de 5 a 7 cursos es de regular a pésima. Inclusive, si nos fijamos en la calidad `mala` podemos observar que incrementa a medida que incrementa el número de cursos. Lo anteriormente dicho, más el hecho que la mayoría de estudiantes que llevan 8 cursos tienen una calidad de sueño menor o igual a `regular` ; nos dice que existe una relación **débil** entre estas dos variables. Y que a medida que se incrementa el número de cursos, la calidad de sueño de los estudiantes es **peor**.


#### 2.- Determinar las repercusiones de la mala calidad de sueño en el desempeño académico de los estudiantes durante el ciclo 22-2.

Para determinar el desempeño de los estudiantes respecto a su calidad de sueño, relacionaremos la variable `Promedio` con la variable `Calidad`:

```{r,echo=FALSE,message=FALSE,include=TRUE}
boxplot(DatosL$Promedio ~ DatosL$Calidad, xlab = "Calidad", ylab = "Promedio", col = c("yellow","yellow","green","red","red"), main = "Boxplot de Promedio de los estudiantes y su Calidad de sueño")

# Contar el número de observaciones en cada categoría
observaciones <- table(DatosL$Calidad)
# Obtener las coordenadas x y y para ubicar el texto
coordenadas_x <- 1:length(observaciones)
# Agregar el texto con el número de observaciones en cada caja
text(x = coordenadas_x, y = par("usr")[4] -1, labels = observaciones)
```

Como se puede observar, con el boxplot a simple vista, podemos inferir que a **peor calidad de suelo,** **peor** es el **promedio del estudiante**. Y esto es lógico, debido a que no solo la cantidad de horas de sueño es importante, uno también va a depender de que tan bien duerme. Por ejemplo, si una persona se levanta muchas veces para ir al baño durante la hora de la siesta, podemos decir que su calidad de sueño va a ser inferior a la de alguien que ha dormido de corrido.

Por lo tanto, podemos decir que la mala calidad de sueño de una persona, también influye en su sus notas. Lo cuál, hace repercusión en su promedio ponderado total. Para una idea más clara, realizaremos un análisis ANOVA.

Para dicho análisis necesitaremos formular las siguientes hipótesis:

- H0 = La mala calidad de sueño de un estudiante del ciclo 22-2, no influye en su sus notas.

- H1 = La mala calidad de sueño de un estudiante del ciclo 22-2, influye en su sus notas.

```{r,echo=FALSE,message=FALSE,include=TRUE}
modelo_anova <- aov(DatosL$Promedio ~ DatosL$Calidad, data = DatosL)
resultado <- summary(modelo_anova)
print(resultado)
```

Gracias al análisis podemos concluir lo siguiente:

a.  Si existe una relación significativa entre ambas variables: esto debido a que el valor ***p*** asociado al estadístico **F** es extremadamente pequeño (6.12e-12) y se encuentra por debajo de cualquier *nivel de significancia* comúnmente utilizado.

b.  Diferencias entre las categorías de calidad: se asume que hay diferencias significativas entre al menos dos categorías.

c.  Varianza: la variabilidad explicada por la variable `Calidad` (50.50) es considerablemente mayor que la variabilidad no explicada (3.13). Esto sugiere que la calidad de sueño puede explicar una proporción significativa de la variabilidad en el promedio.

En conclusión, el análisis ANOVA **afirma** la relación entre estas dos variables. Debido a que, se puede interpretar que existe evidencia estadística significativa para rechazar la hipótesis nula y concluir que **la calidad de sueño tiene un impacto significativo en el promedio de los estudiantes**.


#### 3.- Determinar la relación entre el número de cursos y lel estrés de los estudiantes de UTEC durante el ciclo 22-2

A continuación, relacionaremos las variables `Cursos` y `Estres` :

```{r,echo=FALSE,message=FALSE,include=TRUE}
df <- data.frame(Num_Cursos = DatosL$Cursos, Calidad_Estres = DatosL$Estres)
DatosL$Estres <- factor(DatosL$Estres, levels = c("Alto","Medio","Bajo"))

# Crear el gráfico de dispersión con jitter
ggplot(data = df, aes(y = Num_Cursos, x = Calidad_Estres)) +
  geom_jitter(width = 0.2, height = 0.2) +
  labs(x = "Nivel de Estrés", y = "Número de Cursos", title = "Relación entre Número de Cursos y Nivel de Estrés")+ theme(plot.title = element_text(hjust = 0.5,size=20))
```

Podemos suponer que las variables `Estres` y `Cursos` están relacionadas **fuertemente**, ya que se puede apreciar en la gráfica que a medida que aumenta el número de cursos, hay una mayor cantidad de puntos en los niveles alto y medio. Estos puntos hacen referencia a las personas que llenaron nuestra encuesta, y por ende podemos concluir que **a mayor cantidad de cursos**, **mayor será el nivel de estrés del alumno**.

Sin embargo, el estrés no solo depende de la carga académica sino también de factores externos que no se entran en el alcance de este análisis. Algunos de estos factores podrían ser: el nivel de dificultad del curso, la capacidad organizativa del alumno, la condición del alumno, entre otros factores.


#### 4.- Determinar si existe alguna relación entre el género y el promedio de notas en el Ciclo 2022-2.

Primero tenemos que hallar el porcentaje total de cada género referente a nuestra muestra:

```{r,echo=FALSE,message=FALSE,include=TRUE}
Ma <- DatosL$Genero[grep("Masculino", DatosL$Genero)]
Fe <- DatosL$Genero[grep("Femenino", DatosL$Genero)]
P <- DatosL$Genero[grep("Prefiero no decirlo", DatosL$Genero)]
Mas <- round((table(Ma)*100)/nrow(DatosL),2)
Fem <- round((table(Fe)*100)/nrow(DatosL),2)
Pe <- round((table(P)*100)/nrow(DatosL),2)
Mas
Fem
Pe
```

A partir de los datos obtenidos, podemos decir que de la muestra total el **50.51%** son hombres, el **40.07%** son mujeres y el **9.43%** no se identifican como ninguno de los anteriores. Lo cual evidencia claramente que la mayoría de nuestra muestra son hombres.

```{r,echo=FALSE,message=FALSE,include=TRUE}
tabla_cruzada <- table(Datos$Genero, cut(Datos$Promedio, breaks = c(0, 9, 11, 13, 16,18,20)))
print(tabla_cruzada)
```

Esta tabla cruzada también evidencia lo anteriormente dicho, pero nos dice que en general los hombres tienen un mejor pormedio que las mujeres. En este caso no vamos a tomar en cuenta el otro género, ya que no corresponde al objetivo.

Para tener una idea más clara, compararemos los promedios de ambos géneros en dos casos específicos: cuando aprueban (\> 10.5) y cuando sacan más de 15.

-   Cuando aprueban:

```{r,echo=FALSE,message=FALSE,include=TRUE}
ContadorM <- sum(DatosL$Genero == "Masculino" & DatosL$Promedio > 10.5)
ContadorF <- sum(DatosL$Genero == "Femenino" & DatosL$Promedio > 10.5)
round((ContadorM*100)/table(Ma),2)
round((ContadorF*100)/table(Fe),2)
```

Como podemos observar el porcentaje de los hombres **98%** y el porcentaje de las mujeres **99.16** que aprobaron es muy parecido entre sí, simplemente se diferencian por 1.16%.

-   Cuando sacan más de 15:

```{r,echo=FALSE,message=FALSE,include=TRUE}
ContadorM <- sum(DatosL$Genero == "Masculino" & DatosL$Promedio > 15)
ContadorF <- sum(DatosL$Genero == "Femenino" & DatosL$Promedio > 15)
round((ContadorM*100)/table(Ma),2)
round((ContadorF*100)/table(Fe),2)
```

Ahora si podemos observar una brecha más notoria entre el promedio de ambos géneros, teniendo una diferencia aproximada del 25% a favor del género *Masculino*.

En conclusión, **no existe relación alguna** entre el género y el promedio de los estudiantes, solamente podemos concluir que en nuestra muestra, los hombres tienen un índice de promedio *mayor* al de las mujeres.


#### 5.- Identificar los factores que afectaron la calidad de sueño de los estudiantes de UTEC durante el ciclo 22-2.

Para esto haremos varias relaciones con la variable `Calidad`, empezaremos con la variable `Estres` mediante la ayuda de un mosaico:

```{r,echo=FALSE,message=FALSE,include=TRUE}
Tabla_estres_calidad <- mosaicplot(table(Datos$Calidad, Datos$Estres), color = c("blue", "green","red"), 
             xlab = "Calidad", ylab = "Estres", main = "Mosaico de Nivel de Estrés y Calidad de sueño")
```

Del mosaico podemos notar que los estudiantes que tienen una calidad de sueño *excelente* poseen un nivel de estrés muchísimo más *bajo* comparado a los que tienen una *mala* calidad de sueño. Esta idea también es reforzada cuando miramos las filas de *mala y pésima* calidad de sueño. Donde notamos que la mayoría de los estudiantes tienen un nivel *alto o medio* de estrés.

Para amplificar la idea, realizaremos un histograma entre estas dos variables:

```{r,echo=FALSE,message=FALSE,include=TRUE}
df <- data.frame(Variable1 = DatosL$Estres, Variable2 = DatosL$Calidad)

# Crear el histograma con dos variables categóricas
ggplot(data = df) +
  geom_bar(aes(x = Variable1, fill = Variable2), position = "dodge") +
  labs(x = "Estres", y = "Frecuencia", title = "Histograma de Estres y Calidad")+ theme(plot.title = element_text(hjust = 0.5,size=20))+guides(fill = guide_legend(title = "Calida de Sueño"))

```

Y efectivamente podemos decir, que a mayor nivel de estrés, peor va a ser la calidad de sueño. Entonces, podemos afirmar lo siguiente, el nivel de estrés y la calidad de sueño tienen una **relación inversa**.

Para analizar si las horas de ocio guardan relación con la calidad de sueño, es mejor analizarlas con el nivel de estrés del estudiante, ya que ahora tenemos la relación clara entre el `Estres`y la `Calidad`. Entonces, verifiquemos si las `Horas de ocio` influyen en el nivel de estrés de los estudiantes mediante un histograma:

```{r,echo=FALSE,message=FALSE,include=TRUE}
df <- data.frame(Variable1 = DatosL$Ocio, Variable2 = DatosL$Estres)

# Crear el histograma con dos variables categóricas
ggplot(data = df) +
  geom_bar(aes(x = Variable1, fill = Variable2), position = "dodge") +
  labs(x = "Ocio", y = "Frecuencia", title = "Ocio vs. Estres")+theme(plot.title = element_text(hjust = 0.5,size=20))+guides(fill = guide_legend(title = "Nivel de Estrés"))

```

Como se puede apreciar, las horas de ocio también afectan al estrés del estudiante. Y esto tiene que ver principalmente con la *organización* del alumno. Así que, de la gráfica podemos concluir que las personas con un nivel de estrés **alto y medio** cuentan con una cantidad *menor* de horas de ocio.

Ahora veremos si el `tiempo en que se demora un estudiante a llegar a la universidad` afecta de manera significativa a su calidad de sueño:

```{r}
color <- c("black","grey","brown","blue","lightblue","green","yellow")
barplot(table(DatosL$Tiempollegada, DatosL$Calidad), 
        beside = TRUE,
        xlab = "Calidad de sueño",
        ylab = "Frecuencia",
        main = "Relación entre el Tiempo de llegada a la UTEC y la Calidad de sueño",
        col = color)
legend(x = 0.8, y = 35, legend = c("1h","1h y media","2h","2h y media","3h","más de 3h", "menos de 30 min"), fill = color, cex = 0.7)
```

Y efectivamente como podemos ver en el barplot, en la categoría **excelente** no hay alumno cuyo tiempo de llegada sobrepase las 2 horas, mientras que a medida que vamos bajando en los niveles de la *calidad de sueño* podemos notar que el tiempo que le toma al estudiante en llegar a la universidad *sobrepasa las 2 horas*. Además, podemos notar que en las categorías **mala y pésima** el tiempo de llegada va aumentando significativamente.

Por lo tanto, podemos inferir que a **mayor tiempo de llegada**, **peor va a ser la calidad de sueño del estudiante**. Y esto tiene bastante lógica, debido a que un estudiante que vive bastante lejos de la universidad se tendrá que despertar más temprano que otros. Lo cuál, afecta en sus horas de sueño y por ende también afecta en la calidad de este mismo.


#### 6.- Proponer recomendaciones y estrategias para mejorar la calidad de sueño de los estudiantes y su rendimiento académico en futuros ciclos.

El propósito principal de este análisis es *Analizar los factores que influyeron en la calidad de sueño de los estudiantes de la Universidad Tecnológica del Perú (UTEC) durante el ciclo `22-2`, y evaluar su repercusión en el desempeño académico de los cursos que llevaron*. Y de acuerdo a ello, proponer recomendaciones o soluciones para mejorar dicha calidad de sueño y por ende el rendimiento de los estudiantes en los futuros ciclo.

Entonces, a partir de todo lo analizado, les brindamos algunas recomendaciones y estrategias para mejorar la calidad de sueño:

- **Aprender como organizarse**: según varios estudios sobre el sueño, las personas que más saben organizarse tienen un mayor tiempo de descanso y por ende una mayor calidad de sueño.

- **Alquilar un dormitorio cercano a la universidad**: a partir del estudio realizado, hemos visto que bastantes estudiantes viven demasiado lejos de la universidad. Por ello, recomendamos buscar un alojamiento cercano a este, ya sea alquilado o de un familiar. De este modo, el estudiante podrá tener un mayor tiempo de descanso.

- **Establecer horarios regulares de sueño**: es importante que los estudiantes mantengan una rutina de sueño consistente, acostándose y levantándose a la misma hora todos los días, incluso fines de semana. Esto ayuda a regular el reloj interno del cuerpo y mejora la calidad del sueño. 

- **Crear un entorno propicio para dormir**: asegúrate de que tu dormitorio sea un lugar tranquilo, oscuro y fresco. Elimina distracciones como dispositivos electrónicos, luces brillantes y ruidos fuertes. También se recomienda invertir en un colchón y almohadas de calidad para asegurar un buen descanso. 

- **Evitar la cafeína y estimulantes**: especialmente por la tarde o noche. Estas sustancias pueden dificultar conciliar el sueño y tener un sueño profundo. 

- **Establecer una rutina de relajación antes de acostarse**: ayuda al estudiante a relajarse y prepararse para dormir. Esto puede incluir actividades como tomar un baño caliente, leer un libro, practicar técnicas de respiración o meditar.

- **Limitar el uso de dispositivos electrónicos antes de dormir**: la luz azul emitida por los dispositivos electrónicos, como teléfonos móviles, tabletas y computadoras, puede interferir con la calidad del sueño. Se recomienda establecer una "hora de apagado" de estos dispositivos al menos una hora antes de acostarse.


