---
title: "Correlación del estrés y enfermedades respiratorias más comunes que padecen
  los estudiantes de la universidad UTEC en el ciclo académico 2023-1"
date: "2023-06-03"
output:
  html_document:
    df_print: paged
format: html
---

# 1. Introducción

<div style="text-align: justify">

**Relevancia y Contexto**: Conocer las enfermedades respiratorias y el estrés en estudiantes universitarios es importante por varias razones:

-   **Salud:** La salud de los estudiantes universitarios es fundamental para su bienestar general y su capacidad para cumplir con sus objetivos académicos. Las enfermedades respiratorias pueden afectar su capacidad para respirar adecuadamente, lo que a su vez puede afectar su capacidad para concentrarse y aprender. El estrés puede causar problemas de salud física y mental, lo que puede interferir con su capacidad para aprender y tener éxito en la universidad.

-   **Rendimiento académico:** La salud de los estudiantes universitarios también puede afectar su rendimiento académico. Si los estudiantes están enfermos o estresados, pueden tener dificultades para concentrarse, estudiar y asistir a clases. Si esto ocurre con regularidad, puede afectar su rendimiento académico y su capacidad para cumplir con los requisitos de su programa de estudios.

-   **Prevención:** Conocer las enfermedades respiratorias y el estrés en estudiantes universitarios también es importante para la prevención. Si se comprenden los factores que contribuyen a la aparición de estas enfermedades, se pueden implementar medidas preventivas, como mejorar la calidad del aire en los edificios universitarios y proporcionar recursos para la gestión del estrés, para reducir la incidencia de estas enfermedades y mejorar la salud general de los estudiantes universitarios.

## 1.1. Objetivos

### 1.1.1 Objetivo principal:

-   Conocer el nivel de salud de los estudiantes de UTEC mientras afrontan el ciclo.

### 1.1.2. Objetivos específicos:

-   Identificar enfermedades respiratorias que reflejan los estudiantes.

-   Identificar el nivel de estrés que reflejan los estudiantes.

-   Verificar la correlación entre estrés y rendimiento académico de los estudiantes.

-   Analizar la correlación entre enfermedades o síntomas y la locación de la universidad UTEC.

# 2. Datos

## 2.1. Recolección de datos

<div style="text-align: justify">

Se recolectaron los datos completando la siguiente encuesta: <https://forms.gle/7B7MZtyVavFHGFfT9>

Para la recolección de datos, realizamos un cuestionario con diversas preguntas relacionada con enfermedades respiratoria y niveles de estrés a estudiantes de UTEC. Las preguntas fueron las siguientes:

-   Edad (años)

-   Estatura (m)

-   Peso (kg)

Sección de identificación del origen de las posibles causas de las enfermedades y estrés:

-   ¿Cuál es el distrito en el que vives actualmente? (Listado de distritos)

-   ¿Cuántas veces en este año haz confirmado que te has enfermado? (del 1 al 20)

-   ¿Consideras que te enfermas más durante el ciclo universitario?

-   ¿Consideras que te enfermas más durante las vacaciones?

-   ¿Cuál es el nivel de estrés que presentas durante el ciclo? (del 1 al 5 )

-   ¿Crees que la ubicación de la universidad UTEC sea un motivo para presentar enfermedades respiratorias?

-   ¿Crees que el nivel de exigencia de la universidad UTEC sea un motivo para presentar enfermedades respiratorias?

-   ¿Crees que el nivel de exigencia de la universidad UTEC sea un motivo para presentar estrés?

-   Tipos de movilización hacia la universidad (2 opciones).

Sección de enfermedades, síntomas o tipo de dolores:

-   ¿Presentas alguna enfermedad hereditaria?

-   Selecciona del listado cual presentas (lista de enfermedades hereditarias).

-   Realiza el siguiente test de estrés y coloca tu puntuación.

### 2.1.1. Población, muestra y muestreo

-   Población: Estudiantes de UTEC durante el ciclo 2023-1

-   Muestra: 181 estudiantes.

-   Muestreo: Se realiza muestreo por conveniencia.

## 2.2. Variables

#### 2.2.1. Variables Categóricas Nominales

| [Variable Categóricas Nominales]{style="color: #0CB7F2"} | [Definición]{style="color: #0CB7F2"}                                               |
|:-----------------------------|:-----------------------------------------|
| Nombre de usuario                                        | Nombre del estudiante universitario.                                               |
| Género                                                   | Género del estudiante.                                                             |
| Distrito                                                 | Distrito donde vive el estudiante.                                                 |
| EnfermoCiclo                                             | Si el estudiante se enferma más en el ciclo presenta.                              |
| EnfermoVacación                                          | Si el estudiante se enferma más en vacaciones.                                     |
| EnfermRespiCampus                                        | Si la ubicación de la universidad afecta su salud.                                 |
| EnfermResExigenAcadem                                    | Si la exigencia académica afecta al estudiante respecto a problemas respiratorias. |
| EstresExigAcadem                                         | Si la exigencia académica afecta al estudiante respecto al estrés.                 |
| Transport1                                               | Transporte como primer opción.                                                     |
| Transport2                                               | Transporte como segunda opción.                                                    |
| EnfermHeredit                                            | Si presenta enfermedades hereditarias.                                             |
| TipoEnfermHeredit                                        | El tipo de enfermedades hereditarias que presenta el estudiante.                   |

#### 2.2.2. Variables Categóricas Ordinales

| [Variable Categóricas Ordinales]{style="color: #0CB7F2"} | [Definición]{style="color: #0CB7F2"} |
|:------------------------------------------|:----------------------------|
| NivelEstres                                              | Nivel de estrés del 1 al 5.          |

#### 2.2.3. Variables Numéricas Discretas

| [Variable Numérica Discretas]{style="color: #0CB7F2"} | [Definición]{style="color: #0CB7F2"}                        |
|:---------------------------------|:-------------------------------------|
| Edad                                                  | Edad del estudiante.                                        |
| VecesEnfermo                                          | Veces que se enfermó el estudiante durante el año presente. |
| PuntosTest                                            | Puntaje del estudiante después de tomar el test de estrés.  |

#### 2.2.4. Variables Numéricas Continuas

| [Variable Numérica Continuas]{style="color: #0CB7F2"} | [Definición]{style="color: #0CB7F2"} |
|:-----------------------------------------|:-----------------------------|
| Estatura                                              | Estatura del estudiante en metros.   |
| Peso                                                  | Peso del estudiante en kilogramos.   |

## 2.3. Carga de datos limpios (PG1)

```{r}
librerias <- c("readr", "car", "dplyr", "stringr", "ggplot2")
not_installed <- librerias[!(librerias %in% installed.packages()[ , "Package"])]
if(length(not_installed)) install.packages(not_installed)
# 
library(readr)
library(car)
library(dplyr)
library(stringr)
library(ggplot2)
#
DProy <- read_csv("Data_limpia.csv")
```

# 3. Análisis descriptivo

## 3.1. Análisis Univariado

### 3.1.1. Edad

```{r}
boxplot(DProy$Edad,
        horizontal = TRUE,
        xlab = "Edad",
        notch = TRUE)

promedio <- mean(DProy$Edad)

abline(v = promedio, col = "red", lwd = 2)

legend("topright", legend = c("Promedio"),
       lty = c(1, 1), col = c("red"), lwd = 2)

text(promedio, 1, labels = paste("Promedio:", round(promedio, 2)), pos = 3, col = "red")

```

Con el gráfico, nos podemos dar cuenta que la mayoría de personas que respondieron la encuesta son jóvenes, siendo el promedio de 19.66. Esto se justifica con que la población a la que nos dirigíamos eran estudiantes UTEC, quienes en su mayoría son jóvenes. También encontramos datos atípicos acercándose a los 30 y 40 respectivamente, lo que puede significar que existen estudiantes UTEC de esa edad o que una persona ajena llenó la encuesta, no hay forma de saber.

### 3.1.2. Distritos

```{r}
DProy %>% select(Distrito) %>% group_by(Distrito) %>% summarise(n())
which.max(table(DProy$Distrito))
```

Observamos que una gran parte de los distritos tienen menos de 10 encuestados en ellos. El distrito con la mayor cantidad es Santiago de Surco, con 28 encuestados.

### 3.1.3. Género

```{r}
barplot(table(DProy$Género))
```

Se encuentra una mayor cantidad de hombres que resolvieron la encuesta al número de mujeres. Esto concuerda con lo esperado de los estudiantes UTEC, pues en más hombres que mujeres atienden la universidad. Esto comprueba que la muestra sí puede ser representativa.

### 3.1.4. Veces enfermado

```{r}
moda = as.numeric(names(table(DProy$VecesEnfermo)[table(DProy$VecesEnfermo) == max(table(DProy$VecesEnfermo), na.rm = TRUE)]))
```

```{r}
hist(DProy$VecesEnfermo, prob = TRUE
     , main = "Histograma de veces enfermo"
     , xlab = "Veces enfermo"
     , ylab = "Frecuencia relativa"
     )
abline(v = c(mean(DProy$VecesEnfermo, na.rm=FALSE),
         median(DProy$VecesEnfermo,na.rm = FALSE)
        ), 
       col = c("red", "blue"),
       lty = c(2, 1),
       lwd = 2)
legend("topright"
       , legend = c("Promedio", "Mediana")
       , col = c("red", "blue")
       , lty = c(2, 1)
       , lwd = 2
       , bty = "n"
       )
```

Como el promedio es ligeramente mayor a la mediana, se puede decir que tiene una distribución sesgada a la derecha, o positivamente.

### 3.1.5. Puntos del test

```{r}
hist(DProy$PuntosTest, prob = TRUE
     , main = "Histograma de puntos del test"
     , xlab = "Puntos del test"
     , ylab = "Frecuencia relativa"
     )
abline(v = c(mean(DProy$PuntosTest, na.rm=TRUE),
         median(DProy$PuntosTest,na.rm = TRUE)
        ), 
       col = c("red", "blue"),
       lty = c(2, 1),
       lwd = 2)
legend("topright"
       , legend = c("Promedio", "Mediana")
       , col = c("red", "blue")
       , lty = c(2, 1)
       , lwd = 2
       , bty = "n"
       )
```

Como se puede llegar a ver en el histograma que el promedio es cercano a 40 y la mediana es 40, como tal. Por ello, se puede aproximar que hay una distribución simétrica en la población estudiada. Entonces durante el ciclo para estas personas presentadas con un estrés medianamente elevado, según la relación de la pagina y el pontaje, presentarán un nivel de estrés prolongado durante un tiempo más extenso y adoptarán la forma del estrés crónico o estrés negativo.

## 3.2. Análisis Bivariado

### 3.2.1. Relación entre género y el haberse enfermado en el ciclo

```{r}
genero <- DProy$Género
EnfermoCiclo <- DProy$EnfermoCiclo
tabla <- table(genero, EnfermoCiclo)
mosaicplot(tabla, color = c("red", "blue"), main = "Mosaic Plot: Género vs EnfermoCiclo")
```

Se observa una mayor proporción de mujeres que de hombres que suelen enfermarse. Sin embargo, debemos tener en cuenta una limitación en los datos debido a que la mayoría de las respuestas de la encuesta fueron proporcionadas por hombres en lugar de mujeres. Esto puede generar cierta variación en los resultados, aunque no se compromete la credibilidad ni la validez de los mismos.

### 3.2.2. Relación entre estrés y veces enfermo

```{r}
VecesEnfermo <- DProy$VecesEnfermo
PuntosEstres <- DProy$PuntosTest

# Crear el scatter plot
plot(PuntosEstres, VecesEnfermo, 
     xlab = "Puntos de Estrés", ylab = "Veces Enfermo",
     main = "Relación entre Estrés y Enfermedades",
     col = "blue", pch = 16)

# Agregar una línea de tendencia
lm_model <- lm(VecesEnfermo ~ PuntosEstres)
abline(lm_model, col = "red")

# Agregar leyenda
legend("topright", legend = "Línea de Tendencia", col = "red", lwd = 1)

```

En relación a la conexión entre el estrés y las enfermedades, se utilizaron los datos del test de estrés y la frecuencia de enfermedades para crear un diagrama con una línea de tendencia. A través de este análisis, se observa que, en promedio, las personas que completaron el test presentan un nivel de estrés de aproximadamente 30 a 50 puntos. Esto sugiere una posible asociación entre este nivel de estrés y la frecuencia de enfermedades, ya que se observa un incremento en la cantidad de enfermedades conforme aumenta el nivel de estrés.

### 3.2.3. Relación entre estrés auto-evaluado y con test

```{r}
NivelEstres <- DProy$NivelEstres
PuntosEstres <- DProy$PuntosTest

# Crear el scatter plot
plot(PuntosEstres, NivelEstres, 
     xlab = "Puntos de Estrés (Test)", ylab = "Nivel de Estrés (Autoevaluacion)",
     main = "Relación entre Estrés autoevaluado y test",
     col = "blue", pch = 16)

# Agregar una línea de tendencia
lm_model <- lm(NivelEstres ~ PuntosEstres)
abline(lm_model, col = "red")

# Agregar leyenda
legend("topright", legend = "Línea de Tendencia", col = "red", lwd = 1)
```

En relación a la correlación entre la auto-evaluación del estrés y los puntos obtenidos en el test, se observa una variación de puntos que oscila entre aproximadamente 35 y 50. Estos hallazgos indican que, por cada incremento de 10 puntos en el test, se corresponde con un aumento de dos niveles de estrés en la auto-evaluación. Esto sugiere una tendencia creciente en los niveles de estrés de los estudiantes, considerando la mayoría de los puntos de estrés obtenidos en el test.

```{r}
boxplot(PuntosTest ~ EstresExigAcadem, data = DProy,
        xlab = "EstresExigAcadem", ylab = "PuntosTest",
        main = "Boxplot: EstresExigAcadem vs. PuntosTest")
```

Se puede observar que en relación a cómo el estrés afecta el rendimiento académico de los estudiantes, se ven impactados en numerosas ocasiones por emociones como la ansiedad, la ira y la depresión, lo cual conduce a un bajo rendimiento. El estrés tiene repercusiones en diversas enfermedades, y el desequilibrio generado por el estrés negativo debilita tanto la mente como el cuerpo. Los pensamientos, las emociones y la conducta también se ven afectados por el exceso de estrés. En el ámbito académico, el estrés alcanza niveles elevados en los estudios universitarios, caracterizados por una gran carga de responsabilidades, como consultas, trabajos individuales y en grupo, evaluaciones y proyectos, que exigen un alto nivel de calidad. Por estas razones, varios estudiantes han considerado la posibilidad de abandonar la universidad.

### 3.2.4. Relación entre transporte preferido y veces enfermo

```{r}
tb <- DProy %>% group_by(Transport1) %>% summarise (Total_VecesEnfermo= sum(VecesEnfermo, na.rm = T),Total_NivelEstres = sum(NivelEstres, na.rm = T),Total_TestEstres = sum(as.numeric(PuntosTest), na.rm = T)) %>% mutate(Nivel_Total = Total_VecesEnfermo+ Total_NivelEstres+ Total_TestEstres ) %>% arrange(desc(Nivel_Total))

tabla <- table(tb$Transport1, tb$Total_VecesEnfermo)
barplot(tb$Total_VecesEnfermo, 
        names.arg = tb$Transport1, 
        xlab = "Transporte", 
        ylab = "Total Veces Enfermo",
        main = "Total Veces Enfermo por Transporte preferido",
        col = c("Red", "Blue", "Yellow", "Green"))
```

Acá podemos intuir la relación que el medio de transporte es un posible foco de contagio, lugar de aparición de una enfermedad en una explotación o lugar determinados, y que los estudiantes por el estrés que presentan generalmente mantienen una relación directamente proporcional a bajo niveles de de sistema inmune, especificado en el punto 3.2.2. Por eso, mismo el tipos movilidad es otro factor para influencias y enfermedades respiratorias.

```{r}
boxplot(DProy$PuntosTest ~ DProy$Transport1, data = DProy, 
        xlab = "Tipo de transporte", ylab = "PuntosTest",
        main = "Boxplot de PuntosTest por tipo de transporte")
```

```{r}
table(DProy[DProy$Transport1 == "Bus", ][, c("Distrito", "Transport1")])
```

Adicionalmente, podemos ver que el nivel de estrés físico y mental va de la mano con el tipo de movilización en este caso. Partimos desde la relación estrecha de total de veces que una persona se puede llegar a enfermar por las defensas bajas que presentaría. Es decir a más veces que te enfermas significa que tus defensas son mucho mas bajas; entonces, también existiría la relación del estrés psicológico y físico del cuerpo que no permite tener la mayor recuperación posible. El bus o movilidad es el factor correspondiente para que el nivel de estrés sea elevado por el cansancio físico u hostigamiento físico-visual que se esta expuesto durante largos tramos de viaje.

### 3.2.5. Relación entre Género y si considera que la Exigencia Académica les causa estrés

```{r}
genero <- DProy$Género
EstresExigAcadem <- DProy$EstresExigAcadem
tabla <- table(genero, EstresExigAcadem)
mosaicplot(tabla, color = c("red", "blue"), main = "Mosaic Plot: Género vs EstresExigAcadem")
```

En esta relación, se puede ver claramente que, por amplia mayoría, los encuestados consideran que la exigencia académica de la universidad es un factor que les genera estrés sin importar el género. Esto lo podemos reforzar con la idea que se tiene un foco de puntos de estrés de entre 35 y 50 dentro del ciclo académico.

# 4. Probabilidades

El estudio de la probabilidad es una rama fundamental de la estadística que nos permite comprender y predecir eventos inciertos. En este proyecto, se busca analizar la relación entre diversas variables y la probabilidad de que se cumpla ciertos eventos(casos). A continuación, definimos algunas variables entre discretas o continuas.

## 4.1. Probabilidad Empírica:

### 4.1.1. Variable Aleatoria NivelEstrés

A continuación, analizaremos la variable aleatoria nivel estrés. El experimento aleatorio consta de seleccionar un estudiante universitario de nuestra base de datos y medir el nivel de estrés que presentan.

#### 4.1.1.1. Experimento

Seleccionar un estudiante del conjunto de datos obtenido (181) y observar el nivel de estrés auto-evaluado.

#### 4.1.1.2. Espacio de resultado

$$
\Omega_{Exp_1}=\{ 1,2,3,4,5 \}
$$

#### 4.1.1.3. Eventos

-   E~1~: Seleccionar un estudiante que presenta un nivel de estrés de 1
-   E~2~: Seleccionar un estudiante que presenta un nivel de estrés de 2
-   E~3~: Seleccionar un estudiante que presenta un nivel de estrés de 3
-   E~4~: Seleccionar un estudiante que presenta un nivel de estrés de 4
-   E~5~: Seleccionar un estudiante que presenta un nivel de estrés de 5

#### 4.1.1.4. Probabilidades

```{r}
Omega_1 <- DProy %>% group_by(NivelEstres) %>% summarise (Estudiantes_Por_NivelEstres=n())   %>% mutate(Prob_Estudiante_Por_NivelEstres= Estudiantes_Por_NivelEstres/181)

P1_atomicidad <- 0

for (i in 1:5) {
  # Nombre de variable
  variable_name <- paste0("P1_e", i)
  # Nombre a imprimir
  print_var <- paste0("P(E_", i, ")")
  
  value <- Omega_1[i, 3]
  assign(variable_name, value)
  # Sumatoria
  P1_atomicidad <- P1_atomicidad + value
  print(paste(print_var, "=", value))
}

print(paste("Atomicidad =", P1_atomicidad))
```

Observamos que la probabilidad más alta corresponde a P(E4) con un valor de 0.40331492, lo que indica que es más probable que los estudiantes tengan un nivel de estrés de 4 en comparación con otros niveles. Esto podría indicar que un gran número de estudiantes experimentan un nivel de estrés ligeramente alto dentro de nuestra escala.

Por otro lado, la probabilidad más baja se encuentra en P(E1) con un valor de 0.01657459. Esto sugiere que el nivel de estrés más bajo (1) es menos común entre los estudiantes de UTEC.

La distribución de probabilidad proporcionada muestra una tendencia ascendente en las probabilidades desde el nivel de estrés 1 hasta el 4, y luego una disminución en el nivel de estrés 5.

### 4.1.2. Variable Aleatoria VecesEnfermo

A continuación, analizaremos la variable aleatoria VecesEnfermo. El experimento aleatorio consta de seleccionar un estudiante universitario de nuestra base de datos y cuantificar cuántas veces se enferman.

#### 4.1.1.1. Experimento

Seleccionar un estudiante del conjunto de datos obtenido (181) y observar cuántas veces se han enfermado en el presente ciclo académico.

#### 4.1.1.2 Espacio de resultado

$$
\Omega_{Exp_2}=\{ 0,1,2,3,4,5,6,7,8,9,10 \}
$$

#### 4.1.1.3 Eventos

-   E~0~: Seleccionar un estudiante que se enfermó 0 veces
-   E~1~: Seleccionar un estudiante que se enfermó 1 veces
-   E~2~: Seleccionar un estudiante que se enfermó 2 veces
-   E~3~: Seleccionar un estudiante que se enfermó 3 veces
-   E~4~: Seleccionar un estudiante que se enfermó 4 veces
-   E~5~: Seleccionar un estudiante que se enfermó 5 veces
-   E~6~: Seleccionar un estudiante que se enfermó 6 veces
-   E~7~: Seleccionar un estudiante que se enfermó 7 veces
-   E~8~: Seleccionar un estudiante que se enfermó 8 veces
-   E~9~: Seleccionar un estudiante que se enfermó 9 veces
-   E~10~: Seleccionar un estudiante que se enfermó 10 veces

#### 4.1.1.4 Probabilidades

```{r}
Omega_2 <- DProy %>% group_by(VecesEnfermo) %>% summarise (Estudiantes_Por_VecesEnfermo=n())%>%mutate(Prob_VecesEnfermo=Estudiantes_Por_VecesEnfermo/181) %>% arrange(VecesEnfermo)

P2_atomicidad <- 0

for (i in 0:10) {
  # Nombre de variable
  variable_name <- paste0("P2_e", i)
  # Nombre a imprimir
  print_var <- paste0("P(E_", i, ")")
  
  row_index <- i + 1
  
  value <- Omega_2[row_index, 3]
  assign(variable_name, value)
  # Sumatoria
  P2_atomicidad <- P2_atomicidad + value
  print(paste(print_var, "=", value))
}

print(paste("Atomicidad =", P2_atomicidad))
```

Observamos que las probabilidades más altas se encuentran en los niveles P(E2), P(E1) y P(E0), con valores de 0.259668508, 0.209944751 y 0.160220994, respectivamente. Esto indica que es más probable que los estudiantes se enfermen una cantidad baja de veces (0, 1 o 2) en comparación con otros niveles.

A medida que aumentamos el número de veces que un estudiante se enferma, las probabilidades disminuyen gradualmente. Por ejemplo, las probabilidades son más bajas para P(E10), P(E7) y P(E9) con valores de 0.016574586, 0.005524862 y 0.005524862, respectivamente.

En general, podemos concluir que la distribución de probabilidad muestra una tendencia descendente a medida que aumenta el número de veces que un estudiante se enferma. Es más probable que los estudiantes se enfermen una cantidad baja de veces y menos probable que se enfermen una cantidad alta de veces.

## 4.2. Probabilidad Condicional:

### 4.2.1. Eventos independientes:

Para este proyecto, se tomará en cuenta la relación entre el estrés y las enfermedades respiratoria. Es por ello que tomaremos estos dos eventos, que son relevantes para nuestra investigación:

-   A~1~: Seleccionar a un estudiante que presenta un nivel de estrés mayor a 3.
-   A~2~: Seleccionar a un estudiante que presenta una cantidad de veces enfermo mayor a 5

Tomamos esos valores porque son el punto medio de nuestra escala y a partir de ello analizar si existe cierta dependencia o independencia.

#### 4.2.1.1. Verificar P(A~1~ ∩ A~2~) = P(A~1~) \* P(A~2~):

Para comprobar la fórmula P(A~1~ ∩ A~2~) = P(A~1~) \* P(A~2~), tenemos que hallar P(A~1~ ∩ A~2~). Es decir, la probabilidad de seleccionar a un estudiante que tenga un nivel de estrés mayor o igual a 3 y una cantidad de veces enfermo mayor o igual a 5.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres>=3 & VecesEnfermo>=5)
```

Entonces, la probabilidad de P(A~1~ ∩ A~2~) sería igual el siguiente número:

```{r}
Prob_A1_A2 = 13/181
Prob_A1_A2
```

A continuación, hallamos P(A~1~) que es la probabilidad de seleccionar a un estudiante que tenga un nivel de estrés mayor o igual a 3.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres>=3)
```

Obtenemos la probabilidad P(A~1~):

```{r}
Prob_A1=153/181
Prob_A1
```

Luego, hallamos P(A~2~) que es la probabilidad de seleccionar a un estudiante que tenga cantidad de veces enfermo mayor o igual a 5

Casos favorables:

```{r}
DProy %>% filter(VecesEnfermo>=5)
```

Obtenemos la probabilidad P(A~2~):

```{r}
Prob_A2 = 15/181
Prob_A2
```

Ahora podemos verificar la fórmula P(A~1~ ∩ A~2~) = P(A~1~) \* P(A~2~):

```{r}
Prob_A1*Prob_A2
Prob_A1_A2
```

Entonces, podemos afirma que son independientes. El nivel de estrés y las enfermedades respiratoria no comparte dependencia, en nuestra base de datos, como lo hemos podido comprobar, ya que P(A~1~ ∩ A~2~) = P(A~1~) \* P(A~2~) son aproximadamente iguales.

#### 4.2.1.2. Verificar P(A~1~/A~2~) = P(A~1~):

Ahora, verificaremos la siguiente fórmula: P(A~1~/A~2~) = P(A~1~). Para esto tenemos que hallar P(A~1~/A~2~). Es decir, la probabilidad de seleccionar a un estudiante que tenga un nivel de estrés mayor o igual a 3 dado que tenga una cantidad de veces enfermo mayor o igual a 5.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres>=3 & VecesEnfermo>=5)
```

Casos totales:

```{r}
DProy %>% filter(VecesEnfermo>=5)
```

Obtenemos la probabilidad P(A~1~/A~2~):

```{r}
Prob_A1_Dado_A2 = 13/15
Prob_A1_Dado_A2
```

Ahora podemos verificar la fórmula P(A~1~/A~2~) = P(A~1~):

```{r}
Prob_A1
Prob_A1_Dado_A2
```

Observamos que P(A~1~/A~2~) = P(A~1~) son aproximadamente iguales, por lo que podemos decir que son independientes.

#### 4.2.1.3. Verificar P(A~1~/A~2~) = P(A~1~ ∩ A~2~)/P(A~2~):

Luego, para comprobar la fórmula P(A~1~/A~2~) = P(A~1~ ∩ A~2~)/P(A~2~), reemplazamos algunos dados ya obtenido en la fórmula para verificarlo y obtenemos la siguiente probabilidad:

```{r}
Prob_A1_Dado_A2
Prob_A1_A2/Prob_A2
```

Con estos dos comparaciones, resultados podemos decir que son aproximadamente iguales, por lo que se puede afirma que son eventos independientes.

#### 4.2.1.4. Verificar P(A~2~/A~1~) = P(A~1~/A~2~)\*P(A~2~)/P(A~1~):

Por último, debemos comprobar la fórmula de Bayes P(A~2~/A~1~) = P(A~1~/A~2~)\*P(A~2~)/P(A~1~), por lo que primero hallamos P(A~2~/A~1~) y reemplazamos algunos dados ya obtenido en la fórmula para verificarlo.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres<3 & VecesEnfermo<5)
```

Casos totales:

```{r}
DProy %>% filter(NivelEstres>=3)
```

Obtenemos la probabilidad de P(A~2~/A~1~):

```{r}
Prob_A2_Dado_A1 = 26/153
Prob_A2_Dado_A1
```

A continuación verificamos la fórmula P(A~2~/A~1~) = P(A~1~/A~2~)\*P(A~2~)/P(A~1~) reemplazando valores obtenido anteriormente.

```{r}
Prob_A2_Dado_A1
Prob_A1_Dado_A2*Prob_A2/Prob_A1
```

Después de analizar si existe dependencia o independencia de los eventos, podemos decir que el evento A~1~ y A~2~ son independientes.

### 4.2.2. Eventos Dependientes:

A continuación, se tomará en cuenta la relación entre el nivel estrés y puntaje del test de estrés. Es por ello que tomaremos estos dos eventos, que son relevantes para nuestra investigación:

-   A~3~: Seleccionar a un estudiante que presenta un nivel de estrés mayor a 3.
-   A~4~: Seleccionar a un estudiante que presenta un puntaje de test mayor a 50.

#### 4.2.2.1. Verificar P(A~3~ ∩ A~4~) = P(A~3~) \* P(A~4~):

Para comprobar la fórmula P(A~3~ ∩ A~4~) = P(A~3~) \* P(A~4~), tenemos que hallar P(A~3~ ∩ A~4~). Es decir, la probabilidad de seleccionar a un estudiante que presenta un nivel mayor a 5 y que presenta un puntaje de test mayor a 50.

Casos totales:

```{r}
DProy %>% filter(NivelEstres>3 & PuntosTest>50)
```

Entonces, la probabilidad de P(A~3~ ∩ A~4~) sería igual el siguiente número:

```{r}
Prob_A3_A4 = 6/181
Prob_A3_A4
```

A continuación, hallamos P(A~3~) que es la probabilidad de seleccionar a un estudiante que tenga un nivel de estrés mayor a 3.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres>3)
```

Obtenemos la probabilidad P(A~3~):

```{r}
Prob_A3=108/181
Prob_A3
```

Luego, hallamos P(A~4~) que es la probabilidad de seleccionar a un estudiante que presenta un puntaje de test mayor a 50.

Casos favorables:

```{r}
DProy %>% filter(PuntosTest>50)
```

Obtenemos la probabilidad P(A~4~):

```{r}
Prob_A4 = 8/181
Prob_A4
```

Ahora podemos verificar la fórmula P(A~3~ ∩ A~4~) = P(A~3~) \* P(A~4~):

```{r}
Prob_A3*Prob_A4
Prob_A3_A4
```

Dado a que P(A~3~ ∩ A~4~) = P(A~3~) \* P(A~4~) no son iguales podemos concluir que son eventos dependiente.

#### 4.2.2.2. Verificar P(A~3~/A~4~) = P(A~3~):

A continuación, verificaremos la siguiente fórmula: P(A~3~/A~4~) = P(A~3~). Para esto tenemos que hallar P(A~3~/A~4~). Es decir, la probabilidad de seleccionar a un estudiante que presenta un nivel de estrés mayor a 5 dado que es la probabilidad de seleccionar a un estudiante que presenta un puntaje de test mayor a 50. Casos favorables:

```{r}
DProy %>% filter(NivelEstres>3 & PuntosTest>50)
```

Casos totales:

```{r}
DProy %>% filter(PuntosTest>50)
```

Obtenemos la probabilidad de P(A~3~/A~4~)

```{r}
Prob_A3_Dado_A4 = 6/8
Prob_A3_Dado_A4
```

Verificamos la fórmula P(A~3~/A~4~) = P(A~3~)

```{r}
Prob_A3
Prob_A3_Dado_A4
```

Como P(A~3~/A~4~) no es aproximadamente P(A~3~), podemos decir que son eventos dependientes.

Luego, para comprobar la fórmula P(A~3~/A~4~) = P(A~3~ ∩ A~4~)/P(A~4~), reemplazamos algunos dados ya obtenido en la fórmula para verificarlo.

```{r}
Prob_A3_Dado_A4
Prob_A3_A4/Prob_A4
```

Como P(A~3~/A~4~) es igual P(A~3~ ∩ A~4~)/P(A~4~), podemos decir que son eventos dependientes.

#### 4.2.2.3. Verificar P(A~3~/A~4~) = P(A~3~ ∩ A~4~)/P(A~4~):

Ahora, para comprobar la fórmula de Bayes P(A~4~/A~3~) = P(A~3~/A~4~)\*P(A~4~)/P(A~3~), primero hallamos P(A~4~/A~3~) y reemplazamos algunos dados ya obtenido en la fórmula para verificarlo.

Casos favorables:

```{r}
DProy %>% filter(NivelEstres<=3 & PuntosTest<=50)
```

Casos totales:

```{r}
DProy %>% filter(NivelEstres>3)
```

Obtenemos la probabilidad de P(A~4~/A~3~):

```{r}
Prob_A4_Dado_A3 = 67/108
Prob_A4_Dado_A3
```

#### 4.2.2.4. Verificar P(A~4~/A~3~) = P(A~3~/A~4~)\*P(A~4~)/P(A~3~):

A continuación verificamos la fórmula P(A~4~/A~3~) = P(A~3~/A~4~)\*P(A~4~)/P(A~3~) reemplazando valores

```{r}
Prob_A4_Dado_A3
Prob_A3_Dado_A4*Prob_A4/Prob_A3
```

Después de analizar las fórmulas verificadas, podemos decir que los eventos A~3~ y A~4~ son dependientes.

## 4.3. Variable aleatorias Discretas

### 4.3.1. Variable 1 - PuntosTest

#### 4.3.1.1. Definir qué distribución se usará

```{r}
E1 <- data.frame(table(DProy$PuntosTest))
E1$P = E1$Freq/sum(E1$Freq)
E1
```

La variable PuntosTest tiene 61 posibles valores, $0 \cup [1,60]$. Proponemos una distribución binomial definiendo como $Exito$ el seleccionar a un estudiante que tenga como mínimo **48** puntos, lo que se considera *Alto*.

#### 4.3.1.2. Construir V.A

$$
\mathbb{X} \sim Bin(p,n)
$$

#### 4.3.1.3. Identificar parámetros

$\mathbb{X}$: \# de estudiantes que tienen 48 o más puntos en $PuntosTest$ en el conjunto DProy (181)

$$
\mathbb{X} \sim Bin(n,p) \begin{cases}
n \Rightarrow & \text{Tamaño de muestra} \\
p \Rightarrow P(Exito); & \begin{align}
&\text{Éxito es definido como seleccionar un estudiante} \\
&\text{que tenga 48 puntos o más puntos}
\end{align}
\end{cases}
$$

#### 4.3.1.4. Hallar probabilidades

```{r}
tb <- DProy[complete.cases(DProy$PuntosTest), ]
E1 <- data.frame(table(tb$PuntosTest))
E1$Var1 <- as.numeric(as.character(E1$Var1))
E1$P = E1$Freq/sum(E1$Freq)
E1

Acumulado <- sum(E1$P[E1$Var1 >= 48])
probs <- dbinom(0:173, 173, Acumulado)
plot(0:173, probs, type = "h", main = "Distribución binomial",
     xlim = c(0, 173),
     ylim = c(0, max(probs)),
     ylab = "Probabilidades",
     xlab = "n(0:181)")
```

#### 4.3.1.5. Validar propiedades

```{r}
ytotal <- sum(!is.na(DProy$PuntosTest))
print(paste0("Definimos n como ", ytotal ,", ya es el numero de estudiantes muestreados y nos permite obtener una probabilidad empirica acerca del Experimento"))

#Cantidad de observaciones
y1 <- nrow(DProy %>% filter(PuntosTest >= 48))

E1_prop <- y1/ytotal

## Probabilidad
print(paste("Probabilidad de estrés alto (>=48) =",E1_prop))

error_estandar <- sqrt(E1_prop * (1 - E1_prop) / ytotal)
valor_critico <- qnorm(0.975) 
margen_error <- valor_critico * error_estandar

limite_superior <- E1_prop + margen_error
limite_inferior <- E1_prop - margen_error

barplot(c(E1_prop),ylim = c(0, 1), names.arg = c("Estrés alto (>=48)"), main = "Intervalo de confianza de la estimación 
de la proporción de Estrés alto",
        xlab = "Categoría", ylab = "Proporción")
arrows(1, limite_inferior, 1, limite_superior, angle = 90, code = 3, length = 0.1)
```

#### 4.3.1.6. Ejemplo

**Teniendo 30 estudiantes, ¿cuál es la probabilidad que por lo menos 5 de ellos tengan un nivel de estrés alto (\>=48)?**

```{r}
k = 5
n = 30
p <- Acumulado
result <- pbinom(k,n,p, lower.tail = FALSE)
print(paste("La probabilidad es de", result))
```

### 4.3.2. Variable 2 - EnfermHeredit

#### 4.3.2.1. Definir qué distribución se usará

```{r}
table(DProy$EnfermHeredit)
```

La variable EnfermHeredit tiene 2 posibles valores, $\{Sí, No\}$. Proponemos una distribución geométrica definiendo como $Exito$ el seleccionar a un estudiante que SÍ tenga una enfermedad hereditaria, esto para fines de estudio de la diferencia de niveles de estrés en estas personas contra las demás.

#### 4.3.2.2. Construir V.A

$$
\mathbb{X} \sim Geom(n,p)
$$

#### 4.3.2.3. Identificar parámetros

$\mathbb{X}$: \# de intentos hasta hallar a una persona que presente una $EnfermHeredit$ en el conjunto DProy (181)

$$
\mathbb{X} \sim Geom(n,p) \begin{cases}
n \Rightarrow & \text{tamaño de muestra} \\
p \Rightarrow P(\text{Endermedad hereditaria}); & \begin{align}
&\text{éxito es definido como seleccionar un estudiante} \\
&\text{que padece una enf. hereditaria}
\end{align}
\end{cases}
$$

#### 4.3.2.4. Hallar probabilidades

```{r}
E2 <- data.frame(table(DProy$EnfermHeredit))
E2$P = E2$Freq/sum(E2$Freq)
Prob_E2 <- E2$P[2]
E2

probs <- dgeom(0:181, Prob_E2)
plot(0:181, probs, type = "h", main = "Distribución geométrica",
     xlim = c(0,100),
     ylab = "Probabilidades",
     xlab = "n(0:181)")

```

#### 4.3.1.5. Validar propiedades

```{r}
suma_probabilidades_geom <- sum(E2$P)
print(paste("Suma de probabilidades:", suma_probabilidades_geom))

valor_esperado_geom <- 1 / Prob_E2
print(paste("Esperanza teórica:", valor_esperado_geom))

desviacion_estandar_geom <- sqrt((1 - Prob_E2) / (Prob_E2^2))
print(paste("Desviacion estándar:", desviacion_estandar_geom))

coeficiente_variacion_geom <- (desviacion_estandar_geom / valor_esperado_geom) * 100
print(paste("Coeficiente de variación:", coeficiente_variacion_geom))

varianza <- (1 - Prob_E2) / Prob_E2^2
print(paste("varianza: ",varianza))
```

#### 4.3.1.6. Ejemplo

Probabilidad de encuestar a 20 estudiantes o menos para encontrar a alguien que padece alguna enfermedad hereditaria.

```{r}
probabilidadEG <- pgeom(20, E1$P[2], lower.tail = TRUE)
print(paste("La probabilidad es de", probabilidadEG))
```

## 4.4. Variable aleatorias continuas

### 4.4.1. Variable 1 - Peso

#### 4.4.1.1 Identificar gráficamente

```{r}
plot(density(DProy$Peso, na.rm = TRUE),
     main = "Funcion de densidad de Peso",
     xlab = "Peso (kg)",
     ylab = "Densidad",
     col = "blue")
```

Vemos que el gráfico se asemeja a una distribución normal para 20 \< x \< 100

```{r}
rango <- c(20, 100)  # Define el rango de interés

datos_rango <- DProy$Peso[DProy$Peso >= 20 & DProy$Peso <= 100 & !is.na(DProy$Peso)]

#Densidad de datos obtenidos
plot(density(datos_rango), main = "Función de densidad { 20 <= x <= 100}",
     xlab = "Peso (kg)", ylab = "Densidad", col = "red")

x <- seq(20, 100, 1)

#Datos necesarios:
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

#Densidad de distribución normal
plot(dnorm(x, mean = media, sd = desviacion), main = "Función de densidad Distribucion normal{ 20 <= x <= 100}",
     xlab = "Peso (kg)", ylab = "Densidad", col = "red", type = "l")
```

#### 4.4.1.2. Validamos

```{r}
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

longitud <- length(datos_rango)
tabla_frecuencias <- table(datos_rango)
probabilidades <- tabla_frecuencias / longitud

suma_cuadrados <- sum((datos_rango - media)^2)
varianza <- suma_cuadrados / (length(datos_rango) - 1)

print(paste("Media =", media, "| Mediana =", median(datos_rango)))
print(paste("Varianza =", varianza, "| sd^2 =", desviacion^2))


#Función de distribución de probabilidad de la distribución Normal
plot(x, pnorm(x, mean = media, sd = desviacion), type= "l", col = "red", main = "Función de Distribución de Probabilidad",
      xlab = "Peso (kg)",
      ylab = "Probabilidad")
```

#### 4.4.1.3. Ejemplo

¿Cuál es la probabilidad de que el `Peso` del encuestado sea mayor a 80kg?

```{r}
probabilidad <- pnorm(80, mean = media, sd = desviacion, lower.tail = FALSE)
print(paste("Probabilidad de P(x > 80):", probabilidad))
```

### 4.4.2. Variable 2 - Estatura

#### 4.4.2.1. Identificar gráficamente

```{r}
plot(density(DProy$Estatura, na.rm = TRUE),
     main = "Funcion de densidad de Estatura",
     xlab = "Estatura (m)",
     ylab = "Densidad",
     col = "blue")
```

Vemos que el gráfico se asemeja a una distribución normal para 1.4 \< x \< 2.0

```{r}
rango <- c(1.4, 2.0)  # Define el rango de interés

datos_rango <- DProy$Estatura[DProy$Estatura >= 1.4 & DProy$Estatura <= 2 & !is.na(DProy$Estatura)]

#Densidad de datos obtenidos
plot(density(datos_rango), main = "Función de densidad { 1.4 <= x <= 2.0}",
     xlab = "Estatura (m)", ylab = "Densidad", col = "red")

x <- seq(1.4, 2.0, 0.01)

#Datos necesarios:
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

#Densidad de distribución normal
plot(dnorm(x, mean = media, sd = desviacion), main = "Función de densidad Distribucion normal{ 1.4 <= x <= 2.0}",
     xlab = "Estatura (m)", ylab = "Densidad", col = "red", type = "l")
```

#### 4.4.2.2. Validamos

```{r}
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

longitud <- length(datos_rango)
tabla_frecuencias <- table(datos_rango)
probabilidades <- tabla_frecuencias / longitud

suma_cuadrados <- sum((datos_rango - media)^2)
varianza <- suma_cuadrados / (length(datos_rango) - 1)

print(paste("Media =", media, "| Mediana =", median(datos_rango)))
print(paste("Varianza =", varianza, "| sd^2 =", desviacion^2))

#Función de distribución de probabilidad de la distribución Normal
plot(x, pnorm(x, mean = media, sd = desviacion), type= "l", col = "red", main = "Función de Distribución de Probabilidad",
      xlab = "Estatura (m)",
      ylab = "Probabilidad")
```

#### 4.4.2.3. Ejemplo

¿Cuál es la probabilidad de que el `Estatura` del encuestado sea mayor a 1.8m?

```{r}
probabilidad <- pnorm(1.8, mean = media, sd = desviacion, lower.tail = FALSE)
print(paste("Probabilidad de P(x > 1.8):", probabilidad))
```

# 5. Conclusiones

-   Pudimos observar que una cantidad reducida de estudiantes presentan altos niveles de estrés, mayor a 48 puntos en el test, teniendo en su mayoría un nivel de estrés moderado.

-   Se observó que el nivel de estrés de los estudiantes está relacionado a la exigencia académica que estos presentan.

-   Una gran parte de los estudiantes muestran estar estresados y enfermarse más debido a la locación de la universidad.

-   El estudio de probabilidades nos permiten comprender mejor la incidencia de ciertas condiciones o características dentro de la población estudiantil. Podemos inferir que tanto las enfermedades hereditarias como los niveles de estrés alto son aspectos relevantes a considerar en el ámbito estudiantil.
