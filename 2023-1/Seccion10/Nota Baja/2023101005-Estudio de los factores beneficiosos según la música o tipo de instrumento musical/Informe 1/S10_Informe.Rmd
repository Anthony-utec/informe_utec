---
title: "S10_ Estudio de los factores en el rendimiento, calidad de vida y salud mental del estudiante UTEC en el ciclo 2023-I según la música o tipo de instrumento musical de preferencia"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

```{r, include = FALSE}
if(!require(readr)){install.packages('readr')}
if(!require(knitr)){install.packages('knitr')}
if(!require(plyr)){install.packages('plyr')}
if(!require(dplyr)){install.packages('dplyr')}
if(!require(graphics)){install.packages('graphics')}
if(!require(ggplot2)){install.packages('ggplot2')}
if(!require(plotrix)){install.packages('plotrix')}
```

```{r, echo=FALSE}
library(readr)
library(knitr)
library(plyr)
library(dplyr)
library(graphics)
library(ggplot2)
library(plotrix)
```

<br> <br>


# **INTRODUCCIÓN**

## **Relevancia y objetivos:**

-   Comparar y analizar el impacto que genera el conocimiento de un tipo de instrumento musical o el tipo de música que escuchan en el aprendizaje universitario de los estudiantes UTEC que están cursando el periodo 2023-I.

-   Identificar si el aprendizaje de instrumentos musicales mejora la calidad de vida, los niveles de estrés y la salud mental del estudiante.

-   Animar y motivar el aprendizaje de un instrumento musical en el estudiante. De esta manera estaríamos impulsando aún más la educación musical en la universidad.

## **Planificación:**

Nuestra planificación para la PG1-avance1 y PG1-avance2 se basó en dividir en la creación del forms y la presentación en R. Una parte del grupo ideó las preguntas según nuestras variables encontradas y la otra parte se encarga de programar la presentación en R. Asimismo, uno se encarga de realizar la introducción y los datos , y para la PG1-avance3 la otra persona realizará el análisis descriptivo cuando los datos sean recolectados. Esto se decidió porque no todos poseemos el mismo dominio de este lenguaje de programación y siempre es bueno optimizar el tiempo a nuestro favor. 

El informe ha sido realizado en un plazo de 4 días entre el martes 30/05/2023 y el viernes 02/06/2023. No ha sido tan tedioso ya que poseemos todos lo avances en Rmarkdown presentation y solo tuvimos que pasarlo a Rnotebook.

# **DATOS**

## Recolección de datos

-   La recolección de los datos se realizará mediante un formulario-encuesta en google forms, todo se guardará en nuestro archivo csv llamado DATA_BASE_EyP_PG5.csv. Estará divido en 3 tablas: Aquellos que tocan instrumentos, aquellos que no y los datos de entrada.

## Población, Muestra Y Muestreo

-   Nuestra población a estudiar es la población UTEC. La muestra estará formada por 150 observaciones limpias, tuplas o unidades muestrales (que vienen a ser los estudiantes UTEC) , 5 variables en la primera tabla , 12 en la segunda y 11 en la tercera, son las características para obtener nuestra información.

-   Luego de haber realizado las encuestas y haber obtenido la data necesaria, procederemos a limpiar la data de las unidades muestrales que manchen y dañen nuestra base de datos.

-   Nuestro muestreo será aplicado al muestreo aleatorio simple. Se hará uso de un generador de números aleatorios de cada uno de los pisos recreativos que hay en la UTEC (son tres, el piso 1, piso 6 y piso 11). Así todos los alumnos que se encuentren disponibles en cada piso tendrán la misma probabilidad de formar parte de nuestra muestra.

## TABLA DE VARIABLES

### DATOS DE ENTRADA:

| PREGUNTA                               | Nombre de variable | Tipo de variable   | Restricciones           |
|-------------------|------------------|------------------|------------------|
| ¿Cuál es tu edad?                      | edad               | Numérica Discreta  | Entero positivo.        |
| ¿Cuál es tu género?                    | sexo               | Categórica Nominal | Hombre o mujer.         |
| ¿Qué carrera estás estudiando en UTEC? | carrera            | Categórica Nominal | Carrera que estudia.    |
| ¿Qué ciclo estás cursando?             | ciclo              | Numérica Discreta  | 1-10 , primer a décimo. |
| ¿Tocas algún instrumento musical?      | tocan_instrumento  | Categórica Nominal | Sí o No.                |

### TOCAN INSTRUMENTOS:

| PREGUNTA                                                                                           | Nombre de variable    | Tipo de variable    | Restricciones                                   |
|-------------------|------------------|------------------|------------------|
| ¿Qué tipo de instrumentos tocas?                                                                   | tipo_instrumento      | Categórica Nominal  | Opciones.                                       |
| ¿Cuántas horas a la semana dedicas a estudiar tus cursos en UTEC? (fuera del tiempo académico)     | horas_estudio         | Numérica Discreta   | Entero positivo.                                |
| ¿Cuánto tiempo a la semana dedicas a practicar tu instrumento musical?                             | horas_instrumento     | Numérica Discreta   | Entero positivo.                                |
| ¿Cómo calificarías tu nivel de habilidad para tocar tu instrumento musical?                        | habilidad             | Numérica Discreta   | Muy poco habilidoso - Muy habilidoso (1-5)          |
| ¿Qué tan importante crees que es la música en tu vida?                                             | importancia           | Numérica Discreta   | Muy poco habilidoso - Muy habilidoso (1-5)          |
| ¿Has tocado algún instrumento musical en alguna presentación en vivo o en un grupo musical?        | tocar_en_vivo?        | Categórica Nominal  | Sí o No.                                        |
| ¿Cómo te sientes cuando estás tocando tu instrumento musical?                                      | sentimiento           | Categórica Nominal  | Desde indiferente hasta distintas emociones(5)  |
| ¿De qué manera un instrumento musical te ha ayudado en tu desempeño académico?                     | desempeño_academico   | Categórica Ordinal. | Desde nada importante hasta muy benificioso (1-5) |
| ¿Qué tan importante crees que es tocar un instrumento musical para mejorar tu desempeño académico? | salud_mental          | Categórica Ordinal. | Desde nada importante hasta muy benificioso (1-5) |
| ¿Cuál es el instrumento musical que dominas?                                                       | instrumento_dominante | Categórica Nominal. | Escribir.                                       |
| ¿Cuánto tiempo llevas tocando ese instrumento musical?                                             | tiempo_tocando        | Numérica Discreta   | Entero positivo.                                |
| ¿Qué beneficios crees que tiene el tocar un instrumento musical en tu vida?                        | beneficios            | Categórica Nominal  | Opciones.                                       |

### NO TOCAN INSTRUMENTOS:

| PREGUNTA                                                                                       | Nombre de variable | Tipo de variable    | Restricciones                                   |
|-------------------|------------------|------------------|------------------|
| ¿Qué tipo de música sueles escuchar con más frecuencia?                                        | tipo_musica        | Categórica Nominal  | Opciones.                                       |
| ¿Cuántas horas a la semana dedicas a estudiar tus cursos en UTEC? (fuera del tiempo académico) | horas_estudio      | Numérica Discreta   | Entero positivo.                                |
| ¿Cuántas horas al día sueles escuchar música?                                                  | horas_musica       | Numérica Continua   | Real positivo.                                  |
| ¿Qué tan importante crees que es la música en tu vida?                                         | importancia        | Numérica Discreta   | Del 1 al 5.                                     |
| ¿Cuál es tu género de música favorito para relajarte?                                          | genero_relajacion  | Categórica Nominal  | Opciones.                                       |
| ¿Cuál es tu género de música favorito para motivarte?                                          | genero_motivacion  | Categórica Nominal  | Opciones.                                       |
| ¿Cómo calificarías tu nivel de concentración cuando escuchas música?                           | concentracion      | Numérica Discreta   | 1 al 5.                                         |
| ¿Crees que el tipo de música que escuchas afecta tu estado de ánimo?                           | animo              | Categórica Nominal. | Sí o No.                                        |
| ¿Crees que el escuchar música te ayuda a reducir el estrés?                                    | estres             | Categórica Nominal. | Sí o No.                                        |
| ¿En qué momento(s) del día sueles escuchar música?                                             | momentos           | Categórica Nominal. | Escribir.                                       |
| ¿Qué beneficios crees que tiene el escuchar música en tu vida?                                 | beneficios         | Categórica Ordinal  | Desde nada importante hasta muy benificioso (5) |

## Limpieza de los datos

```{r, include = FALSE}
#DATOS DE ENTRADA
DATOS <- read_csv("DATA_BASE_EyP_G5 - DATOS_ENTRADA.csv")
#TOCAN INSTRUMENTOS
DATOS_TOCAN <- read_csv("DATA_BASE_EyP_G5 - TOCAN_INSTRUMENTOS.csv")
#NO TOCAN INSTRUMENTOS
DATOS_NO_TOCAN <- read_csv("DATA_BASE_EyP_G5 - NO_TOCAN_INSTRUMENTOS.csv")
```


Veamos los nombres de nuestros datos
```{r}
names(DATOS)
names(DATOS_TOCAN)
names(DATOS_NO_TOCAN)
```

Primero corregiremos los tipos de algunas variables que han sido registradas de forma errónea.

La primera tabla (**Datos de entrada**) y la tercera tabla (**No tocan instrumentos**) tienen sus tipos de variable de forma correcta. Por otro lado, la segunda tabla (**Tocan instrumentos**) tiene sus tipo de variable de forma incorrecta. Corregiremos las variables *horas_instrumento* y *tiempo_tocando:* representan las **horas que un alumno de UTEC practica su instrumento musical** y **cuánto tiempo lleva tocando ese instrumento musical**, respectivamente.

Antes de ello, debemos verificar cual fue el o los datos que ocasionaron que esas dos variables hayan sido reconocidas de manera errónea por rstudio. 

```{r, eval = FALSE}
table(DATOS_TOCAN$horas_instrumento)
table(DATOS_TOCAN$tiempo_tocando)
```

Procederemos a corregir el **1h** por 1 y el **desde mi niñez** por 10 años (ya que la edad promedio de nuestra muestra es 19 - 20 años aproximadamente). Teniendo en cuenta que la mayoría de encuestados oscilan en una edad entre 16 a 23, y sabiendo que la moda es 18 años. Tomaré en cuenta acerca de la niñez como 10 años tocando ese instrumento.

```{r}
table(DATOS$edad)
mean(DATOS$edad, na.rm=T)
```
BORRAMOS EL h del 1h
```{r}
DATOS_TOCAN$horas_instrumento=gsub("h","",DATOS_TOCAN$horas_instrumento)
```

Ahora solo usamos la librería dplyr para convertir de character a numeric.
```{r}
DATOS_TOCAN <- DATOS_TOCAN %>%
  mutate(horas_instrumento = as.numeric(horas_instrumento))
```

Reemplazaremos "desde mi niñez" por 10.

```{r}
DATOS_TOCAN$tiempo_tocando <- ifelse(DATOS_TOCAN$tiempo_tocando == "desde mi niñez",10,DATOS_TOCAN$tiempo_tocando)
DATOS_TOCAN <- DATOS_TOCAN %>%
  mutate(tiempo_tocando = as.numeric(tiempo_tocando))
```

### Otras variables

La variable *horas_estudio* tiene un dato que es 82 horas a la semana(lo cual es ilógico), y será reemplazado por NA. Y hay una tupla el cual colocó un dato nulo (0) en la variable *tiempo_tocando*, el cual se puede interpretar como alguien que aún no llega al año como practicante de un instrumento musical, la verdadera variable que me preocupa de esta tupla es *instrumento_dominante* el cual asignó como ninguno o cualquiera que no haya respondido a lo que se le asignó, este dato será cambiado a **NA**.

#### Horas de estudio dedicadas por aquellos que tocan instrumentos.
```{r}
table(DATOS_TOCAN$horas_estudio)
table(DATOS_TOCAN$horas_estudio>50, useNA="always")
```

```{r}
DATOS_TOCAN <- DATOS_TOCAN %>%
  mutate(horas_estudio = if_else(horas_estudio > 50, NA_real_, horas_estudio))
```

### Correción de nombres de datos

#### Tabla: TOCAN INSTRUMENTOS

##### Instrumento dominante

```{r, eval = FALSE}
table(DATOS_TOCAN$instrumento_dominante)
```

```{r}
DATOS_TOCAN$instrumento_dominante <- ifelse(DATOS_TOCAN$instrumento_dominante == "Ninguno",NA,DATOS_TOCAN$instrumento_dominante)
DATOS_TOCAN$instrumento_dominante <- ifelse(DATOS_TOCAN$instrumento_dominante == "No domino, pero si practico tocar la guitarra.","Guitarra",DATOS_TOCAN$instrumento_dominante)

DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="guitarra"] <- "Guitarra"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Guitarra clásica"] <- "Guitarra"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Guitarrra"] <- "Guitarra"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="guitarra electrica"] <- "Guitarra"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Guitarra/piano"] <- "Guitarra"

DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Ukulele"] <- "Ukelele"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Bateria"] <- "Batería"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Flauta dulce"] <- "Flauta"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Clarinete soprano y clarinete bajo"] <- "Clarinete"

DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="órgano eléctrico"] <- "Piano"

DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="saxofón"] <- "Saxofón"
DATOS_TOCAN$instrumento_dominante[DATOS_TOCAN$instrumento_dominante=="Saxofon tenor"] <- "Saxofón"

DATOS_TOCAN$instrumento_dominante <- ifelse(DATOS_TOCAN$instrumento_dominante == "0", NA,DATOS_TOCAN$instrumento_dominante)
```

##### Beneficios

```{r}
DATOS_TOCAN$beneficios <- ifelse(DATOS_TOCAN$beneficios == "0", NA,DATOS_NO_TOCAN$beneficios)
```

##### Tipo de instrumento

```{r}
DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de viento(flauta, saxofón, trompeta, clarinete, etc)","Instrumento de viento",DATOS_TOCAN$tipo_instrumento)

DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de cuerda(guitarra, bajo, piano , ukulele, charango, violin, arpa, etc)","Instrumento de cuerda",DATOS_TOCAN$tipo_instrumento)

DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de percusión(cajón, xilófono, batería, maracas, etc)","Instrumento de percusión",DATOS_TOCAN$tipo_instrumento)



DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de viento(flauta, saxofón, trompeta, clarinete, etc), Instrumento de cuerda(guitarra, bajo, piano , ukulele, charango, violin, arpa, etc)","Instrumento de viento, Instrumento de cuerda",DATOS_TOCAN$tipo_instrumento)

DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de viento(flauta, saxofón, trompeta, clarinete, etc), Instrumento de cuerda(guitarra, bajo, piano , ukulele, charango, violin, arpa, etc), Instrumento de percusión(cajón, xilófono, batería, maracas, etc)","Instrumento de viento, Instrumento de cuerda, Instrumento de percusión",DATOS_TOCAN$tipo_instrumento)

DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de cuerda(guitarra, bajo, piano , ukulele, charango, violin, arpa, etc), Voz","Instrumento de cuerda, Voz",DATOS_TOCAN$tipo_instrumento)

DATOS_TOCAN$tipo_instrumento <- ifelse(DATOS_TOCAN$tipo_instrumento == "Instrumento de viento(flauta, saxofón, trompeta, clarinete, etc), Voz","Instrumento de viento, Voz",DATOS_TOCAN$tipo_instrumento)
```

Ahora cambiaremos a un solo tipo de instrumento según el instrumento dominante que posean.

```{r}
DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de percusión" & instrumento_dominante == "Cajón" ,"Instrumento de percusión",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de cuerda, Voz" & instrumento_dominante == "Piano" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de cuerda, Instrumento de percusión" & instrumento_dominante == "Guitarra/Piano" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de cuerda, Voz" & instrumento_dominante == "Viola" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Guitarra" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de cuerda, Voz" & instrumento_dominante == "Voz" ,"Voz",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Zampoña" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Saxofón" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Flauta" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda, Instrumento de percusión" & instrumento_dominante == "Flauta" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de cuerda, Voz" & instrumento_dominante == "Guitarra" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Voz" & instrumento_dominante == "Saxofón" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Guitarra" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda" & instrumento_dominante == "Ukelele" ,"Instrumento de cuerda",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Voz" & instrumento_dominante == "Flauta" ,"Instrumento de viento",tipo_instrumento))

DATOS_TOCAN <- DATOS_TOCAN %>% mutate(tipo_instrumento = if_else(tipo_instrumento == "Instrumento de viento, Instrumento de cuerda, Voz" & instrumento_dominante == "Zampoña","Instrumento de viento",tipo_instrumento))
```


#### Tabla: NO TOCAN INSTRUMENTOS

Solamente hay una variable con 2 respuestas las cuales no siguieron a la pregunta, en la variable *momentos.* Realizando el respectivo análisis, entendieron la pregunta como la hora a la que usualmente escuchan la música, sus respuesta 3 y 12 podrían referirse tanto a 12 am o 12pm y en el otro caso 3 am o 3pm. Es cierto que nada nos garatinza a si se refiere am o pm. En este caso consulté a ellos porque tuve la oportunidad de ver como hicieron su encuesta, por lo que me mencionaron que escuchaban a partir de esas horas (12pm y 3pm, respectivamente). Por lo que se a decidido

Recordar que la variable es categórica por lo que el 3 y 12 deben ir con comillas

##### Momentos

```{r}
DATOS_NO_TOCAN$momentos <- ifelse(DATOS_NO_TOCAN$momentos == "3" | DATOS_NO_TOCAN$momentos == "12","Por las tardes",DATOS_NO_TOCAN$momentos)
```

##### Tipo de música

```{r}
DATOS_NO_TOCAN$tipo_musica[DATOS_NO_TOCAN$tipo_musica=="BTS"] <- "K-POP"
DATOS_NO_TOCAN$tipo_musica[DATOS_NO_TOCAN$tipo_musica=="Rock indie"] <- "Rock and Roll"
DATOS_NO_TOCAN$tipo_musica[DATOS_NO_TOCAN$tipo_musica=="Rock y metal"] <- "Rock and Roll"
DATOS_NO_TOCAN$tipo_musica[DATOS_NO_TOCAN$tipo_musica=="Dembow"] <- "Reggaeton"
```

##### Género favorito para relajarse

```{r}
DATOS_NO_TOCAN$genero_relajacion[DATOS_NO_TOCAN$genero_relajacion=="balada"] <- "Baladas"
DATOS_NO_TOCAN$genero_relajacion[DATOS_NO_TOCAN$genero_relajacion=="BTS"] <- "K-POP"
DATOS_NO_TOCAN$genero_relajacion[DATOS_NO_TOCAN$genero_relajacion=="Varias musica no sólo uno"] <- "Rock and Roll"
DATOS_NO_TOCAN$genero_relajacion[DATOS_NO_TOCAN$genero_relajacion=="Varias musicas"] <- "Rock and Roll"
```

##### Género favorito para motivarse

```{r}
DATOS_NO_TOCAN$genero_motivacion[DATOS_NO_TOCAN$genero_motivacion=="BTS"] <- "K-POP"
DATOS_NO_TOCAN$genero_motivacion[DATOS_NO_TOCAN$genero_motivacion=="Rock y metal"] <- "Rock and Roll"
DATOS_NO_TOCAN$genero_motivacion[DATOS_NO_TOCAN$genero_motivacion=="soundtracks  hans zimmer"] <- "Orquesta sinfónica"
```

## VERIFIQUEMOS LOS DATOS LIMPIOES

-   DATOS DE ENTRADA LIMPIOS

-   DATOS DE LA TABLA TOCAN INSTRUMENTOS LIMPIOS

-   DATOS DE LA TABLA NO TOCAN INSTRUMENTOS LIMPIOS

```{r}
sum(complete.cases(DATOS))
sum(complete.cases(DATOS_TOCAN))
sum(complete.cases(DATOS_NO_TOCAN))
```


# ANÁLISIS DE DESCIPTORES

## DESCRIPTORES NUMÉRICOS Y GRÁFICOS - TOCAN INSTRUMENTOS

Analizemos la tabla TOCAN INSTRUMENTOS y veamos que variables son numéricas y obtener información con el comando summary().

```{r}
summary(DATOS_TOCAN)
```

### Descriptores numéricos: 

#### **Horas de estudio a la semana de aquellos que tocan instrumentos**

```{r}
range(DATOS_TOCAN$horas_estudio, na.rm = T) #tango
round((sd(DATOS_TOCAN$horas_estudio, na.rm=T)/mean(DATOS_TOCAN$horas_estudio, na.rm = T)) * 100,2) #coeficiente de variación
round(sd(DATOS_TOCAN$horas_estudio, na.rm = TRUE),2) #desviación estándar
moda <- as.numeric(names(table(DATOS_TOCAN$horas_estudio)[table(DATOS_TOCAN$horas_estudio) == max(table(DATOS_TOCAN$horas_estudio), na.rm = TRUE)]))
moda # MODA
DATOS_TOCAN %>% summarise_at('horas_estudio', funs(mean,median,sd,min,max,IQR),na.rm=T)
boxplot(DATOS_TOCAN$horas_estudio, main="Horas de estudio de los estudiantes UTEC que son músicos", col="pink", medlty=2, medlwd=2, medpch=20, medcex = 3, horizontal = TRUE)
```

-   Horas de estudio **mínima** : 2 horas a la semana.

-   Horas de estudio **máxima** : 42 horas a la semana.

-   Horas de estudio **promedio** : 12 horas y 30 minutos a la semana. (12.50)

-   **Rango :** El rango está entre 2 y 42.

-   **Moda :** La mayoría de personas estudia **8 horas a la semana**.

-   **Desviación estándar :** Es de 10.32 horas a la semana.

-   **Coeficiente de variación :** Es del 82.54 %.

-   **Primer cuartil** : 6 horas a la semana. [**Máximo número de horas de estudio del 25% de las menores horas de estudio**]

-   Segundo cuartil [**Mediana**] : 8 horas a la semana.

-   **Tercer cuartil** : 14 horas y 15 minutos a la semana. (14.25) [**MÍnimo número de horas de estudio del 25% de las mayores horas de estudio**]

-   **Rango intercuartil :** Por lo menos el 50% de los datos está aquí, en un rango de 8.25 horas.

Es apreciable que el promedio es mayor que la mediana (12 \> 8). Esto quiere decir que hay un sesgo hacia la derecha. 

#### **Horas ocupadas para tocar instrumento a la semana**

```{r}
range(DATOS_TOCAN$horas_instrumento) #rango
round((sd(DATOS_TOCAN$horas_instrumento, na.rm = TRUE)/mean(DATOS_TOCAN$horas_instrumento))*100,2) #coeficiente de variación
round(sd(DATOS_TOCAN$horas_instrumento, na.rm = TRUE),2) #desviación estándar
#####var(TOCAN$horas_estudio, na.rm = TRUE) #variación
moda <- as.numeric(names(table(DATOS_TOCAN$horas_instrumento)[table(DATOS_TOCAN$horas_instrumento) == max(table(DATOS_TOCAN$horas_instrumento), na.rm = TRUE)]))
moda # MODA
DATOS_TOCAN %>% summarise_at('horas_instrumento', funs(mean,median,sd,min,max,IQR),na.rm=T)
boxplot(DATOS_TOCAN$horas_instrumento, col="cyan", medlty=2, medlwd=2, medpch=20, medcex = 3, horizontal = TRUE)
```

-   Horas de estudio **mínima** : 0 horas a la semana. **[No llega a la hora a la semana]**

-   Horas de estudio **máxima** : 14 horas a la semana.

-   Horas de estudio **promedio** : 2.72 horas a la semana. (2.72)

-   **Rango :** El rango es de 14.

-   **Moda :** La mayoría de personas toca **1 hora a la semana**.

-   **Desviación estándar :** Es de 2.62 horas a la semana.

-   **Coeficiente de variación :** Es del 96.18 %.

-   **Primer cuartil** : 1 hora a la semana. [**Máximo número de horas tocando un instrumento del 25% de las menores número de horas tocando un instrumento**]

-   Segundo cuartil [**Mediana**] : 2 horas a la semana.

-   **Tercer cuartil** : 4 horas a la semana. [**MÍnimo número de horas tocando un instrumento del 25% de las mayores número horas tocando un instrumento**]

-   **Rango intercuartil :** Por lo menos el 50% de los datos está aquí, en un rango de 3 horas.

Es apreciable que el promedio es ligeramento mayor que la mediana (2.72 \> 2). Esto quiere decir que hay un ligero sesgo hacia la derecha. (**sesgo positivo mínimo**)

#### Habilidad para tocar un tipo de instrumento

```{r}
range(DATOS_TOCAN$habilidad) #rango
round((sd(DATOS_TOCAN$habilidad, na.rm = TRUE)/mean(DATOS_TOCAN$habilidad))*100,2) #coeficiente de variación
round(sd(DATOS_TOCAN$habilidad, na.rm = TRUE),2) #desviación estándar
#####var(TOCAN$horas_estudio, na.rm = TRUE) #variación
moda <- as.numeric(names(table(DATOS_TOCAN$habilidad)[table(DATOS_TOCAN$habilidad) == max(table(DATOS_TOCAN$habilidad), na.rm = TRUE)]))
moda # MODA
DATOS_TOCAN %>% summarise_at('habilidad', funs(mean,median,sd,min,max,IQR),na.rm=T)
barplot(table(DATOS_TOCAN$habilidad), main = "Fecuencia de habilidad al tocar un instrumento", xlab = "Nivel de habilidad", ylab = "Frecuencia", col=c("yellow","magenta","cyan","grey","brown"))
```
Es apreciable que el promedio es ligeramento mayor que la mediana (3.03 \> 3). Esto quiere decir que hay un ligero sesgo hacia la derecha. (**sesgo positivo muy mínimo**)

#### Importancia de la música para aquellos que tocan instrumentos


```{r}
range(DATOS_TOCAN$importancia) #rango
round((sd(DATOS_TOCAN$importancia, na.rm = TRUE)/mean(DATOS_TOCAN$importancia))*100,2) #coeficiente de variación
round(sd(DATOS_TOCAN$importancia, na.rm = TRUE),2) #desviación estándar
#####var(TOCAN$horas_estudio, na.rm = TRUE) #variación
moda <- as.numeric(names(table(DATOS_TOCAN$importancia)[table(DATOS_TOCAN$importancia) == max(table(DATOS_TOCAN$importancia), na.rm = TRUE)]))
moda # MODA
DATOS_TOCAN %>% summarise_at('importancia', funs(mean,median,sd,min,max,IQR),na.rm=T)
barplot(table(DATOS_TOCAN$importancia), main = "Fecuencia de importancia de la música en la vida de un músico", xlab = "Importancia", ylab = "Frecuencia", col=c("yellow","magenta","cyan","grey","brown"))
```
Es apreciable que el promedio es ligeramento mayor que la mediana (4.11 \> 4). Esto quiere decir que hay un ligero sesgo hacia la derecha. (**sesgo positivo muy mínimo**)

#### Tiempo tocando instrumentos musicales

```{r}
range(DATOS_TOCAN$tiempo_tocando) #rango
round((sd(DATOS_TOCAN$tiempo_tocando, na.rm = TRUE)/mean(DATOS_TOCAN$tiempo_tocando))*100,2) #coeficiente de variación
round(sd(DATOS_TOCAN$tiempo_tocando, na.rm = TRUE),2) #desviación estándar
moda <- as.numeric(names(table(DATOS_TOCAN$tiempo_tocando)[table(DATOS_TOCAN$tiempo_tocando) == max(table(DATOS_TOCAN$tiempo_tocando), na.rm = TRUE)]))
moda # MODA
DATOS_TOCAN %>% summarise_at('tiempo_tocando',
                             funs(mean,median,sd,min,max,IQR),na.rm=T)
boxplot(DATOS_TOCAN$tiempo_tocando, col="yellow", medlty=2, medlwd=2, medpch=20, medcex = 3, horizontal = TRUE)
```
Es apreciable que el promedio es ligeramento mayor que la mediana (3.65 \> 3). Esto quiere decir que hay un ligero sesgo hacia la derecha. (**sesgo positivo mínimo**)

#### Correlación entre el tiempo tocando y que tan importante sea para aquel que toque.

HALLEMOS LA CORRELACIÓN entre el tiempo que una persona lleva tocando un tipo de instrumento musical y la importancia de la música en sus vidas.

```{r}
round(cor(DATOS_TOCAN$tiempo_tocando,DATOS_TOCAN$importancia, use = "complete.obs"),2)
```

Una correlación de 0.37 indica que existe una relación que influye de manera positiva, es decir, mientras más tiempo toques más importante lo considerarás en tu vida.

## DESCRIPTORES NUMÉRICOS Y GRÁFICOS - NO TOCAN INSTRUMENTOS

Analizemos la tabla NO TOCAN INSTRUMENTOS y veamos que variables son numéricas y obtener información con el comando summary().

```{r}
summary(DATOS_NO_TOCAN)
```

Procedamos a mostrar los descriptores numéricos de nuestras 4 variables.

### Descriptores numéricos:

```{r}
range(DATOS_NO_TOCAN$horas_estudio) #rango
round((sd(DATOS_NO_TOCAN$horas_estudio, na.rm = TRUE)/mean(DATOS_NO_TOCAN$horas_estudio))*100,2) #coeficiente de variación
round(sd(DATOS_NO_TOCAN$horas_estudio, na.rm = TRUE),2) #desviación estándar
moda <- as.numeric(names(table(DATOS_NO_TOCAN$horas_estudio)[table(DATOS_NO_TOCAN$horas_estudio) == max(table(DATOS_NO_TOCAN$horas_estudio), na.rm = TRUE)]))
moda # MODA
DATOS_NO_TOCAN %>% summarise_at('horas_estudio', funs(mean,median,sd,min,max,IQR),na.rm=T)
boxplot(DATOS_NO_TOCAN$horas_estudio, col="green", medlty=2, medlwd=2, medpch=20, medcex = 3, horizontal = TRUE)
```
Es apreciable que el promedio es mayor que la mediana (10.38 \> 8). Esto quiere decir que hay un sesgo hacia la derecha. (**sesgo positivo**)

```{r}
range(DATOS_NO_TOCAN$horas_musica) #rango
round((sd(DATOS_NO_TOCAN$horas_musica, na.rm = TRUE)/mean(DATOS_NO_TOCAN$horas_musica))*100,2) #coeficiente de variación
round(sd(DATOS_NO_TOCAN$horas_estudio, na.rm = TRUE),2) #desviación estándar
moda <- as.numeric(names(table(DATOS_NO_TOCAN$horas_musica)[table(DATOS_NO_TOCAN$horas_musica) == max(table(DATOS_NO_TOCAN$horas_musica), na.rm = TRUE)]))
moda # MODA
DATOS_NO_TOCAN %>% summarise_at('horas_musica', funs(mean,median,sd,min,max,IQR),na.rm=T)
boxplot(DATOS_NO_TOCAN$horas_musica, col="orange", medlty=2, medlwd=2, medpch=20, medcex = 3, horizontal = TRUE)
```
Es apreciable que el promedio es mayor que la mediana (4.95 \> 3). Esto quiere decir que hay un sesgo hacia la derecha. (**sesgo positivo**)

```{r}
range(DATOS_NO_TOCAN$importancia) #rango
round((sd(DATOS_NO_TOCAN$importancia, na.rm = TRUE)/mean(DATOS_NO_TOCAN$importancia))*100,2) #coeficiente de variación
round(sd(DATOS_NO_TOCAN$importancia, na.rm = TRUE),2) #desviación estándar
moda <- as.numeric(names(table(DATOS_NO_TOCAN$importancia)[table(DATOS_NO_TOCAN$importancia) == max(table(DATOS_NO_TOCAN$importancia), na.rm = TRUE)]))
moda # MODA
DATOS_NO_TOCAN %>% summarise_at('importancia', funs(mean,median,sd,min,max,IQR),na.rm=T)
barplot(table(DATOS_NO_TOCAN$importancia), main = "Fecuencia de importancia de la música en la vida de alguien que no es músico", xlab = "Importancia", ylab = "Frecuencia", col=c("yellow","magenta","cyan","grey","brown"))
```
También podemos apreciar que aquellos que tocan instrumentoss son más propensos a considerar importante la música para ellos frente aquellos que no tocan.

```{r}
range(DATOS_NO_TOCAN$concentracion) #rango
round((sd(DATOS_NO_TOCAN$concentracion, na.rm = TRUE)/mean(DATOS_NO_TOCAN$concentracion))*100,2) #coeficiente de variación
round(sd(DATOS_NO_TOCAN$concentracion, na.rm = TRUE),2) #desviación estándar
#####var(TOCAN$horas_estudio, na.rm = TRUE) #variación
moda <- as.numeric(names(table(DATOS_NO_TOCAN$concentracion)[table(DATOS_NO_TOCAN$concentracion) == max(table(DATOS_NO_TOCAN$concentracion), na.rm = TRUE)]))
moda # MODA
DATOS_NO_TOCAN %>% summarise_at('concentracion', funs(mean,median,sd,min,max,IQR),na.rm=T)
barplot(table(DATOS_NO_TOCAN$concentracion), main = "Fecuencia de concentración al escuchar música", xlab = "Concentración", ylab = "Frecuencia", col=c("yellow","magenta","cyan","grey","brown"))
```
Es apreciable que el promedio es ligeramento menor que la mediana (3.34 \< 4). Esto quiere decir que hay un ligero sesgo hacia la izquierda (**sesgo negativo mínimo**)

### Más decriptores

#### Comprobando correlación entre importancia y tiempo tocando instrumentos.

```{r}
# Definimos función de correlación
calcular_correlacion <- function(variable1, variable2) {
  # Calculamos el coeficiente de correlación
  cor <- cor(variable1, variable2,use = "complete.obs")
  print(cor)
  if (abs(cor) >= 0.7) {
    print("La relación es fuerte")
  } else if (abs(cor) >= 0.3) {
    print("La relación es moderada")
  } else {
    print("La relación es débil")
  }
}
```

```{r}
calcular_correlacion(DATOS_TOCAN$importancia, DATOS_TOCAN$tiempo_tocando)
plot(DATOS_TOCAN$importancia, DATOS_TOCAN$tiempo_tocando, xlab = "Importancia", ylab = "Tiempo tocando", main = "Gráfico de Dispersión Importancia vs Tiempo tocando")
```

## Descriptores de los datos de entrada

Primero que todo sería interesante ver qué cantidad de nuestro espacio muestral toca instrumento. Esto con la finalidad de darnos una idea, de acuerdo a nuestra muestra, qué porcentaje de personas tocan instrumento en UTEC.

```{r}
table(DATOS$tocan_instrumentos)
```

Según el table, la moda de la variable tocan_instrumentos es No. Esto signfica que más personas no tocan guitarra de acuerdo a nuestra muestra. Ahora veamos qué porcentaje del total sí tocan algún instrumento.

```{r}
round(min(table(DATOS$tocan_instrumentos))/nrow(DATOS), 2) * 100
```

Esto significa que el 42% de toda nuestra muestra sí toca algún tipo de instrumento, lo que llama muchísimo la atención. Uno esperaría que las personas que tocan sean muchísimas menos. Ahora podríamos encontrar la relación entre el sexo y saber si tocan o no instrumentos. Esto se hará mediante un mosaico para que sean visibles las proporciones.

```{r}
mosaicplot(DATOS$tocan_instrumentos ~ DATOS$sexo
           , main = "Relación de tocan instrumentos con sexo"
           , xlab = "Tocan instrumentos"
           , ylab = "Sexo"
           , color = c("lightblue", "lightgreen")
           )
```

De este mosaico se extraen algunas cosas:

La primera es que, en proporción, tenemos más hombres en nuestra muestra que mujeres. Por lo que, independientemente de si tocan o no tocan instrumento, la proporción de hombres en ambos casos es mayor.

Lo segundo es que la relación del sexo y si tocan instrumentos está invertido de acuerdo al sexo. La mayoría de mujeres no tocan instrumentos, mientras que la mayoría de los hombres sí tocan instrumentos.

#### Relación entre la salud mental y como sienten las personas que tocan instrumentos musicales

Procederemos a relacionar el sentimiento de alguien que al tocar un instrumeto musical y si esto afecta su salud mental en la tabla `TOCAN`. Tal vez podamos encontrar alguna relación directa entre estas dos. Por lo que haremos un gráfico de barras.

```{r}
table(DATOS_TOCAN$salud_mental)
```

```{r}
barplot(sort(table(DATOS_TOCAN$salud_mental))
        , main = "Instrumentos para la salud mental"
        , names.arg = c("Poco Imp", "Moder Imp", "Imp", "Muy Imp")
        , xlab = "Importancia de tocar para salud mental"
        , ylab = "Personas"
        , col=c("yellow","magenta","cyan","green")
        )
```

Como se esperaba, para las personas que tocan instrumentos es muy importante para ellos y esto afecta positivamente en su salud mental. Ahora veremos como se sienten. Con esto llegamos a la conclusión que todos aquellos que tocan instrumentos musicales mejorar su salud mental.

```{r}
table(DATOS_TOCAN$sentimiento)
```

```{r}
barplot(sort(table(DATOS_TOCAN$sentimiento))
        , main = "Sentimientos al tocar instrumentos"
        , names.arg = c("Frus/Dif", "Indif", "Emocion/Ener", "Conc/Flui", "Feliz/Relaj")
        , xlab = "Sentimientos"
        , ylab = "Personas"
        , col=c("yellow","magenta","cyan","grey","brown")
        )
```

Además sienten cosas positivas al estar tocando instrumentos. Esto es una clara prueba de que tocar instrumentos puede traer, en su mayoría, cosas positivas para nosotros los estudiantes. Ya sea como un medio de distracción de la vida ajetreada y de presión en la que se vive, y también para volver luego a los estudios con muchísimas más ganas.

```{r}
table(DATOS_TOCAN$tiempo_tocando)
```

Realizemos un gráfico de puntos para ver la relación entre la habilidad que cree tener cada uno según el tiempo que lleva tocando ese tipo de instrumento.

```{r}
# Ejemplo de gráfico de dispersión
plot(DATOS_TOCAN$habilidad, DATOS_TOCAN$tiempo_tocando, main = "Scatterplot Habilidad vs Tiempo tocando", xlab="Habilidad", ylab="Tiempo tocando en años")
```

De esto concluimos que a pesar de que algunos tocan ya muchos años no se consideran un 5 tocando ese tipo de instrumento. Por otro lado, vemos que la mayoría de personas se considera un 3, y aquellos que se puntúan con 1 y 2 llevan menos de 3 años tocando ese instrumento.

#### Relación entre el nivel de concentración al oír música y si ayuda a controlar los niveles de estrés del estudiante UTEC.

```{r}
mosaicplot(table(DATOS_NO_TOCAN$concentracion,DATOS_NO_TOCAN$estres), main="Concentración vs estrés en aquellos que no tocan instrumentos", xlab = "Concentración del 1 al 5 al oír música", ylab="¿Escuchar música te ayuda con el estrés?", color = c("lightblue", "lightgreen"))
```

Con el mosaico concluimos en que aquellos que escuchar música les concentra también ayuda a controlar su estrés, respecto a un pequeño grupo de aquellos que la música no les concentra tampoco reduce sus niveles de estrés.\\

# CONCLUSIÓN

Finalizaremos este proyecto con el último objetivo, en este estudio queda demostrado que el aprendizaje de instrumentos musicales mejora tu calidad de vida, te ayuda a concentrarte mejor, controlar tu estrés y mejora tu salud mental. Invitamos a los estudiantes UTEC a adentrarse en el mundo de la música, un hobbie sano y pacífico. Muchas gracias a todos los participantes de este estudio, tanto al grupo como a los encuestados.
