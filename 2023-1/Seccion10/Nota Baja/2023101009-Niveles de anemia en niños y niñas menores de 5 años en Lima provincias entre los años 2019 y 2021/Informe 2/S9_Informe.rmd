---
title: "PG1"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

# Título

Causas de anemia en infantes menores de 5 años en Lima Provincias durante la pandemia(2021)

# Tema:

Niveles de anemia en niños y niñas menores de 5 años en Lima provincias a lo largo de 2021.

## 1. INTRODUCCIÓN

### 1.1 Relevancia:

El nivel nutricional y alimenticio de los niños y niñas menores de 5 años, es importante debido a que la alimentación a edades tempranas tiene un rol fundamental en su desarrollo y en la prevencion de enfermedades.

### 1.2 Objetivos

#### 1.2.1 Objetivo general

Demostrar y visibilizar esta problemática que afecta a muchos niños en Lima provincias, la mayoría de ellos de recursos escasos, y concientizar sobre el numero de niños que padecen la enfermedad.

#### 1.2.2 Objetivos específicos

-   Identificar los factores de riesgo asociados a los niveles de anemia en niños y niñas menores de 5 años en Lima provincias entre el año 2021.

-   Evaluar la eficacia de los programas de prevención y tratamiento de la anemia en niños y niñas menores de 5 años en Lima provincias entre el 2021.

-   Identificar las provincias de Lima con mayor prevalencia de anemia en niños y niñas menores de 5 años a lo largo del año del 2021.

### 1.3 Contexto

Para entender el tema que se propone, solo se necesita saber que es la anemia, las afecciones que esta podría conllevar y las correlaciones que podría tener en relación al peso y el nivel de hemoglobina de los niños.

## 2. DATOS

### 2.1 Recolección de datos:

-   Después de las reuniones concretadas en grupo, decidimos trabajar con una base de datos.

-   Seleccionamos, luego de una meticulosa búsqueda de temática, nuestra base de datos de la plataforma nacional Datos abiertos, cuya administración es a cargo del gobierno.

-   Finalmente creemos que el tema elegido es contundente porque nos permitirá trabajar con una problemática real que aqueja hoy en día a un significante número de población.

### 2.2 Población:

La población del estudio son los niños menores de 5 años en Lima Provincias entre los años 2019 y 2021

### 2.3 Muestra:

Nuestra muestra contiene 21789 observaciones.

### 2.4 Muestreo:

Nuestro proyecto utiliza un muestreo del tipo estratificado ya que solo tomamos los casos ocurridos a niños menores de 5 años en Lima Provincias entre 2019 y 2021.

### 2.5 Variables:

| Variables        | Tipo de Variable                  |
|------------------|-----------------------------------|
| Diresa           | categórica nominal                |
| ProvinciaEESS    | categórica nominal                |
| DistritoEESS     | categórica nominal                |
| FechaAtencion    | numérica discreta                 |
| Sexo             | categórica nominal                |
| EdadMeses        | numérica discreta                 |
| UbigeoPN         | numérica continua                 |
| Juntos           | categórica/cualitativa dicotómica |
| SIS              | categórica/cualitativa dicotómica |
| Qaliwarma        | categórica/cualitativa dicotómica |
| Peso             | numérica continua                 |
| Talla            | numérica continua                 |
| Hemoglobina      | numérica continua                 |
| Suplementacion   | categórica/cualitativa dicotómica |
| Consejeria       | categórica/cualitativa dicotómica |
| AlturaREN        | numérica discreta                 |
| HBC              | numérica continua                 |
| Dx_Anemia        | categórica ordinal                |
| IMC              | númerica continua                |


### 2.6 Limpieza de Datos:

Antes que nada descargamos y cargamos los paquetes y librerías necesarios:

En caso no tengamos las librerias, podemos ejecutar el siguiente bloque de comandos: %install.packages('readr') install.packages('dplyr') install.packages("stringi") install.packages('ggplot2') install.packages("car")%

```{r,include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(car)
library(stringi)
library(lubridate)
library(ggthemes)
```

Cargamos la data:

```{r}
DF <- read.csv("NiñosLIMAPROVINCIAS.csv")
```

Hallamos el numero total de observaciones y variables:

```{r}
nrow(DF)
ncol(DF)
```

Luego eliminamos y seleccionamos solo las variables que usaremos y consideramos necesarias:

```{r}
DF = select(DF,Diresa,Dpto_EESS,Prov_EESS,Dist_EESS,FechaAtencion,Sexo,FechaNacimiento,EdadMeses,UbigeoPN,Juntos,SIS,Qaliwarma,Peso,Talla,Hemoglobina,Suplementacion,Consejeria,AlturaREN,HBC,Dx_Anemia)
```

Modificamos los nombres de las variables pertinentes para el proyecto:

```{r}
DF = rename(DF,Departamento = "Dpto_EESS",Distrito = "Dist_EESS", Provincia = "Prov_EESS" , DiagnosticoAnemia = "Dx_Anemia",Ubigeo = "UbigeoPN",Altura = "AlturaREN")
```

Verificamos que nuestras variables tengan los valores adecuados, para que no haya error a la hora de trabajarlos:

```{r}
unique(DF$Diresa)
```

```{r}
unique(DF$Departamento)
```

```{r}
unique(DF$Provincia)
```

```{r}
unique(DF$Distrito)
```

```{r}
unique(DF$FechaAtencion)
```

```{r}
unique(DF$Sexo)
```

```{r}
unique(DF$FechaNacimiento)
```

```{r}
unique(DF$EdadMeses)
```

```{r}
unique(DF$Ubigeo)
```

```{r}
unique(DF$Juntos)
```

```{r}
unique(DF$SIS)
```

```{r}
unique(DF$Qaliwarma)
```

```{r}
unique(DF$Peso)
```

```{r}
unique(DF$Talla)
```

```{r}
unique(DF$Hemoglobina)
```

```{r}
unique(DF$Suplementacion)
```

```{r}
unique(DF$Consejeria)
```

```{r}
unique(DF$Altura)
```

```{r}
unique(DF$HBC)
```

```{r}
unique(DF$DiagnosticoAnemia)
```

Verificamos que nuestras variables sean del tipo correcto:

```{r}
summary(DF)
```

Contamos nuestros casos completos y datos faltantes:

```{r}
sum(complete.cases(DF))
```

```{r}
sum(is.na(DF))
```

Viendo que contamos con una gran cantidad de casos incompletos procederemos a eliminarlos para trabajar solo con las observaciones completas.

```{r}
DF <- na.omit(DF)
```

Verificamos que nuestra DF no cuente con ningún caso incompleto.

```{r}
sum(complete.cases(DF))
sum(is.na(DF))
```


Modificamos nuestras variables que presentan 0 y 1 en lugar de presentar Si o no:

```{r}
DF %>% mutate(Juntos=
               ifelse(Juntos == 0,"No",
               ifelse(Juntos == 1,"Sí",Juntos))) -> DF
DF %>% mutate(SIS=
               ifelse(SIS == 0,"No",
               ifelse(SIS == 1,"Sí",SIS))) -> DF

DF %>% mutate(Qaliwarma=
               ifelse(Qaliwarma== 0,"No",
               ifelse(Qaliwarma == 1,"Sí",Qaliwarma))) -> DF
DF %>% mutate(Suplementacion=
               ifelse(Suplementacion== 0,"No",
               ifelse(Suplementacion == 1,"Sí",Suplementacion))) -> DF
DF %>% mutate(Consejeria=
               ifelse(Consejeria== 0,"No",
               ifelse(Consejeria== 1,"Sí",Consejeria))) -> DF
```

Teniendo en cuenta que nuestros nuestras variables talla y peso tienen datos en extremos atípicos, se modificaran basandonse en los estándares de tallaje y pesaje para niños de entre esas edades, según el Minsa y OMS:

```{r}
DF %>% mutate (Talla=
        ifelse(Talla > 160 ,Talla/9 ,
        ifelse (Talla<=1 ,Talla*100,
        ifelse(Talla <= 16 ,Talla *10,
        Talla )))) -> DF
DF %>% mutate (Talla=
        ifelse(Talla >=135 & EdadMeses <=22  ,Talla /2,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <=20 & EdadMeses >= 54  ,Talla*5,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <=25 & EdadMeses <=22  ,Talla+50,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla == 27 & EdadMeses == 12  ,Talla+40,Talla)) -> DF
```

```{r}
DF %>% mutate (Peso=
        ifelse(Peso >= 200 , Peso/100,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <=100 & Peso >45 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >65 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >65 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <=100 & Peso >65 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >65 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >65 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso>1  & Peso<2 ,Peso*10,
         ifelse(Peso<1 ,Peso*100,      
        Peso ))) -> DF
DF %>% mutate (Peso=
        ifelse(Peso<4 ,(Peso+1)*3,
        Peso )) -> DF
```

Ahora que contamos con la data limpia creamos una variable que va ser pertinente en el estudio, que se calculará con los valores de las variables Talla y Peso

###2.7 IMC
El IMC es **Peso/Estatura\^2**
Añadimos la variable IMC a la base de datos. Veremos su Promedio y su desviación estándar.

![](Imc.png)

```{r}
DF<- mutate(DF,IMC = Peso/((Talla)/100)^2)
```

Finalmente, consideramos que nuestra base de datos se encuentra limpia ya que, nuestras variables se encuentra bien detalladas, las únicas que presentaron valores atípicos extremos fueron modificadas bajo estándares que no permiten que nuestra base de datos pierda confiabilidad. Por otro lado eliminamos los datos faltantes y casos incompletos trabajando así con data recolectada de la fuente inicial.


## 3. ANÁLISIS :DESCRIPTIVO

En nuestro proyecto estamos usando 20 de las 38 variables que presenta nuestra base, dada su relevancia para nuestro trabajo estadístico.

**Diresa**: Esta variable nos permite saber a que Dirección Regional de Salud pertenece el menor.
**Departamento**: La variable nos brinda el departamento de donde proviene el niño.
**Provincia**: La variable nos brinda la provincia de donde proviene el niño.
**Distrito**: Lavariable nos brinda el distrito de donde proviene el niño
**FechaAtencion**: Esta variable nos brinda el día, fecha y año en el que se atendió el niño
**Sexo**: Esta variable nos indica el sexo del menor.
**FechaNacimiento**: Esta variable nos brinda la fecha en la que nacieron los niños.
**EdadMeses**: Esta variable nos permite saber la edad del niño en meses.
**Ubigeo**: Esta variable nos permite indica la ubicación geográfica del lugar en el que naciste .
**Juntos**: La variable nos brinda la información de si el niño pertenece o no al programa juntos.
**SIS**: La variable nos brinda la información de si el niño cuenta o no con el seguro integral de salud.
**Qaliwarma**: a variable nos brinda la información de si el niño pertenece o no al programa Qaliwarma.
**Peso**: Esta variable nos brinda la información respecto al peso del menor.
**Talla**: Esta variable nos brinda la información respecto a la talla del menor.
**Hemoglobina**: Esta variable nos brinda el nivel de hemoglobina en sangre de los niños en cuestión. se mide en gramos por decilitro.
**Suplementacion**: Esta variable nos dejara saber si el menor se encuentra tomando algún tipo suplemento nutricional o no.
**Consejeria**: La variable nos dejara saber si el menor recibe o no , consejería de algún tipo para su salud.
**Altura**: Esta variable nos permite saber la altura en metros sobre el nivel del mar de los distritos, por ende provincia y departamento, de donde proviene el niño.
**HBC**: Esta variable nos brinda de forma analítica, los niveles de HBC sujetos al menor.
**DiagnosticoAnemia**: Esta variable nos deja saber si el menor se encuentra o no con anemia, y en caso de estarlo, nos brindaría el nivel de magnitud de la enfermedad.

### 3.1 Descriptores numéricos:

Máximos, mínimos, mediana y promedio de las variables mas relevantes:

```{r}
summary(DF$Talla)
```

```{r}
summary(DF$Peso)
```

```{r}
summary(DF$Altura)
```

```{r}
summary(DF$Hemoglobina)
```

Calculamos el nuemros de niños con anemia:
```{r}
nrow(filter(DF, DF$DiagnosticoAnemia =="Anemia Leve" | DF$DiagnosticoAnemia =="Anemia Moderada"| DF$DiagnosticoAnemia=="Anemia severa"))
porcenAne = (1843/nrow(DF))*100
print(porcenAne)
```
Son 1843 los niños que padecen algún nivel de anemia y los cuales representan el 14.29% de los niños de toda la muestra.

Número de niños que presentan algún tipo de ayuda social:

```{r}
nrow(filter (DF, DF$Juntos =="Sí" | DF$Qaliwarma =="Sí"| DF$SIS=="Sí" | DF$Consejeria=="Sí"))
```

10620 presentan algún tipo de ayuda social.

Porcentaje de niños que reciben algún tipo de ayuda social:

```{r}
porcenAs = (10620/nrow(DF))*100
print(porcenAs)
```

El 82.34% de los niños presentó algún tipo de ayuda social.

Número de niños que presentan algún nivel de anemia y algún tipo de ayuda social:

```{r}
nrow(filter (DF, DF$SIS =="Sí" | DF$Qaliwarma =="Sí"| DF$Juntos=="Sí" | DF$Consejeria=="Sí", DF$DiagnosticoAnemia  != "Normal"))
```

1524 niños presentan algún nivel de anemia y a su vez algún tipo de ayuda social.

Porcentaje de niños con anemia y ayuda social de algún tipo:

```{r}
porcenA = (1524 / 10620)*100
print(porcenA)
```

El 14.35% de los niños que presentan algún tipo de ayuda social, también presentan algún nivel de anemia.

Correlación entre el nivel de hemoglobina y el peso de los niños:

```{r}
cor(DF$Hemoglobina, DF$Peso)
```

### 3.2 Descriptores Gráficos:

Gráfico de barras para saber la cantidad por sexo de niños con anemia:

```{r}
tabla1 <- table(DF$DiagnosticoAnemia, DF$Sexo)
barplot(tabla1,main="Sexo vs Diagnóstico de anemia", beside = TRUE, las=0.5, 
        xlab='Sexo', ylab='Niños',
        col = c("aquamarine", "burlywood1","khaki1","palegreen1"), 
        ylim = c(0, 8000))
legend('topleft', legend=rownames(tabla1), bty='n',
       fill=c("aquamarine", "burlywood1","khaki1","palegreen1"))
```

```{r}
print(tabla1)
```

### Mapa de calor entre provincia y los diagnósticos de anemia:

```{r}
heatmap(table(DF$DiagnosticoAnemia,DF$Provincia),main="Diagnóstico de anemia vs provincia",Rowv = NA, Colv = NA)
```

El mapa de Calor muestra en que Provincias, hay mayor gravedad en los casos de Anemia, siendo el distrito de Cañete el distrito con los mayores casos de Anemia Moderada y Leve, y el de Huarichiri con los mayores casos de Anemia Severa

### Boxplot de la edad en meses de nuestra DF:

```{r}
boxplot(DF$EdadMeses, horizontal = TRUE)
```
### Tabla de gráficos respecto a los niveles de hemoglobina:

```{r}
hist(DF$Hemoglobina, )
```

### Boxplot de la relacion entre hemoglobina y el diagnostico de anemia.

```{r}
boxplot(DF$Hemoglobina ~ DF$DiagnosticoAnemia, xlab = "Dx anemia", ylab = "Hemoglobina")
```


### Relación entre las Variables de Diagnóstico de Anemia y Programa Qaliwarma

```{r}
ggplot(DF, aes(x = Qaliwarma, fill = DiagnosticoAnemia)) +
  geom_bar(position = "fill") +
  labs(x = "Programa Qaliwarma", y = "Proporción") +
  ggtitle("Relación entre Diagnóstico de Anemia y Programa Qaliwarma")
```

### Relación entre las variables Diagnóstico de Anemia y Programa Juntos

```{r}
ggplot(DF, aes(x = Juntos, fill = DiagnosticoAnemia)) +
  geom_bar(position = "fill") +
  labs(x = "Programa Juntos", y = "Proporción") +
  ggtitle("Relación entre Diagnóstico de Anemia y Programa Juntos")
```

### Casos de Anemia a lo largo de 2021
```{r}
DFA<-DF
date<-as.Date(DF$FechaAtencion, format = "%m/%d/%Y")
DFA$FechaAtencion<-month(date)
DFA %>% mutate(FechaAtencion=
               ifelse(FechaAtencion== 1,"Enero",
               ifelse(FechaAtencion== 2,"Febrero",
               ifelse(FechaAtencion== 3,"Marzo",
               ifelse(FechaAtencion== 4,"Abril",
               ifelse(FechaAtencion== 5,"Mayo",
               ifelse(FechaAtencion== 6,"Junio",
               ifelse(FechaAtencion== 7,"Julio",
               ifelse(FechaAtencion== 8,"Agosto",
               ifelse(FechaAtencion== 9,"Septiembre",
               ifelse(FechaAtencion== 10,"Octubre",
               ifelse(FechaAtencion== 11,"Noviembre",
               ifelse(FechaAtencion== 12,"Diciembre",FechaAtencion))))))))))))) -> DFA

DFA %>% mutate(DiagnosticoAnemia=
                 ifelse(DiagnosticoAnemia=="Normal","Normal",
                 ifelse(DiagnosticoAnemia=="Anemia Moderada","Con anemia",
                 ifelse(DiagnosticoAnemia=="Anemia Leve","Con anemia",
                 ifelse(DiagnosticoAnemia=="Anemia Severa","Con anemia",DiagnosticoAnemia)))))->DFA

DFA$DiagnosticoAnemia <- factor(DFA$DiagnosticoAnemia, levels = c("Con anemia","Normal"))
DFA$FechaAtencion <- factor(DFA$FechaAtencion, levels = c("Enero", "Febrero", "Marzo", "Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre")) 
ggplot(data = DFA, aes(x = FechaAtencion, fill = DiagnosticoAnemia)) +
  geom_bar(position = "fill") +
  labs(title = "Casos de anemia a lo largo del 2021", x = "Meses", y = "Porcentaje") +
  scale_fill_discrete(name = "Diagnostico")
```

# 4. PROBABILIDADES

##4.1 Probabilidad Empírica

###4.1.1 IMC

Vemos el comportamiento de la Variable IMC

El IMC es un indicador que mide si una persona esta en su peso ideal o tiene sobrepeso o bajo peso.

Si el IMC esta entre los valores de 18.5 y 24.9 su peso es el ideal

```{r}
BD$IMC1<- BD$IMC < 18.5  
BD$IMC2<- BD$IMC > 24.9
BD$IMC3<- !BD$IMC1 & !BD$IMC2


```

Seleccionamos un infante de la muestra y comprobamos si esta en su peso ideal.

El Espacio Muestral va estar definido de la Siguiente manera:

$$\Omega_Imc = \{BajoPeso,Normal,Sobrepeso\}$$

*\*BajoPeso\**= "Un infante seleccionado que esta debajo del peso ideal"

*\*Normal* *\**= "Un infante seleccionado que esta en el peso ideal"

\*Sobrepeso\*="Un infante seleccionado que esta por encima del peso ideal"

Así que la probabilidad de que un nino tenga un peso por debajo del ideal es:

```{r}
prop.table(table(BD$IMC1))

```

La probabilidad de que un nino tenga un peso ideal es:

```{r}
prop.table(table(BD$IMC2))
```

```{r}
prop.table(table(BD$IMC3))
```

Comprobamos la veracidad de las probabilidades, sumandolas

```{r}
sum(0.7321082,0.01380166,0.2540901)
```

###4.1.2 HEMOGLOBINA

Primero veremos como es el comportamiento de la variable Hemoglobina

```{r}
hist(DF$Hemoglobina)
```

Según la OMS un nivel bajo de Hemoglobina es considerado cuando es menor en 12 en Mujeres y 14 en Varones.

```{r}
BD$Hemo1F<- BD$Hemoglobina < 12
BD$Hemo1M<- BD$Hemoglobina < 14
```

Seleccionamos un infante de la muestra y comprobamos si tiene baja Hemoglobina

El Espacio Muestral va estar definido de la Siguiente manera: $\Omega_Hemo = \{H1, H1^C\}$

*H1* = "Un infante seleccionado que tenga un nivel de Hemoglobina normal"

*H1\^c*= "Un infante seleccionado que no tenga un nivel de Hemoglobina normal"

Así que la probabilidad de que un nina tenga baja Hemoglobina es :

```{r}
prop.table(table(BD$Hemo1F,BD$Sexo==F))
```

En el caso de los ninos:

```{r}
prop.table(table(BD$Hemo1M,BD$Sexo!=F),margin=2)
```

```{r}
sum(prop.table(table(BD$Hemo1M,BD$Sexo!=F)))
```

##4.2 Probabilidad Condicional

### 4.2.1 Caso 1
A:Seleccionar un niño con anemia B:Seleccionar un niño que no se suplementa 1. Validamos la independencia Para esto se debe cumplir que: 1.P(A∩B)=P(A)*P(B) 2.P(A\|B)=P(A) Sabemos que: P(A\|B)=P(A∩B)/P(B) P(B\|A)=P(A\|B)*P(B)/P(A) Por la probabilidad total P(A)=P(A\|B).P(B)+P(A\|B').P(B')

```{r}

Interseccion<-nrow(filter(DFA,Suplementacion=="No" & DiagnosticoAnemia=="Con anemia" ))/nrow(DFA)
Pa<-nrow(filter(DFA,DiagnosticoAnemia=="Con anemia" ))/nrow(DFA)
Pb<-nrow(filter(DFA,Suplementacion=="No" ))/nrow(DFA)
PaA<-nrow(filter(DFA,DiagnosticoAnemia=="Normal" ))/nrow(DFA)
PbB<-nrow(filter(DFA,Suplementacion=="Sí" ))/nrow(DFA)
PabB<-nrow(filter(DFA,Suplementacion=="Sí" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,Suplementacion=="Sí" ))
Pab<-nrow(filter(DFA,Suplementacion=="No" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,Suplementacion=="No" ))
Pba<-nrow(filter(DFA,Suplementacion=="No" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,DiagnosticoAnemia=="Con anemia" ))
#validacion de independencia

Interseccion
(Pa*Pb)

Pab-Pa
#Comprobamos la probabilidad condicional y bayes
Pab-Interseccion/Pb

(Pab*Pb)/((Pab*Pb)+(PabB*PbB))-Pba

```

A pesar de que esperabamos un dependencia fuerte, observamos que los resultados no son iguales,lo cual se aprecia en el grafico siguiente.

```{r}
ggplot(data = DFA, aes(x = Suplementacion, fill = DiagnosticoAnemia)) +
  geom_bar(position = "fill") +
  labs(title = "Casos de anemia vs suplementacion", x = "Suplementacion", y = "Porcentaje") +
  scale_fill_discrete(name = "Diagnostico")
```

###4.2.2 Caso 2
A:Seleccionar un niño varon B:Seleccionar un niño con anemia 1. Validamos la independencia Para esto se debe cumplir que: 1.P(A∩B)=P(A)*P(B) 2.P(A\|B)=P(A) Sabemos que: P(A\|B)=P(A∩B)/P(B) P(B\|A)=P(A\|B)*P(B)/P(A) Por la probabilidad total P(A)=P(A\|B).P(B)+P(A\|B').P(B')

```{r}

Interseccion<-nrow(filter(DFA,Sexo=="M" & DiagnosticoAnemia=="Con anemia" ))/nrow(DFA)
Pa<-nrow(filter(DFA,DiagnosticoAnemia=="Con anemia" ))/nrow(DFA)
Pb<-nrow(filter(DFA,Sexo=="M" ))/nrow(DFA)
PaA<-nrow(filter(DFA,DiagnosticoAnemia=="Normal" ))/nrow(DFA)
PbB<-nrow(filter(DFA,Sexo=="F" ))/nrow(DFA)
PabB<-nrow(filter(DFA,Sexo=="F" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,Sexo=="F" ))
Pab<-nrow(filter(DFA,Sexo=="M" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,Sexo=="M" ))
Pba<-nrow(filter(DFA,Sexo=="M" & DiagnosticoAnemia=="Con anemia" ))/nrow(filter(DFA,DiagnosticoAnemia=="Con anemia" ))
#validacion de independencia

Interseccion-(Pa*Pb)

Pab-Pa
#Comprobamos la probabilidad condicional y bayes
Pab-Interseccion/Pb

(Pab*Pb)/((Pab*Pb)+(PabB*PbB))-Pba

```

Como era de esperar, la anemia no depende del género del menor, por lo que podemos afirmar que el porcentaje de anemia en cada género debe ser similar como se ve a continuación

```{r}
ggplot(data = DFA, aes(x = Sexo, fill = DiagnosticoAnemia)) +
  geom_bar(position = "fill") +
  labs(title = "Casos de anemia vs sexo", x = "Sexo", y = "Porcentaje") +
  scale_fill_discrete(name = "Diagnostico")
```

##4.3 Variables aleatorias discretas

Definimos el tipo de distribución que se usara en cada variable. En nuestro caso usaremos las variables DiagnosticoAnemia(Categórica nominal) y suplementación(Categórica nominal), y los modelos a usar serán geométrica y binomial respectivamente.

```{r}
unique(DF$DiagnosticoAnemia)
unique(DFA$Suplementacion)
```

###4.3.1 DiagnosticoAnemia

Definimos la variable aleatoria

X: \# de niños que tienen anemia severa en la provincia de Oyon.

Identificamos los parámetros

X \~ Geom(p); donde: *p es la probabilidad de éxito en cada ensayo.* X es la variable aleatoria geométrica que representa el número de ensayos hasta el primer éxito.

```{r}
n<-nrow(filter(DF,Provincia=="OYON"))
p<-nrow(filter(DF,DiagnosticoAnemia=="Anemia Severa" & Provincia=="OYON"))/n
muestra<-rgeom(n,p)
prob<-dgeom(0:n,p)
plot(0:n, prob, type = "h", lwd = 2, main = "Distribución Geométrica",
     xlab = "Número de ensayos hasta el primer éxito", ylab = "Densidad probabilística")
```

Ahora debemos validar las propiedades de este modelo, las cuales son:

Esperanza matemática (E(X)): E(X) = 1 / p

```{r}
mean(muestra)#en el caso de la distribución geométrica, el promedio de una muestra generada a partir de esa distribución es equivalente a la esperanza matemática o el valor esperado.
((1/p))
```

Varianza (Var(X)):

Var(X) = (1 - p) / p\^2

```{r}
var(muestra)
(1 - p) / p^2
```

Coeficiente de variación(CV): CV = (1 - p) / (p\*100)

```{r}
sd(muestra)/mean(muestra)#coeficiente de variacion
(1-p)/(p*100)
```

Observamos que estas tienen un valor muy cercano en cada propiedad, por lo que podemos dar por valido la distribución.

Ejemplo: En un hospital en Oyon solo hay un pediatra, el cual aproximadamente atiende 20 visitas al día. Ante esto se nos pide calcular la probabilidad de que en estas visitas aparezca un niño con anemia severa, para asi poder evaluar si es necesario contratar más pediatras.

```{r}
pgeom(20,p)
```

Observamos de que en 20 visitas existe la probabilidad de 22% que aparezca un niño con anemia severa, por lo que al ser este tan grande, el hospital se ve en la necesidad de evaluar la contratación de un pediatra más.

###4.3.1 Suplementación

Definimos la variable aleatoria

X: \# de niños que reciben suplementación en la provincia de Barranca.

Identificamos los parámetros

X \~ Bin(n,p); donde:*P(x=k) la probabilidad de obtener k exitos.* p es la probabilidad de éxito. \*n es el tamaño de la muestra que recibe suplementación.

```{r}
n<-nrow(filter(DF,Provincia=="BARRANCA"))

p<-nrow(filter(DF,Suplementacion=="Sí" & Provincia=="BARRANCA"))/n
muestra<-rbinom(1000,n,p)
prob<-dbinom(0:n,n,p)
plot(0:n, prob, type = "p", pch = 19, col = "blue", xlab = "Número de éxitos", ylab = "Probabilidad", main = "Distribución Binomial")
```

Ahora debemos validar las propiedades de este modelo, las cuales son:

Esperanza matemática (E(X)): E(X) = n.p

```{r}
mean(muestra)#en el caso de la distribución geométrica, el promedio de una muestra generada a partir de esa distribución es equivalente a la esperanza matemática o el valor esperado.
(n*p)
```

Varianza (Var(X)):

Var(X) = n.p.(1-p)

```{r}
var(muestra)
n*p*(1-p)
```

Coeficiente de variación(CV): CV = sqrt(n.p.(1-p)) / (n.p)

```{r}
sd(muestra)/mean(muestra)#coeficiente de variacion
sqrt(n*p*(1-p))/(n*p)
```

Observamos que estas tienen un valor muy cercano en cada propiedad, por lo que podemos dar por valido la distribucion.

Ejemplo: En un hospital de Barranca, se desea planificar las acciones del hospital, por ende se desea saber que tantos niños ya reciben suplementación para asi poder reducir costos. Por ende veremos cual es la probabilidad de que el 90% de los niños reciban suplementación.

```{r}
qbinom(0.9,n,p)
```

##4.4 Variables aleatorias continua

Definimos el tipo de distribución que se usara en cada variable. usaremos las variables IMC(Numérica continua) y Hemoglobina(Numérica continua), y los modelos a usar serán normal y uniforme respectivamente.

```{r}
range(BD$IMC)
range(DFA$Hemoglobina)
```

Caso 1 - IMC Primero el rango de la variable

```{r}
range(BD$IMC)
IMC_ideal<-BD$IMC
```


### Parámetros teóricos

```{r}
median(IMC_ideal)
mean(IMC_ideal)
```

```{r}
boxplot(IMC_ideal, horizontal = T)
abline(v = mu, col = "red", lwd = 2)
```

```{r}
mu <- mean(IMC_ideal)
sd <- sd(IMC_ideal)
```

```{r}
density(IMC_ideal)
```

```{r}
hist(IMC_ideal, xlim = c(135, 210), breaks = 10, ylim = c(0, 0.05), las = 2, ylab = "", prob = T)
# Curva Real
lines(density(IMC_ideal), col = "blue", lwd = 2)
# Valor máximo Real
abline(h = 4.977e-02, col = "black", lwd = 2)
```

Ejercicio a) ¿Cuál es la probabilidad de que una niño tenga un IMC mayor a 19?
```{r}
pnorm(19,mu,sd,lower.tail = F)
```

# 5. CONCLUSIONES
Se pude decir con certeza que la alimentación, el IMC, la suplementación y la inclusión de niños al programa Juntos reduce considerablemente la probabilidad de que un niño pueda padecer de anemia.