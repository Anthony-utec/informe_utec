---
title: "PG1"
output:
  html_document:
    df_print: paged
  pdf_document: default
---

# Tema:

Niveles de anemia en niños y niñas menores de 5 años en Lima provincias entre los años 2019 y 2021.


## 1. INTRODUCCIÓN

### 1.1 Relevancia:

El nivel nutricional y alimenticio de los niños y niñas menores de 5 años, es importante debido a que la alimentación a edades tempranas tiene un rol fundamental en su desarrollo y en la prevencion de enfermedades.

### 1.2 Objetivos

#### 1.2.1 Objetivo general

Demostrar y visibilizar esta problemática que afecta a muchos niños en Lima provincias, la mayoría de ellos de recursos escasos, y concientizar sobre el numero de niños que padecen la enfermedad.

#### 1.2.2 Objetivos específicos

-   Identificar los factores de riesgo asociados a los niveles de anemia en niños y niñas menores de 5 años en Lima provincias entre los años 2019 y 2021.

-   Evaluar la eficacia de los programas de prevención y tratamiento de la anemia en niños y niñas menores de 5 años en Lima provincias entre los años 2019 y 2021.

-   Identificar las provincias de Lima con mayor prevalencia de anemia en niños y niñas menores de 5 años entre los años 2019 y 2021.

### 1.3 Contexto

Para entender el tema que se propone, solo se necesita saber que es la anemia, las afecciones que esta podría conllevar y las correlaciones que podría tener en relación al peso y el nivel de hemoglobina de los niños.

## 2. DATOS

### 2.1 Recolección de datos:

-   Después de las reuniones concretadas en grupo, decidimos trabajar con una base de datos.

-   Seleccionamos, luego de una meticulosa búsqueda de temática, nuestra base de datos de la plataforma nacional Datos abiertos, cuya administración es a cargo del gobierno.

-   Finalmente creemos que el tema elegido es contundente porque nos permitirá trabajar con una problemática real que aqueja hoy en día a un significante número de población.

### 2.2 Población:

La población del estudio son los niños menores de 5 años en Lima Provincias entre los años 2019 y 2021

### 2.3 Muestra:

Nuestra muestra contiene 21789 observaciones.

### 2.4 Muestreo:

Nuestro proyecto utiliza un muestreo del tipo estratificado ya que solo tomamos los casos ocurridos a niños menores de 5 años en Lima Provincias entre 2019 y 2021.

### 2.5 Variables:

| Variables        | Tipo de Variable                  |
|------------------|-----------------------------------|
| Diresa           | categórica nominal                |
| Red              | categórica nominal                |
| Microred         | categórica nominal                |
| EESS             | categórica nominal                |
| ProvinciaEESS    | categórica nominal                |
| DistritoEESS     | categórica nominal                |
| Renipress        | numérica continua                 |
| FechaAtencion    | numérica discreta                 |
| Pais             | categórica nominal                |
| Sexo             | categórica nominal                |
| FechaNacimiento  | numérica discreta                 |
| EdadMeses        | numérica discreta                 |
| UbigeoPN         | numérica continua                 |
| DepartamentoPN   | categórica nominal                |
| ProvinciaPN      | categórica nominal                |
| DistritoPN       | categórica nominal                |
| CentroPobladoPN  | categórica nominal                |
| Juntos           | categórica/cualitativa dicotómica |
| SIS              | categórica/cualitativa dicotómica |
| Pin              | categórica/cualitativa dicotómica |
| Qaliwarma        | categórica/cualitativa dicotómica |
| Peso             | numérica continua                 |
| Talla            | numérica continua                 |
| Hemoglobina      | numérica continua                 |
| FechaHemoglobina | numérica discreta                 |
| Cred             | categórica/cualitativa dicotómica |
| Suplementacion   | categórica/cualitativa dicotómica |
| Consejeria       | categórica/cualitativa dicotómica |
| Sesion           | categórica/cualitativa dicotómica |
| UbigeoREN        | numérica continua                 |
| DepartamentoREN  | categórica nominal                |
| ProvinciaREN     | categórica nominal                |
| DistritoREN      | categórica nominal                |
| AlturaREN        | numérica discreta                 |
| MES              | numérica discreta                 |
| MesDeAtencion    | numérica discreta                 |
| HBC              | numérica continua                 |
| Dx_Anemia        | categórica ordinal                |

### 2.6 Limpieza de Datos:

Antes que nada descargamos y cargamos los paquetes y librerías necesarios:

En caso no tengamos las librerias, podemos ejecutar el siguiente bloque de comandos: %install.packages('readr') install.packages('dplyr') install.packages("stringi") install.packages('ggplot2') install.packages("car")%

```{r,include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(car)
library(stringi)
```

Cargamos la data:

```{r}
DF <- read.csv("NiñosLIMAPROVINCIAS.csv")
```

Hallamos el numero total de observaciones y variables:

```{r}
nrow(DF)
ncol(DF)
```

Luego eliminamos y seleccionamos solo las variables que usaremos y consideramos necesarias:

```{r}
DF = select(DF,Diresa,Dpto_EESS,Prov_EESS,Dist_EESS,FechaAtencion,Sexo,FechaNacimiento,EdadMeses,UbigeoPN,Juntos,SIS,Qaliwarma,Peso,Talla,Hemoglobina,Suplementacion,Consejeria,AlturaREN,HBC,Dx_Anemia)
```

Modificamos los nombres de las variables pertinentes para el proyecto:

```{r}
DF = rename(DF,Departamento = "Dpto_EESS",Distrito = "Dist_EESS", Provincia = "Prov_EESS" , DiagnosticoAnemia = "Dx_Anemia",Ubigeo = "UbigeoPN",Altura = "AlturaREN")
```

Verificamos que nuestras variables tengan los valores adecuados, para que no haya error a la hora de trabajarlos:

```{r}
unique(DF$Diresa)
```

```{r}
unique(DF$Departamento)
```

```{r}
unique(DF$Provincia)
```

```{r}
unique(DF$Distrito)
```

```{r}
unique(DF$FechaAtencion)
```

```{r}
unique(DF$Sexo)
```

```{r}
unique(DF$FechaNacimiento)
```

```{r}
unique(DF$EdadMeses)
```

```{r}
unique(DF$Ubigeo)
```

```{r}
unique(DF$Juntos)
```

```{r}
unique(DF$SIS)
```

```{r}
unique(DF$Qaliwarma)
```

```{r}
unique(DF$Peso)
```

```{r}
unique(DF$Talla)
```

```{r}
unique(DF$Hemoglobina)
```

```{r}
unique(DF$Suplementacion)
```

```{r}
unique(DF$Consejeria)
```

```{r}
unique(DF$Altura)
```

```{r}
unique(DF$HBC)
```

```{r}
unique(DF$DiagnosticoAnemia)
```

Verificamos que nuestras variables sean del tipo correcto:

```{r}
summary(DF)
```

Contamos nuestros casos completos y datos faltantes:

```{r}
sum(complete.cases(DF))
```

```{r}
sum(is.na(DF))
```

Viendo que contamos con una gran cantidad de casos incompletos procederemos a eliminarlos para trabajar solo con las observaciones completas.

```{r}
DF <- na.omit(DF)
```

Verificamos que nuestra DF no cuente con ningún caso incompleto.

```{r}
sum(complete.cases(DF))
sum(is.na(DF))
```

Modificamos nuestras variables que presentan 0 y 1 en lugar de presentar Si o no:

```{r}
DF %>% mutate(Juntos=
               ifelse(Juntos == 0,"No",
               ifelse(Juntos == 1,"Sí",Juntos))) -> DF
DF %>% mutate(SIS=
               ifelse(SIS == 0,"No",
               ifelse(SIS == 1,"Sí",SIS))) -> DF

DF %>% mutate(Qaliwarma=
               ifelse(Qaliwarma== 0,"No",
               ifelse(Qaliwarma == 1,"Sí",Qaliwarma))) -> DF
DF %>% mutate(Suplementacion=
               ifelse(Suplementacion== 0,"No",
               ifelse(Suplementacion == 1,"Sí",Suplementacion))) -> DF
DF %>% mutate(Consejeria=
               ifelse(Consejeria== 0,"No",
               ifelse(Consejeria== 1,"Sí",Consejeria))) -> DF
```

Teniendo en cuenta que nuestros nuestras variables talla y peso tienen datos en extremos atípicos, se modificaran basandonse en los estándares de tallaje y pesaje para niños de entre esas edades, según el Minsa y OMS:

```{r}
DF %>% mutate (Talla=
        ifelse(Talla > 160 ,Talla/9 ,
        ifelse (Talla<=1 ,Talla*100,
        ifelse(Talla <= 16 ,Talla *10,
        Talla )))) -> DF
DF %>% mutate (Talla=
        ifelse(Talla >=135 & EdadMeses <=22  ,Talla /2,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <=20 & EdadMeses >= 54  ,Talla*5,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <=25 & EdadMeses <=22  ,Talla+50,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla == 27 & EdadMeses == 12  ,Talla+40,Talla)) -> DF
```

```{r}
DF %>% mutate (Peso=
        ifelse(Peso >= 200 , Peso/100,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >= 100 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >45 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <=100 & Peso >45 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >65 & EdadMeses <= 54 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >65 & EdadMeses <= 53 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <=100 & Peso >65 & EdadMeses <= 52 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >65 & EdadMeses <= 51 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso <= 100 & Peso >65 & EdadMeses <= 50 ,Peso/10,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso>1  & Peso<2 ,Peso*10,
         ifelse(Peso<1 ,Peso*100,      
        Peso ))) -> DF
DF %>% mutate (Peso=
        ifelse(Peso<4 ,(Peso+1)*3,
        Peso )) -> DF
```

Finalmente, consideramos que nuestra base de datos se encuentra limpia ya que, nuestras variables se encuentra bien detalladas, las únicas que presentaron valores atípicos extremos fueron modificadas bajo estándares que no permiten que nuestra base de datos pierda confiabilidad. Por otro lado eliminamos los datos faltantes y casos incompletos trabajando así con data recolectada de la fuente inicial.

## 3. ANÁLISIS :DESCRIPTIVO

En nuestro proyecto estamos usando 20 de las 38 variables que presenta nuestra base, dada su relevancia para nuestro trabajo estadístico.

**Diresa**: Esta variable nos permite saber a que Dirección Regional de Salud pertenece el menor.

**Departamento**: La variable nos brinda el departamento de donde proviene el niño.

**Provincia**: La variable nos brinda la provincia de donde proviene el niño.

**Distrito**: Lavariable nos brinda el distrito de donde proviene el niño

**FechaAtencion**: Esta variable nos brinda el día, fecha y año en el que se atendió el niño

**Sexo**: Esta variable nos indica el sexo del menor.

**FechaNacimiento**: Esta variable nos brinda la fecha en la que nacieron los niños.

**EdadMeses**: Esta variable nos permite saber la edad del niño en meses.

**Ubigeo**: Esta variable nos permite indica la ubicación geográfica del lugar en el que naciste .

**Juntos**: La variable nos brinda la información de si el niño pertenece o no al programa juntos.

**SIS**: La variable nos brinda la información de si el niño cuenta o no con el seguro integral de salud.

**Qaliwarma**: a variable nos brinda la información de si el niño pertenece o no al programa Qaliwarma.

**Peso**: Esta variable nos brinda la información respecto al peso del menor.

**Talla**: Esta variable nos brinda la información respecto a la talla del menor.

**Hemoglobina**: Esta variable nos brinda el nivel de hemoglobina en sangre de los niños en cuestión. se mide en gramos por decilitro.

**Suplementacion**: Esta variable nos dejara saber si el menor se encuentra tomando algún tipo suplemento nutricional o no.

**Consejeria**: La variable nos dejara saber si el menor recibe o no , consejería de algún tipo para su salud.

**Altura**: Esta variable nos permite saber la altura en metros sobre el nivel del mar de los distritos, por ende provincia y departamento, de donde proviene el niño.

**HBC**: Esta variable nos brinda de forma analítica, los niveles de HBC sujetos al menor.

**DiagnosticoAnemia**: Esta variable nos deja saber si el menor se encuentra o no con anemia, y en caso de estarlo, nos brindaría el nivel de magnitud de la enfermedad.

### 3.1 Descriptores numéricos:

Máximos, mínimos, mediana y promedio de las variables mas relevantes:

```{r}
summary(DF$Talla)
```

```{r}
summary(DF$Peso)
```

```{r}
summary(DF$EdadMeses)
```

```{r}
summary(DF$Altura)
```

```{r}
summary(DF$Hemoglobina)
```

Número de niños con anemia:

```{r}
nrow(filter(DF, DF$DiagnosticoAnemia =="Anemia Leve" | DF$DiagnosticoAnemia =="Anemia Moderada"| DF$DiagnosticoAnemia=="Anemia severa"))
```

Son 1843 los niños que padecen algún nivel de anemia.

Porcentaje de niños con anemia:

```{r}
porcenAne = (1843/nrow(DF))*100
print(porcenAne)
```

El 14.29% de los niños posee algún nivel de anemia.

Número de niños que presentan algún tipo de ayuda social:

```{r}
nrow(filter (DF, DF$Juntos =="Sí" | DF$Qaliwarma =="Sí"| DF$SIS=="Sí" | DF$Consejeria=="Sí"))
```

10620 presentan algún tipo de ayuda social.

Porcentaje de niños que reciben algún tipo de ayuda social:

```{r}
porcenAs = (10620/nrow(DF))*100
print(porcenAs)
```

El 82.34% de los niños presentó algún tipo de ayuda social.

Número de niños que presentan algún nivel de anemia y algún tipo de ayuda social:

```{r}
nrow(filter (DF, DF$SIS =="Sí" | DF$Qaliwarma =="Sí"| DF$Juntos=="Sí" | DF$Consejeria=="Sí", DF$DiagnosticoAnemia  != "Normal"))
```

1524 niños presentan algún nivel de anemia y a su vez algún tipo de ayuda social.

Porcentaje de niños con anemia y ayuda social de algún tipo:

```{r}
porcenA = (1524 / 10620)*100
print(porcenA)
```

El 14.35% de los niños que presentan algún tipo de ayuda social, también presentan algún nivel de anemia.

Correlación entre el nivel de hemoglobina y el peso de los niños:

```{r}
cor(DF$Hemoglobina, DF$Peso)
```

### 3.2 Descriptores Gráficos:

Gráfico de barras para saber la cantidad por sexo de niños con anemia:

```{r}
tabla1 <- table(DF$DiagnosticoAnemia, DF$Sexo)
barplot(tabla1,main="Sexo vs Diagnóstico de anemia", beside = TRUE, las=0.5, 
        xlab='Sexo', ylab='Niños',
        col = c("aquamarine", "burlywood1","khaki1","palegreen1"), 
        ylim = c(0, 8000))
legend('topleft', legend=rownames(tabla1), bty='n',
       fill=c("aquamarine", "burlywood1","khaki1","palegreen1"))
```

```{r}
print(tabla1)
```

Mapa de calor entre provincia y los diagnósticos de anemia:

```{r}
heatmap(table(DF$DiagnosticoAnemia,DF$Provincia),main="Diagnóstico de anemia vs provincia",Rowv = NA, Colv = NA)
```

Boxplot de la edad en meses de nuestra DF:

```{r}
boxplot(DF$EdadMeses, horizontal = TRUE)
```

Tabla de gráficos respecto a los niveles de hemoglobina:

```{r}
hist(DF$Hemoglobina, )
```

Boxplot de la relacion entre hemoglobina y el diagnostico de anemia.

```{r}
boxplot(DF$Hemoglobina ~ DF$DiagnosticoAnemia, xlab = "Dx anemia", ylab = "Hemoglobina")
```
