---
title: "LIMPIEZA 2"
format: revealjs
editor: visual
---

## LIMPIEZA 2

Limpieza hecha para contar la cantidad de personas que saben contestar una encuesta y desarrollar los objetivos específicos:

```{r}
tabla_2<-FORMS_1
tabla_2<-data.frame(tabla_2[3:21])
names(tabla_2)<-c("Horai24","Nombremay","Tallacm","Pesokg","Fechamda","Carreracom","Vecesnum","Edadmin","Río","Animal", "Pisa","País","Planeta","Pregunta1","Pregunta2","Pregunta3","Confirmación","Saltodeinst","Horaf24")
tabla_2
```

**Limpieza hora inicial formato 24 horas**

```{r}
# Reemplazar los valores en las filas mal ingresadas de la columna 1 (Hora incial, formato 24 horas) por NA
filas <- c(4,9,31,33,38,41,42,44,74,75,79,81,82,87,88,92,95,102,108,127,131,135,138,142,161,167)
tabla_2[filas,1] <- NA

```

**Limpieza nombre**

```{r}
#Elimina lo que no sea solo mayúsculas
tabla_2$Nombremay <- sapply(strsplit(as.character(tabla_2$Nombremay), "\\s+"), function(x) ifelse(!all(grepl("^[[:upper:]]+$", x)), NA, paste(x, collapse = " ")))
```

**Limpieza talla**

```{r}
tabla_2$Tallacm[tabla_2$Tallacm == "150 cm"]<- 150
tabla_2$Tallacm[tabla_2$Tallacm == "176cm"]<- 176
tabla_2$Tallacm[tabla_2$Tallacm == "Ciento setenta (170)"]<- 176
tabla_2$Tallacm <- ifelse(tabla_2$Tallacm < 100, NA, tabla_2$Tallacm)
tabla_2$Tallacm[tabla_2$Tallacm == "28.5"]<- NA
tabla_2$Tallacm[tabla_2$Tallacm == "37"]<- NA
```

**Limpieza peso**

```{r}
tabla_2$Pesokg[tabla_2$Pesokg == "48kg"]<- 48
tabla_2$Pesokg[tabla_2$Pesokg == "65kg"]<- 65
tabla_2$Pesokg[tabla_2$Pesokg == "Sesenta y seis (66)"]<- 66
```

**Limpieza fecha de nacimiento en formato mm/dd/aa**

```{r}
tabla_2$Fechamda[tabla_2$Fechamda == "24/33/2004"]<- NA
tabla_2$Fechamda[tabla_2$Fechamda == "15/06/2004"]<- NA
tabla_2$Fechamda[tabla_2$Fechamda == "05/04/2023"]<- 05/04/2003
tabla_2$Fechamda[tabla_2$Fechamda == "07-07-2004"]<- 07/07/2004
tabla_2$Fechamda[tabla_2$Fechamda == "01312001"]<- 01/31/2001
tabla_2$Fechamda[tabla_2$Fechamda == "29.11.2000"]<- NA
tabla_2$Fechamda[tabla_2$Fechamda == "11122003"]<- 11/12/2003
tabla_2$Fechamda[tabla_2$Fechamda == "07112002"]<- 07/11/2002
#Anulo el siguiente, porque el mes está mal
tabla_2$Fechamda[tabla_2$Fechamda == "25/09/97"]<- NA
# Convertir fechas a números y verificar condición
tabla_2$Fechamda <- ifelse(as.numeric(substr(tabla_2$Fechamda, 1, 2)) <= 12, tabla_2$Fechamda, NA)
```

**Limpieza de nombre completo de carrera**

```{r}
library(stringr)
tabla_2$Carreracom <- str_to_title(tabla_2$Carreracom)
tabla_2$Carreracom <- str_to_title(tabla_2$Carreracom)
tabla_2$Carreracom[tabla_2$Carreracom == "Ingeneria Química"]<- "Ingeniería Química"
tabla_2$Carreracom[tabla_2$Carreracom == "Ingenieria Ambiental"]<- "Ingeniería Ambiental"
tabla_2$Carreracom[tabla_2$Carreracom == "Ingeniería De Energía"]<- "Ingeniería De La Energía"
tabla_2$Carreracom[tabla_2$Carreracom == "Civil"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing. Civil"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing Civil"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Química"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing. Química"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing Ambiental"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing. Ambiental"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ambiental"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Mecánica"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Mecatrónica"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Electrónica"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Ing. Electrónica"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Industrial"]<- NA
tabla_2$Carreracom[tabla_2$Carreracom == "Futbolista"]<- NA
```

**Limpieza de veces que van a la univrersidad en números**

```{r}
tabla_2$Vecesnum[tabla_2$Vecesnum == "5 veces"]<- 5
tabla_2$Vecesnum[tabla_2$Vecesnum == "Cinco"]<- NA
```

**Limpieza edad en minúsculas**

```{r}
#El código elimina todo lo que no es minúscula
tabla_2$Edadmin <- sapply(strsplit(as.character(tabla_2$Edadmin), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
```

**Limpieza pregunta de opción múltiple**

```{r}
#Río más largo del mundo
tabla_2$Río <- sapply(strsplit(as.character(tabla_2$Río), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
#Tipo de animal que es la ballena
tabla_2$Animal <- sapply(strsplit(as.character(tabla_2$Animal), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
#Páis de la torre de Pisa
tabla_2$Pisa <- sapply(strsplit(as.character(tabla_2$Pisa), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
#País más grande
tabla_2$País <- sapply(strsplit(as.character(tabla_2$País), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
#Planeta
tabla_2$Planeta <- sapply(strsplit(as.character(tabla_2$Planeta), "\\s+"), function(x) ifelse(!all(grepl("^[[:lower:]]+$", x)), NA, paste(x, collapse = " ")))
```

**Limpieza preguntas abiertas en mayúsculas**

```{r}
#Pregunta 1
#Elimina lo que no sea solo mayúsculas
tabla_2$Pregunta1 <- sapply(strsplit(as.character(tabla_2$Pregunta1), "\\s+"), function(x) ifelse(!all(grepl("^[[:upper:]]+$", x)), NA, paste(x, collapse = " ")))
#Pregunta 2
#Elimina lo que no sea solo mayúsculas
tabla_2$Pregunta2 <- sapply(strsplit(as.character(tabla_2$Pregunta2), "\\s+"), function(x) ifelse(!all(grepl("^[[:upper:]]+$", x)), NA, paste(x, collapse = " ")))
#Pregunta 3
#Elimina lo que no sea solo mayúsculas
tabla_2$Pregunta3 <- sapply(strsplit(as.character(tabla_2$Pregunta3), "\\s+"), function(x) ifelse(!all(grepl("^[[:upper:]]+$", x)), NA, paste(x, collapse = " ")))
```

**Limpieza hora final formato 24 horas**

```{r}
# Reemplazar los valores en las filas mal ingresadas de la columna 1 (Hora incial, formato 24 horas) por NA
filas <- c(4,9,26,31,33,38,42,60,74,75,79,81,82,87,88,92,95,127,128,134,135,138,142,157,161,167)
tabla_2[filas,19] <- NA
```
