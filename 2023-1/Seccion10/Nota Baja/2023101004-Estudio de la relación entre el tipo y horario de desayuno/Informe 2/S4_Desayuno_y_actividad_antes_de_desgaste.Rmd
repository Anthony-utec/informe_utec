---
title: "Estudio de la relación entre el tipo y horario de desayuno y la cantidad de actividades que hacen los estudiantes de UTEC antes de sentir desgaste energético en sus actividades académicas durante el periodo 2023-1"
format:
  html:
    toc: true
    html-math-method: katex
    css: styles.css
output:
  html_document:
    mathjax: true
editor: visual
---

# INTRODUCCIÓN

## Relevancia:

El desayuno se considera como la comida más importante del día. Es la primera dosis de energía que recibe nuestro cuerpo.

El tema tiene relevancia, ya que nos permitirá conocer que variables relacionadas con el desayuno afectan la cantidad de actividad antes de sentir desgaste de los estudiantes de UTEC al culminar sus actividades durante el día. Dicho de otro modo, podremos conocer la influencia de los factores medidos para desayuno y su relación con la cantidad de actividad antes del desgaste.

## Factibilidad y planificación:

El proyecto es factible ya que la información la podemos obtener fácilmente, ya que nuestra población son los estudiantes de UTEC en el período 2023-1.

Dicho esto en nuestra planificación definimos:

Población: Estudiantes de UTEC en el período 2023-1

Muestra: 155 Estudiantes que asisten a clases, son encuestados uno a uno.

La metodología para obtener la muestra es encuestar a estudiantes al azar durante horas de la mañana en UTEC.

Luego de recoger los datos procedemos a limpiar los datos obtenidos utilizando los conocimientos adquiridos en clase y propios de investigación.

# OBJETIVOS

Nuestro objetivo principal es analizar los horarios de desayunos consumidos, el si características propias como la altura y peso afectan la sensación de desgaste según la cantidad de actividad que realizan los estudiantes de UTEC.

### Objetivos específicos

-   Analizar si existe una relación entre el tipo de desayuno consumido por los estudiantes y la cantidad de actividad que realizan hasta que se sienten desgastados o sin energía.

-   Determinar la relación entre el tiempo transcurrido desde el desayuno y la sensación de desgaste de los estudiantes de UTEC. ¿Existe una asociación entre el tiempo transcurrido después del desayuno y la percepción de fatiga durante las actividades académicas? (hora_desayuno - hora_desgaste) (desayuna - rendimiento) vs (no desayuna - rendimiento)

-   Determinar si el peso y la altura (IMC) determinan si la persona aguanta más en sus actividades académicas. (peso/altura - hora_desgaste)

# MARCO TEÓRICO

## Test del CHI-CUADRADO

El test de chi-cuadrado es una prueba estadística utilizada para determinar si hay una relación significativa entre dos variables categóricas. Este test se basa en comparar las frecuencias observadas en una tabla de contingencia con las frecuencias esperadas bajo la hipótesis de nula independencia entre las variables.

# DESCRIPCIÓN DE LAS VARIABLES DE ESTUDIO (Codebook)

+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| **Variables**                    | **Tipo**           | **Descripción**                                                                                                                                          |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Edad                             | Numérica-discreta  | Toma valores entre $$15 - 40$$                                                                                                                           |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Altura                           | Numérica-continua  | Esta en cm y toma valores entre $$40, 280$$                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Peso                             | Numérica-continua  | Esta en kg y toma valores entre $$20, 200$$                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Sexo                             | Categórica-Nominal | Puede tomar valores de "Masculino", "Femenino" o "Otro"                                                                                                  |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Hora.desayuno                    | Categórica-ordinal | Se ingresa la hora del día en "h:min" en formato de 24 horas.                                                                                            |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Hora.desgaste                    | Categórica-ordinal | Se ingresa la hora del día en "h:min" en formato de 24 horas.                                                                                            |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo.de.producto                 | Categórica-Nominal | Toma valores de "Bebida", "Comida" o "Otro"                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Producto.principal               | Categórica-Nominal | Admite un string como el siguiente "producto que consumió"                                                                                               |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Porción.producto.principal       | Categórica-Nominal | Toma valore string que están definidas 4 opciones u otra que se agregue                                                                                  |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Costo.producto.principal         | Numérica-continua  | Toma los valores en términos de Sol peruano                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Unidades.producto.principal      | Numérica-discreta  | Toma valores que representa la cantidad de producto                                                                                                      |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo.producto.secundario         | Categórica-Nominal | Toma valores de "nombre_producto_secundario"                                                                                                             |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Producto.secundario              | Categórica-Nominal | Toma valores de "Bebida", "Comida" o "Otro"                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Porción.producto.secundario      | Categórica-Nominal | Admite valores string "pan", "snaks", ... , "otro"                                                                                                       |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Costo.unidad.producto.secundario | Numérica-continua  | Toma los valores en términos de Sol peruano                                                                                                              |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Unidades.producto.secundario     | Numérica-discreta  | Toma valores que representa la cantidad de producto                                                                                                      |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Actividad.pre.desgasto           | Categórica-ordinal | Toma valores predefinidos desde "Muy poco" a "Mucho"                                                                                                     |
|                                  |                    |                                                                                                                                                          |
|                                  |                    | -Muy poco : se realizan actividades como solo me siento y veo redes sociales hasta esperar las clases.                                                   |
|                                  |                    |                                                                                                                                                          |
|                                  |                    | -Poco: se realizan actividades como  solo me siento, hago las tareas, reviso pendientes, entro a clases y hago apuntes.                                  |
|                                  |                    |                                                                                                                                                          |
|                                  |                    | -Normal: se realizan actividades como una PC o examen.                                                                                                   |
|                                  |                    |                                                                                                                                                          |
|                                  |                    | -Regular: se realizaban actividades como tengo laboratorio de 5 horas que necesita concentración y andar.)                                               |
|                                  |                    |                                                                                                                                                          |
|                                  |                    | -Mucho: se realizan actividades como (participo en una organización estudiantil donde hago mucha actividad física)                                       |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+
| Tiempo.Pre.Desgaste              | Numérica-continua  | Representa las horas transcurridas desde que desayuno hasta que se sintieron cansados, esta variable se obtiene con las horas desayuno y horas desgaste. |
+----------------------------------+--------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------+

# LIMPIEZA DE DATOS

## Importe de librerías

```{r, results='hide'}
library(dplyr)
library(readr)
library(RColorBrewer)

```

Incluimos el archivo donde esta la base de datos ya limpia, ya que la limpieza no es relevante en esta entrega.

```{r, results='hide'}
DF <- read.csv("datos_limpios.csv")
```

# ANÁLISIS DE VARIABLES

## Análisis de la variable Hora desayuno

La variable hora de desayuno es una variable categórica ordinal la cual podemos explicarla con una gráfica de barras.

```{r}

table(DF$Hora.desayuno)
plot(table(DF$Hora.desayuno), xlab = "hora de desgaste", ylab = "frecuencia",las = 2)
print(levels(DF$Actividad.pre.desgasto))

```

En la gráfica vemos 4 momentos que se resaltan, "06:30", "07:00", "08:00", "09:00", lo cual en su mayoría son escogidos por los estudiantes de UTEC para tomar su desayuno, ademas, el dato "00:00" nos indica (bajo la interpretación de los autores) que son los estudiantes que no toman el desayuno, los cuál es la moda.

## Análisis de la variable Hora desgaste

```{r}
table(DF$Hora.desgaste)

```

La hora 00:00 significa que no se sienten cansados durante el día

```{r}
plot(table(DF$Hora.desgaste), xlab = "hora de desgaste", ylab = "frecuencia", main = "Hora de desgaste vs frecuencia", las = 2)
```

De la gráfica podemos observar que la mayoría de los estudiantes se cansan a la 13:00 de la tarde, lo cual es lógico porque aproximadamente a esa hora se suministra calorías nuevamente al cuerpo(almuerzo).

## Análisis de la variable Producto secundario

```{r}
Producto_Secundario <- data.frame(table(DF$Producto.secundario))

# Cambiar los nombres de las variables
colnames(Producto_Secundario) <- c("Producto_Secundario", "Frecuencia")

# Imprimir el dataframe con los nuevos nombres de variables
print("Estos son los productos considerados como producto secundario y la cantidad de veces que fueron elegidos por los estudiantes en la muestra. Se muestran estos valores ya que nos dan un contexto y entender de lo que se hablara más adelante.")
print(Producto_Secundario)
```

## Análisis de la variable Tiempo.pre.desgaste

Observamos primero en el gráfico de frecuencia, la distribución de la cantidad de repeticiones para cada valor de tiempo. Mientras que en el segundo gráfico se muestra la estimación de la distribución continua de los valores. Ambos gráficos proporcionan información complementaria sobre la distribución y la frecuencia de los tiempos de pre-desgaste en los datos.

```{r}
densidad_tiempo_pre_desgaste <- density(DF$Tiempo.pre.desgaste, na.rm = TRUE)
frecuencia_tiempo_pre_desgaste <- table(DF$Tiempo.pre.desgaste)

# Graficar la frecuencia
plot(frecuencia_tiempo_pre_desgaste,
     xlab = "Tiempo de Pre-desgaste",
     ylab = "Frecuencia",
     main = "Gráfico de Frecuencia de Tiempo de Pre-desgaste",
      col = "blue")

# Graficar la densidad
plot(densidad_tiempo_pre_desgaste, 
     xlab = "Tiempo de Pre-desgaste",
     ylab = "Densidad",
     main = "Gráfico de Densidad de Tiempo de Pre-desgaste",
      col = "red")



print("Observamos primero en el gráfico de frecuencia, la distribución de la cantidad de repeticiones para cada valor de tiempo.  Mientras que en el segundo grafico se muestra la estimación de la distribución continua de los valores. Ambos gráficos proporcionan información complementaria sobre la distribución y la frecuencia de los tiempos de pre-desgaste en los datos.")
```

# INTERACCIÓN ENTRE LAS VARIABLES

## Análisis entre el tipo de desayuno secundario consumido y la cantidad de actividad hasta sentirse cansado

```{r}
datos <- subset(DF, select = c(Producto.secundario, Actividad.pre.desgasto))
datos <- datos[complete.cases(datos),]
# Gráfico para "Tipo.de.producto"
plot(table(datos$Producto.secundario), main = "Distribución de Tipo de Producto secundario",las = 2,cex.axis = 0.7)

# Gráfico para "Actividad.pre.desgasto"
barplot(table(datos$Actividad.pre.desgasto), main = "Distribución de Sensación de Desgaste")
sapply(datos, class)
tabla_contingencia <- table(datos$Producto.secundario, datos$Actividad.pre.desgasto)
print(tabla_contingencia)
# Test de chi-cuadrado
resultado_chi2 <- chisq.test(tabla_contingencia)
print(resultado_chi2)

```

El p-valor nos indica si hay suficiente evidencia para rechazar la hipótesis nula. En este caso, dado que el p-valor es menor que el nivel de significancia comúnmente utilizado (como 0.05), se puede afirmar que existe una asociación significativa entre las variables en análisis.(Posible dependencia)

## Análisis entre la variable "Hora de desayuno" y "Actividad pre desgaste"

```{r}
# Excluir las filas con hora de desayuno igual a "00:00"
datos_a_usar <- DF[DF$Hora.desayuno != "00:00", ]
# Convertir la variable "hora de desayuno" a un formato adecuado
datos_a_usar$Hora.desayuno <- strptime(datos_a_usar$Hora.desayuno, format = "%H:%M")
# Convertir la variable Hora.desayuno a formato numérico de horas
datos_a_usar$hora_numerica <- as.numeric(format(datos_a_usar$Hora.desayuno, "%H"))

# Crear una nueva variable con los rangos de horas
datos_a_usar$rango_hora <- cut(datos_a_usar$hora_numerica, breaks = c(5, 6, 7, 8, 9, 10, 12), labels = c("5-6", "6-7", "7-8", "8-9", "9-10", "11-12"), include.lowest = TRUE)

# Calcular la tabla de contingencia 
tabla_contingencia_rangos <- table(datos_a_usar$rango_hora, datos_a_usar$Actividad.pre.desgasto)

# Generar una paleta de colores sin repetición
colores <- colorRampPalette(brewer.pal(6, "Set3"))(6)

# Crear el gráfico de barras 
barplot(tabla_contingencia_rangos, beside = TRUE, legend.text = TRUE, main = "Distribución de Actividad pre desgaste por Rangos de Horas",
        xlab = "Rangos de Horas", ylab = "Frecuencia", col = colores)

# Imprimir la tabla de contingencia por rangos de horas
print(tabla_contingencia_rangos)

# Realizar el test de chi-cuadrado por rangos de horas
resultado_chi2_rangos <- chisq.test(tabla_contingencia_rangos)
print(resultado_chi2_rangos)
```

En este caso, como el valor p (0.2605) es mayor que un nivel de significancia comúnmente utilizado como 0.05, no se puede rechazar la hipótesis nula. Esto significa que no hay suficiente evidencia para concluir que existe una relación significativa entre los rangos de horas de desayuno y Actividad pre desgasto.

## Análisis del tiempo transcurrido desde desayuno hasta desgaste vs actividad antes de sentirse desgastados

Primero debemos crear una nueva variable por persona que sea `tiempo pre desgaste` que este en horas, cabe aclarar que en nuestro formulario hicimos que quienes no desayunan coloquen 0, en este análisis consideraremos a quienes desayunaron, lo cuál es importante entorno al objetivo específico número 2. Entonces en `tiempo pre desgaste` quienes tengan `hora de desayuno` igual a 0 tendrá el valor de `NA`, porque al momento de realizar la gráfica y realizar operaciones numéricas es fácil obviar los `NA` con `complete.cases`. ¿Por qué `NA` y no 0? porque que tal si alguien si puso que desayuna pero también considera que se siente desgastado al mismo momento de desayunar, entonces el tiempo pre desgaste sería 0.

```{r}
  procesar_datos <- function(dataset) {
    dataset <- dataset[complete.cases(dataset),]
    dataset$Hora.desayuno <- format(dataset$Hora.desayuno, format = "%H:%M")
    
    dataset$Hora.desayuno <- as.POSIXlt(dataset$Hora.desayuno, format = "%H:%M")
    
    dataset$Hora.desgaste <- format(dataset$Hora.desgaste, format = "%H:%M")
    
    dataset$Hora.desgaste <- as.POSIXlt(dataset$Hora.desgaste, format = "%H:%M")
    
    dataset$Tiempo.pre.desgaste <- dataset$Hora.desgaste - dataset$Hora.desayuno
    
    dataset$Tiempo.pre.desgaste <- as.numeric(dataset$Tiempo.pre.desgaste) / 3600
    
    dataset$Tiempo.pre.desgaste[dataset$Hora.desayuno == "2023-06-04 00:00:00"] <- NA
    
    dataset <- dataset[dataset$Tiempo.pre.desgaste >= 0,]
    
    dataset <- dataset[complete.cases(dataset$Tiempo.pre.desgaste),]
    
    return(dataset)
}




```

```{r,results='hide'}
# Añadimos un onlyHours extra
onlyHours <- DF[,c("Hora.desayuno","Hora.desgaste","Actividad.pre.desgasto")]

# Usamos aquellas tuplas sin NA
onlyHours <- procesar_datos(onlyHours)

```

```{r}
# Media de Tiempo.pre.desgaste
media <- mean(onlyHours$Tiempo.pre.desgaste)

# Mediana de Tiempo.pre.desgaste
mediana <- median(onlyHours$Tiempo.pre.desgaste)

# Desviación estándar de Tiempo.pre.desgaste
desviacion_estandar <- sd(onlyHours$Tiempo.pre.desgaste, na.rm = TRUE)

cat(paste("Media de Tiempo.pre.desgaste: ",round(media,2),
          "\nMediana de Tiempo.pre.desgaste: ",mediana, 
          "\nDesviación estándar de Tiempo.pre.desgaste: ", 
          round(desviacion_estandar,2)
          ))


```

En base a estos descriptores, se puede afirmar que la cantidad de horas en promedio de Tiempo.pre.desgaste es 5.86. Además la mediana de 4.75 horas de Tiempo.pre.desgaste nos indica que el 50% de estudiantes se sienten desgastados después de este tiempo. Así mismo podemos observar que la desviación estándar es de 3.87.

```{r}
# Gráfico de caja para la variable Tiempo.pre.desgaste

bxx <- boxplot(onlyHours$Tiempo.pre.desgaste, range = TRUE, horizontal = TRUE,  main = "Boxplot del tiempo pre desgaste", xlab = "Tiempo (horas)")
```

```{r}
# Cuartiles de Tiempo.pre.desgaste
q1 <- quantile(onlyHours$Tiempo.pre.desgaste, 0.25)
q2 <- quantile(onlyHours$Tiempo.pre.desgaste, 0.50)
q3 <- quantile(onlyHours$Tiempo.pre.desgaste, 0.75)

#Q0 y Q4  o extremos de los bigotes del boxplot
extremo_infe <- round(bxx$stats[1, ],2)
extremo_supe <- round(bxx$stats[5, ],2)

# Rango intercuartil de Tiempo.pre.desgaste
iqr <- IQR(onlyHours$Tiempo.pre.desgaste)

cat(paste("\nRango intercuartil de Tiempo.pre.desgaste: ",iqr,
          "\nExtremo inferior: ", extremo_infe,
          "\nExtremo superior: ", extremo_supe,
          "\nCuartil 1: ", q1,
          "\nCuartil 2: ", q2,
          "\nCuartil 3: ", q3
          ))
```

Se observa que hay una distribución casi simétrica y equilibrada de los valores en el Tiempo.pre.desgaste de los estudiantes. Además cabe mencionar que : El 25% de los valores de Tiempo.pre.desgaste se encuentran por debajo de 3.5(horas). El 50% de los estudiantes esta debajo de 4.75 (horas), y el otro 50% esta por encima de 4.75(horas). De los datos el 75% de los valores se encuentran por debajo de 7 (horas).

Ahora procedemos a analizar Tiempo.pre.desgaste VS Actividad.pre.desgasto.

```{r}

bx <- boxplot(Tiempo.pre.desgaste ~ Actividad.pre.desgasto, data = onlyHours,range = TRUE,
        main = "Boxplot de Tiempo.pre.desgaste por Actividad.pre.desgasto",
        xlab = "Actividad.pre.desgasto", ylab = "Tiempo.pre.desgaste")
```

```{r}
# Obtener los valores de cuartiles
q0 <- bx$stats[1, ]
q1 <- bx$stats[2, ]
q2 <- bx$stats[3, ]
q3 <- bx$stats[4, ]
q4 <- bx$stats[5, ]

# Obtener los valores del rango intercuartil (IQR)
iqr_values <- bx$stats[4, ] - bx$stats[2, ]

# Mostrar los valores de los cuartiles y las líneas negras
cat(paste("\nValores de los cuartiles por caja: ->", 
          " Extremo inferior: ", format(round(q0,2), width = 4), 
          "    Extremo superior: ", format(round(q4,2), width = 4),
          "    Cuartil 1: ", format(round(q1,2), width = 4),
          "    Cuartil 2: ", format(round(q2,2), width = 4),
          "    Cuartil 3: ", format(round(q3,2), width = 4)))

# Mostrar los valores del IQR
cat(paste("\nValores del rango intercuartil (IQR):  ->", round(iqr_values,2)))
```

Los valores de los cuartiles por caja y el rango intercuartil se muestran en el orden del gráfico mostrado anteriormente.

Resalta que la mediana de Tiempo.pre.desgaste esta entorno a 4 en todos los valores que toma Actividad.pre.desgasto, esto sugiere que el Tiempo.pre.desgaste se mantiene en un nivel cercano a 4 sin importar la Actividad.pre.desgaste.

Podemos realizar las siguientes afirmaciones:

-   Los niveles de actividad "Poco", "Normal" y "Regular" presentan una mayor dispersión y diversidad en los tiempos de desgaste. Esto sugiere que algunas personas pueden sentirse fatigadas rápidamente, mientras que otras pueden mantener una mayor resistencia antes de llegar a la fatiga.

-   Los niveles de actividad "Muy poco" y "Mucho" muestran una menor variabilidad en los tiempos de desgaste. Esto indica que las personas tienden a experimentar fatiga en momentos más consistentes y predecibles dentro de estos niveles. Por ejemplo en el caso de "Muy poco", podría implicar que la persona se fatiga rápidamente debido a una actividad muy intensa o exigente.

-   Se observe una mayor dispersión o menor variabilidad en los tiempos de desgaste, esto no necesariamente implica una relación directa teóricamente.

En conclusión las personas pueden tener diferentes niveles de resistencia y fatigarse en mayor o menor cantidad de horas de Tiempo.pre.desgaste dentro de los diferentes niveles de actividad.

## Análisis del indice de masa corporal (IMC) con respecto al tiempo de desgaste energético.

```{r,results='hide'}
data_set <- DF[, c("Hora.desayuno","Hora.desgaste","Actividad.pre.desgasto","Peso", "Altura")]

data_set <- procesar_datos(data_set)
# Aplicamos la formula para hallar el IMC 
data_set$IMC <- (data_set$Peso) / ((data_set$Altura/100)^2) 

# Dejamos las variables que servirán
data_set <- subset(data_set, select = c(Peso, Altura,IMC,Tiempo.pre.desgaste))




```

```{r}
plot( data_set$IMC,data_set$Tiempo.pre.desgaste, main = "Gráfico de dispersión",
     xlab = "IMC",
     ylab = "Tiempo hasta sentirse desgastado",
     col = "blue",
     pch = 16)

regresion <- lm(data_set$Tiempo.pre.desgaste ~ data_set$IMC, data = data_set)

```

Trazamos la linea de regresión

```{r}
plot( data_set$IMC,data_set$Tiempo.pre.desgaste, main = "Gráfico de dispersión",
     xlab = "IMC",
     ylab = "Tiempo hasta sentirse desgastado",
     col = "blue",
     pch = 16, abline(regresion))
```

Imprimimos los datos

```{r}
summary(regresion)
```

Los coeficientes no son estadísticamente significativos y el coeficiente de determinación es muy bajo.

```{r}
correlacion <- cor(data_set$Tiempo.pre.desgaste, data_set$IMC)
print(round(correlacion,3))
```

Existe una relación muy débil y prácticamente no hay correlación lineal entre el IMC y el tiempo antes de sentirse desgastados.

```{r}
covarianza <- cov(data_set$IMC, data_set$Tiempo.pre.desgaste)
print(round(covarianza, 2))
```

Una covarianza de -0.76 sugiere que las variables tienen una relación inversa fuerte. Un valor de covarianza negativo indica que cuando una variable aumenta, la otra tiende a disminuir, y viceversa.

En el caso específico de una covarianza de -0.76, indica una relación inversa fuerte entre las variables. Esto significa que cuando una variable aumenta, la otra tiende a disminuir en aproximadamente el 76% de la variabilidad conjunta. Esto implica que a medida que el IMC aumenta, el tiempo antes de sentirse con desgaste tiende a disminuir, y viceversa.Sin embargo, es importante tener en cuenta que la covarianza por sí sola no proporciona información completa sobre la relación entre las variables.

## Análisis de Edad vs Actividad pre-desgasto

```{r}
# Importar el csv limpio no reconoció los niveles
DF$Actividad.pre.desgasto <- factor(DF$Actividad.pre.desgasto, levels = c("Muy poco", "Poco", "Normal", "Regular", "Mucho"))
# Tabla de contingencia
tabla_contingencia <- table(DF$Edad, DF$Actividad.pre.desgasto)
tabla_contingencia
# Covarianza
cov_matrix <- cov(DF$Edad,as.numeric(DF$Actividad.pre.desgasto))
print(paste("Covarianza:", round(cov_matrix,4)))

# Correlación
cor_matrix <- cor(DF$Edad, as.numeric(DF$Actividad.pre.desgasto))
print(paste("Correlación:", round(cor_matrix,4)))
```

Ambas medidas sugieren una relación limitada o débil entre las variables `Edad`y `Actividad.pre.desgasto`.

# PROBABILIDAD

## Probabilidad empírica

Determinamos el espacio de resultados teórico y la función de probabilidad para los eventos atómicos de manera empírica para la variable `Actividad pre desgasto` y `Edad`

### Variable aleatoria X

Se realiza un experimento, seleccionar un estudiante de UTEC y observar su Actividad pre desgasto. A partir del experimento se obtuvo la variable aleatoria $$\mathbb{X}$$ la cuál consta de 5 eventos atómicos, esta variable nos permite dividir a la población según su cantidad de actividad pre desgasto.

$$\mathbb{X} = \begin{cases}
4 & \text{Mucho}\\
3 & \text{Regular}\\
2 & \text{Normal}\\
1 & \text{Poco}\\
0 & \text{Muy poco}\\
\end{cases}
$$

```{r}
x4 <- nrow(DF %>% filter(Actividad.pre.desgasto =="Mucho"))
x3 <- nrow(DF %>% filter(Actividad.pre.desgasto == "Regular"))
x2 <- nrow(DF %>% filter(Actividad.pre.desgasto == "Normal"))
x1 <- nrow(DF %>% filter(Actividad.pre.desgasto == "Poco"))
x0 <- nrow(DF %>% filter(Actividad.pre.desgasto == "Muy poco"))
xtotal <- nrow(DF)

# Comprobando atomicidad
(x4+x3+x2+x1+x0)/xtotal
```

Espacio de resultados teórico de cada evento atómico:

Realiza muy poca actividad antes de sentir desgaste: $$\mathbb{S} = \{Muy \ poco\}$$ Realiza poca actividad antes de sentir desgaste: $$\mathbb{S} = \{Poco\}$$ Realiza una cantidad normal de actividad antes de sentir desgaste: $$\mathbb{S} = \{Normal\}$$

Realiza una cantidad regular(considerado superior a normal) de actividad antes de sentir desgaste: $$\mathbb{S} = \{Regular\}$$ Realiza mucha actividad antes de sentir desgaste: $$\mathbb{S} = \{Mucho\}$$

#### Eventos atómicos

Evento A1 = "Se selecciona un estudiante de UTEC que su actividad pre desgasto es muy poco"

```{r}
# calculamos la probabilidad
P_A1 = x0/xtotal
P_A1
```

Evento A2 = "Se selecciona un estudiante de UTEC que su actividad pre desgasto es poco"

```{r}
# calculamos la probabilidad
P_A2 = x1/xtotal
P_A2
```

Evento A3 = "Se selecciona un estudiante de UTEC que su actividad pre desgasto es normal"

```{r}
# calculamos la probabilidad
P_A3 = x2/xtotal
P_A3
```

Evento A4 = "Se selecciona un estudiante de UTEC que su actividad pre desgasto es regular"

```{r}
# calculamos la probabilidad
P_A4 = x3/xtotal
P_A4
```

Evento A5 = "Se selecciona un estudiante de UTEC que su actividad pre desgasto es mucho"

```{r}
# calculamos la probabilidad
P_A5 = x4/xtotal
P_A5

```

### Variable aleatoria Y

Se realiza un experimento, seleccionar un estudiante de UTEC y obtener su edad en ese preciso momento como número natural. A partir del experimento se obtuvo la variable aleatoria $$\mathbb{Y}$$ la cuál consta de 12 eventos atómicos, esta variable nos permite dividir a la población según la edad que presentaban al momento de realizar el experimento.

```{r}
table(DF$Edad)
```

$$\mathbb{Y} = \begin{cases}
12 & \text{36 años}\\
11 & \text{31 años}\\
10 & \text{26 años}\\
9 & \text{25 años}\\
8 & \text{24 años}\\
7 & \text{23 años}\\
6 & \text{22 años}\\
5 & \text{21 años}\\
4 & \text{20 años}\\
3 & \text{19 años}\\
2 & \text{18 años}\\
1 & \text{17 años}\\
0 & \text{16 años}\\
\end{cases}
$$

```{r}
y12 <- nrow(DF %>% filter(Edad == 36))
y11<- nrow(DF %>% filter(Edad == 31))
y10 <- nrow(DF %>% filter(Edad == 26))
y9 <- nrow(DF %>% filter(Edad == 25))
y8 <- nrow(DF %>% filter(Edad == 24))
y7 <- nrow(DF %>% filter(Edad == 23))
y6 <- nrow(DF %>% filter(Edad == 22))
y5 <- nrow(DF %>% filter(Edad == 21))
y4 <- nrow(DF %>% filter(Edad == 20))
y3 <- nrow(DF %>% filter(Edad == 19))
y2 <- nrow(DF %>% filter(Edad == 18))
y1 <- nrow(DF %>% filter(Edad == 17))
y0 <- nrow(DF %>% filter(Edad == 16))
ytotal <- nrow(DF)

# Comprobando atomicidad
(y12+y11+y10+y9+y8+y7+y6+y5+y4+y3+y2+y1+y0)/ytotal
```

Espacio de resultados teórico de cada evento atómico:

Persona que tiene 16 años: $$\mathbb{S} = \{0\}$$ Persona que tiene 17 años: $$\mathbb{S} = \{1\}$$ Persona que tiene 18 años: $$\mathbb{S} = \{2\}$$ Persona que tiene 19 años: $$\mathbb{S} = \{3\}$$ Persona que tiene 20 años: $$\mathbb{S} = \{4\}$$ Persona que tiene 21 años: $$\mathbb{S} = \{5\}$$ Persona que tiene 22 años: $$\mathbb{S} = \{6\}$$ Persona que tiene 23 años: $$\mathbb{S} = \{7\}$$ Persona que tiene 24 años: $$\mathbb{S} = \{8\}$$ Persona que tiene 25 años: $$\mathbb{S} = \{9\}$$ Persona que tiene 26 años: $$\mathbb{S} = \{10\}$$ Persona que tiene 31 años: $$\mathbb{S} = \{11\}$$ Persona que tiene 36 años: $$\mathbb{S} = \{12\}$$

#### Eventos atómicos

Evento B1 = "Se selecciona un estudiante de UTEC y tiene 16 años"

```{r}
# calculamos la probabilidad
P_B1 = y0/ytotal
P_B1
```

Evento B2 = "Se selecciona un estudiante de UTEC y tiene 17 años"

```{r}
# calculamos la probabilidad
P_B2 = y1/ytotal
P_B2
```

Evento B3 = "Se selecciona un estudiante de UTEC y tiene 18 años"

```{r}
# calculamos la probabilidad
P_B3 = y2/ytotal
P_B3
```

Evento B4 = "Se selecciona un estudiante de UTEC y tiene 19 años"

```{r}
# calculamos la probabilidad
P_B4 = y3/ytotal
P_B4
```

Evento B5 = "Se selecciona un estudiante de UTEC y tiene 20 años"

```{r}
# calculamos la probabilidad
P_B5 = y4/ytotal
P_B5
```

Evento B6 = "Se selecciona un estudiante de UTEC y tiene 21 años"

```{r}
# calculamos la probabilidad
P_B6 = y5/ytotal
P_B6
```

Evento B7 = "Se selecciona un estudiante de UTEC y tiene 22 años"

```{r}
# calculamos la probabilidad
P_B7 = y6/ytotal
P_B7
```

Evento B8 = "Se selecciona un estudiante de UTEC y tiene 23 años"

```{r}
# calculamos la probabilidad
P_B8 = y7/ytotal
P_B8
```

Evento B9 = "Se selecciona un estudiante de UTEC y tiene 24 años"

```{r}
# calculamos la probabilidad
P_B9 = y8/ytotal
P_B9
```

Evento B10 = "Se selecciona un estudiante de UTEC y tiene 25 años"

```{r}
# calculamos la probabilidad
P_B10 = y9/ytotal
P_B10
```

Evento B11 = "Se selecciona un estudiante de UTEC y tiene 26 años"

```{r}
# calculamos la probabilidad
P_B11 = y10/ytotal
P_B11
```

Evento B12 = "Se selecciona un estudiante de UTEC y tiene 31 años"

```{r}
# calculamos la probabilidad
P_B12 = y11/ytotal
P_B12
```

Evento B13 = "Se selecciona un estudiante de UTEC y tiene 36 años"

```{r}
# calculamos la probabilidad
P_B13 = y12/ytotal
P_B13
```

## Probabilidad condicional

A = "Seleccionar una persona en UTEC con una edad de 25 años"

Comprobamos el espacio muestral A: $$\Omega(A) = {\text{{"25 años"}}}$$

```{r}
# P(A) = x1/nrow(DF)
P_A <- y9/nrow(DF)
P_A
# P(A') = 1 - P(A)
1 - P_A
```

B = "Seleccionar una persona en UTEC cuya actividad pre desgasto sea mucho"

Comprobamos el espacio muestral B: $$\Omega(B) = {\text{{"Mucho"}}}$$

```{r}
# P(B) = y4/nrow(DF)
P_B <- x4/nrow(DF)
P_B
# P(B') = 1 - P(B)
1 - P_B
```

Procedemos a verificar la independencia o no independencia de estos dos eventos. Se dice que dos eventos A y B son **independientes** si y sólo si $$\mathbb{P}(A\cap B) = \mathbb{P}(A)\mathbb{P}(B)$$ o bien $$\mathbb{P}(B|A) = \mathbb{P}(B)$$ de otro modo los eventos son dependientes.

```{r}
# P(AnB) = P(A) + P(B) - P(A U B)
P_A_B <- P_A + P_B - nrow(DF %>% filter(Edad == 25 | Actividad.pre.desgasto =="Mucho"))/nrow(DF)
print(paste("P(AnB) =", round(P_A_B,4)))
print(paste("P(A) * P(B) =", round(P_A* P_B,4)))
# P(A|B)
print(paste("P(A) =", round(P_A,4)))
print(paste("P(A/B) =", round(P_A_B/P_A,4)))
# P(B|A)
print(paste("P(B) =", round(P_B,4)))
print(paste("P(B/A) =", round(P_A_B/P_B,4)))
```

Podemos observar que los eventos A y B son dependientes. Tiene sentido porque es posible que las personas más jóvenes (edad de 25 años) tengan más probabilidades de realizar actividades físicas intensas (actividad pre desgasto "mucho") en comparación con las personas de mayor edad.

C = "Seleccionar alguna persona de UTEC y que Actividad pre desgasto sea muy poco"

Comprobamos el espacio muestral C: $$\Omega(C) = {\text{{"Muy poco", "Poco", "Normal", "Regular", "Mucho"}}}$$ D = "Seleccionar alguna persona de UTEC y que el costo de su producto secundario elegido sea 1"

Comprobamos el espacio muestral D: $$\Omega(D) = {\text{{ 0, 1, 1.5, 2, 2.5, 2.9, 3, 5, 10}}}$$

```{r}
# Calcular_las_frecuencias_relativas cada uno 
frecuencias_relativas_actividad <- table(DF$Actividad.pre.desgasto) / nrow(DF[!is.na(DF$Actividad.pre.desgasto), ])
frecuencias_relativas_costo <- table(DF$Costo.unidad.producto.secundario) / nrow(DF[!is.na(DF$Costo.unidad.producto.secundario), ])

  
# Calcular la  probabilidad conjunta
prob_conjunta <- outer(frecuencias_relativas_actividad["Muy poco"], frecuencias_relativas_costo[1])

# Producto de las probabilidades individuales 
probabilidad_actividad <- frecuencias_relativas_actividad["Muy poco"]
probabilidad_costo <- frecuencias_relativas_costo[1]
prod_probabilidades <- probabilidad_actividad * probabilidad_costo
print(paste("La probabilidad de C es:", probabilidad_actividad))
print(paste("La probabilidad de D es:", probabilidad_costo))
print(paste("La probabilidad Conjunta es:", prob_conjunta))
print(paste("El producto de probabilidad de C y probabilidad de D es:", prod_probabilidades))
# Probabilidades condicionales
probabilidad_c_dado_d = prob_conjunta/probabilidad_costo
probabilidad_d_dado_c = prob_conjunta/probabilidad_actividad

print(paste("P(C|D) observamos que es igual a P(C):", probabilidad_c_dado_d))
print(paste("P(D|C) observamos que es igual a P(D):", probabilidad_d_dado_c))

# Comparar las probabilidades
if (all(round(prob_conjunta, 4) == round(prod_probabilidades, 4))) {
  print("La selección de 'Actividad pre desgasto' y el 'Costo del producto principal' son eventos independientes.")
} else {
  print("La selección de 'Actividad pre desgasto' y el 'Costo del producto principal' no son eventos independientes.")
}

```

-   Par de eventos dependientes: A y B
-   Par de eventos independientes: C y D

## Variable aleatorias discretas

### Variable 1 - Actividad.pre.desgaste

Se empleara la variable Actividad.pre.desgasto debido a que consideramos que es una de las variable más importantes en lo datos que tenemos recolectados y se utilizara la distribución binomial.

#### Distribución binomial (Actividad.pre.desgasto)

Experimento aleatorio base: Seleccionar al azar un estudiante del grupo de 154 estudiantes y observar su nivel Actividad.pre.desgaste.

El espacio muestral de Actividad.pre.desgasto $$\mathbb{\Omega} ={\text{{"Mucho","Regular","Normal","Poco","Muy poco"}}}$$

**Construimos la variable aleatoria:**

Por lo que definimos como **ÉXITO** si es "Mucho" o "Regular", esto indica que realizaron cierta cantidad de actividad considerablemente buena hasta llegar a sentir la fatiga. Lo denominaremos como **(Resistentes)**

Y como **FRACASO** si es "Normal","Poco" o "Muy poco", esto indica que realizaron cierta cantidad relativamente baja de actividad hasta llegar a sentir la fatiga. Lo denominaremos como **(No resistentes)**

$$\mathbb{X}:=\text{Numero de personas que son más RESISTENTES en un}\\ \text{ conjunto de 154 estudiantes de UTEC en el periodo 2023-1}$$

**Identificamos los parámetros:**

Sea: $\mathbb{X}\sim\mathsf{Bin}(n, \mathbb{P}(\text{son RESISTENTES}) )$

```{r}
#Total de observaciones
ytotal <- sum(!is.na(DF$Actividad.pre.desgasto))
print(paste("Definimos n como ", ytotal ,", ya es el numero de estudiantes muestreados y nos permite obtener una probabilidad empirica acerca del Experimento"))

#Probabilidad empírica de "Mucho", "Regular"
y1 <- nrow(DF %>% filter(Actividad.pre.desgasto =="Mucho"))
y2 <- nrow(DF %>% filter(Actividad.pre.desgasto == "Regular"))


print(paste("Probabilidad de observa un nivel de Actividad.pre.desgasto Mucho =",y1/ytotal))
print(paste("Probabilidad de observa un nivel de Actividad.pre.desgasto Regular =",y2/ytotal))


PResistentes <- round(y1/ytotal + y2/ytotal,4)
print(paste("Probabilidad de nuestro caso de EXITO denominado como (RESISTENTES) =", PResistentes))


```

-   n = 154 estudiantes de UTEC periodo 2023-1 encuestados
-   $\mathbb{P}(\text{son RESISTENTES})= 0.2143$

**Función de masa de probabilidad**

$p_\mathbb{X}(x)= (0:154,154,0.2143)$

```{r}
x<-c(0:154)
size = 154
probabilities <- dbinom( x, size, PResistentes)
plot(0:154, probabilities, type = "h",xlim = c(0,60), ylim = c(0,0.08), main = "FUNCION DE PROBABILIDAD (Distribución binomial)", ylab = "Probabilidades", xlab = "n (0:154)")
#Ponemos xlim(0,60) solo para que se observe mejor gráfico
```

**Validamos las propiedades**

```{r}

error_estandar <- sqrt(PResistentes * (1 - PResistentes) / ytotal)
valor_critico <- qnorm(0.975) 
margen_error <- valor_critico * error_estandar

limite_superior <- PResistentes + margen_error
limite_inferior <- PResistentes - margen_error

barplot(c(PResistentes),ylim = c(0, 1), names.arg = c("Resistentes"), main = "Intervalo de confianza de la 
        estimación de la proporción de Resistentes",
        xlab = "Categoría", ylab = "Proporción")
arrows(1, limite_inferior, 1, limite_superior, angle = 90, code = 3, length = 0.1)

#Suma Probabilidad = 1
suma_probabilidades <- sum(probabilities)
print(paste("Suma_probabilidades",suma_probabilidades))


valor_esperado_teorico <- size * PResistentes
proporcion_resistentes <- PResistentes
Valor_esperado_empirica <- ytotal * proporcion_resistentes
print(paste("Esperanza_teorica", valor_esperado_teorico))
print(paste("Esperanza_empirica",Valor_esperado_empirica))


desviacion_estandar_teorica <- sqrt(size * PResistentes * (1 - PResistentes))
print(paste("Desviacion_estandar_teorica",desviacion_estandar_teorica))


coeficiente_variacion <- (desviacion_estandar / valor_esperado_teorico)
print(paste("Coeficiente_variacion",coeficiente_variacion))
```

```{r}
print("En este caso la esperanza indica el numero promedio o numero esperado de alumnos RESISTENTES en un grupo de 154 estudiantes")
```

**EJEMPLO** - La universidad UTEC organiza un día de integración para los alumnos y del periodo 2023-1. El evento dura varias horas y los organizadores quieren saber cual es la probabilidad que más del 25% de los estudiantes asistentes sean RESISTENTES. Se sabe que al evento asistieron 80 estudiantes.

$\mathbb{P}(X>20)$

```{r}
probabilidadE <- round(pbinom(20, 80, PResistentes, lower.tail = FALSE),4)
print(paste("La probabilidad de que más del 25% de los estudiantes asistentes sean RESISTENTES es:", probabilidadE))
```

### Variable 2-Hora.desayuno

Se empleara la variable Hora.desayuno y se utilizará la distribución geométrica para este análisis.

#### Distribución geométrica (Hora.desayuno)

Experimento aleatorio base: Seleccionar al azar un estudiante del grupo de 154 estudiantes y observar la hora en la que toma desayuno.

En este caso el espacio muestral es:

$$
\mathbb{\Omega} = \text{00:00, 05:00, 05:30, 05:40, 06:00, 06:10, 06:15,} \\ 
\text{06:20, 06:30, 07:00, 07:15, 07:20, 07:30, 07:40, 08:00, 08:05, 08:20,} \\
\text{08:30, 08:40, 08:50, 09:00, 09:10, 09:30, 09:40, 10:00, 10:30, 10:45, 11:00, 12:00}
$$

**Construimos la variable aleatoria:**

Por lo que definimos como **ÉXITO** si es desayuna entre las 6:00 y las 8:00, esto indica que desayunan a una hora adecuada del día hablando objetivamente. **(HORA_ADECUADA)**

Y como **FRACASO** cualquier hora fuera del rango 6:00 y 8:00. Lo denominaremos como **(HORA_NO_ADECUADA)**

(Recordar que la hora esta en formato de 24horas)

$$
\mathbb{X} := \text{Número de personas que desayunan en una HORA\_ADECUADA} \\ 
\text{en un conjunto de 154 estudiantes de UTEC en el periodo 2023-1
$$

**Identificamos los parámetros:**

Sea:

$$
\mathbb{X}\sim\mathsf{Geom}(n, \mathbb{P}(\text{desyunan en una HORA\_ADECUADA}) )
$$

```{r}
ytotalHoradesyuno <- sum(!is.na(DF$Hora.desayuno))
print(paste("Definimos n como ", ytotalHoradesyuno ,", ya es el numero de estudiantes muestreados"))

horas <- c("06:00", "06:10", "06:15", "06:20", "06:30", "07:00", "07:15", "07:20", "07:30", "07:40", "08:00")
probabilidades <- numeric(length(horas))

#Probabilidad de cada hora
for (i in 1:length(horas)){
  y <- nrow(DF %>% filter(Hora.desayuno == horas[i]))
  probabilida_casos <- y/ytotal
  print(probabilida_casos)
  probabilidades[i] <- probabilida_casos
}

# Probabilidad de HORA ADECUADA
HORA_ADECUADA <- round(sum(probabilidades),4)
print(paste("Probabilidad_de__desayuna_en_HORA_ADECUADA: ",HORA_ADECUADA))
```

-   n = 154 estudiantes de UTEC periodo 2023-1 encuestados
-   $\mathbb{P}(\text{desayunan en una HORA\_ADECUADA})= 0.487)$

**Función de probabilidad** $p_\mathbb{X}(x)= (154,0.487)$

```{r}
x1<-c(0:154)
probabilitiesg <- dgeom( x1, HORA_ADECUADA)
plot(0:154, probabilitiesg, type = "h",xlim=c(1,10), ylim = c(0,0.5), main = "FUNCION DE PROBABILIDAD (Distribución geométrica)", ylab = "Probabilidades", xlab = "n (0:154)")
```

Esto es algo bueno, ya que los estudiantes toman desayuno a una hora relativamente adecuada. Ya que cada vez es más difícil un alumno que desayuno en una HORA ADECUADA sea el primer éxito. Significa que los alumnos suelen tomar desayuno en una HORA ADECUADA.

**Validar propiedades de la distribución geométrica**

```{r}
suma_probabilidades_geom <- sum(probabilitiesg)
print(paste("Suma_probabilidades_geom:", suma_probabilidades_geom))

valor_esperado_geom <- 1 / HORA_ADECUADA
print(paste("Esperanza_teorica_geometrica:", valor_esperado_geom))

desviacion_estandar_geom <- sqrt((1 - HORA_ADECUADA) / (HORA_ADECUADA^2))
print(paste("Desviacion_estandar_geom:", desviacion_estandar_geom))

coeficiente_variacion_geom <- (desviacion_estandar_geom / valor_esperado_geom) * 100
print(paste("Coeficiente_variacion_geom:", coeficiente_variacion_geom))

varianza <- (1 - HORA_ADECUADA) / HORA_ADECUADA^2
print(paste("varianza",varianza))
```

**EJEMPLO** - En un evento organizado por la universidad UTEC en el periodo 2023-1, asistieron 80 estudiantes. Se desea calcular la probabilidad de que en ese evento se tenga que encuestar a 4 estudiantes asistentes o menos para encontrar a alguien que tomo desayuno a una HORA_ADECUADA.

$$
\mathbb{P}(X<4)
$$

```{r}
probabilidadEG <- round(pgeom(4, HORA_ADECUADA, lower.tail = TRUE),4)
print(paste("La probabilidad de que se tenga que encuestar a 4 estudiantes asistentes o menos para encontrar a alguno que tomo desayuno a una HORA_ADECUADA es:", probabilidadEG))
```

## Variable aleatorias continuas

### Variable 1-Tiempo.pre.desgaste

#### Identificar gráficamente

```{r}
plot(density(DF$Tiempo.pre.desgaste, na.rm = TRUE), main = "Funcion de densidad de Tiempo.pre.desgaste",
     xlab = "Tiempos.pre.desgaste (cantidad de horas)", ylab = "Densidad", xlim=c(0,20), col = "blue")
```

**Ahora tenemos la gráfica de la densidad de la variable**

Asumimos que se asemeja a una distribución normal para 0 \< x \< 9

**Entonces ahora podemos trabajar con:**

```{r}
rango <- c(0, 9)  # Define el rango de interés

datos_rango <- DF$Tiempo.pre.desgaste[DF$Tiempo.pre.desgaste >= 0 & DF$Tiempo.pre.desgaste <= 9 & !is.na(DF$Tiempo.pre.desgaste)]

#Densidad de datos obtenidos
plot(density(datos_rango), main = "Función de densidad { 0 <= x <= 9}",
     xlab = "Tiempo.pre.desgaste (cantidad de horas)", ylab = "Densidad", col = "red")

x <- seq(0, 10, 0.1)

#Datos necesarios:
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

#Densidad de distribución normal
plot(dnorm(x, mean = media, sd = desviacion), main = "Función de densidad Distribucion normal{ 0 <= x <= 9}",
     xlab = "Tiempo.pre.desgaste (cantidad de horas)", ylab = "Densidad", col = "red", type = "l")

```

**VALIDAMOS** Por lo que, asumiendo que se trata de una distribución normal, entonces podemos validar lo siguiente para el rango establecido.

```{r}
media <- mean(datos_rango)
desviacion <- sd(datos_rango)

longitud <- length(datos_rango)
tabla_frecuencias <- table(datos_rango)
probabilidades <- tabla_frecuencias / longitud

suma_cuadrados <- sum((datos_rango - media)^2)
varianza <- suma_cuadrados / (length(datos_rango) - 1)

print(paste("Media =", media, "| Mediana =", median(datos_rango)))
print(paste("Varianza =", varianza, "| sd^2 =", desviacion^2))

plot(x, pnorm(x, mean = media, sd = desviacion), type= "l", col = "red", main = "Función de Distribución de Probabilidad",
      xlab = "Tiempo.pre.desgaste (cantidad de horas)",
      ylab = "Probabilidad")
```

**EJEMPLO** Calculamos la probabilidad de que el Tiempo.pre.desgaste sea mayor que 3 horas al encuestar a algún estudiante.

$$
\mathbb{P}(X>3)
$$

```{r}
probabilidad <- 1 - pnorm(3, mean = media, sd = desviacion, lower.tail = FALSE)
print(paste("Probabilidad de P(x > 3):", probabilidad))
```

### Variable 2-Costo.producto.secundario

#### Identificar gráficamente

```{r}
plot(density(DF$Costo.unidad.producto.secundario, na.rm = TRUE), main = "Función de densidad (Costo.producto.secundario)",
     xlab = "Costo.producto.secundario (Soles)", ylab = "Densidad", xlim=c(0,10), col = "blue")
```

**Ahora tenemos la gráfica de la densidad de la variable** Ya que se asemeja a una distribución exponencial para 0 \<= x \<= 10

**Entonces ahora podemos trabajar con el ajuste de la distribución exponencial**

Asumiendo que se asemeja a una distribución exponencial, entonces podemos validar lo siguiente.

```{r}
datos_rango_exponencial <- DF$Costo.unidad.producto.secundario[!is.na(DF$Costo.unidad.producto.secundario)]

lambda <- 1 / mean(datos_rango_exponencial)  # Calcular el parámetro lambda

x <- seq(0, max(datos_rango_exponencial) + 1, length.out = 100)

# Densidad de la distribución exponencial
densidad_exponencial <- dexp(x, rate = lambda)

plot(x, densidad_exponencial, type = "l", main = "Función de Densidad de Distribución Exponencial", xlab = "Valores", ylab = "Densidad", col = "blue", lwd = 2)
```

**VALIDAMOS**

(Asumiendo el ajuste)

```{r}
media_observada <- mean(datos_rango_exponencial)
desviacion_observada <- sd(datos_rango_exponencial)

media_teorica <- 1 / lambda
varianza_expo <- 1/ (lambda*lambda)
desviacion_teorica_exponencial <- varianza_expo*varianza_expo

print(paste("Media observada:", media_observada))
print(paste("Desviación estándar observada:", desviacion_observada))

print(paste("Media teórica:", media_teorica))
print(paste("Desviación estándar teórica:", desviacion_teorica_exponencial))

#F. Distribucion exponencial acumulada
funcion_exponencial <- pexp(x, rate = lambda)

plot(x, funcion_exponencial, type = "l", main = "Función de probabilidad de Distribución Exponencial",
     xlab = "Valores", ylab = "Probabilidad", col = "blue", lwd = 2)
```

**EJEMPLO**

Cual es la probabilidad que el el Costo.producto.secundario que un estudiante encuestado consume es mayor a 3 soles.

$$
\mathbb{P}(X>3)
$$

```{r}
probabilidad <- pexp(3, rate = lambda, lower.tail = FALSE)
print(paste("Probabilidad de que el costo sea mayor a 3 soles:", probabilidad))
```
