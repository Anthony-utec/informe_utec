---
title: "Análisis comparativo del uso entre billeteras digitales y dinero en efectivo"
date: "2023-07-06"
institute: "UTEC"
output: 
  xaringan::moon_reader:
    CSS: [default, metropolis, metropolis-fonts]
    lib_dir: libs
    nature: 
      highlightStyle: arta
      highlightlines: true
      countINcrementalSlides: false
---

```{r setup, include=FALSE}
options( 
  htmltools.dir.version  = FALSE,
  htmltools.preserve.raw = FALSE
)
if (!require("readr")) {
  install.packages("readr")
}
library(readr)
if (!require("plyr")) {
  install.packages("plyr")
}
library(plyr)
if (!require("dplyr")) {
  install.packages("dplyr")
}
library(dplyr)
if (!require("ggplot2")) {
  install.packages("ggplot2")
}
library(ggplot2)
if (!require("plotly")) {
  install.packages("plotly")
}
library(plotly)

if (!require("rriskDistributions")) {
  install.packages("rriskDistributions")
}
library(rriskDistributions)

if (!require("fitdistrplus")) {
  install.packages("fitdistrplus")
}
library(fitdistrplus)

if (!require("xaringan")) {
  install.packages("xaringan")
}
library(xaringan)
```


class: bottom ,center
#### **Introducción**  
Las billeteras digitales han emergido como nuevas tecnologías en Perú desde hace varios años, destacándose Yape y Plin como las más reconocidas. La practicidad y rapidez que ofrecen estas billeteras digitales han impulsado su amplia aceptación entre la población peruana.En consecuencia, resulta sumamente interesante investigar y comprender qué medio de pago predomina en la preferencia de los usuarios: ¿Las billeteras digitales o el dinero en efectivo? Este estudio se enfoca en analizar a estudiantes de la Universidad de Ingeniería y Tecnología (UTEC), con el objetivo de examinar las diferencias en el uso que le dan a estos dos medios de pago y los factores que influyen en su elección.  
 
#### **Objetivos**
1) Utilizar probabilidad empírica para comprender por qué las personas prefieren usar billeteras digitales y saber si están satisfechas o no al usar una billetera digital.  
2) Utilizar probabilidad condicional y gráficos de mosaico para comprender cómo ciertos factores pueden influir en las preferencias de las personas en relación al uso de las billeteras digitales, lo que nos permitirá comprender mejor qué aspectos o factores son relevantes en la adopción de las billeteras digitales.  
3) Utilizar modelos probabilísticos para comprender las características y tendencias asociadas con el uso de las billeteras digitales en comparación con el efectivo.  

```{r}
library(readr)
library(dplyr)
library(ggplot2)
BD<-read.csv("BD_billeteras_limpia_final.csv")
ubd<-filter(BD, Billetera_principal!="No uso billeteras digitales")

```
---
class: bottom ,center
### Descriptores gráficos

```{r, echo=FALSE,comment="",out.width = '350px'}
mosaicplot(table(ubd$Billetera_principal, ubd$Razon_billetera), color = c("#1F77B4", "#2CA02C", "#FF7F0E"), main="Comparación del grado de satisfacción en billeteras digitales",)
```

- Un patrón notable es que las proporciones entre las razones para usar una billetera digital como alternativa para el dinero en efectivo se mantienen en los dos aplicativos.Eso último podría indicar una independencia de eventos visto desde un análisis probabilístico.    
---
class: bottom ,center
```{r, echo=FALSE, comment="",out.width = '350px'}
mosaicplot(table(ubd$Billetera_principal, ubd$Satisfaccion_billetera), ylab=" Nivel satisfacción", xlab= "Billeteras digitales más usadas: Plin y Yape", color=c("#377EB8", "#4DAF4A"), main="Grado de satisfacción de usuarios con billeteras digitales")
```
 
- Se observa una diferencia entre las proporciones de **nivel de satisfacción** dependiendo si es **Yape** o **Plin**.Este último patrón podría indicar una dependencia de eventos visto desde un análisis probabilístico.  

---
## Analisis Probabilístico
### Variable: Razón principal por la que una persona usa billeteras digitales

Buscamos los resultados y frecuencias absolutas asociados a esta variable `razón principal para usar billetera digital`.  

#### **Espacio de resultados**  
El espacio muestral asociado al experimento mencionado es el siguiente:  
$$\Omega = \{Más Costumbre\ ,Rapidez\ ,Registrar Gastos \}$$


#### **Cálculo de las probabilidades de los eventos atómicos**


```{r,echo=FALSE,comment=""}
#Mediante comandos de Rstudio  
prob_razon_uso_billetera<-data.frame(round(prop.table(table(ubd$Razon_billetera)), 3))
names(prob_razon_uso_billetera)<-c("Evento atómico", "Probabilidad empírica")
prob_razon_uso_billetera
```

---
## Variable: Nivel de satisfacción en billeteras digitales  

Buscamos los resultados y frecuencias absolutas asociados a esta variable.  


### Espacio de resultados  

$$\Omega = \{satisfecho\ ,\ neutro\}$$
### Cálculo de las probabilidades de los eventos atómicos  
Se realiza de manera análoga al caso anterior.
```{r,echo=FALSE,comment=""}
#Mediante comandos de Rstudio  
prob_razon_uso_efectivo<-data.frame(round(prop.table(table(ubd$Satisfaccion_billetera)), 3))
names(prob_razon_uso_efectivo)<-c("Evento atómico", "Probabilidad empírica")
prob_razon_uso_efectivo
```
---
## **PROBABILIDAD CONDICIONAL.**
#### EVENTOS DEPENDIENTES:
Se definen los siguientes eventos:    
Y: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y use **Yape** como billetera digital principal.    
P: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y use **Plin** como billetera digital principal.   
N: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y su nivel de satisfacción sea **neutro**.    
S: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y su nivel de satisfacción sea **satisfecho**.    

Se calculas las probabilidades:  

```{r,echo=FALSE,comment=""}
N = nrow(ubd)
Y = nrow(filter(ubd, Billetera_principal=="Yape"))/N
P = nrow(filter(ubd, Billetera_principal=="Plin"))/N
N = nrow(filter(ubd, Satisfaccion_billetera=="Neutro"))/N
S = nrow(filter(ubd, Satisfaccion_billetera=="Satisfecho"))/nrow(ubd)
#print(paste("Probabilidades:")
```
En este caso vamos a demostrar que los eventos **Y** y **S** son dependientes.  
```{r,echo=FALSE,comment=""}
YUS = nrow(filter(ubd, Billetera_principal=="Yape", Satisfaccion_billetera=="Satisfecho"))/nrow(ubd)
paste("P(Y): ", round(Y,2))
paste("P(S): ", round(S,2))
paste("P(YUS): ", round(YUS,2))
paste("Son independientes: ", round(YUS,2)==round(Y*S,2) )
```
Comprobamos que no son independientes, por ello, vamos a calcular la probabilidad condicional.  
- La probabilidad de que un estudiante tenga nivel de satisfacción **satisfecho** con la billetera digital que usa, Dado que su principal billetera digital es **yape**.  
```{r,echo=FALSE,comment=""}
print(paste("P(S|Y): ", round( YUS/Y,2)))
print(paste("P(S): ", round(S,2)))
print(paste("Se aprecio la diferencia entre la probabilidad condicional y la probabilidad del evento"))
```
Estos eventos llegara ser dependientes, ya que hay varios factores que influyen en la percepción de la satisfacción, por ejemplo, problemas de conexión, estafas, entre otros. Se comprobo lo observabo en el mosaico.
---
#### EVENTOS INDEPENDIENTES:
Se definen los siguientes eventos:  
Y: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y use **Yape** como billetera digital principal.  
P: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y use **Plin** como billetera digital principal.   
M: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y su principal razón para usar billeteras digitales es **Más costumbre**.  
R: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y su principal razón para usar billeteras digitales es **rapidez**.  
G: Seleccionar un estudiante de UTEC que es cliente de billeteras digitales y su principal razón para usar billeteras digitales es **registrar gastos**.  
```{r,echo=FALSE,comment=""}
N = nrow(ubd)
Y = nrow(filter(ubd, Billetera_principal=="Yape"))/N
P = nrow(filter(ubd, Billetera_principal=="Plin"))/N
M= nrow(filter(ubd, Razon_billetera=="Más costumbre"))/N
R=nrow(filter(ubd, Razon_billetera=="Rapidez"))/N
G=nrow(filter(ubd, Razon_billetera=="Registrar gastos"))/N
YUR = nrow(filter(ubd, Razon_billetera=="Rapidez", Billetera_principal=="Yape"))/nrow(ubd)
print(paste("Tenemos que la P(Y): ",round(Y,2)))
print(paste("Tenemos que la P(R): ", round(R,2)))
print(paste("Tenemos que la P(Y U R): ",round(YUR,2) ))
print(paste("Son independientes: ", round(YUR,2)==round(Y*R,2)))
YUG = nrow(filter(ubd, Razon_billetera=="Registrar gastos", Billetera_principal=="Yape"))/nrow(ubd)
YUM = nrow(filter(ubd, Razon_billetera=="Más costumbre", Billetera_principal=="Yape"))/nrow(ubd)
print(paste("Tenemos que la P(G): ", round(G,2)))
print(paste("Tenemos que la P(Y U G): ",round(YUG,2) ))
print(paste("los eventos Y e G son independientes: ", round(Y*G,3)==round(YUG, 3) ))
print(paste("Tenemos que la P(M): ", round(M,2)))
print(paste("Tenemos que la P(Y U M): ",round(YUM,2) ))
print(paste("los eventos Y e M son independientes: ", round(Y*M,2)==round(YUM, 2)))
```
Interpretación: La razón principal por la que una persona llega a usar una billetera digital como medio de pago es independiente de la marca de billetera digital que va usar(yape o plin). Esto está relacionado a que las billeteras digitales tienen las mismas funcionalidades y permiten las mismas actividades económicas, por ello estos eventos llegan a tener esa independencia. Se confirmo lo observado en el mosaico.  
---
### **Variables aleatorias discretas**  
#### **Análisis de distribución binomial**
**Experimento aleatorio:** Escoger una muestra de 159 estudiantes
encuestados de UTEC y se cuenta el número de estudiantes que cuentan
mínimo con una billetera digital. 
.pull-left[
**Éxito:** estudiante seleccionado cuenta con al menos una billetera
digital. ] 
.pull-right[
**X**: número de personas que cuentan con al menos una billetera digital
en 159 encuestados]  

class: bottom ,center
```{r, echo=FALSE, comment="",out.width = '320px'}
#Probabilidad de éxito 
p= nrow(BD %>% filter(Billetera_principal != "No uso billeteras digitales"))/nrow(BD)
n= nrow(BD)
rango_valores <-0:nrow(BD)
par(fig = c(0, 1, 0, 1), mar = c(5, 5, 4, 2) + 0.1)
plot(100:150 , dbinom(100:150, n, p), type = 'h', lwd = 2, xlab = "Número de éxitos", ylab = "Probabilidad", main = "Distribución Binomial")
```
---
### **Variables aleatorias continuas**  
#### **Análisis de distribución normal**  
**Definimos la variable aleatoria continua**  
$$ X = gasto\ diario\ promedio\ en\ soles\ de\ un\ estudiante\ de\ UTEC\ que\ es\ cliente\ de\ billeteras\ digitales\ $$
**Rango asociado a esta variable aleatoria**  
$$ Rx \in [1; 44]$$
class: bottom ,center
```{r,echo=FALSE,comment="",out.width = '320px'}
# Cargar la base de datos
datos <- BD
# Filtrar los datos de Gasto_diario_billetera
datos_filtrados <- subset(datos, Billetera_principal != "No uso billeteras digitales")
gasto_diario <- datos_filtrados$Gasto_diario_billetera
# Crear la tabla de densidad
densidad <- density(gasto_diario)
# Crear un dataframe con los valores de la densidad
df_densidad <- data.frame(x = densidad$x, y = densidad$y)
# Crear el gráfico de densidad
ggplot(df_densidad, aes(x = x, y = y)) +
  geom_line(color = "#FF4C4C", linewidth = 1.5) +
  labs(x = "X(gasto diario promedio en soles)", y = "Densidad de probabilidad") +
  ggtitle("Gráfica de densidad de la variable aleatoria") +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank()
  )
```
 
---
**Criterios para validar el modelo de distribución normal**  
**Primer criterio:**  
$$Media \approx Media$$ 
En base a los cálculos previos tenemos que la media se aproxima a la mediana:  
$$20 \approx 19.5$$
**Segundo criterio:**  

$$20 \approx 19.5$$
Se observa una diferencia insignificante de los decimales. Esto no es tan sobresaliente en nuestro análisis del modelo de distribución normal, ya que como se comento se debe a factores como la realización empírica del experimento.  

**Tercer criterio:**  
$$ 10.3 \approx 10.3$$
Se tiene que la variable aleatoria continua cumplió los criterios de comparar descriptores como la mediana, media y desviación estándar, lo cual sugiere analizar el modelo como una distribución normal.  

---

# Conclusiones
- 1: Se pudo utilizar y aplicar adecuadamente conceptos como eventos atómicos, espacio muestral, función de probabilidad, probabilidad condicional y variable aleatoria.
- 2: Se relacionó gráficas como el mosaico para poder identificar posibles eventos dependiente e independientes que fueron aproximados usando probabilidad empírica.  
- 3: Se determino modelos de distribución para variables aleatorias continuas y discretas, esto basado en probabilidades empíricas, las cuales, bajo criterios de comparación y descriptores como media, mediana y desviación estándar permitieron validar ciertos modelos como la distribución normal.

