---
title: 'Análisis de la demanda de los universitarios respecto a la implementación de cajeros automáticos dentro de UTEC'
author: "Grupo 1"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
  pdf_document:
    toc: yes
  html_document:
    toc: yes
    df_print: paged
    
---
# **Alumnos del grupo:**

| Alumno  | código  | correo  | Porcentaje de trabajo |
|:--------------:|:-------:|:-----------:|:-----|
| Rosario Melina Vidal Asto  | 202120600 | rosario.vidal@utec.edu.pe  | 100% |
| María Guadalupe Portales Santillán| 202120739    | maria.portales@utec.edu.pe   | 100% |
| Alessander del Piero Lopez Mesones| 202120335    | alessander.lopez@utec.edu.pe | 100 %|
| Jimena Adela Gurbillon Santa Cruz | 202210153| jimena.gurbillon@utec.edu.pe|100%|
| Flor Lucero Huaman Lopez| 202120270 | flor.huaman@utec.edu.pe |100%|

# **Introducción**

El *Tema* que escogimos esta relacionado con *los Estudiantes y las entidades bancarias* ya que planeamos hacer un analisis de la demanda de los universitarios de segundo ciclo en adelante respecto a implementar cajeros automáticos dentro de la UTEC. 

## **Relevancia**

En el distrito de Barranco, los estudiantes de la UTEC enfrentan desafíos como horarios restrictivos, inseguridad y otros factores que dificultan el acceso a servicios financieros. La instalación de cajeros automáticos en la universidad se considera como una solución para mejorar la accesibilidad y conveniencia, pero es necesario evaluar la disponibilidad de cajeros en la zona y si cumplen con las necesidades de los estudiantes. Además, se deben tener en cuenta la infraestructura existente en la UTEC, las preferencias y hábitos financieros de los estudiantes, a fin de determinar la viabilidad de esta implementación, para mejorar la experiencia estudiantil y satisfacer sus necesidades financieras de manera efectiva.

## **Objetivos**

  + GENERAL:
    + Evaluar factibilidad social de la implementación de cajeros automáticos dentro de la UTEC a través de la demanda y preferencia bancaria del alumnado.

  + ESPECÍFICOS:
    + Determinar si facilita al estudiante el retiro de dinero en efectivo    
    + Determinar si facilita al estudiante las transacciones bancarias
    + Identificar la preferencia bancaria del alumnado 
    + Determinar la necesidad del alumno por los cajeros 

## **Contexto**
Se desarrollará el tema propuesto usando conceptos de Estadística para definir nuestra población, una muestra de ella, describiéndola mediante variables útiles para hallar conclusiones, más adelante, analizando los datos, obteniéndolos primero gracias al ambiente de Rstudio y sus comandos. Utilizamos la definición de desviación estándar para analizar la dispersión de los datos en cada variable. También la correlación de relaciones bi-variables, en la cual, ambas variables deben ser agrupadas de forma homogénea para un mayor sentido.
  

# **Datos**
## **Proceso de recolección de datos**

En primer lugar, difundimos el enlace del formulario entre nuestros conocidos y lo compartimos en plataformas de redes sociales como WhatsApp e Instagram. Posteriormente, compartimos la encuesta con nuestros compañeros de clase, quienes accedieron a completarla a cambio de que nosotros llenemos la suya. Además, decidimos visitar los pisos donde se congregan los estudiantes, proporcionando un código QR para acceder a la encuesta. Aprovechamos eventos con alta concurrencia, como el bailetón celebrado el 28/04/2023.
Los miembros del equipo nos acercábamos a los estudiantes y les preguntabamos:
¿Posee usted alguna cuenta bancaria?
Con esta pregunta evaluábamos si el estudiante cumplía con los requisitos necesarios para formar parte de nuestra muestra y, por ende, para completar el formulario.

Mediante estas estrategias, buscamos de manera formal obtener la participación de estudiantes que contaran al menos con una cuenta bancaria, con el objetivo de recopilar datos a través de nuestro formulario.

## **Población, muestra y muestreo** 

Método: Muestreo por conveniencia
Población: Estudiantes universitarios de UTEC.
Muestra: 150 estudiantes universitarios de segundo ciclo en adelante de UTEC que tengan al menos una cuenta bancaria. 
Unidad muestral: Cada universitario de UTEC de segundo ciclo en adelante que tenga al menos una cuenta bancaria.

# **Variables** 

  + Discretas 
      + Cantidad de tarjetas utilizadas por cada alumno,(entero positivo) 
      + Número de cuentas afiliadas al banco más usado de cada alumno,(entero positivo)  
      + Número de veces que van de la UTEC al cajero más cercano, en una semana,(entero positivo) 
      + Edad,(mayor de 16 menor de 40) 
   
  + Continuo  
      + Tiempo invertido en minutos en ir de la UTEC al cajero más cercano,(positivo)
      + Promedio de dinero retirado en soles en cada visita al cajero más cercano de la UTEC, (positivo)
      + Promedio de dinero retirado en soles en el cajero más cercano a la UTEC, en una semana, (positivo)

  + Nominal  
      + Nombres de los bancos afiliados por alumno
      + Titular de la tarjeta   
      + Razón para ir en determinado horario al cajero

  + Ordinal  
      + Ciclo que cursa actualmente, mayor o igual a segundo ciclo
      + Frecuencia con la que utilizan las tarjetas a la semana.
      + Frecuencia con la que retiran dinero cerca de la UTEC.
      + Frecuencia con la que depositan dinero cerca de la UTEC.
      + Frecuencia con la que retiran dinero cerca de su domicilio u otro lugar.
      + Frecuencia con la que depositan dinero cerca de su domicilio u otro lugar.
      + Horario más frecuente donde van al cajero más cercano de la UTEC.
      + seguridad realizando operaciones bancarias desde la UTEC.
      + Deseo de un cajero automático en la universidad.
      


## **Limpieza de datos:**
```{r}
install.packages('viridisLite') 
install.packages("plotrix")

library(dplyr)
library(tidyverse)
library(viridis)
library(ggplot2)
library(RColorBrewer)
library(plotrix)
```

Para la limpieza de datos vemos como se han guardado los datos en el excel.
```{r, collapse = TRUE}
library(readr)
```
Segundo cargamos el archivo en la variable DC que son las iniciales de Data Cajeros
```{r}
DC<-read_csv("DataCajeros1.csv")
DC
```
Observamos las categorías y nombres de las variables
```{r, collapse = TRUE}
glimpse(DC)
```
En los datos registrados observamos que hay variables que están como numéricas cuando deberían ser categóricas.
Para facilitar el proceso de cambio, reemplazare los de nombres a las variables y renombramos la modificación a DC1, que son las iniciales de Data Cajeros 1

```{r, collapse = TRUE}
DC1 <- rename(DC, Ciclo  = `Ciclo que cursas actualmente \n`, Edad= `Edad:`, Número_de_tarjetas= `¿Cuántas tarjetas utilizas?`, Número_de_cuentas = `¿Cuántas cuentas tienes afiliadas a un mismo banco?`, Veces_en_la_semana_que_va_al_cajero = `A la semana, ¿Cuántas veces vas de UTEC al cajero  más cercano?`, Tiempo_de_demora = `¿Cuánto tiempo usualmente te demoras en ir de UTEC al cajero más cercano? (en minutos)`, Dinero_retirado = `En cada visita al cajero más cercano UTEC, ¿Cuánto dinero retiras aproximadamente?`, Dinero_retirado_semanalmente = `En una semana, ¿Cuánto dinero retiras aproximadamente en el cajero más cercano?`,Bancos = `¿A qué bancos estas afiliado?`, Titular = `¿Quién es el titular de la tarjeta que más utilizas?`,Frecuencia_de_retiro_cerca_de_UTEC  = `[¿Con qué frecuencia retiras dinero cerca de la UTEC?]`, Frecuencia_de_depósito_cerca_de_UTEC= `[¿Con qué frecuencia realizas depósitos cerca de la UTEC?]`,Frecuencia_de_retiro_en_otro_lugar = `[¿Con qué frecuencia retiras dinero cerca de tu domicilio u otro lugar?]`,Frecuencia_de_depósito_en_otro_lugar  = `[¿Con qué frecuencia realizas depósitos cerca de tu domicilio u otro lugar?]`, Horario_para_ir_al_cajero_más_cercano= `¿Qué horario sueles usar para ir al cajero mas cercano de UTEC?`,Razón_del_horario  = `¿Porqué sueles usar ese horario para ir al cajero?`, Seguridad  = `¿Cómo te sentirías realizando las operaciones bancarias desde la UTEC? -`,Deseo_de_la_opción_de_retiro_o_deposito= `¿Te gustaría tener la opción de realizar retiros o depósitos desde un cajero automático sin salir de la universidad?`, Deseo_de_un_cajero_automático =`¿Qué tanto deseas un cajero automático en UTEC?`) 
```
Visualizamos DC1:
```{r, collapse = TRUE}
glimpse(DC1)
```
Para realizar el cambio empleamos **as.character()**:
```{r, collapse = TRUE}
DC1$Ciclo<- as.character(DC1$Ciclo)
DC1$Seguridad<- as.character(DC1$Seguridad)
DC1$Deseo_de_la_opción_de_retiro_o_deposito<- as.character(DC1$Deseo_de_la_opción_de_retiro_o_deposito)
DC1$Deseo_de_un_cajero_automático<- as.character(DC1$Deseo_de_un_cajero_automático)

```
También, variables que figuran como variables decimales, cuando deberían ser enteros.Emplearemos **as.integer()**:
```{r, collapse = TRUE}
DC1$Edad<- as.integer(DC1$Edad)
DC1$Número_de_tarjetas<- as.integer(DC1$Número_de_tarjetas)
DC1$Número_de_cuentas<- as.integer(DC1$Número_de_cuentas)
DC1$Veces_en_la_semana_que_va_al_cajero<-as.integer(DC1$Veces_en_la_semana_que_va_al_cajero)
DC1$Tiempo_de_demora<-as.integer(DC1$Tiempo_de_demora)
```
 
Para nuestro análisis no trabajaremos con la marca temporal ni el correo institucional ya que no competen a nuestro estudio y son variables que se guardaron por defecto en el excel.

Emplearemos la función **select** y lo guardamos en Data Cajeros 1 Selección (DC1S)
```{r, collapse = TRUE}
DC1S<-select(DC1,Ciclo:Deseo_de_un_cajero_automático )
```

**Procedemos a limpiar cada variable**

Verificamos los datos registrados en nuestras variables categóricas de respuesta abierta

*Limpiamos la variable bancos*
Usaremos el comando **unique** para ver las respuestas que tenemos:
```{r, echo=FALSE, message=FALSE}
unique(DC1S$Bancos)
```
Observamos que Tunometecabrasaramanbichen, Agora, Falabella y Diners no corresponden a bancos por ende pasaremos a contarlos como  No válido:
```{r, echo=FALSE, message=FALSE}
fila <- which(DC1S[, 9] == "Tunometecabrasaramanbiche")
columna <- 9
DC1S[fila, columna] <- "No válido"

fila <- which(DC1S[, 9] == "BCP, Agora")
columna <- 9
DC1S[fila, columna] <- "BCP, No válido"

fila <- which(DC1S[, 9] == "BCP, BBVA, Falabella")
columna <- 9
DC1S[fila, columna] <- "BCP, BBVA, No válido"

fila <- which(DC1S[, 9] == "BCP, Scotiabank, Diners")
columna <- 9
DC1S[fila, columna] <- "BCP, Scotiabank,No válido"

fila <- which(DC1S[, 9] == "BCP,")
columna <- 9
DC1S[fila, columna] <- "BCP"

```
Observamos el cambio 
```{r, collapse = TRUE}
unique(DC1S$Bancos)
```

*Limpiamos razón_del_horario*

```{r, echo=FALSE, message=FALSE}
#Vemos los datos que tenemos
unique(DC1S$Razón_del_horario)
```
*_Criterio para la limpieza_*

*"Mayor privacidad"*= "Evitar el horario pico : Mayor privacidad"  
*"Comodidad"* = "Menos calor(brillo solar)" ="La cajera me gusta"   
*Cubrir gastos*="Cubrir gastos diarios de alimentos" =  "Porque necesito dinero."     
*"Tiempo libre" *= "cuando tenga tiempo"  == "Porque tengo hora libre de los cursos de ese día." ==  "Tiempo libre (sin clases)"          
*"Seguridad"*= "Seguridad"
*"No válido"*= "Para dormir" = "No voy al cajero" 

Cambiamos los nombres:
```{r, collapse = TRUE}
DC1S<-mutate(DC1S, Razón_del_horario = case_when( Razón_del_horario=="Menos calor(brillo solar)" ~ "Comodidad", Razón_del_horario=="Evitar el horario pico : Mayor privacidad" ~ "Mayor privacidad", Razón_del_horario=="Cubrir gastos diarios de alimentos" ~ "Cubrir gastos", Razón_del_horario=="Porque necesito dinero." ~ "Cubrir gastos",Razón_del_horario=="Tiempo libre (sin clases)" ~ "Tiempo libre",Razón_del_horario=="cuando tenga tiempo" ~ "Tiempo libre", Razón_del_horario=="Porque tengo hora libre de los cursos de ese día." ~ "Tiempo libre",Razón_del_horario=="Seguridad" ~ "Seguridad", Razón_del_horario=="Para dormir" ~ "No válido", Razón_del_horario=="La cajera me gusta" ~ "Comodidad" ,Razón_del_horario=="No voy al cajero" ~ "No válido" , Razón_del_horario=="Tiempo libre" ~ "Tiempo libre",Razón_del_horario=="Comodidad" ~ "Comodidad"))
```

*Limpieza de las variables numéricas*
*Limpiamos Tiempo_de_demora, Dinero_retirado y Dinero_retirado_semanalmente*

Corremos **scipen** para ver todo en el formato normal,ya que hay respuestas mayores a 6 dígitos que se visualizan en el excel con notación científica.

```{r, echo=FALSE, message=FALSE}
options(scipen = 999)
```
Vemos los valores que tenemos.

*Tiempo_de_demora:*
```{r, echo=FALSE, message=FALSE}
unique(DC1S$Tiempo_de_demora)
```
*Dinero_retirado:*
```{r, echo=FALSE, message=FALSE}
unique(DC1S$Dinero_retirado);
```
*Dinero_retirado_semanalmente*
```{r, echo=FALSE, message=FALSE}
unique(DC1S$Dinero_retirado_semanalmente);
```
En los datos numéricos, vemos que hay valores atípicos que se alejan mucho de los demás resultados.
En Tiempo_de_demora observamos el valor atípico '208000' un tiempo absurdo para ir al cajero más cercano.

En dinero_retirado observamos el valor atípico '10000000' y '3000' una cantidad irreal para retirar en un día ya que los cajeros automáticos cuentan con cierto limite de dinero por día, además se aleja mucho de las otras respuestas. 

En Dinero_retirado_semanalmente también se presenta un valor atípico, '20000000'. Es una cantidad también irreal para retirar en una semana,ya que no hay relación con el dinero retirado por día y esta muy lejos de las otras respuestas.

Decidimos evitar usar estos valores en nuestro análisis de descriptores, pero no podemos eliminarlos, así que crearemos nuevas datas sin estos valores de manera que no afectamos la data original. Para ello usaremos **filter**.

```{r, echo=FALSE, message=FALSE}
D_DRS<-filter(DC1S,Dinero_retirado_semanalmente<20000000 & Dinero_retirado_semanalmente>0)#Data dinero retirado semanalmente
D_DRD<-filter(DC1S,Dinero_retirado <3000 & Dinero_retirado > 0) #Data dinero retirado diario

D_T<-filter(DC1S,Tiempo_de_demora<=180) #Data tiempo 
```

*Fin de la limpieza* Finalmente nuestra data para el análisis general es DC1S con 151 observaciones y 19 variables, además tenemos datas adicionales para el análisis univariado del dinero y tiempo. 


#**Análisis descriptivo**

Para responder a nuestros objetivos planteamos relación entre variables:

Relación de *Edad* vs *Dinero retirado semanalmente*, para ello analizaremos cada una por separado y luego como conjunto.

*Análisis de edad*
```{r}
summary(DC1S$Edad)

"Coeficiente de variación" 
(sd(DC1S$Edad)/mean(DC1S$Edad))*100


```
Podemos observar que el CV es menos del 20%, esto significa que sus datos son homogéneos, es decir tienen poca variabilidad y se distribuyen de manera simétrica. Por ende la media es representativa como una medida de referencia para la edad. Además observamos que el mayor del 75% de los menores de nuestros participantes es la edad de 20 años.

Sacamos la moda
```{r}
table(DC1S$Edad)
```
Observamos que la mayor cantidad de participantes se centra en el intervalo de 18 a 20 años, esto nos da indicios que son estudiantes de los primeros ciclos quienes predominan en nuestra encuesta.
Para observar mejor los datos realizamos un gráfico:
```{r}
boxplot(DC1S$Edad,col=rainbow(7),horizontal = TRUE , xlab="Edad (años)", main="Edad de los participantes")
```
Con el gráfico observamos datos atípico, pero en su mayoría nuestra población se concentra en el intervalo de 8 a 20 años y es más evidente ver la simetría de la muestra, lo cual sabíamos por el coeficiente de dispersión.

*Análisis de dinero retirado*
```{r}
summary(D_DRD$Dinero_retirado)
"Coeficiente de variación" 
(sd(D_DRD$Dinero_retirado)/mean(D_DRD$Dinero_retirado))*100


```
Podemos observar que el CV es más del 70%, esto significa que sus datos son heterogéneos, es decir tienen mucha variabilidad y se distribuyen de manera asimétrica. Por ende la media no es representativa. Además observamos una gran diferencia entre la media y mediana que es otro indicador de la variabilidad. Observamos que el mayor de los menores del 75% de los datos es de 100 soles retirados en promedio por día.

Para observar mejor los datos realizamos un gráfico 
```{r}
boxplot(D_DRD$Dinero_retirado,col='lightgreen',horizontal = TRUE , xlab="Dinero retirado (soles)", main="Dinero promedio retirado a diario")
```
Con el gráfico observamos que hay una asimetría y está sesgado hacia la izquierda. Esto quiere decir que la mayor parte de los encuestados se distribuyen en el intervalo de 40 a 100 soles. Hay una disminución notoria de estudiantes a medida que se avanza hacia la derecha, esto sugiere que no es común que la mayoría de las estudiantes de UTEC retiren a los máximo más de 200 soles en promedio por día. 


Realizamos una comparación entre estas variables
Analizaremos el coeficiente de covarianza y correlación

```{r}
cov(D_DRD$Edad , D_DRD$Dinero_retirado)
cor(D_DRD$Edad , D_DRD$Dinero_retirado)
```
Observamos que el coeficiente de covarianza es mayor que 0 lo que significa que hay una tendencia ascendente .Es decir cuando la edad aumenta, la variable dinero retirado también aumenta, pero el coeficiente de correlación es próximo a 0 esto nos indica que no hay relación lineal entre las 2 variables.Es decir que estas variables son independientes entre sí.

Gráfico de dispersión
```{r, echo=FALSE, message=FALSE}
plot(x =D_DRD$Edad, y = D_DRD$Dinero_retirado, 
     main = "Relación entre Edad y Dinero_retirado", xlab = "Edad (años)", ylab = "Dinero retirado (soles)")

media <- mean(DC1$Edad)
mediana <- median(DC1$Edad)

abline(v = media, col = "red", lwd = 2)
abline(v = mediana, col = "blue", lwd = 2)

```
Con el gráfico de dispersión se observa de mejor forma que no hay una relación entre estas variables, y el coeficiente de variación no es preciso, podemos observar que dentro de los participantes de 30, 20 y 18 años están las personas que más dinero retiran a diario, así que no necesariamente a mayor edad retiran más dinero. 

*Interpretamos la preferencia bancaria mediante un gráfico de barras:*

Para ello debemos separar las respuestas en la data, ya que al ser de opción múltiple se encuentran como una sola respuesta

```{r, echo=FALSE, message=FALSE}
#Cargamos la librería string para modificar los datos
library(stringr)
library(dplyr)
library(tidyr)
```

Primero, separamos los valores ya que en algunas filas se encuentran variables unidas mediante comas, y guardamos la columna de bancos en la variable 'NameBancos':
```{r, echo=FALSE, message=FALSE}
NameBancos <- data.frame(x = c(DC1S$Bancos))
```
Segundo, separamos la variable x de Name en 5 columnas según las comas
```{r, echo=FALSE, message=FALSE}
NameBancos$x<-str_split_fixed(NameBancos$x, ",", 5)
```
Retiramos los espacios de las respuestas y también visualizamos la frecuencia con que se repiten los datos:
```{r, echo=FALSE, message=FALSE}
Name1<-str_trim(NameBancos$x,side="both") #retiramos los espacios de la variable
table(Name1) 
```
Con estos datos procedemos a realizar nuestro gráfico de barras para identificar la preferencia bancaria del alumnado, que notoriamente es el BCP
```{r, echo=FALSE, message=FALSE}
# Crear el gráfico de barras
datos <- c(121, 39, 2, 70, 24,15)
barplot(datos, 
        main = "Preferencia bancaria del alumnado",
        xlab = "Entidades bancarias",
        ylab = "Número de Participantes",
        col =  "#e9d8a6",
        names.arg = c("BCP", "Interbank", "BanBif", "BancoNación", "BBVA", "Scotiabank"))
```
Empleamos un gráfico de barras para observar las frecuencias modales de los datos y observamos que el alumnado tiene una notoria preferencia por la entidad financiera “BCP” seguido del Banco de la nación, esta información nos servirá para analizar la frecuencia con la que los estudiantes retiran cerca de la universidad. Ya que suponemos que si estas entidades están cerca de la universidad deberían de retirar frecuentemente. 

*Relacionamos la Frecuencia de depósito cerca de UTEC y Frecuencia de depósito en otro lugar*
```{r, echo=FALSE, message=FALSE}
f_dep<-recode(DC1S$Frecuencia_de_depósito_cerca_de_UTEC,"Siempre"=6,"Casi siempre"=5,"Muy seguido"=4,"A veces"=3,"Rara vez"=2,"Casi Nunca"=1,"Nunca"=0)
f_dep2<-recode(DC1S$Frecuencia_de_depósito_en_otro_lugar,"Siempre"=6,"Casi siempre"=5,"Muy seguido"=4,"A veces"=3,"Rara vez"=2,"Casi Nunca"=1,"Nunca"=0)



tabfdep<-round(prop.table(table(f_dep))*100,2)
barp<-barplot(tabfdep,main="Frecuencia de deposito cerca de Utec", col=c("lavenderblush","mistyrose","lightpink","lightcoral","palevioletred","mediumvioletred","darkviolet"),ylab = "Porcentaje de personas" , xlab = "Frecuencia") 
legend("topright",legend = c("NUNCA","CASI NUNCA" , "RARA VEZ" ,"A VECES","MUY SEGUIDO","CASI SIEMPRE","SIEMPRE") ,fill=c("lavenderblush","mistyrose","lightpink","lightcoral","palevioletred","mediumvioletred","darkviolet")) 
text(barp, tabfdep-1, labels = tabfdep, cex=0.8)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")



tabfdep2<-round(prop.table(table(f_dep2))*100,2)
barp2<-barplot(tabfdep2,main="Frecuencia de deposito en otro lugar", col=c("#B0E0E6","#AFEEEE","#87CEEB","#4169E1","#40E0D0","#00CED1","#0000FF"),ylab = "Porcentaje de personas" , xlab = "Frecuencia") 
legend("topleft",legend = c("NUNCA","CASI NUNCA" , "RARA VEZ" ,"A VECES","MUY SEGUIDO","CASI SIEMPRE","SIEMPRE") ,fill=c("#B0E0E6","#AFEEEE","#87CEEB","#4169E1","#40E0D0","#00CED1","#0000FF"),cex=0.8) 
text(barp2, tabfdep2-1, labels = tabfdep2,cex = 0.8)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")

boxplot(f_dep,f_dep2,col=rainbow(5),horizontal = TRUE , ylab="Deposito(Universidad)  Deposito(otro lugar)", xlab="Frecuencia", main="FRECUENCIA DE DEPOSITO CERCA DE LA UTEC Y EN OTRO LUGAR")

```
El gráfico de frecuencia de depósito cerca de Utec, nos damos cuenta de que este posee una asimetría y está sesgado hacia la derecha. La mayor parte de los encuestados se distribuyen en las categorías de "nunca", "rara vez" y "a veces". Hay una disminución en la frecuencia de uso a medida que se avanza hacia las categorías de "muy seguido", "casi siempre", "casi nunca" y "siempre". Estos resultados sugieren que la mayoría de las personas no realizan depósitos cerca de la universidad con frecuencia, y solo un pequeño porcentaje de personas lo hacen con mayor regularidad.

Estos resultados indican que la mayoría de las personas encuestadas realizan depósitos en otros lugares con una frecuencia de "3" (marcado como "Muy seguido"). Por otro lado, las categorías con menor frecuencia indican que un grupo más reducido de personas realiza depósitos en otros lugares con mayor o menor regularidad.

Al comparar estas dos variables en el diagrama de cajas:
Para la variable que indica la frecuencia en que las personas realizan depósitos cerca de la universidad, la mediana se encuentra aproximadamente en 1 e indica que la mitad de las personas casi nunca o nunca depositan cerca a la institución educativa, y la otra mitad marca una frecuencia de 1 o más. Sin embargo, en el otro caso, la mediana se encuentra alrededor de 3, lo que indica que la mitad de las personas marca una frecuencia de 3 o menos, y la otra mitad marca una frecuencia de 3 o más.
En general, se puede observar que la frecuencia en que las personas realizan depósitos cerca de la universidad tiende a ser ligeramente menor que la frecuencia en que realizan depósitos en otros lugares. 

*Relación de Frecuencia de retiro cerca a UTEC vs Frecuencia de retiro en otro lugar*

```{r, echo=FALSE, message=FALSE}
f_ret<-recode(DC1S$Frecuencia_de_retiro_cerca_de_UTEC,"Siempre"=6,"Casi siempre"=5,"Muy seguido"=4,"A veces"=3,"Rara vez"=2,"Casi Nunca"=1,"Nunca"=0)
f_ret2<-recode(DC1S$Frecuencia_de_retiro_en_otro_lugar,"Siempre"=6,"Casi siempre"=5,"Muy seguido"=4,"A veces"=3,"Rara vez"=2,"Casi Nunca"=1,"Nunca"=0)


tabfret<-round(prop.table(table(f_ret))*100,2)
barp3<-barplot(tabfret,main="Frecuencia de retiro cerca de Utec", col=c("lightgreen","springgreen","limegreen","green","mediumseagreen","forestgreen","chartreuse"),ylab = "Porcentaje de personas" , xlab = "Frecuencia") 
legend("topright",legend = c("NUNCA","CASI NUNCA" , "RARA VEZ" ,"A VECES","MUY SEGUIDO","CASI SIEMPRE","SIEMPRE") ,fill=c("lightgreen","springgreen","limegreen","green","mediumseagreen","forestgreen","chartreuse")) 
text(barp3, tabfret-1, labels = tabfret, cex=0.8)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")


tabfret2<-round(prop.table(table(f_ret2))*100,2)
barp4<-barplot(tabfret2,main="Frecuencia de retiro en otro lugar", col=c("salmon","coral","orange","orangered","darksalmon","tomato","peachpuff"),ylab = "Porcentaje de personas" , xlab = "Frecuencia") 
legend("topleft",legend = c("NUNCA","CASI NUNCA" , "RARA VEZ" ,"A VECES","MUY SEGUIDO","CASI SIEMPRE","SIEMPRE") ,fill=c("salmon","coral","orange","orangered","darksalmon","tomato","peachpuff")) 
text(barp4, tabfret2-1, labels = tabfret2, cex=0.8)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")

boxplot(f_ret,f_ret2,col=rainbow(7),horizontal = TRUE , ylab="Retiro(Universidad)  Retiro(otro lugar)", xlab="Frecuencia", main="FRECUENCIA DE RETIRO CERCA DE LA UTEC Y EN OTRO LUGAR")

```
El gráfico de barras para la variable "frecuencia en que las personas realizan retiros cerca de la universidad":
La categoría con la mayor frecuencia es 3, con un 30.52% que marcaron esta opción. Esto indica que la mayoría realizan retiros cerca de la universidad con una frecuencia de "Muy seguido".
Las categorías con frecuencias similares son 1 y 2, con un 16.23% marcando cada una de ellas. Esto sugiere que un número considerable de personas realizan retiros cerca de la universidad con una frecuencia de "A veces" o "Rara vez".
Las categorías con las frecuencias más bajas son 6 y 5, con 6.49% y 5.19% marcando respectivamente. Esto indica que un número muy pequeño de personas realizan retiros cerca de la universidad con una frecuencia de "Siempre" o "Nunca".
En general, las frecuencias tienden a disminuir a medida que aumenta la frecuencia de los retiros cerca de la universidad. Esto indica que hay una disminución en la cantidad de personas que realizan retiros con una frecuencia mayor.

Para el gráfico de barras donde se indica la frecuencia que realizan retiros en otros lugares, se puede notar lo siguiente:
La frecuencia más común de retiros en otros lugares es de 3, con un total de 33.12% personas seleccionando esta opción. Esto indica que la mayoría de las personas realizan retiros en otros lugares con una frecuencia moderada.
Las frecuencias de 2 y 5 también son relativamente comunes, con 14.94 % personas seleccionando esas opciones respectivamente.
Las frecuencias más bajas se encuentran en uno de los extremos. El 4.55% de personas que indicaron que nunca realizan retiros en otros lugares (frecuencia 0), y 8.44% de personas que seleccionaron una frecuencia de 6, lo que significa que siempre realizan retiros en otros lugares.
En general, hay una variabilidad en las respuestas de frecuencia, con un rango que abarca desde "nunca" hasta "siempre".


Al analizar el diagrama de cajas de las dos variables "frecuencia en que las personas realizan retiros cerca a la universidad" y "frecuencia en que las personas realizan retiros en otros lugares":
Para la variable "frecuencia en que las personas realizan retiros cerca a la universidad",la mediana se encuentra alrededor de 3, lo que indica que la mayoría de las personas realizan retiros cerca a la universidad con una frecuencia moderada , lo mismo sucede para la variable de frecuencia en que las personas realizas retiros en otros lugares.
El rango intercuartílico (IQR) abarca desde aproximadamente 1 hasta 3, lo que indica que la mayoría de las personas se encuentran dentro de ese rango de frecuencia.Para la variable "frecuencia en que las personas realizan retiros en otros lugares", el rango intercuartílico (IQR) abarca desde aproximadamente 2 hasta 4, lo que indica que la mayoría de las personas se encuentran dentro de ese rango de frecuencia.
En general, podemos concluir que la frecuencia de retiros tanto cerca a la universidad como en otros lugares tiende a ser moderada, con una mediana alrededor de 3 ("a veces") en ambas variables. Sin embargo, hay algunas personas que realizan retiros con mayor frecuencia tanto cerca a la universidad como en otros lugares, como se evidencia en los valores atípicos en las dos variables.


*Relación de Ciclo y Deseo de un cajero automático*

Ambas son categóricas, entonces realizaremos un mapa de calor para visualizar la frecuencia
Primero analizamos la variable ciclo
```{r, echo=FALSE, message=FALSE}
frec<-table(DC1S$Ciclo)
barplot(frec, col="lightblue", ylab = "Cantidad de alumnos" , xlab = "Ciclo",main="Frecuencia de Ciclo")
```
Existe mayor concentración en el ciclo 4, esto puede significar que cuando hagamos un análisis de la variable ciclo con otra variable, el ciclo 4 termine siendo el que tiene mayor cantidad de frecuencia.
La cantidad de personas del ciclo 6 al ciclo 10 es significativamente menor a la de otros ciclos. Esto puede deberse a que las personas de ciclos superiores no suelen pasar tanto tiempo en el campus, por lo que no llenaron nuestra encuesta. 

Creamos la tabla de frecuencias contingencia y **mapa de calor** de **Deseo de un cajero automático en UTEC vs ciclo**:
```{r, echo=FALSE, message=FALSE}
DESEO<-DC1S$Deseo_de_un_cajero_automático;
CICLO<-factor(DC1S$Ciclo, levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10"));
freq<-table(DESEO, CICLO);
df_frecuencias <- as.data.frame(freq);
```

```{r, echo=FALSE, message=FALSE}
ggplot(df_frecuencias, aes(DESEO, CICLO, fill = Freq)) +
 scale_fill_viridis() +
  geom_bin2d() +
  scale_x_discrete(name = "Deseo de un cajero automatico en utec",
                   position = "top") +
  scale_y_discrete(name = "Ciclo",
                   limits = rev(levels(CICLO))) +
  labs(title = "Deseo de un cajero automatico en utec con relacion al Ciclo",
       subtitle = "Deseo: 1=menos deseo ",
       caption = "Plot by @Jamona", fill="Frecuencia") +
  theme_minimal() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank())
  
```
```{r}
DESEO5<-sum(freq[5,])/sum(freq)*100;
cat('El total de los estudiantes que tienen deso nivel 5 representa el',round(DESEO5,2),'% del total.')
```
1. En los ciclos intermedios (de 2 a 5) existe un mayor deseo de nivel intenso (5) por la implementación de cajeros automáticos en la universidad, mientras en los primeros (1) y últimos (de 6 a 10) no existe tanto deseo. 

2. La gran mayoría de encuestados tiene un deseo medio a fuerte (3 a 5)

3. Podemos notar que la mayoría de encuestados se encuentra en el 4 ciclo. También notamos que la mayoría de encuestados tiene DESEO nivel 5.

4. En todos los ciclos, la mayoría de personas siente un deseo mayormente fuerte (4-5) por la implementación de cajeros automáticos en UTEC. 

De ambos gráficos podemos concluir que existe gran demanda por la implementación de cajeros automáticos en UTEC.Con la tabla de contingencia notamos que el 59.74 % del total sienten deseo nivel 5. Si bien no todos los estudiantes sienten deseo nivel 5, el deseo mayormente fuerte (4-5) predomina en esta muestra. Además, sólo una minoría siente deseo nulo por la implementación de cajeros. También notamos que la mayoría de estudiantes con deseo nivel 5 se encuentran en 4to ciclo. Esto puede deberse a que la mayoría de estudiantes que respondieron a esta encuesta pertenecen a dicho ciclo.


*Relación de Titular de la tarjeta vs Cantidad de veces que van al cajero*
Planteamos esta relación porque consideramos que si nuestra población en su mayoría es mayor de edad y es titular de su tarjeta entonces tiene la disponibilidad total.
```{r, echo=FALSE, message=FALSE}
ggplot(DC1S) +
  aes(x = Edad) +
  geom_histogram(bins = 30L, fill = "#FF69B4") +
  labs(
    x = "Edad (años)",
    y = "Número de participantes",
    title = "Relacion Edad, titular y número de participantes"
  ) +
  theme_minimal() +
  facet_wrap(vars(Titular))
```

Nos damos cuenta que la población en su mayoría es titular de su propia tarjeta, esto nos ayudara a analizar las siguientes variables de visitas al cajero. Porque al tener la disponibilidad total de la tarjeta pueden ir las veces que deseen a comparación de los participantes cuyos titulares son sus padres o un tutor legal.

*Deseo de un cajero automático vs Cantidad de veces que van a un cajero*

```{r, echo=FALSE, message=FALSE}
datos <- data.frame(DC1S$Titular,
                    DC1S$Veces_en_la_semana_que_va_al_cajero)

tabsetc<-table(DC1S$Titular, DC1S$Veces_en_la_semana_que_va_al_cajero)
barplot(tabsetc,main="Relación titular, idas al cajero y número de participantes",col=c("red","green", "yellow"),xlab="Veces que van al cajero", ylab="Participantes")
legend(x="topright",legend=c("Padres","Tutor legal","Yo"),fill = c("red","green","yellow"),title="leyenda")
```
Nos damos cuenta que la población de participantes titular de su propia tarjeta en su mayoría tienden a ir una vez por semana, al igual que la mayoría cuyo titular son sus padres.Esto nos demuestra que no necesariamente por ser mayores de edad y tener disponibilidad de su propia tarjeta significa que vayan más veces al cajero. También lo podemos relacionar con la poca frecuencia con la que retiran los estudiantes cerca de la universidad. Esto nos da un indicio de que puede no estar su entidad bancaria favorita cerca de la universidad por ende van pocas veces al cajero. 

### <span style="color:brown">Relación de *Deseo de un cajero automático* vs *Cantidad de veces que van a un cajero*</span>


```{r, echo=FALSE, message=FALSE}

f_ret1<-recode(DC1S$Deseo_de_la_opción_de_retiro_o_deposito,"5"=5,"4"=4,"3"=3,"2"=2,"1"=1)


tabfret<-round(prop.table(table(f_ret1))*100,2)
barp3<-barplot(tabfret,main="Deseo de poder retirar en UTEC", col=c("lightgreen","springgreen","limegreen","green","mediumseagreen"),ylab = "Porcentaje de personas" , xlab = "Deseo") 

legend("topleft",legend = c("No desea","Casi Nada","Indiferente","Desea","Desea urgentemente") ,fill=c("lightgreen","springgreen","limegreen","green","mediumseagreen")) 
text(barp3, tabfret-1, labels = tabfret, cex=0.9)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")


tabsetc<-table(DC1S$Deseo_de_un_cajero_automático, DC1S$Veces_en_la_semana_que_va_al_cajero)
barplot(tabsetc,main="Relación idas al cajero, número de participantes y deseo de un cajero",col=c("red","green", "yellow","lightgreen","purple"),xlab="veces que van al cajero", ylab="participantes")
legend(x="topright",legend=c("No desea","Casi Nada","Indiferente","Desea","Desea urgentemente"),fill = c("red","green","yellow","lightgreen","purple"),title="leyenda")


```

Observamos que un 76.62% de los participantes desea urgentemente poder retirar en UTEC, además que en la segunda gráfica predomina el color morado es decir que existe un deseo urgentemente de la población por implementar un cajero automático, además vemos que las personas que van una vez por semana al cajero son los que tienen mayor deseo por su implementación y esto nos da a pensar que la poca frecuencia con la que retirar o depositan cerca de UTEC se debe a que no hay un cajero de su banco favorito cerca de la universidad.


*Analizamos el horario vs edad *

```{r, echo=FALSE, message=FALSE}
f_ret3<-recode(DC1S$Horario_para_ir_al_cajero_más_cercano,"Noche"=3,"Tarde"=2,"Mañana"=1)


tabfret<-round(prop.table(table(f_ret3))*100,2)
barp3<-barplot(tabfret,main="Horario de retiros", col=c("lightgreen","springgreen","limegreen"),ylab = "Porcentaje de personas" , xlab = "Horario") 

legend("topleft",legend = c("Mañana","Tarde","Noche") ,fill=c("lightgreen","springgreen","limegreen")) 
text(barp3, tabfret-1, labels = tabfret, cex=0.9)
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "lightgrey")

ggplot(DC1S) +
  aes(x = Edad, y = Horario_para_ir_al_cajero_más_cercano) +
  geom_violin(adjust = 1L, scale = "area", fill = "lightpink") +
  theme_bw()
```
Observamos que el 62.34% de nuestra población prefiere retirar su dinero en la tarde. El segundo gráfico de violín es útil para ver la relación entre la edad y el horario en que se utiliza más un cajero automático, permite mostrar la distribución de datos de una variable cuantitativa (edad) en relación con una variable cualitativa (horario de uso del cajero) de manera más detallada ya que el gráfico de violín muestra la forma y la densidad de la distribución de datos. Además esto nos permitirá identificar patrones, tendencias o diferencias en las edades de las personas que utilizan el cajero en diferentes momentos del día. Por ejemplo, podrías observar si hay una concentración de personas jóvenes utilizando el cajero en horarios nocturnos o si las personas de mayor edad tienden a utilizarlo más en horarios de mañana temprano.
La parte más ancha del violín indica una mayor densidad de datos, mientras que las partes más estrechas indican una menor densidad.

+ De los encuestados que indicaron que van en el horario de “Tarde”, se tiene una mayor probabilidad de que este tenga menos de 20 años ya que hay una mayor densidad.
+ De los encuestados que indicaron que van en el horario de “Mañana”, se tiene una mayor probabilidad de que este tenga menos de 25 años ya que hay una mayor densidad.
+ Los alumnos de 25 años de edad tienen más probabilidad de ir al cajero en la noche a comparación de los otros momentos del día ya que se observa que hay mayor densidad en comparación con la densidad en los otros momentos del día.
+ Los alumnos menores a 20 años tienen más probabilidad de ir al cajero durante el día en comparación con los alumnos mayores a 20 años.

En conclusión, los datos muestran patrones en la relación entre la edad y el horario de uso del cajero automático. Los análisis indican que los encuestados más jóvenes tienen más probabilidad de utilizar el cajero en horas específicas, como la tarde o la mañana, mientras que los alumnos de 25 años tienen una tendencia a utilizar el cajero en la noche. Estas conclusiones resaltan la importancia de considerar tanto la edad como el horario al analizar los patrones de uso del cajero automático.


### Razon del horario
```{r, echo=FALSE, message=FALSE}
Razón<-DC1S$Razón_del_horario
frecuencias <- table(Razón)
colores <- c("#005f73", "#0a9396", "#94d2bd", "#e9d8a6", "#ee9b00", "#ca6702")
porcentajes <- round(prop.table(frecuencias) * 100, 1)
leyenda <- paste0(names(frecuencias), " (", porcentajes, "%)")
pie(frecuencias, labels = leyenda, col = colores, main = "Frecuencia relativa% de Razones de retiro",font.main = 4)
```
Existen diferentes razones por las que los estudiantes asisten al cajero en un horario determinado, la principal razón en la que concuerdan con un 39% es la comodidad, esta nos hace referencia a un buen clima en el viaje al cajero más cercano. Por otro lado, tenemos la seguridad, es un hecho que se han percibido muchos robos alrededor de la institución, por ello los estudiantes velan por su seguridad asistiendo al cajero en el horario al que ellos consideran que es más seguro. Sabemos que en la hora de almuerzo algunos no cuentan con efectivo y prefieren ir a retirar su dinero para cubrir sus gastos de alimentación o educativos, por ello un 14.9% de estudiantes recurren al cajero en aquel horario para cubrir sus gastos. La seguridad va de la mano con la privacidad en el cajero, además, debemos resaltar que no es muy cómodo realizar largas colas para retirar dinero, por ello un 12.3% acude a un cajero porque quieren mayor privacidad para realizar sus transacciones y así evitar que alguien logre divisar su clave o por otras razones. Entre clase y clase existen horas libres, donde un 26% de estudiantes las utiliza para realizar sus transacciones bancarias. Finalmente, existen muchos motivos para poder asistir a un cajero en un horario determinado, pero lo esencial para la población estudiantil de UTEC es la comodidad.


```{r, echo=FALSE, message=FALSE}
prim<-c(DC1S %>% filter(Edad>=16,Edad<20,Razón_del_horario=="Seguridad") %>% select(Horario_para_ir_al_cajero_más_cercano))
tprim<-round(prop.table(table(prim))*100,2)
tprim
prim2<-c(DC1S %>% filter(Edad>=21,Edad<25,Razón_del_horario=="Seguridad") %>% select(Horario_para_ir_al_cajero_más_cercano))
tprim2<-round(prop.table(table(prim2))*100,2)

prim3<-c(DC1S %>% filter(Edad>=26,Edad<35,Razón_del_horario=="Seguridad") %>% select(Horario_para_ir_al_cajero_más_cercano))
tprim3<-round(prop.table(table(prim3))*100,2)


```

```{r}
pie3D(tprim, labels = tprim,col=c("violet","#DFC6D9","pink")) #sentido antihorario
#leyenda
legend("topright",legend = c("Mañana","Tarde","Noche"),fill=c("violet","#DFC6D9","pink"))
title("Estudiantes que elegieron Seguridad entre 16 y 20 años")

pie3D(tprim2, labels = tprim2,col=c("#BDDDD4","royalblue","darkblue")) #sentido antihorario
#leyenda
legend("right",legend = c("Mañana","Tarde","Noche"),fill=c("#BDDDD4","royalblue","darkblue"))
title("Estudiantes que elegieron Seguridad entre 21 y 25 años ")

pie3D(tprim3, labels = tprim3,col=c("salmon","darkorange","white")) #sentido antihorario
#leyenda
legend("topright",legend = c("Mañana","Tarde","Noche"),fill=c("salmon","darkorange","white"))
title("Estudiantes que elegieron Seguridad entre 26 y 35 años ")

```

Para los estudiantes de 16 a 20 años:

El 55.17% de los estudiantes prefieren ir en la mañana a retirar dinero.
El 48.83% de los estudiantes prefieren ir en la tarde a retirar dinero.
Ningún estudiante prefiere ir en la noche a retirar dinero.
Para los estudiantes de 21 a 25 años:

El 37.5% de los estudiantes prefieren ir en la mañana a retirar dinero.
El 62.5% de los estudiantes prefieren ir en la tarde a retirar dinero.
Ningún estudiante prefiere ir en la noche a retirar dinero.
Para los estudiantes de 26 a 35 años:

El 100% de los estudiantes prefieren ir en la mañana a retirar dinero.
Ningún estudiante prefiere ir en la tarde ni en la noche a retirar dinero.

Entonces, existe una tendencia en los estudiantes de asistir al cajero de mañana o tarde en busca de una mayor seguridad. Además, ninguno de los estudiantes prefiere ir en las noches a realizar retiros ya que los cajeros más cercanos se encuentran en zonas que ellos consideran peligrosas y este factor no les proporciona seguridad.
