---
title: "S3 Impacto del clima en los estudiantes de UTEC"
output:
  html_document:
    toc: yes
    toc_float:
            collapsed: no
            smooth_scroll: no
    number_sections: yes
    theme: yeti
  pdf_document:
    toc: yes
---
*INTEGRANTES:*

-   Islachin Aquise Andersson Carlos.
-   Fernando André Guillén Rodríguez.
-   Diego Sebastián Enciso Lozano.
-   David Teófilo Orihuela Serafín.
-   Salazar Peña, Joaquín Emir.

# **TEMA**:

El impacto del clima en el bienestar emocional y académico de estudiantes del ciclo
2023-1 de UTEC.


# Introduccion

## Relevancia

¿Verdaderamente el clima afecta el bienestar de los estudiantes de UTEC? ¿En qué aspectos? Estas y más preguntas nos realizamos para escoger este tema como nuestro proyecto de curso. Creemos que este tema es importante por las siguientes razones. En primer lugar,  el clima sí afecta significativamente en el bienestar de las personas (Watson, 2000), pero queremos saber qué tanto conocen los estudiantes sobre este tema mediante su percepción. En segundo lugar, existen estudios los cuales demuestran sus efectos en universitarios. Un ejemplo claro es el realizado en la Universidad de Illinois— Estados Unidos, en el cual se les dio a 62 estudiantes un diario donde escribieron como se sentían durante 42 días.  El resultado obtenido fue que los estudiantes suelen tener cambios de humor bruscos (mayormente negativos) cuando el clima es inestable o están en temporada de exámenes.  Al decir inestable se refiere también al clima no común de esa zona. Es por ello que nosotros tomando con base en nuestro clima habitual,  queremos buscar el clima “ideal” de los estudiantes de UTEC, ya que un “buen” clima produce emociones positivas (Persinger 1975, San ders & Brizzolara 1982).  En tercer lugar, la falta de estudios sobre el impacto del clima en el rendimiento académico nos incita a investigar sobre ello, para que junto con la razón anterior podamos proponer estrategias acorde a nuestro entorno con el fin de mejorar el estado emocional, académico y mental de los estudiantes de UTEC


## Objetivos:

-   Identificar la percepción de cada estudiante sobre la relación entre el clima y su estado anímico
-   Proponer estrategias para mejorar el bienestar emocional de los estudiantes en diferentes condiciones climáticas
-   Identificar el rendimiento académico en los estudiantes UTEC por diferentes temporadas climáticas.

## Contexto

El impacto del clima en el desempeño académico de los estudiantes de UTEC es un tema de estudio que ha despertado interés en los últimos años. El clima, entendido como las condiciones meteorológicas y atmosféricas en una determinada región, puede tener influencia en múltiples aspectos de la vida diaria, incluyendo el ámbito educativo. Este puede afectar tanto el estado físico como mental de las personas y estos factores pueden incidir en su capacidad de aprendizaje y rendimiento académico. Por ejemplo, condiciones climáticas extremas, como altas temperaturas, humedad o cambios bruscos de temperatura, pueden generar incomodidad física y dificultades para concentrarse en el estudio.

Otro aspecto a considerar es el efecto del clima en el estado de ánimo y el bienestar emocional de los estudiantes. Durante períodos prolongados de clima desfavorable, como la falta de luz solar en invierno o la falta de lluvia en zonas áridas, algunos individuos pueden experimentar cambios en su estado de ánimo, como apatía, tristeza o falta de motivación, lo que podría tener repercusiones en su compromiso y desempeño académico.
Sin embargo, es importante tener en cuenta que el impacto del clima en el desempeño académico no es un fenómeno unidimensional y puede variar según factores individuales, contextuales y culturales. Algunos estudiantes pueden adaptarse mejor a ciertas condiciones climáticas, mientras que otros pueden ser más sensibles a los cambios atmosféricos.

Este estudio puede desempeñar un papel fundamental para comprender la relación entre el clima y el desempeño académico. A través de la recopilación de datos climáticos y datos académicos, es posible realizar un análisis cuantitativo que permita identificar patrones, tendencias y posibles correlaciones entre variables climáticas y resultados académicos. Este tipo de investigación puede contribuir a generar conocimiento relevante y proporcionar información útil para la implementación de estrategias educativas y de bienestar que ayuden a los estudiantes a enfrentar de manera más efectiva los desafíos relacionados con el clima.

En resumen, el efecto del clima en el desempeño académico de los estudiantes de UTEC es un tema complejo y multifacético. Comprender cómo las condiciones climáticas pueden influir en el rendimiento académico puede abrir nuevas perspectivas para promover entornos educativos más adaptados y resilientes.


# Datos


## Recolección de datos

Las encuestas mediante el google forms desempeñaron un papel fundamental en nuestro estudio estadístico,nos permitieron obtener una muestra representativa de más de 200 personas y recopilar información detallada sobre las preferencias climáticas, el estado de ánimo, las horas de estudio y los promedios académicos. Estas encuestas nos proporcionaron datos cualitativos y cuantitativos clave, respaldando nuestras conclusiones y recomendaciones con una base sólida de información directamente de los propios estudiantes




## Población, muestra y muestreo

   Poblacion:Estudiantes de la Universidad de Ingenieria y Tecnologia del ciclo regular 2023-1
   Muestra: La muestra tiene 204 observaciones registrados.
   Muestreo: Se aplico el muestreo probabilistico-aleatorio simple para los encuestados.



    
## Tabla de variables
 

| Variables                         | Tipo + Restricción                    |
|-----------------------------------|---------------------------------------|
| Sexo                              | Categórica nominal                    |
| Edad                              | Numérica discreta. Entero no negativo |
| ciclo.academico                   | Categórica nominal                    |
| Carrera                           | Categórica nominal                    |
| Ciclo                             | Numérica discreta. Entero no negativo |
| X.Cómo.sueles.sentirte.en.verano. | Categórica nominal                    |
| X.Cómo.sueles.sentirte.en.otoño.  | Categórica nominal                    |
| X.Cómo.sueles.sentirte.en.invierno| Categórica nominal                    |
| X.Cómo.sueles.sentirte.primavera  | Categórica nominal                    |
| Preferencia.climática             | Categórica nominal                    |
| Afecta.rendimiento                | Categórica nominal                    |
| X.ambiente.más.cálido.o.más.frío  | Categórica nominal                    |
| Promedio.ciclo.regular.2022.1     | Numérica continua. Entero no negativo |
| Promedio.ciclo.regular.2022.1     | Numérica continua. Entero no negativo |
| X.cambiar.tu.rutina.de.estudio    | Numérica discreta. Entero no negativo |
| X.actividad.para.adaptarte.clima  | Categórica nominal                    |
| X.promedio.verano                 | Numérica discreta. Entero no negativo |
| X.horas.de.estudio.dia.soleado    | Categórica ordinal                    |
| X.horas.de.estudio.dia.lluvioso   | Categórica ordinal                    |
| X.horas.de.estudio.dia.templado   | Categórica ordinal                    |
| X.horas.de.estudio.dia.frio       | Categórica ordinal                    |
| X.esta.humor.dia.soleado          | Categórica ordinal                    |
| X.esta.humor.dia.lluvioso         | Categórica ordinal                    |
| X.esta.humor.dia.templado         | Categórica ordinal                    |
| X.esta.humor.dia.frio             | Categórica ordinal                    |
| X.actividad.deportiva.tem.soleado | Categórica nominal                    |
| X.actividad.deportiva.tem.frio    | Categórica nominal                    |
| X.actividad.recreaci.tem.soleado  | Categórica nominal                    |
| X.actividad.recreaci.tem.frio     | Categórica nominal                    |
| X.Universidad.consideracion       | Categórica nominal                    |


## Limpieza de base de datos

Primero instalamos las librerias

```{r}
#Paquetes - Instalar estos paquetes 
list.of.packages <- c("readr","dplyr","stringr","car","modeest","ggplot2","ggthemes","ggmosaic","knitr","stringr","viridisLite","vroom","Rlab","viridis")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
```

```{r}
library(readr)
library(ggplot2)
library(ggmosaic)
library(knitr)
library(Rlab)
library(datasets)
library(stringr)
library(ggthemes)
library(modeest)
library(viridisLite)
library(viridis)
library(dplyr)
```
Luego leemos y nombramos la data
```{r}
DF<-read.csv("clima1.csv", encoding = "UTF-8")
```


Cambiamos el nombre de las variables 
```{r}
DF1 <- rename(DF, Ciclo= `Ciclo.académico.que.se.encuentra.cursando`, Estado_verano= `X.Cómo.sueles.sentirte.en.verano.`, Estado_otoño = `X.Cómo.sueles.sentirte.en.otoño.`, Estado_invierno = `X.Cómo.sueles.sentirte.en.invierno.`, Estado_primavera = `X.Cómo.sueles.sentirte.en.primavera.`, Preferencia_climática = `Preferencia.climática`, Afecta_rendimiento = `X.Consideras.que.el.clima.afecta.tu.rendimiento.académico.`, Estudio_clima = `X.Prefieres.estudiar.en.un.ambiente.más.cálido.o.más.frío.`, Promedio_1 = `X.Cuál.fue.tu.promedio.ponderado.del.ciclo.regular.2022.1..Colocar.respuesta.en.decimales..Usa.punto.decimal...`,Promedio_2=`X.Cuál.fue.tu.promedio.ponderado.del.ciclo.regular.2022.2..Colocar.respuesta.en.decimales..Usa.punto.decimal...`, rutina_clima=`X.Has.considerado.cambiar.tu.rutina.de.estudio.en.función.de.las.condiciones.climáticas..`, Actividad_clima=`X.Realizas.alguna.actividad.específica.para.adaptarte.al.clima.y.poder.estudiar.con.mayor.comodidad.`, estudio_verano=`X.Estudiaste.en.la.Universidad.durante.verano.`,Promedio_verano= `X.Cuál.fue.tu.promedio.ponderado.en.el.ciclo.verano..Colocar.respuesta.en.decimales..Usa.punto.decimal...`,Horas_soleado=`X.Cuántas.horas.sueles.estudiar.en.un.día.soleado.`, Horas_lluvioso=`X.Cuántas.horas.sueles.estudiar.en.un.día.lluvioso.`,Horas_templado=`X.Cuántas.horas.sueles.estudiar.en.un.día.templado.`,Horas_frío=`X.Cuántas.horas.sueles.estudiar.en.un.día.frío.`,Humor_lluvioso=`X.Cómo.sueles.estar.de.humor.en.un.día.lluvioso.`, Humor_frío=`X.Cómo.sueles.estar.de.humor.en.un.día.frío.`,Humor_templado=`X.Cómo.sueles.estar.de.humor.en.un.día.templado.`, Humor_soleado=`X.Cómo.sueles.estar.de.humor.en.un.día.soleado.`, deporte_cálido=`X.Qué.actividad.deportiva.realizas..mas.en.temporadas.primaveral.soleado.`,deporte_frío=`X.Qué.actividad.deportiva.realizas.más.en.temporadas.templados.frios..`,Recreación_calida=`X.Que.actividad.recreativa.realizas.mas.en.temporadas.primaveral.soleado.`,Recreación_fría=`X.Que.actividad.recreativa.realizas.mas.en.temporadas.templados.frio.`, Importancia=`X.Crees.que.la.universidad.debería.tomarle.importancia.al.impacto.del.climatico.en.el.bienestar.académico.y.emocional.de.sus.estudiantes.` )

```
Cambiamos M(Masculino)y F(Femenino) por solo M y F

```{r}
DF1<-mutate(mutate(DF1,Sexo=case_when(Sexo == 'M( Masculino)' ~'M',
Sexo == 'F(Femenino)' ~ 'F')))

```

Cambiar la variable edad, que era char por entero

```{r}
DF1$Edad<-as.integer(DF1$Edad)
```
Como la encuesta es anónima no se tomara en cuenta los correos electrónicos registrados de la data.

```{r}
DF1 <- select(DF1, -Dirección.de.correo.electrónico)
```
Cambiar afecta rendimiento y estudio_verano por Sí y No
```{r}
DF1<-mutate(mutate(DF1,Afecta_rendimiento=case_when(Afecta_rendimiento == 'Si' ~'Sí', TRUE~Afecta_rendimiento)))
DF1<-mutate(mutate(DF1,estudio_verano=case_when(estudio_verano == 'si' ~'Sí',
estudio_verano=='no'~'No')))

```

Debido a que en la encuesta se coloco la opcion mayores de 24 para la variable edad, al hacer la conversion de edad a entero estos valores quedaron como NA, los cuales al ser solo tres (no genera sesgo significativo), los podemos cambiar por 25.
```{r}
DF1<-mutate(mutate(DF1,Edad = case_when(is.na(DF1$Edad) ~ 25,TRUE~Edad)))

```

Cambiamos los 0 de promedio uno por Nas 
```{r}
DF1 <- DF1 %>% mutate_at(c('Promedio_1'), ~na_if(., 0))

```
Cambiamos los 0 de promedio 2 por NAs
```{r}
DF1 <- DF1 %>% mutate_at(c('Promedio_2'), ~na_if(., 0))
```
Cambiamos los 0 de la variable promedio verano por NA

```{r}
DF1 <- DF1 %>% mutate_at(c('Promedio_verano'), ~na_if(., 0))

```
# Análisis descriptivo
## Graficas univariadas
### Categorica
#### Percepcion de los estudiantes UTEC sobre el impacto del clima en su rendimiento academico
```{r, echo=FALSE, message= FALSE}
# Calcular los porcentajes
porcentajes <- table(DF1$Afecta_rendimiento) / nrow(DF1) * 100

# Crear un data frame con los porcentajes
df_porcentajes <- data.frame(Afecta_rendimiento = names(porcentajes), Porcentaje = porcentajes)

# Crear el gráfico circular
ggplot(df_porcentajes, aes(x = "", y = Porcentaje.Freq, fill = Afecta_rendimiento)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  labs(fill = "Afecta Rendimiento", x = NULL, y = NULL, title = "Porcentaje de Afecta Rendimiento") +
  geom_text(aes(label = paste0(round(Porcentaje.Freq, 1), "%")), position = position_stack(vjust = 0.5)) +
  theme_void()
```

### Cuantitativa 
```{r, echo=FALSE, message= FALSE}
ggplot(DF1, aes(x = Edad)) +
  geom_bar(fill = "lightblue", color = "black") +
  labs(x = "Edad", y = "Frecuencia", title = "Diagrama de Barras de Edad") +
  scale_x_continuous(breaks = unique(DF1$Edad)) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```


## Graficas bivariadas

### Variables categorica - numerica
#### Boxplot acerca de como los estudiantes se sienten en verano vs su promedio en el ciclo verano
```{r, echo=FALSE, message= FALSE}
Verano<-filter(DF1,Promedio_verano !="NA " & Estado_verano!="NA ")
```
Deducimos que solo 82 de los encuestados llevaron  un ciclo verano. Ahora veremos el impacto que este tuvo 

```{r, echo=FALSE, message= FALSE}

datos_subset <- Verano[, c("Estado_verano", "Promedio_verano")]

ggplot(datos_subset, aes(x = Estado_verano, y = Promedio_verano, fill = Estado_verano)) +
  geom_boxplot(width = 0.5, color = "black") +
  geom_point(stat = "summary", fun = "mean", shape = 21, size = 4, color = "black") +
  labs(x = "Estado del verano", y = "Promedio del verano", title = "Boxplot del promedio por estado del verano") +
  scale_fill_manual(values = c("blue", "red", "green","yellow")) +
  theme_minimal()



```


El proposito de este grafico es medir que tanto se relaciona el estado de una persona (alegre, calmado, enfadado y triste) que ha llevado ciclo verano con sus notas en un ciclo verano . Podemos observar que el 50% de los datos de la personas alegres van desde 14.50 hasta 17  de las personas que se encuentran tristes, desde 13.50 hasta 16.22,de las personas calmadas desde 14.57 y 16 y de las personas enfadadas desde 15 hasta 16.68. Por ende podemos decir que los rangos intercuartilicos de estados segun el promedio son las siguientes
- Estado Alegre: 2.5 
- Estado Triste: 2.72
- Estado Enfadado: 1.68
- Estado Calmado: 1.43
Mediante ello podemos decir que tanto los estados calmado como enfadado poseen poca dispersion, lo que quiere decir que podemos ver un patron "común" en los promedios de las personas que se sienten calmadas y por lo tanto enfadadas en verano. De igual manera se observa que en las personas tristes desde el su primer cuartil hasta la mediana, es decir alrededor del 25% de los promedios no llegan ni a al primer cuatril de los datos de las personas tanto que se sienten alegres, calmadas y enfadadas. Por lo cual, podemos inferir la tristeza es la que principalmente ocasiona promedios menos óptimos en los estudiantes. Asimismo, los circulos que vemos en cada estado representan la media en cada estado. En el caso del estado calmado y triste se observa que los datos poseen una distribución simétrica. Lo quiere decir que los valores se encuentran distribuidos de manera equilibrada acorde al centro y no existe un sesgo hacia un lado de la distribución.  

```{r, echo=FALSE, message= FALSE}
datos_subset %>%
  group_by(Estado_verano) %>%
  summarize(Min = min(Promedio_verano),
            Q1 = quantile(Promedio_verano, 0.25),
            Median = median(Promedio_verano),
            Mean = mean(Promedio_verano),
            Q3 = quantile(Promedio_verano, 0.75),
            Max = max(Promedio_verano),
            Coeficiente_Variacion = (sd(Promedio_verano) / mean(Promedio_verano)) * 100)


```
Acorde a esta tabla y el coeficiente de variación podemos afirmar que todos nuestros datos son HOMOGENEOS.
#### Estado otoño vs Promedio 2022-1
```{r, echo=FALSE, message= FALSE}
ggplot(DF1, aes(x = Estado_otoño, y = Promedio_1)) +
  geom_boxplot(fill = "lightblue", color = "blue") +
  labs(x = "Estado Otoño", y = "Promedio 2022-1") +
  ggtitle("Boxplot de Estado Otoño y Promedio 2022-1") +
  theme_minimal()
```
La comparación de los boxplots revela que las medianas de los cuatro grupos (Alegre, Calmado, Enfadado y Triste) son aproximadamente similares en magnitud, lo que indica que los valores centrales de las distribuciones son cercanos. Este hallazgo sugiere que los grupos pueden estar influenciados por factores similares que contribuyen a la ubicación central de sus datos.

Además, se puede observar que la longitud de los bigotes en el boxplot correspondiente al grupo "enfadado" difiere de manera significativa en comparación con los otros grupos. Mientras que los bigotes de los demás grupos son de longitud similar, los del grupo "enfadado" presentan una discrepancia, siendo uno de ellos más corto que el otro.

Esta diferencia en la longitud de los bigotes indica la presencia de asimetría en la distribución de datos del grupo "enfadado". La asimetría sugiere que los valores en este grupo pueden estar más concentrados hacia uno de los extremos de la distribución, lo cual puede ser indicativo de una mayor variabilidad en ese extremo particular.

#### Estado Invierno vs Promedio 2022-1
```{r, echo=FALSE, message= FALSE}
ggplot(DF1, aes(x = Estado_invierno, y = Promedio_1)) +
  geom_boxplot(fill = "lightgreen", color = "darkgreen") +
  labs(x = "Estado Invierno", y = "Promedio 1") +
  ggtitle("Boxplot de Estado Invierno y Promedio 1") +
  theme_minimal()
```
Al analizar el gráfico boxplot, se observa que la ubicación de la mediana en el grupo "enfadado" es la más baja en comparación con los otros grupos. Esta diferencia sugiere que la distribución de los datos en el grupo "enfadado" tiende a estar más concentrada hacia valores más bajos en relación con los demás grupos.

Además, al examinar los bigotes de este mismo grupo, se aprecia una asimetría en su longitud en comparación con los demás rectángulos. Si los bigotes fueran de igual longitud, esto indicaría una distribución simétrica. Sin embargo, en esta situación, la asimetría negativa de los bigotes en el grupo "enfadado" sugiere una distribución asimétrica en la cual la cola izquierda de la distribución es más larga que la cola derecha.

Una observación interesante se refiere a la presencia de valores atípicos en este grupo. Estos valores atípicos se encuentran fuera de los bigotes y se destacan como excepciones en comparación con el resto de los datos.Debido a que es relevante destacar que el valor máximo es registrado en este grupo cuya mediana es la más baja y tiene una tendencia hacia valores más bajos. Esto indica la existencia de situaciones excepcionales o extremas que pueden estar influenciando el comportamiento de este grupo en particular.
```{r, echo=FALSE, message= FALSE}
mediana_promedio_1 <- median(DF1$Promedio_1, na.rm = TRUE)
desviacion_promedio_1 <- sd(DF1$Promedio_1, na.rm = TRUE)
min_promedio_1 <- min(DF1$Promedio_1, na.rm = TRUE)
max_promedio_1 <- max(DF1$Promedio_1, na.rm = TRUE)


cat("Mediana Promedio 1:", mediana_promedio_1, "\n")
cat("Desviación estándar Promedio 1:", desviacion_promedio_1, "\n")
cat("Mínimo Promedio 1:", min_promedio_1, "\n")
cat("Máximo Promedio 1:", max_promedio_1, "\n")
```

### Variable categorica-categorica
#### Clima estudio vs- Afecta rendimiento 
```{r, echo=FALSE, message= FALSE}
tabla <- table(DF1$Estudio_clima,DF1$Afecta_rendimiento)
mosaicplot(tabla,color ="Blue", main = "Clima de estudio y Afecta rendimiento", xlab = "Preferencia del clima para estudiar",ylab="Afecta rendimiento academico")
```

La mayoria de los estudiantes tienen una inclinacion a un clima templado-frio para estudiar,ademas segun sus criterios consideran que esto influye en su rendimiento academico. Aun no se sabe si positivamente o negativamente, pero lo mas probable es que la correlacion sea positiva puesto que el estudio en un clima preferido,mejore el rendimiento del estudiante

#### Deporte en clima calido- vs Afecta rendimiento 

```{r, echo=FALSE, message= FALSE}
tabla <- table(DF1$deporte_cálido,DF1$Afecta_rendimiento)
mosaicplot(tabla,color ="red", main = "Deporte en clima calido y afecta rendimiento", xlab = "Actividad deportiva en clima Calido",ylab="Afecta rendimiento academico",las=3,cex.axis = 0.6)
```

El analisis demuestra que deportes practicados en un clima calido tales como Atletismo,Ciclismo,Natacion,Tenis, los estudiantes declaran que su rendimiento academico se ve afectado; sin embargo otros deportes como las artes marciales,basket,futbol los estudiantes consideran que su rendimiento no se ve afectado.Para el caso en que el rendimiento se ve afectado esto puede ser positiva o negativamente.
 
## Graficas multivariadas
### Variable cuantitativa, cuantitativa y categorica

#### Diagrama de dispersion de colores sobre el impacto del promedio anual en el promedio verano acorde a la preferencia climatica del estudiante

Quiero crear un grafico de dispersion por colores. Primero lo que haremos es sumar las variables promedio1 y promedio2 para obtener el promedio anual. Vamos a crear una nueva tabla con la condicion de que las personas hayan cursado los dos ciclos anuales y el ciclo verano. No resulta efectivo trabajar con una cantidad distinta de observaciones para analizar cada variable, puesto que no todos han llevado los tres ciclos.  
```{r, echo=FALSE, message= FALSE}
Estacion<-filter(DF1,Promedio_1 !="NA " & Promedio_2!="NA " &  Promedio_verano!="NA ")
```
Obtenemos que tan solo 79 personas de nuestra muestra han cursado estos tres ciclos. A partir ello realizaremos nuestro diagrama de dispersion por colores. Ahora si, creamos una nueva tabla que calcule el promedio anual y lo redondee a dos decimales
```{r, echo=FALSE, message= FALSE}
Estacion <- Estacion %>%
  mutate(promedio_anual = round((Promedio_1 + Promedio_2) / 2, 2))
```
Hecho esto recien realizaremos nuestro diagrama de dispersion por colores
```{r, echo=FALSE, message= FALSE}
datos_subset2 <- Estacion[, c("promedio_anual", "Promedio_verano","Preferencia_climática")]
library(ggplot2)

# Ajustar modelos de regresión lineal por grupo
modelo_lm <- lm(Promedio_verano ~ promedio_anual, data = datos_subset2)
modelos_por_grupo <- split(datos_subset2, datos_subset2$Preferencia_climática) %>%
  lapply(function(df) lm(Promedio_verano ~ promedio_anual, data = df))

ggplot(datos_subset2, aes(x = promedio_anual, y = Promedio_verano, color = Preferencia_climática)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Promedio Anual", y = "Promedio Verano", color = "Preferencia Climática") +
  theme_minimal()

```
Consideramos a promedio anual como una variable independiente, mientras que a promedio verano como una variable dependiente. Puesto que si tienes mejor promedio anual tendras un turno más temprano de matricula en el ciclo verano, lo cual consideramos como una ventaja. Por otro lado, centrandonos en el grafico queremos averiguar que tipo de relacion lineal posee cada recta que relaciona las tres variables: por lo cual realizamos el siguiente codigo:
```{r, echo=FALSE, message= FALSE}
# Obtener pendientes y direcciones de las líneas de regresión por grupo
pendientes <- sapply(modelos_por_grupo, function(modelo) coef(modelo)[2])
direcciones <- ifelse(pendientes > 0, "Positiva", "Negativa")

# Mostrar resultados
resultados <- data.frame(Preferencia_climática = names(modelos_por_grupo),
                         Pendiente = pendientes,
                         Dirección = direcciones)
print(resultados)
```
Obtenido lo anterior podemos decir que en cada grupo de preferencia climática existe una relación lineal positiva entre el promedio anual y el promedio de verano. Esto significa que a medida que aumenta el promedio anual, también tiende a aumentar el promedio de verano, y viceversa, dentro de cada grupo específico de preferencia climática. No obstante, el promedio del que suele aumentar mas es de las personas que tiene como preferencia climatica el clima seco y el clima tropical propio de los lugares donde suele hacer mas calor. 

### Variable cuantitativa, cuantitativa y cuantitativa
#### Horas de clima vs Promedio ciclo 2021-2 y Promedio ciclo 2022-2

```{r, echo=FALSE, message= FALSE}
# Nuevo dataframe con las variables a usar
df_heatmap <- DF1 %>% select(Promedio_1, Promedio_2, Horas_soleado, Horas_lluvioso, Horas_templado, Horas_frío)

# Mapa de calor Promedio_1
ggplot(df_heatmap, aes(x = Horas_soleado, y = Horas_lluvioso, fill = Promedio_1)) +
  geom_tile() +
  scale_fill_gradient(low = "blue", high = "red") +
  labs(x = "Horas Soleado", y = "Horas Lluvioso", fill = "Promedio 1") +
  ggtitle("Mapa de Calor: Horas de Clima vs. Promedio 1") +
  theme_minimal()

# Mapa de calor Promedio_2
ggplot(df_heatmap, aes(x = Horas_templado, y = Horas_frío, fill = Promedio_2)) +
  geom_tile() +
  scale_fill_gradient(low = "blue", high = "red") +
  labs(x = "Horas templado", y = "Horas Frío", fill = "Promedio 2") +
  ggtitle("Mapa de Calor: Horas de Clima vs. Promedio 2") +
  theme_minimal()
```
##### Analisis mapas de calor
Es evidente que los alumnos destinan un número considerablemente mayor de horas a su estudio durante las jornadas caracterizadas por condiciones climáticas lluviosas y frías, en contraste con los días soleados y templados. Además, se observa una marcada correlación entre aquellos que invierten más de 5 horas en sus tareas académicas y la obtención de calificaciones superiores. De hecho, los promedios obtenidos en este grupo se sitúan en el rango de 18 a 20. Por el contrario, en los días soleados o templados, se percibe una notoria ausencia de calificaciones destacadas (18), lo cual guarda una relación directa con la cantidad de horas dedicadas al estudio.

```{r, echo=FALSE, message= FALSE}
# Nuevo dataframe con las variables a usar
df_mapa_puntos <- DF1 %>% select(Promedio_1, Promedio_2, Horas_soleado, Horas_lluvioso, Horas_templado, Horas_frío)

# Mapa de puntos Promedio_1
ggplot(df_mapa_puntos, aes(x = Horas_soleado, y = Horas_lluvioso, color = Promedio_1)) +
  geom_point() +
  labs(x = "Horas Soleado", y = "Horas Lluvioso", color = "Promedio 1") +
  ggtitle("Mapa de Puntos: Horas de Clima vs. Promedio 1") +
  theme_minimal()

# Mapa de puntos Promedio_2
ggplot(df_mapa_puntos, aes(x = Horas_templado, y = Horas_frío, color = Promedio_2)) +
  geom_point() +
  labs(x = "Horas Templado", y = "Horas Frío", color = "Promedio 2") +
  ggtitle("Mapa de Puntos: Horas de Clima vs. Promedio 2") +
  theme_minimal()
```

##### Analisis mapas de puntos
Observando la disposición de los puntos en el mapa, se pueden identificar áreas de concentración o dispersión. Los puntos no tienden a agruparse en áreas específicas, por lo tanto, se distribuyen de manera uniforme, esto sugiere una distribución más homogénea de los datos. Los puntos se alinean a lo largo de una línea o siguen una forma lineal general, esto indica una relación lineal entre las variables representadas. Cuanto más cerca están los puntos de una línea de tendencia, más fuerte es la relación lineal entre las variables.


```{r, echo=FALSE, message= FALSE}
# Nuevo dataframe con las variables a usar
df_dispersion_regresion <- DF1 %>% select(Promedio_1, Promedio_2, Horas_soleado, Horas_lluvioso, Horas_templado, Horas_frío)

# Dispersión de regresión lineal para Promedio 1
ggplot(df_dispersion_regresion, aes(x = Horas_soleado, y = Promedio_1)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(x = "Horas Soleado", y = "Promedio 1") +
  ggtitle("Dispersión de Regresión Lineal: Horas de Clima vs. Promedio 1") +
  theme_minimal()

# Dispersión de regresión lineal para Promedio 2
ggplot(df_dispersion_regresion, aes(x = Horas_lluvioso, y = Promedio_2)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(x = "Horas Lluvioso", y = "Promedio 2") +
  ggtitle("Dispersión de Regresión Lineal: Horas de Clima vs. Promedio 2") +
  theme_minimal()
```


##### Analisis dispersion de regresion lineal
Se puede observar claramente que los puntos en el gráfico de dispersión (Horas Soleado) exhiben una tendencia a agruparse a lo largo de una línea o una forma lineal general, lo cual sugiere la presencia de una posible relación lineal entre las variables. Cuanto más cercanos estén los puntos a la línea de regresión, mayor será la fuerza de dicha relación lineal. En virtud de esta información, podemos inferir que los promedios obtenidos en ambos casos son, en general, aprobatorios, sin importar la cantidad de horas dedicadas al estudio en los días soleados. Aunque se aprecian algunos puntos que se encuentran en el rango de calificaciones no aprobatorias, así como también algunos valores excepcionales correspondientes a calificaciones altas (18, 19, 20), podemos clasificarlos como valores atípicos o excepcionales en el contexto del conjunto de datos analizado.

### Variable categorica, categorica y categorica 

#### Deporte favorito en clima calido (sacamos otro atributo con quienes hacen deporte y no)), estado_verano, estado_primavera. 

Comparamos estos tres datos para ver si el hacer o no deporte influye en la actitud de los alumnos.  Usaremos grafico de barras apiladas o mosaico. 

Los que hacen deporte:
```{r, echo=FALSE, message= FALSE}
DF2<-filter(DF1,deporte_cálido %in% c("Artes marciales","Atletismo","Basket","Ciclismo","Fútbol","Natación","Otros","Tenis"))
```

```{r, echo=FALSE, message= FALSE}
table(DF2$deporte_cálido,DF2$Estado_verano)
mosaicplot(table(DF2$deporte_cálido,DF2$Estado_verano),
           main = "Deporte_cálido vs Estado_verano",
           col = c("aquamarine1","aquamarine2","aquamarine3","aquamarine4"),
           las = 2,
           xlab = "deporte",
           ylab = "Estado de ánimo" )
```


#### humor_lluvioso, humor_frio, humor_templado, humor_soleado vs sexo
Un solo mosaico para los cuatro climas vs sexo.
```{r, echo=FALSE, message= FALSE}
table(DF1$Humor_lluvioso,DF1$Sexo)
mosaicplot(table(DF1$Humor_lluvioso,DF1$Sexo),
           col=c("azure3","azure4"), 
           main = "Humor_lluvioso vs sexo",
           xlab = "Humor",
           ylab = "Sexo",
           las = 1,
           cex.axis = 1)

table(DF1$Humor_frío,DF1$Sexo)
mosaicplot(table(DF1$Humor_frío,DF1$Sexo),
           col=c("azure3","azure4"), 
           main = "Humor_frío vs sexo",
           xlab = "Humor",
           ylab = "Sexo",
           las = 1,
           cex.axis = 1)

table(DF1$Humor_templado,DF1$Sexo)
mosaicplot(table(DF1$Humor_templado,DF1$Sexo),
           col=c("azure3","azure4"), 
           main = "Humor_templado vs sexo",
           xlab = "Humor",
           ylab = "Sexo",
           las = 1,
           cex.axis = 1)

table(DF1$Humor_soleado,DF1$Sexo)
mosaicplot(table(DF1$Humor_soleado,DF1$Sexo),
           col=c("azure3","azure4"), 
           main = "Humor_soleado vs sexo",
           xlab = "Humor",
           ylab = "Sexo",
           las = 1,
           cex.axis = 1)


```

Observando las gráficas y las características de cada uno de ellas podemos concluir que a los alumnos de UTEC(F y M) no les agrada un clima soleado, en cambio un clima frió les sienta muy bien y los mantiene de buen humor. Esto nos lleva a deducir que los alumnos estudian de manera mas satisfactoria durante el invierno en donde se puede apreciar un clima frío

# Anexos 

- Barnston, A. G. (1988). *The effect of weather on mood, productivity, and frequency of emotional crisis in a temperate continental climate*. International Journal of Biometeorology, 32, 134-143.

- Persinge, M.A. (1975) *Lag responses in mood reports to changes in the weather matrix*. Int J Biometeorol,19, 108-114.

- Watson, D. (2000).*Mood and temperament*. New York: Guilford Press.


