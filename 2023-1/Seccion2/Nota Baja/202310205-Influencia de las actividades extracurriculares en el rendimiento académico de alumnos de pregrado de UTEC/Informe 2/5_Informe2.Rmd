---
title: 'Influencia de las actividades extracurriculares en el rendimiento académico de alumnos de pregrado de UTEC '
output:
  html_document:
    toc: true
    toc_depht: 5
    toc_float: 
      collapsed: false
      smooth_scroll: true 
    
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)

```

# **1. Introducción**

Este informe se centra en realizar un análisis de la influencia de las actividades extracurriculares en el rendimiento académico de los alumnos de UTEC durante el periodo 2022-2. El objetivo principal es comprender la relación que existe entre las actividades realizadas por los estudiantes y su rendimiento académico. Para lograr este propósito, se llevará a cabo un análisis exploratorio de datos (EDA) y un análisis estadístico minucioso. Además, se presentarán datos numéricos y estadísticas relevantes sobre los promedios registrados durante el ciclo académico 2022-2, proporcionando una base sólida para respaldar los hallazgos y conclusiones del informe. En última instancia, este análisis pretende brindar una perspectiva enriquecedora y fundamentada sobre la relación entre las actividades extracurriculares y el rendimiento académico, lo que permitirá a los estudiantes, educadores y demás actores involucrados tomar decisiones informadas y mejorar la experiencia educativa en UTEC.

## 1.1 Relevancia

La relevancia de este informe es el obtener la relación entre las actividades extracurriculares y el rendimiento académico de los alumnos de pre grado en UTEC. Se proporcionará un análisis detallado y minucioso, este informe busca comprender las conexiones directas e indirectas entre las actividades realizadas por los estudiantes y su impacto en el promedio ponderado obtenido. Esto es de suma importancia, ya que brinda una oportunidad invaluable para que los estudiantes, educadores y padres tomen decisiones informadas y estratégicas en relación con la participación en actividades extracurriculares. Además, al explorar el tiempo invertido por los estudiantes en estas actividades y la diversidad de las mismas, se obtiene una comprensión más profunda de cómo las diferentes características pueden influir en el rendimiento académico. 

## 1.2 Objetivos

### 1.2.1 Objetivo general

Realizar un estudio estadístico aplicando los conocimientos adquiridos en el curso para identificar la influencia de las actividades extracurriculares en el rendimiento académico de los alumnos de pregrado de UTEC

### 1.2.2 Objetivos específicos

- Analizar la relación de las variables relacionadas a las actividades extracurriculares (realización de actividades extracurriculares, tiempo dedicada a las actividades extracurriculares y cantidad de actividades extracurriculares) con el promedio de los estudiantes en el ciclo 2022_2

- Analizar el efecto de los tipos de actividades extracurriculares en el promedio 2022_2

- Analizar otras posibles influencias en el rendimiento académico (cantidad de cursos y facilidades brindadas a los estudiantes que realizan actividades extracurriculares)

## 1.3 Contexto

En la educación superior, el rendimiento académico de los estudiantes de pregrado es una preocupación importante tanto para los propios alumnos como para las instituciones educativas. Además de las clases y los estudios regulares, las actividades extracurriculares juegan un papel significativo en la vida universitaria. Estas actividades pueden abarcar una amplia gama de opciones, como participar en clubes estudiantiles, equipos deportivos, organizaciones comunitarias o culturales, eventos artísticos, voluntariado y muchas otras oportunidades fuera del plan de estudios.

La influencia de las actividades extracurriculares en el rendimiento académico de los alumnos de pregrado ha sido objeto de atención y debate en la investigación educativa. Se plantea la pregunta de si participar en actividades extracurriculares puede tener un impacto positivo o negativo en el rendimiento académico de los estudiantes. La respuesta a esta pregunta no es simple, ya que varios factores pueden influir en la relación entre las actividades extracurriculares y el desempeño académico.

# **2.Datos**

## 2.1 Recolección de Datos

Para este proceso realizamos una encuesta con la finalidad de recolectar todos los datos a utilizar en nuestro estudio. Para acceder a la encuesta utilizamos las técnicas de enlace directo y ofrecer un QR. Como medio de difusión utilizamos canales digitales como Gmail o Whatsapp; del mismo modo, recurrimos a preguntar presencialmente dentro del campus de UTEC. Como incentivo utilizamos un premio de 50 soles que sería sorteado entre todos los participantes de la encuesta, así garantizamos una cantidad considerable de respuestas.

## 2.2 Población, muestra y muestreo

La población está compuesta por estudiantes de pregrado de UTEC que realizan actividades extracurriculares o no. Se tenía una muestra de 179 estudiantes, pero con la limpieza de datos se obtuvo una muestra representativa de 173 estudiantes. El muestreo es del tipo aleatorio simple

## 2.3. Variables

| **Variable**                  | **Descripción**                                                                                                                             | **Tipo**              |
|------------------------------|-------------------|-----------------------|
| *Edad*                        | Edad del estudiante de pregrado de UTEC                                                                                                     | Cuantitativa discreta |
| *Género*                      | Se consideran los géneros femenino, masculino y otra identidad                                                                              | Cualitativa nominal   |
| *Carrera*                     | Son todas las carreras que ofrece UTEC                                                                                                      | Cualitativa nominal   |
| *Realización_actividad_extra* | ¿El estudiante realiza alguna actividad extracurricular? Se limita a dos respuestas: Sí / No                                                | Cualitativa nominal   |
| *Tiempo_semanal_actividad*    | Representa la cantidad de tiempo en horas que el estudiante invierte en sus actividades extracurriculares                                   | Cuantitativa continua |
| *Deportivas*                  | Tipo de actividad extracurricular                                                                                                           | Cualitativa nominal   |
| *Académicas*                  | Tipo de actividad extracurricular                                                                                                           | Cualitativa nominal   |
| *Recreacionales*              | Tipo de actividad extracurricular                                                                                                           | Cualitativa nominal   |
| *Trabajo*                     | Tipo de actividad extracurricular                                                                                                           | Cualitativa nominal   |
| *Cantidad_actividad_extra*    | Representa la cantidad de actividades extracurriculares que realiza el estudiante                                                           | Cuantitativa discreta |
| *Influencia_actividad*        | Representa la opinión de los estudiantes respecto a la influencia de las actividades extracurriculares en el promedio                       | Cualitativa ordinal   |
| *Facilidad_actividad*         | Representa la percepción de los estudiantes sobre si las actividades extracurriculares le permiten realizar sus obligaciones universitarias | Cualitativa ordinal   |
| *Promedio_2022.2*             | Representa el promedio del estudiante en el periodo 2022-2                                                                                  | Cuantitativa continua |
| *Ninguna*                     | Facilidades que brinda UTEC                                                                                                                 | Cualitativa nominal   |
| *Becas*                       | Facilidades que brinda UTEC                                                                                                                 | Cualitativa nominal   |
| *Instalaciones*               | Facilidades que brinda UTEC                                                                                                                 | Cualitativa nominal   |
| *Horarios.flexibles*          | Facilidades que brinda UTEC                                                                                                                 | Cualitativa nominal   |
| *Cursos_2022.2*               | Representa la cantidad de cursos del estudiante en el periodo 2022-2                                                                        | Cuantitativa discreta |

## 2.4 Limpieza de datos

\-**Corrección de datos**: Se corrige los datos de cada variable y se modifican algunos errores de escritura por parte de los encuestados.

Lectura de la base de datos

```{r}
RR<-read.csv("Influe.csv")
```

Creación de una copia de la base de datos

```{r}
(RRL = RR)
```

Librerías a usar

```{r}
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
```

Variable Edad

```{r}
unique(RRL$Edad) 
```

```{r}
RRL %>% mutate(Edad = 
        ifelse(Edad == 993709676, NA, Edad))-> RRL
RRL %>% count(Edad)
```

Variable Género

```{r}
unique(RRL$Genero) 
```

```{r}
RRL %>% mutate(Genero = 
        ifelse(Genero == "", NA, Genero))-> RRL
RRL %>% count(Genero)
```

Variable Carrera

```{r}
unique(RRL$Carrera) 
```

```{r}
RRL %>% mutate(Carrera = 
        ifelse(Carrera == "", NA, Carrera))-> RRL
RRL %>% count(Carrera)
```

Variable Realización_actividad_extra

```{r}
unique(RRL$Realizacion_actividad_extra) 
```

```{r}
RRL %>% mutate(Realizacion_actividad_extra = 
        ifelse(Realizacion_actividad_extra == "", NA, Realizacion_actividad_extra))-> RRL
RRL %>% count(Realizacion_actividad_extra)
```

Variable Deportivas

```{r}
RRL %>% count(Deportivas)
```

```{r}
RRL %>% mutate(Deportivas= 
        ifelse(Deportivas == "S\xed", "Sí", Deportivas))-> RRL
RRL %>% count(Deportivas)
```

Variable Recreacionales

```{r}
RRL %>% count(Recreacionales)
```

```{r}
RRL %>% mutate(Recreacionales= 
        ifelse(Recreacionales == "S\xed", "Sí", Recreacionales))-> RRL
RRL %>% count(Recreacionales)
```

Variable Académicas

```{r}
RRL %>% count(Académicas)
```

```{r}
RRL %>% mutate(Académicas= 
        ifelse(Académicas == "S\xed", "Sí", Académicas))-> RRL
RRL %>% count(Académicas)
```

Variable Trabajo

```{r}
RRL %>% count(Trabajo)
```

```{r}
RRL %>% mutate(Trabajo= 
        ifelse(Trabajo == "S\xed", "Sí", Trabajo))-> RRL
RRL %>% count(Trabajo)
```

Variable Cantidad actividad extra

```{r}
unique(RRL$Cantidad_actividad_extra) 
```

```{r}
RRL %>% mutate(Cantidad_actividad_extra = 
        ifelse(Cantidad_actividad_extra == "", NA,
        ifelse(Cantidad_actividad_extra == "0", NA,       
               Cantidad_actividad_extra)))-> RRL
RRL %>% count(Cantidad_actividad_extra)
```

```{r}
class(RRL$Cantidad_actividad_extra)
```

Variable Tiempo_semanal_actividad

```{r}
unique(RRL$Tiempo_semanal_actividad) 
```

```{r}
RRL$Tiempo_semanal_actividad = str_replace(RRL$Tiempo_semanal_actividad,",", ".")
RRL %>% count(Tiempo_semanal_actividad)
```

```{r}
RRL %>% mutate(Tiempo_semanal_actividad= 
        ifelse(Tiempo_semanal_actividad %in% c("", "0"), NA,
        ifelse(Tiempo_semanal_actividad== "2 horas ", 2,
        ifelse(Tiempo_semanal_actividad == "1 hora", 1,
        ifelse(Tiempo_semanal_actividad == "3h", 3, 
               Tiempo_semanal_actividad)))))-> RRL
```

Variable Influencia_actividad

```{r}
unique(RRL$Influencia_actividad) 
class(RRL$Influencia_actividad)
```

Variable Facilidad_actividad

```{r}
unique(RRL$Facilidad_actividad) 
class(RRL$Facilidad_actividad)
```

Variable Promedio_2022.2

```{r}
unique(RRL$Promedio_2022.2) 
```

```{r}
RRL$Promedio_2022.2 = str_replace(RRL$Promedio_2022.2,",", ".")
RRL %>% count(Promedio_2022.2)
```

```{r}
RRL %>% mutate(Promedio_2022.2= 
        ifelse(Promedio_2022.2 %in% c("","Primer ciclo", "Estoy en 1er ciclo ", "No estuve ","Estoy en mi primer ciclo ", "Entre el 2023-1"), NA,
        
              Promedio_2022.2))-> RRL
```

```{r}
class(RRL$Promedio_2022.2)
```

Variable Ninguna

```{r}
RRL %>% count(Ninguna)
```

```{r}
RRL %>% mutate(Ninguna= 
        ifelse(Ninguna == "S\xed", "Sí", Ninguna))-> RRL
RRL %>% count(Ninguna)
```

Variable Instalaciones

```{r}
RRL %>% count(Instalaciones)
```

```{r}
RRL %>% mutate(Instalaciones= 
        ifelse(Instalaciones == "S\xed", "Sí", Instalaciones))-> RRL
RRL %>% count(Instalaciones)
```

Variable Becas

```{r}
RRL %>% count(Becas)
```

```{r}
RRL %>% mutate(Becas= 
        ifelse(Becas == "S\xed", "Sí", Becas))-> RRL
RRL %>% count(Becas)
```

Variable Horarios.flexibles

```{r}
RRL %>% count(Horarios.flexibles)
```

```{r}
RRL %>% mutate(Horarios.flexibles= 
        ifelse(Horarios.flexibles == "S\xed", "Sí",Horarios.flexibles))-> RRL
RRL %>% count(Horarios.flexibles)
```

Variable Cursos_2022.2

```{r}
unique(RRL$Cursos_2022.2) 
class(RRL$Cursos_2022.2)
```

```{r}
RRL %>% mutate(Cursos_2022.2= 
        ifelse(Cursos_2022.2 %in% c("", "Ninguno", "colegio", "No estuve ", "0"), NA, 
               Cursos_2022.2))-> RRL
RRL %>% count(Cursos_2022.2)
```

\-**Eliminación de columnas innecesarias**: Se tenían las variables Tipo_actividad_extra que representaba el tipo de actividades extracurriculares que realizaban los estudiantes (deportivas, académicas, recreacionales o trabajo) y Facilidades_UTEC que representaba las facilidades que brindaba UTEC a los estudiantes que realizaban las actividades extracurriculares (Ninguna, becas, instalaciones u horarios flexibles). Debido a que estas dos variables eran de opción múltiple, se procedió a tomar sus posibles respuestas como nuevas variables para que el análisis sea más sencillo; se eliminaron las dos variables luego de la creación de sus reemplazos.

Variable Tipo_actividad_extra

```{r}
RRL <- select(RRL, -Tipo_actividad_extra)
```

Variable Facilidades_UTEC

```{r}
RRL<- select (RRL, -Facilidades_UTEC)
```

\-**Cambio al correcto tipo de variable**: Se tenían seis variables que estaban en su categoría incorrecta, por lo que se realizó el cambio al tipo de datos correcto.

```{r}
RRL$Cantidad_actividad_extra <- as.integer(RRL$Cantidad_actividad_extra)
```

```{r}
RRL$Tiempo_semanal_actividad <- as.numeric(RRL$Tiempo_semanal_actividad)
```

```{r}
RRL$Influencia_actividad <- as.character(RRL$Influencia_actividad)
```

```{r}
RRL$Facilidad_actividad<- as.character(RRL$Facilidad_actividad)
```

```{r}
RRL$Promedio_2022.2<- as.numeric(RRL$Promedio_2022.2)
```

```{r}
RRL$Cursos_2022.2<- as.integer(RRL$Cursos_2022.2)
```

\-**Observaciones con NA**: Aquellos casos con datos incompletos son debido a que hay encuestados que no realizan actividades extracurriculares y por ende, hay variables que no son necesarias de completar para su caso. En el caso de los que respondieron que sí realizan actividades extracurriculares, las observaciones están completas. Se quiere ver la comparación de los que sí toman actividades extracurriculares y su rendimiento académico entre los que no toman actividades extracurriculares y su rendimiento académico. Debido a esto, se dejan las observaciones incompletas, las cuales cuentan con datos relevantes para el análisis (Realización_actividad_extra y Promedio_2022.2). Cabe recalcar que para el análisis de las demás variables, solo se considera a los que sí tienen actividades extracurriculares; se excluyen las observaciones que tienen estudiantes que no realizan actividades extracurriculares para esos análisis. Además, se encuentra entre la población a 6 estudiantes que son del primer ciclo (no realizan actividades extracurriculares), por lo que son eliminados en la base de datos copia *r*.

```{r}
sum(is.na(RRL$Realizacion_actividad_extra))
sum(is.na(RRL$Promedio_2022.2))
```

```{r}
r<- RRL%>% drop_na(Realizacion_actividad_extra, Promedio_2022.2)
```

# **3.Análisis descriptivo**

## 3.1 Análisis de la variable *Realizacion_actividad_extra*

```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla1 <- table(r$Realizacion_actividad_extra)
tabla1
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
barp1 <- barplot(tabla1, col = rainbow(2), ylim = c(0, 145), main = "Realización de actividad extracurricular", xlab = "¿Realiza alguna actividad extracurricular?", ylab = "Frecuencia absoluta")
text(barp1, tabla1 + 6, labels= tabla1)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
R<- function(n){
  round(n,2)
}
```

```{r}
R((41/173)*100)
R((132/173)*100)
```

De los encuestados (179), el 23.7% no realizan alguna actividad extracurricular, mientras que el 76.3% sí. La mayoría participa en alguna actividad ajena a la universidad.

## 3.2 Análisis de las variables *Promedio_2022.2* y *Realizacion_actividad_extra*

```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(r$Promedio_2022.2  ~ r$Realizacion_actividad_extra, xlab = "Realización de alguna actividad extracurricular", ylab = "Promedio en el periodo 2022-2", main= "Realización de AE vs Promedio 2022-2" )
```
```{r}
summary(r[r$Realizacion_actividad_extra =="Sí",13])
summary(r[r$Realizacion_actividad_extra =="No",13])
```


```{r}
R(sd(r[r$Realizacion_actividad_extra =="Sí",13]))
R(1.92/14.73)*100 #se puede usar media como medida de ubicación
```

```{r}
R(sd(r[r$Realizacion_actividad_extra =="No",13]))
R(1.9/15.04)*100 #se puede usar media como medida de ubicación
```

Respecto al promedio de los que sí realizan alguna actividad extracurricular se tiene lo siguiente: máx=19, mín= 8, rango= máx- mín= 11, mediana=15, IQR=Q3-Q1=16 - 13.78=2.22, media=14.73

Respecto al promedio de los que no realizan alguna actividad extracurricular se tiene lo siguiente: máx=18.26, mín= 11.30, rango= máx- mín= 6.96, mediana=15.26, IQR=Q3-Q1=16.42 - 14=2.42, media=15.04

No hay mucha diferencia entre los promedios de los que sí hacen actividades extracurriculares y los que no. El 50% de casos centrales de los que sí hacen actividades extracurriculares oscila en el intervalo de (13.78,16) y el de los que no en el intervalo de (14,16.42). Además, la media de los que sí hacen actividades extracurriculares es 14.73 y de los que no, 15.04; hay una ligera ventaja de 0.31 para el promedio de los que no hacen actividades extracurriculares; sin embargo, las medias de los promedios de los que sí hacen actividades extracurriculares y de los que no hacen actividades extracurriculares son cercanas.

> A partir de aquí, se da el análisis de las distintas variables pero sólo se cuenta a los estudiantes que sí realizan actividades extracurriculares

```{r}
h<- RRL
h= h[h$Realizacion_actividad_extra =="Sí", c(1:18)] 
h #Estudiantes que sí realizan actividades extracurriculares 
```

De los estudiantes que hacen actividades extracurriculares (132), el 35% son mujeres, el 63% son hombres y el 2% restante se identifican con otro género

## 3.3 Análisis de *Tiempo_semanal_actividad* y *Promedio_2022.2*

```{r}
sum(is.na(h$Tiempo_semanal_actividad))
```

```{r}
corr <- cor(h$Tiempo_semanal_actividad, h$Promedio_2022.2)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
plot(x=h$Tiempo_semanal_actividad, y=h$Promedio_2022.2,xlab = "Tiempo semanal dedicado a la actividad extracurricular(horas)", ylab = "Promedio en el periodo 2022.2", main= "Tiempo semanal para las AE vs promedio 2022-2")
regresion <- lm(Promedio_2022.2 ~ Tiempo_semanal_actividad, data = h)
abline(regresion)
text(paste("Correlación:", round(corr, 2)), x = 30, y = 18)
```

Al ser la correlación tan cercana a 0, se puede afirmar que el tiempo dedicado a las actividades extracurriculares no afecta al promedio de los estudiantes.

## 3.4 Análisis de las variables *Cantidad_actividad_extra* y *Promedio_2022-2*

```{r}
corr2 <- cor(h$Cantidad_actividad_extra, h$Promedio_2022.2)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(h$Promedio_2022.2 ~ h$Cantidad_actividad_extra, xlab = "Cantidad de actividades extracurriculares", ylab = "Promedio en el periodo 2022.2")
text(paste("Correlación:", round(corr2, 2)), x = 4, y = 18)
```
```{r}
summary(h[h$Cantidad_actividad_extra ==1,13])
summary(h[h$Cantidad_actividad_extra==2,13])
summary(h[h$Cantidad_actividad_extra==3,13])
summary(h[h$Cantidad_actividad_extra==4,13])
summary(h[h$Cantidad_actividad_extra==5,13])
```


Al ser la correlación tan cercana a 0, se puede afirmar que la cantidad de actividades extracurriculares realizadas no afecta al promedio de los estudiantes. Las medianas no están tan alejadas las unas de las otras y sus valores están en el intervalo (14.34, 16.05).

## 3.5 Análisis de las variables *Deportivas* y *Promedio_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
hist(h[h$Deportivas=="Sí", 13], xlab= "Promedio del periodo 2022.2 de estudiantes que hacen deporte", ylab = "Frecuencia absoluta", main= "Promedio de estudiantes que hacen deporte", ylim= c(0,20))
```
```{r}
summary(h[h$Deportivas=="Sí", 13])
```


Notamos que la moda se da en el intervalo de 14 a 15 y de 15 a 16. Entonces, los estudiantes que hacen deporte mayormente tienen un promedio de 14 a 16. Los estudiantes que practican deporte tienden a tener un promedio aprobatorio. Se observa un dato atípico, el cual es el 8. El promedio mínimo fue 8 y el máximo, 19.

## 3.6 Análisis de las variables *Académicas* y *Promedio_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
hist(h[h$Académicas=="Sí", 13], xlab= "Promedio del periodo 2022.2", ylab = "Frecuencia absoluta", main= "Promedio estudiantes con AE académicas")
```
```{r}
summary(h[h$Académicas=="Sí", 13])
```


Notamos la moda en el intervalo de 14 a 16. Los estudiantes que practican actividades extracurriculares académicas tienden a sacar un promedio entre 14 a 16, al igual de los que practican deporte, pero con mayor frecuencia respecto a su total de estudiantes. El promedio mínimo fue 8 y el máximo, 18.20.

## 3.7 Análisis de las variables *Recreacionales* y *Promedio_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
hist(h[h$Recreacionales =="Sí", 13] ,xlab= "Promedio del periodo 2022.2", ylab = "Frecuencia absoluta", main= "Promedio de estudiantes con AE recreacionales")
```
```{r}
summary(h[h$Recreacionales =="Sí", 13])
```

Los estudiantes que practican actividades extracurriculares recreacionales tienden a tener un promedio entre 15 a 16. Se tiene como mediana o valor central a 14.85. El mínimo promedio fue 10 y el máximo, 19.

## 3.8 Análisis de las variables *Trabajo* y *Promedio_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
hist(h[h$Trabajo =="Sí", 13] ,xlab= "Promedio del periodo 2022.2", ylab = "Frecuencia absoluta", main= "Promedio de estudiantes con trabajo")
```
```{r}
summary(h[h$Trabajo =="Sí", 13])
```

Los estudiantes que trabajan también tienden a tener un promedio entre 14 y 16. Se tiene como valor central a 14.80. El promedio mínimo es 8 y el máximo 17.21.

## 3.9 Análisis de la variable *Cursos_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla2<- table(h$Cursos_2022.2)
barplot(tabla2,main="Cantidad de cursos 2022-2 de estudiantes con AE", xlab="Cantidad de cursos 2022-2", ylab= "Frecuencia absoluta", col=rainbow(10))
```

De los estudiantes que toman actividades extracurriculares, notamos que la mayoría prefiere tomar 6 cursos en un ciclo.

## 3.10 Análisis de las variables *Cursos_2022.2* y *Promedio_2022.2*

```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(h$Promedio_2022.2 ~ h$Cursos_2022.2, xlab="Cantidad de cursos 2022-2", ylab = "Promedio 2022-2", main= "Cantidad de cursos 2022-2 vs Promedio 2022-2")
```

```{r}
summary(h[h$Cursos_2022.2 == 1, 13])
summary(h[h$Cursos_2022.2 == 2, 13])
summary(h[h$Cursos_2022.2 == 3, 13])
summary(h[h$Cursos_2022.2 == 4, 13])
summary(h[h$Cursos_2022.2 == 5, 13])
summary(h[h$Cursos_2022.2 == 6, 13])
summary(h[h$Cursos_2022.2 == 7, 13])
summary(h[h$Cursos_2022.2 == 8, 13])
summary(h[h$Cursos_2022.2 == 9, 13])
summary(h[h$Cursos_2022.2 == 10, 13])
```

Se observa que las medianas llegan a variar entre 14 y 16. Se puede observar que las personas que llevaron un solo curso tuvieron una gran diferencia de promedio entre ellas mismas, oscilando entre 8 y 17. A esto, le siguen las personas matriculadas en 10 cursos, quienes tuvieron notas que oscilaron entre 11 y 19. El resto de alumnos matriculados en cursos desde 2 a 8, tuvieron notas con no mucha dispersión entre ellos mismos.

## 3.11 Análisis de la variable *Ninguna* 
```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla3<- table(h$Ninguna)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
barp3<-barplot(tabla3,main="Estudiantes que realizan actividades extracurriculares", xlab="¿Recibes ninguna facilidad por la actividad extracurrilar que haces?", ylab= "Frecuencia", col=rainbow(10), ylim = c(0,100))
text(barp3, tabla3 + 6, labels= tabla3)
```
```{r}
R(43/132)*100
R(89/132)*100
```

Se observa que 43 estudiantes de los 132 que realizan actividades extracurriculares son los que reciben alguna facilidad por parte de la universidad y 89 personas no reciben ayuda alguna.
Esto significa que sólo el 33% considera o recibe ayuda por parte la universidad, mientras que el 67% no recibe o no considera alguna facilidad por la actividad extracurricular que realiza.


## 3.12 Análisis de las variables *Promedio_2022.2* y *Ninguna* 
```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(r$Promedio_2022.2  ~ r$Ninguna, xlab = "¿Recibes ninguna facilidad por la actividad extracurrilar que haces?", ylab = "Promedio en el periodo 2022-2", main= "Relación entre Ninguna y el Promedio 2022-2" )

```
<br>Personas que no reciben ayuda:<br>
```{r}
summary(r[r$Ninguna =="Sí",13])
```

<br>Personas que reciben ayuda:<br>
```{r}
summary(r[r$Ninguna =="No",13])
```


<br>De este gráfico se puede extraer que no hay mucha diferencia entre la mediana de los promedios de los estudiantes que cuentan o no con alguna facilidad por la realización de actividades extracurriculares. No hay mucha diferencia a excepción de la nota mínima, la cual es menor en los que no reciben ayuda.


## 3.13 Análisis de la variable *Instalaciones* 

```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla5<- table(h$Instalaciones)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
barp5<-barplot(tabla5,main="Estudiantes que realizan actividades extracurriculares", xlab="¿Cuenta con instalaciones como facilidad para su actividad extracurricular?", ylab= "Frecuencia", col=rainbow(10), ylim = c(0,150))
text(barp5, tabla5 + 6, labels= tabla5)
```
```{r}
R(119/132)*100
R(13/132)*100
```
<br> Se observa que 13 estudiantes cuentan con instalaciones para su actividad extracurricular por parte de la universidad, mientras que los otros 119 estudiantes no. Esto significa que sólo el 10% tiene instalaciones como apoyo a su actividad extracurricular.

## 3.14 Análisis de las variables *Promedio_2022.2* e *Instalaciones*
```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(r$Promedio_2022.2  ~ r$Instalaciones, xlab = "¿Cuenta con instalaciones como facilidad para su actividad extracurricular?", ylab = "Promedio en el periodo 2022-2", main= "Relación entre Instalaciones y el Promedio 2022-2", ylim=c(8,20) )


```

<br>Personas que tienen instalaciones como ayuda:<br>
```{r}
summary(r[r$Instalaciones =="Sí",13])
```

<br>Personas que no tienen instalaciones como ayuda:<br>
```{r}
summary(r[r$Instalaciones =="No",13])
```
<br>De este gráfico se puede extraer que no hay mucha diferencia entre los resultados, por lo que no hay gran variación a excepción de la nota mínima y máxima. La nota mínima es menor en los que no tienen instalaciones como ayuda, pero también cuentan con mayor nota máxima.



## 3.15 Análisis de la variable *Horarios.flexibles*

```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla6<- table(h$Horarios.flexibles)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
barp6<-barplot(tabla6,main="Estudiantes que realizan actividades extracurriculares", xlab="¿Cuenta con horarios flexibles en la universidad para realizar todas sus actividades?", ylab= "Frecuencia absoluta", col=rainbow(10), ylim = c(0,120))
text(barp6, tabla6 + 6, labels= tabla6)
```

<br>En el siguiente gráfico se observa que 33 de 132 estudiantes consideran que tienen horarios flexibles por parte de la universidad. El 25% percibe el contar con horarios flexibles para realizar sus actividades extracurriculares y obligaciones universitarias tranquilamente; sin embargo, el 75% no percibe lo mismo


## 3.16 Análisis de las variables *Promedio_2022.2* y *Horarios.flexibles*
```{r,echo = FALSE, results = 'asis', message= FALSE}
boxplot(r$Promedio_2022.2  ~ r$Horarios.flexibles, xlab = "¿Cuenta con horarios flexibles en la universidad para realizar todas sus actividades?", ylab = "Promedio en el periodo 2022-2", main= "Relación entre Horarios Flexibles y el Promedio",ylim=c(8,20) )
```

<br>Personas que consideran tener horarios flexibles:<br>

```{r}
summary(r[r$Horarios.flexibles =="Sí",13])
```

<br>Personas que no consideran tener horarios flexibles:<br>

```{r}
summary(r[r$Horarios.flexibles=="No",13])
```

<br>De este gráfico se puede observar que, a pesar de contar con la misma mediana y no tener sus medias tan lejos de la otra, la nota mínima de los que no tienen horarios flexibles es notablemente inferior a la de los que sí perciben tener horarios flexibles. A comparación de las otras observaciones, la falta de horarios flexibles afecta notoriamente a los estudiantes.



## 3.17 Análisis de la variable *Becas*
```{r,echo = FALSE, results = 'asis', message= FALSE}
tabla7<- table(h$Becas)
```

```{r,echo = FALSE, results = 'asis', message= FALSE}
barp7<-barplot(tabla7,main="Estudiantes que realizan actividades extracurriculares", xlab="¿Cuenta con beca por su actividad extracurricular?", ylab= "Frecuencia absoluta", col=rainbow(10), ylim = c(0,150))
text(barp7, tabla7 + 6, labels= tabla7)
```
```{r}
R(127/132)*100
R(5/132)*100
```
<br>Se observa que solo 5 estudiantes son becados y 127 estudiantes no, esto de un total de 132 personas. Esto significa que sólo el 4% son becados por su actividad extracurricular, mientras que el 96% restante no recibe esta facilidad. 


## 3.18 Análisis de las variables *Promedio_2022.2* y *Becas*
```{r,echo = FALSE, results = 'asis', message= FALSE}
  boxplot(r$Promedio_2022.2  ~ r$Becas, xlab = "¿Cuenta con beca por su actividad extracurricular?", ylab = "Promedio en el periodo 2022-2", main= "Alumnos Becados que hacen AE y el Promedio 2022-2",ylim=c(8,20) )
```
<br>Personas becadas:<br>
```{r}
summary(r[r$Becas =="Sí",13])
```

<br>Personas no becadas:<br>
```{r}
summary(r[r$Becas =="No",13])
```

<br>De este gráfico se puede extraer que la media y mediana de los becados es menor que la de los no becados. En este caso, la facilidad no influye de forma positiva en el promedio del estudiante que realiza alguna actividad extracurricular.


# **4.Análisis probabilístico**

## 4.1 Probabilidad:

**Probabilidad empírica**

- *Promedio en el ciclo 2022-2: *

Primero determinamos el espacio maestral.

```{r}
length(h$Promedio_2022.2)

table(h$Promedio_2022.2)
```

Como podemos observar la variable promedio en el ciclo 2022-2 esta dispuesta en decimales, por lo que se ha elaborado un código para convertir dichas variables dentro de rangos como valores enteros.

```{r}
# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

# Convertir la columna "Promedio_2022.2" a tipo numérico
h$Promedio_2022.2 <- as.numeric(as.character(h$Promedio_2022.2))

# Redondear hacia abajo cada valor de nota promedio al número entero más cercano
h$Promedio_entero <- floor(h$Promedio_2022.2)

# Calcular la frecuencia de cada valor entero en la columna "Promedio_entero"
frecuencias <- table(h$Promedio_entero)

# Imprimir la cantidad total de registros
cat("Cantidad total de registros:", cantidad_total, "\n\n")

# Imprimir la cantidad de personas para cada promedio entero
cat("Cantidad de personas por promedio entero en el ciclo 2022-2:\n")
for (i in 1:length(frecuencias)) {
  promedio_entero <- as.character(names(frecuencias[i]))
  cantidad <- frecuencias[i]
  cat("La cantidad de alumnos con", promedio_entero, "de nota promedio, son:", cantidad, "\n")
}
```

Ahora calculamos la función probabilidad para los eventos atómicos:

```{r}

# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

# Convertir la columna "Promedio_2022.2" a tipo numérico
h$Promedio_2022.2 <- as.numeric(as.character(h$Promedio_2022.2))

# Redondear hacia abajo cada valor de nota promedio al número entero más cercano
h$Promedio_entero <- floor(h$Promedio_2022.2)

# Calcular la frecuencia de cada valor entero en la columna "Promedio_entero"
frecuencias <- table(h$Promedio_entero)

# Crear vectores para almacenar los valores de frecuencia
Valores_F <- as.numeric(names(frecuencias))
Probabilidad_F <- as.vector(frecuencias) / cantidad_total
Fraccion_F <- paste(frecuencias, "/", cantidad_total, sep = "")

# Crear el dataframe con los resultados
C_Frec <- data.frame(Valores_F, Probabilidad_F, Fraccion_F)

# Mostrar los resultados
C_Frec

```

Aquí lo que más resalta es la probabilidad de seleccionar a un estudiante y que presente una nota promedio entera durante el ciclo 2022-2, siendo 15 la mayor de todas con un aproximado de 0.21. Mientras que la probabilidad de seleccionar a un estudiante y que presente 10 o 18 de promedio aproximado durante el ciclo 2022-2 es de 0.0076, siendo las menores del estudio de esta variable.

- *Cantidad de actividades extracurriculares:*

Primero determinamos el espacio muestral:

```{r}
length(h$Cantidad_actividad_extra)

table(h$Cantidad_actividad_extra)
```

Ahora calculamos la función probabilidad para los eventos atómicos:

```{r}
Valores_C <- c(sort(unique(c(h$Cantidad_actividad_extra)), decreasing = FALSE))
Probabilidad_C <- c(as.vector(table(h$Cantidad_actividad_extra))/length(h$Cantidad_actividad_extra))
Fraccion_C <- paste((table(h$Cantidad_actividad_extra)), "/", length(h$Cantidad_actividad_extra), sep = "")

C_Ciclo <- data.frame(Valores_C, Probabilidad_C, Fraccion_C)
C_Ciclo

```

Lo que más resalta en las probabilidades de eventos atómicos para esta variable es la probabilidad de encontrar a un estudiante que realice 2 actividades extracurriculares, con el 0.39. Mientras que la probabilidad de encontrar a un estudiante que realice 5 actividades extracurriculares es la menor, con una probabilidad de 0.03.

**Probabilidad condicional:**

***Entre Cantidad de actividades extracurriculares realizadas y Promedio en el ciclo 2022-2 de las personas que realizaban dichas actividades:***

Primero determinamos la cantidad de personas por éxito. Definiéndose en este par de eventos como éxito de la primera variable notas menores y, mayores o iguales a 15.\

```{r}
# Cantidad de notas mayores y menores a 15
notas_mayores_15 <- sum(h$Promedio_entero >= 15)
notas_menores_15 <- sum(h$Promedio_entero < 15)

# Crear dataframe con los resultados
resultados_notas <- data.frame(
  Categoría = c("Notas mayores o iguales a 15", "Notas menores a 15"),
  Cantidad = c(notas_mayores_15, notas_menores_15)
)

# Mostrar tabla de resultados
print(resultados_notas)
```

\
También definiremos el éxito de la variable *Cantidad de actividades extracurriculares* como mayores o iguales a 3, y menores a 3.

```{r}
# Cantidad de actividades extracurriculares mayores o iguales a 3
extracurriculares_mayores_3 <- sum(h$Cantidad_actividad_extra >= 3)

# Cantidad de actividades extracurriculares menores a 3
extracurriculares_menores_3 <- sum(h$Cantidad_actividad_extra < 3)

# Crear dataframe con los resultados
resultados_actividades <- data.frame(
  Categoría = c("Actividades extracurriculares mayores o iguales a 3", "Actividades extracurriculares menores a 3"),
  Cantidad = c(extracurriculares_mayores_3, extracurriculares_menores_3)
)

# Mostrar tabla de resultados
print(resultados_actividades)


```

1.  **Primer evento:**

    A: "Seleccionar un estudiante cuyo promedio sea mayor o igual a 15."

    B: "Seleccionar un estudiante que realiza 3 o más actividades extracurriculares."\

    ```{r}
    # Obtener la cantidad de personas con notas mayores o iguales a 15
    notas_mayores_15 <- resultados_notas$Cantidad[1]

    # Obtener la cantidad de actividades extracurriculares mayores o iguales a 3
    extracurriculares_mayores_3 <- resultados_actividades$Cantidad[1]

    # Obtener la cantidad de personas con notas mayores o iguales a 15 y que realizan 3 o más actividades extracurriculares
    personas_mayor_igual_15_3_actividades <- sum(h$Promedio_entero >= 15 & h$Cantidad_actividad_extra >= 3)

    # Calcular las probabilidades empíricas
    P_A <- notas_mayores_15 / cantidad_total
    P_B <- extracurriculares_mayores_3 / cantidad_total
    P_A_interseccion_B <- personas_mayor_igual_15_3_actividades / cantidad_total
    P_A_dado_B <- P_A_interseccion_B / P_B

    # Verificar si los eventos A y B son dependientes o independientes
    if (P_A_interseccion_B == P_A * P_B) {
      dependencia <- FALSE
    } else {
      dependencia <- TRUE
    }

    # Imprimir los resultados
    cat("Probabilidad de A (promedio mayor o igual a 15):", P_A, "\n")
    cat("Probabilidad de B (actividades extracurriculares mayores o iguales a 3):", P_B, "\n")
    cat("Probabilidad de A intersección B:", P_A_interseccion_B, "\n")
    cat("Probabilidad de A dado B:", P_A_dado_B, "\n")
    cat("Los eventos A y B son dependientes:", dependencia, "\n")



    ```

    En resumen, hemos realizado el cálculo correcto de las probabilidades empíricas y hemos verificado que los eventos A y B son dependientes, ya que P(A ∩ B) no es igual a P(A)P(B). También hemos calculado P(A\|B) que nos indica la probabilidad de que un estudiante seleccionado tenga un promedio mayor o igual a 15 si realiza 3 o más actividades extracurriculares. En este caso, P(A\|B) es aproximadamente 0.56, lo que significa que si un estudiante realiza 3 o más actividades extracurriculares, hay una alta probabilidad de que su promedio sea mayor o igual a 15.

2.  **Segundo evento:**

    A: "Seleccionar un estudiante cuyo promedio sea menor a 15."

    B: "Seleccionar un estudiante que realiza menos de 3 actividades extracurriculares."

    Recordemos que previo al cálculo necesitamos la intersección entre A y B.

    Y con esto podremos calcular la verificación de independencia entre este par de variables durante este evento.

    ```{r}
    # Obtener la cantidad de personas con notas mayores o iguales a 15
    notas_mayores_15 <- resultados_notas$Cantidad[2]

    # Obtener la cantidad de actividades extracurriculares mayores o iguales a 3
    extracurriculares_mayores_3 <- resultados_actividades$Cantidad[2]


    # Obtener la cantidad de personas con notas menores a 15 y que realizan menos de 3 actividades extracurriculares
    personas_menor_15_3_actividades <- sum(h$Promedio_entero < 15 & h$Cantidad_actividad_extra < 3)

    # Calcular las probabilidades empíricas
    P_A <- notas_mayores_15 / cantidad_total
    P_B <- extracurriculares_mayores_3 / cantidad_total
    P_A_interseccion_B <- personas_menor_15_3_actividades / cantidad_total
    P_A_dado_B <- P_A_interseccion_B / P_B

    # Verificar si los eventos A y B son dependientes o independientes
    if (P_A_interseccion_B == P_A * P_B) {
      dependencia <- FALSE
    } else {
      dependencia <- TRUE
    }

    # Imprimir los resultados
    cat("Probabilidad de A (promedio menor a 15):", P_A, "\n")
    cat("Probabilidad de B (actividades extracurriculares menores a 3):", P_B, "\n")
    cat("Probabilidad de A intersección B:", P_A_interseccion_B, "\n")
    cat("Probabilidad de A dado B:", P_A_dado_B, "\n")
    cat("Los eventos A y B son dependientes:", dependencia, "\n")
    ```

En resumen, hemos realizado el cálculo correcto de las probabilidades empíricas y hemos verificado que los eventos A y B son dependientes, ya que P(A ∩ B) no es igual a P(A)P(B). También hemos calculado P(A\|B) que nos indica la probabilidad de que un estudiante seleccionado tenga un promedio menor a 15 si realiza menos de 3 actividades extracurriculares. En este caso, P(A\|B) es aproximadamente 0.49, lo que significa que si un estudiante realiza menos de 3 actividades extracurriculares, hay una probabilidad relativamente alta de que su promedio sea menor a 15.

*(Siguiente par de variables)*

**Probabilidad empírica:**

- *Cantidad de cursos en el ciclo 2022-2:*

Primero determinamos el espacio muestral.

```{r}
length(h$Cursos_2022.2)

table(h$Cursos_2022.2)
```

```{r}
#Cantidad de cursos del ciclo anterior

# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

# Calcular la frecuencia de cada valor único en la columna "Cursos 2022-2"
frecuencias <- table(h$Cursos_2022.2)

# Imprimir la cantidad total de registros
cat("Cantidad total de registros:", cantidad_total, "\n\n")

# Imprimir la cantidad de personas para cada cantidad distinta de Cursos 2022-2
cat("Cantidad de cursos por persona:\n")
for (act in names(frecuencias)) {
  cat("La cantidad de personas que llevaron", act, "cursos en el ciclo 2022-2 son:", frecuencias[act], "\n")
}

```

Ahora calculamos la función probabilidad para los eventos atómicos:

```{r}
Valores_C <- c(sort(unique(c(h$Cursos_2022.2)), decreasing = FALSE))
Probabilidad_C <- c(as.vector(table(h$Cursos_2022.2))/length(h$Cursos_2022.2))
Fraccion_C <- paste((table(h$Cursos_2022.2)), "/", length(h$Cursos_2022.2), sep = "")

C_Ciclo <- data.frame(Valores_C, Probabilidad_C, Fraccion_C)
C_Ciclo
```

-*Tiempo semanal dedicado a la Actividad Extracurricular:*

Primero determinamos el espacio muestral.

```{r}
length(h$Tiempo_semanal_actividad)

table(h$Tiempo_semanal_actividad)
```

Como podemos observar la variable Tiempo Semanal dedicado a Actividad Extracurricular está dispuesta en decimales, por lo que se ha elaborado un código para convertir dichas variables dentro de rangos como valores enteros.

```{r}
#Tiempo semanal de actividad extracurricular

h$Tiempo_semanal_actividad <- as.numeric(as.character(h$Tiempo_semanal_actividad))

# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

# Redondear cada cantidad de Tiempo
h$Tiempo_semanal_actividad <- floor(h$Tiempo_semanal_actividad)

# Calcular la frecuencia de cada valor único en la columna "Tiempo semanal Actividad"
frecuencias <- table(h$Tiempo_semanal_actividad)

# Imprimir la cantidad total de registros
cat("Cantidad total de registros:", cantidad_total, "\n\n")

# Imprimir la cantidad de personas para cada cantidad de tiempo semanal dedicados a Actividad Extracurricular
cat("Cantidad de personas por tiempo semanal Actividad Extracurricular:\n")
for (i in 1:length(frecuencias)) {
  tiempo_semanal <- as.character(names(frecuencias[i]))
  cantidad <- frecuencias[i]
  cat("La cantidad de alumnos que dedican", tiempo_semanal, "hora(s) a actividad extracurricular:", cantidad, "\n")
}

```

Ahora calculamos la función probabilidad para los eventos atómicos:

```{r}
# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

# Convertir la columna "Tiempo_Semanal_actividad" a tipo numérico"
h$Tiempo_semanal_actividad <- as.numeric(as.character(h$Tiempo_semanal_actividad))

# Calcular la frecuencia de cada valor entero en la columna "Tiempo_Semanal_actividad" a tipo numérico"
frecuencias <- table(h$Tiempo_semanal_actividad)

# Crear vectores para almacenar los valores de frecuencia
Valores_F <- as.numeric(names(frecuencias))
Probabilidad_F <- as.vector(frecuencias) / cantidad_total
Fraccion_F <- paste(frecuencias, "/", cantidad_total, sep = "")

# Crear el dataframe con los resultados
C_Frec <- data.frame(Valores_F, Probabilidad_F, Fraccion_F)

# Mostrar los resultados
C_Frec
```

**Probabilidad condicional:**

***Entre Cantidad de cursos en el ciclo 2022-2 y Tiempo Semanal dedicado a Actividades Extracurriculares de personas que realizaban dichas actividades:***

Primero determinamos la cantidad de personas por éxito. Definiéndose en este par de eventos como éxito de la primera variable cantidad de cursos menores y, mayores o iguales a 6.\

```{r}
# Cantidad de notas mayores y menores a 6
cursos_mayores_6 <- sum(h$Cursos_2022.2 >= 6)
cursos_menores_6 <- sum(h$Cursos_2022.2 < 6)

# Crear dataframe con los resultados
resultados_cursos <- data.frame(
  Categoría = c("Cantidad de cursos mayores o iguales a 4", "Cantidad de cursos menores a 4"),
  Cantidad = c(cursos_mayores_6, cursos_menores_6)
)

# Mostrar tabla de resultados
print(resultados_cursos)
```

\
También definiremos el éxito de la variable Tiempo Semanal dedicado a Actividades Extracurriculares como mayores o iguales a 8, y menores a 8.

```{r}
# Cantidad de Tiempo Semanal Actividad Extracurricular
tiempo_mayores_8 <- sum(h$Tiempo_semanal_actividad >= 8)

# Cantidad de Tiempo Semanal Actividad Extracurricular
tiempo_menores_8 <- sum(h$Tiempo_semanal_actividad < 8)

# Crear dataframe con los resultados
resultados_tiempo <- data.frame(
  Categoría = c("Tiempo Semanal mayor o igual a 10 horas", "Tiempo Semanal menor a 10 horas"),
  Cantidad = c(tiempo_mayores_8, tiempo_menores_8)
)

# Mostrar tabla de resultados
print(resultados_tiempo)
```

1.  **Primer evento**

A: "Seleccionar una persona con una cantidad de cursos mayor o igual a 6 en el ciclo 2022-2"

B: "Seleccionar una persona con una cantidad mayor o igual a 8 horas dedicadas a la semana a actividades extracurriculares"

Recordemos que previo al cálculo necesitamos la intersección entre A y B.

Y con esto podremos calcular la verificación de independencia entre este par de variables durante este evento.

```{r}
# 
cursos_mayores_6 <- resultados_cursos$Cantidad[1]

# 
tiempo_mayores_8 <- resultados_tiempo$Cantidad[1]

# 
personas_mayor_igual_6_8_tiempo <- sum(h$Cursos_2022.2 >= 6 & h$Tiempo_semanal_actividad>= 8)

# Calcular las probabilidades empíricas
P_A <- cursos_mayores_6 / cantidad_total
P_B <- tiempo_mayores_8 / cantidad_total
P_A_interseccion_B <- personas_mayor_igual_6_8_tiempo / cantidad_total
P_A_dado_B <- P_A_interseccion_B / P_B

# Verificar si los eventos A y B son dependientes o independientes
if (abs((P_A_interseccion_B-P_A * P_B))<(0.03)) {
  dependencia <- FALSE
} else {
  dependencia <- TRUE
}

# Imprimir los resultados
cat("Probabilidad de A (Cantidad de cursos mayor o igual a 6):", P_A, "\n")
cat("Probabilidad de B (Tiempo semanal actividad extracurricular mayor o igual a 8):", P_B, "\n")
cat("Probabilidad de A intersección B:", P_A_interseccion_B, "\n")
cat("Multiplicacion de probabilidades de AxB:",P_A * P_B, "\n")
cat("Probabilidad de A dado B:", P_A_dado_B, "\n")
cat("Los eventos A y B son dependientes:", dependencia, "\n")
```

En resumen, hemos realizado el cálculo correcto de las probabilidades empíricas y hemos verificado que los eventos A y B son independientes; ya que, a pesar de que P(A ∩ B) no sea exactamente igual a P(A)P(B), el menos de 0.03 de diferencia entre ambos valores nos da el suficiente criterio para concluir que son independientes .

2.  **Segundo evento**

A: "Seleccionar una persona con menos de 6 cursos en el ciclo 2022-2"

B: "Seleccionar una persona con una cantidad mayor o igual a 8 de horas dedicadas a la semana a actividades extracurriculares"

Recordemos que previo al cálculo necesitamos la intersección entre A y B.

Y con esto podremos calcular la verificación de independencia entre este par de variables durante este evento.

```{r}
# 
cursos_menores_6 <- resultados_cursos$Cantidad[2]

# 
tiempo_mayores_8 <- resultados_tiempo$Cantidad[1]


#
personas_menor_6_8_tiempo <- sum(h$Cursos_2022.2 < 6 & h$Tiempo_semanal_actividad>=8)

# Calcular las probabilidades empíricas
P_A <- cursos_menores_6 / cantidad_total
P_B <- tiempo_mayores_8 / cantidad_total
P_A_interseccion_B <- personas_menor_6_8_tiempo / cantidad_total
P_A_dado_B <- P_A_interseccion_B / P_B

# Verificar si los eventos A y B son dependientes o independientes
if (abs((P_A_interseccion_B-P_A * P_B))<(0.03)) {
  dependencia <- FALSE
} else {
  dependencia <- TRUE
}

# Imprimir los resultados
cat("Probabilidad de A (Cantidad de cursos menor a 6):", P_A, "\n")
cat("Probabilidad de B (Tiempo semanal actividad extracurricular mayor o igual a 8):", P_B, "\n")
cat("Probabilidad de A intersección B:", P_A_interseccion_B, "\n")
cat("Multiplicacion de probabilidades de AxB:",P_A * P_B, "\n")
cat("Probabilidad de A dado B:", P_A_dado_B, "\n")
cat("Los eventos A y B son dependientes:", dependencia, "\n")
```

En resumen, hemos realizado el cálculo correcto de las probabilidades empíricas y hemos verificado que los eventos A y B son independientes; ya que, a pesar de que P(A ∩ B) no sea exactamente igual a P(A)P(B), el menos de 0.03 de diferencia entre ambos valores nos da el suficiente criterio para concluir que son independientes .

## 4.2 Variables

### 4.2.1 Variables aleatorias discretas

1.  **Primera variable:**

Primero determinamos la variable que usaremos, y definimos la distribución que se usará:

```{r}
# (Esta variable es una Categorica Nominal)
# Cantidad de personas que no realizan actividades extracurriculares
no_realizan_actividades <- sum(RR$Realizacion_actividad_extra != "Sí" & is.na(RR$Cantidad_actividad_extra))

# Cantidad de personas que realizan actividades extracurriculares
realizan_actividades <- sum(RR$Realizacion_actividad_extra == "Sí")

# Crear dataframe con los resultados
resultados_actividades <- data.frame(
  Categoría = c("Personas que no realizan actividades extracurriculares", "Personas que realizan actividades extracurriculares"),
  Cantidad = c(no_realizan_actividades, realizan_actividades)
)

# Mostrar tabla de resultados
print(resultados_actividades)


```

Aquí definimos el **éxito como cantidad de personas que no realizan actividades extracurriculares.**

Usaremos el modelo de distribución Binomial para esta variable, el cual tiene la forma de:

***\~Bin( p , n )***

1.  Construimos nuestra variable aleatoria: ***Número de personas que no realizan actividades extracurriculares en un conjunto de 150 alumnos universitarios.***

2.  Identificamos los parámetros:

    1.  **p =** P(E); donde el éxito es definido como: Seleccionar una persona que no realiza actividades extracurriculares

```{r}
# Cantidad de personas que no realizan actividades extracurriculares
no_realizan_actividades <- sum(RR$Realizacion_actividad_extra != "Sí" & is.na(RR$Cantidad_actividad_extra))

# Cantidad total de personas
total_personas <- sum(resultados_actividades$Cantidad)

# Calcular la fracción
fraccion <- paste(no_realizan_actividades, "/", total_personas)

#Definimos p
p <- no_realizan_actividades/total_personas 

# Crear dataframe de la tabla solicitada
Exito <- data.frame(
  Cantidad = c("", "", "No realizan A. extracurriculares"),
  Operación = c("", "", paste(p)),
  Fracción = c("", "", fraccion)
)


Exito


```

    2.  **n =** Tamaño de la muestra:

```{r}
n = total_personas
c(n)
```

Ahora construimos la densidad de la distribución binomial:

```{r}
densidad_binomial <- dbinom(no_realizan_actividades, size = n, prob = p)

print(densidad_binomial)
```

```{r}

# Calcular la densidad binomial
densidad_binomial <- dbinom(0:n, size = n, prob = p)

# Crear vector de valores x
valores_x <- 0:n

# Crear gráfico de densidad binomial
plot(valores_x, densidad_binomial, type = "h", lwd = 2,
     main = "Densidad Binomial",
     xlab = "Número de éxitos",
     ylab = "Densidad",
     xlim = c(0, 40))  # Ajustar los límites del eje x

```

*(Aquí se pone un límite de 40 a la gráfica para que se pueda apreciar de mejor manera. Sin embargo, la muestra es de tamaño 150)*

**Ahora validamos las propiedades:**

```{r}
# Calcular la esperanza
esperanza <- no_realizan_actividades

# Calcular la varianza
varianza <- (total_personas * p * (1 - p))

# Calcular el coeficiente de variación
coef_variacion <- sqrt(varianza) / esperanza * 100

# Crear dataframe con los resultados
resultados <- data.frame(
  Medida = c("Esperanza", "Varianza", "Coeficiente de variación"),
  Valor = c(esperanza, varianza, coef_variacion)
)

# Mostrar tabla de resultados
print(resultados)
```

Esta variable también se puede trabajar con un modelo de ***probabilidad Hipergeométrica***, si es que se desea analizar probabilidades en distintas muestras a partir de la muestra general. Como es el siguiente caso.

```{r}
N = sum(resultados_actividades$Cantidad)  # Tamaño de la población
n = 50  # Tamaño de la muestra
k = no_realizan_actividades  # Éxitos en la población

# Calcular probabilidades utilizando la distribución hipergeométrica
probabilidades <- dhyper(0:n, k, N-k, n)

# Crear gráfico
plot(0:n, probabilidades, col="#2E5B88", type = "b", xlab = "X", ylab = "P(X=x)", 
     main = "Función de probabilidad Hipergeométrica", xlim = c(0, 13))


```

- ***Ejemplo 1.1:***

UTEC está promoviendo la participación de profesores en actividades fuera de la universidad, por lo que desea conocer la probabilidad de que el 50% de su muestra no realice ninguna actividad, para de este modo decidir que acciones tomar al respecto. Se sabe que la muestra es de 100 profesores.

1.  Determinamos la probabilidad de éxito:

```{r}
T_profesores= 100
Prof_No_Act = 0.5*100
p.prof = Prof_No_Act/T_profesores
fraccion <- paste(Prof_No_Act, "/", T_profesores)
Exito <- data.frame(
  Cantidad = c("", "", "No realizan A. extracurriculares"),
  Operación = c("", "", paste(p.prof)),
  Fracción = c("", "", fraccion)
)


Exito
```

2.  Calcular el valor de la función de distribución acumulada (CDF) de la distribución binomial utilizando la función "pbinom"

```{r}
# Calcular el valor de la CDF en el punto deseado
probabilidad <- pbinom(Prof_No_Act, size = T_profesores, prob = p.prof)

# Mostrar el resultado
print(probabilidad)
```

***Ejemplo 1.2:***

Se desea conocer la probabilidad de que en una muestra, especifica en un salón del curso de Cálculo de una variable (aproximadamente 40 personas). La probabilidad de que 12 alumnos que cursen en ese salón, no hagan actividades extracurriculares.

```{r}
N = sum(resultados_actividades$Cantidad)  # Tamaño de la población
n = 40  # Tamaño de la muestra
k = no_realizan_actividades  # Éxitos en la población
x = 12
# Calcular probabilidades utilizando la distribución hipergeométrica
probabilidades <- dhyper(x, k, N-k, n)
c(probabilidades)
```

2.  **Segunda Variable:**

    ***Cantidad de Tiempo Semanal dedicado a las actividades extracurriculares***

```{r}
# Cantidad de Tiempo Semanal Actividad Extracurricular
tiempo_mayores_8 <- sum(h$Tiempo_semanal_actividad >= 8)

# Cantidad de Tiempo Semanal Actividad Extracurricular
tiempo_menores_8 <- sum(h$Tiempo_semanal_actividad < 8)

# Crear dataframe con los resultados
resultados_tiempo <- data.frame(
  Categoría = c("Tiempo Semanal mayor o igual a 10 horas", "Tiempo Semanal menor a 10 horas"),
  Cantidad = c(tiempo_mayores_8, tiempo_menores_8)
)

# Mostrar tabla de resultados
print(resultados_tiempo)
```

Definimos el éxito como la **cantidad de personas que destinan de 8 a más horas a sus actividades extracurriculares.**

Usaremos el modelo de distribución Binomial para esta variable, el cual tiene la forma de:

***\~Bin( p , n .)***

1.  Construimos nuestra variable aleatoria: ***Número de alumnos que*** ***destinan de 8 a más horas a sus actividades extracurriculares en un conjunto de 132 alumnos universitarios.***

2.  Identificamos los parámetros:

    1.  **p =** P(E); donde el éxito es definido como: **Seleccionar una persona que realiza de 8 a más horas en sus actividades extracurriculares**

```{r}
# Obtener la cantidad total de registros
cantidad_total <- nrow(h)

pt= tiempo_mayores_8/cantidad_total

# Crear vectores para almacenar los valores de frecuencia
Valores_F <- c("Mayores o iguales a 8")
Probabilidad_F <- pt
Fraccion_F <- paste(tiempo_mayores_8, "/", cantidad_total, sep = "")

# Crear el dataframe con los resultados
C_Frec <- data.frame(Valores_F, Probabilidad_F, Fraccion_F)

# Mostrar los resultados
C_Frec
```

2.  **n =** Tamaño de la muestra:

```{r}
nt = cantidad_total
c(nt)
```

Ahora construimos la densidad de la distribución binomial:

```{r}
densidad_binomial_t <- dbinom(tiempo_mayores_8, size = nt, prob = pt)

print(densidad_binomial_t)
```

```{r}

# Calcular la densidad binomial
densidad_binomial_t <- dbinom(0:nt, size = nt, prob = pt)

# Crear vector de valores x
valores_x <- 0:nt

# Crear gráfico de densidad binomial
plot(valores_x, densidad_binomial_t, type = "h", lwd = 2,
     main = "Densidad Binomial",
     xlab = "Número de éxitos",
     ylab = "Densidad",
     xlim = c(15, 60))  # Ajustar los límites del eje x
```

*(Aquí se pone un limite de 15 a 60 a la gráfica para que se pueda apreciar de mejor manera; sin embargo, la muestra es de tamaño 132)*

***Ejemplo:***

UTEC está incentivando la participación en actividades extracurriculares a sus alumnos, y quiere apoyar económicamente a las personas más dedicadas, para esto, se desea conocer la probabilidad de que el 40% del alumnado encuestado, se dedique de 8 a más horas a la semana en sus actividades fuera de la universidad. Se sabe que la muestra fue de 200 personas.

```{r}
T_Alumnos= 200
Alum_may_8 = 0.4*200
p.alum = Alum_may_8/T_Alumnos
fraccion <- paste(Alum_may_8, "/", T_Alumnos)
Exito_t <- data.frame(
  Cantidad = c("", "", "Realizan de 8 a mas horas"),
  Operación = c("", "", paste(p.alum)),
  Fracción = c("", "", fraccion)
)


Exito_t
```

2.  Calcular el valor de la función de distribución acumulada (CDF) de la distribución binomial utilizando la función "pbinom"

```{r}
# Calcular el valor de la CDF en el punto deseado
probabilidad_t <- pbinom(Alum_may_8, size = T_Alumnos, prob = p.alum, lower.tail = FALSE)

# Mostrar el resultado
print(probabilidad_t)
```

### 4.2.2 Variables aleatorias continuas:

1.  **Primera Variable:**

    ***Número de personas que no realizan actividades extracurriculares en un conjunto de 150 alumnos universitarios.***

```{r}
# Calcular la densidad binomial
densidad_binomial <- dbinom(0:n, size = n, prob = p)

# Crear vector de valores x
valores_x <- 0:n

# Calcular la media y la mediana
media <- n * p
mediana <- qbinom(0.5, size = n, prob = p)

# Aproximar los valores a dos decimales
media_aproximada <- round(media, 2)
mediana_aproximada <- round(mediana, 2)

# Mostrar los resultados
print(paste("Media:", media_aproximada))
print(paste("Mediana:", mediana_aproximada))

# Crear gráfico de densidad binomial
plot(valores_x, densidad_binomial, type = "h", lwd = 2,
     main = "Densidad Binomial",
     xlab = "Número de éxitos",
     ylab = "Densidad",
     xlim = c(0, 40))  # Ajustar los límites del eje x

# Agregar línea vertical para representar la media
abline(v = media, col = "red", lty = 2, lwd = 2)

# Agregar línea vertical para representar la mediana
abline(v = mediana, col = "blue")

# Comparar si la esperanza y la media son iguales
if (media_aproximada == mediana_aproximada) {
  print("La esperanza y la media son iguales.")
} else {
  print("La esperanza y la media son diferentes.")
}

```

Al ver que se aproxima a una normalidad, los parámetros serian:

```{r}
u <- media_aproximada
desviacion_estandar <- sd(valores_x)
G <- desviacion_estandar^2

c(u,G)
```

 **Ejemplo:**

Se requiere calcular la probabilidad de obtener un número de personas que no hagan actividades extracurriculares mayor a la cantidad de ingresantes 2023-1, que en este caso serían 2000, para de este modo realizar mas charlas sobre la importancia sobre este.

```{r}
prob = pnorm(2000,u,G, lower.tail = F )
c(prob)
```

2.  **Segunda Variable**

    ***Número de alumnos que*** ***destinan de 8 a más horas a sus actividades extracurriculares en un conjunto de 132 alumnos universitarios.***

```{r}

# Calcular la densidad binomial
densidad_binomial <- dbinom(0:nt, size = nt, prob = pt)

# Crear vector de valores x
valores_x <- 0:nt

# Calcular la media y la mediana
media_t <- nt * pt
mediana_t <- qbinom(0.5, size = nt, prob = pt)

# Aproximar los valores a dos decimales
media_aproximada_t <- round(media, 2)
mediana_aproximada_t <- round(mediana, 2)

# Mostrar los resultados
print(paste("Media:", media_aproximada_t))
print(paste("Mediana:", mediana_aproximada_t))

# Crear gráfico de densidad binomial
plot(valores_x, densidad_binomial, type = "h", lwd = 2,
     main = "Densidad Binomial",
     xlab = "Número de éxitos",
     ylab = "Densidad",
     xlim = c(15, 60))  # Ajustar los límites del eje x

# Agregar línea vertical para representar la media
abline(v = media_t, col = "red", lty = 2, lwd = 2)

# Agregar línea vertical para representar la mediana
abline(v = mediana_t, col = "blue")

# Comparar si la esperanza y la media son iguales
if (media_aproximada == mediana_aproximada) {
  print("La esperanza y la media son iguales.")
} else {
  print("La esperanza y la media son diferentes.")
}
```

```{r}
ut <- media_aproximada_t
desviacion_estandar_t <- sd(valores_x)
Gt <- desviacion_estandar_t^2

c(ut,Gt)
```

 **Ejemplo:**

Se requiere calcular la probabilidad de encontrar a personas que se dediquen igual o más de 8 horas de en sus actividades extracurriculares, sea 1500 personas la cantidad de postulantes a UTEC

```{r}
probt = pnorm(1500,ut,Gt, lower.tail = T )
c(probt)
```

```{r}
# Crear el dataframe con los resultados
C_Ciclo <- data.frame(Valores_C, Probabilidad_C, Fraccion_C)

# Ordenar el dataframe por los valores de Valores_C
C_Ciclo <- C_Ciclo[order(C_Ciclo$Probabilidad_C), ]

# Estimar la densidad
densidad <- density(C_Ciclo$Probabilidad_C)

# Crear gráfico de densidad
plot(densidad, main = "Densidad de Cursos 2022.2",
     xlab = "Cursos 2022.2", ylab = "Densidad",
     col = "blue")

```





Variable aleatoria continua

```{r}
data100<-h%>%select(Promedio_2022.2)

print(data100)
```

Distribución Normal

P: promedio de notas del ciclo 2022-2

```{r}
li=mean(h$Promedio_2022.2)
densidad100<-density(h$Promedio_2022.2)
plot(densidad100,lwd=2,col='red',main='Densidad')+
  abline(v=li)
```

- Promedio

```{r}
promedio100<-mean(h$Promedio_2022.2)
promedio100
```

- Mediana

```{r}
mediana100<-median(h$Promedio_2022.2)
mediana100
```

- Variación Muestra

```{r}
varianza100_p<-var(h$Promedio_2022.2)
varianza100_p
```

- Variación Poblacion

```{r}
varianza100_pobl<-var(RR$Promedio_2022.2, na.rm=TRUE)
varianza100_pobl
```

```{r}
desviacion_estandar100<-sd(RR$Promedio_2022.2,na.rm=TRUE)

desviacion_estandar100
desviacion_estandar100^2
```

Se observa que la media y mediana no coinciden exactamente en valores. Aunque sí se observa una aproximación cercana, con una diferencia de 0,26508.

La varianza muestral no es igual a varianza poblacional. Aunque se observa que existe una leve diferencia entre estos 2 valores, con una diferencia de 3.68477.

Además, otra de las propiedades que podemos analizar para validar la distribución normal es la de comparar la varianza con la desviación estándar de la variable en la base de datos elevada al cuadrado. En este caso podemos ver que los valores de ambos son exactamente iguales.

Si se supone que se aproxima a una distribución normal ###Ejemplo Los promedios del ciclo anterior, 2022-2, se distribuyen según una distribución normal de media 14.73492 y una varianza muestral de 3.68477, calcular el porcentaje de estudiantes que sacaron más de 12.00

P(P\>12)=1-P(P\<=12)

P \~ P(u,sigma\^2)

```{r}
1-pnorm(12,mean=promedio100,sd=sqrt(varianza100_p))
```

El porcentaje de alumnos que sacaron más de 12 de promedio es de 92.28%.

```{r}
# Parámetros de la distribución normal
media <- 14.73492
varianza <- 3.68477

# Calcular el porcentaje de estudiantes que sacaron más de 12.00
porcentaje <- 100 - pnorm(12, media, sqrt(varianza)) * 100

# Imprimir el resultado
cat("El porcentaje de estudiantes que sacaron más de 12.00 es:", porcentaje, "%")
```



# **5.Conclusiones**
- El promedio de los que realizan actividades extracurriculares no tiene mucha diferencia con el promedio de los que no las hacen, sólo hay una ventaja mínima para el segundo caso. La correlación entre la cantidad de actividades extracurriculares y el promedio 2022-2 es baja. La cantidad de actividades extracurriculares no afecta de manera significativa al promedio, sin embargo estas relaciones sí son dependientes. El mismo caso se da entre el tiempo semanal dedicado a las actividades extracurriculares y el promedio 2022-2, el tiempo no afecta significativamente pero se cumple cierta dependencia, aunque mínima. 

- Mediante un análisis de los gráficos, se extrajeron las medianas y las medias para poder ver que tipo de variable afectaba más al promedio. Bajo esto se concluyó que el tipo de variable que menos afecta son las académicas con mediana 15 y media 14.91. En cambio, la que más afecta es el trabajo con una mediana de 14.8 y media de 14.12.

- Tras un análisis de las gráficas, se concluye que las influencias como cantidad de cursos o facilidades cuentan con resultados muy diversos que no llegan a establecer una relación exacta con el promedio, por lo que no pueden ser consideradas como influencias de peso.

- La influencia de las actividades extracurriculares en el rendimiento académico de los estudiantes de pregado de UTEC en el periodo 2022-2 no es significativa si nos referimos al tiempo dedicado a las actividades o la cantidad de estas. Sin embargo, se aprecia que de acuerdo al tipo de actividad extracurricular, el promedio del estudiante varía. Por ejemplo, en el caso de los estudiantes que realizan actividades académicas, estos cuentan con una mediana 15 en promedio, valor mayor frente a los otros tipos de actividades. Entonces, la influencia de las actividades extracurriculares recae más en el tipo de actividad que se está ejecutando. 