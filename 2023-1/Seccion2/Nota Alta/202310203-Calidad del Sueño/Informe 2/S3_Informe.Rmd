---
title: "Relación entre los hábitos de sueño de estudiantes universitarios y su desempeño académico"
author: "Hábitos de sueño y el rendimiento académico"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
---

# Introducción

## Relevancia

La relación entre la calidad del sueño y el rendimiento cognitivo en humanos es un tema reciente de investigación. Por un lado, decidimos enfocarnos en estudiantes universitarios porque poseen un horario de sueño muy variado y por ende, una baja calidad de sueño. Esto puede afectar a la memoria (Álvarez Navarrete et al., 2020), aumentar el riesgo de desarrollar demencia o Alzheimer (Lira y Custodio, 2018), y modificar el ritmo circadiano (Saavedra Torres et al., 2013). Por otro lado, nuestra investigación está orientada al desempeño académico debido a que este se ve afectado negativamente por el deterioro de la salud por la falta de sueño. Existen diversos estudios sobre la relación entre las horas del sueño y el rendimiento académico en estudiantes de medicina (Pérez-Olmos, 2006); sin embargo, no encontramos muchos estudios enfocados a estudiantes universitarios en general.

## Objetivo general

 - Identificar y describir la relación entre los hábitos de sueño y el desempeño académico en estudiantes universitarios.

## Objetivos específicos

- Evaluar el impacto de los hábitos de sueño de los estudiantes en su salud.
- Determinar si los estudiantes duermen lo suficiente de acuerdo a su grupo etario.
- Determinar si existe una relación entre el tiempo de sueño y la carrera universitaria.

## Contexto

Utilizamos como guía una tesis realizada por Rosales-Mayor (2009) para la generación de preguntas de la encuesta. Esto es porque su trabajo trata sobre adaptar una escala de evaluación de somnolencia para la población peruana, lo que nos permite una mejor evaluación de los hábitos de sueño de los estudiantes.

# Análisis descriptivo

## Datos

### Proceso de recolección

1. Elección de la herramienta: Se decidió utilizar Google Forms debido a su facilidad de uso, flexibilidad y capacidad para recopilar respuestas de forma organizada y segura.

2. Diseño del cuestionario: Se diseñó un cuestionario que incluía preguntas relevantes para el estudio sobre las horas de sueño promedio, rendimiento académico, fatiga y factores relacionados.

3. Definición de las condiciones: El cuestionario asegura la confidencialidad de los datos y solicita verificación de usuario.

4. Estrategias de alcance: La difusión del cuestionario es mediante canales de comunicación internos, como telegram, grupos estudiantiles y redes sociales. Además, se invitó a los estudiantes a responder la encuesta mediante el uso del código QR.

5. Validación y control de calidad: Se revisa si existen respuestas inconsistentes o atípicas, así como la verificación de que no se hayan introducido datos erróneos.

### Cuestionario

[Enlace del cuestionario](https://forms.gle/MToHD7xQz8nwP3Cr9)

### Población, muestra y muestreo

En este estudio, la población fueron los estudiantes universitarios de UTEC. Se obtuvo una muestra de 138 observaciones, seleccionada mediante un muestreo aleatorio simple, con el objetivo de obtener una muestra representativa de los estudiantes de la UTEC y poder generalizar los resultados obtenidos a toda la población estudiantil.

## Variables
+-------------------------+----------------------+------------------------------------------------------------------------+
| VARIABLE                | TIPO                 | RESTRICCIONES                                                          |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Edad                    | Numérica discreta    | *Debe ser un entero positivo*                                          |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Ciclo                   | Categórica Ordinal   | *No puede ser negativo ni mayor a 10*                                  |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Carrera                 | Categórica nominal   | *Debe ser una carrera disponible en UTEC*                              |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Tiempo de sueño         | Categórica ordinal   | *Solo puede ser menos de 3, de 3 - 5, de 6 - 8 o más de 8 horas*       |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Calidad de sueño        | Numérica discreta    | *No puede ser un número mayor a 5 o menor a 1*                         |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Dificultad al dormir    | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Desempeño académico     | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Fatiga                  | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Bebidas energizantes    | Categórica ordinal   | *Solo puede ser 0, 1, 2, 3 o más de 3*                                 |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Actividad física        | Categórica ordinal   | *Solo puede ser no realizo ejercicio, 1-2 veces a la semana, 3-4 veces a la semana, 5-6 veces a la semana o me ejercito todos los días*|
+-------------------------+----------------------+------------------------------------------------------------------------+
| Nivel de estrés         | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Aparatos electrónicos   | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Horas de estudio        | Numérica discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Noches sin dormir       | Categórica nominal   | *Solo puede ser sí o no*                                               |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Abrumado                | Numérica Discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Siestas                 | Numérica Discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Bebidas alcohólicas     | Numérica Discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Opinión del tema        | Categórica nominal   | *Solo puede ser sí o no*                                               |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Insomnio                | Numérica Discreta    | *No puede ser un entero negativo*                                      |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Act. extracurriculares  | Categórica ordinal   | *Solo puede ser  1 a 2 horas, 2 a 4 horas, 4 a 6 horas, más de 6 horas o no tengo otros compromisos*     
+-------------------------+----------------------+------------------------------------------------------------------------+
| Eventos académicos      | Numérica Discreta    | *No puede ser un número mayor a 5 ni menor a 1*                        |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Salud mental            | Categórica nominal   | *Solo puede ser sí o no*                                               |
+-------------------------+----------------------+------------------------------------------------------------------------+
| Consulta psicológica    | Categórica nominal   | *Solo puede ser sí o no*                                               |
+-------------------------+----------------------+------------------------------------------------------------------------+

## Limpieza de base de datos

La encuesta presentaba preguntas de opciones múltiples, esto evita que las observaciones presenten algún dato anormal. Gracias a esto, al revisar los datos, no encontramos respuestas mal escritas, o números fuera de un rango habitual. El único problema de esta decisión es que se terminan limitando las respuestas y eliminando la "variedad" de las mismas, ya que hay opciones predeterminadas. Esto se toma como recomendación para futuras investigaciones.

Los cambios realizados están enfocados en la definición de las variables y cómo planteamos sus posibles valores.

```{r}
install.packages("readr",repos='http://cran.us.r-project.org')
install.packages("dplyr", repos='http://cran.us.r-project.org')
install.packages("ggplot2", repos='http://cran.us.r-project.org')
library(readr)
library(dplyr)
library(ggplot2)
DP <- read_csv("Encuesta.csv")
```

Proceso utilizado para saber si existen datos atípicos u observaciones incompletas:

1. Verificamos si los descriptores tienen lógica:

```{r}
summary(DP)
```

2. Verificamos si hay observaciones incompletas:

```{r}
table(is.na(DP))
```

Por otro lado, tuvimos que recategorizar algunas variables en R y eliminamos la variable "Marca Temporal". Para esto seguimos los siguientes pasos:

1. Saber el tipo de variables que se tienen:

```{r}
str(DP)
```

2. Recategorización de variables y cambios adicionales:

```{r}
DP$Bcafeina[DP$Bcafeina == "No consumo"] <- "0"
table(DP$Bcafeina)
```

```{r}
DP$HEstudio[DP$HEstudio == "1 hora"] <- "1"
DP$HEstudio[DP$HEstudio == "2 horas"] <- "2"
DP$HEstudio[DP$HEstudio == "3 horas"] <- "3"
DP$HEstudio[DP$HEstudio == "4 horas"] <- "4"
table(DP$HEstudio)
```

```{r}
DP$Edad<- as.integer(DP$Edad)
DP$Ciclo<- as.integer(DP$Ciclo)
```

3. Eliminación de la variable "Marca Temporal":
```{r}
DP$`Marca temporal` <- NULL
```

4. Clasificar a los estudiantes por grupo etario:
```{r}
DP$GEtario <- ifelse(DP$Edad > 18, "Adulto joven", "Adolescente")
```

5. Clasificar a los estudiantes por facultad (grupos de la semana universitaria):
```{r}
DP <- DP %>% 
  mutate(Facultad = case_when(
    Carrera %in% c('Ingeniería Mecatrónica', 'Ingeniería Electrónica') ~ 'ELMT',
    Carrera %in% c('Bioingeniería', 'Ingeniería Ambiental', 'Ingeniería Química') ~ 'Biochamp',
    Carrera %in% c('Ingeniería Civil', 'Ciencia de Datos', 'Ciencia de la Computación') ~ 'Concreto',
    Carrera %in% c('Administración y Negocios Digitales', 'Ingeniería Industrial') ~ 'WallStreet',
    Carrera %in% c('Ingeniería de la Energía', 'Ingeniería Mecánica') ~ 'MecaWatts'
  ))
```

## Descriptores

### Desempeño académico - Tiempo de Sueño

```{r}
o <- c("Menos de 3 horas","3 a 5 horas","6 a 8 horas","Más de 8 horas")
ggplot(DP, aes(x = TiempoS, y = DesempeñoA)) + 
  geom_boxplot() + 
  scale_x_discrete(limits = o) +
  labs(x = "Horas de sueño", y = "Desempeño Académico (1= muy bajo, 5= muy alto)")
```

Utilidad:
Observamos que la relación entre las horas de sueño y el desempeño académico es significativa si no se toma en cuenta a los estudiantes que duermen menos de 3 horas. Esto es porque existieron muy pocas observaciones que cumplan esto y un valor atípico puede modificar seriamente el boxplot. Notamos que las personas que duermen entre 3 y 8 horas, tienen un desempeño entre el 3 y 4. Esto indica que el descanso que tienen los estudiantes, provoca un desempeño medio y alto (quedan fuera los niveles muy bajo, bajo y muy alto) en los cursos de la universidad.

```{r}
DP$type <- reorder(DP$TiempoS, DP$DesempeñoA)
ggplot(DP, aes(x = DesempeñoA))  +
  geom_histogram(binwidth = 1) + 
  xlab("Desempeño Académico") +
  ylab("Conteo") +
  facet_wrap(~ type, ncol = 1)
```

Utilidad:
El histograma nos es útil puesto que complementa la información presentada en el gráfico anterior. Observamos que mientras más duermen los estudiantes mayor es su desempeño académico, esto lo notamos comparando las observaciones correspondientes a estudiantes que duermen de 3 a 5 horas y de 6 a 8 horas.

### Grupo Etario - Tiempo de sueño

```{r}
ca <- c("Adulto joven", "Adolescente")
ggplot(DP, aes(x = GEtario, fill = TiempoS)) + 
  geom_bar(position = "dodge") + 
  scale_x_discrete(limits = ca) +
  labs(x = "Grupo Etario", y = "Número de observaciones", fill = "Tiempo de sueño")

```

Utilidad:
Notamos que, a pesar de la diferencia de edad entre ambos grupos, el comportamiento es muy similar. Gran parte de ambos grupos etarios toman entre 3 a 5 horas o entre 6 a 8 horas en dormir. Si tomamos en cuenta las investigaciones de The Sleep Foundation (2023), quienes nos indican que los adolescentes (de 13 a 18 años) deben dormir de 8 a 10 horas y los adultos (de 18 a más) deben dormir de 6 a 8 horas para tener un rendimiento óptimo durante el día, podemos concluir que los adolescentes no están durmiendo las suficientes horas al día. En el caso de los adultos jóvenes, podemos concluir que si bien hay muchos adultos que cumplen con el tiempo necesario de sueño, para tener un buen rendimiento durante el día, estos forman parte de un poco más del 50% de las muestras, mientras que el resto solo duermen de 3 a 5 horas (incluso menos, pero en una cantidad mínima).

### Nivel de estrés

```{r}
a <- mean(DP$NEstres)
b <- median(DP$NEstres)
c <- IQR(DP$NEstres)
cat("La media es",a,", la medianana es",b,"y tiene un rango intercuantil igual a",c)
```

```{r}
boxplot(DP$NEstres)
```

Utilidad:
Calculamos la media, mediana y rango intercuartil para interpretar mejor el diagrama de cajas. El gráfico nos permite observar que la mayoría de los encuestados presentan un nivel de estrés regular o alto (3 o 4, respectivamente). Además notamos que existen pocos estudiantes con un nivel de estrés muy bajo (1).

### Abrumado

```{r}
table(DP$AbrumadoTA)
```


```{r}
boxplot(DP$AbrumadoTA)
```

Utilidad:
Lo primero nos permite observar que la mayoría de los estudiantes se sienten abrumados por la carga académica y lo segundo nos permite una mejor visualización de los datos. Aparte notamos la mediana y rango intercuantil en la gráfica. Observamos que la mayoría de los estudiantes se sienten abrumados por la carga académica a veces o casi siempre. Mientras que, existen muy pocos que nunca se sienten abrumados por esta. Esto nos permite evaluar los niveles de estrés.

### Nivel de fatiga- Dificultad al dormir

```{r}
ggplot(data = DP, aes(x = Fatiga, y = DificultadD)) + 
  geom_boxplot(mapping = aes(group = cut_width(Fatiga, 1))) + 
        labs(x = "Nivel de fatiga", y = "Dificultad para dormir", fill = "n")
```

Utilidad:
Nos permite observar si existe una correlación entre ambas variables Dificultad para dormir y nivel de fatiga. Esto es importante en nuestro estudio para determinar los factores que ocasionan una baja calidad de sueño y sus consecuencias en la salud (física y mental). Notamos que existe un nivel de correlación intermedio, podremos confirmar o negar esto en la parte de análisis probabilístico al definir eventos a partir de las variables.

### Calidad de sueño - Carrera

```{r}
DP$type2 <- reorder(DP$Facultad, DP$CalidadS)
ggplot(DP, aes(x = CalidadS))  +
  geom_histogram(binwidth = 1) + 
  xlab("Calidad de sueño (1= muy mala, 5= excelente)") +
  ylab("Conteo") +
  facet_wrap(~ type2, ncol = 1)
```

Utilidad:
Permite identificar si la calidad del sueño varía de acuerdo a la facultad (separados según los grupos de la semana universitaria) en la que se encuentran los estudiantes. Podemos notar que los estudiantes de Concreto y MecaWatts poseen una calidad de sueño regular, buena o excelente en su mayoría. En los otros grupos observamos que las calidad de sueño es más variada. 

### Siestas

```{r}
hist(DP$Siestas, main= "Frecuencias de siestas", xlab="1= nunca, 5 = siempre")
```

Utilidad:
Nos sirve para identificar la frecuencia con la que los estudiantes universitarios toman siestas. Observamos que existe un sesgo hacia la derecha, esto nos indica que la mayoría de los estudiantes toman siestas con poca frecuencia.

### Actividad física - Grupo Etario

```{r}
ggplot(DP, aes(x = GEtario, fill = Ejercicio)) + 
  geom_bar(position = "dodge") + 
  scale_x_discrete(limits = ca) +
  labs(x = "Grupo Etario", y = "Número de observaciones", fill = "Ejercicio")
```

Utilidad:
El gráfico nos muestra la relación entre la frecuencia de realización de ejercicios físicos y los grupos etarios. Esta información es útil porque nos permite analizar cómo se distribuye la práctica de ejercicio en diferentes grupos de edad. Observamos que ambos grupos etarios se ejercitan en su mayoría por lo menos una o dos veces a la semana. Sin embargo, los adultos jóvenes poseen una cantidad de personas que no realizan ejercicio casi igual a la de las que lo realizan una o dos veces a la semana. Además, notamos que los adolescentes presentan una menor cantidad de personas que no realizan ejercicio.

# Análisis probabilístico

## Probabilidad empírica

### Espacio Muestral

Para la variable DesempeñoA:
```{r}
table(DP$DesempeñoA)
```

Para la variable TiempoS:
```{r}
table(DP$TiempoS)
```

### Eventos y funciones de probabilidad

Relacionados a la variable DesempeñoA:

- Evento 1: Escoger una persona con desempeño académico muy alto (5) de una muestra de 138 personas.
```{r}
9/138
```

- Evento 2: Escoger una persona con desempeño académico alto (4) de una muestra de 138 personas.
```{r}
59/138
```

- Evento 3: Escoger una persona con desempeño académico regular (3) de una muestra de 138 personas.
```{r}
61/138
```

- Evento 4: Escoger una persona con desempeño académico bajo (2) de una muestra de 138 personas.
```{r}
9/138
```

- Evento 5: Escoger una persona con desempeño académico muy bajo (1) de una muestra de 138 personas.
```{r}
0/138
```

```{r}
fi=table(DP$DesempeñoA)
pi=round(prop.table(fi),4)
cbind(fi,pi)
```

Relacionados con la variable TiempoS:

- Evento 1: Escoger una persona con un tiempo de sueño de más de 8 horas de una muestra de 138 personas.
```{r}
1/138
```

- Evento 2: Escoger una persona con un tiempo de sueño de más de 6 a 8 horas de una muestra de 138 personas.
```{r}
67/138
```

- Evento 3: Escoger una persona con un tiempo de sueño de 3 a 5 horas de una muestra de 138 personas.
```{r}
64/138
```

- Evento 4: Escoger una persona con un tiempo de sueño de menos de 3 horas de una muestra de 138 personas.
```{r}
6/138
```

## Probabilidad Condicional

### Eventos

- Dependientes: A y B (primer par), C y D (segundo par)

  A: Escoger una persona con nivel de estrés alto (4)
```{r}
table(DP$NEstres)
```
  
  B: Escoger una persona que se sienta abrumada por la carga académica casi siempre (4).
```{r}
table(DP$AbrumadoTA)
```

  C: Escoger una persona con un nivel de fatiga regular (3).
```{r}
table(DP$Fatiga)
```
  
  D: Escoger una persona que casi nunca presenta dificultad para dormir (3).
```{r}
table(DP$DificultadD)
```
  
- Independientes: X y Y (primer par), G y H (segundo par)

  X: Escoger una persona cuyo número de horas de sueño es de 6 a 8
```{r}
table(DP$TiempoS)
```

  Y: Escoger una persona de la carrera de ingeniería ambiental
```{r}
table(DP$Carrera)
```
  G: Escoger a una persona que nunca tome siestas
```{r}
table(DP$Siestas)
```
  
  H: Escoger a una persona que se ejercite todos los días
```{r}
table(DP$Ejercicio)
```
  
### Análisis probabilístico

**Para los eventos dependientes escogidos:**

- Primer par

```{r}
PA= 49/138
PA
PB= 48/138
PB
```

```{r}
DP%>% filter(NEstres == 4 & AbrumadoTA== 4)%>%count()
```

```{r}
#S: Representa a la cantidad de personas que tienen un nivel de estrés alto (4) y se sienten abrumados por la carga académica casi siempre (4)
PS= 26/138

if (PS == PA * PB) {
  resultado <- TRUE
} else {
  resultado <- FALSE
}
resultado
PS
PA*PB
```

```{r}
PA_PB=PS/PB

if (PA_PB == PA) {
  re <- TRUE
} else {
  re <- FALSE
}
re
cat("P(A|B):",PA_PB,"\n")
cat("P(B):",PB)
```

Notamos que existe una diferencia significativa, por lo que las eventos son dependientes.

-Segundo Par

```{r}
PC=51/138
PC
PD=50/138
PD
```

```{r}
DP%>% filter(Fatiga == 3 & DificultadD== 3)%>%count()
```

```{r}
#E: Escoger una persona con un nivel de fatiga regular (3) y que casi siempre presenta dificultad para dormir (3), P(C U D)
PE= 25/138

if (PE == PC*PD) {
  r1 <- TRUE
} else {
  r1 <- FALSE
}
r1
PE
PC*PD
```

```{r}
PCD=PE/PD

if (PCD == PC) {
  r <- TRUE
} else {
  r <- FALSE
}
r
cat("P(C|D):",PCD,"\n")
cat("P(D):",PD)
```
Notamos una diferencia significativa, por lo que los eventos son dependientes.

**Para los eventos independientes escogidos:**

-Primer Par
```{r}
PX=67/138
PX
PY=6/138
PY
```

```{r}
DP%>% filter(Carrera == "Ingeniería Ambiental" & TiempoS== "6 a 8 horas")%>%count()
```

```{r}
#Z: Escoger a una persona de ingeniería ambiental que duerma de 6 a 8 horas
PZ= 3/138

if (PZ == PX * PY) {
  r2 <- TRUE
} else {
  r2 <- FALSE
}
r2
PZ
PX*PY
```

```{r}
PXY = PZ/PY

cat("P(X|Y):",PXY,"\n")
cat("P(Y):",PY,"\n","\n")
PYX=PZ/PX
cat("P(Y|X):",PYX,"\n")
cat("P(X):",PX,"\n")
```

Notamos que la diferencia de valores es mínima, por lo que se podría asegurar que son eventos independientes. Sin embargo, para asegurarnos, utilizamos el teorema de Bayes:

```{r}
TB1 = PX*PYX/PY
cat("Resultado del teorema de Bayes:",TB1,"\n")
cat("P(X|Y):",PXY)
```

Dado que el teorema de Bayes se cumple, ahora podemos asegurar que, efectivamente, los eventos son independientes.

-Segundo Par:
```{r}
PG=62/138
PH=5/138
PG
PH
```

```{r}
DP%>% filter(Siestas == 1 & Ejercicio== "Me ejercito todos los días")%>%count()
```

```{r}
#Q: Escoger una persona que  nunca tome siestas y se ejercite todos los días
PQ=2/138

if (PQ == PG * PH) {
  r3 <- TRUE
} else {
  r3 <- FALSE
}
r3
PQ
PG*PH
```

```{r}
PGH = PQ/PH
cat("P(G|H):",PGH,"\n")
cat("P(G):",PG,"\n","\n")

PHG=PQ/PG
cat("P(H|G)",PHG,"\n")
cat("P(H):",PH,"\n")
```

Notamos que la diferencia de valores es mínima, por lo que se podría asegurar que son eventos independientes. Sin embargo, para asegurarnos, utilizamos el teorema de Bayes:

```{r}
TB2 = PG*PHG/PH
cat("Resultado del teorema de Bayes:",TB2,"\n")
cat("P(G|H):",PGH)
```

Dado que el teorema de Bayes se cumple, ahora podemos asegurar que, efectivamente, los eventos son independientes.

## Modelos probabilísticos

### Variables discretas

1. Distribución binomial
Variable utilizada: Desempeño Académico

```{r}
table(DP$DesempeñoA)
```

Caso: De una población de 138 personas de las cuales ninguna presenta un desempeño de nivel 1, 9 presentan un nivel 2, 61 personas de un nivel 3, 59 personas de nivel 4 y por último 9 personas de nivel 5, si escogemos aleatoriamente 40 personas. ¿Cuál es la probabilidad de tener 3 personas que hayan presentado un nivel 3 en desempeño?

X: número de personas con nivel de desempeño regular (3)

```{r}
#Para X=3
h <- 40 #número de ensayos
j <- 3 #número de personas con nivel 3 en desempeño
a <- 61/138 #probabilidad de éxito
dbinom(j,h,a)
```

```{r}
j <- 0:h     # Valores posibles de j (número de éxitos)
prob <- dbinom(j, h, a)   # Probabilidad de cada valor de j

# Graficar los resultados
barplot(prob, names.arg = j, xlab = "Número de éxitos (k)", ylab = "Probabilidad",
        main = "Función de Probabilidad - Distribución Binomial")
```

```{r}
p_acumulada <- pbinom(j, h, a)   # Probabilidad acumulada de cada valor de j

# Graficar los resultados
plot(j, p_acumulada, type = "s", ylim = c(0, 1),
     xlab = "Número de éxitos (k)", ylab = "Probabilidad acumulada",
     main = "Función de Probabilidad Acumulada - Distribución Binomial")
```

2. Distribución hipergeométrica
Variable utilizada: Grupo Etario

```{r}
table(DP$GEtario)
```

Caso: Tenemos una población de 138 personas de las cuales 86 son Adultos jóvenes y 52 son adolescentes. Si se escogen aleatoriamente 30 personas sin reposición, ¿Cuál es la probabilidad de tener 17 adultos jóvenes?

X: número de adultos jóvenes obtenidos luego de haber escogido al azar a 30 personas de una muestra de 138.

```{r}
N <- 138  # Tamaño de la población
m <- 86   # Número de elementos "buenos" en la población
k <- 30   # Tamaño de la muestra
x <- 17   # Número de elementos "buenos" en la muestra
dhyper(x,m,N-m,k)
```

```{r}
probabilidades <- dhyper(0:k, m, N - m, k)

# Crear un vector con los valores x
valores_x <- 0:k

# Crear un gráfico de barras
barplot(probabilidades, names.arg = valores_x,
        xlab = "Número de adultos jóvenes en la muestra",
        ylab = "Probabilidad",
        main = "Función de Probabilidad de Distribución Hipergeométrica")
```

```{r}
v <- 0:k
prob_acumuladas <- phyper(v, m, N - m, k)

# Graficar la distribución acumulada
plot(v, prob_acumuladas, type = "s", xlab = "Valor", ylab = "Probabilidad acumulada", main = "Distribución acumulada hipergeométrica")
```

```{r}
EX <- k*(m/N)
cat("E(X):",EX,"\n")

VX <- k * (m / N) * ((N - m) / N) * ((N - k) / (N - 1))
cat("V(X):",VX,"\n")

SDX <- sqrt(VX)
cat("SD(X):",SDX)
```

### Variables continuas

1. Distribución normal
Variable utilizada: Calidad de sueño

Paso 1:

```{r}
# Comprobar la simetría y la igualdad de la media y la mediana
simetria <- abs(mean(DP$CalidadS) - median(DP$CalidadS)) < 0.01
simetria
```


```{r}
# Calcular la media y la esperanza de los datos
media <- mean(DP$CalidadS)
esperanza <- mean(DP$CalidadS)

# Comprobar que la media sea igual a la esperanza
media_correcta <- media == esperanza
media_correcta
```


```{r}
# Calcular la varianza y la desviación estándar de los datos
varianza <- var(DP$CalidadS)
desviacion_estandar <- sqrt(varianza)

# Comprobar que la varianza sea igual a la desviación estándar
varianza_correcta <- varianza == desviacion_estandar^2
varianza_correcta
```

Paso 2: Calcular la media y la desviación estándar de los datos
```{r}
media <- mean(DP$CalidadS)
media
desviacion_estandar <- sd(DP$CalidadS)
desviacion_estandar
```

Paso 3: Ajustar los datos a una distribución normal
```{r}
x <- seq(min(DP$CalidadS), max(DP$CalidadS), length = 138)
y <- dnorm(x, mean = media, sd = desviacion_estandar)
```


```{r}
ggplot(DP, aes(x = CalidadS)) +
  geom_line(aes(x = x, y = y), color = "red", size = 1) +
  ggtitle("Distribución Normal Ajustada") +
  xlab("Calidad de sueño") +
  ylab("Densidad")
```

Paso 4: Realizar análisis y cálculos adicionales
```{r}
evento3 <- 3  # Valor umbral para calcular la probabilidad
```

Caso: Calcular la probabilidad de que la variable aleatoria sea igual o menor a 3 utilizando la función pnorm()
```{r}
probabilidad_menor_igual <- pnorm(evento3, mean = media, sd = desviacion_estandar)

cat("La probabilidad de que la variable aleatoria sea igual o menor a", evento3, "es:", probabilidad_menor_igual)
```


2. Distribución exponencial
Variable utilizada: Nivel de estrés

```{r}
media <- mean(DP$NEstres)
cat("Media:",round(media,digits=3))
```

Caso: Tenemos una media de 3.442 para el nivel de estrés (entre alto y regular) para una población de 138 personas. ¿Cuál es la probabilidad de escoger un estudiante al azar que tenga un nivel de estrés menor a la media?

```{r}
#Para X<media
lambda=1/media
1-pexp(media, rate = lambda,lower.tail = FALSE)
```

```{r}
#Para cualquier valor de X

curve(dexp(x, rate = lambda), xlim = c(0,40), xlab = "Valores de X", ylab = "Densidad de Probabilidad",main = "Función de densidad de probabilidad de una Distribución Exponencial")
```

```{r}
Esx <-1/lambda
Vzx <- 1/(Esx^2)
cat("Esperanza:", Esx, "\n")
cat("Varianza:", Vzx, "\n")
```

# Conclusiones

- Logramos describir la relación entre los hábitos de sueño y desempeño académico de los estudiantes de UTEC.
- Evaluamos el impacto de los hábitos de sueño en la salud de los estudiantes, para esto utilizamos métodos probabilísticos como dependencia de eventos y los tipos de distribución. Además, nos apoyamos en las hipótesis vistas en el análisis descriptivo.
- Determinamos que los estudiantes universitarios, en su mayoría, no duermen lo suficiente según lo estipulado en diversas organizaciones médicas.

# Bibliografía

Lira, D., & Custodio, N. (2018). Los trastornos del sueño y su compleja relación con las funciones cognitivas. Revista De Neuro-Psiquiatría, 81(1), 20. https://doi.org/10.20453/rnp.v81i1.3270 

Álvarez Navarrete, S., González Guarneros, G., Juárez Fernández, J. A., & Pérez, M. F. (2020). La calidad del sueño y su relación con la memoria en estudiantes universitarios. PsicoEducativa: Reflexiones Y Propuestas, 6(12), 17–25.  https://psicoeducativa.edusol.info/index.php/rpsicoedu/article/view/122 

Saavedra Torres, J. S., Zúñiga Cerón, L. F., Navia Amézquita, C. A. y Vásquez López, J. A. (2013). Ritmo circadiano: el reloj maestro. Alteraciones que comprometen el estado de sueño y vigilia en el área de la salud. Morfolia, 5(3). https://revistas.unal.edu.co/index.php/morfolia/article/view/41615 

Pérez-Olmos, I., Talero-Gutiérrez, C., González-Reyes, R., & Moreno, C. B. (2006). Ritmos circadianos de sueño y rendimiento académico en estudiantes de medicina. Revista Ciencias de la Salud, 4(2), 147-157. http://www.scielo.org.co/scielo.php?script=sci_arttext&pid=S1692-72732006000200016 

Rosales-Mayor, E. (2009). Estudio de validez y confiabilidad de la escala de somnolencia de Epworth en población peruana y modificación de la escala para población que no conduce vehículos motorizados [Tesis de Maestría]. Lima: facultad de Medicina, Universidad Peruana Cayetano Heredia. https://www.researchgate.net/publication/235220463_Estudio_de_validez_y_confiabilidad_de_la_Escala_de_Somnolencia_de_Epworth_en_poblacion_peruana_y_modificacion_de_la_escala_para_poblacion_que_no_conduce_vehiculos_motorizados 

Suni, E., & Suni, E. (2023). How Much Sleep Do We Really Need? Sleep Foundation. https://www.sleepfoundation.org/how-sleep-works/how-much-sleep-do-we-really-need 

Cote-Menéndez, M., Rangel-Garzón, C. X., Sánchez-Torres, M. Y., & Medina-Lemus, A. (2011). Bebidas energizantes:¿ Hidratantes o estimulantes?. Revista de la facultad de medicina, 59(3), 255-266 https://revistas.unal.edu.co/index.php/revfacmed/article/download/26461/38956?inline=1
