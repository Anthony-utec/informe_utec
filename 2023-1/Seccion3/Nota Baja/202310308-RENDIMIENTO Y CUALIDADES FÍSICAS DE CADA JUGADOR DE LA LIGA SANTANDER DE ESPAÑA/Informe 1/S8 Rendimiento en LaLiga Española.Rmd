---
title: "<center>\"RENDIMIENTO Y CUALIDADES FÍSICAS DE CADA JUGADOR DE LA LIGA SANTANDER
  DE ESPAÑA TEMPORADA 2022-2023\"<center>"
output:
  html_document:
    df_print: paged
---


## <span style="color:blue;"> **ÍNDICE:**

- ##### <span style="color:black;"> **1. Introducción**
  - ##### <span style="color:black;">    *Relevancia*
  - ##### <span style="color:black;">    *Objetivo*
  - ##### <span style="color:black;">    *Contexto*
  
- ##### <span style="color:black;"> **2. Planificación**

- ##### <span style="color:black;"> **3. Datos **
  - ##### <span style="color:black;">    *Recolección de datos*
  - ##### <span style="color:black;">    *Población, muestra y muestreo*
  - ##### <span style="color:black;">    *Variables*
  - ##### <span style="color:black;">    *Limpieza de base de datos*

- ##### <span style="color:black;"> **4. Análisis Descriptivo**

```{r}
# En caso de no tener instalado las librerías que se utilizará
#install.packages("ggplot2")
#install.packages("ggthemes")
#install.packages("descr")
#install.packages("modeest")
#install.packages("stringi")
#install.packages("stringr")
```


```{r,include=FALSE}
library(readr)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(descr)
library(stringi)
library(stringr)
library(modeest)
```
### INTRODUCCIÓN

#### <span style="color:blue"> RELEVANCIA:

El fútbol es importante  en todo el mundo porque tiene muchos seguidores cabe mencionar que la industria del fútbol es muy influyente en la actualidad “La liga santander de España” es una de las más reconocidas y competitivas a nivel profesional en Europa. Por ello, nosotros buscamos resaltar a sus jugadores quienes demuestran su compromiso con el equipo, sus jugadas más destacadas y sus mejores goles en todo el mundo, y asi se puede incentivar a los niños y fomentar este deporte sano donde tienen a estos jugadores como un modelo a seguir. Asimismo, mencionar que el deporte es una actividad saludable en líneas generales el fútbol tiene como objetivos entretener a la afición e incentivar las buenas prácticas deportivas. Además, nosotros buscamos saber si la edad de un jugador es un factor influyente en su rendimiento tanto para él y para el equipo.

#### <span style="color:blue;"> OBJETIVO GENERAL:

- Análisis e interpretación de una base de datos de deporte con el objetivo de ver los factores que influyen en la liga Santánder de España para un adecuado desempeño físico, mental y el rendimiento de cada jugador en el terreno de juego. 

- Observar las ventajas y desventajas que puede proporcionar cada jugador a su equipo durante la jornada de la liga Santánder de España.


##### <span style="color:blue"> OBJETIVO ESPECÍFICO:

- Determinar si la edad es un factor influyente en el rendimiento del jugador profesional, si este afecta en la cantidad de disparos al arco que realiza o en el aporte al equipo de fútbol.
- Identificar al jugador con el mejor rendimiento físico tomando en cuenta las variables numéricas, como minutos jugados en cada partido y sus apariciones en cada posición.
- Estimar el mejor jugador de la temporada tomando en cuenta las variables cuantitativas como los partidos jugados, porcentaje de acierto en los pases, duelos aéreos ganados y ver la posición en donde es más eficiente cada jugador.
- Analizar qué jugador es el que menos infracciones comete a lo largo de la temporada de la liga Santander, la cantidad de tarjetas amarillas, determinando a qué equipo pertenece.

#### <span style="color:blue"> CONTEXTO:

- En la actualidad el fútbol es conocido como el deporte rey, por ello, nos parece interesante analizar a sus jugadores, además porque esta es una de las ligas más llamativas, porque estuvieron jugadores como Cristiano Ronaldo, Messi, entre otros referentes del fútbol mundial.
### <span style="color:blue"> PLANIFICACIÓN:
```{r}
data <- data.frame(Integrantes = c('Planteamiento inicial del proyecto','Objetivos y Relevancia','  Busqueda de base de datos','Organizacion de los resultados de la base de datos','Limpieza de datos','Analisis descriptivo p1', 'Redaccion del informe final P1','Correccion del informe P_1', 'Analisis descriptivo P_2','Analisis probabilistico P2', 'Organizacion de la informacion', 'Redaccion del informe final P2'))
inicio = c('04-03', '04-12', '04-19', '05-01', '05-03','05-03', '05-04','06-05','06-08','06-08','06-15','06-20')
fin = c('04-12', '04-18', '05-03','05-03','05-04','05-04', '05-05','06-08','06-15','06-15','06-18','07-03')
A= c('Aloies','Joel','Aloies','Roly','Alan', 'Joaquin','Todos','Roly','Joaquin','Joel','Alan','Todos')

ggplot(data, aes(x=inicio, xend=fin, y=Integrantes, yend=Integrantes, color=A)) +
  theme_bw()+  geom_segment(size=8) + labs(title='*Planificacion del proyecto*', x='Abril a Julio', y='Actividades') + scale_colour_manual(values = c('goldenrod3', 'darkorchid4', 'firebrick3','darkorange3','palegreen4','dodgerblue3','red','blue','lightgreen','brown','grey','lightyellow','royalblue')) + 
  theme(axis.title = element_text(size=16))+
  theme(axis.text.x = element_text(size=5.5))+
  theme(legend.text = element_text(size=8))+
  theme(legend.title = element_text(size=0))
```


### <span style="color:blue"> DATOS

#### <span style="color:blue"> INSTRUMENTO DE RECOLECCIÓN:
Fuente primaria, se obtuvo la base de datos de la pagina web:

[BaseDeDatos(https://www.kaggle.com/datasets/rayhan32/la-liga-player-status-season-2022-2023)]

#### Población:
- Todos los registros de los rendimientos de cada jugador de la Liga Santander de España primera división en la temporada 2022-2023.

#### Muestra:
- Registros de todos lo jugadores que tengan todos sus datos completos en la base de datos.

#### Muestreo:
- Base de datos recolectada de una página conocida KAGGLE, donde se eligió el área de deporte de manera aleatoria.

#### Variables

##### **Variables Categóricas:**

- *Nombre del Jugador*                                  | **NOMBRE**

- *Equipo del jugador*                                  | **EQUIPO** 

- *Posición de juego en el campo*                       | **POSICIÓN**


##### **Variables Numéricas:**

- *Edad del jugador*                                    | **EDAD**

- *Aparición o partido en el campo*                     | **PARTIDO**

- *Asistencia*                                          | **ASISTENCIA**

- *Minutos jugados*                                     | **MINUTOS**

- *Total de goles*                                      | **GOLES**

- *Cantidad de tarjeta amarilla*                        | **AMARILLA**

- *Cantidad de tarjeta roja*                            | **ROJA** 

- *Cantidad de disparos al arco*                        | **DISPAROS**

- *Porcentaje de aciertos en los pases*                 | **PASES_A**

- *Duelos aéreos ganados por partido*                   | **AEREOS_G**

- *Hombre del Partido*                                  | **MVP**

#### Limpieza de base de datos

##### Base de datos inicial

```{r}
liga = read.csv("lalaiga 2 all player final - lalaiga 2 all player.csv",fileEncoding = "utf8")
```

```{r}
liga
```

##### Buscando las variables con mayores datos faltantes
```{r}
sum(is.na(liga$Goals))
sum(is.na(liga$RC))
sum(is.na(liga$Assist))
sum(is.na(liga$MOTM))
```


##### Renombrando los nombres de las variables y almacenandolo en una nueva base
```{r}
Laliga_limpia= rename(liga,NOMBRE=Player.Name,EQUIPO=Team.name,EDAD=Age,POSICION=Position,PARTIDO=App,MINUTOS=MinP,GOLES=Goals,ASISTENCIA=Assist,AMARILLA=YC,ROJA=RC,DISPAROS=SPG,PASES_A=PS.,AEREOS_G=AW,MVP=MOTM,CLASIFICACION=Rating)
```


##### Eliminamos las variables con mayor cantidad de NA
```{r}
Laliga_limpia$GOLES <- NULL
Laliga_limpia$ROJA <- NULL
Laliga_limpia$MVP <- NULL
Laliga_limpia$ASISTENCIA <- NULL

```


##### Eliminamos las observaciones con NA y almacenando la base de datos inicial en otra nueva
```{r}
LALIGA = na.omit(Laliga_limpia)
```


##### Agregando tres nuevas variables de todos los jugadores que solo sean Delanteros, Defensas y Mediocampistas en general con los datos de TRUE o FALSE


###### DEFENSA
```{r}
LALIGA$DEFENSA <- FALSE
LALIGA$DEFENSA[grep("D", LALIGA$POSICION)] <- TRUE
LALIGA$DEFENSA[grep("DMC", LALIGA$POSICION)] <- TRUE
```

###### MEDIO
```{r}
LALIGA$MEDIO <- FALSE
LALIGA$MEDIO[grep("M", LALIGA$POSICION)] <- TRUE
LALIGA$MEDIO[grep("DMC", LALIGA$POSICION)] <- FALSE
```

###### DELANTERO
```{r}
LALIGA$DELANTERO <- FALSE
LALIGA$DELANTERO[grep("F", LALIGA$POSICION)] <- TRUE
```


##### Creamos tres variables adicionales para conocer los defensas izquierdos, derechos y medios.
##### Agregando una nueva variable DEFENSAD de todos los jugadores que son Defensas Derechos y asignadoles TRUE si en su posición aparece D(R).

```{r}
LALIGA$DEFENSAD = LALIGA$POSICION
LALIGA$DEFENSAD[grep("D\\(.*R.*\\)", LALIGA$DEFENSAD)] <- TRUE
```


###### Agregando una nueva variable DEFENSAI de todos los jugadores que son Defensas Izquierdos y asignadoles TRUE si en su posición aparece D(L)

```{r}
LALIGA$DEFENSAI = LALIGA$POSICION
LALIGA$DEFENSAI[grep("D\\(.*L.*\\)", LALIGA$DEFENSAI)] <- TRUE
```


###### Agregando una nueva variable DEFENSAC de todos los jugadores que son Defensas Centrales y asignadoles TRUE si en su posición aparece D(C), DMC o Defender
```{r}
LALIGA$DEFENSAC = LALIGA$POSICION
LALIGA$DEFENSAC[grep("D\\(.*C.*\\)", LALIGA$DEFENSAC)] <- TRUE
LALIGA$DEFENSAC[grep("Defender", LALIGA$DEFENSAC)] <- TRUE
LALIGA$DEFENSAC[grep("DMC", LALIGA$DEFENSAC)] <- TRUE
```


##### MEDIO

###### Agregando una nueva variable MEDIOI de todos los jugadores que son Medios Izquierdos y asignadoles TRUE si en su posición aparece M(L)

```{r}
LALIGA$MEDIOI = LALIGA$POSICION
LALIGA$MEDIOI[grep("M\\(.*L.*\\)", LALIGA$MEDIOI)] <- TRUE
```


###### Agregando una nueva variable MEDIOD de todos los jugadores que son Medios Derechos y asignadoles TRUE si en su posición aparece M(R)

```{r}
LALIGA$MEDIOD = LALIGA$POSICION
LALIGA$MEDIOD[grep("M\\(.*R.*\\)", LALIGA$MEDIOD)] <- TRUE
```


###### Agregando una nueva variable MEDIOC de todos los jugadores que son Medios Centrales y asignadoles TRUE si en su posición aparece M(C), Miedfielder

```{r}
LALIGA$MEDIOC = LALIGA$POSICION
LALIGA$MEDIOC[grep("M\\(.*C.*\\)", LALIGA$MEDIOC)] <- TRUE
LALIGA$MEDIOC[grep("Midfielder", LALIGA$MEDIOC)] <- TRUE
```


###### Una vez asignado y creado las variables adicionales procedemos a asignar con FALSE aquellas que no cumplen con las condiciones dadas anteriormente


###### Verificando en la variable DEFENSAD  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(DEFENSAD = 
                      
         ifelse(DEFENSAD!=TRUE,FALSE,
         DEFENSAD))-> LALIGA
```


###### Verificando en la variable DEFENSAI  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(DEFENSAI = 
                      
         ifelse(DEFENSAI!=TRUE,FALSE,
         DEFENSAI))-> LALIGA
```


###### Verificando en la variable DEFENSAC  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(DEFENSAC = 
                      
         ifelse(DEFENSAC!=TRUE,FALSE,
         DEFENSAC))-> LALIGA
```


###### Verificando en la variable MEDIOI  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(MEDIOI = 
                      
         ifelse(MEDIOI!=TRUE,FALSE,
         MEDIOI))-> LALIGA
```


###### Verificando en la variable MEDIOD  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(MEDIOD = 
                      
         ifelse(MEDIOD!=TRUE,FALSE,
         MEDIOD))-> LALIGA
```


###### Verificando en la variable MEDIOC  aquellos datos que no sean TRUE, y se le asigna FALSE
```{r}
LALIGA %>% mutate(MEDIOC = 
                      
         ifelse(MEDIOC!=TRUE,FALSE,
         MEDIOC))-> LALIGA
```


##### Separando la variable PARTIDO en dos variables Partido y Apariciones, debido a que esta poseia dos datos en uno solo

```{r}
LALIGA$Partido <- gsub("\\(.*", "", LALIGA$PARTIDO)
LALIGA$Apariciones <- gsub(".*\\(|\\)", "", LALIGA$PARTIDO)
LALIGA$Partido[which(LALIGA$Partido == "")] <- 0
LALIGA$Apariciones[which(LALIGA$Apariciones == "")] <- 0
```

###### Eliminamos la variable adicional PARTIDO que se creo anteriormente, que fue ocasionado por la separación de las anteriores variables

```{r}
LALIGA$PARTIDO <- NULL
```


###### Renombramos la variable Apariciones a APARICIONES para una mejor comprensión y orden de la Base de Datos

```{r}
LALIGA= rename(LALIGA,PARTIDO=Partido,APARICIONES=Apariciones)
```

##### Transformamos las variables APARICIONES, PASES_A y PARTIDO de char a numeric, para un posterior análisis descriptivo
```{r}
LALIGA$APARICIONES = as.numeric(LALIGA$APARICIONES)
```

```{r}
LALIGA$PASES_A = as.numeric(LALIGA$PASES_A)
```

```{r}
LALIGA$PARTIDO = as.numeric(LALIGA$PARTIDO)
```

##### <span style="color:blue"> Base de Datos prolija

```{r}
LALIGA
```

##### Variables obtenidas después de la limpieza de datos


###### **Variables Categóricas:**

- ####### **Nominal:**

  - *Nombre del Jugador*                                 | **NOMBRE**

  - *Equipo del jugador*                                 | **EQUIPO** 

  - *Posición de juego en el campo*                      | **POSICIÓN**

  - *DELANTERO*                                          | **DELANTERO**

  - *DEFENSA IZQUIERDO*                                  | **DEFENSAI**

  - *DEFENSA DERECHO*                                    | **DEFENSAD**

  - *DEFENSA CENTRO*                                     | **DEFENSAC**

  - *MEDIO IZQUIERDO*                                    | **MEDIOI**

  - *MEDIO DERECHO*                                      | **MEDIOD**

  - *MEDIO CENTRO*                                       | **MEDIOC**



###### **Variables Numéricas:**

- ####### **Discreta:**

  - *Edad del jugador*                                   | **EDAD**

  - *Minutos jugados*                                    | **MINUTOS**

  - *Cantidad de tarjeta amarilla*                       | **AMARILLA**


- ####### **Continua:**

  - *Cantidad de disparos al arco*                       | **DISPAROS**

  - *Porcentaje de aciertos en los pases*                | **PASES_A**

  - *Duelos aéreos ganados por partido*                  | **AEREOS_G**

  - *Efectividad en la jornada*                          | **CLASIFICACIÓN**

  - *Cantidad de partidos*                               | **PARTIDOS**

  - *Apariciones importantes*                            | **APARICIONES**


### <span style="color:blue"> DESCRIPCIÓN Y ANÁLISIS DE DATOS

#### Análisis de la variable EDAD
```{r}
summary(LALIGA$EDAD) # detalles de la variable EDAD

unique(LALIGA$EDAD) # Se visualiza la variable EDAD sin repeticiones.

LALIGA %>% count(EDAD) # Se visualiza la variable 
```


```{r}
var(LALIGA$EDAD,na.rm=T) 
sd(LALIGA$EDAD,na.rm=T)  # Desviación estándar
CV_APAR<-(sd(LALIGA$EDAD,na.rm=T)/mean(LALIGA$EDAD,na.rm=T))*100   # coeficiente de variación.
CV_APAR
```


##### Histograma de la Edad de jugadores
```{r}
hist(x = LALIGA$EDAD, main = "Distribución de la Edad de los jugadores", xlab = "EDAD", ylab = "Frecuencia", col = "lightblue",prob=TRUE)
abline(v=median(LALIGA$EDAD),col="red",lwd=2)
abline(v=mean(LALIGA$EDAD),col="yellow",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("red","yellow"))
```

- Como se observa en la gráfica, la mayoría de jugadores tienen entre 25 a 30 años de edad, es decir, que los equipos de LaLIGA Santander de España realizan a jugadores ya experimentados, asimismo, podemos observar que hay pocos jugadores con una edad mayor a 35 años.


```{r}
plot(LALIGA$EDAD,main = "GRÁFICO DE DISPERSIÓN DE LA EDAD DE LOS JUGADORES",
     xlab = "ÍNDICE", ylab = "EDAD", 
     col = c("red"))
```

-En la gráfica de dispersión de EDAD se pueden visualizar que la dispersión es relativamente, porque los puntos no se encuentran concentrados en un mismo lugar, sino está disperso en todo el gráfico, y tiene sentido porque los jugadores tienen diferentes edades.

#### Histograma de cantidad de Disparos efectivos al arco
```{r}
hist(LALIGA$DISPAROS,breaks = 20,main="Distribución de la cantidad de Disparos al Arco",col = "purple", xlab = "Cantidad de disparos",ylab = "Frecuencia")
abline(v=median(LALIGA$DISPAROS),col="red",lwd=2)
abline(v=mean(LALIGA$DISPAROS),col="blue",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("red","blue"))

```

- Como podemos observar en la siguiente gráfica obtenemos una mayor cantidad de frecuencia de jugadores, que realizaron un disparo en un rango de [0,1]. Esta gráfica, nos da a a comprender que la tendencia de disparos se encuentra dentro del rango establecido previamente.De esta, manera podemos concluir que la gran mayoría de los jugadores tienen una cantidad de disparos entre 0 y 1, además son muy pocos los que tuvieron una efectividad de disparo al arco alta.


#### Gráfica de dispersión de EDAD VS DISPAROS(Disparos al arco)
```{r}
LALIGA %>% ggplot(., aes(EDAD, DISPAROS, colour=DISPAROS)) + geom_point()
```

- La gráfica nos resume la cantidad de disparos en un rango de efectividad de 1 a 5 que hizo un jugador en toda la temporada de la liga, es decir, nos muestra la cantidad de disparos de un jugador que fueron efectivos en el arco(importantes) y cual es su edad, donde nos podemos dar cuenta que la edad no influye en la cantidad de disparos que haga un jugador, porque hay un jugador de 35 años que tuvo una efectividad en el disparo de más de 4 a diferencia de otros.


Con el análisis previo procedemos a filtrar al jugador con la mayor cantidad de disparos efectivos al arco
```{r}
filter(LALIGA,LALIGA$EDAD>34 & LALIGA$DISPAROS>4)
```
Como se observa el jugador que más disparos hizo en toda la temporada fue Karim Benzema, quien tiene 35 años, y un número de disparos de efectividad de 4.7 en un rango de 1 a 5, además, este se desempeña como Delantero y pertenece al Real Madrid, es decir, la edad no influye en la cantidad de disparos al arco por un jugador.


#### Analizando la variable APARICIONES

```{r}
summary(LALIGA$APARICIONES) # detalles de la variable APARICIONES

unique(LALIGA$APARICIONES) # Se visualiza la variable APARICIONES sin repeticiones.

LALIGA %>% count(APARICIONES) # Se visualiza la variable 
```


```{r}
var(LALIGA$APARICIONES,na.rm=T) 
sd(LALIGA$APARICIONES,na.rm=T)  # Desviación estandar
CV_APAR<-(sd(LALIGA$APARICIONES,na.rm=T)/mean(LALIGA$APARICIONES,na.rm=T))*100   # coeficiente de variación.
CV_APAR

```

#### Analizando la variable MINUTOS

```{r}
summary(LALIGA$MINUTOS) # detalles de la variable APARICIONES

unique(LALIGA$MINUTOS) # Se visualiza la variable APARICIONES sin repeticiones.

LALIGA %>% count(MINUTOS) # Se visualiza la variable 
```

```{r}
var(LALIGA$MINUTOS,na.rm=T) # Variación
sd(LALIGA$MINUTOS,na.rm=T)  # Desviación estándar
CV_MIN<-(sd(LALIGA$MINUTOS,na.rm=T)/mean(LALIGA$MINUTOS,na.rm=T))*100 # coeficiente de variación.
CV_MIN
```
# Imagen en el archivo

```{r}
B=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
B
mosaicplot(table(B$EQUIPO, B$DELANTERO),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "DELANTERO",
           col = c("skyblue", "pink"),
           legend = TRUE)
```

- La cantidad de jugadores por posición, es independiente de los rankings de los mejores equipos. Asimismo, podemos concluir que el Atlético es el equipo que tiene mas jugadores en la posición de delanteros, por delante de la Real Sociedad, Sevilla, Real Madrid, Barcelona, Real Betis en ese orden mencionado.


##### Gráfica de Defensa Derecha vs Equipo
```{r}
C=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
C
mosaicplot(table(C$EQUIPO, C$DEFENSAD),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "DEFENSA_DERECHA",
           col = c("green", "yellow"),
           legend = TRUE)

```

- De la gráfica anterior, podemos intuir que el equipo que tiene mas jugadores en la posición de "Defensa derecha", es el Atlético, seguido por el Real Madrid, Barcelona, Real sociedad, Sevilla y Real Betis en ese orden mencionado. Asimismo, los equipos con mayores jugadores en esta posición son menos afectados cuando ocurren lesiones físicas porque tienen jugadores para poder sustituirlos; de esta manera, no se ven tan afectados para poder disputar duelos posteriores y mantenerse bien toda la jornada.


##### Gráfica de Defensa Izquierda vs Equipo
```{r}
D=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
D
mosaicplot(table(D$EQUIPO, D$DEFENSAI),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "DEFENSA_IZQUIERDA",
           col = c("turquoise", "violet"),
           legend = TRUE)
```

- De acuerdo a los gráficos mostrados podemos concluir que el Real Betis es el equipo que tiene más jugadores en la posición de defensa izquierda(lateral izquierdo), esto es muy beneficioso para el equipo porque cuando un jugador se lesiona ellos tienen la posibilidad de reemplazarlo con otro jugador alternativo; por lo cual, el equipo no se ve tan afectado pudiendo centrarse en el torneo sin tener una baja significativa de un jugador. En cambio, la Real Sociedad si tendrá perdidas significativas en lo que respecta a la jornada.


##### Gráfico de Defensa Central vs Equipo
```{r}
E=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
E
mosaicplot(table(E$EQUIPO, E$DEFENSAC),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "DEFENSA_CENTRAL",
           col = c("orange", "purple"),
           legend = TRUE)
```

- Tener una defensa central sólida es sinónimo de mantener la portería en 0, por ello, en la gráfica el Atlético es uno de los equipos más sólidos con respecto a la posición de defensa central. En cambio, el Real Madrid y el Real Betis pueden tener efectos adversos si llegan a lesionar a uno de sus jugadores de la posición mencionada.


##### Gráfico de Medio-campista Izquierdo vs Equipo
```{r}
F=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
F
mosaicplot(table(F$EQUIPO, F$MEDIOI),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "MEDIO_IZQUIERDA",
           col = c("skyblue", "blue"),
           legend = TRUE)
```

##### Gráfico de Medio-campista Derecho vs Equipo
```{r}
G=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
G
mosaicplot(table(G$EQUIPO, G$MEDIOD ),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "MEDIO_DERECHA",
           col = c("yellow", "violet"),
           legend = TRUE)
```

- El rol de los jugadores de la posición medio-campista tanto derecho como izquierdo es muy importante para tener el control y dominio de la posición del balón. En este caso en ambas gráficas observamos que el atlético es el equipo con más jugadores en la posición de medio central derecha, también el Sevilla y el Real Betis lo que les favorece a tener un mayor rendimiento en la posición mostradas, además que alguno dellos sufra lesiones no sería muy perjudicado. 


##### Gráfico de Medio-campista Central vs Equipo
```{r}
H=filter = LALIGA[LALIGA$EQUIPO %in% c("Atletico","Real Madrid","Barcelona","Sevilla","Real Sociedad","Real Betis"),]
H
mosaicplot(table(H$EQUIPO, H$MEDIOC),
           main = "LOS 6 MEJORES EQUIPOS DE LA LIGA",
           xlab = "EQUIPOS",
           ylab = "MEDIO_CENTRO",
           col = c("red", "yellow"),
           legend = TRUE)
```

- El jugador que se desempeña en el medio campo central, cumple el rol muy importante de contener el balón y dar pases precisos al delantero, de esta manera se vuelve un miembro muy valioso para el rendimiento general del equipo. En la gráfica podemos observar que el Real Madrid y el Sevilla no sufren efectos significativos si se lesionan uno de sus jugadores de la posición mencionada(medio central).



```{r}
hist(LALIGA$APARICIONES,main="Histograma de la variable Apariciones",col = "yellow", xlab = "Apariciones",ylab = "Frecuencia")
abline(v=median(LALIGA$APARICIONES),col="red",lwd=2)
abline(v=mean(LALIGA$APARICIONES),col="blue",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("red","blue"))
```

- La variable Apariciones es una variable de tipo numérica; por lo cual, usamos un gráfico de barras para poder interpretar mejor su información. Asimismo, para estimar el rendimiento físico de un jugador es necesario analizar el numero de apariciones que realizo durante la jornada, ya que esto nos da un alcance que a mayor apariciones dentro del campo el jugador esta mas óptimo y entrenado en sus condiciones físicas.


##### Gráfico de disperión de Apariciones vs Edad
```{r}
LALIGA %>% ggplot(., aes(EDAD, APARICIONES, colour=APARICIONES)) + geom_point()
```

- Básicamente, al realizar la comparación de la variables APARICIONES Y EDAD de los jugadores, estamos tratando de dar a conocer si la edad es un factor que influye de manera directamente proporcional al rendimiento físico del jugador.De esta manera, podemos observar que para el rendimiento físico de un jugador, la edad no es factor que influye directamente porque encontramos jugadores muy jóvenes de 23 años de edad hasta un rango de 33 años que vendrían a ser los jugadores mas veteranos. Estas conclusiones se obtuvieron con los siguientes códigos:


Para conocer al jugador con mayor número de apariciones utilizamos la función max()
```{r}
MAX = max(LALIGA$APARICIONES)
MAX
```

Procedemos a filtrar aquellos jugadores que tuvieron 25 apariciones que fue la máximo número de apariciones
```{r}
filter(LALIGA,LALIGA$APARICIONES==MAX)
```


##### Gráfica de disperisón de Minutos jugador vs Edad
```{r}
LALIGA %>% ggplot(., aes(EDAD, MINUTOS, colour=MINUTOS)) + geom_point()
```

- La gráfica nos resume los minutos jugados de un jugador en toda la temporada de la liga respecto a su edad, es decir, nos muestra la cantidad de minutos que jugo en un partido y cual es su edad, donde nos podemos dar cuenta que los jugadores que tienen un rango de 20 a 30, fueron los que jugaron más.Asimismo, con esta interpretación podemos concluir que para que un jugador juegue una mayor cantidad de minutos durante la temporada, tuvo que estar muy bien física y mentalmente, es decir, su rendimiento físico estuvo en óptimas condiciones.


##### Gráfica de dispersión de Apariciones y minutos
```{r}
LALIGA %>% ggplot(., aes(APARICIONES, MINUTOS, colour=MINUTOS)) + geom_point()
```

- En la gráfica se puede observar la relación que existe entre la cantidad de apariciones y minutos de cada una de los jugadores, donde se puede ver que la mayoría de ellos tuvo pocas apariciones


Conocido los minutos de manera general procedemos a buscar la máxima cantidad de minutos jugados de los jugadores
```{r}
MAXMIN = max(LALIGA$MINUTOS)
MAXMIN
```

Una vez encontrado la cantidad de minutos procedemos a filtrar al jugador con el mayor número de minutos jugados
```{r}
filter(LALIGA,LALIGA$MINUTOS==MAXMIN)
```
De esta manera podemos concluir que Fran García es el jugador con mayor rendimiento físico de LaLiga Santander de España, es decir, este jugador en toda la temporada un mejor aporte para su equipo.


#### Analizando la variable PARTIDO

```{r}
summary(LALIGA$PARTIDO) # Detalles de la variable PARTIDO

unique(LALIGA$PARTIDO) # Se visualiza la variable PARTIDO sin repeticiones.

LALIGA %>% count(PARTIDO) # Se visualiza la variable 
```

##### Histograma de Partidos jugados en la temporada 2022-2023
```{r}
hist(LALIGA$PARTIDO,main="Distribución de Partidos jugados",col = "green", xlab = "Cantidad de Partidos jugados",ylab = "Frecuencia")
abline(v=median(LALIGA$PARTIDO),col="red",lwd=2)
abline(v=mean(LALIGA$PARTIDO),col="brown",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("red","brown"))
```

- En la gráfica se visualiza que son pocos los jugadores que jugaron más de 25 partidos, prácticamente todos los partidos de la temporada, además que la mayoría de ellos jugo entre 5 a 15 partidos

- Se puede observar que el promedio y la media se encuentra entre 10 y 15 partidos, es decir, que en promedio los jugadores participaron de 10 a 15 partidos en toda la temporada 2022-2023


#### Analizando la variable PASES_A(Pases acertados)

```{r}
summary(LALIGA$PASES_A) # Detalles de la variable PASES_A

unique(LALIGA$PASES_A) # Se visualiza la variable PASES_A sin repeticiones.

LALIGA %>% count(PASES_A) # Se visualiza la variable 
```

##### Histograma de pases acertados en porcentajes de los jugadores
```{r}
hist(LALIGA$PASES_A,main="Histograma de Pases Acertados",col = "yellow", xlab = "Cantidad de Pases Acertados%",ylab = "Frecuencia")
abline(v=median(LALIGA$PASES_A),col="red",lwd=2)
abline(v=mean(LALIGA$PASES_A),col="blue",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("red","blue"))
```

- De la gráfica podemos deducir que la mayoría de jugadores tuvo una efectividad de pases entre el 80% a 85%, es decir, la mayoría de jugadores si realizan pases acertados. Asimismo, podemos concluir que los jugadores de la LALIGA Santander de España tienen una efectividad de pases acertados mayor a 60%, lo cual indica que tienen un excelente dominio del balón en el campo de juego.


#### Analizando la variable AEREOS_G(Duelos aéreos ganados)

```{r}
summary(LALIGA$AEREOS_G) # Detalles de la variable AEREOS_G

unique(LALIGA$AEREOS_G) # Se visualiza la variable AEREOS_G sin repeticiones.

LALIGA %>% count(AEREOS_G) # Se visualiza la variable 
```

##### Histograma de los duelos aéreos ganados en un rango de 1 a 6
```{r}
hist(LALIGA$AEREOS_G,main="Histograma de Duelos aéreos ganados",col = "brown", xlab = "Cantidad de Duelos Ganados",ylab = "Frecuencia")
abline(v=median(LALIGA$AEREOS_G),col="yellow",lwd=2)
abline(v=mean(LALIGA$AEREOS_G),col="blue",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("yellow","blue"))
```

- En el gráfico nos podemos dar cuenta que fueron pocos los jugadores que tuvieron un buen rendimiento en los duelos ganados y que la mayoría se encuentra en el rango de 0.5 a 1.5, que es un bajo rendimiento, además también podemos visualizar que el promedio de los duelos ganados es la línea azul y la mediana es la amarilla, dándonos cuenta que es un gráfico sesgado a la izquierda.


#### Para un mejor análisis relacionamos la cantidad de partido, los duelos ganados y pases acertados, para así conocer quien fue el mejor jugador de la temporada
```{r}
ggplot(data = data.frame(LALIGA$PARTIDO, LALIGA$AEREOS_G, LALIGA$PASES_A), aes(x = LALIGA$PARTIDO, y = LALIGA$AEREOS_G, colour=LALIGA$PASES_A)) + 
  geom_point() + scale_color_gradient(low = "blue", high = "red")
```

- Esta gráfica nos muestra de manera general cuales fueron los jugadores que tuvieron más partidos, más duelos ganados y la mayor cantidad de pases acertados,además de la gráfica podemos interpretar que los que tienen mayor pases acertados y duelos aéreos ganados, respecto a los partidos jugados son los mejores jugadores; los cuales tuvieron un mejor desempeño dando una fiabilidad al momento de mantener la posición del balón para el equipo, que es un factor muy importante para que puedan tener el dominio del juego.

- De la gráfica nos podemos dar cuenta de forma general que los jugadores que tuvieron un buen rendimiento físico podemos considerarlo como el mejor jugador de la temporada es aquel que tuvo un más de 20 partidos jugados, un porcentaje de pases acertados mayor a 80 y un rango de más de 2 en duelos aéreos ganados.

- Con este análisis procedemos a buscar al jugador con las cualidades ya mencionadas.
```{r}
RENDIMIENTO = filter(LALIGA,LALIGA$AEREOS_G>2,LALIGA$PASES_A>80,LALIGA$PARTIDO>20)
RENDIMIENTO
```


#### Gráfica de contorno de densidad de Pases Acertados vs Duelos Aéreos ganados 
```{r}
ggplot(RENDIMIENTO, aes(x = RENDIMIENTO$AEREOS_G, y = RENDIMIENTO$PASES_A)) +
  geom_point() +
  geom_density_2d_filled(alpha=0.6)+
  guides(fill = guide_legend(title = "Nivel"))
```

- De la gráfica podemos observar la relación entre los pases acertados y los duelos aéreos ganados de los 6 jugadores que tuvieron buen desempeño,además, analizando detenidamente podemos darnos que un jugador da un porcentaje de pases acertados relativamente alto y posee en duelos aéreos ganado un nivel no tan bajo, por ende este sería el jugador que estimamos como el mejor jugador de la temporada, dentro de sus cualidades encontramos que tiene en duelos ganados un nivel de 2.5 y un porcentaje mayor a 84% en pases acertados.


- Procedemos a buscar al jugador:

```{r}
filter(RENDIMIENTO,RENDIMIENTO$PASES_A>84,RENDIMIENTO$AEREOS_G==2.5)
```
- De esta manera nosotros estimamos que el mejor jugador de la temporada tomando en cuenta los porcentajes de pases acertados, los duelos aéreos ganados y los partidos que jugó es el jugador Antonio Raíllo, quien pertenece al equipo del Mallorca, este tiene 31 años y juega en la posición de Defensa Central, cabe recalcar que la edad no es un factor influyente en los jugadores.  


#### Analizando la variable AMARILLA(Tarjetas amarillas de los jugadores)

```{r}
summary(LALIGA$AMARILLA) # detalles de la variable AMARILLAS

unique(LALIGA$AMARILLA) # Se visualiza la variable AMARILLAS sin repeticiones.

LALIGA %>% count(AMARILLA) # Se visualiza la variable 
```
```{r}
var(LALIGA$AMARILLA,na.rm=T) # Variación
sd(LALIGA$AMARILLA,na.rm=T)  # Desviación estándar
CV_MIN<-(sd(LALIGA$AMARILLA,na.rm=T)/mean(LALIGA$MINUTOS,na.rm=T))*100 # coeficiente de variación.
CV_MIN
```

##### Histograma de la cantidad de Tarjetas amarillas en toda la temporada
```{r}
hist(LALIGA$AMARILLA,main="Histograma de cantidad de Tarjetas Amarillas",col = "orange", xlab = "Número de amarillas",ylab = "Frecuencia")
abline(v=median(LALIGA$AMARILLA),col="purple",lwd=2)
abline(v=mean(LALIGA$AMARILLA),col="blue",lwd=2)
legend(200,0.012,legend = c("Mediana","Media"),lwd=2,col = c("purple","blue"))
```

- En este gráfico podemos observar la mayor frecuencia de amarillas se da de en los intervalos de [0,4], quiere decir, que los jugadores de la liga santander tienden a cometer faltas de infracción leve(tajeta amarillas) solo de 0 a 4 veces mayormente.


##### Histograma de Equipo vs acumulación de tarjetas amarillas por equipos
```{r}
data_de_comparacion <- data.frame(EQUIPO=LALIGA$EQUIPO, AMARILLA=LALIGA$AMARILLA)
data_de_comparacion
colores <- c("#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd",
             "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf",
             "#aec7e8", "#ffbb78", "#98df8a", "#ff9896", "#c5b0d5",
             "#c49c94", "#f7b6d2", "#c7c7c7", "#dbdb8d", "#9edae5")

ggplot(data_de_comparacion, aes(x = EQUIPO, y = AMARILLA, fill=EQUIPO)) +
  geom_bar(stat = "identity")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  theme(axis.text.x = element_text(size = 10))+
  scale_fill_manual(values = colores)

```

- En el gráfico se puede determinar con mayor facilidad que equipo cometió mayores faltas y menores faltas, por ende, el equipo con mayor cantidad de tarjetas amarillas durante la temporada fue el Mayorca y el equipo que cometió menos infracciones fue el Real Madrid. 


##### Gráfico de dispersión de Equipos vs Edad 
```{r}
LALIGA %>% ggplot(., aes(EDAD, EQUIPO, colour=EDAD)) + geom_point()
```

- Al realizar este gráfico de el equipo respecto a la edad, podemos interpretar que equipos tienen los jugadores mas jóvenes y veteranos, también podemos observar que el rango de edad es de 20 a 35 años.

##### Gráfica de dispersión de Equipo vs cantidad de tajetas amarillas
```{r}
LALIGA %>% ggplot(., aes(AMARILLA, EQUIPO, colour=AMARILLA)) + geom_point()
```

- Básicamente, al analizar la variable equipo con la variable de amarillas acumuladas, podemos estimar que equipo comete el mayor números de faltas por temporada. Asimismo, podemos estimar al equipo que comete el menor numero de faltas, con esta interpretación también podemos sesgar a los jugadores que mas faltas cometen por cada equipo. 

Para saber al jugador que recibió más tarjetas amarillas durante la temporada utilizamos la función max()
```{r}
MAX_A = max(LALIGA$AMARILLA)
```
 
Una vez encontrado la mayor cantidad de tarjetas amarillas lo filtramos
```{r}
filter(LALIGA,LALIGA$AMARILLA==MAX_A)
```
De esta manera concluimos que el jugador con mayor infracción en tarjetas amarillas es Álex Baena quien pertenece al equipo del Villarreal con un total de 10 tarjetas.


Asimismo procedemos como dato adicional a filtrar al jugador o los jugadores con menor número de tarjetas amarillas
```{r}
MIN_A=min(LALIGA$AMARILLA)
filter(LALIGA,LALIGA$AMARILLA==MIN_A)
```














