---
title: Casos atendidos de violencia hacia la mujer e integrantes del grupo familiar
  registrados en el Perú 2020-2022
date: "4 de junio de 2023"
output:
  html_document:
    toc: true
    toc_depth: 6
    toc_float:
      collapsed: false
      smooth_scroll: true
    
    df_print: paged
  html_notebook: default
  pdf_document: default
  
---
![](UTEC.jpg)

| Integrantes | Código |
|:---------------------------------------------|:------------------:|
| Julia Ortega Mautino | 202120409|
| Julian Huaman Baltazar | 202120268 |
| Crithian Cueva Torres | 202120719|
| Mileny Ortiz Moreno | 202120412 |
| Esther Zulema Flores | 202120221 |

# **Introducción**

+ **Objetivo general**

  + Analizar los índices de violencia de género que se registraron en el Perú al nivel nacional entre los año 2020-2022.
  
  + **Objetivos específicos**
  
    + Realizar una comparativa entre los casos de violencia reportados durante los años 2020-2022, con el objetivo de analizar si se observa una tendencia al aumento o disminución de estos casos a lo largo de dicho periodo de tiempo.
    +  Analizar los diferentes tipos de violencia con respecto a cada año para identificar las tendencias y patrones de frecuencia en la incidencia de cada tipo de violencia para cada año.
    + Analizar la relación entre la zona geográfica y la cantidad de casos atendidos de violencia hacia la mujer en el Perú durante los años de estudio.
    + Identificar que otros integrantes del grupo familiar, aparte de la mujer, son afectados por este tipo de violencia, ver como va la tendencia entre la cantidad de reportes de violencia hacia la mujer y la cantidad de reportes de violencia hacia otros integrantes del grupo familiar.
    + Analizar la prevalencia de violencia en diferentes grupos de edad, con el fin de identificar patrones y factores de riesgo asociados a la violencia en cada grupo.
  

+ **Relevancia**

  + La violencia hacia las mujeres y miembros del grupo familiar es un grave problema en el Perú y en todo el mundo. Analizar los casos atendidos entre 2020 y 2022 es relevante para comprender su magnitud, identificar patrones y factores de riesgo, y servir como base para políticas y programas de prevención y respuesta. Es esencial tomar medidas efectivas para prevenir y abordar la violencia en todas sus formas, ya que tiene graves consecuencias para las víctimas y la sociedad en general.
  + El análisis de datos sobre la violencia en el Perú entre 2020-2022 según sexo, rango de edad y tipo de violencia es fundamental para identificar patrones y tendencias. Este análisis es clave para el diseño de políticas y programas efectivos de prevención y respuesta.
  
+ **Contexto**    
  + El MIMP (Ministerio de la Mujer y Poblaciones Vulnerables) en Perú es la institución encargada de promover y proteger los derechos de las mujeres, así como prevenir y sancionar la violencia de género. El MIMP recopila datos sobre los casos de violencia contra la mujer, violencia familiar y violencia sexual en el país.
  El análisis de estos datos puede ayudar a comprender la magnitud de la violencia contra la mujer, integrantes del grupo familiar y violencia sexual en Perú, así como a identificar patrones y tendencias en diferentes regiones y entre diferentes grupos de población. Esta información es fundamental para desarrollar estrategias efectivas de prevención, atención y protección de las víctimas de violencia de género.
  
+ **Planificación** 
![Planificación](PlanifIcación.jpg)

+ **Datos**

  + Obtención de datos:
  Pasos durante el proceso
  + Método de recolección de datos
  Para llegar a obtener los datos, optamos por utilizar una base de datos ya existente, debía ser confiable y que sea un tema relevante.
  + Definir la cantidad de observaciones 
  Aquí establecemos algunas restricciones con respecto la cantidad de observaciones que requerimos para nuestra investigación.

+ **Población, Muestra y Muestreo**

  Población: Población peruana.
  Muestra: 419674 personas aproximadamente.
  Muestreo: Probabilístico (Muestreo Aleatorio Simple)
  
# **Datos**

+ **Recolección de datos**
```{r include=FALSE}

library(readr)
library(plyr)
library(dplyr)
library(readxl)
library(ggplot2)
library(plotrix)
library(stringi)
library(knitr)
library(kableExtra)
```

```{r include=FALSE}
DF <- read_csv( file ="BASE_DATOS_OFICIAL.csv")
DF
```


+ **Variables y analisis descriptivo**

```{r include=FALSE}
names(DF)
```


```{r include=FALSE}

tabla<-str(DF)
tabla

```

| Variables | Tipo |  Clase  | Descripción |
|:-----------|:----------------|:------------------|:------------------:|
| Periodo | Categórica | Nominal | Periodo de la información remitida |
| Departamento | Categórica | Nominal | Entidad subnacional desde donde se recepcionó el caso por parte de la línea de intervención |
| Provincia | Categórica | Nominal | Entidad local desde donde se recepcionó  el caso por parte de la linea de intervención |
| Distrito | Categórica | Nominal | Subdivisión de las provincias de menor categoría desde donde se recepcionó el caso por parte de la línea de intervención |
| Nombre centro de atención| Categórica | Nominal | Lugar que brinda cuidados para la salud |
| Año | Numérica | Discreta | Año del reporte de caso de violencia |
| Casos atendidos-total | Numérica  | Discreta |  Margen total de casos atendidos ante pedido de ayuda |
| Casos atendidos-violencia psicológica |Numérica | Discreta | Margen total  de casos atendidos por violencia psicológica |
| Casos atendidos-violencia física | Numérica  | Discreta | Margen total  de casos atendidos por violencia física |
| Casos atendidos-violencia sexual | Numérica | Discreta | Margen total  de casos atendidos por violencia sexual | 
| Casos atendidos-hombres | Numérica | Discreta | Margen total de hombres que fueron atendidos ante el pedido de ayuda |
| Casos atendidos-mujeres | Numérica | Discreta | Margen total de mujeres que fueron atendidas ante el pedido de ayuda |
| Casos atendidos- 0-5 años |Numérica | Discreta | Margen total  de casos atendidos por edad | 
| Casos atendidos- 6-11 años | Numérica | Discreta | Margen total  de casos atendidos por edad |
| Casos atendidos- 12-17 años |Numérica | Discreta | Margen total  de casos atendidos por edad |
| Casos atendidos- 18-29 años |Numérica | Discreta | Margen total  de casos atendidos por edad |
| Casos atendidos- 30-59 años | Numérica | Discreta | Margen total  de casos atendidos por edad |
| Casos atendidos- 60-más años |Numérica | Discreta | Margen total  de casos atendidos por edad |
       
+ **Limpieza de datos**

Identificamos que nuestra base de datos contaba  con palabras mal escritas o tipificadas,  lo pasamos todo a un solo formato.

La variable departamento contaba con un dato Lima que se encontraba subdividida( Lima provincia, Lima metropolitana), este dato tanbiem lo modificamos y lo colocamos en uno solo como Lima

  + Obtención de base de datos por fuentes secundarios ([Base de datos](https://www.datosabiertos.gob.pe/dataset/mimp-n%C3%BAmero-de-casos-atendidos-por-violencia-contra-la-mujer-integrantes-del-grupo-familiar)) 

```{r include=FALSE}
library(dplyr)

DF <- DF %>% 
         mutate_at(vars(DEPARTAMENTO, PROVINCIA, DISTRITO, `NOMBRE CENTRO ATENCION`), toupper)
DF
```

```{r include=FALSE}
# Vector original con datos de departamentos


DF$DEPARTAMENTO <- gsub("LIMA.*", "LIMA", DF$DEPARTAMENTO)
DF$DEPARTAMENTO <- stri_trans_general(DF$DEPARTAMENTO, "Latin-ASCII")
DF
```


# **DESCRIPTORES**

### **BIVARIADO**

#### **Casos atendidos por año**

```{r echo=FALSE}
# Crear un nuevo data frame con las variables de año y número de casos atendidos
datos <- data.frame(
  Año = DF$AÑO,
  CasosAtendidos = DF$`CASOS ATENDIDOS-TOTAL--`
)

# Calcular la cantidad de casos atendidos por año
casos_por_año <- aggregate(CasosAtendidos ~ Año, data = datos, sum, na.rm = TRUE)

# Imprimir el resultado
print(casos_por_año)
```
```{r echo=FALSE}
library(ggplot2)

# Filtrar los datos para incluir únicamente los años 2020, 2021 y 2022
datos_filtrados <- subset(DF, AÑO %in% c(2020, 2021, 2022))

# Calcular la suma de casos atendidos por año
casos_por_año <- aggregate(`CASOS ATENDIDOS-TOTAL--` ~ AÑO, data = datos_filtrados, sum, na.rm = TRUE)

# Convertir la columna AÑO en un vector de caracteres
casos_por_año$AÑO <- as.character(casos_por_año$AÑO)

# Asignar colores personalizados a las barras
colores <- c("#FF6384", "#36A2EB", "#FFCE56") # Puedes modificar estos valores con los colores deseados

# Graficar los datos como un gráfico de barras
ggplot(casos_por_año, aes(x = AÑO, y = `CASOS ATENDIDOS-TOTAL--`, fill = AÑO)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = colores) + # Asignar colores personalizados
  labs(title = "Grafico 7 - Casos atendidos por año",
       x = "Año",
       y = "Casos atendidos") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```





#### **Casos atendidos por grupo de edades**

```{r echo=FALSE}
# Crear un data frame con los datos de edades y cantidad de casos atendidos
datos <- data.frame(
  Edad = c("0-5 años", "6-11 años", "12-17 años", "18-29 años", "30-59 años", "60+ años"),
  CasosAtendidos = c(
    sum(DF$`CASOS ATENDIDOS - 0_5 - TOTAL`, na.rm = TRUE),
    sum(DF$`CASOS ATENDIDOS - 6_11 - TOTAL`, na.rm = TRUE),
    sum(DF$`CASOS ATENDIDOS - 12_17 - TOTAL`, na.rm = TRUE),
    sum(DF$`CASOS ATENDIDOS - 18_29 - TOTAL`, na.rm = TRUE),
    sum(DF$`CASOS ATENDIDOS - 30_59 - TOTAL`, na.rm = TRUE),
    sum(DF$`CASOS ATENDIDOS - 60_MAS - TOTAL`, na.rm = TRUE)
  ),
  Color = c("Azul", "Verde", "Rojo", "Naranja", "Morado", "Amarillo")
)

# Definir una paleta de colores en español
colores <- c("Azul" = "#1f77b4",
             "Verde" = "#2ca02c",
             "Rojo" = "#d62728",
             "Naranja" = "#ff7f0e",
             "Morado" = "#9467bd",
             "Amarillo" = "#ffdc00")

# Graficar los datos como un gráfico de barras con ejes invertidos y colores en español
ggplot(datos, aes(x = CasosAtendidos, y = Edad, fill = Color)) +
  geom_bar(stat = "identity") +
  labs(title = "Grafico 8 -  Casos atendidos por grupo de edades",
       x = "Cantidad de casos atendidos",
       y = "Edad") +
  scale_fill_manual(values = colores) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5), axis.text.x = element_text(angle = 0, hjust = 1))
```

Total de casos atendidos de 30-59 años
```{r echo=FALSE}
# Filtrar los datos por el rango de edad de 0 a 5 años
casos_30_59 <- DF$`CASOS ATENDIDOS - 30_59 - TOTAL`

# Calcular la suma de casos atendidos en el rango de edad de 0 a 5 años
total_casos_30_59 <- sum(casos_30_59, na.rm = TRUE)

# Imprimir el resultado
print(total_casos_30_59)
##[1] 158458
```

Total casos atendidos de 0 a 5 años
```{r echo=FALSE}
# Filtrar los datos por el rango de edad de 0 a 5 años
casos_0_5 <- DF$`CASOS ATENDIDOS - 0_5 - TOTAL`

# Calcular la suma de casos atendidos en el rango de edad de 0 a 5 años
total_casos_0_5  <- sum(casos_0_5, na.rm = TRUE)

# Imprimir el resultado
print(total_casos_0_5 )
##[1] 22668

```




#### **Tipos de violencia con respecto a cada año**

```{r echo=FALSE}
# Crear un nuevo dataframe con los datos de violencia por tipo y año
datos_violencia <- data.frame(
  Año = DF$AÑO,
  ViolenciaFisica = DF$`CASOS ATENDIDOS - VIOLENCIA FISICA`,
  ViolenciaSexual = DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL`,
  ViolenciaPsicologica = DF$`CASOS ATENDIDOS - VIOLENCIA PSICOLOGICA`,
  CasosReportados = DF$`CASOS ATENDIDOS-TOTAL--`
)

# Transformar los datos de forma larga (long format)
datos_long <- tidyr::gather(datos_violencia, TipoViolencia, Cantidad, -Año, -CasosReportados)

# Calcular la suma de casos reportados totales por año
casos_totales <- aggregate(CasosReportados ~ Año, data = datos_violencia, FUN = sum)

# Crear el gráfico de barras apiladas por tipo de violencia



# Filtrar los datos por tipo de violencia

datos_violencia_fisica <- subset(datos_long, TipoViolencia == "ViolenciaFisica")
datos_violencia_sexual <- subset(datos_long, TipoViolencia == "ViolenciaSexual")
datos_violencia_psicologica <- subset(datos_long, TipoViolencia == "ViolenciaPsicologica")

# Crear el gráfico de barras apiladas por tipo de violencia y separadas por año
ggplot(datos_long, aes(x = Año, y = Cantidad, fill = TipoViolencia)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Año", y = "Casos atendidos", title = "Grafico 9 - Incidencia de los diferentes tipos de violencia por año") +
  scale_fill_manual(values = c("ViolenciaFisica" = "red", "ViolenciaSexual" = "blue", "ViolenciaPsicologica" = "green")) +
  theme_minimal() +
  theme(panel.grid = element_blank()) +
  facet_grid(.~TipoViolencia)

```

```{r echo=FALSE}
library(dplyr)

# Calcular la cantidad de casos por tipo de violencia
cantidad_por_tipo <- datos_long %>%
  group_by(TipoViolencia) %>%
  summarize(Cantidad = sum(Cantidad))

# Imprimir la cantidad de casos por tipo de violencia
print(cantidad_por_tipo)
```
```{r echo=FALSE}
library(dplyr)

# Calcular la cantidad de casos por tipo de violencia y por año
cantidad_por_tipo_y_anio <- datos_long %>%
  group_by(Año, TipoViolencia) %>%
  summarize(Cantidad = sum(Cantidad))

# Imprimir la cantidad de casos por tipo de violencia y por año
print(cantidad_por_tipo_y_anio)
```



#### **Casos atendidos por ubicación**

```{r echo=FALSE}
library(ggplot2)


datos <- data.frame(
  ubicacion = DF$DEPARTAMENTO,
  cantidad_casos = DF$`CASOS ATENDIDOS-TOTAL--`
)

# Crear el gráfico de barras horizontales sin números en las barras
ggplot(datos, aes(x = cantidad_casos, y = ubicacion)) +
  geom_bar(stat = "identity", fill = "blue") +
  ylab("Ubicación") +
  xlab("Cantidad de casos") +
  ggtitle("Grafico 10 - Cantidad de casos atendidos por ubicación") +
  theme(axis.text.y = element_text(hjust = 0),
        axis.ticks.x = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())

```



```{r echo=FALSE}

library(dplyr)

# Agrupar los datos por departamento y sumar la cantidad de casos
casos_por_departamento <- datos %>%
  group_by(ubicacion) %>%
  summarise(total_casos = sum(cantidad_casos))

# Imprimir los resultados
print(casos_por_departamento)

```

```{r echo=FALSE}
# Filtrar casos por departamento, excluyendo Lima Metropolitana y Lima Provincia
casos_por_departamento_filtrado <- casos_por_departamento 
  

# Obtener el departamento con la mayor cantidad de casos
departamento_max_casos <- casos_por_departamento_filtrado %>%
  filter(total_casos == max(total_casos)) %>%
  pull(ubicacion)

# Obtener el departamento con la menor cantidad de casos
departamento_min_casos <- casos_por_departamento_filtrado %>%
  filter(total_casos == min(total_casos)) %>%
  pull(ubicacion)

# Imprimir los resultados
print(paste("Departamento con la mayor cantidad de casos:", departamento_max_casos))
print(paste("Departamento con la menor cantidad de casos:", departamento_min_casos))


# Filtrar casos por departamento, excluyendo Lima Metropolitana y Lima Provincia
casos_por_departamento_filtrado <- casos_por_departamento 
  

# Obtener el departamento con la mayor cantidad de casos
departamento_max_casos <- casos_por_departamento_filtrado %>%
  filter(total_casos == max(total_casos))

# Obtener el departamento con la menor cantidad de casos
departamento_min_casos <- casos_por_departamento_filtrado %>%
  filter(total_casos == min(total_casos))

# Imprimir las cantidades de casos
print(paste("Cantidad de casos para el departamento con la mayor cantidad:", departamento_max_casos$total_casos))
print(paste("Cantidad de casos para el departamento con la menor cantidad:", departamento_min_casos$total_casos))


```



#### **Casos atendidos por región**


```{r echo=FALSE}



# Agregar columna de grupo manualmente
datos$grupo <- ifelse(datos$ubicacion %in% c("TUMBES","PIURA","LAMBAYEQUE","LA LIBERTAD","ANCASH","CALLAO","LIMA PROVINCIA","LIMA METROPOLITANA","AREQUIPA","MOQUEGUA","TACNA","LIMA","ICA"), "COSTA",
                      ifelse(datos$ubicacion %in% c("APURIMAC","AYACUCHO","CAJAMARCA","CUSCO","HUANUCO","HUANCAVELICA","JUNIN","PASCO","PUNO"), "SIERRA",
                             ifelse(datos$ubicacion %in% c("LORETO" ,"AMAZONAS","SAN MARTIN","UCAYALI","MADRE DE DIOS"), "SELVA", "Otros")))

# Crear el gráfico de barras con grupos personalizados
ggplot(datos, aes(x = grupo, y = cantidad_casos, fill = ubicacion)) +
  geom_col(position = "dodge") +
  xlab("Región") +
  ylab("Cantidad de casos") +
  ggtitle("Grafico 11 - Cantidad de casos atendidos region")
```
```{r echo=FALSE}
# Calcular la cantidad de casos por grupo
cantidad_por_grupo <- aggregate(cantidad_casos ~ grupo, datos, sum)

# Mostrar la cantidad de casos por grupo
print(cantidad_por_grupo)
```



#### **Casos de violencia hacia hombres y mujeres registrados en cada año**


```{r echo=FALSE}
# Cargar las librerías ggplot2 y gridExtra
library(ggplot2)
library(gridExtra)

# Crear un nuevo data frame con los datos de violencia
datos_violencia <- data.frame(
  Año = DF$AÑO,
  ViolenciaHombre = DF$`CASOS ATENDIDOS - HOMBRES - TOTAL`,
  ViolenciaMujeres = DF$`CASOS ATENDIDOS - MUJERES - TOTAL`
)

# Gráfico de barras para la violencia hacia hombres
grafico_hombres <- ggplot(datos_violencia, aes(x = Año, y = ViolenciaHombre)) +
  geom_bar(stat = "identity", fill = "sky blue") +
  labs(title = "Violencia hacia el hombre", x = "Año", y = "Casos atendidos") +
  scale_y_continuous(labels = scales::comma)
# Gráfico de barras para la violencia hacia mujeres
grafico_mujeres <- ggplot(datos_violencia, aes(x = Año, y = ViolenciaMujeres)) +
  geom_bar(stat = "identity", fill = "pink") +
  labs(title = "Grafico 12 - Violencia hacia la mujer", x = "Año", y = "Casos atendidos") +
  scale_y_continuous(labels = scales::comma)

# Unir los gráficos en uno solo
grafico_combinado <- grid.arrange(grafico_hombres, grafico_mujeres, ncol = 1)

# Mostrar el gráfico combinado
print(grafico_combinado)
```


```{r echo=FALSE}
# Filtrar los datos para el año 2020 y la variable de violencia hacia mujeres
casos_2020_mujeres <- datos_violencia$ViolenciaMujeres[datos_violencia$Año == 2020]

# Calcular la suma de casos registrados en el año 2020 para las mujeres
total_casos_2020_mujeres <- sum(casos_2020_mujeres, na.rm = TRUE)

# Filtrar los datos para el año 2021 y la variable de violencia hacia mujeres
casos_2021_mujeres <- datos_violencia$ViolenciaMujeres[datos_violencia$Año == 2021]

# Calcular la suma de casos registrados en el año 2021 para las mujeres
total_casos_2021_mujeres <- sum(casos_2021_mujeres, na.rm = TRUE)

# Filtrar los datos para el año 2022 y la variable de violencia hacia mujeres
casos_2022_mujeres <- datos_violencia$ViolenciaMujeres[datos_violencia$Año == 2022]

# Calcular la suma de casos registrados en el año 2022 para las mujeres
total_casos_2022_mujeres <- sum(casos_2022_mujeres, na.rm = TRUE)

# Imprimir los resultados
cat("Para el año 2020 para la mujer se registraron:", total_casos_2020_mujeres, "\n")
cat("Para el año 2021 para la mujer se registraron:", total_casos_2021_mujeres, "\n")
cat("Para el año 2022 para la mujer se registraron:", total_casos_2022_mujeres)
```
```{r echo=FALSE}
# Filtrar los datos para el año 2020 y la variable de violencia hacia hombres
casos_2020_hombres <- datos_violencia$ViolenciaHombre[datos_violencia$Año == 2020]

# Calcular la suma de casos registrados en el año 2020 para los hombres
total_casos_2020_hombres <- sum(casos_2020_hombres, na.rm = TRUE)

# Filtrar los datos para el año 2022 y la variable de violencia hacia hombres
casos_2022_hombres <- datos_violencia$ViolenciaHombre[datos_violencia$Año == 2022]

# Calcular la suma de casos registrados en el año 2022 para los hombres
total_casos_2022_hombres <- sum(casos_2022_hombres, na.rm = TRUE)
# Filtrar los datos para el año 2021 y la variable de violencia hacia hombres
casos_2021_hombres <- datos_violencia$ViolenciaHombre[datos_violencia$Año == 2021]

# Calcular la suma de casos registrados en el año 2021 para los hombres
total_casos_2021_hombres <- sum(casos_2021_hombres, na.rm = TRUE)


# Imprimir los resultados
cat("Para el año 2020 para el hombre se registraron:", total_casos_2020_hombres, "\n")
cat("Para el año 2021 para el hombre se registraron:", total_casos_2021_hombres, "\n")
cat("Para el año 2022 para el hombre se registraron:", total_casos_2022_hombres)
```




```{r echo= FALSE}
# Crear un data frame de ejemplo con los datos de violencia por edad, género y año
datos_violencia <- data.frame(
  año = DF$AÑO,
  cero_cinco_hombres = DF$`CASOS ATENDIDOS - 0_5 - HOMBRES`,
  cero_cinco_mujeres = DF$`CASOS ATENDIDOS - 0_5 - MUJERES`,
  seis_once_hombres = DF$`CASOS ATENDIDOS - 6_11 - HOMBRES`,
  seis_once_mujeres = DF$`CASOS ATENDIDOS - 6_11 - MUJERES`,
  doce_diecisiete_hombres = DF$`CASOS ATENDIDOS - 12_17 - HOMBRES`,
  doce_diecisiete_mujeres = DF$`CASOS ATENDIDOS - 12_17 - MUJERES`,
  dieciocho_veintinueve_hombres = DF$`CASOS ATENDIDOS - 18_29 - HOMBRES`,
  dieciocho_veintinueve_mujeres = DF$`CASOS ATENDIDOS - 18_29 - MUJERES`,
  treinta_cicuentanueve_hombres = DF$`CASOS ATENDIDOS - 30_59 - HOMBRES`,
  treinta_cicuentanueve_mujeres = DF$`CASOS ATENDIDOS - 30_59 - MUJERES`,
  sesenta_mas_hombres = DF$`CASOS ATENDIDOS - 60_MAS - HOMBRES`,
  sesenta_mas_mujeres = DF$`CASOS ATENDIDOS - 60_MAS - MUJERES`
)

# Convertir los datos a formato largo manualmente y establecer el orden de los rangos de edad
datos_violencia_largo <- rbind(
  data.frame(año = datos_violencia$año, grupo_edad = "0-5", cantidad = datos_violencia$cero_cinco_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "0-5", cantidad = datos_violencia$cero_cinco_mujeres, genero = "mujeres"),
  data.frame(año = datos_violencia$año, grupo_edad = "6-11", cantidad = datos_violencia$seis_once_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "6-11", cantidad = datos_violencia$seis_once_mujeres, genero = "mujeres"),
  data.frame(año = datos_violencia$año, grupo_edad = "12-17", cantidad = datos_violencia$doce_diecisiete_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "12-17", cantidad = datos_violencia$doce_diecisiete_mujeres, genero = "mujeres"),
  data.frame(año = datos_violencia$año, grupo_edad = "18-29", cantidad = datos_violencia$dieciocho_veintinueve_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "18-29", cantidad = datos_violencia$dieciocho_veintinueve_mujeres, genero = "mujeres"),
  data.frame(año = datos_violencia$año, grupo_edad = "30-59", cantidad = datos_violencia$treinta_cicuentanueve_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "30-59", cantidad = datos_violencia$treinta_cicuentanueve_mujeres, genero = "mujeres"),
  data.frame(año = datos_violencia$año, grupo_edad = "60-MAS", cantidad = datos_violencia$sesenta_mas_hombres, genero = "hombres"),
  data.frame(año = datos_violencia$año, grupo_edad = "60-MAS", cantidad = datos_violencia$sesenta_mas_mujeres, genero = "mujeres")
)
datos_violencia_largo$genero <- factor(datos_violencia_largo$genero, levels = c("mujeres", "hombres"))
# Establecer el orden de los niveles de la variable 'grupo_edad'
datos_violencia_largo$grupo_edad <- factor(datos_violencia_largo$grupo_edad, levels = c("0-5", "6-11", "12-17", "18-29", "30-59", "60-MAS"))

# Crear el gráfico de barras apiladas
ggplot(datos_violencia_largo, aes(x = factor(año), y = cantidad, fill = genero)) +
  geom_bar(stat = "identity", position = "stack") +
  facet_grid(. ~ grupo_edad) +
  xlab("Año") +
  ylab("Cantidad de violencia") +
  ggtitle("Grafico 15 - Cantidad de violencia por grupo de edad y año") +
  scale_fill_manual(values = c("hombres" = "blue", "mujeres" = "pink")) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))


```

```{r echo =FALSE}
# Calcular la suma de casos por género, rango de edad y año
suma_casos <- aggregate(cantidad ~ genero + grupo_edad + año, data = datos_violencia_largo, sum)

# Imprimir los resultados
print(suma_casos)
```

# **Análisis Probabilístico**
## Probabilidad Condicional
+ TRABAJAMOS PARA 2 EVENTOS:
 + **Eventos dependientes**
 + **Relación entre la variable año y género**
TRABAJAMOS PARA 2 EVENTOS:
PARA A SE USARA LA VARIABLE AÑO
PARA B SE USARA LA VARIABLE CASOS TOTALES MUJERES
A: Seleccionar un caso atendido de violencia en el año 2021
B: Seleccionar una caso de violencia hacia la mujer

```{r}
# Crear una tabla vacía de 4 filas y 5 columnas
tabla <- matrix(nrow = 3, ncol = 4)

# Ingresar los valores manualmente
tabla[1, ] <- c(16569, 22964, 19276, 58809)
tabla[2, ] <- c(97394, 140191, 123280, 360865)
tabla[3, ] <- c(113963, 163155, 142556, 419674)

# Convertir la matriz en un objeto de tipo "data.frame"
df <- as.data.frame(tabla)

# Nombrar las filas y columnas de la tabla
row.names(df) <- c("Hombre", "Mujer", "Total")
colnames(df) <- c("Año-2020", "Año-2021", "Año-2022", "Total")

# Imprimir la tabla en la consola
df
```

```{r}
CASOS20<-filter(DF,DF$AÑO==2020)
sumC20<-sum(CASOS20$`CASOS ATENDIDOS-TOTAL--`)


CASOS21<-filter(DF,DF$AÑO==2021)
sumC21<-sum(CASOS21$`CASOS ATENDIDOS-TOTAL--`)

CASOS22<-filter(DF,DF$AÑO==2022)
sumC22<-sum(CASOS22$`CASOS ATENDIDOS-TOTAL--`)

```

```{r}
evento_A <- sumC21
total_eventos <- sum(DF$`CASOS ATENDIDOS-TOTAL--`)
P_evento_A <- evento_A / total_eventos
P_evento_A
```
$$P(A) = 0.388766$$
```{r}
evento_B <- sum(DF$`CASOS ATENDIDOS - MUJERES - TOTAL`)
total_eventos <- sum(DF$`CASOS ATENDIDOS-TOTAL--`)
P_evento_B <- evento_B / total_eventos
P_evento_B
```
$$P(B) = 0.8598698$$
```{r}
evento_A_interseccion_B <- sum(filter(DF,DF$AÑO == 2021)$`CASOS ATENDIDOS - MUJERES - TOTAL`)
evento_A_interseccion_B
total_eventos <- sumC20+sumC21+sumC22
P_evento_A_interseccion_B <- evento_A_interseccion_B/total_eventos
P_evento_A_interseccion_B
```
$$P(A ∩ B) = 0.3340474$$
*Verificación de independencia*

*P(A n B) = P(A).P(B)*

```{r}
P_evento_A_interseccion_B
P_evento_A * P_evento_B
error<-abs(P_evento_A_interseccion_B-(P_evento_A*P_evento_B))
error
```
$$P(A ∩ B) = 0.3340474$$
$$P(A ∩ B) = P(A).P(B)$$
$$0.3340474 = 0.3342882$$
$$P(A∩B)-(P(A)*P(B)) < 0.01 = Independientes$$
$$0.0002408008 < 0.01 = Independientes$$
Se comprueba que son eventos independientes, esto implica que la probabilidad de seleccionar un caso de violencia hacia el hombre no es afectada por el año en el que ocurrió.
*Usando Bayes, se verifica entonces P(B|A) = P(A|B)P(B)/ P(A) Donde P(A) puede ser caracterizada por la probabilidad total*

```{r}
# Crear una tabla vacía de 4 filas y 5 columnas
tabla <- matrix(nrow = 3, ncol = 3)

# Ingresar los valores manualmente
tabla[1, ] <- c(35845, 22964, 58809)
tabla[2, ] <- c(220674, 140191, 360865)
tabla[3, ] <- c(256519, 163155, 419674)

# Convertir la matriz en un objeto de tipo "data.frame"
df <- as.data.frame(tabla)

# Nombrar las filas y columnas de la tabla
row.names(df) <- c("Hombre", "Mujer", "Total")
colnames(df) <- c(" 2020 y 2022 ","2021", "Total")

# Imprimir la tabla en la consola
df
```
+ *Probabilidad Condicional*
  + **Teorema de Bayes**
*P(B|A) = P(A|B)P(B)/ P(A)*
P(B)= La probabilidad de seleccionar una caso de violencia hacia la mujer
```{r}
P_evento_B
```
$$P(B|A) = P(A ∩ B))/ P(A)$$
```{r}
P_A_B <- abs(P_evento_A_interseccion_B/(P_evento_B))
P_A_B
P_B_A <- abs(P_evento_A_interseccion_B/(P_evento_A))
P_B_A
```
$$P(B|A) =  0.8592504 $$
$$P(B|A) = P(A|B)*P(B)/ P(A)$$
```{r}
P__B_A <- ((0.388486*0.8598698)/0.388766)
P__B_A
```

$$P(A) = P(A|B)*P(B)/P(B|A) $$
```{r}
P_A = ((0.388486*0.8598698)/ 0.8592504)
P_A
```
$$P(A) = 0.388766$$
Conclusión:
La independencia entre los eventos sugiere que la ocurrencia de casos de violencia hacia el hombre no está relacionada con el año específico en este caso el año 2021. Esto implica que la probabilidad de seleccionar un caso de violencia hacia el hombre no se ve afectada por el año en el que ocurrió.

## **Variable dependiente**

+ **Relación entre la variable Casos de violencia y rango de edad**

TRABAJAMOS PARA 2 EVENTOS:
PARA A SE USARA LA VARIABLE CASOS ATENDIDOS - MUJERES.
PARA B SE USARA LA VARIABLE CASOS ATENDIDOS - 30_59 AÑOS.
A: Seleccionar un caso de violencia infringido hacia la mujer.
B: Seleccionar un caso de violencia infringido en el rango de edad de 30 a 59 años.

```{r echo=FALSE}
evento__A <-sum(DF$`CASOS ATENDIDOS - MUJERES - TOTAL`)
evento__A
total__eventos <- sum(DF$`CASOS ATENDIDOS-TOTAL--`)
P__evento_A <- evento__A / total__eventos
P__evento_A
```
$$P(A) = 0.8598698$$

```{r}
evento__B <-sum(DF$`CASOS ATENDIDOS - 30_59 - TOTAL`)
evento__B
total__eventos <- sum(DF$`CASOS ATENDIDOS-TOTAL--`)
P__evento_B <- evento__B / total__eventos
P__evento_B
```
$$P(B) = 0.377574$$

```{r}
evento__A_interseccion_B <- sum(DF$`CASOS ATENDIDOS - 30_59 - MUJERES`)
total__eventos <- sum(DF$`CASOS ATENDIDOS-TOTAL--`)
P__evento_A_interseccion_B <- evento__A_interseccion_B/total__eventos
P__evento_A_interseccion_B
```
$$P(A ∩ B) = 0.3614544$$
+ *Verificación de dependencia*

```{r}
P__evento_A_interseccion_B
P__evento_A * P__evento_B
error<-abs(P__evento_A_interseccion_B-(P__evento_A*P__evento_B))
error
```
$$P(A∩B)-(P(A)*P(B)) < 0.01 = Independientes$$
$$ 0.03678987 > 0.01$$
Los eventos son dependientes entre si, ya que en la verificación de dependencia se observa que el resultado es mayor al limite establecido.

*P(A n B) = P(A).P(B)*

$$P(A ∩ B) = 0.3614544$$
$$P(A ∩ B) = P(A).P(B)$$
$$0.3614544 ≠ 0.3246644799$$

*Usando Bayes, se verifica entonces P(B|A) = P(A|B)P(B)/ P(A) Donde P(A) puede ser caracterizada por la probabilidad total*

*Probabilidad Condicional*
**Teorema de Bayes**
*P(B|A) = P(A|B)P(B)/ P(A)*
P(B)= La probabilidad de seleccionar un caso atendido en el rango de edad de 30 a 59 años.
```{r}
P__evento_B
```
$$P(B|A) = P(A ∩ B))/ P(A)$$
```{r}
P__A_B <- abs(P__evento_A_interseccion_B/(P__evento_B))
P__A_B
P__B_A <- abs(P__evento_A_interseccion_B/(P__evento_A))
P__B_A
```
$$P(B|A) =  0.4203594$$
$$P(A|B) =  0.9573073$$
$$P(B|A) = P(A|B)*P(B)/ P(A)$$
```{r}
P__B_A <- ((0.9573073*0.377574)/0.8598698)
P__B_A
```

$$P(A) = P(A|B)*P(B)/P(B|A) $$
```{r}
P__A = ((0.9573073*0.377574)/0.4203594)
P__A
```
$$P(A) = 0.8598698$$
Conclusión:
Los eventos son dependientes, factores culturales y de género: Las normas culturales arraigadas y las actitudes de género pueden influir en la violencia hacia la mujer. En algunos contextos, se pueden esperar roles específicos para las mujeres en el hogar y en la sociedad, lo que puede contribuir a la perpetuación de la violencia, gran parte de las mujeres en este rango de edad conviven, se encuentran casadas o tienen una pareja sentimental. Muchas mujeres en este grupo de edad pueden encontrarse en relaciones de pareja estables o casadas, lo que puede aumentar la probabilidad de estar expuestas a la violencia doméstica. Además, algunas mujeres pueden experimentar violencia en el lugar de trabajo o en otros entornos sociales.



## **PROBABILIDAD EMPIRICA**

### ELEGIMOS LA VARIABLE: RANGO DE EDAD 


+ **Experimento**: Seleccione una persona de 30_59 años que haya sufrido algún caso de violencia
```{r include=FALSE}

total_cas<-sum(DF$`CASOS ATENDIDOS-TOTAL--`)

espacio_mues1<-sum(DF$`CASOS ATENDIDOS - 0_5 - TOTAL`,na.rm = TRUE)
espacio_mues2<-sum(DF$`CASOS ATENDIDOS - 6_11 - TOTAL`,na.rm = TRUE)
espacio_mues3<-sum(DF$`CASOS ATENDIDOS - 12_17 - TOTAL`,na.rm = TRUE)
espacio_mues4<-sum(DF$`CASOS ATENDIDOS - 18_29 - TOTAL`,na.rm = TRUE)
espacio_mues5<-sum(DF$`CASOS ATENDIDOS - 30_59 - TOTAL`,na.rm = TRUE)
espacio_mues6<-sum(DF$`CASOS ATENDIDOS - 60_MAS - TOTAL`,na.rm = TRUE)

P1<-(espacio_mues1/total_cas)
P2<-(espacio_mues2/total_cas)
P3<-(espacio_mues3/total_cas)
P4<-(espacio_mues4/total_cas)
P5<-(espacio_mues5/total_cas)
P6<-(espacio_mues6/total_cas)

```

+ **Eventos atomicos**: 

+ {P1,P2,P3,P4,P5,P6}

+ **Identificamos los eventos**:

+ Seleccione una persona de 0_5 años que haya sufrido algún caso de violencia
+ Seleccione una persona de 6_11 años que haya sufrido algún caso de violencia
+ Seleccione una persona de 12_17 años que haya sufrido algún caso de violencia
+ Seleccione una persona de 18_29 años que haya sufrido algún caso de violencia
+ Seleccione una persona de 30_59 años que haya sufrido algún caso de violencia
+ Seleccione una persona de 60_mas años que haya sufrido algún caso de violencia


### Probablidad de caso de violencia del rango de 0-5 años
```{r echo=FALSE}
P1
```
### Probablidad de caso de violencia del rango de 6-11 años
```{r echo=FALSE}
P2
```
### Probabilidad de caso de violencia del rango de 12-17 años
```{r echo=FALSE}
P3
```
### Probabilidad de caso de violencia del rango de 18-29 años
```{r echo=FALSE}
P4
```
### Probabilidad de caso de violencia del rango de 30-59 años
```{r echo=FALSE}
P5
```
### Probabilidad de caso de violencia del rango de 60-mas años
```{r echo=FALSE}
P6
```
### Comprobando que la suma de la probabilidad sea 1
```{r }
P1+P2+P3+P4+P5+P6
```


```{r echo=FALSE}
# Crear los datos de ejemplo
edades <- c("0-5", "6-11", "12-17", "18-29", "30-59", "60+")
porcentaje <- c(P1*100, P2*100, P3*100, P4*100, P5*100, P6*100)
porcentajes <- round(porcentaje, 2)
# Crear un dataframe con los datos
datos <- data.frame(edades, porcentajes)

# Crear el gráfico de barras
ggplot(datos, aes(x = edades, y = porcentajes, fill = edades)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = paste0(porcentajes, "%")), vjust = -0.5) +  # Agregar etiquetas de porcentaje
  labs(x = "Rango de Edades", y = "Porcentaje", title = "Probabilidad de casos de violencia por rango de edad") +  # Agregar título
  scale_fill_discrete(guide = FALSE) +
  theme_minimal()
```




### ELEGIMOS LA VARIABLE: TIPO DE VIOLENCIA 
+ **Experimento**: Seleccione una persona que haya sufrido violencia sexual

```{r include=FALSE}
esp_1<-sum(DF$`CASOS ATENDIDOS - VIOLENCIA PSICOLOGICA`,na.rm = TRUE)
esp_2<-sum(DF$`CASOS ATENDIDOS - VIOLENCIA FISICA`,na.rm = TRUE)
esp_3<-sum(DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL`,na.rm = TRUE)

v1<-(esp_1/total_cas)
v2<-(esp_2/total_cas)
v3<-(esp_3/total_cas)



```
+ **Eventos atomicos**: 

+ {v1,v2,v3}

+ **Identificamos los eventos**:

+ Seleccione una persona que haya sufrido violencia Psicologica
+ Seleccione una persona que haya sufrido violencia Fisica
+ Seleccione una persona que haya sufrido violencia Sexual


### Probabilidad de caso por violencia psicologica
```{r echo=FALSE}
v1
```
### Probabilidad de caso por violencia fisica
```{r echo=FALSE}
v2
```
### Probabilidad de caso por violencia sexual
```{r echo=FALSE}
v3
```

### Comprobando que la suma de la probabilidad sea 1
```{r echo=FALSE}
v1+v2+v3
```

```{r echo=FALSE}
porcentaje <- c(v1*100, v2*100, v3*100)
porcentajes <- round(porcentaje, 2)
etiquetas <- c("Violencia psicológica", "Violencia física", "Violencia sexual")

# Colores de las barras
colores <- c("steelblue", "darkorange", "forestgreen")

# Crear gráfico de barras
barplot(porcentajes, ylim = c(0, 100), col = colores, main = "Probabilidad de casos de violencia por tipos de violencia",
        xlab = "Tipo de violencia", ylab = "Probabilidad")

# Agregar etiquetas de porcentaje en las barras
text(x = 1:length(porcentajes), y = porcentajes, labels = paste0(porcentajes, "%"), pos = 3, col = "white")

# Agregar etiquetas en el eje x
axis(side = 1, at = 1:length(etiquetas), labels = etiquetas)
text(x = 1:length(porcentajes), y = porcentajes + 2, labels = paste0(porcentajes, "%"), pos = 3, col = "black", cex = 0.8)

```



## **VARIABLE CONTINUA**

### Variable continua- Indice de tipos de violencia

```{r echo=FALSE}

# Supongamos que tienes un dataframe llamado 'DF' que contiene tus variables

# Calcula el índice de violencia psicológica
DF$Indice_Violencia_Psicologica <- DF$`CASOS ATENDIDOS - VIOLENCIA PSICOLOGICA` / DF$`CASOS ATENDIDOS-TOTAL--`
# Calcula el índice de violencia física
DF$Indice_Violencia_Fisica <- DF$`CASOS ATENDIDOS - VIOLENCIA FISICA` / DF$`CASOS ATENDIDOS-TOTAL--`

# Calcula el índice de violencia sexual
DF$Indice_Violencia_Sexual <- DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL` / DF$`CASOS ATENDIDOS-TOTAL--`

DF
```

### Comprobando que el indice por cada observacion sea 1

```{r include=FALSE}
DF$Indice_Tipo_Violencia<-DF$Indice_Violencia_Psicologica+DF$Indice_Violencia_Fisica+DF$Indice_Violencia_Sexual

DF$Indice_Tipo_Violencia <- ifelse(is.na(DF$Indice_Tipo_Violencia), 1, DF$Indice_Tipo_Violencia)

DF$Indice_Tipo_Violencia

```

### Identificacion graficamente
```{r echo=FALSE}
Psicologica <- DF$Indice_Violencia_Psicologica
Fisica <-DF$Indice_Violencia_Fisica
Sexual <- DF$Indice_Violencia_Sexual

# Paso 2: Importar bibliotecas (no es necesario instalarlas, vienen incluidas en RStudio)
library(ggplot2)

# Paso 3: Crear el data frame con las variables
df <- data.frame(Psicologica, Fisica, Sexual)

# Paso 4: Graficar las tres variables continuas en el mismo plano con colores
plot <- ggplot(df, aes(x = Psicologica, color = "Psicologica")) +
  geom_density() +
  labs(x = "Indice", y = "Densidad", title = "Gráficas de Variables Continuas") +
  geom_density(aes(x = Fisica, color = "Fisica")) +
  geom_density(aes(x = Sexual, color = "Sexual")) +
  facet_wrap(~., scales = "free") +
  scale_color_manual(values = c("Psicologica" = "black", "Fisica" = "red", "Sexual" = "blue"))

# Paso 5: Mostrar el gráfico
print(plot)


```

### Validar las propiedad por media y mediana

```{r echo=FALSE}
I_Psicologico <- DF$Indice_Violencia_Psicologica
I_Fisica <- DF$Indice_Violencia_Fisica
I_Sexual <- DF$Indice_Violencia_Sexual

matriz <- cbind(I_Psicologico, I_Fisica, I_Sexual)

media <- apply(matriz, 2, mean, na.rm = TRUE)
mediana <- apply(matriz, 2, median, na.rm = TRUE)

resultados <- data.frame(media, mediana)

print(resultados)

```


### Validar las propiedades por varianza y variacion estandas al cuadrado

```{r echo=FALSE}
matriz <- cbind(I_Psicologico, I_Fisica, I_Sexual)

varianza <- apply(matriz, 2, var, na.rm = TRUE)
desviacion <- apply(matriz, 2, sd, na.rm = TRUE)

resultadoss <- data.frame(varianza, desviacion*desviacion)

print(resultadoss)

```
Cual es la probabilidad de que el idice en violencia sexual menor a 0.5 en el perido 2020-2022

```{r echo=FALSE}
indice_violencia_sexual <- DF$Indice_Violencia_Sexual

# Calcular la probabilidad de que el índice sea mayor o igual a 0.3
probabilidad <- sum(indice_violencia_sexual < 0.5, na.rm = TRUE) / length(indice_violencia_sexual)

# Imprimir la probabilidad
print(probabilidad)
```



### Variable continua- Indice de Violencia por rando de edad 


```{r echo=FALSE}

# Supongamos que tienes un dataframe llamado 'DF' que contiene tus variables

# Calcula el índice de violencia psicológica
DF$Indice_Edad_0_5 <- DF$`CASOS ATENDIDOS - 0_5 - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`
DF$Indice_Edad_6_11 <- DF$`CASOS ATENDIDOS - 6_11 - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`
DF$Indice_Edad_12_17 <- DF$`CASOS ATENDIDOS - 12_17 - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`
DF$Indice_Edad_18_29 <- DF$`CASOS ATENDIDOS - 18_29 - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`
DF$Indice_Edad_30_59 <- DF$`CASOS ATENDIDOS - 30_59 - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`
DF$Indice_Edad_60_mas <- DF$`CASOS ATENDIDOS - 60_MAS - TOTAL` / DF$`CASOS ATENDIDOS-TOTAL--`


```

### Comprobando que el indice por cada observacion sea 1
```{r include=FALSE}
DF$Indice_Violencia_edad<-DF$Indice_Edad_60_mas+DF$Indice_Edad_30_59+DF$Indice_Edad_18_29+DF$Indice_Edad_12_17+DF$Indice_Edad_6_11+DF$Indice_Edad_0_5

DF$Indice_Violencia_edad <- ifelse(is.na(DF$Indice_Violencia_edad), 1, DF$Indice_Violencia_edad)

DF$Indice_Violencia_edad
```

### Identificacion graficamente
```{r echo=FALSE}

Edad_0_5<-DF$Indice_Edad_0_5 
Edad_6_11<-DF$Indice_Edad_6_11
Edad_12_17<-DF$Indice_Edad_12_17
Edad_18_29<-DF$Indice_Edad_18_29 
Edad_30_59<-DF$Indice_Edad_30_59 
Edad_60_mas<-DF$Indice_Edad_60_mas 


# Paso 2: Importar bibliotecas (no es necesario instalarlas, vienen incluidas en RStudio)
library(ggplot2)

# Paso 3: Crear el data frame con las variables
df <- data.frame(Edad_0_5,Edad_6_11,Edad_12_17,Edad_18_29,Edad_30_59,Edad_60_mas)

# Paso 4: Graficar las tres variables continuas en el mismo plano con colores
plot <- ggplot(df, aes(x = Edad_0_5, color = "Edad_0_5")) +
  geom_density() +
  labs(x = "Indice", y = "Densidad", title = "Gráficas de Variables Continuas") +
  geom_density(aes(x = Edad_6_11, color = "Edad_6_11")) +
  geom_density(aes(x = Edad_12_17, color = "Edad_12_17")) +
  geom_density(aes(x = Edad_18_29, color = "Edad_18_29")) +
  geom_density(aes(x = Edad_30_59, color = "Edad_30_59")) +
  geom_density(aes(x = Edad_60_mas, color = "Edad_60_mas")) +
  
  facet_wrap(~., scales = "free") +
  scale_color_manual(values = c("Edad_0_5" = "black", "Edad_6_11" = "red", "Edad_12_17" = "blue", "Edad_18_29" = "orange", "Edad_30_59" = "purple", "Edad_60_mas" = "green"))

# Paso 5: Mostrar el gráfico
print(plot)

```

### Validar las propiedad por media y mediana

```{r echo=FALSE}


matriz <- cbind(Edad_0_5,Edad_6_11,Edad_12_17,Edad_18_29,Edad_30_59,Edad_60_mas)

media <- apply(matriz, 2, mean, na.rm = TRUE)
mediana <- apply(matriz, 2, median, na.rm = TRUE)

resultados <- data.frame(media, mediana)

print(resultados)

```

### Validar las propiedades por varianza y variacion estandas al cuadrado

```{r echo=FALSE}
matriz <- cbind(Edad_0_5,Edad_6_11,Edad_12_17,Edad_18_29,Edad_30_59,Edad_60_mas)

varianza <- apply(matriz, 2, var, na.rm = TRUE)
desviacion <- apply(matriz, 2, sd, na.rm = TRUE)

resultadoss <- data.frame(varianza, desviacion*desviacion)

print(resultadoss)

```
cual es la probabilidad de que el indice en el rango de edad 30-59 años sea mayor a 0.5 en el periodo 2020-2022
```{r echo=FALSE}
indice_violencia <- DF$Indice_Edad_30_59

# Calcular la probabilidad de que el índice sea mayor a 0.5
probabilidad <- sum(indice_violencia > 0.5, na.rm = TRUE) / length(na.omit(indice_violencia))

# Imprimir la probabilidad
print(probabilidad)

```

**Variables aleatorias distcretas**
Variable =  VIOLENCIA SEXUAL

**Distribución binomial**


```{r echo=FALSE}
summary(DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL`)
```
Situación:
En el Perú, se ha evidenciado que la cantidad de casos atendidos ham sido muy pocas, teniendo un máximo de 309 en un distrito del Perú, hasta un lamentable 0 de casos atendidos, claro esto depende de cuantos casos se denuncian. Para nuestra variable **`CASOS ATENDIDOS DE VIOLENCIA SEXUAL`** denotaremos una encuesta a partir de 100 centros de atención y consideraremos como un éxito que en una provincia se atiendan 70 o más denuncias de casos de violencia sexual y un fracaso si esta cantidad es menos. ¿Cuál es la probabilidad de que 20 o menos centros de atención registren 70 o más casos atendidos de violencia sexual?

Probabilidad de éxito (p)= Centro de atención que tenga 70 o mas casos atendidos (CASOS_ATENTIDOS_VIOLENCIA_SEXUAL >= 70)
Probabilidad de fracaso (q)= Centro de atención que tenga menos de 70 casos atendidos (CASOS_ATENTIDOS_VIOLENCIA_SEXUAL < 70)

$$P(\mathbb{X} \leq 40)$$

```{r echo=FALSE}
casos_totales <- length(DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL`)
Data_Binomial <- data.frame(Var1 = DF$`CASOS ATENDIDOS - VIOLENCIA SEXUAL`, Var2 = DF$`NOMBRE CENTRO ATENCION`)
Casos_media <- mean(Data_Binomial$Var1)
Data_Binomial <- Data_Binomial %>%
  mutate(Cumple_Condicion = ifelse(Var1 >= 70, "C >= C_prom", "C < C_prom"))
Data_Binomial
prob_E <- round((sum(Data_Binomial$Cumple_Condicion == "C >= C_prom"))/casos_totales,3)
prob_E
prob_F <- round((sum(Data_Binomial$Cumple_Condicion == "C < C_prom"))/casos_totales,3)
prob_F
```
$$p = 0.211$$
$$q = 0.789$$
```{r echo=FALSE}

# size: número de ensayos (n > = 0)
# prob: probabilidad de éxito en cada ensayo
# lb: límite inferior de la suma
# ub: límite superior de la suma
# col: color
# lwd: ancho de línea
binom_sum <- function(size, prob, lb, ub, col = 4, lwd = 1, ...) {
    x <- 0:size
    
    if (missing(lb)) {
       lb <- min(x)
    }
    if (missing(ub)) {
        ub <- max(x)
    }
      
    plot(dbinom(x, size = size, prob = prob), type = "h", lwd = lwd, ...)
  
    if(lb == min(x) & ub == max(x)) {
        color <- col
    } else {
        color <- rep(1, length(x))
        color[(lb + 1):ub ] <- col
    }
    
    lines(dbinom(x, size = size, prob = prob), type = "h",
          col =  color, lwd = lwd, ...)
}

```

```{r echo=FALSE}
plot(dbinom(0:100, 100, prob = prob_E), type = "h", lwd = 2,
     main = "Función de Probabilidad Binomial de X",
     ylab = "P(X = x)", xlab = "X")
```
 ¿Cuál es la probabilidad de que 20 o menos centros de atención registren 70 o más casos atendidos de violencia sexual?
```{r echo=FALSE}
sum(dbinom(0:20, 100, prob_E))
```

```{r echo=FALSE}

binom_sum(100, prob =prob_E, ub = 20, lwd = 2,
          ylab = "P(X = x)", xlab = "X", main = "Función de Probabilidad Binomial de X")

```
En este gráfico se puede observar que que 
```{r echo=FALSE}
Esperanza = 100 *  0.211
Esperanza
```
```{r echo=FALSE}
Varianza = 100 * prob_E * prob_F
Varianza 
```
La probabilidad de que 40 o menos centros de atención registren 70 o más casos atendidos de violencia sexual es de 0.9999947

**Distribución Geométrica**
La distribución geométrica es un tipo de modelo probabilístico discreto que se emplea para estimar la probabilidad de lograr un número específico de intentos necesarios para obtener un resultado exitoso por primera vez. Se basa en "N" experimentos independientes, y el proceso se considera finalizado una vez que se alcanza el primer éxito.

$$ P(X=x) = ((1-p)^(n-1))*p $$

```{r echo=FALSE}
Esperanza = mean(DF$`CASOS ATENDIDOS - 12_17 - TOTAL`)
Esperanza
```
$$ Esperanza = 52.44044$$
```{r echo=FALSE}
Varianza = var(DF$`CASOS ATENDIDOS - 12_17 - TOTAL`)
Varianza
```
$$ Varianza = 1877.407$$
Determinamos los parámetros de la distribución geométrica.
Parámetro p
```{r echo=FALSE}
p = 1/Esperanza
p
```
$$ p = 0.01906925$$

**Situación** 
En este modelo, nuestra variable se denomina **`VG2`**. En el caso de la distribución geométrica, consideramos un éxito cuando se registra por primera vez un caso de violencia en el rango de edad de 12 a 17 años, y un fracaso cuando se registra otro tipo de caso de violencia en otro rango de edad. Supongamos que nuestro equipo de trabajo registra 345 observaciones hasta obtener el primer caso de violencia entre el rango de 12 a 17 años. **`¿Cuál es la probabilidad de que se necesiten 20 o menos observaciones para obtener por primera vez dicho caso?`**

Definimos nuestra variable aleatoria discreta:

X: número de observaciones necesarias para obtener el primer registro de violencia entre el rango de 12 a 17 años en una provincia de Lima.

Conociendo la probabilidad de éxito:

$$ X∼G(p)$$
$$ X∼G(0.01906925)$$
Represetando gráficamente la función de probabilidad geométrica de la variable discreta X.

```{r echo=FALSE}
# Generar los valores de X
x <- 0:345
# Calcular las probabilidades
prob_condicion <- dgeom(x,p)
# Graficar la función de probabilidad
plot(x, prob_condicion, type = "h", xlab = "X", ylab = "P(X)", main = "Función de la distribución Geométrica",lwd = 3,col = "green")
```
La situación nos pide la probabilidad de que se necesiten 20 o menos observaciones para obtener por primera vez un registro de violencia entre el rango de 12 a 17 años: 
$$ P(X≤20)=1-P(X>20)$$
```{r echo=FALSE}
# Definir los parámetros de la distribución geométrica
p <- 0.01906925  # Probabilidad de éxito
# Generar los valores de X
x <- 0:345
# Calcular las probabilidades
prob_condicion <- dgeom(x, p)
# Graficar la función de probabilidad con dos colores delimitados
plot(x, prob_condicion, type = "h", xlab = "X", ylab = "P(X)",
     main = "Función de la distribución Geométrica X", lwd = 3)
# Agregar colores para delimitar
n <- length(x)
threshold <- 20  # Valor de umbral para cambiar de color
colors <- rep("green", n)
colors[1:threshold] <- "blue"
segments(x, rep(0, n), x, prob_condicion, col = colors, lwd = 3)
```
```{r echo=FALSE}
VG2 <- round(sum(pgeom(20,0.01906925)),4)
cat('La probabilidad de que sea necesrio regisrar 20 o menos observaciones por primera de un caso de violencia entre el rango de 12 a 17 años:', VG2)
```



# **Conclusiones**

En 2020 se registraron 113963 casos reportados, en 2021 aumentó en 40% aproximadamente, teniendo el mayor número de casos reportados: 163155. Para 2022 se registró una ligera disminución de un 12% aproximadamente, llegando a 142556 casos reportados.

Los tipos de violencia más frecuentes son la psicológica y la física (151.96 y 128.58 de promedio de casos atendidos respectivamente), mientras que la sexual solo tiene 48.36 de promedio de casos atendidos, pero está en un ligero aumento 2022. 

La región costa ocupa la mayor cantidad de casos reportados: 267075 siendo aproximadamente el 67% del total, destaca Lima con aproximadamente el 27% del total. La región selva es quien tiene menos casos reportados: 37229 (9% aprox. Del total) teniendo la menor cantidad de casos reportados Madre de Dios: 3090 (0.8 % aprox.)

El promedio de la frecuencia de los casos atendidos en mujeres es más de 6 veces con respecto a los hombres, también equivale al 85% aproximadamente del total del promedio de la frecuencia de los casos atendidos.

La violencia afecta de manera diferenciada a distintos grupos de edad y género. Las mujeres entre 30 a 59 años presentan la mayor cantidad de casos reportados (37% aproximadamente del total), los niños y niñas de 0 a 11 años han representado la menor cantidad de reportes (5% aproximadamente del total)

# **Conclusiones**

En 2020 se registraron 113963 casos reportados, en 2021 aumentó en 40% aproximadamente, teniendo el mayor número de casos reportados: 163155. Para 2022 se registró una ligera disminución de un 12% aproximadamente, llegando a 142556 casos reportados.

Los tipos de violencia más frecuentes son la psicológica y la física (151.96 y 128.58 de promedio de casos atendidos respectivamente), mientras que la sexual solo tiene 48.36 de promedio de casos atendidos, pero está en un ligero aumento 2022. 

La región costa ocupa la mayor cantidad de casos reportados: 267075 siendo aproximadamente el 67% del total, destaca Lima con aproximadamente el 27% del total. La región selva es quien tiene menos casos reportados: 37229 (9% aprox. Del total) teniendo la menor cantidad de casos reportados Madre de Dios: 3090 (0.8 % aprox.)

El promedio de la frecuencia de los casos atendidos en mujeres es más de 6 veces con respecto a los hombres, también equivale al 85% aproximadamente del total del promedio de la frecuencia de los casos atendidos.

La violencia afecta de manera diferenciada a distintos grupos de edad y género. Las mujeres entre 30 a 59 años presentan la mayor cantidad de casos reportados (37% aproximadamente del total), los niños y niñas de 0 a 11 años han representado la menor cantidad de reportes (5% aproximadamente del total)

# **Referencias**

MIMP Número de casos atendidos por violencia contra la mujer, integrantes del grupo familiar y violencia sexual, según sexo y departamento | Plataforma Nacional de Datos Abiertos. (2022). Datosabiertos.gob.pe. https://www.datosabiertos.gob.pe/dataset/mimp-n%C3%BAmero-de-casos-atendidos-por-violencia-contra-la-mujer-integrantes-del-grupo-familiar

Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer.

Chang, W. (2013). R Graphics Cookbook. O'Reilly Media.
