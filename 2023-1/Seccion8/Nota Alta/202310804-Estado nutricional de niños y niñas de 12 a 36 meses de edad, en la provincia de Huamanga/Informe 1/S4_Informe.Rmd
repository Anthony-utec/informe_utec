---
title: "**Estado nutricional de niños y niñas de 12 a 36 meses de edad, en la provincia de Huamanga en el año 2022 (Perú)**"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    toc_float: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: yes
    number_sections: no
    theme: yeti
---

# **Introducción**

## **Relevancia**

Estudiar el estado nutricional de los niños y niñas de 12 a 36 meses en la provincia de Huamanga en el año 2022 es importante porque genera información relevante para entender  y abordar los problemas relacionados con la nutrición infantil. Asimismo, identificar posibles deficiencias nutricionales en esta población es motivo de preocupación, ya que la precariedad del estado nutricional se evidencia en la presencia de diferentes tipos de condiciones de peso, como el bajo peso, el sobrepeso, obesidad o la desnutrición. Estas condiciones pueden tener consecuencias negativas a largo plazo en la salud y el bienestar de los niños y niñas, por lo que es vital identificar y abordar cualquier problema de desnutrición. 

## **Objetivos**

### **Objetivo General**  

Describir el estado nutricional de niños y niñas de 12 a 36 meses de edad en la provincia de Huamanga en el año 2022.  
 
### **Objetivos específicos**

**-** Determinar la relación de la hemoglobina con la edad  de niños y niñas de 12 a 36 meses de edad, en la provincia de Huamanga en el año 2022.	

**-** Determinar el índice de masa corporal de niños y niñas de 12 a 36 meses de edad, en la provincia de Huamanga en el año 2022. 

**-** Determinar la cantidad de niños y niñas de 12 a 36 meses de edad, que pertenecen a los programas sociales (SIS, Qali Warma y Juntos), en la provincia de Huamanga en el año 2022. 

**-** Determinar los centros de salud en los cuales fueron atendidos la mayor cantidad de niños y niñas de 12 a 36 meses edad, según su sexo en la provincia de Huamanga en el año 2022.
	
**-** Comparar y analizar el estado nutricional de niños y niñas de 12 a 36 meses de edad, con los tres distritos más destacados en la provincia de Huamanga en el año 2022. 

## **Contexto** 

La provincia de Huamanga, ubicada en la región de Ayacucho en Perú, alberga una población significativa de niños y niñas en el rango de edad de 12 a 36 meses. Esta etapa temprana de la vida es crítica para el desarrollo físico y cognitivo óptimo de los niños y establece las bases para su salud y bienestar en el futuro. Sin embargo, diversos factores económicos y sociales influyen en el estado nutricional de los niños. Desde el punto de vista económico, Huamanga se caracteriza por tener una tasa de pobreza alta, lo que limita el acceso a alimentos nutritivos y servicios de salud adecuados. Además, es importante considerar los programas sociales existentes en la provincia de Huamanga, como SIS ,Qali Warma y Juntos, que tienen como objetivo brindar apoyo y asistencia a las familias en situación de vulnerabilidad. Estos programas pueden desempeñar un papel importante en el estado nutricional de los niños y niñas, ya sea a través de la provisión de alimentos o el acceso a servicios de salud y educación. Comprender este contexto es fundamental para diseñar intervenciones efectivas y estrategias de mejora del estado nutricional en esta población.

# **Datos**

## **Proceso de recolección de datos**

Para la recolección de datos, se consultó al docente las fuentes de las cuales podríamos extraer una base de datos necesario para nuestro tema, debido a que se decidió trabajar con una base de datos. El motivo por el cuál elegimos una base de datos fue para obtener más datos confiables y además requiere menos tiempo en comparación a una encuesta. 

## **Población, muestra y muestreo**

**Población:** Los niños del departamento de Ayacucho.

**Unidad muestral:** Niños de 12 a 36 meses de edad en la provincia de Huamanga.

**Tipo de muestreo:** El tipo de muestreo es no probabilístico, debido a que la elección de los datos es por conveniencia al tener una data el cual faltan datos en algunas observaciones.

## **Variables**
```{r, echo=FALSE}
V= c("Distrito", "Sexo", "Edad", "CentroDeSalud", "Juntos", "SIS", "Qaliwarma", "Peso", "Estatura", "PTZ", "ZTE", "ZPE", "Dx_PT", "Dx_TE", "Dx_PE", "Hemoglobina", "IMC")

TV = c("Categórica nominal", "Categórica nominal", "Numérica discreta", "Categórica nominal", "Categórica nominal", "Categórica nominal", "Categórica nominal", "Numérica continua", "Numérica continua", "Numérica Continua", "Numérica continua", "Numérica continua", "Categórica ordinal", "Categórica ordinal", "Categórica ordinal", "Numérica continua", "Numérica continua")

R = c("Distritos de la provincia estudiada", "Sexo biológico", "Número entero mayor igual a 12 y menor igual a 36", "Centros de Salud de la provincia estudiada", "Programa social", "Programa de salud", "Programa social", "Valor decimal positivo medido en kilogramos", "Valor decimal positivo medido en centímetros", "Número decimal negativo o positivo", "Número decimal negativo o positivo", "Número decimal negativo o positivo", "","","", "Valor decimal positivo", "Valor decimal positivo")

Tabla_de_variable = data.frame(V,TV,R)
Tabla_de_variable
```

## **Limpieza de base de datos**

### **Criterio de filtración de nuestro base datos** 

La región de Ayacucho por ser una región en donde habitan una gran cantidad de personas. Se considera la ciudad de Huamanga específicamente porque es la capital de dicho departamento en donde se ubica gran porcentaje de la población total.

```{r}
#install.packages("readr")
library(readr)
#install.packages(dplyr)
library(dplyr)
#install.packages("modeest")
library(modeest)
#install.packages("DescTools")
library(DescTools)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("stringi")
library(stringi)
#install.packages("car")
library(car)
#install.packages("plotrix")
library(plotrix)
#install.packages("knitr")
library(knitr)
#install.packages("kableExtra")
library(kableExtra)
#install.packages("boot")
library(boot)
#install.packages("remotes")
library(remotes)
```


La limpieza de datos inicia con llamar a la base de datos. En este caso es un archivo **csv** que se descargó con el nombre de **"Niños_AYACUCHO"**, pero se asignó un nombre más fácil de utilizar, que será **"D"**.
```{r,echo=FALSE}
library(readr)
Niños_AYACUCHO <- read_csv("Niños AYACUCHO.csv")
```

```{r}
D<-Niños_AYACUCHO
```


En primer lugar, se filtra la base de datos de acuerdo a la muestra que realiza este estudio. En este análisis, se requiere filtrar al **Departamento de Ayacucho**, por **niños de 12-36 meses** que viven en la **provincia de Huamanga.**
```{r,echo=FALSE}
D<-filter(D, Prov_EESS=="HUAMANGA",EdadMeses>=12,EdadMeses<=36)
```

Luego, se procede a cambiar algunos nombres de las variables de la base de datos por nombres más sencillos, para ejecutar cualquier código que requiera dicha variable para este estudio. Además, se seleccionan las variables que se necesita para el análisis de este proyecto. Cada cambio se va actualizando en la misma base datos para no asignar muchos nombres a cada proceso.
```{r,echo=FALSE}
D <- rename(D, Distrito='Dist_EESS' , Edad='EdadMeses', CentroDeSalud='CentroPobladoPN', PIN='Pin',Estatura='Talla' )
D<-select(D, 8,12,14,19:28,30:33)
View(D)
D
```

Se verifica el tipo de variable que **Rstudio** categoriza a la base de datos. 
```{r}
class(D$Distrito)
class(D$Sexo)
class(D$Edad)
class(D$CentroDeSalud)
class(D$Juntos)
class(D$SIS)
class(D$PIN)
class(D$Qaliwarma)
class(D$Peso)
class(D$Estatura)
class(D$PTZ)
class(D$ZTE)
class(D$ZPE)
class(D$Dx_PT)
class(D$Dx_TE)
class(D$Dx_PE)
class(D$Hemoglobina)
```
De acuerdo a **R** a nuestras variables categóricas nominales les considera como numéricas. Por ello, se procede a corregir dichos errores.
```{r,echo=FALSE}
D$Juntos<-as.character(D$Juntos)
D$SIS<-as.character(D$SIS)
D$PIN<-as.character(D$PIN)
D$Qaliwarma<-as.character(D$Qaliwarma)
```
Se verifica el cambio de estas variables.
```{r,echo=FALSE}
class(D$Juntos)
class(D$SIS)
class(D$PIN)
class(D$Qaliwarma)
```
Además, se cambia el nombre de un tipo de la variable **Dx_PT** para entender mejor los conceptos empleados.
```{r,echo=FALSE}
D <- D %>% mutate(Dx_PT = ifelse(Dx_PT == "D.Aguda", "Bajo Peso", Dx_PT))
unique(D$Dx_PT)
```


Después de tener la base de datos limitada por las características del estudio. La base de datos de la muestra presenta la siguiente dimensión :
```{r,echo=FALSE}
nrow(D)
ncol(D)
dim(D)
```
7374 filas y 17 columnas. En la cual, las filas son las unidades muestrales u observaciones y las columnas las variables de la muestra. 

Se identifica que variables contienen datos faltantes para realizar la limpieza de datos correspondiente para tener un estudio con un sesgo menor.
```{r,echo=FALSE}
colSums(is.na(D))
```
Se visualiza que la variable con más datos faltantes es **Hemoglobina** y 5 variables con la misma cantidad de datos faltantes. La primera opción sería eliminar todos los datos faltantes, por lo cual veremos si tiene un gran impacto en el tamaño de la muestra. Se asigna a DF la base de datos sin datos faltantes.
```{r, echo=FALSE}
DF<-na.omit(D)
View(DF)
DF
```
Se halla la dimensión de DF
```{r,echo=FALSE}
dim(DF)
```


Se observa que la cantidad de observaciones se redujo más del 50% de las observaciones de la muestra. Por lo tanto, eliminar todos los datos faltantes no es un buena opción para el estudio presente. 

Para ello, se utiliza condicionales para verificar si en cada fila hay **NA** en las 5 variables, que elimine la fila. Así no se eliminan datos innecesariamente. Un dato curioso es que en esta base de datos la variable **CentroDeSalud, Juntos, SIS, PIN, Qaliwarma** presentan **NA** en las mismas filas.
```{r,echo=FALSE}
D <- mutate(D,
             Filas_NA = ifelse(is.na(D$CentroDeSalud) & is.na(D$Juntos) & is.na(D$SIS) & is.na(D$PIN)& is.na(D$Qaliwarma), row_number(), NA))
print(D)
```
 En la columna **Filas_NA** se registra los números de filas en la que las 5 variables presentan **NA**. Es importante mencionar que en la condicional no se encuentra la variable **Hemoglobina**, ya que esta variable presenta **NA** en filas diferentes respecto a las otras 5 variables. Sin embargo, la cantidad de  filas a eliminar son eficientes para no afectar los datos de **Hemoglobina** y tener una muestra adecuada para el análisis.
 
Se filtra y elimina las filas con los 5 valores **NA**. Y se selecciona las primeras 17 columnas, que son las variables de la muestra.
```{r,echo=FALSE}
filas_NA <- D[!is.na(D$Filas_NA), ]
D <- D[is.na(D$Filas_NA), ]
D<-select(D,1:17)
print(D)
```

Se verifica los datos faltantes después de la limpieza.
```{r}
colSums(is.na(D))
```
Se observa que solo la variable **Hemoglobina** presenta datos faltantes, pero se redujo de la cantidad inicial. Sin embargo, no se eliminaron información importante para el análisis del estudio.La dimensión de la base limpia es:
```{r}
dim(D)
```
De los 7374 observaciones inicialmente, no se ve afectado la muestra drásticamente.
En términos de porcentajes, solo el 2.52% de los datos fueron eliminados 

```{r,echo=FALSE}
Porcentaje = round((sum(is.na(D))/sum(!is.na(D)))*100,2)
Porcentaje
```

Para el estudio del estado nutricional de la provincia Huamanga, se requiere conocer el Índice de masa corporal (IMC). Para ello, se verefica que la variable **Peso y Estatura** se encuentren en las unidades correspondientes.

**Convirtiendo la estatura en m ** 
```{r}
D$Estatura<-D$Estatura/100
```

**Creando la columna IMC = (peso (Kg)/Estatura^2(m))**
```{r}
D<-cbind(D, IMC =D$Peso/(D$Estatura*D$Estatura))
D$IMC<-round(D$IMC,3)
```


# **Análisis de los descriptores numéricos y gráficos**

**Desarrollo del objetivo específico 1**

Determinar la relación de la hemoglobina con la edad de niños y niñas de 12 a 36 meses de edad en la provincia de Huamanga en el año 2022.

**Histograma de la variable edad**
```{r,echo=FALSE}
library(ggplot2)
```


```{r,echo=FALSE}
# Calcular las medidas de resumen
media <- round(mean(D$Edad), 2)
mediana <- median(D$Edad)
moda <- as.numeric(names(table(D$Edad))[table(D$Edad) == max(table(D$Edad))])

# Crear el título y subtítulo del gráfico
titulo <- "Gráfica 1. Histograma de Edad"
subtitulo <- paste("Media =", media, "Mediana =", mediana, "Moda =", moda)

# Graficar el histograma

ggplot(data = D, mapping = aes(x = Edad, fill = "Barras")) +
  geom_histogram(bins = 50) +
  ggtitle(titulo, subtitle = subtitulo) +
  xlab('Edad') + ylab('Frecuencia') +
  geom_vline(aes(xintercept = media, color = "media"),
             linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = mediana, color = "mediana"),
             linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = moda, color = "moda"),
             linetype = "dashed", size = 1) +
  scale_color_manual(values = c("green", "red","orange"),
                     labels = c("Media", "Mediana","Moda")) +
  scale_fill_manual(values = "skyblue")  # Cambia "blue" al color que desees
```
```{r,echo=FALSE}
summary(D$Edad)
```
*Coeficiente de Variabilidad*

```{r,echo=FALSE}
#Coeficiente de variabilidad
round(sd(D$Edad)/mean(D$Edad),2)*100
```
En el gráfico, se puede notar que tanto la **mediana** (24) como la **media** (24.11) son valores cercanos entre sí. Esto implica que hay una tendencia central similar en la distribución de las edades. Sin embargo, también se observa una dispersión considerable de las edades en la muestra, lo que indica que hay una amplia variabilidad en relación con la edad media. Para corroborar esto, se calcula el coeficiente de variación, que resulta ser 31%. Por lo tanto, se concluye que la medida que mejor representa a la variable edad en este caso es la **mediana**. Además, son aproximadamente simétricas

**Histograma de la variable hemoglobina**
```{r,echo=FALSE}
# Calcular las medidas de resumen
media <- round(mean(DF$Hemoglobina), 2)
mediana <- median(DF$Hemoglobina)

# Crear el título y subtitulo del gráfico
titulo <- "Gráfica 2. Histograma de Hemoglobina"
subtitulo <- paste("Media =", media, "Mediana =", mediana)

# Dibujar el histograma con líneas de media y mediana
ggplot(data = D, aes(x = Hemoglobina)) +
  geom_histogram(binwidth = 0.5, fill = "steelblue", color = "white") +
  ggtitle(titulo, subtitle = subtitulo) +
  xlab('Hemoglobina') + ylab('Frecuencia') +
  geom_vline(aes(xintercept = media, color = "Media"),
             linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = mediana, color = "Mediana"),
             linetype = "dashed", size = 1) +
  scale_color_manual(values = c("yellow", "red"),
                     labels = c("Media", "Mediana")) +
  guides(color = guide_legend(title = "Líneas"))
```
```{r,echo=FALSE}
summary(DF$Hemoglobina)
```

```{r,echo=FALSE}
#Moda de la variable Hemoglobina
as.numeric(names(table(DF$Hemoglobina))[table(DF$Hemoglobina) == max(table(DF$Hemoglobina))])
```
La variable Hemoglobina es bimodal porque presenta dos valores con mayor repetición en la muestra. Es decir, hay mayor cantidad de niños y niñas que presentan este nivel de Hemoglobina.

El histograma de  hemoglobina de los niños presenta una distribución aproximadamente simétrica, con una **media** de 13.18 y **mediana** de 13.2, lo cual indica que la distribución de los valores de hemoglobina se equilibra a ambos lados de la media, y que no hay un sesgo evidente hacia valores más altos o más bajos. En otras palabras, no hay una inclinación hacia uno de los extremos.


```{r,echo=FALSE}
boxplot(D$Hemoglobina  ~D$Edad,las=3,cex.axis=0.8,xlab="Edad",ylab="Nivel de Hemoglobina",main=" Gráfica 3. Distribución del nivel de Hemoglobina por edades", col=rainbow(16))
```
```{r,echo=FALSE}
D$Edad[which.max(D$Hemoglobina)]
```
Los niños con una edad de 12 meses presentan mayor Hemoglobina.
```{r,echo=FALSE}
boxplot(DF$Hemoglobina ~DF$Distrito,las=3, cex.axis=0.6, xlab="Distrito", ylab="Nivel de Hemoglobina", main="Gráfica 4. Distribución del nivel de Hemoglobina por distritos", col=rainbow(16))
```
De acuerdo al diagrama de cajas los 5 distritos con mayor nivel de Hemoglobina son los que figuran en la siguiente tabla.

```{r,echo=FALSE}
# Calcular el promedio de hemoglobina por distrito
promedio_hemoglobina <- aggregate(Hemoglobina ~ Distrito, data = D, FUN = mean)

# Ordenar los distritos de forma descendente según el promedio de hemoglobina
distritos_ordenados <- promedio_hemoglobina[order(promedio_hemoglobina$Hemoglobina, decreasing = TRUE), ]

# Mostrar los distritos con mayor hemoglobina
distritos_mayor_hemoglobina <- head(distritos_ordenados, n = 5)

# Imprimir los distritos con mayor hemoglobina
print(distritos_mayor_hemoglobina)
```

```{r,echo=FALSE}
ggplot(data = D, aes(x = Sexo, y = Hemoglobina)) + 
  geom_jitter(aes(color = Sexo), size = 1, alpha = 0.7) +
  geom_boxplot(aes(color = Sexo), alpha = 0.7) + 
  xlab('Sexo') + 
  ylab('Nivel de Hemoglobina') +
  ggtitle('Gráfica 5. Nivel de Hemoglobina de acuerdo al Sexo') + 
  theme_minimal()
```

El gráfico de cajas muestra que existe una mayor dispersión o una mayor existencia de datos atípicos(outliers) para el caso de las niñas en comparación de los niños. Además, se puede observar que la **mediana** para ambos sexos son idénticas. Esto significa que el nivel de Hemoglobina para ambos sexos son similares.

```{r, echo=FALSE}
D1 <- D
```


```{r,echo=FALSE}
# Crear los intervalos de edad
intervalos <- seq(12, 36, by = 6)

# Asignar los intervalos a las edades
D1$Edad_intervalo <- cut(D1$Edad, intervalos, include.lowest = TRUE)

# Crear el gráfico
ggplot(D1, aes(x = Edad_intervalo, fill = Sexo)) +
  geom_bar(position = "dodge", stat = "count") +
  labs(x = "Edad", y = "Cantidad de Niños", fill = "Sexo") +
  ggtitle("                             Gráfica 6.Cantidad de Niños por Edad y Sexo")
```

En la siguiente gráfica se observar que entre 12 y 18 meses de edad existe mayor cantidad de niños. Además, se afirmar que no existe una diferencia grande en la cantidad de niños según el sexo.

**Desarrollo del objetivo específico 2**

Determinar el índice de masa corporal de niños y niñas de 12 a 36 meses de edad en la provincia de Huamanga en el año 2022. 

**Histograma de la variable Indice de masa corporal(IMC)**

```{r,echo=FALSE}
# Calcular las medidas de resumen
media <- round(mean(D$IMC), 2)
mediana <- median(D$IMC)

# Crear el título y subtitulo del gráfico
titulo <- "Gráfica 7. Histograma del Indice de Masa Corporal(IMC)"
subtitulo <- paste("Media =", media, "Mediana =", mediana)

# Dibujar el histograma con líneas de media y mediana
ggplot(data = D, aes(x = IMC)) +
  geom_histogram(binwidth = 0.5, fill = "skyblue", color = "white") +
  ggtitle(titulo, subtitle = subtitulo) +
  xlab('IMC') + ylab('Frecuencia') +
  geom_vline(aes(xintercept = media, color = "Media"),
             linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = mediana, color = "Mediana"),
             linetype = "dashed", size = 1) +
  scale_color_manual(values = c("orange", "black"),
                     labels = c("Media", "Mediana"))# +geom_density(color = "red", size = 1)
```

```{r,echo=FALSE}
summary(D$IMC)
```
El histograma de Índice de masa corporal de los niños presentó una distribución simétrica, con una **media** de 16.43  y una **mediana** de  16.338. Lo cual indica que la distribución de los valores del IMC se equilibra a ambos lados de la media y que no hay un sesgo evidente. Es decir, que no hay una inclinación hacia uno de los extremos.

```{r,echo=FALSE}
# Crear el gráfico de barras
grafico_imc <- ggplot(D, aes(x = Sexo, y = IMC, fill = Sexo)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Sexo", y = "IMC", title = "Gráfica 8. Distribución de IMC según el Sexo") +
  scale_fill_manual(values = c("blue", "pink")) +
  theme_minimal()

# Mostrar el gráfico
print(grafico_imc)
```
La niñas presentan mayor IMC que los niños.

```{r,echo=FALSE}
rectas <- D %>%
  group_by(Dx_PT) %>%
  do(modelo = lm(Estatura ~ Peso, data = .)) %>%
  rowwise() %>%
  mutate(pendiente = coef(modelo)[["Peso"]],
         intercepto = coef(modelo)[["(Intercept)"]],
         ecuacion = paste("y = ", round(pendiente, 4), "x + ", round(intercepto, 4)))

# Definir los colores para cada nivel de Dx_PT
colores <- c("Bajo Peso" = "red",
              "Normal" = "green",
             "Sobrepeso" = "orange",
             "Obesidad" = "purple")

# Creamos la gráfica
ggplot(D, aes(Peso, Estatura)) +
  geom_point(aes(color = factor(Dx_PT, levels = names(colores)))) +
  geom_smooth(method = "lm", se = FALSE, color = "black", aes(group = Dx_PT)) +
  labs(title = "Gráf 9. Diagnóstico en tratamiento para la anemia en relación de la estatura y peso",
       x = "Peso",
       y = "Estatura") +
  scale_color_manual("Nivel de DX_PT", values = colores) +
  facet_wrap(~ Dx_PT, nrow = 2) +
  geom_text(data = rectas, aes(x = Inf, y = Inf, label = ecuacion, group = Dx_PT), 
            vjust = "inward", hjust = "inward", check_overlap = TRUE, size = 3)
```

```{r,echo=FALSE}
#Correlación de variabilidad entre la variable Peso y Edad
round(cor(DF$Peso,DF$Estatura),2)
```
En el Diagrama de dispersión del Diagnóstico de Poblaciones de Riesgo en Tratamiento para la anemia(DX_PT) se muestra que existe una correlación fuertemente positiva. Además, se puede observar que existe una relación lineal bien marcada.


```{r,echo=FALSE}
summary(filter(select(D, 11:16), Dx_PT == "Aguda")$PTZ)
summary(filter(select(D, 11:16), Dx_PT == "Normal")$PTZ)
summary(filter(select(D, 11:16), Dx_PT == "Sobrepeso")$PTZ)
summary(filter(select(D, 11:16), Dx_PT == "Obesidad")$PTZ)

summary(filter(select(D, 11:16), Dx_TE == "D.Crónica")$ZTE)
summary(filter(select(D, 11:16), Dx_TE == "Normal")$ZTE)

summary(filter(select(D, 11:16), Dx_PE == "D.Global")$ZPE)
summary(filter(select(D, 11:16), Dx_PE == "Normal")$ZPE)
```


**PTZ: Índice que compara el peso del menor con el peso esperado para su talla y permite establecer si ha ocurrido una pérdida/ganancia de peso corporal.**

Rango para Bajo Peso en PTZ = [-4.780, -2.010]

Rango para Normal en PTZ = [-1.980, 2.000]

Rango para Sobrepeso en PTZ  = [2.010, 2.960]

Rango para Obesidad en PTZ =[3.020,4.540]


```{r,echo=FALSE}
# Crear el dataframe con los rangos y categorías
data <- data.frame(
  Categorias = c("Aguda", "Normal", "Sobrepeso", "Obesidad", "Normal", "Crónica", "Normal", "Global"),
  Variable = c("PTZ", "PTZ", "PTZ", "PTZ", "ZTE", "ZTE", "ZPE", "ZPE"),
  Rango_Inferior = c(-4.780, -1.980, 2.010, 3.020, -5.750, -2.010, -5.450, -2.000),
  Rango_Superior = c(-2.010, 2.000, 2.960, 4.540, -2.010, 5.9100, -2.010, 3.700)
)

# Establecer el orden de las categorías para cada variable
orden_PTZ <- c("Aguda", "Normal", "Sobrepeso", "Obesidad")
orden_ZTE <- c("Normal", "Crónica")
orden_ZPE <- c("Normal", "Global")

# Convertir la columna "Categorias" en un factor con el orden deseado para cada variable
data$Categorias <- factor(data$Categorias, levels = unique(c(orden_PTZ, orden_ZTE, orden_ZPE)))
```


```{r,echo=FALSE}
# Crear gráficos separados para cada variable
grafico_PTZ <- ggplot(data[data$Variable == "PTZ", ], aes(x = Categorias, y = Rango_Superior)) +
  geom_point(aes(color = Variable), size = 3) +
  geom_line(aes(group = Variable, color = Variable), size = 1) +
  geom_errorbar(aes(ymin = Rango_Inferior, ymax = Rango_Superior, color = Variable), width = 0.2) +
  labs(x = "Categorías", y = "Valor", title = "Gráfica 10. Rangos y Categorías - PTZ") +
  scale_color_manual(values = c("blue")) +
  theme_minimal()
#Mostrar el gráfico
print(grafico_PTZ)
```

```{r,echo=FALSE}
par(mar = c(1.7, 8, 0.45, 3) + 0.1)
mosaicplot(D$Dx_PT ~ D$Sexo,
           col = 2:5,
           main = "Gráfica 11. Niveles de peso para la talla esperada según sexo",
           xlab = "Nivel",
           ylab = "Sexo",
           cex.axis = 1,
           as = 1,
           las = 2)
```

Al observar la gráfica de mosaico que representa la condición del peso de acuerdo a la talla esperada de los niños, se puede notar que la gran mayoría se encuentra en la categoría de peso normal. En contraste, las barras correspondientes a las categorías de sobrepeso, obesidad y bajo peso son mucho más bajas, lo que sugiere que estas condiciones son menos comunes en la población estudiada.

**ZTE: Índice que compara la talla del menor con la talla esperada para su edad y permite establecer si está ocurriendo un retraso en el crecimiento.**

Rango para Crónica en ZTE = [-5.750, -2.010]

Rango para Normal en ZTE = [-2.000,5.9100]


```{r,echo=FALSE}
grafico_ZTE <- ggplot(data[data$Variable == "ZTE", ], aes(x = Categorias, y = Rango_Superior)) +
  geom_point(aes(color = Variable), size = 3) +
  geom_line(aes(group = Variable, color = Variable), size = 1) +
  geom_errorbar(aes(ymin = Rango_Inferior, ymax = Rango_Superior, color = Variable), width = 0.2) +
  labs(x = "Categorías", y = "Valor", title = "Gráfica 12. Rangos y Categorías - ZTE") +
  scale_color_manual(values = c("green")) +
  theme_minimal()
#Mostrar el gráfico
print(grafico_ZTE)
```

```{r, echo=FALSE}
mosaicplot(D$Dx_TE ~ D$Sexo,
           col=3:6,
           main="Gráfica 13. Niveles de talla para la edad esperada según sexo",
           xlab="Nivel",
           ylab="Sexo",
           cex.axis=1 ,as=1)
```


La siguiente gráfica representa la condición de la talla para la edad esperada de los niños, donde se nota que la mayor cantidad de niños  se encuentran en la categoría de una talla normal para su edad. En contraste, la barra correspondiente a la categoría de desnutrición crónica muestra una menor cantidad de individuos lo que sugiere que esta condición es menos común en la población estudiada.

**ZPE: Índice que compara el peso del menor con el peso esperado para su edad y permite establecer si está ocurriendo desnutrición.**

Rango para Global en ZPE = [-5.450 -2.010]

Rango para Normal en ZPE =[-2.000,3.700]

```{r,echo=FALSE}
grafico_ZPE <- ggplot(data[data$Variable == "ZPE", ], aes(x = Categorias, y = Rango_Superior)) +
  geom_point(aes(color = Variable), size = 3) +
  geom_line(aes(group = Variable, color = Variable), size = 1) +
  geom_errorbar(aes(ymin = Rango_Inferior, ymax = Rango_Superior, color = Variable), width = 0.2) +
  labs(x = "Categorías", y = "Valor", title = "Gráfica 14. Rangos y Categorías - ZPE")+
  scale_color_manual(values = c("orange")) +
  theme_minimal()
#Mostrar el gráfico
print(grafico_ZPE)
```

```{r, echo=FALSE}
mosaicplot(D$Dx_PE ~ D$Sexo,
           col=7:10,
           main="Gráfica 15. Niveles de peso para la edad esperada según sexo",
           xlab="Nivel",
           ylab="Sexo",
           cex.axis=1 ,as=1)
```

La siguiente gráfica representa la condición del peso para la edad esperada de los niños, donde se nota que la mayor cantidad de niños se encuentran en la categoría de un peso normal para su edad. En contraste, la barra correspondiente a la categoría de desnutrición global muestra una menor cantidad de niños lo que sugiere que esta condición es menos común en la población estudiada.

**Desarrollo del objetivo especifico 3**

Determinar la cantidad de niños y niñas de 12 a 36 meses que pertenecen a los programas sociales (SIS, Qali Warma y Juntos)  en la provincia de Huamanga en el año 2022.

```{r,echo=FALSE}
# Calcular la cantidad de niños pertenecientes a algún programa.
B<-select(D,5,6,8)
conteo_programas <- colSums(B == "1")  # "A" representa la categoría del programa
colores <- c("blue", "red", "orange")
# Graficar el conteo de personas por programa
bp1<- barplot(conteo_programas,col=colores, xlab = "Programas Sociales", ylab = "Cantidad de Niños",main = "Gráfica 16. Cantidad de niños que pertenecen a un programa social",ylim= c(0,7000))
text(bp1, conteo_programas, labels = conteo_programas, pos = 3, cex = 1)
```

```{r,echo=FALSE}
round(6145/nrow(D)*100,2)
```
Se puede observar que la cantidad de niños que pertenecen al programa SIS representan el 96.15% del total de niños evaluados.


```{r,echo=FALSE}
B$Juntos <- ifelse(B$Juntos == 1, "SI", "NO")
B$SIS <- ifelse(B$SIS == 1, "SI", "NO")
B$Qaliwarma <- ifelse(B$Qaliwarma == 1, "SI", "NO")
```

```{r,echo=FALSE}
#Calcular la tabla de contingencia de Programa y Sexo
tabla_contingencia <- table(B$SIS, D$Sexo)

#Definir una lista de colores personalizados
colores <- c("orange", "brown")

#Graficar la distribución de cantidad de personas según su sexo en los programas sociales con colores personalizados
bp2 <- barplot(tabla_contingencia, beside = TRUE,
               col = colores, xlab = "Programa SIS", ylab = "Cantidad de Niños",
               main = "Gráfica 17. Participación en el programa SIS según sexo", ylim = c(0, 3500))
legend("right", legend = rownames(tabla_contingencia), fill = colores, cex = 1, xpd = TRUE, y.intersp = 1, inset =c(0.34,0))
text(bp2, tabla_contingencia, labels = tabla_contingencia, pos = 3, cex = 1)
```

**Desarrollo del objetivo especifico 4**

Determinar los centros de salud en los cuales fueron atendidos la mayor cantidad de niños y niñas de 12 a 36 meses según su sexo en la provincia de Huamanga en el año 2022.

```{r,echo=FALSE}
# Calcular la cantidad de niños y niñas atendidos por centro de salud
atendidos <- D %>%
  group_by(CentroDeSalud, Sexo) %>%
  summarise(Cantidad = n(), .groups = "drop")

# Ordenar la tabla por la variable Cantidad de mayor a menor
atendidos <- atendidos %>%
  arrange(desc(Cantidad))

# Obtener el centro de salud con más niños y niñas atendidos
centro_mas_atendidos <- atendidos %>%
  filter(row_number() == 1) %>%
  pull(CentroDeSalud)
```


# **Tabla de Contingencia**
```{r,echo=FALSE}
titulo1 <- "Top 5 centros de salud con mayor cantidad de Atendidos"
cat("\n", titulo1)
# Obtener los cinco centros de salud con mayor cantidad
top_centros <- names(sort(table(D$CentroDeSalud), decreasing = TRUE))[1:5]

# Filtrar los datos solo para los centros de salud seleccionados
datos_filtrados <- subset(D, CentroDeSalud %in% top_centros)

# Crear la tabla de contingencia entre los centros de salud y el sexo
tabla_contingencia <- table(datos_filtrados$CentroDeSalud, datos_filtrados$Sexo)

# Mostrar la tabla de contingencia con el título
print(tabla_contingencia, quote = FALSE)
```
**Desarrollo del objetivo específico 5**

Comparar y analizar el estado nutricional de niños y niñas de 12 a 36 meses con los tres distritos más destacados en la provincia de Huamanga en el año 2022. 

```{r,echo=FALSE}
# Convertir la variable "Distrito" en un factor con el orden deseado
D$Distrito <- factor(D$Distrito, levels = c("SANTIAGO DE PISCHA","AYACUCHO","ACOCRO","ANDRES AVELINO CACERES D.","PACAYCASA", "VINCHOS","OCROS","CARMEN ALTO","SOCOS","SAN JOSE DE TICLLAS","JESUS NAZARENO","SAN JUAN BAUTISTA","ACOS VINCHOS","CHIARA", "TAMBILLO","QUINUA"))

# Crear el gráfico de barras con los distritos reordenados
g<- barplot(table(D$Distrito), xlab = "Cantidad de niños",
        main = "Gráfica 18. Distribución de niños por Distrito",xlim = c(0,2000),
        col = rainbow(16), horiz = TRUE, las = 1, names.arg = "")
# Agregar la leyenda
legend("topright", levels(D$Distrito),
       border = "black", fill = rainbow(16), cex = 0.6, y = 0.99999999)
```


```{r,echo=FALSE}
rename(data.frame(table(D1$Distrito)) %>% arrange(desc(select(data.frame(table(D1$Distrito)), 2))) %>% head(3), Distrito = 'Var1', CantidadDeNiños = 'Freq')
```

Podemos observar que los tres distritos mas destacados con respecto a la cantidad de niños son: Ayacucho, Jesús Nazareno y San Juan Bautista.


# **Conclusiones**

Los niños de 12 meses de edad presentan una mayor Hemoglobina. Los cuales se encuentran en los siguientes tres distritos: Vinchos, Chiara y Quinua con una Hemoglobina de 14.08, 13.68 y 13.43 respectivamente. 

El promedio del indice de masa corporal de los niños es 16.43. Además, las niñas presentan un IMC mayor en comparación de los niños. 

La cantidad total de niños que participan en los programas sociales Juntos, SIS Y Qaliwarma son 1099, 6145 y 8 respectivamente. Donde el programa SIS resalta por la mayor cantidad de participación tanto de niñas y niños.

Los centros de salud donde fueron atendidos la mayor cantidad de niños son Ayacucho- Ciudad, San Juan Bautista, Carmen Alto, Las Nazarenas - Pueblo. En el primero, fueron atendido 699 niñas y 671 niños, en el segundo, 440 niñas y 421 niños, en el tercero 277 niñas y 285 niños y en el último 209 niñas y 242 niños.

El estado nutricional de niños se encuentran en la categoría de peso normal. En contraste, las categorías de sobrepeso, obesidad y bajo peso son mucho más bajas. Además hay mayor cantidad de niños donde la estatura de un niño o niña con respecto a su edad se encuentra en una categoría normal que en una categoría crónica. Finalmente hay mayor cantidad de niños donde el peso de un niño o niña con respecto a su edad se encuentra en una categoría normal que en una categoría global. Por lo tanto, los niños de la provincia de Huamanga de 12 a 36 meses se encuentran en un buen estado nutricional.


