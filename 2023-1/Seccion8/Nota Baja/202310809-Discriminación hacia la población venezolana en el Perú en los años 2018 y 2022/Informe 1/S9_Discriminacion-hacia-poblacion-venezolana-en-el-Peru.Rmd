---
title: "Discriminación hacia la población venezolana en el Perú en los años 2018 y 2022"
output:
  html_document:
    toc: true
    toc_float: true
    theme: 'readable'
    css: 'styles.css'
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE)
```

```{r, echo=FALSE, message=FALSE}
# install.packages("rmarkdown")
# install.packages("haven")
# install.packages("esquisse")
# install.packages("dplyr")
# install.packages("tidyr")
# install.packages("datasets")
# install.packages("readxl")
# install.packages("funModeling")
# install.packages("ggplot2")
# install.packages("ggmosaic")
# install.packages("plotly")
# install.packages("reshape2")
```

```{r, echo=FALSE, message=FALSE}
library(rmarkdown)
library(haven)
library(esquisse)
library(dplyr)
library(tidyr)
library(datasets)
library(readxl)
library(funModeling)
library(ggplot2)
library(ggmosaic)
library(plotly)
library(reshape2)
```

# Tema

El tema general de este estudio es el análisis de la discriminación hacia la población venezolana mayor de 18 años en el Perú en los años 2018 y 2022. La información está basada en un estudio realizado por el INEI.

# Contexto

Durante los años 2018 y 2022, la población venezolana experimentó discriminación debido a la crisis migratoria que afectó al país. Esta crisis, impulsada por problemas económicos, políticos y sociales, llevó a un gran número de venezolanos a buscar una mejor condición de vida en otros. Sin embargo, muchos de ellos encontraron prejuicios y estereotipos negativos.

La discriminación se mostró a través de actitudes hostiles, exclusiones y generalizaciones negativas sobre los venezolanos, que a menudo se basaban en la percepción de que eran criminales, desempleados o pobres. Estos prejuicios contribuyeron a la marginalización y la violación de los derechos de los migrantes.

Para comprender plenamente esta problemática, es necesario conocer los antecedentes de la crisis migratoria, comprender los conceptos de xenofobia y prejuicios, y estar familiarizado con los derechos humanos y el marco legal que protege a los migrantes. Además, es fundamental escuchar las experiencias y testimonios de las personas venezolanas afectadas, ya que brindan una perspectiva personal sobre la discriminación que enfrentaron.

En resumen, la discriminación hacia la población venezolana en los años 2018 y 2022 fue el resultado de la crisis migratoria, xenofobia, prejuicios y estereotipos negativos. Es crucial abordar este tema con sensibilidad y promover la igualdad y el respeto hacia todas las personas, sin importar su origen o nacionalidad.
# Relevancia
Realizar un estudio de la población venezolana entre los años 2018 y 2022 es de suma importancia debido a la crisis sociopolítica y humanitaria que ha afectado al país en ese periodo. Este estudio puede proporcionar datos actualizados sobre el impacto de la crisis en áreas como salud, educación, empleo, migración y bienestar general de la población. También es posible analizar la migración y las condiciones de vida de los migrantes venezolanos, así como sus relaciones con factores personales como la edad y el sexo, todo esto con el objetivo de hallar indicadores que representen de manera precisa los niveles de discriminación en distintos rubros. En resumen, el estudio de la población venezolana en esos años es esencial para comprender y abordar los desafíos que enfrenta el país, informar decisiones y promover el cumplimiento de los derechos humanos.

# Finalidad y objetivos

La finalidad de este estudio es analizar y estudiar la discriminación hacia las personas mayores de 18 de nacionalidad venezolana en el Perú, así como también sus factores relacionados, en los años 2018 y 2022, con el objetivo de hallar indicadores que representen de manera precisa los niveles de discriminación en distintos rubros.

Entre los diversos objetivos de este estudio se encuentran:

<span class="custom-bullet">&#8226;</span>
Explicar la relación de la discriminación hacia la población venezolana mayor a 18 años, considerando su estado económico en el Perú en los años 2018 y 2022.

<span class="custom-bullet">&#8226;</span>
Determinar los factores personales por el cual la población venezolana mayor a 18 años fue discriminada en el Perú en los años 2018 y 2022.

<span class="custom-bullet">&#8226;</span>
Identificar los principales motivos de discriminación hacia la población venezolana mayor a 18 años y la principal población agresora en el Perú en el año 2022.

<span class="custom-bullet">&#8226;</span>
Buscar una relación entre el nivel de estudio y la discriminación hacia la población venezolana mayor a 18 años en el Perú en los años 2018 y 2022.

<span class="custom-bullet">&#8226;</span>
Describir la variación del nivel de discriminación que sufren los trabajadores independientes y dependientes mayores a 18 años en el Perú de acuerdo a su ingreso mensual en los años 2018 y 2022.

# Recolección de datos
Decidimos utilizar una base de datos existente llamada Instituto Nacional de Estadística e Informática para recopilar la información necesaria para este proyecto. Esta elección fue tomada con el propósito de evitar la necesidad de llevar a cabo una encuesta, ya que eso implicaría un costo financiero y temporal considerable que no es factible dentro del plazo establecido para la presentación del trabajo.

Los datos a utilizar en este estudio fueron obtenidos de la base de datos de INEI (Instituto Nacional de Estadística e Informática). La "Encuesta dirigida a la población venezolana que reside en el país, 2018 y 2022" proporciona información sobre la población venezolana en 10 módulos distintos orientados al estado económico y social, la satisfacción de derechos básicos, y la discriminación. En este caso, es el módulo 8 es el que contiene los datos de la encuesta sobre discriminación, aunque se utilizaran módulos relacionados con el fin de hallar una conexión entre los rubros.

La información de la base de datos es conseguida del [Catálogo de Base de Datos 2023](https://www.inei.gob.pe/media/difusion/apps/#p=1) del Instituto Nacional de Estadística e Informática. En la cual podemos encontrarla como __Encuesta dirigida a la Población Venezolana que reside en el país, 2022__ __(ENPOVE)__ y cuenta con una [ficha técnica](https://proyectos.inei.gob.pe/iinei/srienaho/Descarga/FichaTecnica/642-Ficha.pdf), un [cuestionario](https://proyectos.inei.gob.pe/iinei/srienaho/Descarga/DocumentosMetodologicos/2022-67/2-Cuestionario-ENPOVE.pdf) y una [base de datos en formatos CSV y SPSS](https://proyectos.inei.gob.pe/microdatos/index.htm).

# Especificaciones sobre muestra
Según la ficha técnica de la encuesta, la población objetivo consiste de 3611 viviendas con población venezolana en la capital de Tumbes, Trujillo, Arequipa y Tumbes. A nivel provincial, en la Provincia de Lima Metropolitana y la Provincia Constitucional del Callao. El rango de edad evaluado es a partir de los 5 años de edad. Para personas mayores a 12 años, se entrevistó directamente. Para personas menores a 12 y mayores a 5, la a información fue proporcionada por el jefe de hogar.

# Definiciones

<span class="custom-bullet">&#8226;</span>
Población agresora: Conjunto de individuos que, directa o indirectamente, violentan, agreden física, verbal o psicológicamente a una persona de nacionalidad venezolana.

# Base 2022
## Variables

<span class="custom-bullet">&#8226;</span>
Edad: La edad del encuestado

<span class="custom-bullet">&#8226;</span>
Género: El género de la persona

<span class="custom-bullet">&#8226;</span>
Nivel Estudios: Nivel de estudios que alcanzó el encuestado

<span class="custom-bullet">&#8226;</span>
Nivel Económico: Nivel económico al que pertenece el encuestado de acuerdo a sus ingresos
La variable **nivel económico** fue determinada con rangos de valores a criterio personal. Los rangos a considerar fueron:

<div class="rounded-box">
  <div class="table-container">
```{r, echo=FALSE}
limitesInferiores <- c('0', '701', '1001', '1401', '3001')
limitesSuperiores <- c('700', '1000', '1400', '3000', '...')
niveles <- c('Bajo', 'Medio Bajo', 'Medio', 'Medio Alto', 'Alto')
tablaVariables <- data.frame(limiI = limitesInferiores, limiS = limitesSuperiores, niv = niveles)
knitr::kable(tablaVariables, col.names = c('Límite Inferior', 'Límite Superior', 'Nivel'))
```
  </div>
</div>
\
<span class="custom-bullet">&#8226;</span>
Empleo: El estado de empleo actual de la persona

<span class="custom-bullet">&#8226;</span>
Discriminación: Representa si la persona se siente discriminada o no

<span class="custom-bullet">&#8226;</span>
Lugar: Lugar en el que la persona se siente discriminada

<span class="custom-bullet">&#8226;</span>
Motivo: Razón por la cual la persona se sintió discriminada

<span class="custom-bullet">&#8226;</span>
Agresor: Población por la cual la persona encuestada se siente discriminada

<span class="custom-bullet">&#8226;</span>
Horas Trabajo: Horas que la persona trabaja semanalmente

<span class="custom-bullet">&#8226;</span>
Ingreso Hora Independiente: Ingreso por hora en soles en trabajos independientes

<span class="custom-bullet">&#8226;</span>
Ingreso Hora Dependiente: Ingreso por hora en soles para trabajadores dependientes (en empresas)

## Tipos de variables

<div class="rounded-box">
  <div class="table-container">
```{r, echo=FALSE}
nombresVariables <- c('Edad', 'Género', 'Nivel Estudio', 'Estado Económico', 'Empleo', 'Discriminación', 'Lugar', 'Motivo', 'Agresor', 'Horas Trabajo', 'Ingreso Hora Independiente', 'Ingreso Hora Dependiente')

tiposVariables <- c('Numérica discreta', 'Categórica nominal', 'Categórica ordinal', 'Categórica ordinal', 'Categórica nominal', 'Categórica nominal', 'Categórica nominal', 'Categórica nominal', 'Categórica nominal', 'Numérica discreta', 'Numérica continua', 'Numérica continua')

valoresVariables <- c('Número entero', 'Hombre o Mujer', 'Número entero 1-10 con un nombre asociado', 'Número entero 1-5 representando un intervalo de ingresos', 'Sí o No', 'Sí o No', 'Sí o No para cada columna que representa un lugar distinto', 'Sí o No para cada columna que representa un motivo distinto', 'Sí o No para cada columna que representa un tipo de persona distinta', 'Número entero', 'Decimal', 'Decimal')

tablaVariables <- data.frame(Nombre = nombresVariables, Tipo = tiposVariables, Valores = valoresVariables)
knitr::kable(tablaVariables)
```
  </div>
</div>

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
C_EDAD <- read_sav("EDAD_CARACTERISTICAS_2022.SAV", col_select = c("P204", "P205_A", "P208", "NSELV", "P200_N") )
C_EDAD <- as_factor(C_EDAD)

C_DISCR <- read_sav("DISCRIMINACION_2022.SAV", col_select = c("P701", "P702_1", "P702_2","P702_3","P702_4","P702_5","P702_6","P702_7","P703_1", "P703_2","P703_3", "P703_4","P703_5","P703_6","P703_7","P703_8","P703_9","P703_10","P704_1","P704_2", "P704_3","P704_4","P704_5","P704_6","P704_7", "P704_8", "P704_9", "NSELV", "P200_N") )
C_DISCR <- as_factor(C_DISCR)

C_EMPL <- read_sav("EMPLEO_2022.SAV", col_select = c("P621","P622_1","P622_2", "P623_1","P623_2", "P615_T", "P601", "NSELV", "P200_N") )
C_EMPL <- as_factor(C_EMPL)

C_EDU <- read_sav("EDUCACION_2022.SAV", col_select = c("P501", "P501A", "P501B", "NSELV", "P200_N") )
C_EDU <- as_factor(C_EDU)

C_EMPL$P615_T <- C_EMPL$P615_T*4
C_EMPL <- C_EMPL %>% mutate(GANANCIA_POR_HORA_TRABAJADOR_INDEPENDIENTE = round((P623_1+P623_2)/(P615_T),3))
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
C_EMPL$P621 <- case_when(
  C_EMPL$P621 == "1.Diario?" ~ 30,
  C_EMPL$P621 == "2.Semanal?" ~ 4,
  C_EMPL$P621 == "3.Quincenal?" ~ 2,
  C_EMPL$P621 == "4.Mensual?" ~ 1,
  C_EMPL$P621 == "5.No recibió pago alguno" ~ 0,
  TRUE ~ NA
)

C_EMPL <- C_EMPL %>% mutate(INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE = round(((P622_1+P622_2)*P621)/(P615_T),3))
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}

C_EMPL <- C_EMPL %>% unite(NSELV,P200_N, col = CODIGO, sep = "_", remove = F) %>% print()
C_EDAD <- C_EDAD %>% unite(NSELV,P200_N, col = CODIGO, sep = "_", remove = F) %>% print()
C_EDU <- C_EDU %>% unite(NSELV,P200_N, col = CODIGO, sep = "_", remove = F) %>% print()
C_DISCR <- C_DISCR %>% unite(NSELV,P200_N, col = CODIGO, sep = "_", remove = F) %>% print()
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# Eliminando repetidos NSELV y P200

C_EMPL <- select(C_EMPL, -NSELV, -P200_N)
C_EDAD <- select(C_EDAD, -NSELV, -P200_N)
C_EDU <- select(C_EDU, -NSELV, -P200_N)
C_DISCR <- select(C_DISCR, -NSELV, -P200_N)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# Merge
base2022 <- Reduce(function(...) merge(..., by.x = "CODIGO", by.y = "CODIGO", all = TRUE), list(C_EDU, C_EMPL, C_DISCR, C_EDAD))

```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
base2022$P501 <- as.numeric(base2022$P501)
base2022$P501B <- as.numeric(base2022$P501B)
for (i in 1:nrow(base2022)) {
  base2022$P501[i] <- sum(base2022$P501[i], base2022$P501B[i], na.rm = T)
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#creamos la suma de las columnas de ingresos para crear el nivel economico
for (i in 1:nrow(base2022)) {
  base2022$NIVEL_ECONO[i] <- sum(((base2022$P622_1[i]+base2022$P622_2[i])*base2022$P621[i]), (base2022$P623_1[i]+base2022$P623_2[i]), na.rm = T)
}
```




```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# CREACIÓN DE COPIAS ANTES DE LA LIMPIEZA

base2022_sucia <- base2022

base2022 <- base2022 %>% filter(P205_A >= 18 | is.na(P205_A))
#base2022 <- base2022[!is.na(base2022$P501A),]
base2022 <- base2022[!is.na(base2022$P701),]
#base2022 <- base2022[!is.na(base2022$P619),]
base2022 <- base2022 %>% filter_at(.vars = vars(P622_1,P623_1), .vars_predicate = any_vars(!is.na(.)))
```




```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
ceros_ingres <- base2022 %>% filter(NIVEL_ECONO == 0)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#Creamos la escala economia 

#A(1) -> (3001, ...)  Alto 
#B(2) -> (1401, 3000) Medio Alto
#C(3) -> (1001, 1400) Medio
#D(4) -> (701, 1000)  Medio Bajo
#E(5) -> (0, 700)     Bajo

base2022$NIVEL_ECONO[1]
for (i in 1:nrow(base2022)){
  if (base2022$NIVEL_ECONO[i] <= 3000 ){
    if(base2022$NIVEL_ECONO[i] <= 1400){
      if(base2022$NIVEL_ECONO[i] <= 1000){
        if(base2022$NIVEL_ECONO[i] <= 700){
          base2022$NIVEL_ECONO[i] = 5
        }
        else{
          base2022$NIVEL_ECONO[i] = 4
        }
      }
      else{
        base2022$NIVEL_ECONO[i] = 3
      }
    }
    else{
      base2022$NIVEL_ECONO[i] = 2
    }
  }
  else {
    base2022$NIVEL_ECONO[i] = 1
  }
}
table(base2022$NIVEL_ECONO)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#RENOMBRANDO

base2022 <- base2022 %>% rename(NIVEL_EDU = P501)
base2022 <- base2022 %>% rename(ESTADO_TRABAJO = P601)
base2022 <- base2022 %>% rename(HORAS_TOTALES_TRABAJ = P615_T)
#base2022 <- base2022 %>% rename(BUSCAS_TRABAJO = P619)
base2022 <- base2022 %>% rename(INGRESO_T_DEP = P622_1)
base2022 <- base2022 %>% rename(INGRESO_T_IND = P623_1)
base2022 <- base2022 %>% rename(SENTIRSE_DISC = P701)
base2022 <- base2022 %>% rename(SEXO = P204)
base2022 <- base2022 %>% rename(EDAD = P205_A)
base2022 <- base2022 %>% rename(MIGRÓ_DE_V = P208)

base2022 <- base2022 %>% rename(MOT_DISC_1 = P702_1)
base2022 <- base2022 %>% rename(MOT_DISC_2 = P702_2)
base2022 <- base2022 %>% rename(MOT_DISC_3 = P702_3)
base2022 <- base2022 %>% rename(MOT_DISC_4 = P702_4)
base2022 <- base2022 %>% rename(MOT_DISC_5 = P702_5)
base2022 <- base2022 %>% rename(MOT_DISC_6 = P702_6)
base2022 <- base2022 %>% rename(MOT_DISC_7 = P702_7)

base2022 <- base2022 %>% rename(LUG_DIS_1 = P703_1)
base2022 <- base2022 %>% rename(LUG_DIS_2 = P703_2)
base2022 <- base2022 %>% rename(LUG_DIS_3 = P703_3)
base2022 <- base2022 %>% rename(LUG_DIS_4 = P703_4)
base2022 <- base2022 %>% rename(LUG_DIS_5 = P703_5)
base2022 <- base2022 %>% rename(LUG_DIS_6 = P703_6)
base2022 <- base2022 %>% rename(LUG_DIS_7 = P703_7)
base2022 <- base2022 %>% rename(LUG_DIS_8 = P703_8)
base2022 <- base2022 %>% rename(LUG_DIS_9 = P703_9)
base2022 <- base2022 %>% rename(LUG_DIS_10 = P703_10)

base2022 <- base2022 %>% rename(QUIEN_DIS_1 = P704_1)
base2022 <- base2022 %>% rename(QUIEN_DIS_2 = P704_2)
base2022 <- base2022 %>% rename(QUIEN_DIS_3 = P704_3)
base2022 <- base2022 %>% rename(QUIEN_DIS_4 = P704_4)
base2022 <- base2022 %>% rename(QUIEN_DIS_5 = P704_5)
base2022 <- base2022 %>% rename(QUIEN_DIS_6 = P704_6)
base2022 <- base2022 %>% rename(QUIEN_DIS_7 = P704_7)
base2022 <- base2022 %>% rename(QUIEN_DIS_8 = P704_8)
base2022 <- base2022 %>% rename(QUIEN_DIS_9 = P704_9)

base2022 <- base2022 %>% rename(ULT_NIVEL_ESTU = P501A)


```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}

base2022 <- select(base2022, -P501B,)
base2022 <- select(base2022, -P621,)
base2022 <- select(base2022, -P622_2,)
base2022 <- select(base2022, -P623_2,)
base2022 <- select(base2022, -INGRESO_T_DEP,)
base2022 <- select(base2022, -INGRESO_T_IND,)
base2022 <- select(base2022, -MIGRÓ_DE_V,)
base2022 <- select(base2022, -CODIGO,)

```

## Estructura y Limpieza de datos

La base de datos original consistía de 12 módulos con más de 30 preguntas cada uno. Con la intención de facilitar el manejo de los datos y ahorrar espacio, filtramos únicamente las variables a utilizar para los objetivos del proyecto en otras tablas más pequeñas con las variables que se precisan. Se crearon subbases con información sobre discriminación, características personales, educación, y empleo. Estas se presentan a continuación:

<div class="rounded-box">
  <div class="table-container">
### C_DISCR
```{r, echo=FALSE, message=FALSE}
knitr::kable(head(C_DISCR[1:8]))
```

### "C_EDAD
```{r, echo=FALSE, message=FALSE}
knitr::kable(head(C_EDAD))
```

### C_EDU
```{r, echo=FALSE, message=FALSE}
knitr::kable(head(C_EDU))
```

### C_EMPL
```{r, echo=FALSE, message=FALSE}
knitr::kable(head(C_EMPL[1:9]))
```
  </div>
</div>
\
Después de filtrar las variables a utilizar por cada tabla, se unieron todas las subtablas mediante la variable __código__. Esta variable nos permitió unir cada observación con sus correspondientes pares en las demás subtablas. La nueva super tabla creada fue llamada __"base2022"__.

Antes de realizar la limpieza de datos, fue necesario analizar la naturaleza de los datos faltantes (NAs). Así como existen datos vacíos por falta de información, también tenemos datos vacíos por cascada; es decir, existen preguntas que condicionan el acceso a otras. Un claro ejemplo de esto es la pregunta ¿Te sientes discriminado/a? En caso la respuesta sea negativa, entonces las preguntas sobre el individuo agresor y espacios de discriminación no serán respondidas.

## Restricciones

Además de los filtros por cascada, se añadieron restricciones extras para ciertos objetivos, como, por ejemplo:

<span class="custom-bullet">&#8226;</span>
Las personas menores a 18 años no son consideradas en el estudio

<span class="custom-bullet">&#8226;</span>
Debido a que el estudio está enfocado en la discriminación, las observaciones que no cuenten con una respuesta a la pregunta ¿Usted se siente discriminado? serán eliminadas de la base de datos.

<span class="custom-bullet">&#8226;</span>
En el caso de ganancias de trabajos dependientes e independientes, una observación es únicamente considerada como incompleta cuando ambos valores son NAs. Es posible que una persona tenga una o dos fuentes de ingreso, pero si no tiene ninguna, no puede ser considerado para la división por niveles económicos. Además, se eliminan las observaciones con 0 horas de trabajo que cuentan con ganancia.

Teniendo esto en cuenta, se realizó un filtrado de los NAs, eliminando casi a la mitad del total observaciones, debido a que no contenían la suficiente información para realizar el estudio. A continuación se muestra información sobre la super tabla "base2022" antes y después de la limpieza.


<div class="rounded-box">
  <div class="table-container">
### base2022, sin limpieza
```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
filas_base2022_sucia <- nrow(base2022_sucia)
filas_temp <- nrow(base2022_sucia)
```

La cantidad de observaciones iniciales en la base sucia es `r filas_base2022_sucia`.

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# Se limpia según edad
NA_edad_base2022_sucia <- sum(base2022_sucia$P205_A < 18 | is.na(base2022_sucia$P205_A), na.rm=FALSE)
NA_porcentaje_edad_base2022_sucia <- round((NA_edad_base2022_sucia/filas_temp)*100, 2)
base2022_sucia <- base2022_sucia %>% filter(P205_A >= 18 | is.na(P205_A))
filas_temp <- nrow(base2022_sucia)

# Se limpia segun disc
NA_disc_base2022_sucia <- sum(is.na(base2022_sucia$P701))
NA_porcentaje_disc_base2022_sucia <- round((NA_disc_base2022_sucia/filas_temp)*100, 2)
base2022_sucia <- base2022_sucia[!is.na(base2022_sucia$P701),]
filas_temp <- nrow(base2022_sucia)

# Se limpia segun ingresos
NA_ingresos_base2022_sucia <- sum(is.na(base2022_sucia$P622_1) & is.na(base2022_sucia$P623_1))
NA_porcentaje_ingresos_base2022_sucia <- round((NA_ingresos_base2022_sucia/filas_temp)*100, 2)
base2022_sucia <- base2022_sucia %>% filter_at(.vars = vars(P622_1,P623_1), .vars_predicate = any_vars(!is.na(.)))
filas_temp <- nrow(base2022_sucia)

# Limpia según horas de trabajo faltante
#NA_tiempoTrabajo_base2022_sucia <- sum(base2022_sucia$P615_T <= 0)
#NA_porcentaje_tiempoTrabajo_base2022_sucia <- round((NA_tiempoTrabajo_base2022_sucia/filas_temp)*100, 2)
#base2022_sucia <- base2022_sucia %>% filter(P615_T > 0)
#filas_temp <- nrow(base2022_sucia)

knitr::kable(head(base2022_sucia[1:3]))
```

__Restricción de edad:__
La cantidad de observaciones con personas menores a 18 años o edad NA es `r NA_edad_base2022_sucia`, lo cual corresponde al `r NA_porcentaje_edad_base2022_sucia`% del total de observaciones. Se procede a eliminar las filas que no cumplen con esta restricción.

__Restricción de discriminación:__
Una vez limpiada la base según la restricción anterior, la cantidad de observaciones con NAs en la variable discriminación es `r NA_disc_base2022_sucia`, lo cual corresponde al `r NA_porcentaje_disc_base2022_sucia`% del total de observaciones.

__Restricción de ingresos:__
Por último, después de haber limpiado según la restricción anterior, la cantidad de observaciones con NAs en ambos tipos de ingresos es `r NA_ingresos_base2022_sucia`, lo cual corresponde al `r NA_porcentaje_ingresos_base2022_sucia`% del total de observaciones.

### base2022, limpia
```{r, echo=FALSE, message=FALSE}
filas_base2022 <- nrow(base2022)
porcentaje_filas_limpiadas <- round(((filas_base2022_sucia - filas_temp)/filas_base2022_sucia) * 100, 2)
knitr::kable(head(base2022[1:3]))
```

La cantidad de observaciones en la base limpia es `r filas_base2022`, lo cual significa que se ha eliminado el `r porcentaje_filas_limpiadas`% de observaciones.

  </div>
</div>

# Base 2018
## Variables

<span class="custom-bullet">&#8226;</span>
Edad: La edad del encuestado

<span class="custom-bullet">&#8226;</span>
Género: El género de la persona

<span class="custom-bullet">&#8226;</span>
Nivel Estudios: Nivel de estudios que alcanzó el encuestado

<span class="custom-bullet">&#8226;</span>
Estado Económico: Nivel económico al que pertenece el encuestado de acuerdo a sus ingresos

<span class="custom-bullet">&#8226;</span>
Empleo: El estado de empleo actual de la persona

<span class="custom-bullet">&#8226;</span>
Discriminación: Representa si la persona se siente discriminada o no

<span class="custom-bullet">&#8226;</span>
Lugar: Lugar en el que la persona se siente discriminada

<span class="custom-bullet">&#8226;</span>
Horas Trabajo: Horas que la persona trabaja semanalmente

<span class="custom-bullet">&#8226;</span>
Ingreso Hora Independiente: Ingreso por hora en soles en trabajos independientes

<span class="custom-bullet">&#8226;</span>
Ingreso Hora Dependiente: Ingreso por hora en soles para trabajadores dependientes (en empresas)

*Ambas bases de datos comparten una sección significativa de variables, aunque la base 2018, la más antigua, no cuenta con datos sobre la población agresora.

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
C_EDAD <- read_sav("EDAD_CARACTERISTICAS_2018.sav", col_select = c("P204", "P205_A", "VIVIENDA", "CODPERSO") )
C_EDAD <- as_factor(C_EDAD)
#"ESTRATO_SOCIOECONOMICO"

C_DISCR <- read_sav("DISCRIMINACION_2018.sav", col_select = c("P701", "P702_1", "P702_2","P702_3","P702_4","P702_5","P702_6","P702_7","P702_8","P702_9","P702_10","VIVIENDA", "CODPERSO") )
C_DISCR <- as_factor(C_DISCR)

C_EMPL <- read_sav("EMPLEO_2018.sav", col_select = c("P601","P610_T","P613","P614_MON","P614_ESP","P615_MON","P615_ESP","VIVIENDA", "CODPERSO") )
C_EMPL <- as_factor(C_EMPL)

C_EDU <- read_sav("EDUCACION_2018.sav", col_select = c("P501","VIVIENDA", "CODPERSO") )
C_EDU <- as_factor(C_EDU)

C_EMPL$P610_T <- C_EMPL$P610_T*4
C_EMPL <- C_EMPL %>% mutate(GANANCIA_POR_HORA_TRABAJADOR_INDEPENDIENTE = round((P615_MON+P615_ESP)/(P610_T),3))
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}

C_EMPL$P613 <- case_when(
  C_EMPL$P613 == "Diario?" ~ 30,
  C_EMPL$P613 == "Semanal?" ~ 4,
  C_EMPL$P613 == "Quincenal?" ~ 2,
  C_EMPL$P613 == "Mensual?" ~ 1,
  TRUE ~ NA
)
  
C_EMPL <- C_EMPL %>% mutate(INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE = round(((P614_MON+P614_ESP)*P613)/(P610_T),3))
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
C_EMPL <- C_EMPL %>% unite(VIVIENDA,CODPERSO, col = CODIGO, sep = "_", remove = F) %>% print()
C_EDAD <- C_EDAD %>% unite(VIVIENDA,CODPERSO, col = CODIGO, sep = "_", remove = F) %>% print()
C_EDU <- C_EDU %>% unite(VIVIENDA,CODPERSO, col = CODIGO, sep = "_", remove = F) %>% print()

C_DISCR <- C_DISCR %>% unite(VIVIENDA,CODPERSO, col = CODIGO, sep = "_", remove = F) %>% print()
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# Eliminando repetidos VIVIENDA y CODPERSO

C_EMPL <- select(C_EMPL, -VIVIENDA, -CODPERSO)
C_EDAD <- select(C_EDAD, -VIVIENDA, -CODPERSO)
C_EDU <- select(C_EDU, -VIVIENDA, -CODPERSO)
C_DISCR <- select(C_DISCR, -VIVIENDA, -CODPERSO)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
# Merge
base2018 <- Reduce(function(...) merge(..., by.x = "CODIGO", by.y = "CODIGO", all = TRUE), list(C_EDU, C_EMPL, C_DISCR, C_EDAD))
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}

filas_base2018_sucia <- nrow(base2018)

base2018 <- base2018 %>% filter(P205_A >= 18 | is.na(P205_A))
#base2018 <- base2018 %>% filter_at(.vars = vars(P622_1,P623_1), .vars_predicate = any_vars(!is.na(.)))
base2018 <- base2018 %>% filter(P610_T > 0)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#creamos la suma de las columnas de ingresos para crear el nivel economico
for (i in 1:nrow(base2018)) {
  base2018$NIVEL_ECONO[i] <- sum(((base2018$P614_MON[i]+base2018$P614_ESP[i])*base2018$P613[i]), base2018$P615_MON[i]+base2018$P615_ESP[i], na.rm = T)
}
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#RENOMBRANDO

base2018 <- base2018 %>% rename(NIVEL_EDU = P501)
base2018 <- base2018 %>% rename(ESTADO_TRABAJO = P601)
base2018 <- base2018 %>% rename(HORAS_TOTALES_TRABAJ = P610_T)
base2018 <- base2018 %>% rename(SENTIRSE_DISC = P701)
base2018 <- base2018 %>% rename(SEXO = P204)
base2018 <- base2018 %>% rename(EDAD = P205_A)

base2018 <- base2018 %>% rename(LUG_DIS_1 = P702_1)
base2018 <- base2018 %>% rename(LUG_DIS_2 = P702_2)
base2018 <- base2018 %>% rename(LUG_DIS_3 = P702_3)
base2018 <- base2018 %>% rename(LUG_DIS_4 = P702_4)
base2018 <- base2018 %>% rename(LUG_DIS_5 = P702_5)
base2018 <- base2018 %>% rename(LUG_DIS_6 = P702_6)
base2018 <- base2018 %>% rename(LUG_DIS_7 = P702_7)
base2018 <- base2018 %>% rename(LUG_DIS_8 = P702_8)
base2018 <- base2018 %>% rename(LUG_DIS_9 = P702_9)
base2018 <- base2018 %>% rename(LUG_DIS_10 = P702_10)

```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
base2018 <- select(base2018, -P613,)
base2018 <- select(base2018, -P614_MON,)
base2018 <- select(base2018, -P614_ESP,)
base2018 <- select(base2018, -P615_MON,)
base2018 <- select(base2018, -P615_ESP,)
base2018 <- select(base2018, -CODIGO,)
```

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
#Creamos la escala economica 

#A(1) -> (3001, ...)  Alto 
#B(2) -> (1401, 3000) Medio Alto
#C(3) -> (1001, 1400) Medio
#D(4) -> (701, 1000)  Medio Bajo
#E(5) -> (0, 700)     Bajo

for (i in 1:nrow(base2018)){
  if (base2018$NIVEL_ECONO[i] <= 3000 ){
    if(base2018$NIVEL_ECONO[i] <= 1400){
      if(base2018$NIVEL_ECONO[i] <= 1000){
        if(base2018$NIVEL_ECONO[i] <= 700){
          base2018$NIVEL_ECONO[i] = 5
        }
        else{
          base2018$NIVEL_ECONO[i] = 4
        }
      }
      else{
        base2018$NIVEL_ECONO[i] = 3
      }
    }
    else{
      base2018$NIVEL_ECONO[i] = 2
    }
  }
  else {
    base2018$NIVEL_ECONO[i] = 1
  }
}


```

## Tipos de variables
<div class="rounded-box">
  <div class="table-container">
```{r, echo=FALSE}
nombresVariables <- c('Edad', 'Género', 'Nivel Estudio', 'Estado Económico', 'Empleo', 'Discriminación', 'Lugar', 'Horas Trabajo', 'Ingreso Hora Independiente', 'Ingreso Hora Dependiente')

tiposVariables <- c('Numérica discreta', 'Categórica nominal', 'Categórica ordinal', 'Categórica ordinal', 'Categórica nominal', 'Categórica nominal', 'Categórica nominal', 'Numérica discreta', 'Numérica continua', 'Numérica continua')

valoresVariables <- c('Número entero', 'Hombre o Mujer', 'Número entero 1-10 con un nombre asociado', 'Número entero 1-5 representando un intervalo de ingresos', 'Sí o No', 'Sí o No', 'Sí o No para cada columna que representa un lugar distinto', 'Número entero', 'Decimal', 'Decimal')

tablaVariables <- data.frame(Nombre = nombresVariables, Tipo = tiposVariables, Valores = valoresVariables)
knitr::kable(tablaVariables)
```
  </div>
</div>

```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE, include=FALSE}
filas_eliminadas_2018 <- filas_base2018_sucia - nrow(base2018)
filas_2018 <- nrow(base2018)
```

## Estructura y Limpieza de datos

El proceso realizado para la limpieza de datos fue el mismo que se utilizó para la limpieza de la base 2022. Se insertaron las observaciones en la super base, y se eliminaron observaciones que no tenían los datos suficientes para estudiar.

La base resultante fue llamada __base2018__. En este caso, el tamaño original de la base era de `r filas_base2018_sucia`, y se lograron eliminar `r filas_eliminadas_2018`, terminando con un total de `r filas_2018` filas.

<div class="rounded-box">
  <div class="table-container">
### base2018
```{r, echo=FALSE, message=FALSE}
knitr::kable(head(base2018[1:3]))
```
  </div>
</div>

# Análisis

## Objetivo 1

Durante las primeras etapas de investigación, el nivel económico fue el principal factor sobre el cual se estableció una conexión con el nivel de discriminación. Al ser el estado económico el principal motivo de la migración venezolana en masa, la hipótesis inicial fue que la ocurrencia de discriminación estaba estrechamente relacionada con el estado económico de la víctima.

Con la finalidad de verificar esta suposición, se creó un gráfico de barras que agrupa los casos de discriminación con los niveles económicos respectivos:

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
ggplot(base2022) +
aes(x = factor(NIVEL_ECONO), fill = SENTIRSE_DISC) +
geom_bar(position = "dodge") +
geom_text(
  aes(label = after_stat(count)),
  stat = "count",
  position = position_dodge(width = 0.9),
  vjust = -0.5,
  size = 3
) +
scale_fill_hue(direction = 1) +
labs(
  x = "Nivel económico",
  y = "Casos",
  title = "Discriminación por escala económica",
  subtitle = "Base 2022",
  fill = "Fue discriminado"
) +
scale_x_discrete(labels = c("Alto", "Medio-Alto", "Medio", "Medio-Bajo", "Bajo")) +
theme_gray() +
theme(legend.position = "right")

ggplot(base2018) +
aes(x = factor(NIVEL_ECONO), fill = SENTIRSE_DISC) +
geom_bar(position = "dodge") +
geom_text(
  aes(label = after_stat(count)),
  stat = "count",
  position = position_dodge(width = 0.9),
  vjust = -0.5,
  size = 3
) +
scale_fill_hue(direction = 1) +
labs(
  x = "Nivel económico",
  y = "Casos",
  title = "Discriminación por escala económica",
  subtitle = "Base 2018",
  fill = "Fue discriminado"
) +
scale_x_discrete(labels = c("Alto", "Medio-Alto", "Medio", "Medio-Bajo", "Bajo")) +
theme_gray() +
theme(legend.position = "right")
```
</div>
\

A primera vista, sería fácil concluir que los casos de discriminación incrementan al mismo tiempo que lo hace el nivel económico. Además, también es posible que no se evidencien las diferencias en el nivel económico más alto; sin embargo, esto ocurre debido a la **escasa cantidad de datos** que encajan en el primer nivel determinado.

Con la intención de facilitar la lectura y comprensión de la información provista por el gráfico, creamos un histograma con los porcentajes en cada nivel económico, y omitimos la escala alta debido a la posibilidad de una baja precisión por la cantidad de observaciones.

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2022 %>% 
  filter(NIVEL_ECONO != 1)
ggplot(temp) +
aes(x = factor(NIVEL_ECONO), fill = SENTIRSE_DISC) +
scale_y_continuous(labels = scales::percent) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
labs(
  x = "Nivel económico",
  y = "Porcentaje de casos",
  title = "Porcentaje de discriminación por escala económica",
  subtitle = "Base 2022",
  fill = "Fue discriminado"
  ) +
scale_x_discrete(labels = c("Medio-Alto", "Medio", "Medio-Bajo", "Bajo")) +
theme_gray() +
theme(legend.position = "right")
rm(temp)

temp <- base2018 %>% 
  filter(NIVEL_ECONO != 1)
ggplot(temp) +
aes(x = factor(NIVEL_ECONO), fill = SENTIRSE_DISC) +
geom_bar(position = "fill") +
scale_y_continuous(labels = scales::percent) +
scale_fill_hue(direction = 1) +
labs(
  x = "Nivel económico",
  y = "Porcentaje de casos",
  title = "Porcentaje de discriminación por escala económica",
  subtitle = "Base 2018",
  fill = "Fue discriminado"
  ) +
scale_x_discrete(labels = c("Medio-Alto", "Medio", "Medio-Bajo", "Bajo")) +
theme_gray() +
theme(legend.position = "right")
rm(temp)
```
</div>
\

En el año 2018, el nivel de discriminación estaba repartido entre los diversos niveles económicas. El nivel medio-alto fue el más discriminado, aunque no había tanta diferencia comparado a los demás rubros.

Por otro lado, en el año 2022, se puede apreciar una tendencia discriminatoria hacia el nivel económico más bajo, mientras que el índice de discriminación disminuyó para los niveles más altos.

Podríamos decir que existe una correlación negativa entre el nivel de discriminación y el nivel económico: a mayor nivel, menor tasa de discriminación.

Este fenómeno podría relacionarse a la frecuencia con la que se discrimina debido a las apariencias. Durante los inicios de la migración venezolana, existía un rechazo hacia la población migratoria en general, por lo que los niveles erán más parejos. A medida que pasaron los años, la cultura venezolana se fue integrando a la sociedad peruana, por lo que la discriminación dirigida se estabilizó hacia los niveles económicos más bajos, mezclándose así con la población peruana de bajos ingresos.

## Objetivo 2

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2022 %>% filter(SENTIRSE_DISC == "1.Sí")
ggplot(temp) +
  aes(x = temp$EDAD, y = temp$SENTIRSE_DISC, fill = temp$SEXO) +
  geom_boxplot() +
  scale_fill_hue(direction = 1) +
  labs(
  x = "Edad",
  y = "Fue discriminado",
  title = "Casos de discriminación por edad y sexo",
  subtitle = "Base 2022",
  fill = "Sexo"
  ) +
  theme_gray() +
  coord_cartesian(xlim = c(min(base2022$EDAD), max(base2022$EDAD))) +
  theme(
    axis.title.y = element_blank(),
    axis.text.y = element_blank()
  )
  rm(temp)
  
temp <- base2018 %>% filter(SENTIRSE_DISC == "Si")
ggplot(temp) +
  aes(x = temp$EDAD, y = temp$SENTIRSE_DISC, fill = temp$SEXO) +
  geom_boxplot() +
  scale_fill_hue(direction = 1) +
  labs(
  x = "Edad",
  y = "Fue discriminado",
  title = "Casos de discriminación por edad y sexo",
  subtitle = "Base 2018",
  fill = "Sexo"
  ) +
  theme_gray() +
  coord_cartesian(xlim = c(min(base2018$EDAD), max(base2018$EDAD))) +
  theme(
    axis.title.y = element_blank(),
    axis.text.y = element_blank()
  )
  rm(temp)
```
</div>
\

Al clasificar los casos de discriminación y relacionarlos con el sexo y la edad, es posible observar las diferencias en influencia que el sexo tuvo sobre la frecuencia de discriminación.

En el 2018, la discriminación era generalizada hacia la mayor parte de la población venezolana, principalemente debido a su nacionalidad. La media de edad de la población discriminada es de 29 años, lo cual tiene sentido, ya que la mayor parte de inmigrantes tenían el objetivo de obtener un empleo estable para poder satisfacer sus necesidades económicas, y la población laboral oscila dentro del rango intercuartil, en este caso con límites establecidos de 23 a 35 años. Existen valores atípicos, los cuales representan una minoría de personas de 50 años o más.

Por otro lado, el rango de edades perteneciente a la población que labora incrementó ligeramente en el año 2022, llegando hasta los 39 años. Además, la incidencia de casos de discriminación se concentró en la población femenina, lo cual representa (de cierta manera) la inclusión de la cultura venezolana a la peruana, resultando lametablemente en la reincidencia de la cultura machista existente.

Con esta interpretación, podemos concluir que la discriminación está dirigida hacia personas pertenecientes al rango de edad laboral joven, y que el sexo no jugaba un rol importante al inicio de la etapa migratoria. Conforme incrementó la tolerancia hacia la cultura venezolana, se introdujeron factores pertenecientes a la cultura peruana, lo cual incrementó los casos de discriminación hacia el sexo femenino.

## Objetivo 3

<div class="rounded-box">
```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2022 %>%
  select(SENTIRSE_DISC, LUG_DIS_1:LUG_DIS_10) %>%
  filter(SENTIRSE_DISC == "1.Sí") %>%
  pivot_longer(cols = LUG_DIS_1:LUG_DIS_10, names_to = "LUG_DIS_number", values_to = "LUG_DIS_value") %>%
  filter(LUG_DIS_value != "0")

ggplot(temp, aes(x = factor(LUG_DIS_number), fill = LUG_DIS_value)) +
  geom_bar(aes(y = (after_stat(count))/sum(after_stat(count)))) +
  scale_fill_manual(values = c("#9e0142", "#d53e4f", "#f46d43", "#fdae61", "#fee08b", "#e6f598", "#abdda4" , "#66c2a5", "#3288bd", "#5e4fa2"), labels = c("1. Trabajo", "2. I.Educativa", "3. E.Salud", "4. I.Justicia", "5. Calle", "6. T.Público", "7. Migración", "8. Cancillería", "9. Barrio", "10. Otro")) +
  scale_y_continuous(labels = scales::percent) +
  scale_x_discrete(labels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10")) +
  labs(x = "Ambiente",
       y = "Porcentaje",
       title = "Porcentajes de discriminación por ambiente",
       fill = "Lugar") +
  theme_gray() +
  theme(legend.position = "right")
rm(temp)
```
</div>
\

<div class="rounded-box">
```{r, echo = FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2022 %>%
  select(SENTIRSE_DISC, MOT_DISC_1:MOT_DISC_7) %>%
  filter(SENTIRSE_DISC == "1.Sí") %>%
  pivot_longer(cols = MOT_DISC_1:MOT_DISC_7, names_to = "MOT_DISC_number", values_to = "MOT_DISC_value") %>%
  filter(MOT_DISC_value != "0")

ggplot(temp, aes(x = MOT_DISC_number, fill = MOT_DISC_value)) +
geom_bar(aes(y = (stat(count))/sum(stat(count))), width = 1) +
scale_y_continuous(labels = scales::percent) +
scale_x_discrete(labels = c("1", "2", "3", "4", "5", "6", "7")) +
labs(
  x = "Motivo de la discriminación",
  y = "Porcentaje",
  title = "Porcentaje de personas que se sintieron discriminadas por cada motivo",
  fill = "Motivo"
)
rm(temp)
```
</div>
\

Al analizar el primer gráfico, es posible notar que la mayor cantidad de casos de discriminación ocurren en la calle, trabajo, y transporte público, siendo la calle el ambiente con más incidencia. Seguidos de estos ambientes, se encuentran los ambientes socioeconómicos, como son las instituciones públicas.

Si bien podría ser predecible que la mayor cantidad de casos se dieran en las calles del Perú, es alarmante la cantidad de casos combinados en instituciones públicas y el transporte público a la vez. Debería esperarse imparcialidad en cualquier tipo de atención a clientes, sin importar su procedencia. Este suceso deja notar el impacto que tienen los prejuicios y la connotación negativa que suele dirigirse hacia migrantes venezolanos.

Relacionando lo anterior con el segundo gráfico, es posible observar que la principal razón de discriminación son factores relacionados con la nacionalidad, aspecto, o condición migratoria. Existe un cierto rechazo hacia la población migrante venezolana, sobre todo en los años cercanos al inicio de la migración en masa. Estos datos hacen resaltar la opinión pública sobre esta población, por más que se trate de una minoría relativa que lleva a cabo actos excluyentes en contra de la población estudiada.

## Objetivo 4
<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2022
temp$NIVEL_EDU_AGRUPADO <- temp$NIVEL_EDU
temp$NIVEL_EDU_AGRUPADO[temp$NIVEL_EDU %in% c(0, 1, 2, 11, 12)] <- "Otros"

nueva_leyenda <- c("3", "4", "5", "6", "7", "8", "9","10" ,"Otros")
temp$NIVEL_EDU_AGRUPADO <- factor(temp$NIVEL_EDU_AGRUPADO, levels = nueva_leyenda)

mosaico <- table(temp$NIVEL_EDU_AGRUPADO, temp$SENTIRSE_DISC)

mosaicplot(mosaico, main = "Discriminación por nivel de estudio, 2022",
           xlab = "Nivel de estudio", ylab = "Fue discriminado",
           col = c("#ea9b25", "#43c6a8"))
rm(temp)
rm(mosaico)
```
</div>
\
<span class="custom-bullet">&#8226;</span>
3. Básica Incompleta

<span class="custom-bullet">&#8226;</span>
4. Básica Completa

<span class="custom-bullet">&#8226;</span>
5. Media Diversificada Incompleta

<span class="custom-bullet">&#8226;</span>
6. Media Diversificada Completa

<span class="custom-bullet">&#8226;</span>
7. Técnico Superior Incompleto

<span class="custom-bullet">&#8226;</span>
8. Técnico Superior Completo

<span class="custom-bullet">&#8226;</span>
9. Universitaria Incompleta

<span class="custom-bullet">&#8226;</span>
10. Universitaria Completa


Al clasificar los casos de discriminación respecto a los niveles de estudios es favorable observar las variaciones que se presentan entre los niveles de estudio, los cuales indican las distintas tentativas de sentirse discriminado respecto al nivel educativo que se alcanza. Es claro notar que se alcanza una mayor tendencia a sentirse discriminado cuando no se cuenta con un nivel de educación superior, que en su mayoría recae cuando solo se termina la secundaria.

## Objetivo 5

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
# Cargar los datos
# menores a 10 y mayores a 10 soles 
# univariado 
# objetivo 5

temp <- base2022
# Ingreso por hora de acuerdo a nivel economico
temp$GANANCIA_INGRESO <- ifelse(temp$ESTADO_TRABAJO == "1.Sí", temp$INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE, temp$GANANCIA_POR_HORA_TRABAJADOR_INDEPENDIENTE)

# Filtrado
menor10 <- temp %>% filter(GANANCIA_INGRESO < 10 & SENTIRSE_DISC == "1.Sí")
mayor10 <- temp %>% filter(GANANCIA_INGRESO >= 10 & SENTIRSE_DISC == "1.Sí")
media_menor <- median(menor10$GANANCIA_INGRESO)
media_mayor <- median(mayor10$GANANCIA_INGRESO)

# Grafico de menor a 10
boxplot(menor10$GANANCIA_INGRESO, main = "Discriminacion e ingreso/hora < 10, 2022", xlab = "Casos de discriminación", ylab = "Ganancia o ingreso por hora", col = "lightSalmon")

# Linea de la media
abline(h = media_menor, col = "black", lwd = 2)
rm(menor10)


boxplot(mayor10$GANANCIA_INGRESO , main = "Discriminacion e ingreso/hora >= 10, 2022", xlab = "Casos de discriminación", ylab = "Ganancia o ingreso por hora", col="lightSalmon")

abline(h = media_mayor, col = "black", lwd = 2)
rm(mayor10)

rm(temp)
```
</div>
\

Al observar los casos de discriminación hacia personas con un ingreso menor a los 10 soles por hora en el año 2022, es posible notar que la media se sitúa en los 5 soles. Podría concluirse que hay menor ocurrencia de discriminación en valores menores y mayores a este, mas esto ocurre debido a que la mayoría de personas tienen una ganancia horaria de 4 a 6 soles. Al pertenecer al mismo nivel económico, la media no es muy descriptiva, ya que una ganancia promedio de 5 a 6 soles es de esperarse.

Al analizar el gráfico de casos de discriminación hacia las personas que ganan más de 10 soles, se observan patrones diferentes. La discriminación se concentra en los valores más bajos, lo cual coincide con el gráfico de discriminación por niveles económicos anteriormente mostrado. Es posible observar el mismo comportamiento, en el que la frecuencia de discriminación disminuye a medida que incrementa el nivel adquisitivo. Existen datos atípicos, los cuales representan una parte de la población examinada que logra salir de los valores esperados en cuanto a ganancia. Sin embargo, la mayoría de la población tiene una ganancia de 12 a 32 soles por hora.

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
temp <- base2018
# Ingreso por hora de acuerdo a nivel economico
temp$GANANCIA_INGRESO <- ifelse(temp$ESTADO_TRABAJO == "Si", temp$INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE, temp$GANANCIA_POR_HORA_TRABAJADOR_INDEPENDIENTE)

# Filtrado
menor10 <- temp %>% filter(GANANCIA_INGRESO < 10 & SENTIRSE_DISC == "Si")
mayor10 <- temp %>% filter(GANANCIA_INGRESO >= 10 & SENTIRSE_DISC == "Si")

media_menor <- median(menor10$GANANCIA_INGRESO)
media_mayor <- median(mayor10$GANANCIA_INGRESO)

# Grafico de menor a 10
boxplot(menor10$GANANCIA_INGRESO, main = "Discriminacion e ingreso/hora < 10, 2018", xlab = "Casos de discriminación", ylab = "Ganancia o ingreso por hora", col = "lightSalmon")

# Linea de la media
abline(h = media_menor, col = "black", lwd = 2)
rm(menor10)


boxplot(mayor10$GANANCIA_INGRESO , main = "Discriminacion e ingreso/hora >= 10, 2018", xlab = "Casos de discriminación", ylab = "Ganancia o ingreso por hora", col="lightSalmon")

abline(h = media_mayor, col = "black", lwd = 2)
rm(mayor10)

rm(temp)
```
</div>
\
En el caso del año 2018, el patrón observado es similar al del 2022. Las diferencias apreciables se encuentran en el ingreso por hora, donde la gran mayoría de personas con un ingreso menor a 10 soles ganan 1 sol menos.

Respecto a aquellas personas con ingresos mayores a 10 soles por hora, se puede observar que la discriminación se concentra en un valor similar al del año 2022. Al igual que las personas con ingresos menores a 10 soles, su ingreso promedio disminuye, llegando a ubicarse desde los 11 a 28 soles. Lo mismo ocurre con los datos atípicos, los cuales se concentran más en valores alrededor de los 100 soles.

Este análisis gráfico complementa al de niveles económicos mostrado anteriormente; es posible observar más a detalle los valores a los cuales pertenecen cada sector, al mismo tiempo que se observa más a detalle la situación económica de cada individuo. En este caso, podemos concluir que la ganancia media para la población venezolana **discriminada** incrementó desde el 2018. Además, se reitera que el nivel económico juega un papel importante en los casos de discriminación hacia la población venezolana, y la población peruana en general.

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
#eliminar la 12 
#nivel de estudio con horas de trabajo 
# Cargar los datos
# obejtivo 5
temp <- base2022
# Agrupamos los de menor magnitud en categoria otros
temp$NIVEL_EDU_Merged <- temp$NIVEL_EDU
temp$NIVEL_EDU_Merged[temp$NIVEL_EDU %in% c(0, 1, 2, 11, 12)] <- "Otros"

# reordenamos las variables
temp$NIVEL_EDU_Merged <- factor(temp$NIVEL_EDU_Merged, levels = c("3", "4", "5", "6", "7", "8", "9","10" ,"Otros"))

# Creamos los boxplots de horas de trabajo en funcion al nivel de estudio
boxplot(temp$HORAS_TOTALES_TRABAJ ~ temp$NIVEL_EDU_Merged, 
        main = "Distribución de las horas totales trabajadas según el nivel de estudio",
        xlab = "Nivel de estudio", ylab = "Horas totales trabajadas")
rm(temp)
```
</div>
\

Este gráfico de cajas anidado provee información sobre la cantidad de horas de trabajo mensuales para cada nivel educativo.

A gran escala, es posible observar que la cantidad de horas trabajadas semanales es aproximadamente la misma en todos los niveles educativos. Al ser el valor medio 200 horas mensuales, se aproxima a 7 horas semanales.

Sorpredentemente, el nivel educativo no tiene un impacto grande si se habla del valor medio de la mayoría de niveles educativos; sin embargo, a medida que incrementa el nivel de educación, se presenta una mayor concentración de casos atípicos con menos horas de trabajo. Esto se debe a que a medida que incrementa el nivel educativo, se presenta una mayor cantidad de oportunidades con ingresos mejores, lo cual conlleva una disminución de la cantidad de horas necesarias, sobre todo en el caso de trabajadores independientes exitosos, como empresarios o dueños de negocios.

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
# Objetivo 5
# Eliminar las filas que tienen más de 1000 de ingreso por hora
temp <- base2022
temp <- subset(temp, INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE < 100)

# Generar el gráfico de regresión lineal con ggplot2
ggplot(temp, aes(x = EDAD, y = INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Ingreso horario dependiente por edades", x = "Edad", y = "Ingreso por hora")
rm(temp)
```
</div>
\

Al analizar la relación entre el ingreso por hora de trabajadores dependientes y sus edades, se puede notar una tendencia a negativa respecto al ingreso. A primera vista, es posible decir que el ingreso medio disminuye a medida que la edad incrementa. Esto podría deberse a diversos factores, como la reposición de personal en empresas, mayores oportunidades a edades tempranas, o el nivel educativo de cada persona.

A pesar de que existe una correlación evidente, es necesario analizar las horas de trabajo y su relación con los ingresos obtenidos para poder obtener una conclusión concisa.

<div class="rounded-box">
```{r, echo=FALSE, message = FALSE, warning = FALSE, error = FALSE}
# objetivo 5
# Generar el gráfico de regresión lineal con ggplot2
ggplot(base2022, aes(x = HORAS_TOTALES_TRABAJ, y = INGRESO_POR_HORA_TRABAJADOR_DEPENDIENTE)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Horas totales por ingreso dependiente", x = "Horas totales de trabajo por mes", y = "Ingreso por hora")
```
</div>
\
Si se observa la relación entre las horas de trabajo y el ingreso horario (en soles), podría pensarse que existen contradicciones. Idealmente, se esperaría que los ingresos aumentaran a mayor cantidad de horas trabajadas; sin embargo, se puede observar lo contrario.

Este fenómeno puede ocurrir por diversos motivos, como por ejemplo el hecho de que los trabajos con mayores ganancias suelen requerir un menor tiempo de dedicación, o porque existen trabajos con un tiempo relativamente similar que ofrecen un pago distinto dependiendo del área laboral.

Al analizar el gráfico de manera más logica, en conjunto con el gráfico anterior, es posible concluir que una mayor cantidad de horas de trabajo no necesariamente conlleva a mayores ingresos; es más, existe cierta tendencia negativa; el ingreso tiende a disminuir a mayor cantidad de horas trabajadas.

Sin embargo, existen casos excepcionales (representados por los datos atípicos), en los que ciertas personas logran obtener una ganancia mayor con horas de trabajo menor a la media. También existen otros casos con valores más cercanos a la mayoría; es probable que se deban a sobretiempo en ciertos empleos, o a ciertos trabajos que cuentan con una mejor remuneración.

Tomando todo lo anterior en cuenta, se puede concluir que, en la gran mayoría de casos, una mayor cantidad de horas de trabajo conlleva a menores ingresos. Los casos en los que ocurre lo contrario son excepcionales, los cuales son representados por trabajos con alta paga y menor demanda de tiempo. Volviendo a la mayoría de la población, los valores cercados al eje vertical representan ingresos bajos, con tendencia a trabajar una mayor cantidad de horas para compensar. Conectando estos casos a la realidad, podríamos observar estos casos en trabajadores que son explotados a nivel macroeconómico debido a una mayor tolerancia por sueldos bajos debido a la condición económica en la que se encuentran. También se podría hablar de los vendedores ambulantes, los cuales se ven forzados a trabajar una mayor cantidad de horas (no necesariamente con un mayor ingreso) para poder satisfacer sus necesidades económicas.