---
title: "Cáncer de mama"
output: 
  html_document:
      toc: true
      toc_depth: 6
      theme: readable
---

```{r eval=TRUE, echo= FALSE}
list.of.packages <- c("ggplot2", "moments", "dplyr", "readr")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
```

# Análisis de las características de las pacientes con cáncer de mama en Estados Unidos entre los años 2017 y 2022

## I. Introducción

### 1. Relevancia

El estudio del cáncer de mama es de suma importancia debido a su alta
incidencia en las mujeres. Según la Organización Mundial de la Salud,
cada año se pronostican más de dos millones de casos nuevos en todo el
mundo. Esta enfermedad es una de las principales causas de muerte por
cáncer en las mujeres. Nuestra investigación busca describir el
comportamiento de distintos factores que determinar el estado final de
una paciente.

### 2. Objetivos

#### 2.1 Objetivo general

Analizar las características de las pacientes con cáncer de mama en
Estados Unidos entre los años 2017 y 2022 con el fin de describir el
comportamiento de las variables.

#### 2.2 Objetivos específicos

-   Explorar las distribuciones de las proteínas de las pacientes
-   Establecer si existe alguna relación entre el tipo de cirugía
    realizada con las etapas del tumor
-   Determinar cómo influye el estado de la proteína HER2 en el estado
    de la paciente
-   Hallar la proporción de pacientes vivas y fallecidas por etapa del
    tumor

### 3. Conceptos relevantes

-   Nivel de expresión de una proteína: Se definen cuatro proteínas. Los
    valores asignados a cada una de estas variables se refieren al nivel
    de expresión del gen de cada una de ellas, por lo que pueden tomar
    valores positivos y negativos. El término nivel de expresión
    negativo en el contexto de una proteína generalmente indica que no
    se está produciendo o se encuentra en cantidades muy bajas en una
    muestra o célula específica. Cuando se dice que el nivel de
    expresión de una proteína es positivo, significa que la proteína
    está siendo producida y presente en cantidades detectables en una
    muestra o célula específica.

-   El estado positivo de HER2 significa que las células cancerígenas de
    la paciente tienen niveles más altos de HRE2 de lo normal, lo que
    implica que el cáncer tiende a crecer y propagarse más rápido que
    otros tipos de cáncer de seno, pero responden al tratamiento con
    medicamentos que tienen como blanco a la proteína HER2.

-   Con histología nos referimos al tipo histológico de cáncer de mama
    que presenta la paciente. Esta clasificación se determina acorde al
    tipo específico de células afectadas en cada caso.

-   Se encuentran 4 tipos: `Lumpectomía`, `Mastectomía Simple` y
    `Mastectomía Radical Modificada` y `Otra`. En el primer tipo de
    cirugía, se extirpa el ćancer u otro tejido mamario anormal. En
    "Mastectomía Simple", se extirpa todo el seno (pezón, areola y
    piel). Para el tercer tipo, se extirpa también todo el seno y se
    realiza una extirpación de los ganglios linfáticos auxiliares. El
    cuarto se refiere a alguna operación diferente de las tres
    mencionadas anteriormente.

-   Etapas del tumor: Existen tres etapas del tumor en la base de datos.
    La etapa 1 (`I`) indica que el cáncer ocupa un área relativamente
    pequeña y no se ha propagado a los ganglios linfáticos o que hay una
    propagación ligera. La etapa 2 (`II`) sugiere que ocupa un área
    mayor y que se ha propagado a algunos ganglios adyacentes. En la
    etapa 3 (`III`) se tiene un tumor grande o que invade los tejidos
    cercanos o que se ha propagado a muchos ganglios linfáticos
    adyacentes.

-   Estado del paciente: El estado del paciente indica si es que en el
    periodo en que se tomaron los datos, el paciente falleció o no
    durante el periodo de tiempo de 2017 a 2022.

-   Las proteínas quinasas que interactúan con el receptor (RIP) son un
    grupo de proteínas quinasas de treonina/serina con un dominio
    quinasa relativamente conservado pero regiones no quinasas
    distintas. Los miembros de la familia de quinasas de proteínas que
    interactúan con el receptor (RIP) han surgido como sensores
    esenciales de estrés intracelular y extracelular. Se ha demostrado
    que desempeñan un papel importante no solo en la inflamación y otras
    respuestas inmunitarias, sino también en los procesos que inducen la
    muerte.

## II. Datos

### Proceso de recolección de datos

Se obtuvieron los datos a partir de una fuente secundaria. Es un dataset
que cuenta con 334 observaciones. El enlace es el siguiente:
<https://www.kaggle.com/datasets/kreeshrajani/breast-cancer-survival-dataset>

### Población, muestra y muestreo

Los datos provienen de [Bio
GPS](http://biogps.org/dataset/tag/brca1/){.uri} Esta página recopila
datos de genes regularmente de fuentes de datos comunes (principalmente
[NCBI](https://www.ncbi.nlm.nih.gov/) y
[Ensembl](https://www.ensembl.org/index.html)).

### Variables de estudio

De las 15 variables de la base de datos, consideramos solo 10 de ellas,
las cuales son las siguientes:

+----------------+----------------+----------------+----------------+
| Variable       | Tipo           | Descripción    | Especi         |
|                |                |                | ficaciones/R   |
|                |                |                | estricciones   |
+================+================+================+================+
| `Edad`         | Numérica       | Edad de la     | No puede tomar |
|                | discreta       | paciente. Toma | valores        |
|                |                | valores desde  | negativos.     |
|                |                | 29 a 90.       |                |
+----------------+----------------+----------------+----------------+
| `Proteína1`    | Numérica       | Serina /tr     | Toma valores   |
|                | continua       | e              | de -2.1446 a   |
|                |                | onina-proteína | 1.5936         |
|                |                | quinasa 1 que  |                |
|                |                | interactúa con |                |
|                |                | el receptor    |                |
|                |                | (RIP1)         |                |
+----------------+----------------+----------------+----------------+
| `Proteína2`    | Numérica       | Serina /tr     | Toma valores   |
|                | continua       | e              | de -0.97873 a  |
|                |                | onina-proteína | 3.4022         |
|                |                | quinasa 2 que  |                |
|                |                | interactúa con |                |
|                |                | el receptor    |                |
|                |                | (RIP2):        |                |
+----------------+----------------+----------------+----------------+
| `Proteína3`    | Numérica       | Serina /tr     | Toma valores   |
|                | continua       | e              | de -1.6274 a   |
|                |                | onina-proteína | 2.1934         |
|                |                | quinasa 3 que  |                |
|                |                | interactúa con |                |
|                |                | el receptor    |                |
|                |                | (RIP3)         |                |
+----------------+----------------+----------------+----------------+
| `Proteína4`    | Numérica       | Serina /tr     | Toma valores   |
|                | continua       | e              | de -2.0255 a   |
|                |                | onina-proteína | 1.6299         |
|                |                | quinasa 4 que  |                |
|                |                | interactúa con |                |
|                |                | el receptor    |                |
|                |                | (RIP4)         |                |
+----------------+----------------+----------------+----------------+
| `Eta           | Categórica     | Etapa del      | Toma los       |
| p a_del_Tumor` | ordinal        | cáncer de mama | valores I, II  |
|                |                | de la          | y III          |
|                |                | paciente.      |                |
|                |                |                |                |
|                |                | -   `I` :      |                |
|                |                |     Etapa 1    |                |
|                |                |                |                |
|                |                | -   `II` :     |                |
|                |                |     Etapa 2    |                |
|                |                |                |                |
|                |                | -   `III` :    |                |
|                |                |     Etapa 3    |                |
+----------------+----------------+----------------+----------------+
| `Histología`   | Categórica     | Tipo           | Puede tomar    |
|                | nominal        | histológico    | solo las tres  |
|                |                | del cáncer de  | categorías     |
|                |                | mama. Existen  | descritas      |
|                |                | tres tipos:    |                |
|                |                |                |                |
|                |                | -   Carcicnoma |                |
|                |                |     Ductal     |                |
|                |                |                |                |
|                |                |    Infiltrante |                |
|                |                |                |                |
|                |                | -   Carcina    |                |
|                |                |     Lobular    |                |
|                |                |                |                |
|                |                |    Infiltrante |                |
|                |                |                |                |
|                |                | -   Carcinoma  |                |
|                |                |     Mucinoso   |                |
+----------------+----------------+----------------+----------------+
| `Estado_HER2`  | Categórica     | Indica si      | Existen dos    |
|                | nominal        | tiene un       | estados:       |
|                |                | cáncer de mama | Positivo y     |
|                |                | HER2-activo    | Negativo       |
+----------------+----------------+----------------+----------------+
| `Tip           | Categórica     | Tipo de        | Puede tomar    |
| o _de_Cirugía` | nominal        | cirugía que se | solo las       |
|                |                | realizó a la   | categorías     |
|                |                | paciente       | descritas      |
|                |                |                |                |
|                |                | -              |                |
|                |                |    Lumpectomía |                |
|                |                |                |                |
|                |                | <!-- -->       |                |
|                |                |                |                |
|                |                | -              |                |
|                |                |    Mastectomía |                |
|                |                |     Simple     |                |
|                |                |                |                |
|                |                | -              |                |
|                |                |    Mastectomía |                |
|                |                |     Radical    |                |
|                |                |     Modificada |                |
|                |                |                |                |
|                |                | -   Otra       |                |
+----------------+----------------+----------------+----------------+
| `Estado_       | Categórica     | Estado del     | Existen dos    |
| d el_Paciente` | nominal        | paciente       | estados: Vivo  |
|                |                |                | y F allecido   |
+----------------+----------------+----------------+----------------+

### Base de datos

Cargamos las librerías para leer los datos

```{r}
library("readr")
library("dplyr")
```

Cargamos la base de datos

```{r}
CANCER <- read_csv("breast_cancer_survival.csv")
spec(CANCER)
```

```{r}
head(CANCER)
```

### Limpieza de datos

La base de datos se encuentra en inglés, por lo que, para un mayor
entendimiento, traducimos las variables a español.

```{r}
colnames(CANCER)[1] <- "Edad"
colnames(CANCER)[2] <- "Sexo"
colnames(CANCER)[3] <- "Proteína1"
colnames(CANCER)[4] <- "Proteína2"
colnames(CANCER)[5] <- "Proteína3"
colnames(CANCER)[6] <- "Proteína4"
colnames(CANCER)[7] <- "Etapa_del_Tumor"
colnames(CANCER)[8] <- "Histología"
colnames(CANCER)[9] <- "Estado_ER"
colnames(CANCER)[10] <- "Estado_PR"
colnames(CANCER)[11] <- "Estado_HER2"
colnames(CANCER)[12] <- "Tipo_de_Cirugía"
colnames(CANCER)[13] <- "Día_de_Cirugía"
colnames(CANCER)[14] <- "Última_Visita"
colnames(CANCER)[15] <- "Estado_del_Paciente"
CANCER
```

Ahora traducimos los valores de las variables categóricas

```{r}
CANCER$Histología[CANCER$Histología == "Infiltrating Ductal Carcinoma"] <- "Carcinoma Ductal Infiltrante"
CANCER$Histología[CANCER$Histología == "Infiltrating Lobular Carcinoma"] <- "Carcinoma Lobular Infiltrante"
CANCER$Histología[CANCER$Histología == "Mucinous Carcinoma" ] <- "Carcinoma Mucinoso"

CANCER$Sexo[CANCER$Sexo == "FEMALE"] <- "Femenino"
CANCER$Sexo[CANCER$Sexo == "MALE"] <- "Masculino"

CANCER$Estado_HER2[CANCER$Estado_HER2 == "Positive"] <- "Positivo"
CANCER$Estado_HER2[CANCER$Estado_HER2 == "Negative"] <- "Negativo"

CANCER$Estado_del_Paciente[CANCER$Estado_del_Paciente == "Alive"] <- "Vivo"
CANCER$Estado_del_Paciente[CANCER$Estado_del_Paciente == "Dead"] <- "Fallecido"

CANCER$Tipo_de_Cirugía[CANCER$Tipo_de_Cirugía == "Other"] <- "Otra"
CANCER$Tipo_de_Cirugía[CANCER$Tipo_de_Cirugía == "Lumpectomy"] <- "Lumpectomía"
CANCER$Tipo_de_Cirugía[CANCER$Tipo_de_Cirugía == "Simple Mastectomy"] <- "Mastectomía Simple"
CANCER$Tipo_de_Cirugía[CANCER$Tipo_de_Cirugía == "Modified Radical Mastectomy"] <- "Mastectomía Radical Modificada"

CANCER
```

Identificamos la cantidad de observaciones por `Sexo`

```{r}
# Pacientes de sexo femenino
nrow(subset(CANCER, Sexo=='Femenino'))
# Pacientes de sexo masculino
nrow(subset(CANCER, Sexo=='Masculino'))
```

Como nuestra investigación se basa en paciente de sexo femenino,
seleccionamos solo las observaciones en las que la variable `Sexo` es `Femenino`

```{r}
CANCER <- subset(CANCER, Sexo=='Femenino')
CANCER
```

Ahora que solo contamos con paciente de sexo femenino, notamos que la
variable `Sexo` no es necesaria, ya que de por sí todos los pacientes
son del mismo sexo.

```{r}
CANCER <- CANCER[,!names(CANCER) %in% c("Sexo")]
CANCER
```

Existen dos variables que tienen solo un dato único, por lo que
procedemos a borrarlas, ya que para todos los pacientes se cumple el
mismo parámetro.

```{r}
CANCER <- CANCER[,!names(CANCER) %in% c("Estado_ER", "Estado_PR")]
CANCER
```

```{r}
length(unique(CANCER$Día_de_Cirugía))
length(unique(CANCER$Última_Visita))
```

`Última_Visita` y `Día_de_Cirugía` no serán usadas en el análisis, por
lo que no es necesario mantenerlas en `CANCER`

```{r}
CANCER <- CANCER[,!names(CANCER) %in% c("Última_Visita", "Día_de_Cirugía")]
CANCER
```

Vemos la cantidad de NAs en la base de datos

```{r}
NAs<-sum(is.na(CANCER))
NAs
```

Calculamos la cantidad de casos completos de la base de datos

```{r}
casos_incompletos <- sum(!complete.cases(CANCER))
casos_incompletos
```

Calculamos el porcentaje que representan los datos faltantes en la base
de datos

```{r}
round((NAs/(nrow(CANCER)*ncol(CANCER)))*100,2)
```

Calculamos los datos faltantes por cada variable para ver cómo los `NA`
afectan a cada una de ellas.

```{r}
colSums(is.na(CANCER))
```

La variable `Estado_del_Paciente` contiene información fundamental que
se empleará para clasificar a las pacientes, por lo que es necesario que
cada observación sea un caso completo. Es por ello que se eliminarán las
observaciones con NAs en esta variable.

```{r}
CANCER <- CANCER[complete.cases(CANCER), ] 
CANCER
```

Asignación de variables

```{r}
edad <- CANCER$Edad
proteina1 <- CANCER$Proteína1
proteina2<- CANCER$Proteína2
proteina3 <- CANCER$Proteína3
proteina4 <- CANCER$Proteína4
etapa_tumor <- CANCER$Etapa_del_Tumor
histologia <- CANCER$Histología
estado_HER2 <- CANCER$Estado_HER2
tipo_cirugía <- CANCER$Tipo_de_Cirugía
estado_paciente <- CANCER$Estado_del_Paciente
```

## III. Análisis descriptivo

Cargamos las librerías para realizar el análisis

```{r}
library("ggplot2")
library("moments")
```


### 1. Variables de estudio

Antes de continuar, se definirán unas funciones que resultarán útiles
para describir los datos

```{r}
CV <- function(x, na.rm=FALSE) {
  return (sd(x, na.rm=na.rm) / mean(x, na.rm=na.rm))
}
```

```{r}
Moda <- function(x) {
  return (table(x)[which.max(table(x))])
}
```

```{r}
R <- function(x) {
  return (round(x, digits=2))
}
```

```{r}
describir <- function(x) {
  return (c("Min"=min(x, na.rm=TRUE),"Max"=max(x, na.rm=TRUE),"Media"=mean(x, na.rm=TRUE), "Mediana"=median(x, na.rm=TRUE), "Desviación Estándar"=sd(x, na.rm=TRUE), "Coeficiente de Variación"=CV(x, na.rm=TRUE), "Rango Intercuartil"=IQR(x, na.rm=TRUE)) %>% R)
}
```

#### Análisis de `Etapa_del_Tumor`

```{r}
count_Tumor <- CANCER %>% count(Etapa_del_Tumor)
count_Tumor <- count_Tumor %>% mutate(FreqRel = n/317)
count_Tumor
```

```{r}
  ggplot(count_Tumor, 
       aes(x=Etapa_del_Tumor,y = FreqRel))+
    geom_col(color =c("#00B9E3", "#00C19F", "#619CFF"), fill = c("#00B9E3", "#00C19F", "#619CFF"))+
    geom_text(aes(label = R(FreqRel)), vjust=-0.25)+
    labs(x = "Etapa del Tumor", y = "Frecuencia relativa", title = "Proporciones de las etapas del tumor en las pacientes")

```

El gráfico sugiere que más de la mitad de las pacientes se encuentra en
etapa II de cáncer de mama.

#### Análisis de `Histología`

Realizamos una tabla para observar las frecuencias relativa y absoluta
de la variable `Histología`

```{r}
count_Histología <- CANCER %>% count(Histología)
count_Histología <- count_Histología %>% mutate(FreqRel = n/317)
count_Histología
```

A partir de la tabla, graficamos para observar mejor las proporciones

```{r}
  ggplot(count_Histología, 
       aes(x=Histología,y = FreqRel))+
    geom_col(color = c("#CD9600", "#FF68A1", "#49A0FF"), fill = c("#CD9600", "#FF68A1", "#49A0FF"))+
    geom_text(aes(label = R(FreqRel)), vjust=-0.25)+
    labs(x = "Histología", y = "Frecuencia relativa", title = "Proporciones de los tipos histológicos")

```

La mayoría de pacientes tiene cáncer de mama de tipo histológico
Carcinoma Ductal Infiltrante.

#### Análisis de `Tipo_de_Cirugía`

```{r}
count_Cirugía <- CANCER %>% count(Tipo_de_Cirugía)
count_Cirugía <- count_Cirugía %>% mutate(FreqRel = n/317)
count_Cirugía
```

```{r}
 ggplot(count_Cirugía, 
       aes(x= Tipo_de_Cirugía,y = FreqRel))+
    geom_col(color = c("#EA8331", "#9590FF", "#39B600", "#E76BF3"), fill = c("#EA8331", "#9590FF", "#39B600", "#E76BF3"))+
    geom_text(aes(label = R(FreqRel)), vjust=-0.25)+
    labs(x = "Tipo de cirugía", y = "Frecuencia relativa", title = "Proporciones de los tipos de cirugía realizadas a las pacientes")

```

La mayoría de pacientes se sometió a una operación diferente de una
Lumpectomía, Mastectomía Radical Modificada o Mastectomía Simple.
Además, existe una proporción similar entre pacientes que se realizaron
una Lumpectomía y una Mastectomía Simple.

#### Análisis de `Estado_HER2`

```{r}
count_HER2 <- CANCER %>% count(Estado_HER2)
count_HER2 <- count_HER2 %>% mutate(FreqRel = n/317)
count_HER2
```

```{r}
  ggplot(count_HER2, 
       aes(x= Estado_HER2,y = FreqRel))+
    geom_col(color = "#A3A500", fill = "#A3A500")+
    geom_text(aes(label = R(FreqRel)), vjust=-0.25)+
    labs(x = "Estado de la proteína HER2", y = "Frecuencia relativa", title = "Proporción del estado de la proteína HER2")

```

La gráfica indica que más del 90% de pacientes tiene cáncer
HER2-negativo, que quiere decir que no poseen la proteína HER2, que
promueve el crecimiento del cáncer de mama.

#### Análisis de `Edad`

Como es una variable numérica discreta, se analizará con descriptores
numéricos

```{r}
CANCER$Edad %>% describir
```

El coeficiente de variación es bajo, por lo que hay una baja dispersión
entre los datos, lo que significa que la media es representativa para
esta variable.

```{r}
Moda(CANCER$Edad)
```

Se observa que la edad más frecuente es 59 con 15 pacientes.

```{r}
hist(CANCER$Edad, freq=F, ylab="Frecuencia relativa", xlab="Edades", main="Edades de los pacientes", col = "#88CFE0") 
abline(v=c(median(edad, na.rm=TRUE)), col=c("blue"), lwd=c(2))
abline(v=c(mean(edad, na.rm=TRUE)), col=c("red"), lwd=c(2))

legend("topleft", legend = c("Mediana"), col = c("blue"), lwd=2)
legend("topright", legend = c("Media"), col = c("red"), lwd=2)

```

Observamos que se obtiene la siguiente relación:

$$ 
  mediana < media
$$

Se sugiere que podría existir un sesgo hacia la derecha. Para comprobar
esto, empleamos el índice de simetría

```{r}
skewness(CANCER$Edad)
```

El valor obtenido es positivo, por lo que se confirma que existe un
sesgo hacia la derecha. Sin embargo, puesto que el resultado se
encuentra dentro del rango [-0.5 - 0.5], podríamos decir que la
distribución de la variable `Edad` es aproximadamente simétrica.

### 2. Interacción entre variables

#### 2.1 Análisis bivariado

##### Análisis de `Etapa_del_Tumor` y `Estado_del_Paciente`

```{r}
ggplot(CANCER, aes(x = factor(Estado_del_Paciente), 
                          y = prop.table(stat(count)), 
                          fill = factor(Estado_del_Paciente), 
                          label = scales::percent(prop.table(stat(count))))) +
    geom_bar(position = "dodge") + 
    facet_wrap(~Etapa_del_Tumor) + 
    geom_text(stat = 'count',
              position = position_dodge(.9), 
              vjust = -0.5, 
              size = 3) + 
    scale_y_continuous(labels = scales::percent) + 
    labs(x = 'Estado del Paciente', y = 'Proporción', fill = 'Estado del Paciente')
```

Más del 80% de pacientes se encuentran vivos. Existe una tendencia
similar en en ambos estados: la mayoría de pacientes se encuentra en
etapa II y la menor cantidad en etapa I.

##### Análisis de `Tipo_de_Cirugía` y `Etapa_del_Tumor`

```{r}
mosaicplot(table(CANCER$Tipo_de_Cirugía, CANCER$Etapa_del_Tumor), col= c("#00B9E3", "#00C19F", "#619CFF"), main = "Tipos de cirugías realizadas en las etapas del tumor", xlab="Tipos de cirugía", ylab = "Etapas del tumor")
```

En la etapa I, la mayoría de pacientes se sometieron a una Lumpectomía;
en la II, a una Mastectomía Simple; y, a la etapa III, a una Mastectomía
Radical Modificada. Esto sugiere que mientras más avanza el cáncer, la
operación correspondiente se vuelve más compleja, puesto que hay que
retirar más tejidos.

##### Análisis de `HER2` y `Estado_del_Paciente`

```{r}
ggplot(CANCER, aes(x= Estado_del_Paciente,  group=Estado_HER2)) + 
    geom_bar(show.legend = F, aes(y = after_stat(prop), fill = factor(..x..)), stat="count") +
    geom_text(aes( label = scales::percent(..prop..),
                   y= ..prop.. ), stat= "count", vjust = -.5) +
    labs(y = "Porcentaje", x = "Estado del paciente", title = "Estado de la proteína HER2 respecto al estado del paciente") +
    facet_grid(~Estado_HER2) +
    scale_y_continuous(labels = scales::percent)

```

La gráfica sugiere que sin importar si el cáncer es HER2-positivo o
HER2-negativo, las pacientes tienden a sobrevivir. La mayoría de
pacientes respondió positivamente al tratamiento específico para el
estado de la proteína HER2.

#### 2.2 Análisis multivariado

##### Análisis de `Proteína1` respecto a `Estado_del_Paciente` y `Etapa_del_Tumor == I`

```{r}
ggplot(CANCER, aes(color =  Estado_del_Paciente, y= Proteína1, x = factor(Estado_del_Paciente, levels=c('Vivo', 'Fallecido')))) +
  geom_violin()+
  geom_boxplot(width = 0.1) +
  facet_grid(~Etapa_del_Tumor) +
  labs(title = "Proteína 1 según estado y etapa del tumor del paciente",
       x = "Estado del Paciente", 
       y = "Nivel de expresión de la proteína 1")
```

En pacientes fallecidos observamos que, a medida que la etapa progresa,
el nivel de expresión de la proteína tiende a concentrarse en un nivel
positivo. En pacientes vivos, observamos que, a medida que progresa la
etapa, el nivel de expresión de la proteína suele tender a niveles
positivos, iniciando desde un nivel negativo.

##### Análisis de `Proteína2` respecto a `Estado_del_Paciente` y `Etapa_del_Tumor`

```{r}
ggplot(CANCER, aes(color =  Estado_del_Paciente, y= Proteína2, x = factor(Estado_del_Paciente, levels=c('Vivo', 'Fallecido')))) +
  geom_violin()+
  geom_boxplot(width=0.1) +
  facet_grid(~Etapa_del_Tumor) +
  labs(title = "Proteína 2 según estado y etapa del tumor del paciente",
       x = "Estado del Paciente", 
       y = "Nivel de expresión de la Proteína2")
```

El gráfico sugiere que, a medida que progresa el cáncer, el nivel de expresión de la proteína 2 es similar en ambos estados. Ambos empiezan con un mayor nivel positivo y terminan con un
mayor nivel negativo. La diferencia es que en la etapa II, los
fallecidos toman una similar cantidad de niveles positivos y negativos.

##### Análisis de `Proteína3` respecto a `Estado_del_Paciente` y `Etapa_del_Tumor`

```{r}
ggplot(CANCER, aes(color =  Estado_del_Paciente, y= Proteína3, x = factor(Estado_del_Paciente, levels=c('Vivo', 'Fallecido')))) +
  geom_violin()+
  geom_boxplot(width=0.1) +
  facet_grid(~Etapa_del_Tumor) +
  labs(title = "Proteína 3 según estado y etapa del tumor del paciente",
       x = "Estado del Paciente", 
       y = "Nivel de expresión de la proteína 3")

```

El gráfico sugiere que, a medida que progresa el cáncer, el nivel de expresión de la proteína 3 es similar en ambos estados. Ambos empiezan y terminan con un mayor nivel negativo. La
diferencia es que en la etapa II, en los fallecidos toman una similar
cantidad de niveles positivos y negativos.

##### Análisis de `Proteína4` respecto a `Estado_del_Paciente` y `Etapa_del_Tumor`

```{r}
ggplot(CANCER, aes(color =  Estado_del_Paciente, y= Proteína4, x = factor(Estado_del_Paciente, levels=c('Vivo', 'Fallecido'))))+
  geom_violin()+
  geom_boxplot(width=0.1) +
  facet_grid(~Etapa_del_Tumor) +
  labs(title = "Proteína 4 según estado y etapa del tumor del paciente",
       x = "Estado del Paciente", 
       y = "Nivel de expresión de la Proteína4")
```

El gráfico sugiere que en pacientes vivos el nivel de expresión de la
proteína 4 disminuye, distribuyéndose progresivamente hacia -1, lo que quiere decir que cada vez es menos notable. Asimismo, en pacientes fallecidos, tiende aumentar hacia 1, lo que quiere decir que va ganado presencia progresivamente.


##### Análisis de `Edad` respecto a `Estado_del_Paciente` y `Etapa_del_Tumor`

```{r}
ggplot(CANCER, aes(color = Estado_del_Paciente, x = factor(Estado_del_Paciente, levels=c('Vivo', 'Fallecido')), y = Edad)) +
  geom_violin()+
  geom_boxplot(width=0.1) +
  facet_grid(~Etapa_del_Tumor) +
  labs(title = "Edad según estado y etapa del tumor del paciente",
       x = "Estado del Paciente", 
       y = "Edades")

```

A medida que avanza la etapa del cáncer, los pacientes fallecidos son
más jóvenes. En cuanto a pacientes vivos, la frecuencia de las edades es
cada vez más uniforme, lo que quiere decir que mientras más avanzada sea la etapa del cáncer, las afectadas son de edades más diversas.
