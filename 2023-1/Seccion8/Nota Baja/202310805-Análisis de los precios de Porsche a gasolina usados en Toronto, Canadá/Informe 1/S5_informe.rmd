---
title: "Análisis de los precios de Porsche a gasolina usados en Toronto, Canadá, desde enero a marzo del 2023"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  word_document:
    toc: yes
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    theme: journal
    number_sections: yes
editor_options: 
  chunk_output_type: inline
---

## Introducción:

## Relevancia:

Esta investigación ayuda a informar a los canadienses que viven en Toronto el precio promedio que se recomendaría pagar por un Porsche de segunda mano en base a los datos recolectados de la página "autotrader.ca", encontrada en el repositorio de **kaggle**.

## Objetivos:

### Objetivo General:

Analizar los precios de Porsche a gasolina usados tomando en cuenta especificaciones, en Toronto, Canadá por lo que va del 2023.

### Objetivos Específicos:

-   **Identificar** la relación entre el precio de venta y cantidad de km recorridos por modelo de Porsche a gasolina usado en Toronto, Canadá desde enero a marzo del 2023.

-   **Describir** las características de los Porsche a gasolina usados con mayor valor de reventa en Toronto, Canadá de desde enero a marzo del 2023.

-   **Identificar** la relación entre el precio de venta y el consumo que tiene cada modelo de Porsche a gasolina usado en Toronto, Canadá desde enero a marzo del 2023.

Marco teórico: Antecedentes, Metodología, 

## Librerías:

```{r include=FALSE}
library(readr)
library(dplyr)
library(funModeling)
library(modeest)
library(ggplot2)
```

Funciones:
```{r}
r <- function(n){
  round(n, 2)
}

cv <- function(X){
  return(sd(X, na.rm = T) / mean(X, na.rm = T))
}
```


```{r}
ModaCreada <- function(x) {
  DatosSinNulos <- na.omit(unique(x))
  tabulado <- tabulate(match(x, DatosSinNulos))
  DatosSinNulos[tabulado == max(tabulado) ]
}
```


## Datos:
```{r}
doc<-read.csv("AutosUsadosVendidos.csv")
doc
```



```{r}
cols<-ncol(doc)
rows<- nrow(doc)
cols
rows
```

La base de datos esta siendo almacenada en la variable doc.

Contiene 18647 observaciones y 16 variables

## Proceso de recolección de datos

Nuestro proceso de recolección de datos se basó en, primer lugar, definir si íbamos a usar una base de datos ya existentes o realizar encuestas. Sin embargo, decidimos emplear una ya existente por dos motivos, debido a la recomendación de nuestro profesor de aula y debido a que consideramos que es una buena opción de ahorrar tiempo para poder avanzar con nuestro trabajo.

A partir de ello, decidimos buscar un tema de interés para todos los del grupo en una de las páginas que nos recomendó el profesor de aula, llamada "Kaggle", y nos pusimos de acuerdo para elegir esta base de datos que se trata de las especificaciones de los Porsche en venta para que de esta manera podamos desarrollar los objetivos posteriormente indicados.

## Población, muestra y muestreo

1.- Población de estudio: Los múltiples precios que presentan los Porsche usados en Toronto, Canadá, desde enero a marzo del 2023.

2.- Unidad muestral: Diferentes modelos de Porsche.

3.- Tamaño de muestra: 599 precios de autos Porsche

4.- Representatividad de la muestra: Si es una muestra representativa, ya que muestra los múltiples precios que existen por modelo de Porsche, basado en sus especificaciones.

5.- Tipo de muestreo: Población total.

## Variables

+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Variable                                 | Tipo de Variable   | Descripción                                                                                                                                |
+==========================================+====================+============================================================================================================================================+
| Consumo de combustible/energía en ciudad | Numérica continua  | Consumo de combustible/energía de un auto/camioneta en zonas urbanas y/o ciudad                                                            |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Consumo de combustible/energía carretera | Numérica continua  | Consumo de combustible/energía de un auto/camioneta en carretera                                                                           |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Kilometraje                              | Numérica Discreta  | Kilómetros recorridos del auto/camioneta                                                                                                   |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Pasajeros                                | Numérica Discreta  | Cantidad de pasajeros que pueden ir en el auto/camioneta                                                                                   |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Puertas                                  | Numérica Discreta  | Número de puertas que contiene el auto                                                                                                     |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Precio                                   | Numérica Discreta  | Precio del auto/camioneta puesto en venta                                                                                                  |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| N° de cilindros del motor                | Numérica Discreta  | Cantidad de cilindros del motor que presenta un auto/camioneta                                                                             |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Modelo                                   | Categórica Nominal | Identificación específica para cada tipo de auto diferente, pero de la misma marca                                                         |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo de carrocería                       | Categórica Nominal | Identificar si es un carro o una SUV                                                                                                       |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo de tracción                         | Categórica Nominal | Mecanismo que permite llevar la fuerza y el movimiento generado por el motor hasta las ruedas                                              |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Color exterior                           | Categórica Nominal | Color de cada auto/camioneta vista por el exterior                                                                                         |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Color interior                           | Categórica Nominal | Color de cada auto/camioneta vista por el interior                                                                                         |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo de combustible/energía              | Categórica Nominal | Aquella sustancia que proporciona energía a los autos con motor de combustión o electrico                                                  |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Tipo de transmisión                      | Categórica Nominal | Aquel mecanismo que convierte la fuerza del motor en una fuente controlada de energía, actuando como mediador entre el motor y las ruedas. |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Año del Auto                             | Categoría Ordinal  | Año en que se frabricó el vehíuclo                                                                                                         |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Marca                                    | Categórica Nominal | Empresa que se encargó de la fabricación del vehículo                                                                                      |
+------------------------------------------+--------------------+--------------------------------------------------------------------------------------------------------------------------------------------+


## Limpieza de datos

1.- Se procede a filtrar la base de datos total para obtener solo los datos a utilizar.

```{r}
library(readr);
library(dplyr);
doc<-read.csv("AutosUsadosVendidos.csv")
doc_corregido<-filter(doc, doc$Make=="Porsche")
doc_corregido
```

2.- Se procede a eliminar las variables "Exterior Colour" y "Interior Colour", ya que no la consideramos relevante en nuestro estudio.

```{r}
BD<-select(doc_corregido,  -Interior_Colour)
BD
```

3.- Revisaremos si existen datos faltantes (NA)

```{r}
sum(!complete.cases(BD)) #significa que no hay ninguna fila incompleta.
```

4.- Ahora cargaremos los datos con la función `df_status`

```{r}
library(funModeling)
knitr::kable(df_status(BD,print_results = FALSE),"pipe",caption="Resumen de la base de datos" )
```


```{r}
ncol(BD)
nrow(BD)
```

Se presentan 14 variables y 599 observaciones en la tabla.


Identificamos que las variables City y Highway se presentan como caracter, por lo que haremos su conversión a numérico.

Pero para hacer esto, primero debemos convertir las comas de los datos de las variables City y Highway en puntos.

-   **Cambio de comas a puntos de los datos de las variables City y Highway**

```{r}
BD$City<-sub(",",".",BD$City, fixed=TRUE)
BD$Highway<-sub(",",".",BD$Highway, fixed=TRUE)

```

Observamos que en nuestra base de datos los datos numéricos que tenían comas, ahora tienen puntos

```{r}
BD
```

-   **Cambio de carácter a numérico de la variable City**

```{r}
BD$City<-as.numeric(BD$City)
```

Verificaremos que la variable City se haya transformado correctamente a numérica

```{r}
is.numeric(BD$City)
```

-   **Cambio de carácter a numérico de la variable Highway**

```{r}
BD$Highway<-as.numeric(BD$Highway)
```

Verificaremos que la variable Highway se haya transformado correctamente a numerica.

```{r}
is.numeric(BD$Highway)
```

-   **Cambio de numérico a categórico de la variable Year**

```{r}
BD$Year<-as.character(BD$Year)
```

Verificaremos que la variable Year se haya transformado correctamente a categórica.
```{r}
is.character(BD$Year)
```

-   **Cambio de carácter a numérico de la variable Engine**
```{r}
BD$Engine<-as.numeric(BD$Engine)
```

Verificaremos que la variable Engine se haya transformado correctamente a numérica.
```{r}
is.numeric(BD$Engine)
```

Ahora veremos los datos actualizados
```{r}
knitr::kable(df_status(BD,print_results = FALSE),"pipe",caption="Resumen de la base de datos" )
```

Ahora pasaremos a renombrar las variables

1.-Primero, vamos a llamar a todas las variables presentes con el comando `names`
```{r}
names(BD)
```

2.- Segundo, cambiaremos los nombres de estas por unas mas adecuadas con el comando `rename` y almacenaremos nuestra nueva base de datos en "BD1"
```{r}
rename(BD, Año= 'Year', Marca='Make', Modelo='Model', Kilómetros='Kilometres', Carrocería='Body_Type', Motor='Engine', Transmisión='Transmission', Tracción= 'Drivetrain', Color_exterior='Exterior_Colour', Pasajeros='Passengers', Puertas='Doors', Tipo_combustible='Fuel_Type', Consumo_Ciudad='City',Consumo_Carretera='Highway',Precio='Price' )->BD1
BD1
```

Ahora vamos a filtrar nuestra base de datos para que nos nuestre solo los modelos de Porsche a gasolina ("Gas")
```{r}
table(BD1$Tipo_combustible)
BD1<-filter(BD1,Tipo_combustible == "Gas")
```

Una vez filtrada, llamamos a la variable "Tipo_combustible" y vemos que solo nos nuestra las observaciones que son a gasolina ("Gas")
```{r}
table(BD1$Tipo_combustible)
```

Como vemos no hay datos faltantes
```{r}
sum(is.na(BD1))
```

Ahora llamamos a la variable "Modelo" para verificar que esté todo en orden pero nos damos cuenta que el modelo "Boxster" se repite, una vez en minúscula y otra vez en mayúscula
```{r}
table(BD1$Modelo)
```

Ahora hacemos que cuando aparezca el modelo "BOXSTER" lo identifique y lo cambie a "Boxster" y esta corrección va aser almacenada en una nueva variable "Modelcor"
```{r}
BD1<-mutate(BD1,Modelcor=case_when(Modelo == '718' ~'718',
Modelo == '911' ~ '911',Modelo=='Boxster'~'Boxster',Modelo=='BOXSTER'~'Boxster',Modelo=='Cayenne'~'Cayenne',Modelo=='Cayman'~'Cayman', Modelo=='Macan'~'Macan',Modelo=='Panamera'~'Panamera'))

```

Seguido de esto, vamos a proceder a eliminar las variables "Modelo", "Tipo_combustible" y "Marca", ya que habrían 2 variables que muestran los mismos datos "Modelo" y "Modelcor"; tambien porque todas nuestras observaciones son Porsche y todas son a gasolina ("Gas")

```{r}
BD1<-select(BD1,  -Modelo,-Tipo_combustible,-Marca)
```

Revisamos si hay datos faltantes nuevamente y como vemos no hay
```{r}
sum(is.na(BD1))
```


Por último, llamamos a nuestra base de datos corregida (BD1)

```{r}
BD1
```



## Descriptores 

## Variables Númericas:

# Precio

Observamos que existe una diferencia entre la mediana y la media de nuestros datos de la variable precio.  
```{r}
r(mean(BD1$Precio, na.rm=TRUE))
median(BD1$Precio, na.rm=TRUE)
```
Para poder saber que medida de tendencia central representa mejor a nuestros datos, sin que afecte mucho los valores atípicos, calcularemos el coeficiente de variabilidad en porcentaje:  
```{r}
cv(BD1$Precio)*100 
```
Este resultado nos indica que existe una dispersión alta. También nos indica que la presencia de valores atípicos influye a que nuestros valores individuales de nuestro conjunto estén más alejados de la media. Por lo tanto el mejor descriptor para nuestra variable es la mediana.  
```{r}
median(BD1$Precio, na.rm=TRUE)#valor que representa el 50% de nuestros datos
```

```{r}
quantile(BD1$Precio,na.rm = TRUE)
```

Ahora veremos el diagrama de Cajas y Bigotes de la variable Precio
```{r}
options(scipen=3)
caja<-boxplot(BD1$Precio, horizontal = T, main = "Diagrama de Cajas y Bigotes de Precio", xlab = "Precio ($)",col="#FFEFDB")
abline(v=median(BD1$Precio),col="red",lwd=2)
text(x=median(BD1$Precio)-11000, y=0.6, "Mediana", srt=90, col="red")
```

Ahora se calculan los datos atípicos
```{r}
min(caja$out)
length(caja$out)#cantidad de datos atípicos
```

Según la grafica, la cantidad de valores atípicos son de 39 autos, que representan los autos Porsche que tienen un precio muy por encima de los 259888 dólares. También que el 25% superior de los Porsche puestos en venta van a estar por encima de un precio de 137869 dólares. Un valor promedio del precio de todos los autos Porsche que están siendo vendidos será de aproximadamente 73888 dólares. Por un lado el mayor precio de los Prosche puestos en venta será de 539000 dolares. Por otro lado, el Porsche más barato tiene un precio de 15995 dólares.



#N° CILINDROS DE MOTOR


```{r}
#Descriptores
min(BD1$Motor)
max(BD1$Motor)
ModaCreada(BD1$Motor)
```


```{r}

hist(BD1$Motor,breaks=10,col="#FFEFDB",main="Distribución del número de cilindros del motor\n de los Porsches usados a la venta",xlab="Número de cilindros", ylab="Número de Porsches")
abline(v=ModaCreada(BD1$Motor),col="red",lwd=2)
legend("topright",legend=c("Moda"),lwd=2,col=c("red"))
```

En el gráfico barras se ve que la mayoría de Porsche a la venta tienen 6 cilindros, con un máximo de 8 y un mínimo de 3.



#KILÓMETROS   


```{r}
#Descriptores
range(BD1$Kilómetros) 
round(mean(BD1$Kilómetros),2)  # Promedio del kilómetro.
round(median(BD1$Kilómetros),2)# Mediana del kilómetro.
quantile(BD1$Kilómetros)


#revisar si va o no coeficiente de variabiblidad
```

Observamos que existe una diferencia entre la mediana y la media de nuestros datos de la variable Kilómetros.  
```{r}
r(mean(BD1$Kilómetros, na.rm=TRUE))
median(BD1$Kilómetros, na.rm=TRUE)
```

Para poder saber que medida de tendencia central representa mejor a nuestros datos, sin que afecte mucho los valores atípicos, calcularemos el coeficiente de variabilidad en porcentaje:  
```{r}
cv(BD1$Kilómetros)*100 
```

Este resultado nos indica que existe una dispersión alta. También nos indica que la presencia de valores atípicos influye a que nuestros valores individuales de nuestro conjunto estén más alejados de la media. Por lo tanto el mejor descriptor para nuestra variable es la mediana.  
```{r}
median(BD1$Kilómetros, na.rm=TRUE)#valor que representa el 50% de nuestros datos
```

Ahora haremos un histograma con la variable de Kilómetros recorridos de los Porsches usados a la venta
```{r}
#Gráficos
library(modeest)
hist(BD1$Kilómetros, xlab="Kilometraje", ylab="Número de Porsches", main="Histograma del kilometraje de los Porsche usados a la venta", breaks=7, col="#FFEFDB",border= "black")

abline(v=median(BD1$Kilómetros),col="red")
legend("topright", c("Mediana"), col=c("red"), lwd=2)
```

Ahora pasaremos al gráfico de Cajas y Bigotes con la variable kilometros recorridos por los autos/camionetas Porsche

```{r}
cajak<-boxplot(BD1$Kilómetros,main = "Diagrama de Cajas y Bigotes del Kilometraje\n de los Porsches usados a la venta", col="#FFEFDB", horizontal = TRUE , xlab ="Kilometraje")

abline(v=median(BD1$Kilómetros),col="red")

legend("topright", c("Mediana"), col=c("red"), lwd=2)
```

Calcularemos la cantidad de datos atípicos presentes
```{r}
length(cajak$out)
```


Como se ve en ambos gráficos, hay 11 Porsches a la venta que tienen un kilometraje mayor a comparación del resto.También identificamos que el 25% superior de los Porsches usados a la venta van a estar por encima de los 76422 kilometros recorridos aproximadamente. La cantidad promedio de kilometros recorridos por los Porsches usados a la venta es de 44899 aproximadamente. Por un lado, el mayor kilometraje de los Porsches puestos a la venta es de 205400. Por otro lado, el menor kilometraje presente entre los Porsches usados a la venta es de 67.



#CONSUMO EN CIUDAD


```{r}
#Descriptores

tabla_frecuencias<-table(BD1$Consumo_Ciudad)
rango<-range(BD1$Consumo_Ciudad)
rango
mediana<-median(BD1$Consumo_Ciudad)
mediana
promedio<-mean(BD1$Consumo_Ciudad)
promedio
quantile(BD1$Consumo_Ciudad)
```

Observamos que existe una diferencia entre la mediana y la media de nuestros datos de la variable precio.  
```{r}
r(mean(BD1$Consumo_Ciudad, na.rm=TRUE))
median(BD1$Consumo_Ciudad, na.rm=TRUE)
```

Para poder saber que medida de tendencia central representa mejor a nuestros datos, sin que afecte mucho los valores atípicos, calcularemos el coeficiente de variabilidad en porcentaje:  
```{r}
cv(BD1$Consumo_Ciudad)*100 
```

Este resultado nos indica que existe una dispersión alta. También nos indica que la presencia de valores atípicos no influye a que nuestros valores individuales de nuestro conjunto estén más alejados de la media. Por lo tanto el mejor descriptor para nuestra variable es la media.  
```{r}
r(mean(BD1$Consumo_Ciudad, na.rm=TRUE))#valor que representa el 50% de nuestros datos
```


Ahora haremos un diagrama de cajas y bigotes con la variable de Consumo en Ciudad (L/100Km)
```{r}
cajacc<-boxplot(BD1$Consumo_Ciudad,main = "Diagrama de Cajas y Bigotes del consumo de gasolina en cuidad\n (L/100Km) de los Porsches usados a la venta", col="#FFEFDB", horizontal = TRUE , xlab ="Consumo en ciudad (L/100Km)")

abline(v=mean(BD1$Consumo_Ciudad),col="red")
legend("topright", c("Media"), col=c("red"), lwd=2)
```
Calculamos la cantidad de datos atípicos que presenta
```{r}
length(cajacc$out)
```

Según los gráficos, hay 47 Porsches a la venta que tienen un consumo de gasolina en cuidad alejado de la mayoría. También identificamos que el 25% superior de los Porsches a la venta van a tener un consumo de gasolina en ciudad mayor de 13.7 litros por cada 100 Km recorridos aproximadamente. La cantidad promedio de consumo de gasolina de los Porsches en ciudad es de 13.24 litros por cada 100 Km recorridos. Por un lado, el mayor consumo de gasolina en cuidad de estos es de 19.4 litros por cada 100 Km recorridos. Por otro lado, el menor consumo es de 7.4 litros por cada 100 Km recorridos. 




#CONSUMO CARRETERA


```{r}
#Descriptores

tabla_frecuencias<-table(BD1$Consumo_Carretera)
moda<-as.numeric(names(tabla_frecuencias)[which.max(tabla_frecuencias)])
moda
rango<-range(BD1$Consumo_Carretera)
rango
mediana<-median(BD1$Consumo_Carretera)
mediana
promedio<-mean(BD1$Consumo_Carretera)
promedio
round(quantile(BD1$Consumo_Carretera),2)
```

Observamos que existe una diferencia entre la mediana y la media de nuestros datos de la variable precio.  
```{r}
r(mean(BD1$Consumo_Carretera, na.rm=TRUE))
median(BD1$Consumo_Carretera, na.rm=TRUE)
```

Para poder saber que medida de tendencia central representa mejor a nuestros datos, sin que afecte mucho los valores atípicos, calcularemos el coeficiente de variabilidad en porcentaje:  
```{r}
cv(BD1$Consumo_Carretera)*100 
```

Este resultado nos indica que existe una dispersión baja. También nos indica que la presencia de valores atípicos no influyen a que nuestros valores individuales de nuestro conjunto estén más alejados de la media. Por lo tanto el mejor descriptor para nuestra variable es la media.  
```{r}
r(mean(BD1$Consumo_Carretera, na.rm=TRUE))#valor que representa el 50% de nuestros datos
```

Ahora haremos un histograma del consumo de gasolina en carretera tendrán los Porsches usados puestos en venta


```{r}
hist(BD1$Consumo_Carretera, xlab="Consumo en Carretera (L/100km)", ylab = "Número de Porsches", main = "Histograma del consumo de gasolina en carretera\n (L/100 Km) de los Porsches usados a la venta")
abline(v=mean(BD1$Consumo_Carretera, na.rm=T), col='red')
legend("topright", c("Media"), col=c("red"), lwd=2)
```

Ahora haremos un diagrama de cajas y bigotes del consumo de gasolina en carretera (L/100 Km) de los Porsches usados a la venta
```{r}
boxplot(BD1$Consumo_Carretera,main = "Diagrama de Cajas y Bigotes del consumo de gasolina en carretera\n (L/100Km) de los Porsches usados a la venta", col="#FFEFDB", horizontal = TRUE , xlab ="Consumo en carretera (L/100Km)")

abline(v=mean(BD1$Consumo_Carretera),col="red")
legend("topright", c("Media"), col=c("red"), lwd=2)
```


Como podemos observar en este histograma, el consumo de gasolina en carretera promedio de los Porsches usados a la venta es de 10 litros por cada 100 Km recorridos. Por un lado, el mayor consumo de gasolina que tienen los Porsches usados a la venta es de 28.3 litros por cada 100 Km recorridos. Por otro lado, el menor consumo de gasolina es de 6.8 litros por cada 100 Km recorridos.



## Variables Categoricas:

#MODELOS DE PORSCHE


```{r}
#Descriptor
moda<-mfv(BD1$Modelcor)
moda
```

Ahora haremos un gráficos de Frecuencias de la variable Modelo
```{r}
#Gráficos
bar<-barplot(table(BD1$Modelcor), 
             xlab = "Modelos de Porsche", ylab = "Número de Porsches",
             main = "Frecuencia de la variable Modelo", 
             col = c("blue1","pink","yellow","brown","red","green","aquamarine","black"),
             names.arg = " ",
             ylim = c(0, 200),xlim= c(0,21))
text(bar, table(BD1$Modelcor)+1.5, labels = table(BD1$Modelcor))
legend(x="right", legend=c("718","911","Boxster", "Cayenne","Cayman","Macan","Panamera"),
       fill = c("blue1","pink","yellow","brown","red","green","aquamarine","black"),
       title = "Leyenda")
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "grey")

```

De acuerdo con esta gráfica observamos que los modelos con menos unidades a la venta son el "Panamera" con 53 unidades, seguido del "718" con 30 unidades, el "Boxster" con 10 unidades y por último el "Cayman" con solo 5 unidades, siendo el modelo con menos unidades la venta. Por otro lado, los modelos "Macan", "911" y "Cayenne" van a ser los que tienen mas unidades puestas en venta; siendo el "Macan" con más unidades puestas en venta con 164, seguido del "Cayenne" con 155 unidades y por último al "911" con 153 unidades puestas en venta.



#TIPO DE CARROCERÍA


```{r}
#Descriptor
ModaCreada(BD1$Carrocería) #El tipo de carrocería con mayor repetición en los autos Porsche
```

Ahora calculamos el número de Porsches de cada tipo de carrocería
```{r}
table(BD1$Carrocería)
```

Ahora tendremos un gráfico de barras que mostrará la cantidad de tipos de carrocerías de los Porsche puestos en venta  
```{r}
color=c("grey","grey","grey","grey","#97FFFF","grey")
barplot(table(BD1$Carrocería),main="Tipo de Carrocería", xlab="Tipo de carrocería", ylab="Cantidad", col=color)
```
De acuerdo a está gráfica observamos que son 319 autos Porsche puestos en venta que tienen un tipo de carrocería igual `SUV`, este viene a representar la moda. Se logra deducir que hay 3 tipos de carrocería de autos Porsche puestos en venta que no cuentan con un número de repeticiones mayor a 40, de los cuales son `Hatchback, Sedan y Wagon` en un intervalo de 0-40. Luego los tipos de carrocerías `Convertible` y `Coupe` de autos Porsche cuentan con una cantidad de 56 y 136 respectivamente.



#TRACCIÓN  


```{r}
variable<-BD1$Tracción
tabla_frecuencias<-table(variable)
moda<-names(tabla_frecuencias)[tabla_frecuencias == max(tabla_frecuencias)]
moda
```

Ahora calcularemos la cantidad de Porsche que hay de cada tipo de tracción
```{r}
table(BD1$Tracción)
```

Realizamos un gráfico de barras  
```{r}
color=c("grey","#1F8AA2","grey")
tabla_frecuencias<-table(BD1$Tracción)
barplot(tabla_frecuencias, main="Tracción", xlab="Tracción", ylab="Cantidad",col=color)
```
De acuerdo a está gráfica observamos que el menor tipo de tracción del mecanismo que permite llevar la fuerza y el movimiento generado por el motor hasta las ruedas es  `AWD` con una cantidad 447, seguido del tipo de tracción `RWD` con una cantidad de 119 repeticiones y por último tenemos al tipo de tracción de `4x4` con una cantidad de 4 repeticiones, en los cuales estos dos últimos tipos de tracción comparado con el `AWD` vienen representado por pocos autos Porsche puestos en venta.



#COLOR DEL AUTO

```{r}
muestra<-filter(BD1, Color_exterior=="Black" | Color_exterior=="White" | Color_exterior=="Blue" | Color_exterior=="Quarzite Grey Metallic" | Color_exterior=="Silver" | Color_exterior=="Agate Grey Metallic")
muestra
```

Ahora identificaremos la cantidad de Porsches que van haber por cada tipo de color
```{r}
table(muestra$Color_exterior)
```

Ahora haremos una gráfica de la cantidad de Porsches que hay por cada tipo de pintura
```{r}
color=c("#616161","#030303","#1E90FF","#474747","#949494","White")
barplot(table(muestra$Color_exterior),main="Color exterior", xlab="", ylab="Cantidad", col=color)

legend(x=3,y=140, legend=c("Agate Grey Metallic","Black","Blue", "Quarzite Grey Metallic","Silver","White"),
       fill = c("#616161","#030303","#1E90FF","#474747","#949494","White"),
       title = "Leyenda")
```

De acuerdo a está gráfica se observa que el menor repeticiones de color es `Agate Grey Metallic` con una cantidad de 20, seguido de él se encuentra los colores  `Grey Metallic y Silver` con una cantidad de 23. Por otro lado tenemos el mayor repetición de color es `Black` con una cantidad de 149.



#AÑO DEL AUTO


```{r}
library(modeest)
mfv(doc_corregido$Year)
```


```{r}
library(ggplot2)
ggplot(doc_corregido) +
 aes(x = Year) +
 geom_histogram(bins = 30L, fill = "#1F8AA2") +
 labs(y = "Frecuencia", 
 title = "Año del Auto") +
 theme_minimal()

```
De acuerdo a está gráfica observamos los menores años de frabricación son `1997 y 1999` con 1 venta en cada uno y el año del auto puesto en  mayoría a la venta es `2019` con 104 ventas de autos.
Y se observa que se ponen en venta menos de 110 autos de cada año.


## Análisis Descriptivo:  


#Objetivo 1:

-   **Identificar** la relación entre el precio de venta y cantidad de km recorridos por modelo de Porsche usado en Toronto, Canadá desde enero a marzo del 2023.

```{r}
Kilómetros<-BD1$Kilómetros
Precio<-BD1$Precio
ggplot(BD1, aes(x=Precio,y=Kilómetros))+geom_point() +ggtitle("Gráfico de relación entre el precio de venta y la cantidad de Km recorridos") 
```

***Análisis del Gráfico***
Según la gráfica, tiene una tendencia a una relación no lineal.

Verificamos con el p_value si hay relación:
```{r}
#Hallamos el p_value
cor.test(BD1$Precio,BD1$Kilómetros)
```
Se observa que el valor del p_value<0.05, entonces se confirma que existe relación entre estas variables.

Se procederá a analizar el precio y Kilometraje que tiene cada modelo de Porsche:
```{r}
Conf3x3 = matrix(c(1:9), nrow=3, byrow=F)
Conf3x3

layout(Conf3x3)
options(scipen=3)

# 1) 718:
M718 <-filter(BD1,Modelcor == "718")
grafico <- ggplot(M718, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo 718:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm) + facet_wrap("Modelcor")

# 2) 911:
M911<-filter(BD1,Modelcor=="911")
grafico <- ggplot(M911, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo 911:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

# 3) Boxster:
MBoxster<-filter(BD1,Modelcor=="Boxster")
grafico <- ggplot(MBoxster, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo Boxster:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

#4) Cayenne:
MCayenne<-filter(BD1,Modelcor=="Cayenne")
grafico <- ggplot(MCayenne, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo Cayenne:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

#5) Cayman:
MCayman<-filter(BD1,Modelcor=="Cayman")
grafico <- ggplot(MCayman, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo Cayman:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

#6) Macan:
Macan<-filter(BD1,Modelcor=="Macan")
grafico <- ggplot(Macan, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo Macan:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

#7) Panamera:
Mpana<-filter(BD1,Modelcor=="Panamera")
grafico <- ggplot(Mpana, aes(x = Precio, y = Kilómetros)) + 
  geom_point() + 
  labs(title = "Gráfico de regresión para modelo Panamera:", x = "Precio", y = "Kilometros")
grafico + geom_smooth(method = lm)

```
***Análisis del Gráfico***
Como podemos ver en estos gráfticos de regresión tienen una pendiente negativa. Esto significa que con forme vaya aumentando el kilometraje va a disminuir el precio. Mientras menos kilometraje tenga, mayor será el precio de venta del Porsche, ya que tendrá un menor uso.


Ahora haremos un diagrama de Cajas y Bigotes de los precios que tiene los modelos de los Porsches usados a la venta
```{r}
boxplot(formula=BD1$Precio~BD1$Modelcor, xlab="Modelos", ylab="Precio ($)",main="Modelos de Porsche y Precio", data=BD1,col="#FFEFDB", vertical=T)
```
***Análisis del Gráfico***

En los dos gráficos ya visualizados y analizados, se concluye que el precio disminuye según aumenta el kilometraje del vehículo, además se visualiza que el modelo con mayor precio será el 911 pero no necesariamente su kilometraje será menor.



#Objetivo 2

-   **Describir** las características de los Porsche usados con mayor valor de reventa en Toronto, Canadá de desde enero a marzo del 2023.

Para este análisis lo primero será identificar el 10% superior de los Porsches con mayor valor de reventa 
```{r}
cuantil<-quantile(BD1$Precio, na.rm = TRUE, probs = 0.90)
baseP<-filter(BD1,Precio>=cuantil)
baseP1<- arrange(baseP,-Precio)
baseP1

```

Aquí podremos observar el mínimo y máximo del precio de los Porsche de nuestra nueva base de datos
```{r}
range(baseP$Precio)
```
Con esto podemos concluir que los precios máximos a analizar se encuentran dentro de un rango de 208800 hasta 539000 dólares.

De nuestra base de datos (baseP) podemos concluir lo siguiente con respecto a las siguientes variables:

*Año*: El año de fabricación del auto en el cual más se repite, es el año 2019 con una frecuencia absoluta de 20, luego está el año 2022 con una frecuencia absoluta de 14, seguido de los años 2021 y 2018 que tienen la misma frecuencia absoluta de 8, después eñ año 2017 con una frecuencia absoluta de 2 y por último de los valores únicos como son los años 1996,1997, 2008, 2010 y 2023. 
```{r}
table(baseP$Año)
```

*Kilometraje*:La gran mayoría de los Porsche tiene un kilometraje único a excepción de 2676 km que hay 6 con el mismo, seguido de 7514 con 4 unidades, despues de 48880 con 3 unidades y por último 9036 y 5523 ambos con 2 unidades. El de mayor precio Porsche tiene un kilometraje de 125, seguido de uno con 27475.

```{r}
table(baseP$Kilómetros)
```
*Transmisión*: En esta variable, la moda está inclinada hacia un tipo de transmisión de "7 Speed Automatic" que cuenta con un número de 20 repeticiones por encima de los otros tipos. El Porsche con el precio máximo de reventa tiene como característica de esta variable al tipo "7 Speed Automatic".

```{r}
table(baseP$Transmisión)
```
*Color_exterior*: En cuanto al color exterior observamos que en su mayoría si fueron repetidas hasta en 3 ocasiones con 5 cantidades, el color que representa al Porsche con el precio máximo de reventa es el color "Black".

```{r}
table(baseP$Color_exterior)
```

*Consumo_Ciudad*: En esta variable se observa una moda inclinada de 5 Porsche hacia un consumo por ciudad de 13.6576087 L/100km, en esta parte el  Porsche con el precio máximo de reventa tiene la característica de 15.3 L/100km, donde se puede explicar que los clientes tienen una tendencia de adquirir autos con menores consumos de litros por cada 100 km en ciudad.

```{r}
table(baseP$Consumo_Ciudad)
```
*Consumo_Carretera*: En esta variable se observa una moda inclinada a 26 con 13.6576087 11.2 L/100km , en esta parte el  Porsche con el precio mínimo de reventa tiene como 6 valores únicos, donde se puede explicar que los clientes tienen una tendencia de adquirir autos con menores consumos de litros por cada 20 km en ciudad.

```{r}
table(baseP$Consumo_Carretera)
```

Gráficas de las otras variables

```{r}
Conf2x3 = matrix(c(1:6), nrow=2, byrow=F)
layout(Conf2x3)

color=c("#7FFF00","grey")
barplot(table(baseP$Carrocería),main="Tipo de carrocería", xlab="", ylab="Cantidad", col=color)

barplot(table(baseP$Motor),main="Cantidad de cilindros", xlab="", ylab="Cantidad", col="#616161")

color=c("aquamarine","#1F8AA2")
barplot(table(baseP$Tracción),main="Tipo de Tracción", xlab="", ylab="Cantidad", col=color)

color=c("#C1FFC1","aquamarine","#C6E2FF")
barplot(table(baseP$Pasajeros),main="Número de pasajeros", xlab="", ylab="Cantidad", col=color)

barplot(table(baseP$Puertas),main="Número de puertas", xlab="", ylab="Cantidad", col="lightblue")

barplot(table(baseP$Modelcor),main="Tipo de modelo", xlab="", ylab="Cantidad", col="#FFE4C4")

#poner pie chart para las numericas
```
Podemos observar que varios de los Porsche tienen ahora características más comunes. En las gráficas del Tipo de carrocería, Tipo de tracción y el número de pasajeros existe una moda más notaria donde se puede decir que de los 10 Porsche con los mayores valores de reventa tienen una tendencia a preferir a un tipo de carrocería de "Coupe", un tipo de tracción de "RWD" y a un número de pasajeros de "2". Mientras que en las gráficas de Número de puertas, Cantidad de cilindros o motor y el tipo de modelo todas tienen características iguales.



#Objetivo específico 3

-   **Identificar** la relación entre el precio de venta y el consumo que tiene cada modelo de Porsche a gasolina usado en Toronto, Canadá desde enero a marzo del 2023.



```{r}
boxplot(formula=BD1$Consumo_Carretera~BD1$Modelcor, xlab="Modelos", ylab="Consumo en Carretera (L/100km)", main="Modelos de Porsche y Consumo en Carretera", data=BD1,col="#FFEFDB", vertical=T)

boxplot(formula=BD1$Consumo_Ciudad~BD1$Modelcor, xlab="Modelos", ylab="Consumo en Ciudad (L/100km)", main="Modelos de Porsche y Consumo en Ciudad", data=BD1,col="#FFEFDB", vertical=T)
```

***Análisis del Gráfico***
-En ambos gráficos se puede observar que el modelo de Porsche "911" genera datos atípicos.

-Concluyendo que es el modelo que más consume gasolina(L/100km) tanto en carretera como en ciudad, y si analizamos detenidamente podemos corroborarlo visualmente con la mediana.

-Donde la mediana es el descriptor más robusto, en el gráfico se observa que la línea negra está en la parte superior del Diagrama de caja y bigotes para ambos casos, indicando que la mitad para arriba están los mayores valores a comparación de los demás modelos.







```{r}
Conf2x1 = matrix(c(1:2), nrow=1, byrow=F)
Conf2x1
```

```{r}
layout(Conf2x1)

options(scipen=3)
regre21<-plot(BD1$Precio~BD1$Consumo_Ciudad,pch=20,col=c("black","red"),main="Precio y Consumo por ciudad",xlab="Consumo por ciudad (L/100km)",ylab="Precio ($)")
abline(lm(BD1$Precio~BD1$Consumo_Ciudad),col="blue",lty=1)


options(scipen=3)
regre22<-plot(BD1$Precio~BD1$Consumo_Carretera,pch=20,col=c("black","red"),main="Precio y Consumo por carretera",xlab="Consumo por carretera (L/100km)",ylab="Precio ($)")
abline(lm(BD1$Precio~BD1$Consumo_Carretera),col="blue",lty=1)
```
***Análisis del Gráfico***
Para el análisis de cada uno de los modelos, partimos de una vista general donde en este gráfico se relaciona el precio de venta con el consumo en ciudad y carretera de todos los modelos.

Se observa en los gráficos que la variable consumo por ciudad, presenta mayor velocidad de aumento de precio.

```{r}
M718<-filter(BD1,Modelcor=="718")
```

```{r}
M911<-filter(BD1,Modelcor=="911")
```

```{r}
MBoxster<-filter(BD1,Modelcor=="Boxster")
```

```{r}
MCayenne<-filter(BD1,Modelcor=="Cayenne")
```

```{r}
MCayman<-filter(BD1,Modelcor=="Cayman")

```

```{r}
Macan<-filter(BD1,Modelcor=="Macan")
```

```{r}
Mpana<-filter(BD1,Modelcor=="Panamera")
```

```{r}
Conf3x3 = matrix(c(1:9), nrow=3, byrow=F)
Conf3x3
```

Se generan los gráfricos por modelo de Porsche entre su precio y la cantidad de consumo de combustible en ciudad en L/100Km

```{r}
layout(Conf3x3)


options(scipen=3)
regre21<-plot(M718$Precio~M718$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo '718'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(M718$Precio~M718$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(M911$Precio~M911$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo '911'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(M911$Precio~M911$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(MBoxster$Precio~MBoxster$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo 'Boxster'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(MBoxster$Precio~MBoxster$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(MCayenne$Precio~MCayenne$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo 'Cayenne'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(MCayenne$Precio~MCayenne$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(MCayman$Precio~MCayman$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo 'Cayman'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(MCayman$Precio~MCayman$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(Macan$Precio~Macan$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo 'Macan'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(Macan$Precio~Macan$Consumo_Ciudad),col="blue",lty=1)

regre21<-plot(Mpana$Precio~Mpana$Consumo_Ciudad,pch=20,col=c("black","red"),main="Modelo 'Panamera'",xlab="Consumo en ciudad (L/100 km)",ylab="Precio ($)")
abline(lm(Mpana$Precio~Mpana$Consumo_Ciudad),col="blue",lty=1)
```

***Análisis del Gráfico***
-Pendiente positiva en los modelos: "718", "Cayenne", "Panamera" y "911".
Indica que presentan un comportamiento de crecimiento del precio respecto al consumo en ciudad.

-Pendiente  negativa en los modelos: "Cayman" y Boxster.
Puede indicar que existe un decaimiento de precio respecto al consumo en ciudad en el mercado de hoy en día, pero ello no se puede garantizar por los pocos datos que hay.

-Pendiente a tendencia nula en el modelo "Macan":
Indica que existe una cierta distribución central del precio en el gráfico respecto al consumo en ciudad.





Para verificar la correlación de estas 2 variables, se utiliza el comando cor():
```{r}
cor(BD1$Precio[BD1$Modelcor=="Cayenne"],BD1$Consumo_Ciudad[BD1$Modelcor=="Cayenne"])
cor(BD1$Precio[BD1$Modelcor=="911"],BD1$Consumo_Ciudad[BD1$Modelcor=="911"])
```
Visualmente los modelos "Cayenne" y "911", presentan una tendencia más cercana de crecimiento del precio respecto al consumo en ciudad. Pero con el comando cor() se observa que el modelo "Cayenne" presenta esta característica.

Se generan los gráfricos por modelo de Porsche entre su precio y la cantidad de consumo de combustible en carretera en L/100Km
```{r}
layout(Conf3x3)


options(scipen=3)
regre21<-plot(M718$Precio~M718$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo '718'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(M718$Precio~M718$Consumo_Carretera),col="blue",lty=1)

regre21<-plot(M911$Precio~M911$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo '911'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(M911$Precio~M911$Consumo_Carretera),col="blue",lty=1)

regre21<-plot(MBoxster$Precio~MBoxster$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo 'Boxster'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(MBoxster$Precio~MBoxster$Consumo_Carretera),col="blue",lty=1)

regre21<-plot(MCayenne$Precio~MCayenne$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo 'Cayenne'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(MCayenne$Precio~MCayenne$Consumo_Carretera),col="blue",lty=1)

regre21<-plot(MCayman$Precio~MCayman$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo 'Cayman'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(MCayman$Precio~MCayman$Consumo_Carretera),col="blue",lty=1)

regre21<-plot(Macan$Precio~Macan$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo 'Macan'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(Macan$Precio~Macan$Consumo_Carretera),col="blue",lty=1)

options(scipen=3)
regre21<-plot(Mpana$Precio~Mpana$Consumo_Carretera,pch=20,col=c("black","red"),main="Modelo 'Panamera'",xlab="Consumo en carretera (L/100 km)",ylab="Precio ($)")
abline(lm(Mpana$Precio~Mpana$Consumo_Carretera),col="blue",lty=1)
```

***Análisis del Gráfico***
-Pendiente positiva en los modelos: "718", "Cayenne", "Panamera" y "911".
Igual que el anterior gráfico indica el crecimiento del precio a medida que aumenta el consumo en carretera.

-Pendiente  negativa en los modelos: "Cayman" y Boxster.
Puede indicar que existe un decaimiento de precio respecto al consumo en carretera en el mercado de hoy en día, pero ello no se puede garantizar por los pocos datos que hay.

-Pendiente a tendencia nula en el modelo "Macan":
Indica que existe una cierta distribución central del precio en el gráfico respecto al consumo en carretera

Para verificar la correlación de estas 2 variables, se utiliza el comando cor():
```{r}
cor(BD1$Precio[BD1$Modelcor=="Cayenne"],BD1$Consumo_Carretera[BD1$Modelcor=="Cayenne"])
```
En este caso utilice del modelo "Cayenne", donde los datos presentan una tendencia más cercana de crecimiento del precio respecto al consumo en carretera, visualizando que los datos están más pegado a la linea y se confirma con el comando cor().


















