---
title: "PG2 - Informe"
output:
  html_document:
    toc: yes
    df_print: paged
  word_document:
    toc: yes
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    theme: yeti
  pdf_document:
    toc: yes
editor_options:
  markdown:
    wrap: sentence  
  
  
  html_document:
    df_print: paged
---

<center>

![](logoutec.png)

**Estadística y probabilidades I**

# **INTRODUCCIÓN**

### **Relevancia**

Este tema resulta de gran interés, puesto que la contaminación del aire esta en aumento cada vez más, trayendo consigo la destrucción del planeta y perjudicando la salud de las personas. Sin embargo, nosotros somos cómplices de este gran problema y no somos capaces de ayudar a reducir la contaminación. Y es ahí donde nos preguntamos ¿qué factores influyen en este tipo de contaminación?, pues como se sabe son varios los factores que repercuten en este problema como las industrias, los residuos, pero sobre todos la emisión de CO2 que producen los diferentes tipos de vehículos diariamente (cada ves va en aumento), generando mayor contaminación ambiental.
Por lo tanto, este proyecto permite identificar y entender como la contaminación de CO2 puede variar según las diferentes características que presenta un vehículo que es usado en Canadá. 
Teniendo esto en cuenta, un estudio estadístico con este tema podría ser de mucha ayuda para las organizaciones que buscan reducir el cambio climático, como también permitirá saber si disminuyendo la utilidad de los vehículos, se reducirá la contaminación del aire. Por ello, con toda la información que vamos a encontrar referente a este problema se podrá aplicar conclusiones y dar soluciones al mismo país de estudios que es Canadá e influyendo a otros países.

# **DATOS**

## **Recolección de datos**

El proceso de recolección de datos se dió a partir de la siguiente base de datos "[Emisiones de Dioxido de Carbono por Vehiculos en Canada](https://www.kaggle.com/datasets/debajyotipodder/co2-emission-by-vehicles)" de la página de Kaggle, donde elegimos el tema de la Emisión de dióxido de carbono, por la amplia información que nos brinda sobre la empresa de vehículos, modelo de auto, entre otros.

## **Población, muestra y muestreo**

-   Población

Son vehículos con diferentes características que emiten CO2 en Canadá.
La unidad muestral es la cantidad de porcentaje de CO2 emitido, que generan los distintos tipos de vehículos y su porcentaje de emisión de CO2 en los diferentes recorridos, ya sea por ciudad y carretera.

-   Muestra

El tamaño de la muestra tiene 7385 filas y 12 columnas, dándonos un total de 88,620 vehículos.
La muestra es muy amplia porque abarca sobre como las emisiones de CO2 de un vehículo puede variar dependiendo de las características que presente.

-   Muestreo

Muestreo aleatorio simple, porque se ha seleccionando un grupo de sujetos (la muestra) para luego realizar un estudio de un grupo más grande (la población).

## **Variables**

Identificamos diferentes tipos de cada variable categóricas y numéricas, con sus respectivas restricciones.

+ Variables Categóricas:

+-----------------------+--------------+-----------------+------------------------------------------------+
| **Variable**          | **Tipo**     |**Restricción**  |                Descripción                     |
+-----------------------+--------------+-----------------+------------------------------------------------+
| Compañía              | Nominal      |Tipo carácter    |Empresa de ventas de automóviles                |
+-----------------------+--------------+-----------------+------------------------------------------------+
| Clase                 | Nominal      |Tipo carácter    |Tipo de carrocería                              |
+-----------------------+--------------+-----------------+------------------------------------------------+
| Transmisión           | Nominal      |Tipo carácter    |Sistema de propulsión del motor con las ruedas  |
+-----------------------+--------------+-----------------+------------------------------------------------+
|Tipo de combustible    | Nominal      |X,Y,E,D y N      |Sustancias que liberan energía                  |
+-----------------------+--------------+-----------------+------------------------------------------------+

+ Variables Numéricas:

+-----------------------+--------+-----------------+-------------------------------------------------+
|**Variable**           |**Tipo**|**Restricción**  |                Descripción                      |
+-----------------------+--------+-----------------+-------------------------------------------------+
|Tamaño del motor       |Continua|Natural positivo |Volumen del motor.                               |
+-----------------------+--------+-----------------+-------------------------------------------------+
|Cilindros              |Discreta|Entero positivo  |Cámara donde se quema el combustible.            | 
+-----------------------+--------+-----------------+-------------------------------------------------+
|Consumo de combustible |Continua|Racional Positivo|Cantidad consumida de combustible                |
|en la ciudad (L/100 km)|        |                 |transcurriendo en la ciudad en (L/km).           |
+-----------------------+--------+-----------------+-------------------------------------------------+
|Consumo de combustible |Continua|Racional Positivo|Cantidad consumida de combustible                |  
|en carretera (L/100 km)|        |                 |transcurriendo en una carretera en (L/km).       | 
+-----------------------+--------+-----------------+-------------------------------------------------+
|Peine de consumo de    |Continua|Racional Positivo|Indicador de consumo de combustible por (L/km).  |
|combustible (L/100 km) |        |                 |                                                 |
+-----------------------+--------+-----------------+-------------------------------------------------+
|Peine de consumo de    |Continua|Racional Positivo|Indicador de consumo de combustible en por milla |   
|combustible (mpg)      |        |                 |por galón(mpg).                                  |      
+-----------------------+--------+-----------------+-------------------------------------------------+
|Emisiones de CO2 g/km) |Continua|Racional Positivo|Cantidad de C02en gramo emitido por kilómetro.   |
+-----------------------+--------+-----------------+-------------------------------------------------+

## **Limpieza de datos**

Explicaremos de manera concisa todos los criterios utilizados para poder garantizar que nuestra base de datos final, sirve para cumplir con los objetivos del proyecto.

*Librerías usadas:*

```{r}
library(readr) #Para leer el archivo
library(dplyr)
library(modeest) #Para la moda
library(ggplot2)
require("tidyverse")
```

**1. Leemos el archivo**

```{r}
datos <- read_csv("CO2EmisionesCanada.csv")
```

**2.  Cambiamos las variables**

```{r}
datos %>% rename(Marca = Make, Modelo = Model, ClaseVehiculo = `Vehicle Class`, TamañoMotor = `Engine Size(L)`, Cilindros = Cylinders, Transmision = Transmission, TipoCombustible = `Fuel Type`, CombustibleCiudad = `Fuel Consumption City (L/100 km)`, CombustibleCarretera = `Fuel Consumption Hwy (L/100 km)`, CombustibleCombinadoL = `Fuel Consumption Comb (L/100 km)`, CombustibleCombinadoM = `Fuel Consumption Comb (mpg)`, EmisionesCO2 = `CO2 Emissions(g/km)`) -> ft1
```

**3.  Filtracion de las marcas y clases más conocidas de vehículos Para realizar nuestra investigación. Seleccionamos los vehículos mas vendidos en el territorio canadiense.**

```{r}
ft1 <- filter(ft1,ft1$Marca == "TOYOTA" |ft1$Marca == "HYUNDAI"|ft1$Marca == "KIA"|ft1$Marca=="CHEVROLET"|ft1$Marca=="FORD"| ft1$Marca == "ACURA"| ft1$Marca == "TODOTERRENO"| ft1$Marca == "MITSUBISHI"| ft1$Marca == "NISSAN")
ft1 <-filter(ft1, ft1$ClaseVehiculo=="COMPACT"|ft1$ClaseVehiculo=="FULL-SIZE"|ft1$ClaseVehiculo=="MID-SIZE"|ft1$ClaseVehiculo== "SUV - STANDARD"| ft1$ClaseVehiculo=="SUV - SMALL"|ft1$ClaseVehiculo=="SUBCOMPACT")
```

**4.  Eliminación de modelo de autos, pues se trabajará con marcas de compañía:**

```{r}
ft1 <- select(ft1, -Modelo)
```

**5.  Con la base de datos formada, se realiza la observación de casos incompletos.**

```{r}
nrow(ft1) - sum(complete.cases(ft1)) # número de casos incompletos=0
```

+  Se determina que todos los datos están completos en el data frame

**6.  Variable ClaseVehiculo.**

+  Se visualiza la variable
  
```{r}
ft1 %>% count(ClaseVehiculo)
```

+  Se renombra la variable ClaseVehiculo para una mejor comprensión
  
```{r}

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="COMPACT"] <- "COMP"

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="FULL-SIZE"] <- "TG"

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="MID-SIZE"] <- "TM"

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="SUV - SMALL"] <- "SP"

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="SUV - STANDARD"] <- "SE"

ft1$ClaseVehiculo[ft1$ClaseVehiculo=="SUBCOMPACT"] <- "SC"

```

**7.  Variable Transmisión**

+  Se visualiza la variable Transmision, sin repeticiones
  
```{r}
unique(ft1$Transmision)
```

+  Para la variable Transmisión, se re nombra de la siguiente manera
  
```{r}
ft1$Transmision[ft1$Transmision=="A4"] <- "A"
ft1$Transmision[ft1$Transmision=="A5"] <- "A"
ft1$Transmision[ft1$Transmision=="A6"] <- "A"
ft1$Transmision[ft1$Transmision=="A8"] <- "A"
ft1$Transmision[ft1$Transmision=="A9"] <- "A"
ft1$Transmision[ft1$Transmision=="A10"] <- "A"
ft1$Transmision[ft1$Transmision=="AM6"] <- "AM"
ft1$Transmision[ft1$Transmision=="AM8"] <- "AM"
ft1$Transmision[ft1$Transmision=="AM7"] <- "AM"
ft1$Transmision[ft1$Transmision=="AS5"] <- "AS"
ft1$Transmision[ft1$Transmision=="AS6"] <- "AS"
ft1$Transmision[ft1$Transmision=="AS7"] <- "AS"
ft1$Transmision[ft1$Transmision=="AS8"] <- "AS"
ft1$Transmision[ft1$Transmision=="AS9"] <- "AS"
ft1$Transmision[ft1$Transmision=="AS10"] <- "AS"
ft1$Transmision[ft1$Transmision=="AV"] <- "AV"
ft1$Transmision[ft1$Transmision=="AV10"] <- "AV"
ft1$Transmision[ft1$Transmision=="AV6"] <- "AV"
ft1$Transmision[ft1$Transmision=="AV7"] <- "AV"
ft1$Transmision[ft1$Transmision=="AV8"] <- "AV"
ft1$Transmision[ft1$Transmision=="M5"] <- "M"
ft1$Transmision[ft1$Transmision=="M6"] <- "M"
```

+ Esto se hace debido a que se cuenta con la siguiente información:
    - A = Automático\
    - AM = Manual automatizado\
    - AS = Automático con selección de cambios\
    - AV = Continuamente variable\
    - M = Manual

**8.  Variable TipoCombustible**

+  Se visualiza la variable
  
```{r}
ft1 %>% count(TipoCombustible)
```

+  Se renombra los tipos de combustibles:
  
```{r}

ft1$TipoCombustible[ft1$TipoCombustible=="D"] <- "Diesel"

ft1$TipoCombustible[ft1$TipoCombustible=="Z"] <- "G.Premium"

ft1$TipoCombustible[ft1$TipoCombustible=="X"] <- "G.Regular"

ft1$TipoCombustible[ft1$TipoCombustible=="E"] <- "Etanol"

ft1$TipoCombustible[ft1$TipoCombustible=="N"] <- "G.Natural"

```

Con estos cambios, se empezará a trabajar con la base de datos.

# **ANÁLISIS DESCRIPTIVO**

*Funciones que se usaran en el proceso:*

```{r}
r <- function(x){
    round(x,2) # Redondear a 2 decimales
}
```

```{r}
cv <- function(x){
  sd(x)/mean(x) # Hallar el coeficiente de variación
}
```

Para esta sección, se realiza el análisis de cada variable y luego se busca la relación entre estas. Para ello, se hará uso de los descriptores numéricos y gráficos.

## **Descriptores numéricos y gráficos**

### **1. Variable Marca**

a) **Cantidad de los vehículos de las marcas ACURA, CHEVROLET, FORD, HYUNDAI, KIA, MITSUBISHI, NISSAN y TOYOTA.**\
```{r}
table(ft1$Marca) 
```

b) **Porcentaje que toma cada marca del total de vehículos.**\
```{r}
r(prop.table(table(ft1$Marca))*100)
```
-  **Interpretación:**\
Se determina que la marca más usada es FORD, que ocupa el 22.28% del total con 363 Vehículos y la menos usada es ACURA, que ocupa el 4.24% del total con 69 vehículos.

c) **Gráfica**\
    La variable "Marca", se representa en el siguiente gráfico:

```{r}
ggplot(ft1, aes(x = Marca , fill = Marca)) + geom_bar(width = 0.8, color = "maroon2") + ggtitle("Marca de Vehiculos") + ylab("Frecuencia absoluta") + ylim(0,400)
```

-   Interpretación de datos obtenidos:
    -   FORD es la marca con mayor cantidad de vehículos, ya que ocupa 363 vehículos y luego le sigue CHEVROLET quien se diferencia por un vehículo en cantidad.\
    -   Las valores se aprecian mejor en las tablas que en las gráficas
    -   Al haber solo un valor que mas se repite, la variable Marca es unimodal.

### **2. Variable Clase**

a) **Esta variable indica la clase de vehículo según su tamaño. Donde:**\
    -   COMP: Vehículo compacto.\
    -   TG: Vehículo tamaño grande.\
    -   TM: Vehículo tamaño medio\
    -   SP: Vehículo suv pequeño.\
    -   SE: Vehículo suv estándar que es de tamaño promedio.\
    -   SC: Vehículo Suv compacto.\
    
b) **Cantidad de vehículo por clase:**\

```{r}
table(ft1$ClaseVehiculo)
```

c) **Porcentaje de cada clase del total de vehículos:**\

```{r}
r(prop.table(table(ft1$ClaseVehiculo))*100)
```

d) **Datos obtenidos de mayor a menor:**\
    -   Hay 435 vehículos suv pequeños que son 26.70% del total.
    -   Hay 357 vehículos de tamaño mediano que son el 21.92% del total.
    -   Hay 312 vehículos compactos que son el 19.15% del total.
    -   Hay 222 vehículos suv estándar que son el 13.63% del total.
    -   Hay 153 vehículos de tamaño grande que son el 9.39% del total.
    -   Hay 150 vehículos suv compactos que son el 9.21% del total.\
        Se obtiene que el tamaño del vehículo mas usado es el SP (vehículo suv pequeño), ocupando un 26.70% del total con 435 vehículos y el modelo menos usado es el SC (vehículo suv compacto), ocupando un 9.21% del total con 150 vehículos.
        
e) **Gráfico:**\

```{r}
barplot(prop.table(table(ft1$ClaseVehiculo)),  main = "Clase de vehículos", xlab = "Clase de vehículo", ylab = "Frecuencia relativa", col=c("orange1","pink1","cadetblue1","brown1","seagreen1", "darkorchid1")) 
legend("topright", "Moda", fill = "brown1")
```

-   **Interpretación:**\
    -   La gráfica muestra que realmente los vehículos de clase *SP* (color rojo) ocupan mayor cantidad, sin embargo no se puede apreciar la clase de vehículo con menor cantidad. Debido a ello, se recurre a las tablas creadas anteriormente y se afirma que el vehículo menos usado es de clase **Sc** (color rosado).
    -   La variable ClaseVehiculo es unimodal, debido a que su moda es unicamente los vehiculos de clase suv pequeño

### **3. Variable Transmisión**\

a) **Esta variable indica la forma en la que se lleva el movimiento de las llantas, donde:**\
    -   A: Automático\
    -   AM: Manual automatizado\
    -   AV: Vehículos autónomos\
    -   AS: Automático con cambio seleccionado\
    -   M: Manual\
    
b) **Cantidad de cada tipo:**\

```{r}
table(ft1$Transmision)
```

c) **Porcentaje de toma cada transmisión de los vehículos:**\

```{r}
r(prop.table(table(ft1$Transmision))*100)
```

d) **Datos obtenidos de mayor a menor:**\
    -   Hay 743 de tipo automático con cambio acelerado, que son el 45.61% del total.\
    -   Hay 311 de tipo manual, que abarcan el 19.09% del total.\
    -   Hay 255 de tipo vehículos autónomos, que son el 15.65% del total.
    -   Hay 231 de tipo automático, que ocupan el 14.18% del total
    -   Hay 89 de tipo manual automatizado, que son el 5.46% del total.\
    
e) **La variable "Transmisión", se representa en el siguiente gráfico:**\

```{r}
barplot(prop.table(table(ft1$Transmision)), main = "Transmisión", xlab = "Transmisión", ylab = "Frecuencia relativa",col=c("cyan1","yellow","hotpink","firebrick1","olivedrab1"))
legend("topright", "Moda", fill = "hotpink")
```

-   Observamos que la moda son los vehículos con transimisión Automático con cambio seleccionado, debido a ello se puede afirmar que la clase Transmision es unimodal.

### **4. Variable TipoCombustible**

a) **Indica el tipo de combustible que utiliza el vehículo para poder movilizarse. Donde:**\
    -   G.Regular: Gasolina regular.\
    -   G.Premium: Gasolina premium.\
    -   G.Natural: Gas natural.\
    
b) **Visualizamos la variable**\

```{r}
ft1 %>% count(TipoCombustible)
```

c) **Hallamos los porcentajes de cada tipo de combustible**\

```{r}
r(prop.table(table(ft1$TipoCombustible))*100) #porcentajes de cada tipo de combustible
```

d) **Datos obtenidos de mayor a menor:**\
    -   Hay 1345 vehiculos que usan Gas regular de combustible, que son el 82.57% del total.
    -   Hay 186 vehiculos que usan Gas Premium, que son el 11.42% del total.
    -   Hay 186 vehiculos que usan Etanol de combustible, que son el 5.10% del total.\
    -   Hay 14 vehiculos que usan Diesel de combustible, que son el 0.86% del total.\
    -   Hay 1 vehiculo que usan Gas Natural, el cual es el 0.06% del total.\
    
e) **Con respecto a la variable "Tipo de combustible", tenemos el siguiente gráfico:**\

```{r}
barplot(prop.table(table(ft1$TipoCombustible)), main = "Tipo de combustible", xlab = "Combustible", ylab="Frecuencia relativa", ylim = c(0.00,1), col=c("lightsalmon","lightblue2","gold1","coral1","darkolivegreen2"))
legend("topright", "Moda", fill = "darkolivegreen2")
```

-   **Interpretación de los datos:**\
    -   El combustible más usado es la gasolina regular con un 82.57% del total con un valor de 1345 vehículos y el menos usado es el Gas natural con un 0.06% en 1 solo vehículo.\
    -   La clase TipoCombustible es unimodal, debido a que tiene una sola moda

### **5. Variables CombustibleCiudad**\
    Esta variable me indica el consumo de combustible, por vehículo, usado en la ciudad en litros por cada 100 km recorridos.

a) **Descriptores numéricos:**\

  + Mediana:

```{r}
median(ft1$CombustibleCiudad)
``` 
    
  + Media o promedio:

```{r}
mean(ft1$CombustibleCiudad)
```

  + Cuartil:

```{r}
quantile(ft1$CombustibleCiudad)
```
       
  + Moda:

```{r}
mfv(ft1$CombustibleCiudad)
```
   
  + Mínimo:

```{r}
r(min(ft1$CombustibleCiudad))
```

  + Máximo:

```{r}
r(max(ft1$CombustibleCiudad))
```

  + Rango:

```{r}
r(max(ft1$CombustibleCiudad)) - r(min(ft1$CombustibleCiudad))
```
   
  + Desviación estándar:

```{r}
r(sd(ft1$CombustibleCiudad))
```

  + Coeficiente de variación:

```{r}
r(cv(ft1$CombustibleCiudad))
```

b) **Descriptores Gráficos:**\

 + La variable "CombustibleCiudad", se representa con el siguiente gráfico:\

```{r}
    hist(ft1$CombustibleCiudad, breaks = 40, prob = T, main = "Combustible en la Ciudad en L/100 km", xlab = "Combustible", ylab = "Frecuencia relativa", ylim = c(0,0.2), xlim = c(0,27), col = "darkgoldenrod1")
```

 + **Gráfica de dos variables: CombustibleCiudad vs TamañoMotor:**\

```{r}
    plot(ft1$TamañoMotor, ft1$CombustibleCiudad, pch = 19, col = rgb(0,0,0,0.2), main = "Variable Combustible Ciudad vs Tamaño Motor", ylab = "Combustible Ciudad", xlab = "Tamaño motor")
    abline(lm(ft1$CombustibleCiudad ~ ft1$TamañoMotor), col = "red")
```

 + Según la gráfico hallamos:\

   - Coeficiente de Correlacion lineal, que indica el grado de asociación, y la Recta de regresión lineal\

```{r}
    cor(ft1$CombustibleCiudad, ft1$TamañoMotor) #Correlacion
    lm(ft1$CombustibleCiudad ~ ft1$TamañoMotor) #Regresion lineal
```
La recta de regresión lineal es: y = 2.2x + 5.24

- **Interpretación:**\
    La correlacion obtenida nos indica una asociacion lineal fuerte y positiva. Asimismo podemos decir que a mayor tamaño del motor, mayor es el consumo de combustible en la ciudad en L/100 km.

### **6. V. ConsumoCombinado (L/km)**\
    Esta variable me representa el consumo combinado de combustible (55% ciudad, 45% carretera) en L por 100 km recorridos.\

a) **Descriptores numéricos:**\

 + Mediana:

```{r}
r(median(ft1$CombustibleCombinadoL))
```

 + Media o promedio:

```{r}
r(mean(ft1$CombustibleCombinadoL))
```

 + Cuartil:

```{r}
quantile(ft1$CombustibleCombinadoL)
```

 + Moda:

```{r}
mfv(ft1$CombustibleCombinadoL)
```

 + Mínimo:

```{r}
r(min(ft1$CombustibleCombinadoL))
```

 + Máximo:

```{r}
r(max(ft1$CombustibleCombinadoL))
```

 + Rango:

```{r}
r(max(ft1$CombustibleCombinadoL)) - r(min(ft1$CombustibleCombinadoL))
```

 + Desviación estándar:

```{r}
r(sd(ft1$CombustibleCombinadoL))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$CombustibleCombinadoL))
```

b) **Descriptores Gráficos:**\

 + La variable CombustibleCombinadoL, se representa en el siguiente gráfico:\

```{r}
    hist(ft1$CombustibleCombinadoL, breaks = 30, prob = T, main = "Combustible Combinado en L/100 km", xlab = "Combustible Combinado", ylab = "Frecuencia relativa", ylim = c(0,0.2), xlim = c(0,25), col = "deeppink1", border = "springgreen")
```

 + **Gráfica de dos variables: "CombustibleCombinadoL" vs Cilindros**\

```{r}
    plot(ft1$Cilindros, ft1$CombustibleCombinadoL, pch = 19, col = rgb(0,0,0,0.2), main = "Combustible Combinado en L/100 km vs Cilindros", ylab = "Combustible Combinado", xlab = "Numero de Cilindros")
    abline(lm(ft1$CombustibleCombinadoL ~ ft1$Cilindros), col = "red")
```

 + Para complementar la información:

    - Se halla el coeficiente de Correlación lineal, que indica el grado de asociación, y la Recta de regresión lineal

```{r}
cor(ft1$CombustibleCombinadoL, ft1$Cilindros) #Correlacion
lm(ft1$CombustibleCombinadoL ~ ft1$Cilindros) #Regresion lineal
```
La recta de regresión lineal es y = 1.56x + 2.22

- **Interpretación:**\
    La correlación obtenida nos indica una asociación lineal fuerte y positiva. Asimismo podemos decir que a mayor numero de cilindros, mayor es el consumo de combustible combinado en L/100 km.

### **7. Variable TamañoMotor**

Indica el Tamaño del motor del vehículo, en litros.

a) **Descriptores numéricos:**\

 + Moda:

```{r}
r(mfv(ft1$TamañoMotor))
```

 + Media:

```{r}
r(mean(ft1$TamañoMotor))
```

 + Mediana:

```{r}
r(median(ft1$TamañoMotor))
```

 + Rango Intercuartil:

```{r}
r(IQR(ft1$TamañoMotor))
```

 + Mínimo:

```{r}
r(min(ft1$TamañoMotor))
```

 + Máximo:

```{r}
r(max(ft1$TamañoMotor))
```

 + Rango:

```{r}
r(max(ft1$TamañoMotor)) - r(min(ft1$TamañoMotor))
```

 + Desviación estándar:

```{r}
r(sd(ft1$TamañoMotor))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$TamañoMotor))
```

 + Cuartiles:

```{r}
quantile(ft1$TamañoMotor)
```

b) **Descriptores gráficos:**\

 + La variable Tamaño del motor se representa en el siguiente histograma:\

```{r}
    hist(ft1$TamañoMotor, prob = T, breaks = 40, main = "Tamaño del Motor", xlab = "Tamaño", ylab = "Frecuencia relativa", ylim = c(0,1), xlim = c(0,7), col = "olivedrab1", border = "tomato")
```

- **Interpretación:**\

   -   A mayor breaks que se le coloque a la grafica, se podrá apreciar mejor los valores que contiene la variable TamañoMotor.\
   -   La variable TamañoMotor es unimodal, ya que su moda es el tamaño de motor de 2 litros.

### **8. Variable Cilindros**
    Esta variable indica los cilindros que tiene el vehículo para quemar el combustible. En otras palaras, para impulsar al motor del vehículo.

a) **Descriptores numéricos:**\

 + Moda:

```{r}
r(mfv(ft1$Cilindros))
```

 + Media:

```{r}
r(mean(ft1$Cilindros))
```

 + Mediana:

```{r}
r(median(ft1$Cilindros))
```

 + Rango intercuartil:

```{r}
r(IQR(ft1$Cilindros))
```

 + Valor Mínimo:

```{r}
r(min(ft1$Cilindros))
```

 + Valor Máximo:

```{r}
r(max(ft1$Cilindros))
```

 + Desviación estándar:

```{r}
r(sd(ft1$Cilindros))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$Cilindros))
```

b) **Descriptores gráficos:**\

 + Gráfico de la variable cilindro:\

```{r}
    barplot(prop.table(table(ft1$Cilindros)), main = "Numero de cilindros", xlab = "Cilindros", ylab="Frecuencia relativa", ylim = c(0.00,0.80), col=c("orchid1","palegreen","gold", "dodgerblue"))
```

- **Interpretación:**\

  -   La variable Cilindros es unimodal.\
  -   Los vehículos mayormente tienen 4 cilindros que impulsan al motor.\

### **9. Variable CombustibleCarretera**\
    Esta variable me indica el consumo de combustible, por vehículo, usado en carretera en litros por cada 100 km recorridos.

a) **Descriptores numéricos:**\

 + Mediana:

```{r}
median(ft1$CombustibleCarretera)
```

 + Media o promedio:

```{r}
mean(ft1$CombustibleCarretera)
```

 + Cuartil:

```{r}
quantile(ft1$CombustibleCarretera)
```

 + Moda:

```{r}
mfv(ft1$CombustibleCarretera)
```

 + Máximo:

```{r}
r(max(ft1$CombustibleCarretera))
```

 + Mínimo:

```{r}
r(min(ft1$CombustibleCarretera))
```

 + Rango:

```{r}
r(max(ft1$CombustibleCarretera)) - r(min(ft1$CombustibleCarretera))
```

 + Rango intercuartil:

```{r}
r(IQR(ft1$CombustibleCarretera))
```

 + Desviación estándar:

```{r}
r(sd(ft1$CombustibleCarretera))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$CombustibleCarretera))
```

b) **Descriptores gráficos:**\

 + Se representa mediante un histograma:\

```{r}
    hist(ft1$CombustibleCarretera, breaks = 20, prob = T, main = "Combustible en Carretera en L/100 km", xlab = "Combustible", ylab = "Frecuencia relativa", ylim = c(0,0.25), xlim = c(0,20), col = "tan3", border = "#00F5FF")
```

 + También puede representarse mediante un grafico boxplot:\

```{r}
boxplot(ft1$CombustibleCarretera, horizontal = T, main = "Combustible en Carretera en L/100 km")
```

Se observa que hay varios valores atipicos.

 + **Gráfica de dos variables: "CombustibleCarretera" vs "TamañoMotor"**\

```{r}
plot(ft1$TamañoMotor, ft1$CombustibleCarretera, pch = 19, col = rgb(0,0,0,0.15), main = "Combustible en Carretera en L/100 km vs Emisiones de CO2 en g/km", ylab = "Combustible en Carretera", xlab = "Emisiones de CO2")
abline(lm(ft1$CombustibleCarretera ~ ft1$TamañoMotor), col = "red")
```

-   Para realizar una mejor interpretación, se halla lo siguiente:

  -  Coeficiente de Correlación lineal, que indica el grado de asociación, y la Recta de regresión lineal

```{r}
    cor(ft1$CombustibleCarretera, ft1$TamañoMotor) #Correlacion
    lm(ft1$CombustibleCarretera ~ ft1$TamañoMotor) #Regresion lineal
```
La recta de regresión lineal es y = 1.295x + 4.72\

- **Interpretación:**\
    La correlacion obtenida nos indica una asociacion lineal fuerte y positiva. Asimismo podemos decir que a mayor tamaño del motor, mayor es el consumo de combustible en Carretera en L/100 km.

### **10. V. CombustibleCombinadoM**\
    Esta variable me indica el consumo combinado de combustible tanto en ciudad como en carretera en millas por galón (mpg)

a) **Descriptores numéricos:**\

 + Mediana:

```{r}
r(median(ft1$CombustibleCombinadoM))
```

 + Media o promedio:

```{r}
r(mean(ft1$CombustibleCombinadoM))
```

 + Cuartil:

```{r}
quantile(ft1$CombustibleCombinadoM)
```

 + Moda:

```{r}
mfv(ft1$CombustibleCombinadoM)
```

 + Máximo:

```{r}
r(max(ft1$CombustibleCombinadoM))
```

 + Mínimo:

```{r}
r(min(ft1$CombustibleCombinadoM))
```

 + Rango:

```{r}
r(max(ft1$CombustibleCombinadoM)) - r(min(ft1$CombustibleCombinadoM))
```

 + Rango intercuartil:

```{r}
r(IQR(ft1$CombustibleCombinadoM))
```

 + Desviación estandar:

```{r}
r(sd(ft1$CombustibleCombinadoM))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$CombustibleCombinadoM))
```

b) **Descriptores gráficos:**\

 + Se representa mediante un histograma:\

```{r}
    hist(ft1$CombustibleCombinadoM, breaks = 40, prob = T, main = "Combustible Combinado en MPG", xlab = "Combustible Combinado", ylab = "Frecuencia relativa", ylim = c(0,0.06), xlim = c(10,70), col = "darkslategray1", border = "darkorchid")
```

 + Tambien puede representarse mediante un grafico boxplot:\

```{r}
boxplot(ft1$CombustibleCombinadoM, horizontal = T, main = "Combustible combinado en MPG")
```

Se observa que hay 10 valores atipicos.

 + **Grafico de dos variables: "CombustibleCombinadoM" vs "TamañoMotor**"\

```{r}
plot(ft1$TamañoMotor, ft1$CombustibleCombinadoM, pch = 19, col = rgb(0,0,0,0.15), main = "Combustible en Carretera en L/100 km vs Emisiones de CO2 en g/km", ylab = "Combustible Combinado", xlab = "Tamaño Motor")
abline(lm(ft1$CombustibleCombinadoM ~ ft1$TamañoMotor), col = "red")
```

-   Para realizar una mejor interpretacion, se halla lo siguiente:

  -   Coeficiente de Correlacion lineal, que indica el grado de asociación, y la Recta de regresión lineal

```{r}
    cor(ft1$CombustibleCombinadoM, ft1$TamañoMotor) #Correlacion
    lm(ft1$CombustibleCombinadoM ~ ft1$TamañoMotor) #Regresion lineal
```
La recta de regresión lineal es y = -4.9x + 44.06

- **Interpretación:**\
    La correlacion obtenida nos indica una asociacion lineal media fuerte y negativa Asimismo podemos decir que a mayor tamaño del motor, menor es el consumo de combustible en Carretera en L/100 km y viceversa.

### **11. Variable EmisionesCO2**\
    Esta variable me indica las emisiones de dióxido de carbono del tubo de escape (en gramos por kilómetro) para la conducción combinada en ciudad y carretera.

a) **Descriptores numéricos:**\

 + Mediana:

```{r}
r(median(ft1$EmisionesCO2))
```

 + Media o promedio:

```{r}
r(mean(ft1$EmisionesCO2))
```

 + Cuartil:

```{r}
quantile(ft1$EmisionesCO2)
```

 + Moda:

```{r}
mfv(ft1$EmisionesCO2)
```

 + Máximo:

```{r}
r(max(ft1$EmisionesCO2))
```

 + Mínimo:

```{r}
r(min(ft1$EmisionesCO2))
```

 + Rango:

```{r}
r(max(ft1$EmisionesCO2)) - r(min(ft1$EmisionesCO2))
```

 + Rango intercuartil:

```{r}
r(IQR(ft1$EmisionesCO2))
```

 + Desviación estándar:

```{r}
r(sd(ft1$EmisionesCO2))
```

 + Coeficiente de variación:

```{r}
r(cv(ft1$EmisionesCO2))
```

b) **Descriptores gráficos:**\

 + Se representa mediante un histograma:\

```{r}
    hist(ft1$EmisionesCO2, breaks = 40, prob = T, main = "Emisiones de CO2 en g/mpg", xlab = "Emisiones CO2", ylab = "Frecuencia relativa", ylim = c(0,0.01), xlim = c(50,450), col = "plum1", border = "red")
```

Obtenemos que lo emitido con mayor frecuencia es una cantidad de 184 g/km. La máxima cantidad emitida es de 392 g/km, el mínimo es de 96 g/km. El valor central se encuentra en 216 g/km y el promedio emitido es de 222,8 g/km.

```{r}
boxplot(ft1$EmisionesCO2, horizontal = T, main = "Combustible Emisiones es CO2")
```

Se observa que hay algunos cuantos valores atipicos.

 + **Gráfico de dos variables: "Marca" vs "EmisionesCO2"**\
 
 Vamos a ver cual de las marcas de vehículo emite mayor cantidad de CO2 y cual es la que emite menos.
 
 Se realiza un gráfico (boxplot):
 
```{r}
boxplot(ft1$EmisionesCO2~ ft1$Marca, main= "Emisión de Co2 vs Marca de vehículo", xlab= "Marca de vehículo", ylab = "Emisión de CO2 (g/km)", col= c("plum1","red1","green","orange", "yellow", "tan3", "darkslategray1"), las = 3)
```

Como se puede observar la marca que mas emisión de CO2 presenta es CHEVROLET y la marca que emite menos cantidad de CO2 es MITSUBISHI.


 + **Gráfico de dos variables: "TipoCombustible vs EmisionesCO2"**\

Se quiere saber que tipo de combustible es más contaminante. Para ello se busca la relación entre las variables  **TipoCombustible** y **EmisionesCO2**

Se realiza el siguiente gáfico(boxplot)

```{r}
boxplot(ft1$EmisionesCO2~ ft1$TipoCombustible, main= "Emisión de Co2(g/100km) vs Tipo de combustible", xlab= "Tipo de combustible", ylab = "Emisión de CO2 (g/km)", col= c("blue","red","green","orange","pink"), las = 3)
```
- La Gasolina premium es el combustible que más emite CO2, presenta una concentración mayor de Co2, 100 g/km , desde 225 g/km a 325 g/km de CO2 emitido. El máximo es 386 g/km y el mínimo de 210 g/km de emisión de CO2. La mediana se encuentra alrededor de 290(g/km) de Co2 emitido.

- El "gas natural" es el combustible que menos emite CO2, con menor concentración de CO2, 5 g/km, desde 210 g/km a  215 g/km de CO2 emitido. El máximo es 215 g/km y el mínimo es 210 g/km de CO2 emitido. La mediana esta al rededor de 212.5 g/km de CO2 emitido. 



 + **Gráfico de dos variables: "EmisionesCO2" vs "TamañoMotor"**\

```{r}
plot(ft1$TamañoMotor, ft1$EmisionesCO2, pch = 19, col = rgb(0,0,0,0.15), main = "Emisiones de CO2 (g/mpg) vs Tamaño Motor ", ylab = "Emisiones CO2", xlab = "Tamaño Motor")
abline(lm(ft1$EmisionesCO2 ~ ft1$TamañoMotor), col = "red")
```

-   Se halla lo siguiente para realizar una mejor interpretación:

  -   Coeficiente de Correlación lineal, que indica el grado de asociación, y la Recta de regresión lineal

```{r}
    cor(ft1$EmisionesCO2, ft1$TamañoMotor) #Correlacion
    lm(ft1$EmisionesCO2 ~ ft1$TamañoMotor) #Regresion lineal
```
La recta de regresión lineal es y = 36.55x + 125.45\

- **Interpretación:**\
    La correlacion obtenida nos indica una asociacion lineal fuerte y positiva. Asimismo podemos decir que a mayor tamaño del motor, mayor son las emisiones de CO2 y viceversa.

 + **Gráfico de dos variables: "EmisionesCO2" vs "Cilindros"**\

```{r}
plot(ft1$Cilindros, ft1$EmisionesCO2, pch = 19, col = rgb(0,0,0,0.15), main = "Emisiones de CO2 (g/mpg) vs Cilindros ", ylab = "Emisiones CO2", xlab = "Cilindros")
abline(lm(ft1$EmisionesCO2 ~ ft1$TamañoMotor), col = "red")
```

-   Se halla lo siguiente para realizar una mejor interpretación:

   -   Coeficiente de Correlación lineal, que indica el grado de asociación, y la Recta de regresión lineal

```{r}
    cor(ft1$EmisionesCO2, ft1$Cilindros) #Correlacion
    lm(ft1$EmisionesCO2 ~ ft1$Cilindros) #Regresion lineal
```
La recta de regresión lineal es y = 31.52x + 69.66\

-   **Interpretación:**\
    La correlacion obtenida nos indica una asociacion lineal fuerte y positiva. Asimismo podemos decir que a mayor numeros de cilindros, mayor son las emisiones de CO2 y viceversa.

# **ANÁLISIS PROBABILÍSTICO**

## **Variables Aleatorias y Distribuciones**

### **1. Variable Aleatoria Continua - Distribución Normal**


**A. Variable EmisionesCO2**

  +  Realizamos un gráfico que nos ayuda a observar función de densidad de esta variable(EmisionesCO2): 

```{r}
hist(ft1$EmisionesCO2, breaks = 50,freq = FALSE, main = "Emision Co2: Distribucion normal", xlab = "Emision Co2 g/km", col = "pink")
lines(density(ft1$EmisionesCO2, na.rm = TRUE), col = "orange3", lwd = 2)
curve(dnorm(x,mean(ft1$EmisionesCO2, na.rm = TRUE), sd(ft1$EmisionesCO2, na.rm = TRUE)),lwd = 2, col = "green2", add = T)
legend("topleft", c("C.O", "C.N.T"),lty = 1, lwd = 2, col = c("orange3", "green2"), bty = "n", cex = 0.8)
```
Donde:

- C.N.T : Curva Normal Teórica
- C.O : Curva Observada

También se calcula el promedio, la mediana y la desviación Estándar de esta variable.

+  Promedio:
```{r}
r(mean(ft1$EmisionesCO2, na.rm = TRUE)) ## Promedio
```
El promedio es 222.8 g/km

+  Desviación Estandar:
```{r}
r(sd(ft1$EmisionesCO2, na.rm = TRUE))
```
La desviación estandar es 53,52.

En el gráfico muestra que la Curva Observada (curva de color naranja) se asemeja relativamente a la Curva Normal Teórica (Curva de color verde).


<center>
**CASO PARA EL CÁLCULO DE PROBABILIDAD:**
</center>
Sea una variable aleatoria "X" con una distribución normal --> $$ X \sim N(233.8,53.52)$$

El 2020 ha comenzado con la entrada en vigor de una nueva normativa europea que limita las emisiones de dióxido de carbono (CO2) de los vehículos ligeros. Así, a partir de ese año, los fabricantes solo podrían vender coches cuyas emisiones no superen los 95 gramos de CO2 por kilómetro recorrido. Aquí se establece que para 2020, todos los vehículos nuevos no deberán emitir más de 147 gramos de CO2 por kilómetro. Debido a esto en el caso calcularemos la probabilidad de que el CO2 emitido sea mayor a 147 g/Km, de esta forma sabremos que cantidad de vehículos emiten mayores cantidades de CO2 a las permitidas. 

**a. ¿Que tan probable es que el CO2 emitido supere los 147 g/km?**
```{r}
r(pnorm(147, mean = 222.8, sd = 53.52, lower.tail = F))
```
+ La probabilidad de que el CO2 emitido supere los 147 g/km es del 92%.

Obtenemos un valor del 99% de todos los vehículos tienen una emisión mayor a 147 g/Km, un alto porcentaje de vehículos contaminando nuestra atmósfera. 

En general, en un coche de gama media un litro de combustible sirve para recorrer entre 12 y 14 kilómetros como media. Es decir, entre 7 y 8 litros por cada 100 kilómetros recorridos, con emisiones entre 165.45 g/km y 189.09 g/km por cada 100 km recorridos. Para los conductores de utilitarios o vehículos con motor de gasolina, esto supone una reducción del consumo de combustible a solo 5,5 litros de gasolina por cada 100 kilómetros y unas emisiones de CO2 de 130 gr/km. Estableciendo un límite máximo de consumo de combustible en ambos tipos de recorrido, ya sea consumo en ciudad o carretera, un límite de 8 L/100 km, para calcular en cual de estos recorridos hay una mayor cantidad de emisión de CO2. Con esto trabajamos en base a las variables **CombustibleCiudad** y **CombustibleCarretera** y calculamos que tan probable es que se consuma una cantidad mayor a 8 L/100km.


**B. Variable CombustibleCiudad (Consumo de Combustible en Ciudad)**

Calculamos el promedio y la desviación estándar:
```{r}
r(mean(ft1$CombustibleCiudad))

r(sd(ft1$CombustibleCiudad))
```
Promedio de 11.11 L/100 km

- La desviación estándar es de 3.28 

- Para observar la función de densidad de la variable realizamos el siguiente gráfico:
```{r}
hist(ft1$CombustibleCiudad, breaks = 0:25,freq = FALSE, main = "Distribución Normal: Consumo de combustible en Ciudad", xlab = "Consumo en ciudad L/100 km", col = "darkslategray1")
lines(density(ft1$CombustibleCiudad, na.rm = TRUE), col = "blue2", lwd = 2)
curve(dnorm(x,mean(ft1$CombustibleCiudad, na.rm = TRUE), sd(ft1$CombustibleCiudad, na.rm = TRUE)),lwd = 2, col = "green3", add = T)
legend("topleft", c("C.O", "C.N.T"),lty = 1, lwd = 2, col = c("blue2", "green3"), bty = "n", cex = 0.8)
```
Donde:

- C.O : Curva observada (Curva de color azul)
- C.N.T : Curva Normal Teórica (Curva de color verde)

Del gráfico podemos decir que la Curva Observada se asemeja relativamente a la Curva Normal Teórica.


<center>
**CASO PARA EL CÁLCULO PROBABILÍSTICO**
</center>
Sea una variable aleatoria "X" con una distribución normal --> $$ X \sim N(11.11,3.28)$$

**a. ¿Qué tan probable es que el consumo de combustible en ciudad supere los 8 L/Km?**

```{r}
r(pnorm(8, mean = 11.11, sd = 3.28, lower.tail = F)) # Probabilidad
```
+ La probabilidad de que el consumo de combustible en ciudad supere los 8 L/100 km es del 83%.

+ Obtenemos que un valor del 83% de consumo de combustible en ciudad supera los 8 L/100 km.


**C. Variable CombustibleCarretera (Consumo de Combustible en Carretera)**

Calculamos el promedio y la desviación estándar:
```{r}
r(mean(ft1$CombustibleCarretera))

r(sd(ft1$CombustibleCarretera))
```
Promedio de 8.16 L/100 km

- La desviación estándar es de 2.02

- Para observar la función de densidad de la variable realizamos el siguiente gráfico:
```{r}
hist(ft1$CombustibleCarretera, breaks = 0:25,freq = FALSE, main = "Distribución Normal: Consumo de combustible en Carretera", xlab = "Consumo en carretera L/100 km", col = "darkslategray1")
lines(density(ft1$CombustibleCarretera, na.rm = TRUE), col = "blue2", lwd = 2)
curve(dnorm(x,mean(ft1$CombustibleCarretera, na.rm = TRUE), sd(ft1$CombustibleCarretera, na.rm = TRUE)),lwd = 2, col = "green3", add = T)
legend("topleft", c("C.O", "C.N.T"),lty = 1, lwd = 2, col = c("blue2", "green3"), bty = "n", cex = 0.8)
```
Donde:

- C.O : Curva observada (Curva de color azul)
- C.N.T : Curva Normal Teórica (Curva de color verde)

Del gráfico podemos decir que la Curva Observada se asemeja relativamente a la Curva Normal Teórica.


<center>
**CASO PARA EL CALCULO PROBABILISTICO**
</center>
Sea una variable aleatoria "X" con una distribución normal --> $$ X \sim N(8.16,2.02)$$

**a. ¿Qué tan probable es que el consumo de combustible en carretera supere los 8 L/100 km?**

```{r}
r(pnorm(8, mean = 8.16, sd = 2.02, lower.tail = F)) # Probabilidad
```
La probabilidad de que el consumo de combustible en carretera supere los 8 L/100 km es del 53%.

Obtenemos que un valor del 53% del consumo de combustible en carretera supera los 8 L/100 km.


### **2. Variables Aleatoria Discreta - Distribución Geométrica**

**A. Variable Combustible**

Sabemos que de toda la muestra tomada el combustible más contaminante, ya que emite una cantidad mayor de Dióxido de Carbono a la atmósfera y el segundo más utilizado  es la gasolina premium. Se modela un experimento que sigue una distribución geométrica. Se determina las veces que se repite hasta dar con un vehículo usuario de este combustible.

```{r}
table(ft1$TipoCombustible)  # Tabla de usuarios de combustibles 
```

Hay un total de 1629 vehículos de los cuales 186 usan el combustible Gasolina Premium.

- Definimos el espacio muestral --> ("Gasolina premium", "Otro")

Se definen los casos:

a. CASO DE EXITO: Vehículos usuarios de combustible Gasolina Premium
b. CASO DE FRACASO: vehículos usuarios de otro combustible.

```{r}
probabilidad_de_exito <- r(sum(ft1$TipoCombustible == "G.Premium")/nrow(ft1))
probabilidad_de_exito

# Probabilidad Teórica de Exito
```
La probabilidad de éxito es del 11%.

+ Se modela la la distribución geométrica

  - X: es el número de repeticiones hasta dar con el primer vehículo usuario de combustible gasolina Premium

$$ X \sim Geom(0.11)$$

+ Para visualizar gráficamente la distribución realizamos lo siguiente:

```{r}
x <- 0:10  
Probabilidad <- dgeom(x=x, prob=0.11)
plot(x=x, y=Probabilidad, xlab = "Número de repeticiones", ylab = "Probabilidad", 
     type='h', las=1, lwd=6)+abline(v= 1/.11, col="yellow", lwd=3)
legend("topright",c("Esperanza"),fill=c("yellow"))
```
Observando el gráfico podemos deducir que tenemos una baja probabilidad de que en una sola repetición se encuentre a un vehículo usuario de este combustible, ya que la tasa de éxito es P = 0.11.

- Calculamos la esperanza:
```{r}
p = 0.11
Esperanza_geometrica<-r((1/p))
Esperanza_geometrica

```

El promedio esperado de repeticiones esperado hasta dar con un vehículo usuario de combustible Gasolina Premium se aproxima a 9.09 repeticiones.


<center>
**CALCULANDO PROBABILIDADES**
</center>
Uno de los combustible menos usado es el Diesel. Planteamos el siguiente caso: ¿Qué tan probable es encontrar un vehículo usuario de combustible Diesel después de 5 repeticiones?

+ Visualizamos la cantidad de vehículos usuarios de cada combustible:
```{r}
table(ft1$TipoCombustible)
```
Del total de vehículos, 14 usan combustible Diesel.

+ Definimos nuestro espacio muestra --> ("Diesel", ""otro)

  -  Definimos los casos:
     + CASO DE EXITO: Vehículos usuario de Diesel.
     + CASO DE FRACASO: Vehículos usuarios de otro combustible

+ Encontramos la probabilidad de éxito:
```{r}
#probabilidad de exito(teorico)
probabilidad_de_exito <- r(sum(ft1$TipoCombustible == "Diesel")/nrow(ft1))
probabilidad_de_exito
```
La probabilidad de éxito es del de 0.01%. 

+ Se calculará: P(X>5)

```{r}
r(1-pgeom(5-1, 0.1))
```
La probabilidad de dar con un vehículo usuario de combustible Diesel es del 59%.


**B. Variable Emisión de CO2**

Sabemos que los vehículos de la muestra que más cantidad de CO2 emiten a la atmofera son de la marca CHEVROLET y los que menos CO2 emiten son los MITSUBISHI. Nos plantemaos el sigueinte caso de probabilidad: 

a. ¿Qué tan probable es que después de 100 repeticiones se de con un vehículo de la marca CHEVROLET?
b. ¿Qué tan probable es que después de 100 repeticiones se de con un vehículo de la marca MITSUBISHI?

+ Visualizamos la cantidad de cada marca de nuestra muestra:
```{r}
table(ft1$Marca)
```
+ Tenemos que del total de 1629 vehículos 362 son CHEVROLET y 87 MITSUBISHI.


**1. Calculamos la probabilidad de éxito para la marca CHEVROLET**

```{r}
probabilidad_de_exito <- r(sum(ft1$Marca =="CHEVROLET")/nrow(ft1))
probabilidad_de_exito
```
 La probabilidad de éxito es del 22%.
 
- Se calcula: P(X>100)

```{r}
r(1-pgeom(100-1, 0.22))
```
La probabilidad de dar con un Vehículo de la marca CHEVROLET es de 0%.


**2. Calculando  la probabilidad para la marca MITSUBISHI**

```{r}
probabilidad_de_exito <- r(sum(ft1$Marca =="MITSUBISHI")/nrow(ft1))
probabilidad_de_exito
```
La probabilidad de éxito es de 5%.

- Se calcula: P(X>100)

```{r}
r(1-pgeom(100-1, 0.05))
```
La probabilidad de dar con un Vehículo de la marca CHEVROLET es de 1%.

La causa de que la probabilidad de la marca CHEVROLET sea menor, se debe a la gran cantidad de vehículos de esta maraca, tienen mayor probabilidad de ser encontrados en una repetición o pocas repeticiones. por otro lado la marca MITSUBISHI tiene menos vehículos por lo cual tiene una mayor probabilidad de ser encontrada en una gran cantidad de repeticiones.


### **3. Variable Aleatoria Discreta - Distribución Binomial**

Durante la investigación en la primera parte se obtuvo que los vehículos de la marca CHEVROLET son los que mas emisiones de CO2 generan. Además, los combustibles más contaminantes son: la gasolina Premium y la gasolina regular, respectivamente uno más que el otro.

+ Proponemos la siguiente pregunta:

  -  ¿Qué tan probable es una cantidad "X" de vehículos de la marca CHEVROLET sean usuarios del combustible Gasolina Premium?

Se plantea un experimento aleatorio para dar respuesta a la pregunta.

```{r}
nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.Premium" ))
nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.Regular" ))
nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.Regular" )) + nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.Premium" ))

```
Obtenemos mediante una filtración que 258 vehículos CHEVROLET usan ambos combustibles contaminantes, de los cuales 29 usan "gasolina premium" y 229 usan "gasolina regular".

+ Se realiza un filtro donde:
  - 304 Vehículos de la marca CHEVROLET usan ambos combustibles.
  - 53 Vehículos de la marca CHEVROLET usan el combustible Gasolina Premium.
  - 251 Vehículos de la marca CHEVROLET usan elcombustible Gasolina Pegular.

Definimos el espacio muestral: {vehiculos de la marca  CHEVROLET  que usan gasolina Premium, vehiculos de la marca CHEVROLET  que usan gasolina Regular.

```{r}
probabilidad_de_exito <- (nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.Regularr" )))/nrow(ft1)
r(probabilidad_de_exito)
```
- La probabilidad de éxito es del 15%.


### **4. DISTRIBUCIÓNBINOMIAL**

X: Número de vehículos de la marca CHEVROLET que usan combustible gasolina regular -->$$ y \sim Bin(258,0.25)$$

- Representamos gráficamente la distribución:

```{r}
x <- 0:100
Probabilidad <- dbinom(x=x, size=304, prob=0.15)
plot(x=x, y=Probabilidad, xlab = "Número de vehiculos", ylab = "Probabilidad", 
     type='h', las=1, lwd=2)+abline(v=304*0.14, col="yellow", lwd=3)
legend("topright",c("Esperanza"),fill=c("yellow"))

```

+ Calculamos la esperanza que nos servirá para el calculo de las probabilidades:
```{r}
n = 304
p = 0.15
Esp<- (n*p)
Esp
```
Obtenemos un promedio esperado de 45.6 lo cual nos indica que se espera que esta cantidad de vehiculos de la marca CHEVROLET usen Gasolina Premium.


<center>
**CALCULO DE PROBABILIDADES:**


</center>
**a. ¿Qué tan probable es que que mas de 50 vehículos de la marca CHEVROLET sea usuario del combustible "Gasolina Regular" de la muestra de 304 vehículos?**

```{r}
r(pbinom(50,size = 304, prob =  0.15, lower.tail = FALSE ))
```
La probabilidad de que más de 50 vehículos de la marca CHEVROLET sea usuariodel combustible Gasolina Reegulares del 0.21.


**b. ¿Qué tan probable es que mas de 15 vehículos de la marca CHEVROLET sea usuario del combustible "Gasolina Premium" de la muestra de 304 vehículos?**

```{r}
probabilidad_2_exito <- (nrow(filter(ft1,Marca == "CHEVROLET" & TipoCombustible == "G.premium" )))/nrow(ft1)
r(probabilidad_2_exito)
```
Obtenemos una probabilidad de éxito teórica del 0%.

```{r}
r(pbinom(15,size = 304, prob =  0.0, lower.tail = FALSE ))
```
La probabilidad de que 15 vehículos de la marca CHEVROLET sean usuarios del combustible Gasolina Premium es baja debido a que hay pocos vehículos usuarios de este combustible con solo 53 del total de 304 vehículos.

# **BIBLIOGRAFÍA**

[Guía completa markdown y su integración con R . (s/f). Amazonaws.com. Recuperado el 13 de noviembre de 2022.](https://rstudio-pubs-static.s3.amazonaws.com/330387_5a40ca72c3b14824acedceb7d34618d1.html)

[Podder, D. (2020). Emisiones de CO2 por vehículos [Conjunto de datos].](https://www.kaggle.com/datasets/debajyotipodder/co2-emission-by-vehicles)

[Coder, R. (2020, 22 de agosto). Gráfico de CORRELACIÓN en R ◤Correlograma◢ [CON EJEMPLOS] .R CODIFICADOR.](https://r-coder.com/grafico-correlacion-r/)



