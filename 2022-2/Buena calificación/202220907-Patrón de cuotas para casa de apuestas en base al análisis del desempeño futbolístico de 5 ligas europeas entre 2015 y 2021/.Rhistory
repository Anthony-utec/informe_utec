arrange(desc(gr_sum))
LigaInglesaPlayer2018<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Premier League")%>%  filter(`season`=="2018")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaInglesaPlayer2019<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Premier League")%>%  filter(`season`=="2019")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaInglesaPlayer2020<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Premier League")%>%  filter(`season`=="2020")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
BestJugadores_LigaInglesa <- LigaInglesaPlayer2016 %>%
left_join(LigaInglesaPlayer2017, by=c("player"))%>%
left_join(LigaInglesaPlayer2018, by=c("player"))%>%
left_join(LigaInglesaPlayer2019, by=c("player"))%>%
left_join(LigaInglesaPlayer2020, by=c("player"))%>%na.omit(BestJugadores_LigaInglesa)%>%
mutate(total_goal = rowSums(across(c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum))))%>%
mutate(total_disparos = rowSums(across(c(grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum))))%>%
mutate(total_owngoals = rowSums(across(c(growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum))))%>%
mutate(total_pasesclave = rowSums(across(c(grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum))))%>%
mutate(total_asistencias = rowSums(across(c(grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))))%>%
select(-c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum,grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum,growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum,grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum,grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))
LigaEspanolaPlayer2016<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="La Liga")%>%  filter(`season`=="2016")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaEspanolaPlayer2017<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="La Liga")%>%  filter(`season`=="2017")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaEspanolaPlayer2018<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="La Liga")%>%  filter(`season`=="2018")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaEspanolaPlayer2019<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="La Liga")%>%  filter(`season`=="2019")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaEspanolaPlayer2020<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="La Liga")%>%  filter(`season`=="2020")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
BestJugadores_LigaEspanola <- LigaEspanolaPlayer2016 %>%
left_join(LigaEspanolaPlayer2017, by=c("player"))%>%
left_join(LigaEspanolaPlayer2018, by=c("player"))%>%
left_join(LigaEspanolaPlayer2019, by=c("player"))%>%
left_join(LigaEspanolaPlayer2020, by=c("player"))%>%na.omit(BestJugadores_LigaEspanola)%>%
mutate(total_goal = rowSums(across(c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum))))%>%
mutate(total_disparos = rowSums(across(c(grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum))))%>%
mutate(total_owngoals = rowSums(across(c(growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum))))%>%
mutate(total_pasesclave = rowSums(across(c(grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum))))%>%
mutate(total_asistencias = rowSums(across(c(grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))))%>%
select(-c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum,grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum,growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum,grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum,grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))
LigaItalianaPlayer2016<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Serie A")%>%  filter(`season`=="2016")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaItalianaPlayer2017<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Serie A")%>%  filter(`season`=="2017")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaItalianaPlayer2018<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Serie A")%>%  filter(`season`=="2018")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaItalianaPlayer2019<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Serie A")%>%  filter(`season`=="2019")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaItalianaPlayer2020<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Serie A")%>%  filter(`season`=="2020")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
BestJugadores_LigaItaliana <- LigaItalianaPlayer2016 %>%
left_join(LigaItalianaPlayer2017, by=c("player"))%>%
left_join(LigaItalianaPlayer2018, by=c("player"))%>%
left_join(LigaItalianaPlayer2019, by=c("player"))%>%
left_join(LigaItalianaPlayer2020, by=c("player"))%>%na.omit(BestJugadores_LigaItaliana)%>%
mutate(total_goal = rowSums(across(c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum))))%>%
mutate(total_disparos = rowSums(across(c(grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum))))%>%
mutate(total_owngoals = rowSums(across(c(growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum))))%>%
mutate(total_pasesclave = rowSums(across(c(grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum))))%>%
mutate(total_asistencias = rowSums(across(c(grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))))%>%
select(-c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum,grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum,growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum,grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum,grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))
LigaAlemanaPlayer2016<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Bundesliga")%>%  filter(`season`=="2016")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaAlemanaPlayer2017<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Bundesliga")%>%  filter(`season`=="2017")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaAlemanaPlayer2018<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Bundesliga")%>%  filter(`season`=="2018")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaAlemanaPlayer2019<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Bundesliga")%>%  filter(`season`=="2019")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaAlemanaPlayer2020<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Bundesliga")%>%  filter(`season`=="2020")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
BestJugadores_LigaAlemana <- LigaAlemanaPlayer2016 %>%
left_join(LigaAlemanaPlayer2017, by=c("player"))%>%
left_join(LigaAlemanaPlayer2018, by=c("player"))%>%
left_join(LigaAlemanaPlayer2019, by=c("player"))%>%
left_join(LigaAlemanaPlayer2020, by=c("player"))%>%na.omit(BestJugadores_LigaAlemana)%>%
mutate(total_goal = rowSums(across(c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum))))%>%
mutate(total_disparos = rowSums(across(c(grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum))))%>%
mutate(total_owngoals = rowSums(across(c(growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum))))%>%
mutate(total_pasesclave = rowSums(across(c(grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum))))%>%
mutate(total_asistencias = rowSums(across(c(grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))))%>%
select(-c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum,grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum,growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum,grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum,grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))
LigaFrancesaPlayer2016<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Ligue 1")%>%  filter(`season`=="2016")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaFrancesaPlayer2017<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Ligue 1")%>%  filter(`season`=="2017")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaFrancesaPlayer2018<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Ligue 1")%>%  filter(`season`=="2018")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaFrancesaPlayer2019<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Ligue 1")%>%  filter(`season`=="2019")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
LigaFrancesaPlayer2020<-apariciones%>%select(gameID, player,goals, ownGoals, shots,assists,league, season,keyPasses) %>%filter(`league` =="Ligue 1")%>%  filter(`season`=="2020")%>%filter(`goals`>= 2)%>%group_by(player)%>%
dplyr::summarise(gr_sum= sum(goals), grshot_sum=sum(shots), growng_sum=sum(ownGoals),grassists_sum=sum(assists), grkey_sum=sum(keyPasses))%>%
arrange(desc(gr_sum))
BestJugadores_LigaFrancesa <- LigaFrancesaPlayer2016 %>%
left_join(LigaFrancesaPlayer2017, by=c("player"))%>%
left_join(LigaFrancesaPlayer2018, by=c("player"))%>%
left_join(LigaFrancesaPlayer2019, by=c("player"))%>%
left_join(LigaFrancesaPlayer2020, by=c("player"))%>%na.omit(BestJugadores_LigaFrancesa)%>%
mutate(total_goal = rowSums(across(c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum))))%>%
mutate(total_disparos = rowSums(across(c(grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum))))%>%
mutate(total_owngoals = rowSums(across(c(growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum))))%>%
mutate(total_pasesclave = rowSums(across(c(grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum))))%>%
mutate(total_asistencias = rowSums(across(c(grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))))%>%
select(-c(gr_sum.x, gr_sum.y, gr_sum.x.x, gr_sum.y.y, gr_sum,grshot_sum.x, grshot_sum.y, grshot_sum.x.x, grshot_sum.y.y, grshot_sum,growng_sum.x, growng_sum.y, growng_sum.x.x, growng_sum.y.y, growng_sum,grkey_sum.x, grkey_sum.y, grkey_sum.x.x, grkey_sum.y.y, grkey_sum,grassists_sum.x, grassists_sum.y, grassists_sum.x.x, grassists_sum.y.y, grassists_sum))
library(ggplot2)
LigaAlemana_equipo<-estadistica_equipos%>%filter(`league`=="Bundesliga")%>% group_by(team)%>%
dplyr::summarise(gol_tem= sum(goals), gtshot_sum=sum(shots), gtem_target=sum(shotsOnTarget),gt_foul=sum(fouls), gt_yelow=sum(yellowCards),gt_red=sum(redCards))%>%
arrange(desc(gol_tem))
LigaInglaterra_equipo<-estadistica_equipos %>% filter(`league` =="Premier League")%>% group_by(team)%>%
dplyr::summarise(gol_tem= sum(goals), gtshot_sum=sum(shots), gtem_target=sum(shotsOnTarget),gt_foul=sum(fouls), gt_yelow=sum(yellowCards),gt_red=sum(redCards))%>%
arrange(desc(gol_tem))
LigaFrancia_equipo<-estadistica_equipos %>% filter(`league` =="Ligue 1")%>% group_by(team)%>% group_by(team)%>%
dplyr::summarise(gol_tem= sum(goals), gtshot_sum=sum(shots), gtem_target=sum(shotsOnTarget),gt_foul=sum(fouls), gt_yelow=sum(yellowCards),gt_red=sum(redCards))%>%
arrange(desc(gol_tem))
LigaEspanola_equipo<-estadistica_equipos %>% filter(`league` =="La Liga")%>% group_by(team)%>% group_by(team)%>%
dplyr::summarise(gol_tem= sum(goals), gtshot_sum=sum(shots), gtem_target=sum(shotsOnTarget),gt_foul=sum(fouls), gt_yelow=sum(yellowCards),gt_red=sum(redCards))%>%
arrange(desc(gol_tem))
LigaItalia_equipos<-estadistica_equipos %>% filter(`league` =="Serie A")%>% group_by(team)%>% group_by(team)%>%
dplyr::summarise(gol_tem= sum(goals), gtshot_sum=sum(shots), gtem_target=sum(shotsOnTarget),gt_foul=sum(fouls), gt_yelow=sum(yellowCards),gt_red=sum(redCards))%>%
arrange(desc(gol_tem))
ComportamientoLigaInglesa<-estadistica_equipos%>%filter(`league` =="Premier League")%>%
group_by(team)%>% summarise(grfoul_total=sum(fouls), gryellow_total=sum(yellowCards), grred_total=sum(redCards))
ComportamientoLigaItaliana<-estadistica_equipos%>%filter(`league` =="Serie A")%>%
group_by(team)%>% summarise(grfoul_total=sum(fouls), gryellow_total=sum(yellowCards), grred_total=sum(redCards))
ComportamientoLigaAlemanaa<-estadistica_equipos%>%filter(`league` =="Bundesliga")%>%
group_by(team)%>% summarise(grfoul_total=sum(fouls), gryellow_total=sum(yellowCards), grred_total=sum(redCards))
ComportamientoLigaEspanola<-estadistica_equipos%>%filter(`league` =="La Liga")%>%
group_by(team)%>% summarise(grfoul_total=sum(fouls), gryellow_total=sum(yellowCards), grred_total=sum(redCards))
ComportamientoLigaFrancesa<-estadistica_equipos%>%filter(`league` =="Ligue 1")%>%
group_by(team)%>% summarise(grfoul_total=sum(fouls), gryellow_total=sum(yellowCards), grred_total=sum(redCards))
apariciones %>% filter(position == c("FW","FWR","FWL")) %>% filter(xGoals < 1 ) %>% filter(assists < 1) %>% filter(xGoalsBuildup < 1) %>% group_by(position) -> Delanteros
apariciones %>% filter(position == c("MR","ML","AML","AMR","MC")) %>% filter(xGoals < 1 ) %>% filter(assists < 1) %>% filter(xGoalsBuildup < 1) %>% group_by(league) -> MedioCampo
apariciones %>% filter(position == c("DR","DL","DC","DMR","DML","DMC")) %>% filter(xGoals < 1 ) %>% filter(assists < 1) %>% filter(xGoalsBuildup < 1) %>% group_by(league) -> Defensas
pases_1=apariciones%>%
group_by(player)%>%
summarise(total_pases = sum(keyPasses), promedio_pases = (mean(keyPasses)), minimo_pases = min(keyPasses), maximo_pases = max(keyPasses)) %>% arrange(desc(total_pases))-> pases_clave
head(pases_clave)
apariciones %>% group_by(player) %>% summarise(goal_avg = mean(goals), goals_median = median (goals), goals_sd = sd(goals), max_goals = max(goals)) %>% arrange(desc(goal_avg)) %>% filter(goal_avg != 1) -> n_goals
(head(n_goals))
estadistica_equipos%>%group_by(team) %>% summarise (total_goals= sum(goals),total_shots = sum(shots),total_shots_OT = sum(shotsOnTarget)) %>% arrange(desc(total_goals))
estadistica_equipos%>%group_by(league) %>% summarise (total_goals= sum(goals),total_shots_OT = sum(shotsOnTarget), total_fouls = sum(fouls), total_red_cards = sum(redCards)) %>% arrange(desc(total_goals))
yellow_df <- estadistica_equipos %>% group_by(team) %>% summarise(ycards_avg = mean (yellowCards), ycards_median = median(yellowCards), ycards_cv = sd(yellowCards)/mean(yellowCards), max_ycards = max(yellowCards), total_ycards = sum(yellowCards)) %>% arrange(desc(ycards_avg))
head(yellow_df)
estadistica_equipos %>% filter(result == "3" & location == "h") %>% group_by(team) %>% summarise(league = league, t_wins_h_avg = (table(result))/7 ) %>% arrange(desc(t_wins_h_avg)) %>% distinct
estadistica_equipos %>% filter(result == "3" & location == "a") %>% group_by(team) %>% summarise(league = league, t_wins_a_avg = (table(result))/7 ) %>% arrange(desc(t_wins_a_avg)) %>% distinct
#barchart de graficos de cada de ligaalemana
barchart_lae<-ggplot(data=LigaAlemana_equipo,aes(x=reorder(team,gol_tem), y=gol_tem)) +
geom_bar(stat="identity")+ coord_flip()+labs(title = "Liga Alemana", x = "Equipos", y = "Goles")
barchart_lae
#barchart de graficos de cada de ligainglaterra
barchart_lie<-ggplot(data=LigaInglaterra_equipo,aes(x=reorder(team,gol_tem), y=gol_tem)) +
geom_bar(stat="identity")+ coord_flip()+labs(title = "Liga Ingelsa", x = "Equipos", y = "Goles")
barchart_lie
#barchart de graficos de cada de ligafrancia
barchart_lfe<-ggplot(data=LigaFrancia_equipo,aes(x=reorder(team,gol_tem), y=gol_tem)) +
geom_bar(stat="identity")+ coord_flip()+labs(title = "Liga Francesa", x = "Equipos", y = "Goles")
barchart_lfe
#barchart de graficos de cada de ligaespanola
barchart_lee<-ggplot(data=LigaEspanola_equipo,aes(x=reorder(team,gol_tem), y=gol_tem)) +
geom_bar(stat="identity")+ coord_flip()+labs(title = "Liga Española", x = "Equipos", y = "Goles")
barchart_lee
#barchart de graficos de cada de ligaitalia
barchart_lie<-ggplot(data=LigaItalia_equipos,aes(x=reorder(team,gol_tem), y=gol_tem)) +
geom_bar(stat="identity")+ coord_flip()+labs(title = "Liga Italiana", x = "Equipos", y = "Goles")
barchart_lie
head(BestJugadores_LigaAlemana)
head(BestJugadores_LigaFrancesa)
head(BestJugadores_LigaEspanola)
head(BestJugadores_LigaInglesa)
head(BestJugadores_LigaItaliana)
disparos%>% filter(player == "Robert Lewandowski" & season == 2020)-> timegame
disparos%>% filter(player == "Robert Lewandowski" & season == 2018)-> timegame1
disparos%>% filter(player == "Robert Lewandowski" & season == 2016)-> timegame2
hist(timegame$minute, col = "darkmagenta", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Robert Lewandowski en 2020")
hist(timegame1$minute, col = "darkmagenta", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Robert Lewandowski en 2018")
hist(timegame2$minute, col = "darkmagenta", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Robert Lewandowski en 2016")
disparos%>% filter(player == "Kylian Mbappe-Lottin" & season == 2020)-> timegame
disparos%>% filter(player == "Kylian Mbappe-Lottin" & season == 2018)-> timegame1
disparos%>% filter(player == "Kylian Mbappe-Lottin" & season == 2016)-> timegame2
hist(timegame$minute, col = "blue", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Kylian Mbappe-Lottin en 2020")
hist(timegame1$minute, col = "blue", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Kylian Mbappe-Lottin  en 2018")
hist(timegame2$minute, col = "blue", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Kylian Mbappe-Lottin  en 2016")
disparos%>% filter(player == "Luis Su\xe1rez" & season == 2020)-> timegame
disparos%>% filter(player == "Luis Su\xe1rez" & season == 2018)-> timegame1
disparos%>% filter(player == "Luis Su\xe1rez" & season == 2016)-> timegame2
hist(timegame$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Luis Suaréz en 2020")
hist(timegame1$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Luis Suaréz  en 2018")
hist(timegame2$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Luis Suaréz  en 2016")
disparos%>% filter(player == "Lionel Messi" & season == 2020)-> timegame
disparos%>% filter(player == "Lionel Messi" & season == 2018)-> timegame1
disparos%>% filter(player == "Lionel Messi" & season == 2016)-> timegame2
hist(timegame$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Lionel Messi en 2020")
hist(timegame1$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Lionel Messi  en 2018")
hist(timegame2$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Lionel Messi  en 2016")
disparos%>% filter(player == "Antoine Griezmann" & season == 2020)-> timegame
disparos%>% filter(player == "Antoine Griezmann" & season == 2018)-> timegame1
disparos%>% filter(player == "Antoine Griezmann" & season == 2016)-> timegame2
hist(timegame$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Antoine Griezmann en 2020")
hist(timegame1$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Antoine Griezmann  en 2018")
hist(timegame2$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Antoine Griezmann  en 2016")
disparos%>% filter(player == "Iago Aspas" & season == 2020)-> timegame
disparos%>% filter(player == "Iago Aspas" & season == 2018)-> timegame1
disparos%>% filter(player == "Iago Aspas" & season == 2016)-> timegame2
hist(timegame$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Iago Aspas en 2020")
hist(timegame1$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Iago Aspas  en 2018")
hist(timegame2$minute, col = "red", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Iago Aspas  en 2016")
disparos%>% filter(player == "Harry Kane" & season == 2020)-> timegame
disparos%>% filter(player == "Harry Kane" & season == 2018)-> timegame1
disparos%>% filter(player == "Harry Kane" & season == 2016)-> timegame2
hist(timegame$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Harry Kane en 2020")
hist(timegame1$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Harry Kane  en 2018")
hist(timegame2$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Harry Kane  en 2016")
disparos%>% filter(player == "Sergio Ag\xfcero" & season == 2020)-> timegame
disparos%>% filter(player == "Sergio Ag\xfcero" & season == 2018)-> timegame1
disparos%>% filter(player == "Sergio Ag\xfcero" & season == 2016)-> timegame2
hist(timegame$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Sergio Agüero en 2020")
hist(timegame1$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Sergio Agüero  en 2018")
hist(timegame2$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Sergio Agüero  en 2016")
disparos%>% filter(player == "Son Heung-Min" & season == 2020)-> timegame
disparos%>% filter(player == "Son Heung-Min" & season == 2018)-> timegame1
disparos%>% filter(player == "Son Heung-Min" & season == 2016)-> timegame2
hist(timegame$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Son Heung-Min en 2020")
hist(timegame1$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Son Heung-Min  en 2018")
hist(timegame2$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Son Heung-Min en 2016")
disparos%>% filter(player == "Jamie Vardy" & season == 2020)-> timegame
disparos%>% filter(player == "Jamie Vardy" & season == 2018)-> timegame1
disparos%>% filter(player == "Jamie Vardy" & season == 2016)-> timegame2
hist(timegame$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Jamie Vardy en 2020")
hist(timegame1$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Jamie Vardy  en 2018")
hist(timegame2$minute, col = "brown", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Jamie Vardy  en 2016")
disparos%>% filter(player == "Andrea Belotti" & season == 2020)-> timegame
disparos%>% filter(player == "Andrea Belotti" & season == 2018)-> timegame1
disparos%>% filter(player == "Andrea Belotti" & season == 2016)-> timegame2
hist(timegame$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Andrea Belotti en 2020")
hist(timegame1$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Andrea Belotti  en 2018")
hist(timegame2$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Andrea Belotti  en 2016")
disparos%>% filter(player == "Ciro Immobile" & season == 2020)-> timegame
disparos%>% filter(player == "Ciro Immobile" & season == 2018)-> timegame1
disparos%>% filter(player == "Ciro Immobile" & season == 2016)-> timegame2
hist(timegame$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Ciro Immobile en 2020")
hist(timegame1$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Ciro Immobile  en 2018")
hist(timegame2$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Ciro Immobile  en 2016")
disparos%>% filter(player == "Dries Mertens" & season == 2020)-> timegame
disparos%>% filter(player == "Dries Mertens" & season == 2018)-> timegame1
disparos%>% filter(player == "Dries Mertens" & season == 2016)-> timegame2
hist(timegame$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Dries Mertens en 2020")
hist(timegame1$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Dries Mertens  en 2018")
hist(timegame2$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Dries Mertens  en 2016")
disparos%>% filter(player == "Edin Dzeko" & season == 2020)-> timegame
disparos%>% filter(player == "Edin Dzeko" & season == 2018)-> timegame1
disparos%>% filter(player == "Edin Dzeko" & season == 2016)-> timegame2
hist(timegame$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Edin Dzeko en 2020")
hist(timegame1$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Edin Dzeko  en 2018")
hist(timegame2$minute, col = "green", xlab = "Minuto del partido",xlim = c(0,90), main = "Frecuencia de disparos de Edin Dzeko  en 2016")
hist(disparos$minute, main = "Minutos en los que se realizan disparos", col = "lightblue",xlab = "Minuto del partido")
abline(v=mean(disparos$minute), col = "red")
abline(v=which.max(table(disparos$minute)), col = "blue")
abline(v=median(disparos$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("red","blue","yellow"), lwd=3, lty=1)
disparos%>% filter(league == "Bundesliga")-> disp_bundesliga
hist(disp_bundesliga$minute,main = "Minutos de más disparos de la Bundeskiga", col = "darkmagenta",xlab = "Minuto del partido")
abline(v=mean(disp_bundesliga$minute), col = "red")
abline(v=which.max(table(disp_bundesliga$minute)), col = "blue")
abline(v=median(disp_bundesliga$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("red","blue","yellow"), lwd=3, lty=1)
disparos%>% filter(league == "Ligue 1")-> disp_Ligue1
hist(disp_Ligue1$minute,main = "Minutos de más disparos de la  Ligue 1", col = "blue",xlab = "Minuto del partido")
abline(v=mean(disp_Ligue1$minute), col = "red")
abline(v=which.max(table(disp_Ligue1$minute)), col = "skyblue")
abline(v=median(disp_Ligue1$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("red","skyblue","yellow"), lwd=3, lty=1)
disparos%>% filter(league == "La Liga")-> disp_LaLiga
hist(disp_LaLiga$minute,main = "Minutos de más disparos de la  La Liga", col = "red",xlab = "Minuto del partido")
abline(v=mean(disp_LaLiga$minute), col = "orange")
abline(v=which.max(table(disp_LaLiga$minute)), col = "blue")
abline(v=median(disp_LaLiga$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("orange","blue","yellow"), lwd=3, lty=1)
disparos%>% filter(league == "Premier League")-> disp_premierleague
hist(disp_premierleague$minute,main = "Minutos de más disparos de la Premier League", col = "brown",xlab = "Minuto del partido")
abline(v=mean(disp_premierleague$minute), col = "red")
abline(v=which.max(table(disp_premierleague$minute)), col = "blue")
abline(v=median(disp_premierleague$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("red","blue","yellow"), cex=0.8, pt.cex =0.8, lwd=1, lty=1 )
disparos%>% filter(league == "Serie A")-> disp_SerieA
hist(disp_SerieA$minute,main = "Minutos de más disparos de la Serie A", col = "green",xlab = "Minuto del partido")
abline(v=mean(disp_SerieA$minute), col = "orange")
abline(v=which.max(table(disp_SerieA$minute)), col = "blue")
abline(v=median(disp_SerieA$minute), col = "yellow")
legend("topright", c("Media","Moda","Mediana"), col = c("orange","blue","yellow"), lwd=3, lty=1)
boxplot(yellow_df$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de todas las ligas", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(yelow_Bundesliga$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de la Bundesliga", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(yelow_LaLiga$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de La Liga", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(yelow_Ligue1$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de la Ligue 1", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(yelow_premierleague$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de la Premier League", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(yelow_SerieA$total_ycards,horizontal = TRUE, col = "yellow", main = "Tarjetas amarillas por equipo en las 6 temporadas de la Serie A", xlab= "Total de tarjetas amarillas")
abline(v=mean(yellow_df$total_ycards,na.rm = TRUE), col = "green", lwd = 3, lty = 2)
legend("topright",c("Media del total de tarjetas amarillas"),col = "green", lwd = 3,lty =2)
boxplot(n_goals$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores", xlab= "Promedio de goles")
abline(v=mean(n_goals$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
#Identificar y ordenar por color de pertenecientes a cada liga
boxplot(n_goalPremierLeague$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores de la Premier League", xlab= "Promedio de goles")
abline(v=mean(n_goalPremierLeague$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
boxplot(n_goalBundesliga$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores de la BundesLiga", xlab= "Promedio de goles")
abline(v=mean(n_goalBundesliga$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
boxplot(n_goalLaLiga$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores de La Liga", xlab= "Promedio de goles")
abline(v=mean(n_goalLaLiga$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
boxplot(n_goalLigue1$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores de La Ligue 1", xlab= "Promedio de goles")
abline(v=mean(n_goalLigue1$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
boxplot(n_goalSerieA$goal_avg, col = "orange",horizontal = TRUE, main = "Goles promedio de jugadores de la Serie A", xlab= "Promedio de goles")
abline(v=mean(n_goalSerieA$goal_avg), col = "blue",lwd=3, lty=2)
legend("bottomright", c("Media de los promedios de goles"), col = "blue", lwd=3 , lty=2 )
estadistica_equipos %>% group_by(season,league) %>% summarise(goles_totales = sum(goals)) %>% filter(league == "Bundesliga") -> alemania
estadistica_equipos %>% group_by(season,league) %>% summarise(goles_totales = sum(goals)) %>% filter(league == "Premier League") -> inglesa
estadistica_equipos %>% group_by(season,league) %>% summarise(goles_totales = sum(goals)) %>% filter(league == "Ligue 1") -> francesa
estadistica_equipos %>% group_by(season,league) %>% summarise(goles_totales = sum(goals)) %>% filter(league == "La Liga") -> española
estadistica_equipos %>% group_by(season,league) %>% summarise(goles_totales = sum(goals)) %>% filter(league == "Serie A") -> italiana
ggplot(alemania,aes(x=season,y=goles_totales)) + geom_bar(stat = "identity",fill = "purple") + ggtitle("Bundesliga ")
ggplot(inglesa,aes(x=season,y=goles_totales)) + geom_bar(stat = "identity",fill = "blue") + ggtitle("Premier League")
ggplot(francesa,aes(x=season,y=goles_totales)) + geom_bar(stat = "identity",fill = "red") + ggtitle("Ligue 1 ")
ggplot(española,aes(x=season,y=goles_totales)) + geom_bar(stat = "identity",fill = "brown") + ggtitle("La Liga ")
ggplot(italiana,aes(x=season,y=goles_totales)) + geom_bar(stat = "identity",fill = "green") + ggtitle("Serie A")
cor(LigaAlemana_equipo$gol_tem, LigaAlemana_equipo$gtshot_sum)
regresion_lineal3<-lm(LigaAlemana_equipo$gtshot_sum~ LigaAlemana_equipo$gol_tem)
plot(LigaAlemana_equipo$gol_tem, LigaAlemana_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Alemana en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
smoothScatter(LigaAlemana_equipo$gol_tem, LigaAlemana_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Alemana en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
summary(regresion_lineal3)
coefficients(regresion_lineal3)
cor(LigaEspanola_equipo$gol_tem, LigaEspanola_equipo$gtshot_sum)
regresion_lineal3<-lm(LigaEspanola_equipo$gtshot_sum~ LigaEspanola_equipo$gol_tem)
plot(LigaEspanola_equipo$gol_tem, LigaEspanola_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Espanola en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
smoothScatter(LigaEspanola_equipo$gol_tem, LigaEspanola_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Espanola en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
summary(regresion_lineal3)
coefficients(regresion_lineal3)
cor(LigaFrancia_equipo$gol_tem, LigaFrancia_equipo$gtshot_sum)
regresion_lineal3<-lm(LigaFrancia_equipo$gtshot_sum~ LigaFrancia_equipo$gol_tem)
plot(LigaFrancia_equipo$gol_tem, LigaFrancia_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Francesa en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
smoothScatter(LigaFrancia_equipo$gol_tem, LigaFrancia_equipo$gtshot_sum,  main="Desemepeño futbolístico de Liga Francesa en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
summary(regresion_lineal3)
coefficients(regresion_lineal3)
cor(LigaInglaterra_equipo$gol_tem, LigaInglaterra_equipo$gtshot_sum)
regresion_lineal3<-lm(LigaInglaterra_equipo$gtshot_sum~ LigaInglaterra_equipo$gol_tem)
plot(LigaInglaterra_equipo$gol_tem, LigaInglaterra_equipo$gtshot_sum, main="Desemepeño futbolístico de Liga Inglesa en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
smoothScatter(LigaInglaterra_equipo$gol_tem, LigaInglaterra_equipo$gtshot_sum, main="Desemepeño futbolístico de Liga Inglesa en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
summary(regresion_lineal3)
coefficients(regresion_lineal3)
cor(LigaItalia_equipos$gol_tem, LigaItalia_equipos$gtshot_sum)
regresion_lineal3<-lm(LigaItalia_equipos$gtshot_sum~ LigaItalia_equipos$gol_tem)
plot(LigaItalia_equipos$gol_tem, LigaItalia_equipos$gtshot_sum, main="Desemepeño futbolístico de Liga Italiana en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
smoothScatter(LigaItalia_equipos$gol_tem, LigaItalia_equipos$gtshot_sum,  main="Desemepeño futbolístico de Liga Italiana en las temporada 2016-2020.",
xlab="Total de Goles  ",
ylab="Disparos al arco ",)
abline(regresion_lineal3, col='red')
summary(regresion_lineal3)
coefficients(regresion_lineal3)
cor(ComportamientoLigaAlemanaa$gryellow_total, ComportamientoLigaAlemanaa$grfoul_total)
regresion_lineal2<- lm(ComportamientoLigaAlemanaa$grfoul_total~ ComportamientoLigaAlemanaa$gryellow_total)
plot(ComportamientoLigaAlemanaa$gryellow_total, ComportamientoLigaAlemanaa$grfoul_total,  main="Desemepeño futbolístico de Liga Alemana en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
smoothScatter(ComportamientoLigaAlemanaa$gryellow_total, ComportamientoLigaAlemanaa$grfoul_total,  main="Desemepeño futbolístico de Liga Alemana en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
summary(regresion_lineal2)
coefficients(regresion_lineal2)
cor(ComportamientoLigaEspanola$gryellow_total, ComportamientoLigaEspanola$grfoul_total)
regresion_lineal2<- lm(ComportamientoLigaEspanola$grfoul_total~ ComportamientoLigaEspanola$gryellow_total)
plot(ComportamientoLigaEspanola$gryellow_total, ComportamientoLigaEspanola$grfoul_total,  main="Desemepeño futbolístico de Liga Espanola en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
smoothScatter(ComportamientoLigaEspanola$gryellow_total, ComportamientoLigaEspanola$grfoul_total,  main="Desemepeño futbolístico de Liga Espanola en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
summary(regresion_lineal2)
coefficients(regresion_lineal2)
cor(ComportamientoLigaFrancesa$gryellow_total, ComportamientoLigaFrancesa$grfoul_total)
regresion_lineal2<- lm(ComportamientoLigaFrancesa$grfoul_total~ ComportamientoLigaFrancesa$gryellow_total)
plot(ComportamientoLigaFrancesa$gryellow_total, ComportamientoLigaFrancesa$grfoul_total,  main="Desemepeño futbolístico de Liga Francesa en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
smoothScatter(ComportamientoLigaFrancesa$gryellow_total, ComportamientoLigaFrancesa$grfoul_total,  main="Desemepeño futbolístico de Liga Francesa en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
summary(regresion_lineal2)
coefficients(regresion_lineal2)
cor(ComportamientoLigaInglesa$gryellow_total, ComportamientoLigaInglesa$grfoul_total)
regresion_lineal2<- lm(ComportamientoLigaInglesa$grfoul_total~ ComportamientoLigaInglesa$gryellow_total)
plot(ComportamientoLigaInglesa$gryellow_total, ComportamientoLigaInglesa$grfoul_total,  main="Desemepeño futbolístico de Liga Inglesa en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
smoothScatter(ComportamientoLigaInglesa$gryellow_total, ComportamientoLigaInglesa$grfoul_total,  main="Desemepeño futbolístico de Liga Inglesa en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
summary(regresion_lineal2)
coefficients(regresion_lineal2)
cor(ComportamientoLigaItaliana$gryellow_total, ComportamientoLigaItaliana$grfoul_total)
regresion_lineal2<- lm(ComportamientoLigaItaliana$grfoul_total~ ComportamientoLigaItaliana$gryellow_total)
plot(ComportamientoLigaItaliana$gryellow_total, ComportamientoLigaItaliana$grfoul_total,  main="Desemepeño futbolístico de Liga Italiana en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
smoothScatter(ComportamientoLigaItaliana$gryellow_total, ComportamientoLigaItaliana$grfoul_total,  main="Desemepeño futbolístico de Liga Italiana en las temporada 2016-2020.",
xlab="Amonestaciones del arbitro ",
ylab="Total de faltas")
abline(regresion_lineal2, col='blue')
summary(regresion_lineal2)
coefficients(regresion_lineal2)
estadistica_equipos%>%group_by(team) %>% summarise (total_goals= sum(goals),total_shots_OT = sum(shotsOnTarget), Proba_goles = round((total_goals/total_shots_OT), digits = 2), Proba_Atajadas = round(1-(total_goals/total_shots_OT), digits = 2)) %>% arrange(desc(total_goals)) ->IND_Efectividad
IND_Efectividad
hist(IND_Efectividad$Proba_goles, main = "Efectividad de los equipos de futbol", xlab = "Probabilidad de gol")
shapiro.test(IND_Efectividad$Proba_goles)
estadistica_equipos%>%group_by(team) %>% summarise (total_fouls = sum(fouls,na.rm = TRUE), total_red_cards = sum(redCards, na.rm = TRUE), total_yellow_cards = sum(yellowCards,na.rm = TRUE), Prob_Agresividad_team = round(total_red_cards/total_fouls+total_yellow_cards/total_fouls, digits=2)) %>% arrange(desc(Prob_Agresividad_team))->IND_Agresividad_team
IND_Agresividad_team
estadistica_equipos%>%group_by(league) %>% summarise (total_fouls = sum(fouls,na.rm = TRUE), total_red_cards = sum(redCards, na.rm = TRUE), total_yellow_cards = sum(yellowCards,na.rm = TRUE), Prob_Agresividad_liga = round(total_red_cards/total_fouls+total_yellow_cards/total_fouls, digits=2)) %>% arrange(desc(Prob_Agresividad_liga))->IND_Agresividad_liga
IND_Agresividad_liga
hist(Delanteros$xGoals,xlab = "Delanteros probabilidad de gol")
mean(Delanteros$xGoals)
sqrt(var(Delanteros$xGoals))
sd(Delanteros$xGoals)
hist(MedioCampo$xGoals,xlab = "Mediocampistas probabilidad de gol")
mean(MedioCampo$xGoals)
sqrt(var(MedioCampo$xGoals))
hist(Defensas$xGoals,xlab = "Defensas probabilidad de gol")
mean(Defensas$xGoals)
sqrt(var(Defensas$xGoals))
DefensasU <- filter(Defensas, xGoals >=0.2)
mean(DefensasU$xGoals)
(min(DefensasU$xGoals)+max(DefensasU$xGoals))/2
((max(DefensasU$xGoals)-min(DefensasU$xGoals))^2)/12
var(DefensasU$xGoals)
hist(Delanteros$xGoalsBuildup,main = "Delanteros",xlab = "Delanterps probabilidad de asistencia de gol")
mean(Delanteros$xGoalsBuildup)
sqrt(var(Delanteros$xGoalsBuildup))
hist(MedioCampo$xGoalsBuildup,main = "Medio Campo", xlab = "Mediocampistas probabilidad de asistencia de gol")
mean(MedioCampo$xGoalsBuildup)
sqrt(var(MedioCampo$xGoalsBuildup))
hist(Defensas$xGoalsBuildup,main = "Defensas",xlab = "Defensas probabilidad de asistencia de gol")
mean(Defensas$xGoalsBuildup)
sqrt(var(Defensas$xGoalsBuildup))
res2<-fit.cont(estadistica_equipos$fouls)
res3<-fit.cont(estadistica_equipos$shots)
install.packages("repmis")
