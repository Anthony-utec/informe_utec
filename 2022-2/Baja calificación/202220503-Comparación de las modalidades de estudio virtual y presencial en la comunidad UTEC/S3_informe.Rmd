---
title: "PROYECTO: Comparación de las modalidades de estudio virtual y presencial en la comunidad UTEC"
output:
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
  html_document:
    toc: yes
    df_print: paged
---

![](logo_utec.png)

***INTEGRANTES DEL GRUPO 3***:
  
     Aron Rizqallah, Luciana
     Montes Barrera, Rosmelia Susana (Líder)
     Soncco Machaca, Franklin David
     Tito Berrocal, Angel Ulises
     Vargas Machuca Acevedo, Diego Alonso


```{r, include = FALSE}
if(!require(ggplot2)){install.packages('ggplot2')}
if(!require(graphics)){install.packages('graphics')}
if(!require(tidyr)){install.packages('tidyr')}
if(!require(readr)){install.packages('readr')}
if(!require(dplyr)){install.packages('dplyr')}
if(!require(tidyverse)){install.packages('tidyverse')}
if(!require(rcompanion)){install.packages('rcompanion')}
```


```{r, include=FALSE}
library(readr)
library(graphics)
library(tidyr)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(rcompanion)
```

# INTRODUCCIÓN

### 1.1. RELEVANCIA

En el año 2022 la SUNEDU dispuso el regreso de las clases presenciales en las universidades del Perú. De esta manera, los métodos de estudio, hábitos y actividades diarias de los estudiantes han cambiado para adecuarse a esta transformación.

Es importante estudiar estos cambios, debido a que nos permitirán analizar cuáles son las condiciones que benefician al aprendizaje y cuáles son aquellas que lo perjudican. Esto con miras a mejorar el nivel de la educación superior en el Perú.

Por eso nuestro de equipo de investigación recolectara diferentes datos de una muestra de 200 estudiantes de UTEC para realizar una análisis de cómo han cambiado los hábitos cotidianos de la modalidad virtual a la presencial y cómo influye en el método de estudio por parte de los alumnos.

### Objetivo general
Comparar los hábitos cotidianos de los estudiantes de UTEC en la modalidad presencial y virtual.
### Objetivos específicos
- Elaborar un formulario para la obtención de los datos a través de una encuesta.
- Obtener las 200 observaciones por medio del muestreo aleatorio simple.
- Realizar análisis de las variables mediante el uso de descriptores gráficos y numéricos.
- Aproximar las variables aleatorias a los datos obtenidos para realizar el análisis probabilístico.

### 1.2. PLANIFICACIÓN

```{r}
data <- data.frame(Procesos = c('Entrega de la pre-entrega del proyecto', 'Búsqueda de temas relevantes', 'Escoger uno de los temas aceptados de la pre-entrega del proyecto', 
'Realización del formulario de encuestas', 'Recolección y limpieza de datos','Realizar el informe para la primera entrega del proyecto', 
'Reserva de la reunion para el feedback','Análisis de la segunda parte del proyecto', 'Feedback dado por la profesora referente a nuestro proyecto', 'Realizar el informe para la segunda entrega del proyecto', 'Entrega del informe y exposicion de manera oral del mismo'), 
Inicio = c(3,3,5,5,5,6,7,8,10,11,14),
Fin =    c(5,4,6,6,7,7,8,9,11,14,15),
Estado = c('Finalizado','Finalizado','Finalizado','Finalizado','Finalizado','Finalizado','Finalizado','Finalizado','Finalizado', 'En proceso', 'En proceso')
)
```

```{r}
data$Procesos = factor(data$Procesos,c('Entrega del informe y exposicion de manera oral del mismo','Realizar el informe para la segunda entrega del proyecto','Feedback dado por la profesora referente a nuestro proyecto','Análisis de la segunda parte del proyecto','Reserva de la reunion para el feedback','Realizar el informe para la primera entrega del proyecto','Recolección y limpieza de datos', 'Realización del formulario de encuestas','Escoger uno de los temas aceptados de la pre-entrega del proyecto', 'Búsqueda de temas relevantes','Entrega de la pre-entrega del proyecto'))
```


```{r}
ggplot(data, aes(x=Inicio, xend=Fin, y=Procesos, yend=Procesos, color=Estado)) +
  theme_bw()+ 
  geom_segment(size=8) + 
  labs(title='Planificación', x='Tiempo (en semanas)', y='Procesos')
```



# DATOS

## Población, muestra y muestreo

### Proceso de recolección de datos

En primer lugar, creamos una encuesta en Google Forms con el fin de recolectar datos para nuestra investigación. En segundo lugar, iniciamos con la recolección de datos tanto de forma virtual y presencial. Por ejemplo, presencialmente empezamos a intervenir a diferentes alumnos de la universidad de forma aleatoria y les pedimos que completen la encuesta dándoles un incentivo de caramelos y nuestra gratitud de manera cordial. Respecto a la recolección de forma virtual, no hemos tenido frutos significativos pues muchas veces el publico al que nos dirigimos no responde las encuestas. Así nuestra base de datos proviene mayormente de la recolección presencial por su efectividad y rapidez.

### Población:
Estudiantes de UTEC que han cursado al menos un ciclo durante la modalidad virtual y al menos un ciclo durante la modalidad presencial.

### Muestra:
Una sub-población de 209 estudiantes que reúnen características de haber cursado al menos un ciclo en la modalidad presencial y virtual.

### Muestreo:
El tipo de muestreo utilizado fue aleatorio simple ya que encuestamos de forma virtual y presencial en distintos momentos y días.



## Variables

+---------------------------------+-------------------------------+----------------------------------------+
| **Variables**                   |          **Tipo**             |      **Restricción**                   |
+=================================+===============================+========================================+
| *Sexo*                          |*Categórica nominal*           | *Hombre / Mujer*                       |
+---------------------------------+-------------------------------+----------------------------------------+
| *Edad*                          |*Numérica discreta*            | *[16; 60]*                             |
+---------------------------------+-------------------------------+----------------------------------------+
| *Codigo*                        |*Categórica ordinal*           | *9 dígitos*                            |
+---------------------------------+-------------------------------+----------------------------------------+
| *Ciclo*                         |*Categórica ordinal*           | *[1-10]*                               |
+---------------------------------+-------------------------------+----------------------------------------+
| *Carrera*                       |*Categórica nominal*           | *Las carreras ofertadas de UTEC*       |
+---------------------------------+-------------------------------+----------------------------------------+
| *EstudioV*                      |*Numérica continua*            | *Entero no negativo, menor a 24*       |
+---------------------------------+-------------------------------+----------------------------------------+
| *SueñoV*                        |*Numérica continua*            | *Entero no negativo, menor a 24*       |
+---------------------------------+-------------------------------+----------------------------------------+
| *EstresV*                       |*Categórica ordinal*           | *Entero [0;10]*                        |
+---------------------------------+-------------------------------+----------------------------------------+
| *PresupuestoV*                  |*Numérica discreta*            |   *Entero positivo*                    |
+---------------------------------+-------------------------------+----------------------------------------+
| *EnseñanzaV*                    |*Categórica ordinal*           |   *Entero [0;10]*                      |
+---------------------------------+-------------------------------+----------------------------------------+
|*SatisfaccionV*                  |*Categórica ordinal*           | *Entero [0;10]*                        |
+---------------------------------+-------------------------------+----------------------------------------+
|*EstudioP*                       |*Numérica continua*            | *Entero no negativo, menor a 24*       |          
+---------------------------------+-------------------------------+----------------------------------------+
| *SueñoP*                        | *Numérica continua*           |*Entero no negativo, menor e igual a 15*|
+---------------------------------+-------------------------------+----------------------------------------+
| *EsresP*                        |*Categórica ordinal*           |   *Entero [0;10]*                      |
+---------------------------------+-------------------------------+----------------------------------------+
| *PresupuestoP*                  |*Numérica discreta*            |*Entero positivo*                       |
+---------------------------------+-------------------------------+----------------------------------------+
|*SatisfaccionP*                  |*Categórica ordinal*           | *Entero [0;10]*                        |          
+---------------------------------+-------------------------------+----------------------------------------+
| *EnseñanzaP*                    |*Categórica ordinal*           |  *Entero [0;10]*                       |
+---------------------------------+-------------------------------+----------------------------------------+
| *TransporteP*                   |*Numérica continua*            |  *Entero no negativo, menor a 24*      |
+---------------------------------+-------------------------------+----------------------------------------+



## Limpieza de base de datos

Primero cargamos nuestra base de datos en la variable BD:

```{r, echo=TRUE}
BD <- read.csv('base_de_datos_proyecto.csv')
```

Posterior a ello seleccionamos solo las variables que vamos a utilizar:

```{r, echo=TRUE}
BD <- select(BD, 5:22)
```
Ahora cambiamos el nombre de nuestras variables y la almacenamos en BD2:

```{r, echo=TRUE}
BD2 <- rename(BD,edad = 'Edad..Ejemplo..18.', cod_alumno = 'Código.de.alumno', Ciclo = 'Ciclo.que.cursas', EstudioV = 'Horas.de.estudio.diarias..Ejemplo..3.', 
SueñoV = 'Horas.diarias.de.sueño..Ejemplo..6.', EstresV = 'Nivel.de.estrés', PresupuestoV = 'Presupuesto.Diario.en.soles..Ejemplo..30.', 
SatisfaccionV = 'Nivel.de.satisfacción.universitaria', EnseñanzaV = 'Percepción.de.calidad.de.enseñanza', 
TransporteP = 'Tiempo.promedio.de.transporte.en.minutos..Ejemplo..25.', EstudioP = 'Horas.de.estudio.promedio.al.dia..Ejemplo..2.', 
SueñoP = 'Horas.diarias.de.sueño..Ejemplo..7.', EstresP = 'Nivel.de.estrés.1', SatisfaccionP = 'Nivel.de.satisfacción.general', 
PresupuestoP = 'Presupuesto.Diario.en.soles..Ejemplo..40.', EnseñanzaP = 'Percepción.de.enseñanza')
```

Después de ello cambiamos como variables categóricas a las siguientes variables, ya que R los considera numéricas:

```{r, echo=TRUE}
BD2$SatisfaccionP <- as.factor(BD2$SatisfaccionP)
BD2$SatisfaccionV <- as.factor(BD2$SatisfaccionV)
BD2$EstresV <- as.factor(BD2$EstresV)
BD2$EstresP <- as.factor(BD2$EstresP)
BD2$EnseñanzaV <- as.factor(BD2$EnseñanzaV)
BD2$EnseñanzaP <- as.factor(BD2$EnseñanzaP)
```

Ahora verificaremos si contamos con NA's dentro de nuestra base de datos:

```{r, echo=TRUE}
TotalNA <- sum(is.na(BD2))
```

```{r}
TotalNA
```

Con esto nos damos cuenta que no contamos con ninguna NA en nuestra base de datos.
```{r, echo=TRUE}
ObsCompletas <- sum(complete.cases(BD2))
```

```{r}
ObsCompletas
```

Aquí nos damos cuenta que contamos con 209 observaciones en nuestra base de datos.

```{r, echo=TRUE}
ObsImcompletas <- sum(!complete.cases(BD2))
```

```{r}
ObsImcompletas
```

Aquí verificamos que todas nuestras observaciones estén completas.
```{r}
nrow(BD2)
ncol(BD2)
```
En nuestra base de datos contamos con 209 observaciones y 18 variables

```{r}
cat("El porcentaje de las NA´s es ", (sum(is.na(BD2))/(nrow(BD2)*ncol(BD2)))*100, "% en la base de datos")
cat("El porcentaje de las observaciones completas es ", (sum(complete.cases(BD2))/(nrow(BD2)))*100, "% en la base de datos")
cat("El porcentaje de las observaciones incompletas es ", (sum(!complete.cases(BD2))/(nrow(BD2)))*100,"% en la base de datos")
```


Respecto a la variable Sexo, antes de empezar con la encuesta, se ha dispuesto controles para la obtención de las mismas siendo como únicas alternativas "Hombre" y "Mujer", por lo tanto no se realiza limpieza adicional.

```{r}
table(BD2$Sexo)
```

Respecto a la variable edad hemos dispuesto que colocaran solo números enteros, restringiendo así la obtención de caracteres. Debido a esto no se realiza una limpieza adicional.
```{r}
table(BD2$edad)
```
Respecto a la variable ciclo hemos dispuesto que colocaran solo números enteros, ya que esta solo podía ser respondida por opción múltiple con unos parámetros definidos. Debido a esto no se realiza una limpieza adicional.

```{r}
table(BD2$Ciclo)
```
En el caso de la variable carrera se dispuso de diferentes opciones a elegir para no hacer una limpieza adicional, pero nos olvidamos de la carrera "Ingeniería de Energía", la cual marcaron con la opción de "OTRA"
```{r}
table(BD2$Carrera)
```
Debido a la anterior, realizamos un cambio en la respuesta "OTRA" a "Ingeniería de Energía" de la siguiente manera:

```{r, echo =TRUE}
BD2$Carrera[BD2$Carrera == 'OTRA'] <- "Ingeniería de la Energía"
```

```{r}
table(BD2$Carrera)
```

Para las variables sueñoV, estudioV,presupuestoV,sueñoP, estudioP, presupuestoP y TransporteP restringimos el ingreso de caracteres, haciendo que solo se puedan ingresar valores enteros. Debido a esto no se realiza una limpieza adicional.

```{r}
print("Tabla de las horas de estudio en la modalidad virtual")
table(BD2$EstudioV)
print("Tabla del presupuesto diario en la modalidad virtual")
table(BD2$PresupuestoV)
print("Tabla de las horas de sueño en la modalidad virtual")
table(BD2$SueñoV)
print("Tabla de las horas de estudio en la modalidad presencial")
table(BD2$EstudioP)
print("Tabla del presupuesto diario en la modalidad presencial")
table(BD2$PresupuestoP)
print("Tabla de las horas de sueño en la modalidad presencial")
table(BD2$SueñoP)
print("Tabla del tiempo de transporte en minutos en la modalidad presencial")
table(BD2$TransporteP)
```

Para las variables estresV, satisfaccionV,enseñanzaV,estresP,satisfaccionP y enseñanzaP se predispuso al encuestado opciones del 1 al 10, haciendo así que no se realice una limpieza adicional.

```{r}
print("Tabla del nivel de estrés en la modalidad virtual")
table(BD2$EstresV)
print("Tabla del nivel de satisfacción en la modalidad virtual")
table(BD2$SatisfaccionV)
print("Tabla de la percepción de la calidad de enseñanza en la modalidad virtual")
table(BD2$EnseñanzaV)
print("Tabla del nivel de estrés en la modalidad presencial")
table(BD2$EstresP)
print("Tabla del nivel de satisfacción en la modalidad presencial")
table(BD2$SatisfaccionP)
print("Tabla de la percepción de la calidad de enseñanza en la modalidad presencial")
table(BD2$EnseñanzaP)
```
Finalmente creamos un nuevo archivo csv en donde exportamos la base de datos completamente limpia.

```{r, echo=TRUE}
write_csv(BD2, "BD_limpio.csv")
```


# Análisis descriptivo


Primero veremos un análisis a nuestras variables categóricas:

## Sexo

```{r}
barplot(table(BD2$Sexo),col=c("lightblue","pink"),main = "Sexo de los estudiantes",xlab="Sexo", ylab = "Cantidad")
```
Nos es conveniente utilizar una gráfica de barras debido a que es una variable categórica, aunque no tiene relevancia en el objetivo de nuestro estudio que es comparar la virtualidad y presencialidad, los resultados nos ayudan a conocer a la población que estudiamos, que es el primer paso para el estudio estadístico.


## Carrera


```{r}
barplot(table(BD2$Carrera), ylab = "Cantidad de personas", main = "Carreras universitarias de nuestros encuestados", las = 2)
```
De acuerdo a la gráfica de barras se puede interpretar que estudiantes de Ingeniería Civil y Mecatrónica predominan en nuestra encuesta. Esto nos sirve para conocer mejor a nuestra población y no tiene una mayor relevancia para nuestro estudio.

## Estrés


```{r}
barplot(table(BD2$EstresP), ylab = "Cantidad de personas", xlab = "Nivel de estrés",main = "Niveles de estrés en la modalidad presencial", col = "white")
```


```{r}
barplot(table(BD2$EstresV), ylab = "Cantidad de personas", xlab = "Nivel de estres",main = "Niveles de estrés en la modalidad virtual", col = "skyblue")
```

```{r}
cat("Porcentaje del nivel de estrés en la modalidad virtual\n")
table(BD2$EstresV)/nrow(BD2)*100
cat("Porcentaje del nivel de estrés en la modalidad presencial\n")
table(BD2$EstresP)/nrow(BD2)*100
```

Esta variable en ambas modalidades ya es de nuestro interés pues nos permite comparar el nivel de estrés de los estudiantes encuestados. Al observar los datos por medio de una gráfica de barras y sacar el porcentaje de cada nivel, el 13.88% de estudiantes en la virtualidad afirma que tiene un nivel de estrés 10, mientras que un 16.75% de estudiantes de la presencialidad afirma lo mismo, existiendo un incremento de nivel de estrés de 2,87%, al igual que en el nivel de estrés 9 con 11.01% siendo este ultimo el de mayor notoriedad. Por otro lado, existe un decremento en el nivel de estrés 8 de un 5.27% siendo el mas notorio en decrecer. Uno de los patrones reconocidos es que los niveles de estrés bajos en la modalidad virtual parecen "correrse" hacia niveles de estrés altos en la modalidad presencial.


## Satisfacción

```{r}
barplot(table(BD2$SatisfaccionV),col=c("lightblue"),main = "Nivel de Satisfacción en modalidad virtual", ylab = "Cantidad de personas")
```

```{r}
barplot(table(BD2$SatisfaccionP),col=c("lightblue"),main = "Nivel de Satisfacción en modalidad presencial", ylab = "Cantidad de personas")
```

Con respecto a los gráficos, podemos concluir que el nivel de satisfacción de los alumnos encuestados es mayor en la modalidad presencial en comparación con la virtual.

## Calidad de enseñanza

```{r}
barplot(table(BD2$EnseñanzaV),col=c("lightblue"),main = "Nivel de calidad de enseñanza según los alumnos en la modalidad virtual", ylab = "Cantidad de personas")
```

```{r}
barplot(table(BD2$EnseñanzaP),col=c("lightblue"),main = "Nivel de calidad de enseñanza según los alumnos en la modalidad presencial", ylab = "Cantidad de personas")
```

Se ha usado una gráfica de barras para la visualización de los datos ya que nos permite comparar los niveles de calidad de enseñanza de los estudiantes encuestados. Se puede observar que la modalidad presencial tiene una mayor calidad de enseñanza en comparación con la virtual, ya que podemos observar que los estudiantes no consideran que la calidad de enseñanza presencial sea meritorio de una calificación como 0, en comparación con la modalidad virtual que existen respuestas que son 0.


Ahora veremos nuestras variables numéricas:

## Horas de estudio

```{r}
plotNormalHistogram(BD2$EstudioV, ylab = "Cantidad de personas", xlab = "Horas", main = "Horas de estudio en modalidad virtual", breaks = 10)
abline(v = mean(BD2$EstudioV), col = 'red', lwd = 2)
abline(v = median(BD2$EstudioV), col = 'green', lwd = 2)
legend(x = "topright", legend = c("Media", "Mediana"), lty = c(1, 1), col = c('red', 'green'), lwd = 2)

print("Media")
mean(BD2$EstudioV)
print("Mediana")
median(BD2$EstudioV)
print("Desviación estandar")
sd(BD2$EstudioV)
```

```{r}
plotNormalHistogram(BD2$EstudioP, ylab = "Cantidad de personas", xlab = "Horas", main = "Horas de estudio en modalidad presencial", breaks = 10)
abline(v = mean(BD2$EstudioP), col = 'red', lwd = 2)
abline(v = median(BD2$EstudioP), col = 'green', lwd = 2)
legend(x = "topright", legend = c("Media", "Mediana"), lty = c(1, 1), col = c('red', 'green'), lwd = 2)

print("Media")
mean(BD2$EstudioP)
print("Mediana")
median(BD2$EstudioP)
print("Desviación estandar")
sd(BD2$EstudioP)

```

Respecto a la variable de horas de estudio, tanto en la modalidad virtual y presencial la mediana es la misma, en este caso siendo su valor de 4, pero su media en ambos caso es mayor a la mediana,esto gracias a los datos atípicos en ambos casos (20 horas de estudio en la modalidad virtual y 17 horas de estudio en la modalidad presencial).

## Horas de sueño

```{r}
boxplot(BD2$SueñoV,BD2$SueñoP, col = c("red","blue"), xlab = "Modalidades", ylab = "Horas de sueño", main = "Horas de sueño en las diferentes modalidades")
legend(x = "topright", legend = c("Virtual", "Presencial"), col = c('red', 'blue'), lwd = 2)
print("Mediana de la modalidad virtual")
median(BD2$SueñoV)
print("Mediana de la modalidad presencial")
median(BD2$SueñoP)
print("Desviación estandar")
sd(BD2$SueñoP)
```

Como podemos observar la mediana en ambas modalidades son iguales, teniendo el valor de 6. Sus cuartiles 50% están casi a la par y si tenemos algo que destacar sería los datos atípicos que aparecen en ambas modalidades, siendo para la virtual el dato de 12 horas y en presencialidad el dato de 1 hora de sueño.


## Presupuesto diario en soles

```{r}
plotNormalHistogram(BD2$PresupuestoV, ylab = "Cantidad de personas", xlab = "Dinero en soles", main = "Presupuesto diario en modalidad virtual", breaks = 10)
abline(v = mean(BD2$PresupuestoV), col = 'red', lwd = 2)
abline(v = median(BD2$PresupuestoV), col = 'green', lwd = 2)
legend(x = "topright", legend = c("Media", "Mediana"), lty = c(1, 1), col = c('red', 'green'), lwd = 2)

print("Media")
mean(BD2$PresupuestoV)
print("Mediana")
median(BD2$PresupuestoV)
print("Desviación estandar")
sd(BD2$PresupuestoV)

```

```{r}
plotNormalHistogram(BD2$PresupuestoP, ylab = "Cantidad de personas", xlab = "Dinero en soles", main = "Presupuesto diario en modalidad presencial", breaks = 10)

abline(v = mean(BD2$PresupuestoP), col = 'red', lwd = 2)
abline(v = median(BD2$PresupuestoP), col = 'green', lwd = 2)
legend(x = "topright", legend = c("Media", "Mediana"), lty = c(1, 1), col = c('red', 'green'), lwd = 2)

print("Media")
mean(BD2$PresupuestoP)
print("Mediana")
median(BD2$PresupuestoP)
print("Desviación estandar")
sd(BD2$PresupuestoP)

```

En estos gráficos se observa la cantidad de alumnos que cuentan con ciertos rangos de presupuesto, tanto en la modalidad virtual como en la modalidad presencial. Como podemos observar aquí ya existe una diferencia un poco más marcada con respecto a la media y mediana entre las diferentes modalidades, ya que la mediana para la modalidad virtual fue de 20, en comparación con la presencial que fue de 25, también notamos una diferencia en la media que incrementó de un 20.70287 de la modalidad virtual a 27.76459 en la presencial, la media es mayor a la mediana debido a los casos atípicos que se presentan en ambas modalidades. Además, el pico de la curva de comportamiento en la gráfica de modalidad presencial es más alto, lo que representa que más personas cuentan con un presupuesto cercano a la media. Con estos datos podemos concluir que los alumnos cuentan con un presupuesto mayor en la modalidad presencial. Esto puede ser explicado por gastos de transporte, alimento y entretenimiento.

# Análisis descriptivo

Ahora analizaremos las relaciones entre nuestras variables:

## Relación entre las horas de estudio y las horas de sueño en las diferentes modalidades

```{r}
covarianzaP <- cov(x = BD2$SueñoP, y = BD2$EstudioP)
rP <- cor(x = BD2$SueñoP, y = BD2$EstudioP, method = "pearson")
covarianzaV <- cov(x = BD2$SueñoV, y = BD2$EstudioV)
rV <- cor(x = BD2$SueñoV, y = BD2$EstudioV, method = "pearson")

plot( BD2$SueñoP ,BD2$EstudioP, pch=20, col="orange", plot( BD2$SueñoV ,BD2$EstudioV, pch=17, col="black", ylab="Horas de estudio", xlab="Horas de sueño"), main="Comparación de horas de estudio y sueño", ylab="Horas de estudio", xlab="Horas de sueño")
abline(lm(BD2$EstudioP ~ BD2$SueñoP), col="blue")
abline(lm(BD2$EstudioV ~ BD2$SueñoV), col="red")
legend(x = "topright", legend = c("Virtual", "Presencial", "Pendiente Virtual", "Pendiente Presencial"), fill = c("black", "orange", "red", "blue"),title = "Leyenda")
print("El valor de la covarianza en la modalidad presencial es: ",)
covarianzaP
print("El valor de la correlación en la modalidad presencial es: ",)
rP
print("El valor de la covarianza en la modalidad virtual es: ",)
covarianzaV
print("El valor de la correlación en la modalidad virtual es: ",)
rV

print("El valor de la pendiente en la modalidad presencial es:")
lm(BD2$EstudioP ~ BD2$SueñoP)
print("El valor de la pendiente en la modalidad virtual es:")
lm(BD2$EstudioV ~ BD2$SueñoV)
```
Gracias al cálculo de la correlación, podemos decir que nuestra relación que vamos a desarrollar es válida, ya que se presenta en el rango de -1 a +1 para ambas modalidades, tomando como valor para la modalidad presencial: -0.1406949 y para la modalidad virtual: -0.167382. 
En este diagrama se puede observar la variación entre horas de estudio y de sueño en las modalidades presencial y virtual. Se puede ver que ambas pendientes son negativas, lo que significa que los estudiantes con mayor cantidad de horas de sueño obtienen una menor cantidad de horas de estudio. Por otro lado, se puede observar que la pendiente de la relación en la modalidad virtual es más inclinada que aquella de la modalidad presencial. Esto quiere decir que los alumnos, durante la modalidad presencial, duermen más, en relación con las horas que estudian. Finalmente, la línea de regresión lineal de la modalidad virtual se encuentra más arriba en el gráfico, lo que demuestra que los alumnos en esta modalidad estudian más que aquellos en la presencial. Algunas razones de esta diferencia pueden ser la cantidad de tiempo destinada en transporte, alistarse y distracciones.

## Relación entre las horas de estudio y el tiempo de transporte en la modalidad presencial

```{r}
temp <- BD2$TransporteP*(1/60)

covarianzaP2 <- cov(x = BD2$TransporteP, y = BD2$EstudioP)
rP2 <- cor(x = BD2$TransporteP, y = BD2$EstudioP, method = "pearson")

plot( temp, BD2$EstudioP, main="Gráfica de dispersión entre las horas de estudio y transporte", ylab="Horas de estudio", xlab="Tiempo de transporte (Horas)", col="red", pch=16)
abline(lm(BD2$EstudioP ~ temp,data=BD2), col="blue")

print("El valor de la covarianza en la modalidad presencial es: ",)
covarianzaP2
print("El valor de la correlación en la modalidad presencial es: ",)
rP2
print("El valor de la pendiente en la modalidad presencial es:")
lm(BD2$EstudioP ~ temp)
```

Gracias al calculo de la correlación, podemos decir que nuestra relación que vamos a desarrollar es valida, ya que se presenta en el rango de -1 a +1 al ser esta de valor -0.07764058.
En la gráfica podemos observar, la relación entre las horas de estudio y el transporte en la modalidad presencial. Notamos que a mayor cantidad de horas de transporte, las horas de estudio serán menores. La regresión lineal tiene una pendiente negativa. Además observando la gráfica podemos concluir que los estudiantes a los que les toma menos tiempo para venir a la universidad estudian menos. Y hay un porcentaje minoritario de estudiantes que dedica más tiempo al estudio.


## Relación entre el nivel de estrés y horas de sueño

```{r}
boxplot(BD2$SueñoV ~ BD2$EstresV, main="Boxplot de las horas de sueño y el nivel de estrés (VIRTUAL)", ylab="Horas de sueño", xlab="Nivel de estrés", col = 2:length(levels(chickwts$feed)))

lines(c(0,10), c(mean(BD2$SueñoV), mean(BD2$SueñoV)), col="red")


```

En este caso existen dos conclusiones, si bien en esta modalidad virtual
las horas de sueño son mayores a comparación de la modalidad presencial
esto no cambia el hecho de que se mantenga cierto comportamiento en los
estudiantes respecto al nivel de estrés. En este caso los que sienten
mayor estrés duermen en general poco, pero existen alumnos que a pesar de dormir
poco no sienten mucho estrés.

```{r}
boxplot(BD2$SueñoP ~ BD2$EstresP, main="Boxplot de las horas de sueño y el nivel de estrés (PRESENCIAL)", ylab="Horas de sueño", xlab="Nivel de estrés", col = 2:length(levels(chickwts$feed)))

lines(c(0,10), c(mean(BD2$SueñoP), mean(BD2$SueñoP)), col="red")

```

Se puede concluir en está gráfica de nivel de estrés y horas de sueño de
forma presencial, también dos comportamientos claros, para algunas
personas dormir poco conlleva a tener un alto grado de estrés. Por el
contrario, para otras personas dormir poco no es un detonante de estrés.

Para concluir observamos la linea trazada en la gráfica, esta nos muestra la media de sueño, en la cual podemos concluir que la media de sueño en la modalidad presencial es menor a la media de sueño en la modalidad virtual.

## Relación entre el nivel de estrés y el sexo de nuestros encuestados

```{r}
tabla1 <- table(BD2$Sexo, BD2$EstresP)
barplot(prop.table(tabla1,margin = 1),
        main = "Gráfico de barras del estrés presencial y el sexo de nuestros encuestados",
        xlab = "Nivel de estrés", ylab = "Sexo",
        col=c("lightblue","pink"),
        beside = FALSE)
legend("topleft",legend = c("Hombres", "Mujeres"),fill = c("lightblue","pink"))
```
Aquí podemos observar y volver a confirmar que hay mas hombres que mujeres que participaron en nuestra encuesta, posterior a ello también se puede observar que hay altos niveles de estrés dentro de la modalidad presencial, en donde el nivel 9 de estrés,que es el nivel con mayor numero de respuestas, está conformado por el 24% de las mujeres encuestadas y el 16% de hombres encuestados.

```{r}
tabla2 <- table(BD2$Sexo, BD2$EstresV)
barplot(prop.table(tabla2,margin = 1),
        main = "Gráfico de barras del estrés virtual y el sexo de nuestros encuestados",
        xlab = "Nivel de estrés", ylab = "Sexo",
        col=c("lightblue","pink"),legend = c("Hombres", "Mujeres"),
        beside = FALSE)
```
Ahora en este gráfico podemos observar que los niveles de estrés varían más, teniendo un menor numero de respuestas en los 2 niveles mas altos, aquí observamos que en el nivel 7 de estrés, el cual para este caso es el que tiene el mayor numero de respuestas, contiene al 24% de los hombres y el 20% de mujeres.

Ahora haciendo un contraste entre los 5 últimos niveles de estrés podemos observar que para la modalidad presencial este esta conformado por el 72% de los hombres aproximadamente y el 82.7% de las mujeres, que en total conforma el 77.99% de la población encuestada, en comparación con la modalidad virtual el cual esta conformado por el 62.4% de los hombres y el 93.3% de las mujeres encuestadas que en total conforma 76.07% de nuestros encuestados. Dando por conclusión, que los alumnos sienten un mayor nivel de estrés dentro de la modalidad presencial que en la virtual.

# Análisis probabilístico
## Análsis probabilístico de la variable "presupuesto virtual"
```{r}
BD2$PresupuestoV[BD2$PresupuestoV == 12.5] <- 13
BD2$PresupuestoV[BD2$PresupuestoV == 6.4] <- 6
plot(table(BD2$PresupuestoV)/nrow(BD2),main="Gráfico del presupuesto (Virtual)" , ylab="Probabilidad", xlab="Valor del presupuesto")
m0 <- round(mean(BD2$PresupuestoV), 0)
points(dpois(c(0:max(BD2$PresupuestoV)), m0), pch=20 ,col="red")
legend("topright", c("datos observados de la variable", "Distribución de poisson teórica"), col=c("black", "red"), lty =1, lwd=2, bty="n", cex=0.8 )

```
## Análisis probabilístico de la variable "presupuesto presencial"
```{r}
BD2$PresupuestoP[BD2$PresupuestoP == 3.5] <- 4
BD2$PresupuestoP[BD2$PresupuestoP == 12.5] <- 13
BD2$PresupuestoP[BD2$PresupuestoP == 54.8] <- 55
m1 <- round(mean(BD2$PresupuestoP), 0)

plot(table(BD2$PresupuestoP)/nrow(BD2), main="Gráfico del presupuesto (Presencial)" , xlab="Valor del presupuesto", ylab="Probabilidad")
points(dpois(c(0:max(BD2$PresupuestoP)), m1), pch=20, col="blue")
legend("topright", c("datos observados de la variable", "Distribución de poisson teórica"), col=c("black", "blue"), lty =1, lwd=2, bty="n", cex=0.8 )
```
### Análisis
Viendo el comportamiento por medio de gráficas del presupuesto que destinan diariamente los estudiantes de UTEC en ambas modalidades hemos identificado que se acerca mas a una distribución poisson, descartamos la binomial y binomial negativa debido a que no tiene sentido hablar de éxitos y fracasos respecto a la variable, pero sí hablar del monto que destina un alumno de UTEC por unidad de día. Por otro lado el parámetro $\lambda$ ha sido obtenido de la media teórica en ambas modalidades. Asimismo, descartamos la problematización en la modalidad virtual pues la distribución poisson no se aproxima al comportamiento de los datos.   

### Problematización:

El equipo sabe que la variable presupuesto presencial se comporta como una distribución poisson con media igual a 28, se quiere saber:
1. la probabilidad de que al seleccionar 10 estudiantes al azar exactamente 2 estudiantes digan que su presupuesto diario es a lo sumo 20 soles.

SOLUCIÓN:

Sea $\ Y$ la VAD que cuenta la cantidad de dinero que destina cada estudiante de UTEC por día.\n
Y ~ Poiss($\lambda=28$)\n
Nos piden P(Y<=20)\n

Sea $\ X$ la VAD que cuenta el numero de estudiantes que a lo mucho su presupuesto es 20 soles.\n
X ~ Bin(n=10, p=ppois(20,28))\n
Nos piden: P(X=2)

```{r}
p <- ppois(20, lambda=28, lower.tail=TRUE)
cat("La probabilidad de que un estudiante destine como presupuesto a los sumo S/. 20 es: ", p, " \n")
Prob <- dbinom(2, 10, p)
cat("La probabilidad de que al seleccionar 10 estudiantes al azar 2 destinen presupuesto a lo sumo S/. 20 es: ", Prob, "\n")
cat("El siguiente gráfico describe el comportamiento de la nueva VAD que cuenta los éxitos")
plot(dbinom(0:10, 10, p), pch=18, col="purple", ylab="Probabilidad", xlab="Número de estudiantes", main="Gráfico de la binomial que cuenta el\n número de estudiantes que a lo sumo gastan S/.20 por día")
```

---------------------------------------------------------

## Análisis probabilístico de la variable "Sueño virtual"
```{r}
muV <- mean(BD2$SueñoV)
sigmaV <- sd(BD2$SueñoV)
v <- table(BD2$SueñoV)/nrow(BD2)
hist(BD2$SueñoV, 10, freq = FALSE, main="Histograma de la variable horas de sueño (Virtual)", xlab="Horas de sueño", ylab="Probabilidad", col="pink")
lines(density(BD2$SueñoV, na.rm = TRUE), col="red", lwd=3)
curve(dnorm(x, muV, sigmaV), lwd=3, col="green" ,add = T)
legend("topright", c("Curva observada en la variable", "Curva normal Teórica"), col=c("red", "green"), lty =1, lwd=2, bty="n", cex=0.8 )


```
## Análisis probabilístico de la variable "Sueño presencial"

```{r}
muP <- mean(BD2$SueñoP)
sigmaP <- sd(BD2$SueñoP)
hist(BD2$SueñoP, 10, freq = FALSE, main="Histograma de la variable horas de sueño (Presencial)", xlab="Horas de sueño", ylab="Densidad", col="skyblue")
lines(density(BD2$SueñoP, na.rm = TRUE), col="orange", lwd=3)
curve(dnorm(x, muP, sigmaP), lwd=3, col="purple" ,add = T)
legend("topright", c("Curva observada en la variable", "Curva normal Teórica"), col=c("orange", "purple"), lty =1, lwd=2, bty="n", cex=0.7 )

```
### Análisis probabilístico:

```{r}
#modalidad virtual
dTeorica1 <-(pnorm(muV-2*sigmaV, muV, sigmaV, lower.tail = FALSE)-pnorm(muV+2*sigmaV, muV, sigmaV, lower.tail = FALSE))*100
data1 <- table(BD2$SueñoV)/nrow(BD2)
#data1
dExperimental1 <- 98.09
cat("El ", dExperimental1, "% de los datos está entre 2.68 horas y 9.38 horas en la modalidad virtual experimental, mientras que el ", dTeorica1, "% en la teórica\n")
#modalidad presencial
dTeorica2 <- (pnorm(muP-2*sigmaP, muP, sigmaP, lower.tail = FALSE)-pnorm(muP+2*sigmaP, muP, sigmaP, lower.tail = FALSE))*100
data2 <- (table(BD2$SueñoP)/nrow(BD2))*100
#data2
dExperimental2 <- 81.82
cat("El ", dExperimental2, "% de los datos está entre 3.97 horas y 7.31 horas en la modalidad presencial experimental, mientras que el ", dTeorica2, "% en la teórica")
```
* Al realizar un histograma de los datos de la variable "horas de sueño" en ambas modalidades, nos damos cuenta que es muy probable que sigan un modelo de VAC normal, para estar seguros requerimos obtener los parámetros $\mu$ y $\sigma$. Al obtener los parámetros y hacer una representación de la función densidad en los histogramas se puede observar que se aproximan en gran medida al comportamiento de los datos obtenidos en la encuesta.
* Respecto a la densidad de los datos, por teoría se sabe que el 95,44% de los datos están entre $\mu-2 \sigma$ y $\mu+2 \sigma$. En la normal teórica obtenida se cumple para amabas modalidades y es exactamente 95.44%, mientras que en los datos obtenidos tenemos 98.09% en la modalidad virtual y 81.82% en la modalidad presencial, esto nos indica que la normal teórica no es un modelo que describe exactamente la variable "horas de sueño" en ambas modalidades lo cual es correcto. 

### Problematización:
Si se selecciona al azar una persona del estudio estadístico en base a la distribución normal teórica el equipo desea saber:
1. la probabilidad de que la persona duerma mas de 10 horas en ambas modalidades.
2. la probabilidad de que duerma entre 2 y 6 horas en ambas modalidades.

SOLUCIÓN 1:

Sea $\ Y$ la variable aleatoria que cuenta las horas que duerme una estudiante.\n
Y ~ Norm($\mu=6.08$, $\sigma=1.65$) en la modalidad virtual.

y ~ Norm($\mu=5.64$, $\sigma=1.66$) en la modalidad presencial.

Nos piden P(Y>=10)

```{r}
p1 <- pnorm(10, muV, sigmaV, lower.tail=FALSE)*100  # modalidad virtual
cat("- La probabilidad de que la persona seleccionada duerma mas de 10 horas es ", p1, "% en la virtualidad\n")
p2 <- pnorm(10, muP, sigmaP, lower.tail=FALSE)*100  #modalidad presencial
cat("- La probabilidad de que la persona seleccionada duerma mas de 10 horas es ", p2, "% en la presencialidad\n")
cat("- Asimismo, es más probable que el estudiante seleccionado duerma en la modalidad virtual que en la presencial\n")
```

SOLUCIÓN 2:

Nos piden P(2 <= Y <= 6)

```{r}
#Para la segunda pregunta
p3 <- (pnorm(2,muV, sigmaV, lower.tail = FALSE)-pnorm(6, muV, sigmaV, lower.tail = FALSE))*100 # modalidad virtual
p4 <- (pnorm(2,muP, sigmaP, lower.tail = FALSE)-pnorm(6, muP, sigmaP, lower.tail = FALSE))*100  # modalidad presencial
cat("Se puede afirmar que la probabilidad de dormir entre 2 y 6 horas es ", p4, "% en la modalidad presencial, mientras que un ", p3, "% en la modalidad virtual. Siendo mayor la probabilidad en la modalidad presencial.\n")
```


## Analizando la variable de horas de estudio en ambas modalidades

### Horas de estudio virtual
```{r}
muEV <- mean(BD2$EstudioV)
muEV
sigmaEV <- sd(BD2$EstudioV)
sigmaEV

hist(BD2$EstudioV, 10, freq=FALSE, main="Histograma de la variable horas de estudio (Virtual)", xlab="Horas de estudio (Virtual)", ylab="densidad", col="green", xlim=c(0,max(BD2$EstudioV)), ylim=c(0, 0.25))
lines(density(BD2$EstudioV, na.rm = TRUE), col="blue", lwd=3)
curve(dnorm(x, muEV, sigmaEV), lwd=3, col="yellow" ,add = T)
legend("topright", c("Curva observada en la variable", "Curva normal Teórica"), col=c("blue", "yellow"), lty =1, lwd=2, bty="n", cex=0.7 )


```

### Horas de estudio presencial
```{r}
muEP <- mean(BD2$EstudioP)
muEP
sigmaEP <- sd(BD2$EstudioP)
sigmaEP

hist(BD2$EstudioP,10, freq=FALSE, main="Histograma de la variable horas de estudio (Presencial)", xlab="Horas de estudio (Presencial)", ylab="densidad", col="orange", xlim=c(0,max(BD2$EstudioP)), ylim=c(0, 0.25))
lines(density(BD2$EstudioP, na.rm = TRUE), col="blue", lwd=3)
curve(dnorm(x, muEP, sigmaEP), lwd=3, col="yellow" ,add = T)
legend("topright", c("Curva observada en la variable", "Curva normal Teórica"), col=c("blue", "yellow"), lty =1, lwd=2, bty="n", cex=0.7 )

```

Después de un análisis exhaustivo el comportamiento de la variable estudio tanto en la modalidad presencial y virtual no se aproxima a un modelo probabilístico de variable aleatoria continua para la media y desviación estándar obtenida. cabe mencionar que el posible modelo mas aproximado es una distribución normal.


## Análisis probabilístico de la variable "transporte presencial"

```{r}
mu9 <- round(mean(BD2$TransporteP), 0)
table(BD2$TransporteP)
hist(BD2$TransporteP, 10, freq=FALSE, main="Histograma de la variable Transporte", xlab="Tiempo (minutos)", ylab="densidad", col="skyblue", ylim=c(0,0.020))
lines(density(BD2$TransporteP, na.rm = TRUE), col="green", lwd=3)
curve(dexp(x, 1/mu9), lwd=3, col="red" ,add = T)
legend("topright", c("Datos observados de la variable", "Distribución exponencial teórica"), col=c("green", "red"), lty =1, lwd=2, bty="n", cex=0.8 )
```

### Análisis probabilístico:

* Realizando un histograma y la linea de densidad del tiempo de transporte de los estudiantes UTEC, se puede observar que la densidad de datos es mayor con tendencia a tiempo igual a 0, y menos denso con tendencia hacia el infinito positivo, esto nos hace pensar que es probable que se comporte como una exponencial. Si graficamos la VAC exponencial con parámetro $\lambda$ equivalente a la inversa de la media de la variable en estudio, se puede identificar que para un tiempo mayor a 20 aproximadamente los datos se aproximan más a la exponencial teórica, mientras que los valores menores a 20 no obedecen dicho comportamiento. Asimismo, cabe mencionar que eso representa el 68.57% y 31.43% de los datos respectivamente. Cabe destacar que no se descarta el modelo exponencial debido a que trabajamos con la muestra de la población en estudio.
```{r}
a <- pexp(20, 1/53, lower.tail=FALSE)*100
cat("El porcentaje de valores que se encuentran para un tiempo mayor a 20 es ", a, "%\n")
b<- pexp(20, 1/53)*100
cat("El porcentaje de valores que se encuentran para un tiempo menor a 20 es ", b, "%\n")

```

* El parámetro lambda de la función de densidad de la exponencial se ha obtenido con la inversa la media teórica de los datos.


### Problematización:

el equipo investigador sabe que el tiempo destinado de los estudiantes de UTEC para transportarse a la universidad tiene un modelo exponencial con media 53 minutos, se desea saber:

1. Si se escogen 10 estudiantes al azar de la base de datos, calcular la probabilidad de que al menos 5 lleguen por lo menos en 40 minutos.  

SOLUCIÓN:

Sea $\ Y$ la VAC exponencial que cuenta los minutos que demora un estudiantes en llegar a la universidad.
Y ~ exp(lambda = 1/53)

Nos piden P(Y>=40)

sea X la variable aleatoria que cuenta el numero de estudiantes que llegan a la universidad en por lo menos 40 minutos.
X ~ Bin(n=10, p=pexp(40, 1/53, lower.tail=FALSE))

Nos piden P(X>=5)

```{r}
z <- pexp(40, 1/53, lower.tail = FALSE)
cat("- La probabilidad de que un estudiante demore por lo menos 40 minutos es: ", p, "\n")
z1 <- pbinom(5, 10, z ,lower.tail=FALSE)
cat("- Mientras que la probabilidad de que 5 estudiantes de 10, lleguen a la universidad en por lo menos 40 minutos es ", z1, "\n")
plot(pbinom(0:10, 10, z, lower.tail = FALSE), pch=18, col="red", ylab="Probabilidad", xlab="Numero de estudiantes", main="Grafico de la Binomial que cuenta el número de estudiantes\n que demoran por lo menos 40 minutos en ir a UTEC")
```