---
title: "Segunda Entrega P2"
author: "Estadística y Probabilidad 1"
date: "24 de Junio del 2022"
output:
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: journal
  html_document:
    toc: yes
    df_print: paged
---

#<div style="text-align: justify">

S9 Transporte y tráfico

Integrantes: 

  + Fabrizio Natal Fuentes-Castro (líder)
  + Javier Pereda 
  + David Astulle
  + Diego Díaz
  + Jan Paul Valle
  
# Contenidos

1. Introducción
   - Relevancia del tema escogido
   - Planificación 
   
2. Datos 
   - Proceso de recolección de datos
   - Población, muestra y muestreo
   - Variables
   - Limpieza de base de datos
  
3. Análisis descriptivo

4. Probabilidades

5. Variables aleatorias y modelos

6. Conclusión

--- 

# 1 Introducción

**1.1 Relevancia:**

Muchos de los estudiantes viven en zonas muy alejadas a UTEC por lo que para llegar a sus clases presenciales utilizan distintos medios de transporte, como lo pueden ser bicicletas, autos, motos, taxis, buses, entre otros. Sin embargo, en ciertos casos durante el trayecto se suele perder mucho tiempo por el tráfico, el cual es considerablemente alto en la ciudad de Lima provocando que muchos estudiantes no logren llegar a las clases a tiempo. Es por eso que consideramos que sería interesante el conocer cual es la preferencia de los estudiantes como medio de transporte y cuanto tiempo pierden en el tráfico para así poder relacionarlo con su rendimiento académico. El cual se puede ver afectado de forma negativa debido a que puede que no alcancen algunas clases o el cansancio y el estrés que puede generar los trayectos largos con un tráfico pesado. Además, para saber de donde provienen los datos, en una primera instancia verificaremos donde se encuentra la mayor parte de nuestra muestra analizando las variables edad y ciclo. 

**1.2 Planificación:** 

```{r}
library(ggplot2)

data <- data.frame(Presentaciones = c('Seleccion de temas', 'Presentacion de temas', 'Eleccion del mejor tema', 'Retroalimentacion del docente', 'Elaboracion del cuestionario', 'Recoleccion de datos', 'Limpieza de datos', 'Analisis descriptivo'), 
Dias = c(1, 13, 14, 18, 23, 31, 38, 40),
dias_fin = c(13, 14, 21, 20, 30, 39, 40, 42)
)

ggplot(data, aes(x=Dias, xend=dias_fin, y=Presentaciones, yend=Presentaciones)) +
  geom_segment()
```
Para entender mejor este gráfico debemos suponer que el valor de 1 es el 25 de Marzo del 2022 y el 42, el 5 de mayo del 2022.

# 2 Datos

**2.1 Proceso de recolección de datos:**

Primero, con la ayuda del docente, completamos la encuesta en Google Forms. Desde el primer día nos dispusimos a enviarla por medio de Gmail a los correos de todos los alumnos de UTEC. Además, para llegar al mínimo de 200 observaciones, compartimos la encuesta en grupos de mentorías, trabajos de otros cursos, chats de estudio, entre otros. Se utilizaron estrategias como que la encuesta sea bastante concisa, breve y bien contextualizada, de manera que los estudiantes no cierren la encuesta antes de terminarla. También que muchas de las preguntas no requieren que el encuestado escriba su respuesta, sino que se le brinda opciones en las que sólo tiene que hacer un click (esto además ayuda a evitar datos erróneos originados por errores de escritura, ortografía, etc.). Se decidió recopilar la información de esta manera pues era la forma más rápida y sencilla de acceder a un considerable grupo de alumnos de UTEC.

**2.2 Población, muestra y muestreo :**

Para la realización de este proyecto estamos considerando al alumnado de UTEC de todas las carrera y de todos los ciclos como nuestra población objetivo, donde también podemos afirmar que nuestra unidad muestral es un alumno de UTEC. Además, para este caso se ha decido tomar una muestra de 200 alumnos de nuestra población total. Esta muestra estadística presenta una representatividad sobre toda la población debido a que abarca la situación de diversas personas de diversos distritos, donde la mayoría toma la decisión de utilizar el mismo medio de transporte por lo que asemejaría a otro individuo que viva en la misma zona pero que no se encuentre en la muestra. El tener una muestra diversa de ubicaciones nos permite poder tener una imagen más clara de la situación que queremos estudiar. Para este estudio hemos realizado un muestreo por conveniencia pues hemos utilizado los datos de las primeras 200 personas que pudieron participar en el estudio dentro de la población de alumnos de UTEC. Sin embargo, como se ha explicado antes esta si presenta una representatividad sobre la población. 

**2.3 Variables:** 

Las variables que hemos desarrollado en el proyecto son 17 y son las siguientes: 

  + Edad (Numérica discreta), con restricción de que sea un número entero no menor de 15.
  + Género (Categórica nominal), con restricción de que sea masculino o femenino.
  + Carrera (Categórica nominal), con restricción de que se encuentre dentro de las opciones que ofrece la universidad.
  + Ciclo (Numérica discreta), con restricción que sea un número entero entre 1 y 10.
  + Distrito (Categórica nominal), con restricción que sea un distrito de Lima.
  + Tipo de transporte (Categórica nominal), con restricción que sea un medio de transporte existente.
  + Hora de salida (Categórica ordinal), con restricción que sea lo más temprano que se sale a la semana y que los valores estén entre las 0 y 24 horas. 
  + Tiempo de viaje (Numérica continua), con restricción que sea un número no negativo y convertido a minutos. 
  + Tiempo perdido en tráfico (Numérica continua), con restricción que sea un número no negativo y convertido en minutos.
  + Nivel de cansancio (Categórica ordinal), con restricción de que no sea un valor por debajo de 1 ni por encima de 5.
  + Nivel de estrés (Categórica ordinal), con restricción de que no sea un valor por debajo de 1 ni por encima de 5.
  + Dolor físico (Categórica nominal), con restricción que la respuesta sea de si o no. 
  + Tipo de dolor (Categórica nominal), con restricción de que si en la anterior respondió no, que se escoja la opción de no tengo dolores, de lo contrario que sea uno de los existentes en la lista.
  + Tardanzas (Numérica discreta), con restricción de que sea un entero no negativo y no mayor de 6. 
  + Cantidad de movilizaciones(Numérica discreta),con restricción de que sea un entero no negativo y no mayor de 6. 
  + Horas de sueño (Numérica discreta), con restricción que sea en horas redondeado a un entero no menor de 2 y tampoco mayor de 15. 
  + Tiempo para salud (Categórica ordinal),  con restricción de que no sea un valor por debajo de 1 ni por encima de 5.
  
**2.4 Limpieza de base de datos:** 

Para limpiar la base de datos y garantizar que esta es de gran utilidad, utilizaremos la ayuda de Rstudio y para eso tendremos que verificar que todas las variables no tengan datos sin sentido. Primero vamos a verificar si existen datos faltantes en la base de datos y para eso utilizamos el comando is.na que nos ayudará a verificar esto. Luego de darnos cuenta que no hay datos faltantes empezaremos a analizar las respuestas con ayuda de R. Como en el formulario gran parte de las opciones son para marcar y para colocar números enteros, es imposible que encontremos casos en los que donde debería ir un número hay una letra, por lo que nos enfocaremos en buscar datos sin sentido. Para la variable edad utilizaremos la función filter de la librería dplyr filtrando las edades entre a menores de 16 y mayores de 30 para ver si encontramos datos extraños. Para la variable género solo se puede marcar dos opciones así que lo único sería verificar que no existan valores que no sean masculino y femenino con la ayuda de filter nuevamente. Mismo caso para la variable carrera universitaria pues también es para marcar.

Luego para la variable ciclo utilizaremos también el comando filter para buscar si existen valores por debajo de 1 y por encima de 10 pues son valores inexistentes y que deberían trabajarse. Para variables que se responden marcando distintas opciones como distrito, transporte, el grado de cansancio, grado de estrés, existencia de dolor físico, tipo de dolor físico, tardanzas, veces de desplazamiento y el cuidado de la salud física no deben tener datos sin sentido. De todos modos se confirmaran filtrando a ver si existen respuestas que no correspondan a las opciones. Para la hora deberemos filtrar a ver si existe algún valor que esté por debajo de las 00 horas y por encima de las 24 horas. Para el caso de las variables de tiempo y tiempo perdido por tráfico debemos de filtrar para asegurarnos que no existen valores muy grandes ni tampoco valores por debajo de 1. Posteriormente, debemos filtrar la variable de horas de sueño para verificar que no existan valores por debajo de 3, ni por encima de 15, esto porque rara vez se logra alcanzar estos valores y de encontrarlos se debería analizarlos. Por último, una buena forma de demostrar que todo está en orden es revisar el resumen de la base de datos para ver si las variables tienen su tipo correspondiente y no se encuentra ningún error.

Además, luego de verificar que todo esté en orden, corregiremos los datos y variables que tengan errores por las tildes o ñ con ayuda de los comandos mutate para los datos y rename para las variables. De esta forma ya podríamos, aplicando el comando write_csv, guardar nuestra base de datos limpia. Parte de este cambio también es asignarle a las variables ordinales un valor desde muy poco a mucho según sea la variable y esto también lo lograremos con el comando mutate.


# 3 Análisis Descriptivo

Para empezar a desarrollar el análisis primero debemos cargar las librerías que utilizaremos y la base de datos limpia.

```{r}
if(!require(tidyverse)){install.packages('tidyverse')}
library(tidyverse)
if(!require(readr)){install.packages('readr')}
library(readr)
if(!require(dplyr)){install.packages('dplyr')}
library(dplyr)
if(!require(stringr)){install.packages('stringr')}
library(stringr)
if(!require(car)){install.packages('car')}
library(car)
if(!require(gmodels)){install.packages('gmodels')}
library(gmodels)
```
Tidyverse es una librería que funciona como una carpeta de otras buenas librerías como lo puede ser ggplot, luego se encuentran la readr para leer la base de datos, la dplyr si necesitamos manipular esta base de datos, car para poder realizar otras modificaciones de necesitarlo. Ahora leeremos la base de datos limpia. 

```{r}
S9 <- read.csv("DatosLimpios.csv", header = T, sep = ',')
```
```{r}
S9
```

Como podemos observar tenemos 200 observaciones con 17 variables en nuestra base de datos, por lo que ahora realizaremos el análisis descriptivo correspondiente para determinar los objetivos que buscábamos al realizar el proyecto sobre este tema.

Primero vamos a lo básico y queremos saber y analizar de donde provienen los datos y para eso podemos desarrollar gráficos y descriptores que nos ayuden a lograr eso.

**3.1 Análisis univarial:** 

**3.1.1 Variable Edad**

```{r}
prom <- round(mean(S9$Edad),digits= 2)
prom
med <- round(median(S9$Edad),digits= 2)
med
hist(S9$Edad,breaks = 15, col= "lightyellow" , main = "Gráfico 1: Histograma de Edades",xlab= "Edades", ylab= "Frecuencia" )
abline(v = prom,col= "red", lwd=2)
abline(v = med, col = "blue", lwd=2, lty = 2)
legend("topright",bty= "n", legend = c("media","mediana"),col = c("red", "blue"),lwd =2, lty= 1:2)
```

Podemos observar que la mayoría de personas que respondieron la encuesta están entre los 17 y 18 años, sin embargo el valor de nuestra mediana se encuentra en 19 y el de la media en 19.3, los cuales se pueden visualizar mejor como lineas en el gráfico. Sin embargo, no solo podemos determinar la moda de forma gráfica, también podemos determinarla con ayuda de los comando de R como veremos con el caso de ciclo.

**3.1.2 Variable ciclo**
```{r}
frecuencias <- data.frame(table(S9$Ciclo))
moda <- frecuencias[which.max(frecuencias$Freq),1]
moda
med1 <- round(median(S9$Ciclo),digits= 2)
med1
barplot(table(S9$Ciclo),col= "lightgreen", main= "Gráfica 2: Ciclos de los encuestados", xlab= "Ciclo Universitario", ylab= "Cantidad de encuestados")
abline(v = moda,col= "red", lwd=2)
abline(v = med1, col = "blue", lwd=2, lty = 2)
legend("topright",bty= "n", legend = c("moda","mediana"),col = c("red", "blue"),lwd =2, lty= 1:2)
```
Como vimos, ya sabíamos de antelación que la moda era 3 pero también nos podemos apoyar de forma gráfica con ayuda de los gráficos de barras, donde vemos que la moda se encuentra en el valor de 3. Por lo tanto podemos afirmar que la mayoría de los encuestados son alumnos de UTEC de 3 ciclo con edades entre 17 y 18 años. 

**3.1.3 Variable tiempo de viaje**

Primero para ser un análisis propio podemos realizar un boxplot para ver si existen valores atípicos: 

```{r}
boxplot(S9$viaje,col="blue", main = "Gráfico 3: Tiempo de Viaje", ylab="tiempo de viaje(min)")
```
Como podemos observar no hay datos atípicos por lo que sería interesante descubrir algunos de los descriptores numéricos más interesantes y analizar los resultados.

```{r}
cat('Media:',round(mean(S9$viaje, na.rm=TRUE),2),'\n') 

cat('Mediana:',round(median(S9$viaje, na.rm=TRUE),2),'\n') 

cat('Desviación Estándar:',round(sd(S9$viaje, na.rm=TRUE),2),'\n') 

cat('Rango:',round(range(S9$viaje, na.rm=TRUE),2),'\n') 

cat('Rango Intercuartílico:',round(IQR(S9$viaje, na.rm=TRUE),2),'\n') 

cat('Coeficiente de Variación:', round((sd(S9$viaje, na.rm=TRUE)/mean(S9$viaje, na.rm=TRUE))*100,2),'\n')
```
Podemos ver acá que los alumnos llegan a la UTEC en promedio en 58.16 minutos y que la mediana de valores se encuentra en 47.5 minutos. Con estos valores podemos asegurar que esta variable está sesgada hacia la derecha. A través de la gráfica podemos observar lo mismo pues el ancho de la caja es mayor después de la mediana. También podemos ver que el tiempo mínimo es de 5 minutos y el máximo de 180, dándonos un rango de 175, el cual es mucho mayor que el rango intercuartílico, que nos muestra la diferencia entre el percentil 75 y el percentil 25, la cual es de 60. Aparte de eso, también podemos observar que la desviación estándar es de 39.72, la cual no es tan grande respecto a los valores que tenemos pero sigue siendo considerable por lo que se puede asumir que hay una distribución media de los datos. Además, esto lo podemos ver aún más con el coeficiente de variación, que nos muestra la variabilidad de los datos, sin embargo, en este caso tiene un valor de 68.28% por lo que existe una variabilidad y la media perdería un poco de valor. 

**3.1.4 Variable tiempo en tráfico**

Primero para ser un análisis propio podemos realizar un boxplot para ver si existen valores atípicos: 

```{r}
boxplot(S9$Trafico,col="red", main = "Gráfico 4: Tiempo perdido en tráfico", ylab="tiempo en tráfico(min)")
```
En este caso si podemos observar datos atípicos por lo que calcular valores como la media podía ser un poco impreciso, aun así calcularemos otros descriptores numéricos que nos pueden servir para analizar la variable: 

```{r}
cat('Mediana:',round(median(S9$Trafico, na.rm=TRUE),2),'\n') 

cat('Desviación Estándar:',round(sd(S9$Trafico, na.rm=TRUE),2),'\n') 

cat('Rango:',round(range(S9$Trafico, na.rm=TRUE),2),'\n') 

cat('Rango Intercuartílico:',round(IQR(S9$Trafico, na.rm=TRUE),2),'\n') 

cat('Coeficiente de Variación:', round((sd(S9$Trafico, na.rm=TRUE)/mean(S9$Trafico, na.rm=TRUE))*100,2),'\n')
```
En este caso vemos que la mediana es de 20 minutos, es decir, que hay una mitad por debajo de ese valor y la otra mitad por arriba de ese valor. En este caso el valor de la desviación es menor pero también lo son el máximo y el mínimo, siendo estos 120 y o respectivamente. Es por eso que el valor de 19.04 de desviación estándar tampoco es un valor tan grande pues el rango es de 120 pero aún así es considerable. Además, gracias al coeficiente de variación podemos confirmar lo ya antes dicho de forma gráfica, y es que la media no tiene mucho valor. En este caso es más notorio que en el anterior debido a que el coeficiente de variación tiene un valor de 86.28%, un valor que está tan cerca de 1 que nos garantiza que hay mucha variabilidad y que la media no tiene tanto valor. 

**3.1.5 Variable horas de sueño**

Primero para ser un análisis propio podemos realizar un boxplot para ver si existen valores atípicos: 

```{r}
boxplot(S9$Descanso,col="lightgreen", main = "Gráfico 5: Horas de sueño", ylab="Horas de sueño(horas)")
```
Como podemos observar no hay datos atípicos por lo que sería interesante descubrir algunos de los descriptores numéricos más interesantes y analizar los resultados.

```{r}
cat('Media:',round(mean(S9$Descanso, na.rm=TRUE),2),'\n') 

cat('Mediana:',round(median(S9$Descanso, na.rm=TRUE),2),'\n') 

cat('Desviación Estándar:',round(sd(S9$Descanso, na.rm=TRUE),2),'\n') 

cat('Rango:',round(range(S9$Descanso, na.rm=TRUE),2),'\n') 

cat('Rango Intercuartílico:',round(IQR(S9$Descanso, na.rm=TRUE),2),'\n') 

cat('Coeficiente de Variación:', round((sd(S9$Descanso, na.rm=TRUE)/mean(S9$Descanso, na.rm=TRUE))*100,2),'\n')
```
Vemos en este caso que en promedio los participantes duermen 6.74 horas y la mediana es 7 por lo que podemos decir que es prácticamente simétrica, cosa que podemos confirmar también viendo el gráfico. Vemos que el valor del mínimo es de 3 y el máximo es de 10 por lo que el rango es de 7. Vemos en este caso que la desviación estándar tiene un valor pequeño pero es considerable por el rango por lo que aun hay una pequeña variación. Por último, el valor del coeficiente de variación nos ayuda a determinar que no existe mucha variabilidad de los datos pues el valor 19.43 se acerca más a 0 que a 100.

**3.2 Relación entre variables categóricas**

Otra variable que nos interesaría analizar es cual es el distrito de donde más personas vienen a la universidad y cual es el de donde vienen menos y de misma forma con el transporte, cual se usa más y cual menos. Determinar esto nos servirá más adelante para relacionar variables y realizar conclusiones. Lo anterior lo podemos determinar ya sea gráficamente o por medio de los comandos de R y eso haremos a continuación: 

```{r}
table(S9$Transporte)
```
Acá podemos ver claramente que el transporte más utilizado es el metropolitano y el menos utilizado es la motocicleta. Esto puede significar que mucha gente viene de largas distancias y ahí cae la necesidad de usar el metropolitano, aun así, esto se verificará después con otros análisis. Sin embargo, esto también se puede sacar con ayuda de la función de moda como haremos con el distrito. 
```{r}
frecuencias1 <- data.frame(table(S9$Distrito))
moda1 <- frecuencias1[which.max(frecuencias1$Freq),1]
moda1
min1<- frecuencias1[which.min(frecuencias1$Freq),1]
min1
```
De esta forma también podemos determinar lo mismo y es que la mayoría de los encuestados residen en Santiago de Surco y la minoría en Punta Hermosa. Además, también podríamos relacionar estas variables con el género para saber cuantos hombres y mujeres corresponden a los resultados anteriores y para esto podemos hacer tablas cruzadas. A continuación se presenta la tabla 1: Distrito vs género.

```{r}
CrossTable(S9$Distrito,S9$Genero, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```
Podemos observar en esta tabla cruzada, gráfica de mucha utilidad para explicar relaciones entre categóricas y categóricas, la cantidad de hombres y mujeres que hay por cada distrito de Lima que van a la UTEC. Además, gracias a esta tabla podemos darnos cuenta que Punta Hermosa no es el único distrito mínimo, si no que Santa Rosa tiene el mismo valor. Además, otro punto a considerar es que la tabla se ve muy grande por lo que podría ser interesante para una mejor visualización en la que se zonifiquen los distritos por zonas para una mejor visualización. Por lo tanto haremos lo siguiente: 

```{r}
S9 %>% mutate(Zona =
      ifelse(Distrito %in% c("Ancon","Carabayllo","Santa Rosa","Puente Piedra","Comas", "Los Olivos", "San Martin de Porres", "Independencia"), "Lima Norte",
      ifelse(Distrito %in% c("San Juan de Lurigancho", "Lurigancho", "Ate", "El Agustino", "La Molina", "Santa Anita", "Cieneguilla", "Chacaclayo"), "Lima Este",
      ifelse(Distrito %in% c("San Juan de Miraflores", "Chorrillos", "Lurin", "Pachacamac", "Punta Negra", "San Bartolo", "Villa el salvador", "Villa Maria del Triunfo", "Punta Hermosa", "Santa Maria del Mar", "Pucusana", "San Luis"), "Lima Sur",
      ifelse(Distrito %in% c("Miraflores", "Rimac", "Brena", "Pueblo Libre", "Cercado de Lima", "Jesus Maria", "Magdalena del Mar", "San Miguel", "Surquillo", "Santiago de Surco", "Barranco", "San Borja", "Lince", "San Isidro", "La Victoria"), "Lima Centro", Distrito))))) -> S9
S9 %>% count(Zona)
```
Vemos ahora que se ha reducido considerablemente la cantidad de distritos a solo 4 categorías que definen en que zona de Lima se encuentran. Por lo tanto ahora podemos volver a realizar el proceso de realización de una tabla cruzada para tener una mejor visualización. A continuación se presenta la tabla 2: Zona de residencia vs género.

```{r}
CrossTable(S9$Zona,S9$Genero, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```
En esta tabla podemos ver los datos con mucha mayor facilidad que en el caso anterior por lo que con seguridad podemos decir por ejemplo que hay una mayor cantidad de hombres que vienen desde Lima centro, mientras que hay una mayor cantidad de mujeres que provienen de Lima Este o de Lima norte. En el caso del sur de Lima es casi lo mismo para ambos géneros. 
También podemos desarrollar otro tipo de relación entre variables categóricas, en este caso sería interesante determinar la relación que existe entre las variables de dolor con transporte. Pues es posible que el dolor que se presenta se deba a el tipo de transporte. 

```{r}
tabla5 <- table(S9$Transporte, S9$Dolor)
mosaicplot(tabla5,color = "skyblue", main = "Gráfico 6: Dolor creado por transporte", xlab = "Tipo de transporte", ylab= "Dolor")
```
Acá observamos algo curioso y es que las personas que vienen en auto particular y en taxi son las que menos dolores reportan, seguido de otros medios de transporte como bus y bicicleta, los cuales reportan una mayor cantidad de si pero no mayor que el no. Sin embargo, si observamos el metropolitano y la combi son los que reportan mayor cantidad de si. Esto puede deberse a la cantidad de personas que utilizan estos medios al día o el movimiento que hay durante el traslado.

Para confirmar esto, puede ser interesante realizar un diagrama de dispersión con clases para ver cuales medios de transporte tienen la mayor cantidad de tiempo de viaje: 


```{r}
plot(S9$viaje,S9$Trafico,col = ifelse(S9$Transporte == "Metropolitano","blue", ifelse(S9$Transporte == "Taxi","yellow",ifelse(S9$Transporte == "Bicicleta","red",ifelse(S9$Transporte == "Patineta", "green", ifelse(S9$Transporte == "Auto particular", "orange",ifelse(S9$Transporte == "Bus", "pink", ifelse(S9$Transporte == "Combi", "skyblue",ifelse(S9$Transporte == "Otro medio de transporte", "lightgreen", ifelse(S9$Transporte == "Motocicleta", "grey","black"))))))))),pch=17,main = "Gráfico 7: Tiempo de viaje por transporte", xlab="Tiempo de viaje (min)", ylab= "Tiempo perdido en tráfico(min)")
legend("topleft", legend = c("Metropolitano","Taxi","Bicicleta","Patineta","Auto Particular","Bus","Combi","Otro medio","Moto"), col = c("blue","yellow","red","green","orange","pink","skyblue","lightgreen","grey"),lwd=2,cex = 0.6)
```
Como vemos, podemos confirmar según el gráfico de dispersión, que la bicicleta siempre llega rápido seguro por la cercanía a la universidad, mientras que los que más se demoran son los celestes y los azules, es decir, la combi y el metropolitano como bien dice la leyenda. De esta forma si podemos confirmar que los dolores también son producto del tiempo de viaje. 


**3.3 Relación entre variables categóricas y numéricas**

Para poder revisar la relación que existe entre estas variables podemos utilizar un gráfico de suma utilidad como son los gráficos de cajas y bigotes y juntarlos. Pero para esto primero tenemos que darle un orden lógico a las variables que utilizaremos:

```{r}
S9$Cansancio <- factor(S9$Cansancio, levels = c("Nada cansado", "Poco cansado", "Moderadamente cansado", "Cansado", "Muy cansado"), ordered = TRUE)
```


```{r}
S9$Estres <- factor(S9$Estres, levels = c("Nada estresado", "Poco estresado", "Moderadamente estresado", "Estresado", "Muy estresado"), ordered = TRUE)
```


```{r}
op <- par(mfrow = c(1,2))
boxplot(S9$Descanso~S9$Cansancio,col = "red", main= "Gráfico 8: Cansancio vs descanso", xlab = "Nivel de cansancio", ylab= "Horas de descanso" )
boxplot(S9$Descanso~S9$Estres, col= "blue", main = "Gráfico 9: Estrés vs descanso", xlab= "Nivel de estrés", ylab = "Horas de descanso" )
par(op)
```

Podemos observar que cuando los encuestados consideraban que no se sentían nada cansados o poco cansados la diferencia horas de sueño no se diferenciaba mucho pero, sin embargo, mientras nos desplazamos a la derecha, donde más cansados/estresados están, menores son las horas de sueño, o la mayor cantidad de personas de esa clase duermen menos. Esto nos puede decir que las horas de sueño son un factor importante a la hora del estrés y cansancio que tienen los alumno. Ahora también sería interesante verificar si hay relación con el tiempo de desplazamiento y para esto podemos comparar ambos, pero con la variable de tiempo. 

```{r}
op1 <- par(mfrow = c(1,2))
boxplot(S9$viaje~S9$Cansancio,col = "green", main= "Gráfico 10: Cansancio vs tiempo", xlab = "Nivel de cansancio", ylab= "Tiempo de viaje(min)" )
boxplot(S9$viaje~S9$Estres, col= "yellow", main = "Gráfico 11: Estrés vs tiempo", xlab= "Nivel de estrés", ylab = "Tiempo de viaje(min)" )
par(op1)
```

Podemos observar ahora claramente que mientras más cansancio y estrés se reporta, mayor es el tiempos de viaje por lo que también se puede afirmar que el nivel de estrés y el cansancio también se ven afectadas para mal cuando el tiempo de viaje es muy largo.

Para concluir el análisis del efecto que hay podemos relacionar el tiempo que el encuestado considera que le da a su salud con el tiempo de viaje y con las horas de sueño para ver si el encuestado es conciente de que por esos factores es posible que esté descuidando su salud. Para esto también tendremos que darle un orden lógico a las variables.


```{r}
S9$Salud <- factor(S9$Salud, levels = c("Muy poco tiempo", "Poco tiempo", "Moderado tiempo", "Mayor tiempo que el promedio", "Mucho tiempo"), ordered = TRUE)
```


```{r}
op2 <- par(mfrow = c(1,2))
boxplot(S9$viaje~S9$Salud,col = "orange", main= "Gráfico 12: Salud vs tiempo", xlab = "Tiempo dedicado a salud", ylab= "Tiempo de viaje(min)" )
boxplot(S9$Descanso~S9$Salud, col= "pink", main = "Gráfico 13: Salud vs Descanso", xlab= "Tiempo dedicado a salud", ylab = "Horas de sueño" )
par(op2)
```
Como en los gráficos anteriores, acá vemos una situación interesante, pues en el primer gráfico vemos que las personas que reportaron que dedican mucho tiempo a cuidar su salud son justamente los que viajan menos tiempo, esto puede decirnos que tal vez, el tiempo de viaje es un limitante a la hora de dedicarle un espacio a cuidar su salud física y mental. Por otro lado, el gráfico rosa de la derecha presenta otra situación parecida pues vemos que mientras las personas consideran que le dedican más tiempo a su salud, sus horas de sueño son mayores, lo que evidentemente explica porque consideran que se cuidan más pues el sueño es muy importante. Esto también lo podemos ver por sus medianas las cuales muestran que van subiendo (gráfico rosa) y bajando (gráfico naranja), lo que confirma lo anteriormente dicho.

**3.4 Relación entre variables numéricas con numéricas**

Acá podemos analizar varias cosas como por ejemplo verificar si existe una regresión lineal o una línea de tendencia si comparamos las variables de tiempo de viaje con tiempo de trafico para verificar si a mayor tiempo de viaje hay mayor tiempo perdido en tráfico.

```{r}
plot(S9$viaje,S9$Trafico,main = "Gráfico 14: Relación entre los tiempos de viaje y tráfico", xlab= "Tiempo de viaje(min)", ylab= "Tiempo perdido en tráfico(min)", col= "red",pch=20)
modelo <- lm(S9$Trafico~S9$viaje)
summary(modelo)
abline(modelo,col = "orange",lwd = 2)
legend("topright", bty = "n", legend = c("Línea de tendencia"),col = "orange",lwd = 2)
text(40,120,paste("Correlación:",round(cor(S9$viaje,S9$Trafico, use = "complete.obs"),digits=2)))
```
Como podemos apreciar en el gráfico la correlación entre ambas variables es de 0.63 lo que nos indica que es una correlación buena o moderada por lo que podemos aventurarnos en ver como sería la línea de tendencia. En este caso vemos que tenemos un R ajustado del 40% por lo que tampoco sería muy buena pero nos puede servir de referencia. En este caso observamos que nuestra ecuación sería $y = 0.301*x+4.56$. Además la tendencia que sigue el gráfico nos da ha entender que mientras mayor sea el tiempo de viaje mayor es el tiempo perdido en tráfico. 

Otra posible relación de este estilo que nos interesaría analizar es si las tardanzas se ven afectadas por la cantidad de veces que van los alumnos, por eso realizaremos el siguiente gráfico. 

```{r}
plot(S9$Presencialidad,S9$Tardanzas, xlim = c(0,10),ylim= c(0,10),main = "Gráfico 15: Relación entre tardanzas y visitas al campus", xlab= "Veces presentes en el campus", ylab= "Tardanzas semanales", col= "pink",pch=20)
modelo1 <- lm(S9$Tardanzas~S9$Presencialidad)
summary(modelo1)
abline(modelo1,col = "blue",lwd = 2)
legend("topright", bty = "n", legend = c("Línea de tendencia"),col = "blue",lwd = 2)
text(2,10,paste("Correlación:",round(cor(S9$Presencialidad,S9$Tardanzas, use = "complete.obs"),digits=2)))
```
En este caso observamos una correlación muy baja, esta es de 0.15 y su R ajustado es de 2% por lo que en este caso si nos damos cuenta que no hay una relación entre las veces que se van al campus con la cantidad de tardanzas que hay. En este caso no habría necesidad de realizar el modelo pues no nos dará datos coherentes y es por eso que utilizarlo sería un error.  


# 4. Probabilidades

Para realizar distintos análisis tal vez nos sea conveniente crear nuevas variables agrupando y categorizando algunas de estas, como por ejemplo los medios de transporte en transporte público o privado y también en vehículos motorizados o no motorizados. También puede ser de utilidad el dividir los tiempos de tráfico y viaje en intervalos para poder trabajarlos con mayor facilidad en análisis posteriores. Para lograr eso realizaremos lo siguiente: 

```{r}
S9 %>% mutate(Tipo1 =
      ifelse(Transporte %in% c("Bus","Combi","Metropolitano"), "Publico",
      ifelse(Transporte %in% c("Auto particular", "Bicicleta", "Motocicleta", "Patineta", "Taxi"), "Privado",
      ifelse(Transporte %in% c("Otro medio de transporte"), "Otro medio", Transporte)))) -> S9
S9 %>% count(Tipo1)
```

```{r}
S9 %>% mutate(Tipo2 =
      ifelse(Transporte %in% c("Bus","Combi","Metropolitano", "Auto particular", "Motocicleta", "Taxi"), "Transporte Motorizado",
      ifelse(Transporte %in% c("Bicicleta", "Patineta"), "Transporte No Motorizado", Transporte))) -> S9
S9 %>% count(Tipo2)
```


```{r}
S9 %>% mutate(Trafico1 =
      ifelse(Trafico %in% c("0"), "0 min",
      ifelse(Trafico %in% c("1", "2", "3", "4", "5", "6", "7", "8", "9","10"), "1-10 min",
      ifelse(Trafico %in% c("11", "12", "13", "14", "15", "16", "17", "18", "19","20"), "11-20 min",
      ifelse(Trafico %in% c("31", "32", "33", "34", "35", "36", "37", "38", "39","40"), "31-40 min",
      ifelse(Trafico %in% c("41", "42", "43", "44", "45", "46", "47", "48", "49","50"), "41-50 min",
      ifelse(Trafico %in% c("51", "52", "53", "54", "55", "56", "57", "58", "59","60"), "51-60 min",
      ifelse(Trafico %in% c("61", "62", "63", "64", "65", "66", "67", "68", "69","70"), "61-70 min",
      ifelse(Trafico %in% c("71", "72", "73", "74", "75", "76", "77", "78", "79","80"), "71-80 min",
      ifelse(Trafico %in% c("81", "82", "83", "84", "85", "86", "87", "88", "89","90"), "81-90 min",
      ifelse(Trafico %in% c("91", "92", "93", "94", "95", "96", "97", "98", "99","100"), "91-100 min",
      ifelse(Trafico %in% c("101", "102", "103", "104", "105", "106", "107", "108", "109","110"), "101-110 min",
      ifelse(Trafico %in% c("111", "112", "113", "114", "115", "116", "117", "118", "119","120"), "111-120 min",
      ifelse(Trafico %in% c("21", "22", "23", "24", "25", "26", "27", "28", "29","30"), "21-30 min", Trafico)))))))))))))) -> S9
S9 %>% count(Trafico1)
```

```{r}
S9 %>% mutate(Viaje1 =
      ifelse(viaje %in% c("1", "2", "3", "4", "5", "6", "7", "8", "9","10","11", "12", "13", "14", "15", "16", "17", "18", "19","20", "21", "22", "23", "24", "25", "26", "27", "28", "29","30"), "1-30 min",
      ifelse(viaje %in% c("31", "32", "33", "34", "35", "36", "37", "38", "39","40", "41", "42", "43", "44", "45", "46", "47", "48", "49","50","51", "52", "53", "54", "55", "56", "57", "58", "59","60"), "31-60 min",
      ifelse(viaje %in% c("61", "62", "63", "64", "65", "66", "67", "68", "69","70","71", "72", "73", "74", "75", "76", "77", "78", "79","80","81", "82", "83", "84", "85", "86", "87", "88", "89","90"), "61-90 min",
      ifelse(viaje %in% c("91", "92", "93", "94", "95", "96", "97", "98", "99","100","101", "102", "103", "104", "105", "106", "107", "108", "109","110","111", "112", "113", "114", "115", "116", "117", "118", "119","120"), "91-120 min",
      ifelse(viaje %in% c("121", "122", "123", "124", "125", "126", "127", "128", "129","130","131", "132", "133", "134", "135", "136", "137", "138", "139","140","141", "142", "143", "144", "145", "146", "147", "148", "149","150"), "121-150 min",
      ifelse(viaje %in% c("151", "152", "153", "154", "155", "156", "157", "158", "159","160","161", "162", "163", "164", "165", "166", "167", "168", "169","170","171", "172", "173", "174", "175", "176", "177", "178", "179","180"), "151-180 min", viaje))))))) -> S9
S9 %>% count(Viaje1)
```

```{r}
S9$Viaje1 <- factor(S9$Viaje1, levels = c("1-30 min", "31-60 min", "61-90 min", "91-120 min", "121-150 min","151-180 min"), ordered = TRUE)
```

**4.1 Análisis probabilístico entre tipo de transporte y tiempo de viaje** 

En este caso utilizaremos las modificaciones que hemos hecho acerca del tiempo en intervalos de 10 en 10. Para poder aprovechar los distintos axiomas y probabilidad generales, usaremos una tabla cruzada. En esta nos interesa analizar algunas probabilidades entre el tipo de transporte y el tiempo de viaje, por lo que presentaremos la tabla 3: Medio de transporte vs tiempo de viaje

```{r}
CrossTable(S9$Transporte,S9$Viaje1, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```

Podemos ver que la tabla cuanta con muchos datos lo que lo hace muy complicado de leer, tal vez, en este caso sería de utilidad también categorizar los medios de transporte de dos formas: Como público y privado. Por lo tanto podemos tener esta primera tabla cruzada, la cual es la tabla 4: medio de transporte vs tiempo de viaje 

```{r}
CrossTable(S9$Viaje1,S9$Tipo1, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```
Ahora podemos ver la tabla y analizarla con mucha mayor facilidad. Para un análisis más simple tomaremos a los intervalos de forma creciente con las letras de la a hasta la f, siendo a la fila de 1 a 30 minutos y f la fila de 151 a 180 minutos.

Primero podemos empezar con lo básico, cual es la probabilidad de que sean de un tipo de transporte: 

Esto sería lo siguiente donde privado es Pr, público Pu y otro medio O : 

$P(Pr)$
$P(Pu)$
$P(O)$

Como vemos en la tabla tenemos que coger el total de cada columna y dividirlo entre el total para obtener la probabilidad de cada tipo de medio de transporte:

```{r}
cat('P(Pr):',round(85/200,2),'\n') 
cat('P(Pu):',round(108/200,2),'\n')
cat('P(O):',round(7/200,2),'\n')

```
Vemos que es un poco más probable que la persona se vaya en un vehículo público antes que en un vehículo privado.

Ahora podemos hacernos otras preguntas igual de interesantes, como por ejemplo las siguientes: 

 1. Cual es la probabilidad de que el alumno vaya en transporte privado o se demore de 1 a 90 minutos.
 2. Cual es la probabilidad de que el alumno vaya en transporte público o se demore de 1 a 90 minutos.
 3. Cual es la probabilidad de que el alumno vaya en transporte público o se demore más de 90 minutos.
 4. Cual es la probabilidad de que el alumno vaya en transporte privado o se demore más de 90 minutos.

Esto si lo traducimos a términos matemáticos sería lo siguiente:

 1.$P(Pr)+P(a)+P(b)+P(c)-P(Pr∩a)-P(Pr∩b)-P(Pr∩c)$
 
 2.$P(Pu)+P(a)+P(b)+P(c)-P(Pu∩a)-P(Pu∩b)-P(Pu∩c)$
 
 3.$P(Pu)+P(d)+P(e)+P(f)-P(Pu∩d)-P(Pu∩e)-P(Pu∩f)$
 
 4.$P(Pr)+P(d)+P(e)+P(f)-P(Pr∩d)-P(Pr∩e)-P(Pr∩f)$

```{r}
cat('1:',round(0.42+(68/200)+(62/200)+(31/200)-(55/200)-(25/200)-(2/200),2),'\n') 
cat('2:',round(0.54+(68/200)+(62/200)+(31/200)-(8/200)-(37/200)-(29/200),2),'\n')
cat('3:',round(0.54+(31/200)+(5/200)+(3/200)-(27/200)-(4/200)-(3/200),2),'\n')
cat('4:',round(0.42+(31/200)+(5/200)+(3/200)-(2/200)-(1/200)-(0/200),2),'\n')
```
Con estos resultados podemos darnos cuenta que es muy probable que que un alumno vaya en transporte público o que se demore menos de 90 minutos en llegar mientras que cambiando el transporte público con el privado, la probabilidad disminuye como bien habíamos visto antes. Sin embargo, vemos claramente que la probabilidad de que lleguen antes de 90 minutos en ambos casos es mayor a que lleguen en más de 90 por lo que podemos comprobar que es más probable que los alumnos lleguen antes de 90 minutos a la universidad. 

Aun podemos hacer otras preguntas igual de interesantes, como por ejemplo las siguientes: 

1. Cual es la probabilidad de que el alumno vaya en transporte privado y se demore menos de 30 minutos.  
2. Cual es la probabilidad de que el alumno vaya en transporte público y se demore menos de 30 minutos.

Esto reescrito matemáticamente sería: 

1.$P(Pr∩a)$

2.$P(Pu∩a)$

Evidentemente para encontrar estas posibilidades solo debemos ver el cuadro de intersección en la tabla:

```{r}
cat('1:',round(55/200,2),'\n') 
cat('2:',round(8/200,2),'\n')
```
Acá vemos que claramente que la probabilidad de que el alumno llegue en menos de 30 minutos es mayor en el transporte privado que en el transporte público y con una diferencia notoria. 

**4.2 Análisis probabilístico entre tipo de transporte y la presencia de dolor**

Nos interesa saber en este caso la relación que hay en la presencia de dolor con el tipo de transporte en el que van los alumnos, por lo tanto podemos crear la tabla 5: Tipo de transporte vs reporte de dolor

```{r}
CrossTable(S9$Tipo1,S9$Dolor, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```
Solo viendo la tabla vemos que la probabilidad de que digan si o no, es casi similar, siendo ambas muy cercanas al 50%. 

Algo que nos gustaría saber es cual es la probabilidad de que digan que si pero que no sea transporte privado. También sería interesante calcular la probabilidad  de que digan que no pero que no sea transporte privado. Lo que significa lo siguiente:

1.$P(S∩Pr^c)=P(S)-P(S∩Pr)$

2.$P(N∩Pr^c)=P(N)-P(N∩Pr)$

```{r}
cat('1:',round(98/200-29/200,2),'\n')
cat('2:',round(102/200-56/200,2),'\n')
```
Viendo ambos valores de probabilidades podemos darnos cuenta que es más probable que los alumnos digan que si y que no vaya en transporte privado a que digan que no y no vaya en transporte privado, lo que nos da a entender que las personas que van en vehículos privados tienden a no sentir dolores más que los que van en transporte público. Esto mismo podemos comprobar viendo las tablas

Otra cosa interesante es saber cual es la probabilidad que ni diga que no ni que sea privado. Esto lo podemos ver de la siguiente manera y trabajarlo según el axioma 7: 

$P(N^c∩Pr^c)=P(N∪Pr)^c=1-P(N∪Pr)=1-P(N)-P(Pr)+P(N∩Pr)$

```{r}
cat('',round(1-(102/200)-(85/200)+(56/200),2),'\n')
```
Esto nos da a entender que la probabilidad de que el alumno ni diga no, ni que vaya en transporte privado es de 0.35, lo que significa que hay una probabilidad considerable de que el alumno diga que si y que vaya en un transporte que no sea privado. 

**4.3 Análisis probabilístico entre zona de procedencia y cansancio**

La última tabla que nos interesa analizar es una que nos muestra la relación de la zona de procedencia con que tan cansado se sienten al llegar a la universidad. De este modo tenemos la tabla 6: Zona de procedencia vs cansancio

```{r}
CrossTable(S9$Cansancio,S9$Zona, prop.r=F,
prop.c=F, prop.t=F, prop.chisq=F)
```
Solo viendo la tabla ya nos damos cuenta que es más probable que la persona indique que se siente moderadamente cansado, seguido por cansado. Además, también vemos que es más probable que la persona sea de lima centro que de las demás zonas. Además, algo que nos interesa saber en este caso son algunas probabilidades condicionales:

1.Cual es la probabilidad de que sea de Lima norte si se sabe que llega cansado

2.Cual es la probabilidad de que sea de Lima centro si se sabe que llega cansado

Lo cual significa lo siguiente, suponiendo además, que cansado es C:

1.$P(Ln/C)=P(Ln∩C)/P(C)$

2.$P(Lc/C)=P(Lc∩C)/P(C)$

```{r}
cat('1:',round((17/200)/(59/200),2),'\n')
cat('2:',round((25/200)/(59/200),2),'\n')
```
Vemos lo que claramente podemos observar también de forma gráfica, y es que es más probable que una persona llegue cansada de Lima centro que una persona llegue cansada de Lima norte. Sin embargo, del mismo modo gráfico podemos ver que más personas de Lima norte reportan sentirse muy cansados, que de Lima centro.

**4.4 Análisis Probabilístico de tardanzas con zona de procedencia** 

Para realizar este análisis sería de mucha utilidad imaginar un diagrama del árbol con todas las posibilidades ya escritas. Primero debemos ver la probabilidad de cada zona y para eso podemos apoyarnos de la tabla 6:

$P(Lc)=105/200=0.525$

$P(Le)=38/200=0.19$

$P(Ls)=17/200=0.085$

$P(Ln)=40/200=0.2$

Luego debemos ver la probabilidad de que una persona llegue al menos 1 vez tarde respecto a la zona, y para eso nos sirve realizar la tabla 7: Zona de procedencia vs tardanzas 

```{r}
table(S9$Zona, S9$Tardanzas)
```
Juntando todos los valores de 1 a 5 como uno, podemos ver que al probabilidad de que lleguen al menos una vez tarde por cada zona es de:

$P(T/Lc)=45/105=0.429$
$P(T/Le)=24/38=0.632$
$P(T/Ls)=8/17=0.471$
$P(T/Ln)=29/40=0.725$

Sabiendo que sus complementos serían quitarle a 1 el valor de cada uno, podemos ahora si trabajar con estas probabilidades y aplicar conceptos como la probabilidad total o el teorema de Bayes, por ejemplo:

1. Cual es la probabilidad de que la persona llegue tarde y la probabilidad de que no lo haga. 

Para esto simplemente tendríamos que realizar la sumatoria de la multiplicación de la probabilidad de cada zona con la de que llegue tarde. Esto según la probabilidad total, por lo que nuestro resultado sería el siguiente:

$P(T)=0.525*0.429+0.19*0.632+0.085*0.471+0.2*0.725$

```{r}
round((0.525*0.429)+(0.19*0.632)+(0.085*0.471)+(0.2*0.725),2)
```
La probabilidad de que lleguen tarde por lo menos una vez es de 0.53 mientras que la de que no sería su complemento, es decir $1-0.53$, lo cual es $0.47$. Aparte de esto también sería interesante saber lo siguiente:

2.Cual es la probabilidad de que una persona sea de Lima este si se sabe que llego tarde 

3.Cual es la probabilidad de que una persona sea de lima centro si es se sabe que no llego tarde.

Para esto aplicaremos el teorema de Bayes, lo cual nos dice que la respuesta será la siguiente: 

$P(Le/T)=P(Le)*P(T/Le)/P(T)$

$P(Lc/T^c)=P(Lc)*P(T^c/Lc)/P(T^c)$

```{r}
cat('2:',round(((0.19)*(0.632))/(0.53),2),'\n')
cat('3:',round(((0.525)*(0.571))/(0.47),2),'\n')
```
Vemos en este caso que es baja la probabilidad de que sea de lima norte si es que llega tarde lo que nos dice que la gente que proviene de Lima norte no suele llegar muchas veces tarde. Además, vemos que la probabilidad de que sea de Lima centro si es que no llega tarde es alta, lo que también nos asegura que gran parte de los alumnos de lima centro no llegan tarde.

# 5. Variables aleatorias y modelos

Ya hemos visto previamente algunas probabilidades respecto a las zonas de procedencia, pero ahora queremos saber algunas probabilidades de que en una muestra de alumnos al azar encontremos un determinado número de alumnos que vienen de una zona en específico. Como hemos visto anteriormente, las personas de Lima Norte son las que más reportan el sentirse cansados al llegar, así que nos interesa trabajar con las probabilidades de esa sección de Lima. Por lo tanto podemos plantear lo siguiente:

1. Se sabe que se han entrevistado a 200 estudiantes de los cuales 105 son de Lima centro, 38 de Lima este, 40 de Lima norte y 17 de Lima sur. Supongamos que queremos tomar a 15 alumnos sin reemplazo, es decir que una vez se le pregunte a uno su zona de procedencia, no se le vuelve a preguntar. También debemos saber que cada persona tiene la misma probabilidad de ser elegido. 
En este caso nos interesa saber las probabilidades respecto al grupo de Lima norte.

X: Número de estudiantes que viven en la zona de Lima norte

X tiene H(N=200,M=40,n=15)

Por lo tanto podemos plantear las siguientes preguntas:

a) ¿Cuantos alumnos de Lima norte se espera seleccionar?

Para este caso nos piden encontrar la esperanza de la variable. Como sabemos la esperanza de una variable hipergeométrica es $E(X)=nM/N$, por lo tanto, el valor esperado sería el seguiente:

```{r}
(15*40)/200
```
Se espera que en una muestra de 15 personas, hayan 3 que vayan a la universidad desde Lima norte. 

b) ¿Cuál es la probabilidad de que la cantidad de alumnos de Lima norte sea entre 3 y 7?

Para este caso sabemos que la probabilidad de esto será lo siguiente: 

$P(3 <= X <= 7) -> P(X <= 7)-P(X <= 2)$

```{r}
phyper(7,40,160,15)-phyper(2,40,160,15)
```
La probabilidad entonces de que la cantidad de alumnos sea de Lima norte es de 0.61 o de 61% aproximando. Podemos ver que si es probable de encontrar una cantidad considerable de alumnos que vienen de Lima norte o en este caso que sean entre 3 a 7 estudiantes.

c) Si se sabe que va a haber más de 1 alumno de Lima norte, ¿Cuál es la probabilidad de que hayan como máximo 10 alumnos de esa zona de Lima?

En este caso la pregunta se nos presenta como una condicional: 

$P(X <= 10)/P(X > 1) -> P(1 < X <= 10)/P(X > 1)$

```{r}
(phyper(10,40,160,15)-phyper(1,40,160,15))/(1-phyper(1,40,160,15))
```
Vemos en este caso que la probabilidad es casi 1, lo cual tiene sentido porque estamos proponiendo que sea como máximo 10, pero con tal de que sean 2 ya cumple como para estar dentro de la probabilidad. Sabíamos del ítem a que la esperanza es 3 por lo que tener 1 menos es muy probable. 

Otra variable que nos interesa analizar para entender mejor la situación de los alumnos es la del tipo de dolor que reportan, todos sabemos lo incómodo que es tener dolores como los cólicos, el dolor de cabeza y las nauseas. Queremos saber cual es la probabilidad de que en una muestra de 200 alumnos se reportan estos dolores, ya que en muchas ocasiones estos provocan que muchos alumnos pierdan clases, así que realizaremos la tabla 8: Tipos de dolor 

```{r}
table(S9$Tipo)
```
Vemos que sumando los valores, la probabilidad de sentir alguno de esos 3 fastidios es de $35/200 = 0.175$ Por lo tanto podemos plantear lo siguiente:

2. Un equipo ha entrevistado a 200 alumnos sobre algunos dolores que estos sienten a la hora de realizar su desplazamiento a la universidad. Entre estos se reportaron molestias fuertes como el dolor de cabeza, los cólicos y las nauseas. Por estudios previos, también se sabe que la probabilidad de que los alumnos reporten alguna de estas molestias es de 0.175. Por lo tanto, el equipo se ha interesado en saber algunas probabilidades de interés y por eso seleccionaron a alumnos al azar con reemplazo. Además, se busca saber las probabilidades hasta encontrar el 5to alumno con estos problemas. 

X: Número de alumnos que reportan dolores de cabeza, nauseas y cólicos

X tiene BN(k=5,p=0.175)

Por lo tanto podemos plantear las siguientes preguntas:

a)¿Cuál es la probabilidad de preguntar a más de 10 personas para encontrar los alumnos necesarios?

En este caso lo que nos piden es lo siguiente: $P(X > 10)$

```{r}
1-pnbinom(5,5,0.175)
```
El resultado es aproximadamente 98%, esto tiene sentido pues en algún momento si nos pasamos de 10 llegaremos a esos 5 resultados deseados, sin embargo, no es 100% porque aún existe la posibilidad de conseguir esa cantidad de éxitos en menos de 10 intentos.

b) ¿Cuál es la posibilidad de conseguir la cantidad deseada en como máximo 7 personas?

En este caso la probabilidad que nos piden es la siguiente: $P(X <= 7)$

```{r}
pnbinom(2,5,0.175)
```

En este caso vemos que la probabilidad es tan baja que no llega ni al 1% debido a que el número de intentos es cercano al de éxitos necesarios, esto sumado a la baja probabilidad de éxito provoca que esa sea la probabilidad.

c) ¿Cuál es el numero de personas que se espera preguntar para conseguir los 5 éxitos?

Como sabemos que nos están pidiendo el promedio o esperanza tendremos que aplicar la fórmula de la esperanza en una variable binomial negativa la cual es la siguiente: $k/p$ donde k=5(número de éxitos) p=0.175

```{r}
5/0.175
```
En este caso aproximando debemos entrevistar a 28.57 personas pero sabemos que no existen personas y media, por lo que diremos que se espera entrevistar a 29 personas para obtener el resultado deseado.

Por último, podemos desarrollar otra variable de interés y en este caso puede ser una variable cuantitativa. Por ejemplo una variable de la que tenemos interés es el tiempo que las personas pierden en el tráfico, por lo tanto primero debemos visualizar un histograma de la variable para poder entender mejor su distribución:

```{r}
hist(S9$Trafico, col= "lightblue" , main = "Gráfico 16: Histograma de tiempo en tráfico",xlab= "Tiempo perdido en el tráfico(min)", ylab= "Frecuencia" )
```
Viendo el gráfico rápidamente podemos ver que esta tiende a una distribución exponencial, por lo que sería interesante encontrar los parámetros necesario para su explicación y desarrollo de probabilidades. Sabemos que la exponencial trabaja con un parámetro β, el cual es el promedio o valor esperado. Por lo tanto para poder trabajar con esta distribución debemos buscar el promedio del tiempo perdido en tráfico. 

```{r}
round(mean(S9$Trafico),2)
```
Entonces podemos afirmar el valor de β, el cual es de 22.07 minutos. Por lo tanto podemos presentar el siguiente contexto: 

3. Un equipo ha realizado una investigación determinando el tiempo que diversos alumnos tardan en llegar a la UTEC, donde uno de los parámetros medidos fue el tiempo que ellos perdían en el tráfico, el cual fue medido en minutos. Además se ha determinado que esta variable sigue una distribución exponencial con un promedio de 22.07 minutos. A partir de esto podemos calcular las siguientes probabilidades: 

X: tiempo perdido en tráfico por alumnos de UTEC (min)

X tiene Exp(β= 22.07 min)

a) ¿Cual es la probabilidad de que pierdan en trafico a lo más 30 minutos?

$P(X <= 30)$

```{r}
pexp(30,1/22.07)
```
Vemos que la probabilidad de que esto suceda es muy grande con un valor de 74.31%, casi el 75% y esto tiene sentido, pues, como hemos visto en el gráfico, gran parte de las respuestas se encuentran en el rango de 0 a 40 minutos. Por lo tanto, podemos afirmar que gran parte de los alumnos de UTEC reportan que pierden menos de 30 minutos en tráfico a la hora de desplazarse a la universidad. 

b) ¿Cuál es la probabilidad de que pierdan en tráfico más de 40 minutos?

$P(X > 40)$

```{r}
1-pexp(40,1/22.07)
```

En este caso vemos que es todo lo contrario, lo cual hace sentido viendo el gráfico pues la distribución se concentra en tiempos más cortos. Además, podemos afirmar que no muchas personas se demoran más de 40 minutos en tráfico. Aún así, el grupo que si lo hace no es tan despreciable pues es el 16.33%.

c) ¿Cuál es la probabilidad de que la persona pierda en tráfico entre 15 a 55 minutos?

$P(15 <= X <= 55)$

```{r}
pexp(55,1/22.07)-pexp(15,1/22.07)
```
Vemos en este caso que la probabilidad de que esto suceda es del 42.41% y esto puede hacer sentido pues la clase modal es de 0 a 10 minutos perdidos. Además, podemos afirmar que menos de la mitad de las personas reportan perder más de 15 minutos pero menos de 55. Lo que también nos ayuda a entender, complementado por los cálculos anteriores, que la mayoría de las personas pierden de 0 a 15 minutos en el tráfico. 

# 6. Conclusión 

Tras realizar este análisis descriptivo nos hemos dado cuenta que para los alumnos de UTEC si existe una relación entre el estado físico y mental de los alumnos por el tema del transporte y del tráfico. Hemos visto que hay un grupo considerable que utiliza medios de transporte como el metropolitano, los buses, las bicicletas y las combis. Además, muchos de estos vienen de sitios alejados y esto genera que sus tiempos de viaje sean muy largos como se pudo ver en el gráfico de dispersión "tiempo de viaje por transporte", lo cual puede generar la angustia de sentir que debes llegar rápido, generando más estrés. Esto sumado a la cantidad de gente en estos medios y el movimiento que hay, genera que los alumnos reporten que al llegar a la universidad se sientan con dolores, con cansancio y con estrés. Esto último fue apoyado también con los gráficos de caja y bigotes "Estrés vs tiempo" y "Cansancio vs tiempo". 

Agregado a esto, hemos visto que este desgaste también se ve afectado por la cantidad de horas de sueño que tienen los alumnos, valor que sumado al tiempo de viaje, afectan al tiempo que el alumno le puede dedicar a cuidar su salud física y mental. Por último, descubrimos que existe una relación entre el tiempo de viaje con el tiempo perdido en el tráfico lo que nos da a entender que cuando el tiempo de viaje crece, se pierde más tiempo en el tráfico. Sin embargo, no encontramos relación alguna entre las veces que se va a la universidad con la cantidad de tardanzas por lo que podemos asumir que no existe una relación entre estas dos. 

Con el análisis probabilístico hemos visto que es más probable que los alumnos utilicen el transporte público que el privado aunque la diferencia sea mínima. Aparte de eso se determinó que es muy probable que los alumnos se demoren menos de 90 minutos y más aún cuando van en transporte público. Sin embargo, la probabilidad de que lleguen en menos de 30 minutos es mayor en el transporte privado que en el transporte público. Por lo que se puede concluir que los alumnos llegan más rápido generalmente en transporte privado. Además se determino que la probabilidad de decir que si a la presencia de un dolor y que vayan en transporte público es mayor que en la de ir en transporte privado. Por lo que se puede inferir que más dolores se reportan cuando se utiliza el transporte público, lo cual tiene sentido pues son transportes más incómodos. 

Hemos visto también que es más probable que las personas de Lima norte reporten estar más cansados que las demás zonas. También hemos visto que es un poco más probable llegar al menos una vez tarde que no llegar ninguna. Sin embargo, esta bien distribuida en los distritos pues ninguno destaca más que el resto. Otro factor asociado a esto fue el tiempo perdido en tráfico. Se descubrió que casi el 75% de las personas pierden menos de 30 minutos en el tráfico y que un 16% aproximadamente, pierde más de 40 minutos en el tráfico. Por lo tanto, los alumnos de UTEC en general no pierden mucho el tiempo en tráfico pero si demoran mucho en el traslado, por lo que ese tiempo se refiere más a la distancia. 
