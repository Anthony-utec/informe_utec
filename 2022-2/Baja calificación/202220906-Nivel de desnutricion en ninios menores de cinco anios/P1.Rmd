---
title: "PROYECTO"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: no
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: no
    theme: cosmo
---

```{r,include=FALSE}
library(readr)
library(DescTools)
library(ggplot2)
library(stringi)
library("raster")
library("stringr")
library("RColorBrewer")
library(dplyr)
```


# TEMA: **Nivel de desnutrición en niños menores de cinco años en Lima provincias en el periodo 2019 al 2021**

![](https://www.minedu.gob.pe/tinkuy/imagenes/tinkuy-personajes-2021.jpg)
# **1. INTRODUCCIÓN**

## **1.1. Relevancia:**

 <div style="text-align: justify"> El tema propuesto nos resulta relevante debido a que nos permite conocer 
  el nivel nutricional por el que pasan los niños menores de 5 años que residen en las provincias de Lima.
  Para ello, se realizará un análisis comparativo, respecto a la base de datos obtenida, para determinar la situación 
  de dicha problemática en los últimos 3 años. <div/>
  
## **1.2. Objetivos:**

### **1.2.1. Objetivo general: **

<div style="text-align: justify">Buscar, por medio de análisis estadísticos, los índices de desnutrición que hay en los menores de 5 años en las diferentes locaciones de estudio en el departamento de Lima desde el año 2019 hasta en 2022.<div/>

### **1.2.1. Objetivos específicos:**


- Determinar el nivel de anemia de los infantes con respecto a cada provincia de Lima.

- Determinar qué provincia de estudio en Lima posee mayor y menor cantidad de casos de niños con anemia

- Determinar qué distrito de Lima posee mayor y menor tasa de anemia

- Determinar el porcentaje de niños que presentan alguna ayuda social y que, a su vez, presenten algún tipo de anemia.

- Determinar el rango de hemoglobina que presentan los niños de acuerdo a su peso y género

- Determinar la influencia que presenta el sistema de alimentación Qaliwarma en el nivel de anemia en los infantes de las provincias de  Lima

- Determinar la influencia que tiene el Seguro Integral de Salud en el nivel de anemia en los infantes de las provincias de Lima.

- Determinar en promedio cuántas personas del estudio están recibiendo ayuda de suplementación y que provincia es la que recibe una mayor tasa de suplementación.

- Determinar la cantidad de niños por sexo que presentan algún tipo de anemia.

- Hallar una relación entre la edad de los infantes, la presencia de anemia y su nivel en ellos



## **1.2. Planificación:**


Para la planificación se elaboró un diagrama de Gantt con los trabajos correspondientes de la P0 y la P1:

```{r, echo=FALSE}
tasks <- c ('Planteamiento de los temas', 'Obtención de data', 'Análisis de la data ', 'Entrega de la P0', 'Evaluar el feedback', 'Corregir de acuerdo al feedback','Selección del tema','Análisis de la data seleccionada','Planteamiento de los objetivos','Limpieza de la data', 'Selección de variables','Elaboración del informe', 'Preparación para la exposición','Entrega P1', 'Selección de posibles variables probabilísticas', 'Análisis de las variables', 'Limpieza de datos adicional','Corrección de la P1','Selección de axiomas', 'Aplicación de axiomas','Elaboración de tablas', 'Selección de distribuciones discretas', 'Empleación de la distribución', 'Selección de distribuciones continuas', 'Corroboración de la distribución ','Empleación de la distribución continua', 'Preparación para la exposición 2', 'Entrega de la P2' )
task2 = rev(tasks)
dfr <- data.frame(
  name        = factor(task2, levels = task2),
  start.date  = c (15,15,14,14,14,13,13,11,11,11,10,10,9,8,7,7,7,7,6,6,6,5,5,5,3,3,2,2),
  end.date    =  c (16,16,15,15,15,14,14,12,12,12,11,11,10,9,8,8,8,8,7,7,7,6,6,6,4,4,3,3),
  Fases = c ('P2','P2','P2','P2','P2','P2','P2','P2','P2','P2','P2','P2','P2','P2','P1','P1','P1','P1','P1','P1','P1','P1','P1','P1', 'P0','P0','P0','P0')
)

ggplot(dfr, aes(x =start.date, xend= end.date, y=name, yend = name, color=Fases)) +
  geom_segment(size = 3) +
  xlab("Semanas") + ylab("Trabajos") + 
  labs(title='Gráfico 1', 
       subtitle='Diagrama de Gantt') + theme(plot.title=element_text(size=13.5, face='bold', color='black')) +theme (plot.subtitle =element_text(size=10, face='bold', color='black'))
```


# **2. DATOS**

## **2.1. Proceso de recolección de datos**

 <div style="text-align: justify"> Se optó, en el presente proyecto, por utilizar una base de datos. El proceso de selección fue el siguiente:
 
 - Se ingresó a una plataforma confiable y segura para la selección de la data. Para ello se ingresó a la [Plataforma Nacional de Datos Abiertos](https://www.datosabiertos.gob.pe/) perteneciente al gobierno. 
 
 - En el equipo se planteó posibles temas de interés para la selección de la data
 - Se optó por elegir el apartado de **Alimentación y nutrición**
 - Dentro de dicho apartado el equipo decidió abarcar el tema, utilizando la data pertinente, acerca de la desnutrición en infantes en los últimos 3 años tomando Lima como departamento de estudio.


El motivo de selección del tema y la data es debido al interés y relevancia que puede presentar en la población. Así mismo, se contempla que se logre informar y concientizar  adecuadamente . Por otro lado, para el proyecto se decidió elaborar un formulario representativo sobre la posible forma de recolección centrada en la data seleccionada. [Formulario representativo](https://forms.gle/dPbGbxgm6RbSJDj77) (NO ES NECESARIO LLENAR). <div/>


## **2.2. Población, muestra y muestreo**


- **Población**: Nuestra población de estudio fueron los niños de entre 6 meses y 5 años de edad que fueron atendidos en los distintos centros de salud de Lima provincias entre 2019 y 2021.


- **Muestra** : La dimensión de nuestra muestra es de 13822 observaciones.


- **Muestreo**: El proyecto utiliza un tipo de muestreo estratificado ya que solo se desea evaluar los casos ocurridos en Lima provincias a niños de un rango de edad de entre 6 meses y 5 años, cuya atención se diese entre 2019 y 2021.



## **2.3. Variables**

*Tabla 1: Descripción de las variables*

+----------------------+----------------------------+--------------------------------------------------+
|   **Variables**      |   **Tipo de Variable**     |   **Restricciones**                              |
+----------------------+----------------------------+--------------------------------------------------+
| *Red*                |  categórica nominal        | Debe estar ubicado en Lima                       |        
+----------------------+----------------------------+--------------------------------------------------+
| *Microred*           |  categórica nominal        | Debe estar ubicado en Lima                       |
+----------------------+----------------------------+--------------------------------------------------+ 
| *EESS*               |  categórica nominal        | Debe estar ubicado en Lima                       |
+----------------------+----------------------------+--------------------------------------------------+
| *ProvinciaEESS*      |  categórica nominal        | Debe pertenecer a las provincias de Lima         |
+----------------------+----------------------------+--------------------------------------------------+
| *DistritoEESS*       |  categórica nominal        | Debe pertenecer a las provincias de Lima         |
+----------------------+----------------------------+--------------------------------------------------+
| *FechaAtencion*      |  numérica discreta         | Debe encontrarse entre los años 2019 al 2021     |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Genero*             |  categórica nominal        | Puede ser masculino o femenino                   |
+----------------------+----------------------------+--------------------------------------------------+ 
| *FechaNacimiento*    |  numérica discreta         | El año Debe ser mayor o igual a 2016             |
+----------------------+----------------------------+--------------------------------------------------+ 
| *EdadMeses*          |  numérica discreta         | Debe ser un número entero positivo >= 6 y <=60   |
+----------------------+----------------------------+--------------------------------------------------+ 
| *DepartamentoPN*     |  categórica nominal        | Debe pertenecer a los departamentos del Perú     |
+----------------------+----------------------------+--------------------------------------------------+
| *ProvinciaPN*        |  categórica nominal        | Debe pertenecer a las provincias del Perú        |
+----------------------+----------------------------+--------------------------------------------------+ 
| *DistritoPN*         |  categórica nominal        | Debe pertenecer a los distritos del Perú         |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Juntos*             |  categórica dicotómica     | Solo puede ser sí o no                           |
+----------------------+----------------------------+--------------------------------------------------+ 
| *SIS*                |  categórica dicotómica     | Solo puede ser sí o no                           |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Qaliwarma*          |  categórica dicotómica     | Solo puede ser sí o no                           |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Peso*               |  numérica continua         | Debe ser un número natural positivo              |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Talla*              |  numérica continua         | Debe ser un número natural positivo              |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Hemoglobina*        |  numérica continua         | Debe ser un número natural positivo              |
+----------------------+----------------------------+--------------------------------------------------+ 
| *Suplementacion*     |  categórica dicotómica     | Solo puede ser sí o no                           |   
+----------------------+----------------------------+--------------------------------------------------+ 
| *Consejeria*         |  categórica dicotómica     | Solo puede ser sí o no                           |
+----------------------+----------------------------+--------------------------------------------------+ 
| *MesDeAtencion*      |  numérica discreta         | Debe pertenecer a los meses del año              |
+----------------------+----------------------------+--------------------------------------------------+ 
| *HBC*                |  numérica continua         | Debe ser un número natural positivo              | 
+----------------------+----------------------------+--------------------------------------------------+ 
| *DiagnosticoAnemia*  |  categórica ordinal        | Puede ser Anemia leve, moderada, severa o normal |
+----------------------+----------------------------+--------------------------------------------------+ 



## **2.4. Limpieza de datos**



Posteriormente se procede a cargar las librerías:


```{r}
library(readr)
library(dplyr)
library(DescTools)
library(ggplot2)
library(stringi)
library(car)
library(fastGraph)
```



Leemos la data:

```{r,eval=FALSE}
data<- read_csv('Niños LIMA.csv')
```

Se selecciona las 22 variables relevantes:

```{r}
df = select(data,Red,Microred,EESS,Prov_EESS,Dist_EESS,FechaAtencion,Sexo,FechaNacimiento,EdadMeses,DepartamentoPN,ProvinciaPN,DistritoPN,Juntos,SIS,Qaliwarma,Peso,Talla,Hemoglobina,Suplementacion,Consejeria,HBC,Dx_Anemia)

```

Modificamos los nombres de las  variables **"Sexo" ,"Dist_EESS", "Prov_EESS" y "Dx_Anemia"** renombrándolas por Genero, **DistritoEESS, ProvinciaEESS y DiagnosticoAnemia** respectivamente :

```{r}
 df = rename(df,Genero="Sexo",DistritoEESS = "Dist_EESS", ProvinciaEESS = "Prov_EESS" , DiagnosticoAnemia = "Dx_Anemia" ) 
```


Modificamos los errores presentados en la variable **Red**:

```{r}
unique(DF$Red) 
DF %>% mutate(Red = 
        ifelse(Red == "RED VII CAĽETE - YAUYOS", "RED VII CAÑETE - YAUYOS",Red)) -> DF
DF %>% mutate( Peso = 
        ifelse(Peso == "#ĄNULO!", NA,Peso)) -> DF
DF %>% mutate( Talla = 
        ifelse(Talla == "#ĄNULO!", NA,Talla)) -> DF
unique(DF$Red) 
```



Modificamos los errores presentados en la variable **DistritoEESS**:

```{r}

DF %>% mutate( DistritoEESS= 
        ifelse(DistritoEESS == "SAN VICENTE DE CAŃETE", "SAN VICENTE DE CAÑETE",
        ifelse(DistritoEESS == "HUAŃEC", "HUAÑEC",
        ifelse(DistritoEESS == "ZUŃIGA", "ZUÑIGA",
        ifelse(DistritoEESS == "VIŃAC", "VIÑAC",
        DistritoEESS
        )))))-> DF

DF %>% mutate(ProvinciaEESS =
                ifelse(ProvinciaEESS == "CAŃETE", "CAÑETE",ProvinciaEESS)
                )->DF

```


Modificamos los errores presentados en la variable **ProvinciaPN**:

```{r}
DF %>% mutate (ProvinciaPN = 
        ifelse(ProvinciaPN %in% c("CAĐETE", "CAŃETE","CA+ćETE","CAĂ\u0083â\u0080\u0098ETE","CAĂ\u0091ETE"), "CAÑETE",
        ifelse(ProvinciaPN %in% c("FERREŃAFE"), "FERREÑAFE",
        ifelse(ProvinciaPN %in% c("MARAŃON"), "MARAÑON"
               , ProvinciaPN
               )))) -> DF
```


Modificamos los errores presentados en la variable **DistritoPN**:

```{r}
DF %>% mutate(DistritoPN = 
        ifelse(DistritoPN %in% c("VIŃAC", "VIĂ\u0091AC","VIĂ\u0083â\u0080\u0098AC"), "VIÑAC",
        ifelse(DistritoPN %in% c("SAN VICENTE DE CAĂ\u0091ETE","SAN VICENTE DE CAŃETE","SAN VICENTE DE CAĂ\u0083â\u0080\u0098ET","SAN VICENTE DE CAĐETE","SAN VICENTE DE CA+ćETE" ), "SAN VICENTE DE CAÑETE",
        ifelse(DistritoPN %in% c("ZUŃIGA", "ZUĂ\u0091IGA","ZUĂ\u0083â\u0080\u0098IGA"), "ZUÑIGA",
        ifelse(DistritoPN %in% c("BREŃA","BREĂ\u0083â\u0080\u0098A"), "BREÑA",
        ifelse(DistritoPN %in% c("HUAĂ\u0091EC","HUAŃEC"), "HUAÑEC",
        ifelse(DistritoPN %in% c("PUŃOS"),"PUÑOS"     ,
        ifelse(DistritoPN %in% c("PARIŃAS"),"PARIÑAS"   , 
        ifelse(DistritoPN %in% c("LOS BAŃOS DEL INCA" ), "LOS BAÑOS DEL INCA",
        ifelse(DistritoPN %in% c("FERREŃAFE"),"FERREÑAFE",
        ifelse(DistritoPN %in% c("MAŃAZO"),"MAÑAZO",
         DistritoPN
        ))))))))))) -> DF

```


Modificamos las variables **SIS**, **Juntos**, **Qaliwarma**, **Suplementacion** y **Consejeria** que presentan en sus datos valores de 0 y 1 reemplazándolos por **"Sí"** a los **1** y **"No"** a los **0**:


```{r}
DF %>% mutate(SIS=
               ifelse(SIS == 0,"No",
               ifelse(SIS == 1,"Sí",SIS))) -> DF
DF %>% mutate(Juntos=
               ifelse(Juntos == 0,"No",
               ifelse(Juntos == 1,"Sí",Juntos))) -> DF
DF %>% mutate(Qaliwarma=
               ifelse(Qaliwarma== 0,"No",
               ifelse(Qaliwarma == 1,"Sí",Qaliwarma))) -> DF
DF %>% mutate(Suplementacion=
               ifelse(Suplementacion== 0,"No",
               ifelse(Suplementacion == 1,"Sí",Suplementacion))) -> DF
DF %>% mutate(Consejeria=
               ifelse(Consejeria== 0,"No",
               ifelse(Consejeria== 1,"Sí",Consejeria))) -> DF
```


Convertimos las variables **Talla**, **Peso** y **HBC** en variables numéricas:

```{r}
DF$Talla= as.numeric(DF$Talla)
```

```{r}
DF$Peso= as.numeric(DF$Peso)
```

```{r}
DF$HBC = as.numeric(DF$HBC)
```


Para modificar la Talla y Peso se tomo en cuenta las [Curvas de la OMS](https://www.aepap.org/sites/default/files/curvas_oms.pdf ) para modificar de forma coherente y adecuada.

Arreglamos la variable **Talla** debido a los valores atípicos presentados en la data:

```{r}
DF %>% mutate (Talla=
        ifelse(Talla > 157 ,Talla/10 ,
        ifelse (Talla<2 ,Talla*100,
        ifelse (Talla<10 ,Talla *10,
        ifelse(Talla <= 16 ,Talla *10,
        Talla ))))) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <=20  ,Talla*5,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla >=140 & EdadMeses <=23  ,Talla /2,Talla)) -> DF
DF %>% mutate (Talla=
        ifelse(Talla <20 & EdadMeses == 54  ,Talla*5,Talla)) -> DF
```


Arreglamos la variable **Peso** debido a los valores atípicos presentados en la data:


```{r}
DF %>% mutate (Peso=
        ifelse(Peso > 200 ,Peso/100,
        Peso )) -> DF
```

```{r}
DF %>% mutate (Peso=
        ifelse(Peso > 100 & EdadMeses != 54 ,Peso/10,
        Peso )) -> DF
```


```{r}
DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >40 & EdadMeses != 54 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso <100 & Peso >60 & EdadMeses != 54 ,Peso/10,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso >100 & EdadMeses == 54, NA,
        Peso )) -> DF

DF %>% mutate (Peso=
        ifelse(Peso>80  & EdadMeses == 54, NA,
        Peso )) -> DF
DF %>% mutate (Peso=
        ifelse(Peso>1  & Peso<2 ,Peso*10,
         ifelse(Peso<1 ,Peso*100,      
        Peso ))) -> DF
DF %>% mutate (Peso=
        ifelse(Peso<4 ,Peso*3,
        Peso )) -> DF
```

Se modifica la variable **FechaNacimiento** y **FechaAtencion**:


```{r}
DF %>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "ene", "01") 
) %>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "feb", "02") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "mar", "03") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "abr", "04") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "may", "05") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "jun", "06") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "jul", "07") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "ago", "08") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "sep", "09") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "oct", "10") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "nov", "11") 
)%>% mutate(
  FechaNacimiento = str_replace(FechaNacimiento, "dic", "12") 
)->DF
```

```{r}
DF %>% mutate(
  FechaAtencion = str_replace(FechaAtencion, "feb", "02") 
) %>% mutate(
  FechaAtencion = str_replace(FechaAtencion, "ene", "01") 
)%>% mutate(
  FechaAtencion = str_replace(FechaAtencion, "mar", "03")
)%>% mutate(
  FechaAtencion = str_replace(FechaAtencion, "abr", "04") 
)%>% mutate(
 FechaAtencion = str_replace(FechaAtencion, "may", "05") 
)%>% mutate(
  FechaAtencion = str_replace(FechaAtencion, "jun", "06") 
) ->DF
```



# **3. ANÁLISIS DESCRIPTIVO**

De acuerdo a la data seleccionada, en nuestro proyecto evaluamos y utilizamos 22 de las 38 variables presentes en la data debido a la relevancia que presentan estas 22 en nuestro proyecto.

- **Red**: Nos permitirá ver la red general del sistema de salud donde se atendió el menor. Esta variable al fin y al cabo nos dará la ubicación del hospital con respecto a las redes de establecimientos que posee.

- **Microred**: Esta variable nos permitirá tener un mayor enfoque de la red de establecimiento de salud donde se atendió el menor.

- **EESS**: Esta variable nos permitirá obtener el número, código y nombre del establecimiento de salud en donde se trató el menor. Estos datos generales nos ayudarán a visualizar cual fue del establecimiento de salud que ha presentado mayores casos de atención por desnutrición en menores de 5 años.

- **ProvinciaEESS**: Nos dará una ubicación acerca de la provincia en donde se ubica el establecimiento de salud, y así podremos obtener puntos de atención establecidos con respecto a casos de desnutrición, a fin de visualizar que provincia de Lima fueron los mas afectadas y cuáles no.

- **Distrito EESS**: El distrito en donde se encuentra el establecimiento de salud, es una variable que nos permitirá visualizar que distritos de Lima fueron los mas afectados por la desnutrición en menores.
Fecha atención: Gracias a esta variable podremos saber el día, mes y año de la última evaluación médica del menor. Esta variable nos permitirá ver como ha sido la evolución de la desnutrición en los niños en los últimos años.

- **Género**: Esta variable nos permitirá tener un vistazo con respecto a la alimentación que llevan los niños y niñas en Lima

- **FechaNacimiento**: Esta variable nos permitirá saber la fecha exacta en la que nació el menor.

- **EdadMeses**: Esta variable nos ayudara a identificar de manera eficaz la edad del niño en meses, según su fecha de nacimiento. 
 
 
- **DepartamentoPN**: Esta variable nos permitirá saber de que departamentos procede cada niño. 

- **ProvinciaPN**: Esta variable nos permitirá saber de que provincia procede cada niño, dependiendo del departamento del que proviene.

- **DistritoPN**: Esta variable nos permitirá saber el distrito de procedencia de cada niño, dependiendo de la provincia de la que proviene.


- **Juntos**: La variable nos permite saber si el niño en cuestión es perteneciente al programa juntos o no.


- **SIS**: Esta variable nos ayudara a identificar si el niño posee o no el seguro integral de salud.

- **Qaliwarma**: La variable nos permite conocer si el niño es o no beneficiario del programa Qaliwarma.

- **Peso**: Esta variable nos permite conocer el peso del niño en kilogramos de manera precisa.

- **Talla**: La variable nos permitirá saber la talla del menor en centímetros eficazmente. 

- **Hemoglobina**: Esta variable nos dará el nivel de hemoglobina en sangre del niño en cuestión la cual estará medida en gramos entre decilitro.

- **Suplementacion**: Esta variable nos permitirá saber si el menor se encuentra tomando algún suplemento alimenticio o no.

- **Consejeria**: La variable nos permite saber si el niño recibe algún tipo de ayuda de consejeros para con su salud.

- **DiagnosticoAnemia**: Esta variable nos permitirá saber si el menor se encuentra con anemia o no, en caso el resultado fuese positivo, no daría el nivel en el que se encuentra la enfermedad.


- **HBC**: Esta variable nos permitirá saber numéricamente el nivel de HBC presente en el niño, la cual es un forma anormal de hemoglobina asociada con la destrucción de glóbulos rojos y anemia hemolítica. Su unidad es gramos entre decilitro.

## **3.1. Descriptores numéricos**


Evaluamos los máximos y mínimos de las variables cuantitativas más relevantes:




```{r,eval=TRUE}
summary(DF$Peso)
```
- Máximo: **34.30**
- Mínimo: **4.00**


```{r,eval=TRUE}
summary(DF$EdadMeses)
```
- Máximo: **60**
- Mínimo: **6**


```{r,eval=TRUE}
summary(DF$Hemoglobina)
```
- Máximo: **18**
- Mínimo: **4.4**


```{r,eval=TRUE}
summary(DF$HBC)
```
- Máximo: **18**
- Mínimo: **2.63**


### **3.1.1. Mediana, moda, medidas de tendencia central y rango intercuantil**



```{r,eval=TRUE, echo = FALSE}
boxplot(DF$Talla)
title(main = "Gráfico 2: Boxplot de la Talla en cm ",adj =0)
```


```{r,eval=TRUE, echo = FALSE}
boxplot(DF$Hemoglobina)
title(main = "Gráfico 3: Boxplot de la Hemoglobina en (g/dL) ",adj =0)
```

```{r,eval=TRUE, echo = FALSE}
boxplot(DF$Peso)
title(main = "Gráfico 4: Boxplot del Peso en Kg ",adj =0)
```

```{r}
median(DF$Peso,na.rm=TRUE)
median(DF$Talla,na.rm=TRUE)
median(DF$Hemoglobina)
```
Debido a los datos atípicos no es recomendable utilizar la media.

De los gráficos se determina:

- La mediana del peso es : 11.6 Kg
- La mediana de la talla es: 82 cm
- La mediana de la hemoglobina es: 11.5 (g/dL)


La moda de las variables: 


```{r,eval=TRUE, echo = TRUE}
Mode(DF$Talla,na.rm=TRUE)
Mode(DF$Hemoglobina,na.rm=TRUE)
Mode(DF$Peso,na.rm=TRUE)
Mode(DF$DiagnosticoAnemia)
```

- La moda de la variable Talla es: 80 cm
- La moda de la variable Hemoglobina es: 11 (g/dL)
- La moda de la variable Peso es: 12 kg
- La moda de la variable DiagnósticoAnemia es: "Normal" 

#### **Calculando la mediana respecto al tipo de anemia que posee cada paciente** 

```{r,eval=TRUE, echo = TRUE}
by(DF$Peso,DF$DiagnosticoAnemia,median,na.rm=TRUE)
```
#### **Hallando la mediana de la talla respecto al género** 

```{r,eval=TRUE, echo = TRUE}
by(DF$Talla,DF$Genero,median,na.rm=TRUE)
```
#### **Hallando la mediana de la hemoglobina respecto al género** 
```{r,eval=TRUE, echo = TRUE}
by(DF$Hemoglobina,DF$Genero,median,na.rm=TRUE)
```
#### **Medidas de tendencia de posición** 

Limites del 50% central de la varible Peso.

```{r,eval=TRUE, echo = FALSE}
quantile(DF$Peso,0.25,na.rm=TRUE)
quantile(DF$Peso,0.75,na.rm=TRUE)
```
Limites del 70% central de la talla de los pacientes.

```{r}
quantile(DF$Talla,0.20,na.rm=TRUE)
quantile(DF$Talla,0.90,na.rm=TRUE)
```

### **3.1.2.Rango interquantil del peso talla y hemoglobina.**

```{r}
IQR(DF$Peso,na.rm=TRUE)
```
```{r}
IQR(DF$Talla,na.rm=TRUE)
```
Rango = $R = Vmax-vamin$
```{r}
Rp = max(DF$Peso,na.rm=TRUE)-min(DF$Peso,na.rm=TRUE)
Rp
```

```{r}
Rt = max(DF$Talla,na.rm=TRUE) - min(DF$Talla,na.rm=TRUE)
Rt
```
```{r}
Rh = max(DF$Hemoglobina,na.rm=TRUE) - min(DF$Hemoglobina,na.rm=TRUE)
Rh
```





#### **3.1.3. Datos relevantes** 

Se determinará el porcentaje de menores que presentan alguna ayuda social (SIS, Juntos o Qaliwarma) y tienen algún tipo de anemia


Cuantificamos los menores que presentan algún tipo de  ayuda social estatal.

```{r, eval=TRUE}
nrow(filter (DF, DF$SIS =="Sí" | DF$Qaliwarma =="Sí"| DF$Juntos=="Sí" ))
```
- **10894 menores presentan algún tipo de  ayuda social estatal**

```{r,eval=TRUE}
porNAS = (10894/nrow(DF))*100
print(porNAS)
```
- **El 68.77959 % de los niños en el estudio presentó alguna ayuda social**


Cuantificamos los menores que presentan alguna ayuda social y tienen algún tipo de anemia

```{r, eval=TRUE}
nrow(filter (DF, DF$SIS =="Sí" | DF$Qaliwarma =="Sí"| DF$Juntos=="Sí", DF$DiagnosticoAnemia  != "Normal"))
```
- **1932 menores presentan alguna ayuda social y tienen algún tipo de anemia**



```{r,eval=TRUE}
porNCA = (1932 / 10894)*100
print(porNCA)

porNSA = 100 - porNCA
print(porNSA )
```

- **Determinamos que le porcentaje es 17.73453 %**
- **Por ende, el 82.26547 % presenta índices normales**




## **3.2. Descriptores gráficos**

Se analizarán las relaciones existentes más relevantes en nuestras variables de estudio:


#### **3.2.1. Edad**

Se analiza la variable EdadMeses y se presenta un gráfico respectivo.

```{r,eval=TRUE, echo = FALSE}
hist(DF$EdadMeses, xlab="Edad (meses)", ylab = "Frecuencia", main="Gráfico 5: Histograma de la variable Edad en meses",breaks=15,col="light blue")
abline(v=mean(DF$EdadMeses),col="red")
abline(v=Mode(DF$EdadMeses),col="green")
abline(v=median(DF$EdadMeses),col="blue")
legend("topright",c("Promedio","Moda","Mediana"),col=c("red","green","blue"),lty=1:1,lwd = 5)

```



En la presente gráfica podemos identificar:

- El promedio de la variable es: 22.22 meses
- La moda de la variable es: 12 meses
- La mediana de la variable es: 18 meses

#### **3.2.2. Peso**
Se analiza la variable Peso y se presenta un gráfico respectivo.

```{r,eval=TRUE, echo = FALSE}
hist(DF$Peso, xlab="Peso (Kg)", ylab = "Frecuencia", main="Gráfico 6: Histograma de la variable Peso en kilogramos",breaks=15,col="#DEB887")
abline(v=mean(DF$Peso,na.rm= TRUE),col="red")
abline(v=Mode(DF$Peso,na.rm= TRUE),col="green")
abline(v=median(DF$Peso,na.rm= TRUE),col="blue")
legend("topright",c("Promedio","Moda","Mediana"),col=c("red","green","blue"),lty=1:1,lwd = 5)
```

En la presente gráfica podemos identificar:

- El promedio de la variable es: 12.26 Kg
- La moda de la variable es: 12 Kg
- La mediana de la variable es: 11.6 Kg


#### **3.2.3. Talla**

Se analiza la variable Talla y se presenta un gráfico respectivo.

```{r,eval=TRUE, echo = FALSE}
hist(DF$Talla, xlab="Talla (cm)", ylab = "Frecuencia", main="Gráfico 7: Histograma de la variable talla en centímetros",breaks=15,col="darkorange")
abline(v=mean(DF$Talla,na.rm= TRUE),col="red")
abline(v=Mode(DF$Talla,na.rm= TRUE),col="green")
abline(v=median(DF$Talla,na.rm= TRUE),col="blue")
legend("topright",c("Promedio","Moda","Mediana"),col=c("red","green","blue"),lty=1:1,lwd = 5)
```


En la presente gráfica podemos identificar:

- El promedio de la variable es: 83.18 cm
- La moda de la variable es: 80 cm
- La mediana de la variable es: 82 cm



#### **3.2.4. Diagnóstico de anemia y provincias de los EESS**



```{r,eval=TRUE, echo = FALSE}
data<-table(DF$DiagnosticoAnemia,DF$ProvinciaEESS) 
data
```


**Gráfico 8: Mapa de calor del Diagnóstico de anemia respecto a las provincias de los EESS** 

```{r, echo=FALSE}
heatmap(table(DF$DiagnosticoAnemia,DF$ProvinciaEESS), cexCol = 0.8, cexRow = 1.25, Rowv = NA, Colv = NA)
```


<div style="text-align: justify">Podemos observar que en la provincia de Cañete posee una alta concentración de niños con anemia moderada y leve, la provincia de Huarochiri posee la mayor cantidad de niños con anemia severa y Huaral es la que posee una mayor población de niños sin anemia<div/>




#### **3.2.5. Género y el diagnóstico de anemia**

Realizamos un gráfico de barras para determinar la cantidad de niños por sexo que presentan algún tipo de anemia.



```{r,echo=FALSE}

tabla1 <- table(DF$DiagnosticoAnemia, DF$Genero)
barplot(tabla1,main="Gráfico 9: Gráfico de barras del Diagnótico de anemia respecto al género ", cex.main=1, beside = TRUE, las=1, 
        xlab='Género', ylab='Niños',
        col = c("lightblue", "mistyrose","lightyellow","lightgreen"), 
        ylim = c(0, 8000), )
legend('topleft', legend=rownames(tabla1), bty='n',
       fill=c("lightblue", "mistyrose","lightyellow","lightgreen"))
```
Se presenta la tabla para especificar las cantidades en el gráfico.
```{r,eval=TRUE, echo = FALSE}
tabla1
```
Identificamos que los niños presentan un mayor indice de anemia leve, moderada y severa a comparación de las niñas. Con respecto a los niveles normales, las niñas presentan un mayor índice.


Identificamos mediante un plot el rango aproximado de hemoglobina que presentan los niños de acuerdo a su peso y género.


#### **3.2.6. Peso, género y nivel de hemoglobina**

Se analizará la distribución y densidad presente en las variables mencionadas.
```{r ,eval=TRUE, echo = FALSE}

plot(DF$Hemoglobina,DF$Peso,pch = 20 ,col=ifelse(DF$Genero =="F" ,rgb(1,0,0,0.2),rgb(0,0,1,0.2)),xlab = "Hemoglobina (g/dL)",ylab = "Peso (Kg)",main = "Gráfico 10: Gráfico de dispersión de la variable Peso respecto a la Hemoglobina de acuerdo al género",cex.main=0.8 )
legend("topright",legend = c("M", "F"),
       lwd = 3, col = c("blue", "red"))

```

Respecto a la mayor concentración, se puede identificar que los niños que presentan entre 11 a 13 de hemoglobina tienen un rango de edad de entre 5 a 18 meses aproximadamente.

#### **3.2.7. Peso y Diagnóstico de Anemia** 


Se analizan las varibles representándolas en un bloxplot.

```{r,eval=TRUE, echo = FALSE}
ggplot(subset(DF,!is.na(Peso)), aes(x = Peso, y = DiagnosticoAnemia ,fill = DiagnosticoAnemia))+
stat_boxplot(geom = "errorbar",width = 0.25)+
geom_boxplot()+
theme_bw() +labs(title='Gráfico 11', 
       subtitle='Boxplot de la variable Peso respecto al Diagnóstico de anemia') + theme(plot.title=element_text(size=13.5, face='bold', color='black')) +theme (plot.subtitle =element_text(size=10, face='bold', color='black'))
```



#### **3.2.8. Organizaciones de apoyo (SIS, Juntos, Qaliwarma, Suplementacion, Consejeria)**

Se presenta un gráfico circular donde se presenta la distrubución de los infantes que presental algún sistema de apoyo.

```{r,eval=TRUE, echo = FALSE}
SIS=nrow(filter (DF, DF$SIS =="Sí"))
QALI=nrow(filter(DF,DF$Qaliwarma =="Sí"))
juntos=nrow(filter(DF,DF$Juntos=="Sí"))
sumple=nrow(filter(DF,DF$Suplementacion =="Sí"))
conse=nrow(filter(DF,DF$Consejeria=="Sí"))
count<-c(SIS,juntos,sumple,conse,QALI)
count2<- c("SIS", "Juntos", "Suplementacion", "Consejeria", "Qaliwarma")

color <- brewer.pal(length(count), "Set2") 
pie(count, labels=c("SIS = 10838"  ,"Juntos = 487","sumplementacion = 6030"," Consejeria = 7714","Qaliwarma = 13"), col = color)
title(main = "Gráfico 12: Gráfico circular de los tipos de ayuda social ",adj =0)
```


Se puede concluir:

- El Sistema Integral de Salud (SIS) es el más recurrente en los infantes. 
- El programa Qaliwarma presenta menos cantidad de infantes respecto a las demás.


#### **3.2.9. Diagnóstico de Anemia**


Se analiza la variable DiagnosticoAnemia y se presenta en un gráfico circular.

```{r,eval=TRUE, echo = FALSE}
N=nrow(filter (DF, DF$DiagnosticoAnemia =="Normal"))
L=nrow(filter (DF, DF$DiagnosticoAnemia =="Anemia Leve"))
M=nrow(filter (DF, DF$DiagnosticoAnemia =="Anemia Moderada"))
S=nrow(filter (DF, DF$DiagnosticoAnemia =="Anemia Severa"))
count<-c(N,L,M,S)

color <- brewer.pal(length(count), "Set2") 

pie(count,labels = c("Normal = 12892","Anemia Leve =  1904","Anemia Moderada = 1012","Anemia Severa = 31"),col = color )
title(main = "Gráfico 13: Gráfico circular del diagnóstico de anemia ",adj =0)
```

Se puede concluir:

- Hay mayor índice de niños sin algún tipo de anemia.

Respecto a los casos con anemia:

- Los casos de Anemia leve presentan mayor índice.
- Los casos de anemia severa son mínimos con respecto a la cantidad de infantes.


#### **3.2.10. Regresión lineal, covarianza y la correlación de la variable peso y talla**


```{r}
Ln = lm(DF$Talla~DF$Peso)
Ln
plot(DF$Talla~DF$Peso,xlab="Peso (Kg)",ylab="Talla (cm)",col=rgb(0,0,1,0.2))
abline(Ln,col="red",lwd=2)

cor.test(DF$Peso,DF$Talla)

title(main = "Gráfico 14: Gráfica de regresión lineal de la Talla respecto al Peso ",adj =0)
```


```{r}
summary(Ln)
```

Podemos evidenciar que los interceptos  son  b0 = 46.12604 , b1 = 2.99545.asimismo el R cuadrado es mayor al 65%  siendo un 74.08 % porque que se puede modelar por una regresión lineal. 


$y =46.42604 + 2.99545x$

```{r}
0.7408 *100
```

#### **Covarianza y coeficiente de correlación de la Talla respecto al Peso**

```{r}
cov(DF$Talla,DF$Peso,use = "complete.obs")
cor(DF$Talla,DF$Peso,use="complete.obs")
```

Observamos que la covarianza es positiva por lo tanto se mueven en la misma dirección, es decir crecen en el mismo sentido entre mas Pese el infante mas estatura presentara este.Además,la correlación que existe entre ellas es una correlación positiva fuerte debido  a su aproximación hacia el 1 en un 86%, esto me quiere decir que yo puedo explicar la variación de la variable "Talla" en función de la variable "Peso".


# **4. ANÁLISIS PROBABILÍSTICO**


```{r,echo=FALSE}
install.packages('fastGraph')
install.packages('mosaic')
```

```{r,echo=FALSE}
library(fastGraph)
library(mosaic)
library(DescTools)
library(dplyr)
```

```{r,echo=FALSE}
copyDF = DF
```
En este apartado, desarrollaremos un análisis basado en distintos teoremas, axiomas y modelos probabilísticos aplicados en nuestra base de datos. Se tiene el propósito de determinar diferentes probabilidades que sean relevantes para nuestra investigación y, además, nos proporcionen información valiosa para las diferentes relaciones existentes en nuestras variables junto a los objetivos previamente planteados. 




## **4.1 AXIOMAS Y TABLAS **



Como parte del estudio realizado se clasifica el género según el tipo de anemia a la que pertenece:


```{r}
print("Distribución de los pacientes segundo su tipo de anemia y genero")
tb<-table(DF$Genero,DF$DiagnosticoAnemia)
tb<-addmargins(tb,margin=c(1,2))
colnames(tb) <- c("Anemia Leve", "Anemia Moderada" ,"Anemia Severa","Normal"," Total")
rownames(tb) <- c("Femenino","Masculino","Total")
tb
```


Si se selecciona un niño al azar que tenga cualquier tipo de anemia  podemos responder:


**Axioma 3:**

$P(As \cup Am) = P(As) + P(Am)$

**1)** ¿Cual es la probabilidad de seleccionar un niño que tenga anemia severa o anemia moderada?
```{r}
31/15839 + 1012/15839
```

**2)** ¿Cuál es la probabilidad de seleccionar a un niño tenga anemia leve o que sea del genero masculino ?

**Axioma 4:**


$P( Al ∪ M) = P(Al) + P(M) - P(Al ∩ M)$

```{r}
1904/15839 + 8036/15839 - 1021/15839
```


Según la base de datos obtenida ¿Cuál es la probabilidad de que el establecimiento de Salud pertenezca a una determinada provincia y el infante atendido presente algún tipo de anemia? 



**Axioma 10:**

$P(A ∩ B) = P(A) * P(B)$


```{r}
unique(copyDF$ProvinciaEESS)
```
```{r}
nrow(filter(copyDF,  copyDF$DiagnosticoAnemia != "Normal"))
```
Calculando la probabilidad de que un infante presente algún tipo de anemia.

```{r}
Prob_Anemia =  (2947/15839) 
Prob_Anemia
```


 **1)** HUAURA

```{r}
prob_Huara = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "HUAURA" ))/ nrow(DF)) * Prob_Anemia
prob_Huara
```


**2)** HUARAL

```{r}
prob_Huaral = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "HUARAL" ))/ nrow(DF)) * Prob_Anemia
prob_Huaral
```

**3)** BARRANCA

```{r}
prob_Barranca = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "BARRANCA" ))/ nrow(DF)) * Prob_Anemia
prob_Barranca
```


**4)** CAÑETE

```{r}
prob_Canete = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "CAÑETE" ))/ nrow(DF)) * Prob_Anemia
prob_Canete

```


**5)** YAUYOS

```{r}
prob_Yauyos = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "YAUYOS" ))/ nrow(DF)) * Prob_Anemia
prob_Yauyos
```

**6)** HUAROCHIRI 

```{r}
prob_Huarochiri = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "HUAROCHIRI" ))/ nrow(DF)) * Prob_Anemia
prob_Huarochiri 
```
**7)** OYON 

```{r}
prob_Oyon = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "OYON" ))/ nrow(DF)) * Prob_Anemia
prob_Oyon
```

**8)** CANTA

```{r}
prob_Canta = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "CANTA" ))/ nrow(DF)) * Prob_Anemia
prob_Canta
```

**9)** CAJATAMBO


```{r}
prob_Cajatambo = (nrow(filter(copyDF, copyDF$ProvinciaEESS == "CAJATAMBO" ))/ nrow(DF)) * Prob_Anemia
prob_Cajatambo
```


### **Probabilidad Total**

**1)** ¿Calcular la es la probabilidad de que un infante no padezca de anemia severa?


$P(As^c)  = P(Al).P(M) + P(Am).P(M)+P(N).P(M) + P(F).P(Al)+P(F).P(Am)+P(F).P(N)$


```{r}
# AS' : no padesca Anemia severa
PM = 8036/15839 # Masculino
PF = 7803/15839 # Femenino

PAl = 1904/15839 # AL :Anemia leve
PAM = 1012/15839 # AM :Anemia Moderada
PN= 12892/15839 # N :Normal


PT = (PM*PAl)+(PM*PAM)+(PM*PN) + (PF*PAl)+(PF*PAM)+(PF*PN)
PT

```

### **Probabilidad de Bayes** 

e.Si se conoce  la probabilidad de que infante no padezca anemia severa ¿cual es la probabilidad de que el niño sea del sexo Masculino? 

$P(M/As^c) = P(AL).P(M) + P(M)*P(AM) + P(M)*P(N) / P(As^c)$

```{r}

PM = 8036/15839 # M :sexo masculino 
PMnAs = ((PAl*PM)+(PM*PAM)+(PM*PN))/PT
PMnAs
```

## **4.2. DISTRIBUCIONES DISCRETAS NOTABLES**


### **4.2.1. Distribución binomial**


Un experimento binomial se puede caracterizar como la extracción de n elementos uno
a uno con reposición, de una población finita (N) o infinita dividida en dos categorías
(éxito y fracaso).



![](https://victoryepes.blogs.upv.es/files/2019/06/binomial-1.jpg)


Para emplear la distribución, se tomo como muestra a 100 infantes y las siguentes probabilidades según el Ministerio de Salud (2021):

a) La probabilidad de que un infante presente **anemia severa** es de 0.064.

b) La probabilidad de que un infante presente **seguro SIS** es de 0.673.

c) La probabilidad de que un infante **no presente índices anemia** es de 0.623.

Además, recodemos:

Esperanza de la distribución binomial: $E(x) = n*p$


Varianza de la distribución binomial: $V(x) = n*p*q$

#### **CASOS PLANTEADOS:**

**1)** La probabilidad de hallar menos de 5 infantes que presenten indices de anemia severa


```{r}
pbinom(4,100,0.064)
```

```{r}
Infantes <- 1:4 
Probabilidad <- pbinom(Infantes,100,0.064)
plot(x=Infantes, y=Probabilidad, 
     type='h', las=1, lwd=3,xlab = "Infantes", ylab = "Probabilidad")

title(main = "Gráfico 15: Gráfico de distribución binomial sobre los índices de anemia severa ",cex.main = 1, adj =0)
```
Su esperanza:

```{r}
Esperanza1<-100*0.064
Esperanza1
```

Su varianza:

```{r}
Varianza1<-100*0.064*0.936
Varianza1

```



**2)** la probabilidad de que como mínimo 50 infantes presenten seguro SIS

```{r}
1-pbinom(49,100,0.673)
```
```{r}

Infantes <- 50:100 
Probabilidad <- 1-pbinom(Infantes,100,0.673)
plot(x=Infantes, y=Probabilidad, 
     type='h', las=1, lwd=3,xlab = "Infantes", ylab = "Probabilidad")
title(main = "Gráfico 16: Gráfico de distribución binomial sobre los infantes pertenecientes al SIS",cex.main = 0.9, adj =0)
```

Su esperanza:
```{r}
Esperanza2<-100*0.673
Esperanza2
```
Su varianza:

```{r}
Varianza2<-100*0.673*0.327
Varianza2

```




**3)** La probabilidad de que hayan por lo menos 60 infantes sin indice de anemia

```{r}
1-pbinom(59,100,0.623)
```
```{r}
Infantes <- 50:100 
Probabilidad <- 1-pbinom(Infantes,100,0.623)
plot(x=Infantes, y=Probabilidad, 
     type='h', las=1, lwd=3,xlab = "Infantes", ylab = "Probabilidad")
title(main = "Gráfico 17: Gráfico de distribución binomial sobre los infantes sin índices de anemia",cex.main = 0.9, adj =0)
```

Su esperanza:

```{r}
Esperanza3<-100*0.623
Esperanza3
```

Su varianza:

```{r}
Varianza3<-100*0.623*0.377
Varianza3
```


### **4.2.2. Distribución hipergeométrica**

La distribución hipergeométrica es una distribución de probabilidad de una variable
aleatoria discreta y es útil donde las extracciones se realizan sin reposición, en cuyo
caso las pruebas no son independientes.


![](https://proyectodescartes.org/iCartesiLibri/materiales_didacticos/EstadisticaProbabilidadInferencia/VAdiscreta/4_1DistribucionHipergeometrica/img/FormulaHipergeometrica.png)



A) Según la  base de datos, de los 15839 infantes estudiados, se determina que 2947 poseen algún tipo de anemia. 

```{r}
nrow(filter(copyDF,  copyDF$DiagnosticoAnemia != "Normal"))
```

$N = 15839$

$M = 2947$

#### **CASOS PLANTEADOS:**


Se selecciona una muestra sin reemplazo de 14 infantes, donde se plantean las siguientes probabilidades:

$n = 14$

1) ¿Cuál es la probabilidad de encontrar exactamente a 1 infante con algún tipo de anemia?


```{r}
dhyper(1,2947,12892,14)
```

2) ¿Cuál es la probabilidad de encontrar exactamente a 2 infantes con algún tipo de anemia?


```{r}
dhyper(2, 2947,12892,14)
```
3) ¿Cuál es la probabilidad de encontrar exactamente a 3 infantes con algún tipo de anemia?


```{r}
dhyper(3, 2947,12892,14)
```

4) ¿Cuál es la probabilidad de encontrar exactamente a 4 infantes con algún tipo de anemia?

```{r}
dhyper(4, 2947,12892,14)
```

5) ¿Cuál es la probabilidad de encontrar a 5 o más  infantes con algún tipo de anemia?

```{r}
1 - phyper(4, 2947,12892, 14)
```


```{r}
MSReemplazo <- 0:14 
Probabilidad <- dhyper(x=MSReemplazo, 2947,12892,14 )
plot(x=MSReemplazo, y=Probabilidad, 
     type='h', las=1, lwd=3,xlab = "Muestra sin reemplazo", ylab = "Probabilidad") + abline(v=14*2947/15839, col='red', lwd=2)

title(main = "Gráfico 18: Gráfico de distribución hipergeométrica sobre los índices de anemia ",cex.main = 1, adj =0)
```

Donde la esperanza $E(x) = n (M/N)$ es:


```{r}
14*(2947/15839)
```

Y la varianza $V(x) = n (M/N) * (1 -(M/N) * ( N - n/N - 1)$ es:

```{r}
14*(2947/15839) * (1 - (2947/15839) * ((15839 - 14)/(15839-1)))
```




B) Según la  base de datos, de los 15839 infantes estudiados, se determina que 10894 poseen algún tipo de ayuda social estatal. 

```{r}
nrow (filter(copyDF,  (copyDF$Juntos == 'Sí' | copyDF$SIS == 'Sí' | copyDF$Qaliwarma == 'Sí')))
```
$N = 15839$

$M = 10894$

#### **CASOS PLANTEADOS:**


Se selecciona una muestra sin reemplazo de 5 infantes, donde se plantean las siguientes probabilidades:

$n = 5$

1) ¿Cuál es la probabilidad de encontrar exactamente a 1 infante con algún tipo de ayuda social estatal?


```{r}
dhyper(1,10894,4945,5)
```

2) ¿Cuál es la probabilidad de encontrar exactamente a 2 infantes con algún tipo de ayuda social estatal?


```{r}
dhyper(2, 10894,4945,5)
```
3) ¿Cuál es la probabilidad de encontrar exactamente a 3 infantes con algún tipo de ayuda social estatal?


```{r}
dhyper(3, 10894,4945,5)
```

4) ¿Cuál es la probabilidad de encontrar exactamente a 4 infantes con algún tipo de ayuda social estatal?

```{r}
dhyper(4, 10894,4945,5)
```


5) ¿Cuál es la probabilidad de encontrar a 5 o más  infantes con algún tipo de ayuda social estatal?

```{r}
1 - phyper(4, 10894,4945, 5)
```


```{r}
MSReemplazo2 <- 0:5
Probabilidad2 <- dhyper(x=MSReemplazo2, 10894,4945, 5)
plot(x=MSReemplazo2, y=Probabilidad2, 
     type='h', las=1, lwd=3,xlab = "Muestra sin reemplazo", ylab = "Probabilidad")+ abline(v=5*10894/15839, col='red', lwd=2)

title(main = "Gráfico 19: Gráfico de distribución hipergeométrica sobre los índices de ayuda social estatal",cex.main = 0.8, adj =0)
```
Donde la esperanza $E(x) = n (M/N)$ es:
```{r}
5*(10894/15839)
```

Y la varianza $V(x) = n (M/N) * (1 -(M/N) * ( N - n/N - 1)$ es:

```{r}
5*(10894/15839) * (1 - (10894/15839)) * ((15839- 5)/(15839-1))
```

## **4.3. DISTRIBUCIONES CONTINUAS**

Creando y rectificando la base de datos:


```{r,eval=FALSE}
data2 = subset(DF,select=c(Genero,Peso,Talla,EdadMeses,Hemoglobina,DiagnosticoAnemia))
data2
data2 %>% mutate(Peso = ifelse( Peso < 5 & EdadMeses < 6,NA,
                 ifelse(Peso>20 & EdadMeses < 33,NA,
                  ifelse(Peso >20 & EdadMeses > 33 ,NA,Peso))))%>% mutate(Genero = ifelse( Genero=="F","Femenino",
                      ifelse(Genero == "M","Masculino",Genero)))-> data2

```



### **4.3.1. Distribución Normal**

La distribución normal adapta una variable aleatoria a una función dependiente de la media y la desviación típica. En otras palabras, la función y la variable aleatoria tendrán la misma representación pero con ligeras diferencias.

![](https://matemovil.com/wp-content/uploads/2018/06/f%C3%B3rmula-distribuci%C3%B3n-normal.jpg)


Filtrado de data 


```{r}
data = subset(data2,select= c(Genero,Peso,Talla,EdadMeses,Hemoglobina,DiagnosticoAnemia),DiagnosticoAnemia == "Anemia Moderada")
data = data[complete.cases(data),]
data= data[1:200,]

```


Test para verificar si la variable **Peso** puede presentar una distribución normal

```{r}
shapiro.test(data$Peso)
```


Luego de haber verificado el p-value y ver que es mayor a 66% ,la variable peso si puede presentar un distribución normal.
PAra eso estudiamos la  muestra de 200 infantes para visualizar la forma de la distribución y  de igual forma idenficar  su media, mediana y moda. 


```{r}
mp = mean(data$Peso,na.rm=TRUE)
dst = sd(data$Peso)
medianaP = median(data$Peso)
modaP = Mode(data$Peso)
```

```{r}
g2 <- plotDist(dist="norm",mean = mp,sd = dst,type = "h",lab = "x's = Estaturas", col = 'blue', main = "Gráfico 20: Gráfico de comprobación de distribución normal",cex.main = 0.8) 
g2

```

```{r}
x <- seq(-3, 3, length = 100) *dst + mp
hist(data$Peso,freq=FALSE,col="lightsalmon",main="Gráfico 21: Histograma del Peso", xlab = 'Peso (Kg)')
curve(dnorm(x,mp,dst),col="blue",lwd=2,add=TRUE)
abline(v = mp,lwd = 3,col="red")
abline(v = medianaP,lwd = 3,col="black")
abline(v = modaP,lwd = 2,col="yellow")
legend( x = "topright",y = c("media","mediana","moda"),fill=c("red","black","yellow"))


```
#### **CASOS PLANTEADOS:**


Según el estudio de  200 infantes  que tienen anemia de grado 2  se señala que el peso de cada infante sigue una distribución normal. Por ello en el siguiente caso se calculara las siguientes probabilidades donde X  es la variable aleatoria que sige dicha distribución.

$X∼N(13.1197,2.728154)$


**1)** Cual es la probabilidad de que el Peso de los niños que presentan anemia moderada que se encuentre entre 10 y  25. 
```{r}
shadeDist( c( 10,25),"dnorm",mp, dst, lower.tail=FALSE,col=c("purple", "lightgreen"), main ="Gráfico 22: Gráfica de distribución normal del índice de anemia moderada", cex.main = 0.9, adj=0)

round(pnorm(25,mp,dst)-pnorm(10,mp,dst),4)
```
Esto quiere decir que Aproximadamente el 87% de los infantes en este estudio tiene un peso entre 10 kg y 25 kg .


**2)** Calcular es la probabilidad de que los niños tengo un peso como mínimo 15 kg.


```{r}
pnorm(15,mp,dst)
shadeDist(15,"dnorm",mp, dst, lower.tail=FALSE,col=c("orange", "red"), main ="Gráfico 23: Gráfica de distribución normal de infantes con peso de 15 a más Kg ", cex.main = 0.9, adj=0)
```


Esperanza matematica de la distribución normal del peso
```{r}
mp
```
Varianza de la distrubción normal del peso
```{r}
var(data$Peso)
```


