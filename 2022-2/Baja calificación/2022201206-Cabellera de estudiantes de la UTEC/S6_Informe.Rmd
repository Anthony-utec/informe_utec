---
title: "PG2"
date: "2022-11-25"
output:
  html_document:
    toc: yes
    toc_depth: 5
    toc_float:
      collapsed: no
      smooth_scroll: yes
  word_document:
    toc: yes
    toc_depth: '5'
  html_notebook:
    toc: yes
    toc_depth: '5'
---

```{r}
library(kableExtra)
```


![](imagen.png)

# **Estudio de la cabellera de los estudiantes de UTEC**

## **1. Introducci√≥n**
### **Antecedentes** 

Seg√∫n Garnier (marca cosm√©tica mundial desde 1995), nos dice que existe una gran variedad de diferencias entre el cabello de un var√≥n con el de una mujer.
El cabello de los hombres tiende a ser m√°s grueso, adem√°s es m√°s propenso a ser graso y tener caspa. Las mujeres por su parte, tienen el cabello m√°s fino, lo que conlleva a que pueda ser m√°s quebradizo y reseco.
Pero, independientemente de que seas hombre o mujer, el cabello debe cuidarse adecuadamente para que est√© completamente sano y evites enfermedades capilares como la caspa, la dermatitis entre otras.

Seg√∫n algunos fil√≥sofos como Aristoteles sugiere que  el cabello se formaba a trav√©s de los vapores impuros exhalados por los poros del cuerpo, estos residuos mediante  un proceso se convert√≠an en sangre y de esta manera crec√≠a el cabello. Los hombres y las mujeres somos muy diferentes en todo, y el cabello no es la excepci√≥n. Existen diversas diferencias entre ambos cueros cabelludos. El cabello de los hombres  tiende a ser m√°s grueso, graso y tener caspa, por el contrario en caso de las mujeres el cabello tiende a ser m√°s fino, lo que conlleva a ser m√°s quebradizo y reseco. Por eso el cuidado   del cabello, tanto del hombre como de la mujer depende  de ciertos productos que utilizamos para  nuestro lavado esto considerando el tipo de cabello que tengamos.  En el mercado hay m√∫ltiples productos para que tu cabello est√© saludable pero no todos se adaptan bien a tu tipo de cabello y a la necesidad que tengas, entonces en vez de cuidarlo, podr√≠an da√±arlo.

Seg√∫n MedlinePlus (Un servicio de informaci√≥n en l√≠nea provisto por la Biblioteca Nacional de Medicina de los Estados Unidos), nos dice que uno de los cambios m√°s com√∫n en las personas es el cambio de color en el cabello, ya que es uno de los signos m√°s obvios del envejecimiento. El color del cabello se debe a un pigmento, llamado melanina, que producen los fol√≠culos pilosos. Los fol√≠culos pilosos son estructuras en la piel que producen y permiten el crecimiento del cabello. Con la edad, los fol√≠culos producen menos melanina y eso provoca las canas. El encanecimiento comienza con frecuencia hacia los 30 a√±os de edad. Por ello, usar medicamentos y un shampoo adecuado, puede ayudar a prolongar el cambio de color.

### **Relevancia**

Determinar las caracter√≠sticas del cabello es mayor entre los estudiantes de UTEC y medir el impacto de los productos comerciales en cada uno de ellos con la finalidad poder producir y vender un shampoo especialmente dise√±ado para cada uno.


### **Factibilidad**

Para poder llevar a cabo el estudio, se decidi√≥ organizar de forma eficaz el proyecto. Por ello, se elabor√≥ un diagrama de Gantt, el cual contiene las fechas de cada actividad realizada respetando el tiempo de entrega establecido.

#### **Planificaci√≥n**



```{r}
library(ggplot2)
library(tidyr)
library(lubridate)
```



```{r}
df <- read.csv("Gantt.csv")
```



```{r}
df <- data.frame(Tarea = c("Lluvia de ideas" , "Escoger tema" , "Herramienta de datos"          , "Recopilaci√≥n de data", "Limpieza de data" , "Descriptores num√©ricos","Descriptores gr√°ficos","An√°lisis probabil√≠stico", "Modelos probabil√≠sticos","Conclusiones y mejoras")
                 , Inicio = c("2022-08-24"      ,"2022-08-28"
                             ,"2022-08-31"        ,"2022-10-03"
                             ,"2022-10-10"        , "2022-10-17"
                             , "2022-10-25", "2022-11-12", "2022-11-14", "2022-11-16")
                 
                 ,Fin = c("2022-08-27"         ,"2022-08-28"
                          ,"2022-09-08"        ,"2022-10-09"
                          ,"2022-10-16"        , "2022-10-24"
                          , "2022-10-27", "2022-11-24", "2022-11-25", "2022-11-25")
                 , Completo = c(TRUE, TRUE,TRUE, TRUE, TRUE, TRUE, TRUE,TRUE,TRUE,TRUE))
```



```{r}
library(ymd)
```


```{r}
df$Inicio <- ymd(df$Inicio)
df$Fin <- ymd(df$Fin)
```


```{r}

df.melt <- df%>%
  tidyr::pivot_longer(col = c(Inicio,Fin))

```


```{r}

today <- Sys.Date()
```








```{r}
pl <- ggplot(df.melt, aes(x = value, y = Tarea, colour = Completo ))
pl <- pl + geom_line( alpha = 0.2, size = 10)
pl <- pl + geom_text(aes(label = format(value, "%d %b")), vjust = -0.5, angle = 45, size = 3, color = "black")
pl <- pl +   theme_classic()
pl <- pl + geom_vline(xintercept = today, color = "red", size = 2, alpha = 0.5)
pl <- pl + labs(title = "Diagrama de Gantt")
pl <- pl + labs(x = "Date")
pl <- pl + labs(y = "Tareas")
pl <- pl + scale_color_manual(values = c("red", "blue"))
pl <- pl + theme(legend.position = "none")
pl <- pl + theme(panel.background = element_rect(color = "black"))
pl <- pl + scale_x_date(name = "Fechas"
                        ,  date_labels = "%d %b"
                        ,  date_breaks = "1 week"
                        , minor_breaks = "1 day"
                        ,  sec.axis =  dup_axis(name = "N√∫mero de semana en el a√±o",labels = scales::date_format('%W')))
pl
```






## **2. Objetivos**

### **Objetivo general**
El objetivo principal de nuestro proyecto es saber acerca del cuidado y estado de la cabellera de los estudiantes de Utec, adem√°s se busca encontrar relaciones entre nuestras variables propuestas.

### **Objetivos espec√≠ficos**
1. Determinar la preferencia de las personas respecto a los productos de cuidado del cabello.
2. Estimar la probabilidad de que las personas utilicen ciertos productos o herramientas para el cabello.
3. Determinar las diferencias del cuidado del cabello de acuerdo al g√©nero de las personas.
4. Determinar la salud del cabello en raleci√≥n a los productos y herramientas que utilizan.
5. Definir si existe alguna relaci√≥n entre las caracteristicas del cabello, y los productos y herramientas que utilizan las personas.

### **Preguntas generales**


* ¬øQu√© productos y herramientas para el cabello suelen emplear los estudiantes del ciclo 2022-2 de UTEC?

* ¬øQu√© shampoo, productos y herramientas para el cabello presentan una mayor demanda por parte de los estudiantes de UTEC?

* ¬øCu√°les son los ingredientes m√°s frecuentes que est√°n presentes en los productos que el alumnado de UTEC adquiere?

* ¬øCu√°les son las caracter√≠sticas que predomina en la cabellera de los alumnos de UTEC?




## **3. Datos**

### **Proceso de recolecci√≥n de datos**
Nuestro estudio fue realizado para poder encuestar el m√≠nimo de observaciones requeridas con la finalidad de obtener informaci√≥n que represente a nuestra poblaci√≥n. Para el presente trabajo se realiz√≥ una recolecci√≥n de datos la cual fue ejecutada siguiendo un proceso en espec√≠fico. En primer lugar, realizamos un formulario con preguntas sumamente exactas para as√≠ poder obtener el resultado deseado. Despu√©s, la estrategia que elegimos para obtener las encuestas en el menor tiempo posible fue la de comprar Ole ole, chupetes, galletas y chin chin para poder ofrecerlas a las personas que nos ayudar√°n llenando nuestro formulario. Posteriormente, pasamos a encuestar al mayor n√∫mero de personas posibles. Luego caminamos del piso 1 al piso 11 para poder encontrar m√°s personas y as√≠ ser m√°s eficaces y lograr nuestro objetivo en el menor tiempo posible.

QR de nuestra encuesta:
![Imagen del QR de nuestra encuesta](imagen4.jpeg)

### **Poblaci√≥n, muestra y muestreo**
* Poblaci√≥n de estudio: Estudiantes de UTEC que se encuentran cursando el semestre 2022-2.

* Tama√±o de la muestra: 257 encuestas 

* Representatividad: Esta muestra representa la poblaci√≥n de estudiantes de UTEC, debido a que supera la cantidad de estudiantes m√≠nima requerida para el estudio. Por ello, las caracter√≠sticas de esta muestra se pueden generalizar a toda la poblaci√≥n.

* Tipo de muestreo: No probabil√≠stico intencional. Este estudio est√° siendo realizado en la universidad UTEC, a la cual pertenece el grupo 6 del curso Estad√≠stica y Probabilidades I


### **Variables**



| Pregunta formulada |    Variable     |  Tipo de Variable  |                                   Restricciones                                   |                                              Descripci√≥n                                               |
|:----------------:|:-----------------:|:----------------:|:----------------:|
|   Edad        |         Edad      | Num√©rica discreta| Solo n√∫meros en a√±os.                                            |                                    Indica el ciclo del estudiante.                                  |
|     G√©nero         |     G√©nero      | Categ√≥rica nominal |    Pregunta cerrada (masculino, femenino y prefiero no decirlo).                              |                                       
|   Carrera   |   Carrera   |Categ√≥rica nominal   | Elegir entre opciones.                 |          
|        Ciclo         |     Ciclo      | Categ√≥rica ordinal |Elegir entre n√∫meros enteros con un rango de 1 a 10.             
|Escala a la que perteneces|    Escala      | Categ√≥rica ordinal  |          Elegir entre opciones A, B, C, D o D           |                    
|Selecciona la longitud de tu cabello|Longitud| Categ√≥rica ordinal  |Elegir entre opciones corto, mediano, largo o super largo.|                 
|Tipo de cabello|Tipo   | Categ√≥rica nominal |Elegir opciones entre graso, mixto o seco.
|¬øQu√© tanto se lava el cabello?|LavaC | Categ√≥rica nominal |  Elegir entre opciones de distintos intervalos |                                  
|¬øCu√°ntos mililitros de shampoo usas al ba√±arte aproximadamente? | MiliS   | Num√©rica discreta  | Seleccionar entre el rango de las opciones.      |
|Seleccione la temperatura del agua con la que se lava el cabello |  Temperatura  | Categ√≥rica ordinal |     Elegir entre opciones fr√≠a, tibio, caliente o me es indiferente.  |
|Introduce el tiempo en el que se demora secar tu cabello aproximadamente.|  Tiempo  | Num√©rica  continua  |Colocar el tiempo en minutos y solo el n√∫mero |                 |
|¬øCu√°ntas veces compras shampoo al mes?|   VecesC  | Num√©rica discreta|Colocar solo n√∫meros enteros.                            |
|¬øUtilizas un shampoo con sulfatos?| Sulfatos  | Categ√≥rica nominal |Seccionar entre las opciones s√≠, no u no s√©.                 |
|¬øUtilizas shampoo con sal?|   Sal  | Categ√≥rica nominal |  Seccionar entre las opciones s√≠, no u no s√©.                          |
|¬øUtilizas shampoo cruelty free (libre de crueldad animal)?| Cruelfre| Categ√≥rica nominal  |Seccionar entre las opciones s√≠, no u no s√©.| 
|¬øCu√°l es el precio que pagas por un shampoo, frecuentemente?|Precio   | Num√©rica continua |Colocar en soles y solo n√∫meros enteros.
|¬øQu√© productos utilizas para el cabello?  |ProduC | Categ√≥rica nominal |  Se seleccionan m√∫ltiples opciones en un rango de 7 opciones |                                 
|¬øUtilizas productos para el cabello con siliconas?|SiliC   | Categ√≥rica nominal  | Elegir entre las opciones s√≠, no u  no s√©.      |
|¬øQu√© herramientas de calor utilizas para el cabello?|  HerraC  | Categ√≥rica nominal |    Se seleccionan m√∫ltiples opciones en un rango de 5 opciones.  |
|¬øQui√©n compra el shampoo que utilizas?| Qcompra | Categ√≥rica nominal  |Elegir entre las opciones yo, mam√°, pap√°, amigo u otro familiar. | 
|¬øCu√°l es tu marca de preferencia?| Marca  | Categ√≥rica nominal |Colocar el nombre de la marca en min√∫scula.                 |



## **4. Limpieza de datos** 

Para poder iniciar con la limpieza de datos, primero debemos instalar y leer las siguientes librer√≠as:



```{r}
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(modeest)
library(car)
library(ggplot2)
```

Ahora debemos cargar la base de datos
```{r}
CA <- read_csv("Encuesta_Estadistica_Grupo6.csv")
```

Analizando nuestra base de datos nos damos cuenta que tenemos dos columnas que no ser√°n de utilidad para nuestro estudio, estas son "Marca temporal" Y "Direcci√≥n de correo", es por eso que decidimos eliminarlas de la siguiente manera:
```{r}
CA <- CA[,c(3:23)]#En esta linea de c√≥digo se est√°n eliminando "Marca temporal" y "Direcci√≥n de correo electr√≥nico"
```

Ahora con la funci√≥n names podemos conocer los nombres de nuestra variables y con la funci√≥n rename podemos modificarlas para facilitar su manejo.
```{r}
names(CA)
```
```{r}
rename (CA,
        Genero = "G√©nero",
        Edad =  "Edad (solo en n√∫meros, ejemplo: 18, 20, 22, etc.)", 
        Carrera = "Carrera", 
        Ciclo = "Ciclo",
        Escala = "Escala a la que perteneces en UTEC",
        Longitud = "Selecciona la longitud de tu cabello",
        Tipo = "Tipo de cabello",
        LavaC = "¬øQu√© tanto se lava el cabello?",
        MiliS = "¬øCu√°ntos mililitros de shampoo usas al ba√±arte aproximadamente?",
        Temperatura = "Seleccione la temperatura del agua con la que se lava el cabello",
        Tiempo =  "Introduce el tiempo en el que se demora secar tu cabello aproximadamente. (Colocar el tiempo en minutos y solo n√∫meros, ejemplo: 15, 120, etc.)",
        VecesC = "¬øCu√°ntas veces compras shampoo al mes? (Solo n√∫meros, ejemplo: 1, 2, 3, etc.)",
        Sulfatos = "¬øUtilizas un shampoo con sulfatos?",
        Sal =  "¬øUtilizas shampoo con sal?",
        Cruelfre = "¬øUtilizas shampoo cruelty free (libre de crueldad animal)?",
        Precio = "¬øCu√°l es el precio que pagas por un shampoo, frecuentemente? (En soles y solo utilice n√∫meros exactos, ejemplo: 15, 20, 30, etc.)",  
        ProduC = "¬øQu√© productos utilizas para el cabello?",
        SiliC = "¬øUtilizas productos para el cabello con siliconas?",
        HerraC = "¬øQu√© herramientas de calor utilizas para el cabello?",
        Qcompra = "¬øQui√©n compra el shampoo que utilizas?",
        Marca = "¬øCu√°l es tu marca de preferencia? (Escr√≠belo todo en min√∫scula, ejemplo: sedal)"
) -> CA
```

Ahora debemos de verificar la cantidad de datos completos e incompletos:
```{r}
sum(is.na(CA)) #cantidad de datos incompletos de DBT
sum(!is.na(CA)) # Los datos completos.
sum(complete.cases(CA)) # Los casos completos de la base de datos.
sum(!complete.cases(CA)) # La cantidad de casos incompletos.
```
Analizando nuestra base de datos nos dimos cuenta que en cinco variables encontramos algunos variables, procederemos a corregirlo:
Primero usaremos unique para observar los errores de cada variable:

```{r}
unique(CA$Marca)
```
```{r}
unique(CA$Edad)
```


```{r}
unique(CA$Tiempo)
```
```{r}
unique(CA$VecesC)
```
```{r}
unique(CA$Precio)
```
Limpieza de la variable Precio:
```{r}
CA %>% mutate(Precio =
              ifelse(Precio == "23 soles", "23",
              ifelse(Precio == "1.5", "15" ,      
              ifelse(Precio ==  "20-30", "25" ,
              ifelse(Precio ==  "5,46", "46" ,
              ifelse(Precio ==  "677", "77",
              ifelse(Precio ==  "0", NA,     
                     Precio
              ))))))) ->CA
CA %>% count(Precio) #Con este comando se visualiza que la variable se ha corregido; tambi√©n se puede utilizar unique(Periodo_Corregido
```


Limpieza de la variable tiempo:

```{r}
unique(CA$Tiempo) #Permite conocer todas las formas que han respondido para la variable periodo
CA %>% mutate(Tiempo = 
        ifelse(Tiempo == "1 hora y media", "90",
        ifelse(Tiempo == "15 min", "15",
        ifelse(Tiempo == "5m", "5",
        ifelse(Tiempo == "1 hora", "60",
        ifelse(Tiempo == "6 minutos", "6",
        ifelse(Tiempo == "2 minutos", "2",
        ifelse(Tiempo == "30 min", "30",
        ifelse(Tiempo == "A", "10",
        ifelse(Tiempo == "2.1", "21",
        ifelse(Tiempo == "3 horas", "180",
        ifelse(Tiempo == "0 horas ,4 minutos , 30 segundos", "4",Tiempo
        )))))))))))) -> CA
CA %>% count(Tiempo) #Con este comando se visualiza que la variable se ha corregido; tambi√©n se puede utilizar unique(Periodo_Corregido) 
```

Limpieza de la variable VecesC:
```{r}
CA %>% mutate(VecesC =
              ifelse(VecesC == "0 -1.001", "1" ,
              ifelse(VecesC == "0.3", "0" ,      
              ifelse(VecesC == "1 ves al mes", "1" ,
              ifelse(VecesC == "q", "1" ,
              ifelse(VecesC ==  "V", "1",
                     VecesC
              ))))))->CA
CA %>% count(VecesC) #Con este comando se visualiza que la variable se ha corregido; tambi√©n se puede utilizar unique(Periodo_Corregido
```

Limpieza de la variable Edad:
```{r}
CA %>% mutate(Edad=
              ifelse(Edad=="float n = 19.999999", "19",
              ifelse(Edad == "diecinueve", "19",
                        Edad
              )))->CA
          
CA %>% count(Edad)
        
```

Limpieza de la variable Marca:

```{r}
unique(CA$Marca) # Verificar las etiquetas de la variable Marca
CA %>% count(Marca) # Contabilizar cu√°ntos han completado teniendo en cuenta las diferentes marcas

CA %>%  mutate(Marca =
      ifelse(Marca %in% c("revlon"),"Revlon",
      ifelse(Marca %in% c("capilatis"),"Capilatis", 
      ifelse(Marca %in% c("savital", "Savitel"),"Savital",
      ifelse(Marca %in% c("P&G"),"Procter & Gamble",
      ifelse(Marca %in% c("head y shoulders","Head and shoulders","head & shoulders","head shoulder","Hs","Hs.","Head&shoulders","h&s","H&S","Head & Shoulders","head&shoulders","Head and Shoulder","Head and shoulder","Hys","H&s","Head n shoulders", "Head n shoulders", "Head and shower üßº","Hys" ,"H&s","H S","HEAD&SHOULDERS","Head and Shoulders","Head &  shoulders", "Head Shoulder","HyS","hys","headandshoulders", "Head and shouders","Gead & shoulders","head shoulders" ,"H.shoulderr","Head&Shoulder","HEAD AND SHOULDERS","Headshoulder" , "hedan shoulder","H & S", "head and shoulders" ,"Hedanshowders","Head ans Shoulder","HS","Hy s","H y S"  ),"Head & Shoulders",
      ifelse(Marca %in% c("Salon in"), "Salon IN", 
      ifelse(Marca %in% c("T√≠o Nacho","Tio nacho","Tionacho","T√≠o nacho","t√≠o nacho","tio nacjo", "tio nacho", "Mi fiel T√≠o Nacho","Tio Nacho"), "T√≠o Nacho",
      ifelse(Marca %in% c("johnson's baby","Johnson's Baby", "Johnsons baby", "Johnson's Baby", "Jhonson‚Äôs baby"), "Johnson's Baby",
      ifelse(Marca %in% c("babaria", "Leo ?", "leo", "leo ", "leo ?"),"Barbaria",
      ifelse(Marca %in% c("baor", "Sagitatio", "Sagitario", "sagitatio"), "Baor",
      ifelse(Marca %in% c("sedal","Sedal, Elvive, Ego", "Sesal","SEDAL", "Sedal, Sabogal" ), "Sedal",
      ifelse(Marca %in% c("Pantene","pantene","Pannosetene"), "Pantene",
      ifelse(Marca %in% c("Kativa","kativa"),"Kativa",
      ifelse(Marca %in% c("elvive","Elvive",  "El vive - Lor√©al Par√≠s","ELVIVE"),"Elvive", 
      ifelse(Marca %in% c("Herbal Essences"),"Herbal Essences",
      ifelse(Marca %in% c("Clear men","Clear Men","Men","Clean"),"Clear Men",
      ifelse(Marca %in% c("Kumir"),"Kumir",
      ifelse(Marca %in% c("Ego","ego" ),"Ego", 
      ifelse(Marca %in% c("ballerina"),"Ballerina",
      ifelse(Marca %in% c("recamier"),"Recamier",
      ifelse(Marca %in% c("L,bel","pantene"), "L'Bel",
      ifelse(Marca %in% c("dove", "Dove"),"Dove",
      ifelse(Marca %in% c("Jhonson & Johnson","Johnson"),"Johnson's", 
      ifelse(Marca %in% c("Homen Natura","Natura", "natura"),"Natura",
      ifelse(Marca %in% c("Vitane"),"Vitane",
      ifelse(Marca %in% c("Medicasp"),"Medicasp",
      ifelse(Marca %in% c("geomen", "GEOMEN"),"Geomen", 
      ifelse(Marca %in% c("garnier fructis","garnier"),"Garnier",       
      ifelse(Marca %in% c("TIGI"),"TIGI",
      ifelse(Marca %in% c("herbal essences"),"Herbal Essences",
      ifelse(Marca %in% c("recamier"),"Recamier",
      ifelse(Marca %in% c("-", "", "No tengo", "Nose", "Ni yo la s√©","No me fijo en uno", "Hm", "ogx", "No","No me acuerdo pero es de un emprendimiento","No tengo preferencias", "No recuerdo el nombre" ,"void","No se","No me acuerdo", "Argan","No s√©", "Cualquiera funciona", "Cualquier shampoo da lo mismo", "a",".","Ukyff","H&m", "Hola","Sebastian" ), NA,
             Marca
             ))))))))))))))))))))))))))))))))) -> CA
CA %>% count(Marca)
```



Tambi√©n observamos que tenemos dos variables con alternativas m√∫ltiples, es por eso que las separaremos con la funci√≥n grep.
Empezamos con la Variable ProduC:
```{r}
CA$Acondicionador <- NA
CA$Mascarilla_para_el_cabello <- NA
CA$Gel <- NA
CA$Crema_para_peinar <- NA
CA$Serum<- NA
CA$otros <- NA
CA$No_utilizo <- NA


CA$Acondicionador[grep("Acondiconador", CA$ProduC)] <- "S√≠"
CA$Mascarilla_para_el_cabello[grep("Mascarilla para el cabello", CA$ProduC)] <- "S√≠"
CA$Gel[grep("Gel", CA$ProduC)] <- "S√≠"
CA$Crema_para_peinar[grep("Crema para peinar", CA$ProduC )] <- "S√≠"
CA$Serum[grep("Serum",CA$ProduC)] <- "S√≠"
CA$otros[grep("otros", CA$ProduC)] <- "S√≠"
CA$No_utilizo[grep("No utilizo", CA$ProduC)] <- "S√≠"

CA$Acondicionador[is.na(CA$Acondicionador)] <- "No"
CA$Mascarilla_para_el_cabello[is.na(CA$Mascarilla_para_el_cabello)] <- "No"
CA$Gel[is.na(CA$Gel)] <- "No"
CA$Crema_para_peinar[is.na(CA$Crema_para_peinar )] <- "No"
CA$Serum[is.na(CA$Serum)] <- "No"
CA$otros[is.na(CA$otros)] <- "No"
CA$No_utilizo[is.na(CA$No_utilizo)] <- "No"

```

```{r include=FALSE}
CA %>% select(Acondicionador)%>% filter(Acondicionador=="S√≠") -> graf_Acondi
CA %>% select(Mascarilla_para_el_cabello)%>% filter(Mascarilla_para_el_cabello=="S√≠") -> graf_Mascarilla
CA %>% select(Gel)%>% filter(Gel=="S√≠") -> graf_Gel
CA %>% select(Crema_para_peinar)%>% filter(Crema_para_peinar=="S√≠") -> graf_Crema
CA %>% select(Serum)%>% filter(Serum=="S√≠") -> graf_Serum
CA %>% select(otros)%>% filter(otros=="S√≠") -> graf_otros
CA %>% select(No_utilizo)%>% filter(No_utilizo=="S√≠") -> graf_No

Productos <-c("Acondiconador", "Mascarilla para el cabello")
for (i in 1:nrow(graf_Acondi)){
  Productos[[length(Productos) + 1]]<-"Acondiconador"}
for (i in 1:nrow(graf_Mascarilla)){
 Productos[[length(Productos) + 1]]<-"Mascarilla para el cabello"}
for (i in 1:nrow(graf_Gel)){
  Productos[[length(Productos) + 1]]<-"Gel"}
for (i in 1:nrow(graf_Crema)){
  Productos[[length(Productos) + 1]]<-"Crema para peinar"}
for (i in 1:nrow(graf_Serum)){
  Productos[[length(Productos) + 1]]<-"Serum"}
for (i in 1:nrow(graf_otros)){
  Productos[[length(Productos) + 1]]<-"otros"}
for (i in 1:nrow(graf_No)){
  Productos[[length(Productos) + 1]]<-"No utilizo"}


Productos <- Productos [-c(1,2)]
Productoslevels <- factor(Productos, levels = c("Acondiconador","Mascarilla para el cabello","Gel",
                                                   "Crema para peinar","Serum","otros","No_utilizo"))

```

Seguimos con la variable HerraC:
```{r}
CA$Plancha <- NA
CA$Secador <- NA
CA$Rizador <- NA
CA$OtrasHerr <- NA
CA$No_utilizoHerr <- NA


CA$Plancha[grep("Plancha", CA$HerraC)] <- "S√≠"
CA$Secador[grep("Secador", CA$HerraC)] <- "S√≠"
CA$Rizador[grep("Rizador", CA$HerraC)] <- "S√≠"
CA$OtrasHerr[grep("Otros", CA$HerraC)] <- "S√≠"
CA$No_utilizoHerr[grep("No utilizo", CA$HerraC)] <- "S√≠"

CA$Plancha[is.na(CA$Plancha)] <- "No"
CA$Secador[is.na(CA$Secador)] <- "No"
CA$Rizador[is.na(CA$Rizador)] <- "No"
CA$OtrasHerr[is.na(CA$OtrasHerr)] <- "No"
CA$No_utilizoHerr[is.na(CA$No_utilizoHerr)] <- "No"

```

```{r include=FALSE}
CA %>% select(Plancha)%>% filter(Plancha=="S√≠") -> graf_Plancha
CA %>% select(Secador)%>% filter(Secador=="S√≠") -> graf_Secador
CA %>% select(Rizador)%>% filter(Rizador=="S√≠") -> graf_Rizador
CA %>% select(OtrasHerr)%>% filter(OtrasHerr=="S√≠") -> graf_OtrasHerr
CA %>% select(No_utilizoHerr)%>% filter(No_utilizoHerr=="S√≠") -> graf_NoHerr

Herramientas <-c("Plancha", "Secador")
for (i in 1:nrow(graf_Plancha)){
  Herramientas[[length(Herramientas) + 1]]<-"Plancha"}
for (i in 1:nrow(graf_Secador)){
 Herramientas[[length(Herramientas) + 1]]<-"Secador"}
for (i in 1:nrow(graf_Rizador)){
  Herramientas[[length(Herramientas) + 1]]<-"Rizador"}
for (i in 1:nrow(graf_OtrasHerr)){
  Herramientas[[length(Herramientas) + 1]]<-"OtrasHerr"}
for (i in 1:nrow(graf_NoHerr)){
  Herramientas[[length(Herramientas) + 1]]<-"No_utilizoHerr"}


Herramientas <- Herramientas [-c(1,2)]
Herramientaslevels <- factor(Herramientas, levels = c("Plancha","Secador","Rizador",
                                                "OtrasHerr","No_utilizoHerr"))

```
Observamos con la funci√≥n str que R no reconoce a estas varibles como num√©ricas, entonces usamos la funci√≥n as.numeric para convertirlas en num√©ricas:
```{r}
str(CA)
```


```{r}
CA$Edad<-as.numeric(CA$Edad)
```
```{r}
CA$Precio<-as.numeric(CA$Precio)
```
```{r}
CA$VecesC<-as.numeric(CA$VecesC)
```
```{r}
CA$Tiempo<-as.numeric(CA$Tiempo)
```

## **5. Descriptores num√©ricos**

```{r}
summary(CA$Edad)
```








Cantidad de personas respecto al nivel de temperatura a lo que prefieren lavar su cabello.
Se presenta mayor preferencia por el lavado de cabello con agua tibia. Sin embargo, es interesante se√±alar que m√°s personas prefieren el agua fr√≠a que el agua caliente.




### Tablas de doble entrada:




Se eval√∫a la preferencia del g√©nero masculino y femenino respecto a la temperatura con la que se lavan el cabello.
Se puede visualizar que la mayoria de estudiantes masculinos encuestados prefieren lavarse el cabello con agua fr√≠a. Por otro lado, las estudiantes femeninas encuestadas, prefieren lavarse el cabello con agua tibia.

```{r}
table(CA$Temperatura,CA$Genero)
```




### Tabla desagregada (tres variables)

Se eval√∫a el nivel de temperatura a la que se lavan el cabello y la cantidad de veces que realizan dicha acci√≥n respecto al g√©nero estudiantes de UTEC.
Los estudiantes masculinos que se lavan el cabello con agua caliente, en su mayoria prefieren lavarse el cabello diariamente.
La mayoria de estudiantes pertenecientes al g√©nero femenino se lavan el cabello interdiariamente con agua tibia, al igual que la mayoria de estudiantes masculinos con la diferencia de que prefieren hacerlo con agua fr√≠a.

```{r}
table(CA$Genero,CA$LavaC,CA$Temperatura)
```


## **6. Descriptores gr√°ficos** 



##### Tabla de g√©nero

```{r}
tablaGenero<-CA %>% count(Genero)
tablaGenero<-tablaGenero %>% mutate(fr=round(n/(length(CA$`Nombres y Apellidos`)),4))
tablaGenero<-tablaGenero%>% mutate(fp=100*tablaGenero$fr)
tablaGenero

```

##### Gr√°fico circular de g√©nero

```{r}

library(readr)
library(dplyr)
library(modeest)
library(RColorBrewer)
library(stringr)
library(ggplot2)

```




_Observaci√≥n_

Se obtuvo mayor cantidad de respuestas por parte de estudiantes del g√©nero masculino

#### Edad:

Se raliza una representaci√≥n gr√°fica sobre las edades que poseen los estudiantes de UTEC que fueron encuestados y forman parte de nuestra muestra.


```{r}
barplot(table(CA$Edad), main = "Edades de alumnos que participaron en la encuesta", ylab = "Estudiantes", xlab = "Edad", col="lightblue",ylim = c(0,80),space = 0,cex.names = 0.8)

```
_Observaciones_

* En nuestra muestra se presenta mayor cantidad de personas de 18 y 19 a√±os de edad.
* Se presenta mayor n√∫mero de respuestas del g√©nero masculino.


##### Tabla de escala

```{r}
tablaEscala<-CA %>% count(Escala)
tablaEscala<-tablaEscala %>% mutate(fr=round(n/(length(CA$`Nombres y Apellidos`)),30))
tablaEscala<-tablaEscala%>% mutate(fp=100*tablaEscala$fr)
tablaEscala

```

##### Gr√°fico circular de escala





```{r}
library(ggplot2)
library(ggthemes)
library(scales)
library(dplyr)
```







### Caracter√≠sticas del cabello





```{r}
mosaicplot(CA$Longitud~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Longitud",
           xlab="Longitud",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```
_Observaciones_

* **G√©nero vs. Longitud**:Los estudiantes utecsinos del g√©nero masculino suelen lucir un cabello corto. Por otro lado, las estudiantes utecsinas suelen llevar el cabello super largo.



```{r}
mosaicplot(CA$Tipo~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Tipo de cabello",
           xlab="Tipo",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```


#### Tabla desagregadas (tres variables)
Se eval√∫a la cantidad de shampoo utilizado y el tiempo de secado del cabello respecto a la longitud del mismo. La mayoria de estudiantes que se demoran en secar su cabello en 15 minutos, tienen una cabellera mediana para la cual suelen aplicar 3 mL de shampoo al momento de ducharse.
```{r}
table(CA$Genero,CA$LavaC,CA$Temperatura)
```


Se eval√∫a el nivel de temperatura a la que se lavan el cabello y la cantidad de veces que realizan dicha acci√≥n respecto al g√©nero estudiantes de UTEC. Los estudiantes masculinos que se lavan el cabello con agua caliente, en su mayoria prefieren lavarse el cabello diariamente. La mayoria de estudiantes pertenecientes al g√©nero femenino se lavan el cabello interdiariamente con agua tibia, al igual que la mayoria de estudiantes masculinos con la diferencia de que prefieren hacerlo con agua fr√≠a.



```{r, echo=FALSE}
pos <- within(CA, Marca <- factor(Marca,levels=names(sort(table(Marca), decreasing=F))))

p <- ggplot(pos, aes(x = Marca)) + geom_text(aes(label = ..count..), stat= "count", hjust = -0.1, size = 3.3) +  geom_bar( width = 0.7,col="#104E8B")
p + coord_flip() + ylab("Cantidad de estudiantes") + xlab("Marca de shampoo")+ ggtitle("Cantidad de estudiantes respecto a la marca de shampoo")
```
_Observaciones_
* El shampoo con mayor demanda por parte de los utecsinos es Head & Shoulders.





```{r}
barplot(table(CA$Precio), main = "Precio de Shampoo", ylab = "Frecuencia", xlab = "Precio", col="lightblue",ylim = c(0,80),space = 0,cex.names = 0.8)
```





```{r}
attach(CA)
names(CA)
```



```{r}
plot(Ciclo ~ Precio, main="Diagrama de Dispersi√≥n y correlaci√≥n entre las variables Precio y Ciclo",
     xlab="Precio", ylab="Ciclo")
# Para crear una l√≠nea de regresi√≥n
abline(lm(Ciclo ~ Precio))
```


```{r}
pairs(~Ciclo + Precio + Edad)
```




```{r}
library(psych)
```


```{r}

pairs.panels(CA[c(2,4,16)])
```




```{r}
plot(Edad ~ Precio, main="Diagrama de Dispersi√≥n y correlaci√≥n entre las variables Precio y Ciclo",
     xlab="Precio", ylab="Ciclo")
# Para crear una l√≠nea de regresi√≥n
abline(lm(Edad ~ Precio))
```




```{r}
plot(MiliS ~ Precio, main="Diagrama de Dispersi√≥n y correlaci√≥n entre las variables Precio y Ciclo",
     xlab="Precio", ylab="Ciclo")
# Para crear una l√≠nea de regresi√≥n
abline(lm(MiliS ~ Precio))
```


```{r}
mosaicplot(CA$Temperatura~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Temperatura",
           xlab="Temperatura",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```




```{r}
mosaicplot(CA$SiliC~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Temperatura",
           xlab="Temperatura",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```



```{r}
mosaicplot(CA$Sal~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Temperatura",
           xlab="Temperatura",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```



```{r}
mosaicplot(CA$Sulfatos~CA$Genero,col=c("firebrick","deepskyblue4"),
           main="Gr√°fico de mosaico: G√©nero vs. Temperatura",
           xlab="Temperatura",
           ylab="G√©nero",
           cex.axis=0.5,
           las=1)
```




```{r}
boxplot(CA$Edad, main="Edades de alumnos que participaron en la encuesta",col="lightblue",horizontal = T)
```












#### Diagramas de dispersi√≥n:


**Para las variables Edad y Precio**

Primero para tener una posible idea de la relaci√≥n debemos de realizar el siguiente gr√°fico de dispersi√≥n:

En primera instancia observamos que no hay una correlaci√≥n
```{r}
plot(CA$Edad,CA$Precio)
```
Efectivamente para verificar que la estimaci√≥n sea adecuada, el coeficiente de determinaci√≥n debe ser mayor que 65% y en este caso est√° por debajo de esta cifra y nos damos cuenta de esto ya que el R cuadrado es de 5.174e-06.

```{r echo=FALSE}
boxplot(CA$Precio)
```

```{r echo=FALSE}
boxplot(CA$Edad)
```




```{r}
summary(lm(CA$Precio~CA$Edad))
```
Tambi√©n observamos que no existe coeficiente de correlaci√≥n: 
```{r}
cor(CA$Edad, CA$Precio)
```


**Para las variables VecesC y Precio**
Primero para tener una posible idea de la relaci√≥n debemos de realizar el siguiente gr√°fico de dispersi√≥n
Observamos que al parecer no existe una relaci√≥n:

```{r}
plot(CA$VecesC,CA$Precio)
```
Efectivamente para verificar que mi estimaci√≥n sea adecuada, el coeficiente de determinaci√≥n debe ser mayor que 65% y en este caso est√° por debajo de esta cifra y nos damos cuenta de esto ya que el R cuadrado es de 0.006385.

```{r echo=FALSE}
boxplot(CA$VecesC)
```


```{r}
summary(lm(CA$Precio~CA$VecesC))
```
Tambi√©n observamos que no existe coeficiente de correlaci√≥n: 
```{r}
cor(CA$VecesC, CA$Precio)
```

### Escala vs precio del shampoo


```{r echo=FALSE}
ggplot(CA, aes(x = as.factor(Escala), y = Precio)) +
  geom_boxplot(colour="black") +
  xlab("Escala") +
  ylab("Precio del shampoo")
```


```{r echo=FALSE}
ggplot(CA, aes(x = as.factor(Qcompra), y = Precio)) +
  geom_boxplot(colour="black") +
  xlab("Persona encargada de comprar el shampo que el estudiante utiliza") +
  ylab("Precio del shampoo")
```



```{r echo=FALSE}
ggplot(CA, aes(x = as.factor(LavaC), y = Precio)) +
  geom_boxplot(colour="black") +
  xlab("Persona encargada de comprar el shampo que el estudiante utiliza") +
  ylab("Precio del shampoo")
```

```{r}
summary(lm(CA$Precio~CA$Escala))
```







```{r}
library(gridExtra)
```





```{r}
boxplot(CA$Precio, main="Precio de Shampoo",col="lightblue",horizontal = T)
```

```{r}
summary(CA$Precio)
```


#### Productos




```{r}
CA$Precio<-as.numeric(CA$Precio)
CA$Edad<-as.numeric(CA$Edad)
```



```{r}
str(CA)
```


```{r}
CA%>%count(Acondicionador)
CA%>%count(Mascarilla_para_el_cabello)
CA%>%count(Gel)
CA%>%count(Crema_para_peinar)
CA%>%count(Serum)
CA%>%count(otros)
```



```{r}
library(tidyverse)
library(scales)
```



```{r}
CA_acondicionador<- CA%>% count(Acondicionador)%>%
  mutate(prop=n/sum(n))

acondi_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Acondicionador)%>%
  mutate(prop=n/sum(n))

ggplot(acondi_genero,aes(Acondicionador,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Acondicionador",
       y="Estudiantes",
       title = "Acondicionador,Estudiantes",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```



```{r}
CA_masc<- CA%>% count(Mascarilla_para_el_cabello)%>%
  mutate(prop=n/sum(n))

masc_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Mascarilla_para_el_cabello)%>%
  mutate(prop=n/sum(n))

ggplot(masc_genero,aes(Mascarilla_para_el_cabello,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Mascarilla para el cabello",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan mascarilla para el cabello",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```



```{r}
CA_gel<- CA%>% count(Gel)%>%
  mutate(prop=n/sum(n))

gel_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Gel)%>%
  mutate(prop=n/sum(n))

ggplot(gel_genero,aes(Gel,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Gel",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan gel para el cabello",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```




```{r}
CA_crema<- CA%>% count(Crema_para_peinar)%>%
  mutate(prop=n/sum(n))

crema_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Crema_para_peinar)%>%
  mutate(prop=n/sum(n))

ggplot(crema_genero,aes(Crema_para_peinar,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Crema para peinar",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan crema para peinar",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```

```{r}
CA%>%count(Sal)
CA%>%count(SiliC)
CA%>%count(Sulfatos)
CA%>%count(Cruelfre)
```


```{r}
CA_sal<- CA%>% count(Sal)%>%
  mutate(prop=n/sum(n))

sal_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Sal)%>%
  mutate(prop=n/sum(n))

ggplot(sal_genero,aes(Sal,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Productos con sal",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan productos con salcrema para peinar",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()
```

```{r}
CA_sulf<- CA%>% count(Sulfatos)%>%
  mutate(prop=n/sum(n))

sulf_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Sulfatos)%>%
  mutate(prop=n/sum(n))

ggplot(sulf_genero,aes(Sulfatos,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Productos con sulfatos",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan productos con sulfatos",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()
```





```{r}
CA_silic<- CA%>% count(SiliC)%>%
  mutate(prop=n/sum(n))

silic_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(SiliC)%>%
  mutate(prop=n/sum(n))

ggplot(silic_genero,aes(SiliC,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Productos con siliconas",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que utilizan productos con siliconas",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()
```




```{r}
CA_cruel<- CA%>% count(Cruelfre)%>%
  mutate(prop=n/sum(n))

cruel_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Cruelfre)%>%
  mutate(prop=n/sum(n))

ggplot(cruel_genero,aes(Cruelfre,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Productos con siliconas",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que utilizan productos Cruelty free",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()
```







```{r}
str(CA)
```




```{r}
CA%>%count(Cruelfre)
```

```{r}
CA%>%count(Carrera)
```


```{r}
CA_Cruelfre<- CA%>% count(Cruelfre)%>%
  mutate(prop=n/sum(n))

cruel_carrera<-CA%>%
  filter(Carrera!="No especificado")%>%
  group_by(Carrera)%>%
  count(Cruelfre)%>%
  mutate(prop=n/sum(n))

ggplot(cruel_carrera,aes(Cruelfre,n,fill=Carrera))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Cruelty free",
       y="N√∫mero de estudiantes",
       title = "N√∫mero de estudiantes por carrera que ulitizan productos cruelty free",
       fill="Carrera")+
  theme_classic()+
  coord_flip()

```

Se puede observar que un mayor n√∫mero de estudiantes de la carrera de Ing. Ambiental y Bioingenier√≠a utilizan productos cruelty free





```{r}
plot(as.factor(CA$Cruelfre), main = "Figura #. Cantidad de estudiantes que utilizan productos Crueltyfree", col="lightblue")
```






```{r}
CA%>%count(Plancha)
CA%>%count(Secador)
CA%>%count(Rizador)
CA%>%count(OtrasHerr)
CA%>%count(No_utilizoHerr)
```





```{r}
CA_plancha<- CA%>% count(Plancha)%>%
  mutate(prop=n/sum(n))

plancha_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Plancha)%>%
  mutate(prop=n/sum(n))

ggplot(plancha_genero,aes(Plancha,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Plancha",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan plancha para el cabello",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```




```{r}
CA_NoUtilHerr<- CA%>% count(No_utilizoHerr)%>%
  mutate(prop=n/sum(n))

NoUtilHerr_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(No_utilizoHerr)%>%
  mutate(prop=n/sum(n))

ggplot(NoUtilHerr_genero,aes(No_utilizoHerr,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="No utilizo herramientas de calor",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que NO ultizan herramientas de calor para el cabello",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```


```{r}
CA_secador<- CA%>% count(Secador)%>%
  mutate(prop=n/sum(n))

secador_genero<-CA%>%
  filter(Genero!="No especificado")%>%
  group_by(Genero)%>%
  count(Secador)%>%
  mutate(prop=n/sum(n))

ggplot(secador_genero,aes(Secador,n,fill=Genero))+
  geom_bar(stat="identity",position="dodge")+
  labs(x="Sacador",
       y="Estudiantes",
       title = "N√∫mero de estudiantes por g√©nero que ultizan gel para el cabello",
       fill="G√©nero")+
  theme_classic()+
  coord_flip()

```



## **7. An√°lisis probabil√≠stico**


```{r}
plot(as.factor(CA$Serum), main = "Serum", col="lightblue")
```

```{r}
SerumTable <- table(as.factor(CA$Serum))
ProbSerum <- SerumTable/nrow(CA)
ProbSerum
```

Probabilidad aproximada de que los estudiantes utilicen serum: 0.06
Probabilidad aproximada de que los estudiantes NO utilicen serum: 0.94


Si se selecciona una muestra de 30 estudiantes al azar
¬øCu√°l es la probabilidad de que 12 de los estudiantes seleccionados utilice serum?

```{r}
dbinom(12,30,0.06)
```


```{r}
plot(as.factor(CA$Acondicionador), main = "Acondicionador", col="lightblue")
```

```{r}
AcondiTable <- table(as.factor(CA$Acondicionador))
ProbAcondi <- AcondiTable/nrow(CA)
ProbAcondi
```

Probabilidad aproximada de que los estudiantes utilicen acondicionador: 0.54
Probabilidad aproximada de que los estudiantes NO utilicen acondicionador: 0.45


Si se selecciona una muestra de 10 estudiantes al azar
¬øCu√°l es la probabilidad de que 4 de los estudiantes seleccionados utilice acondiconador?

```{r}
dbinom(4,10,0.54)
```



```{r}
plot(as.factor(CA$Mascarilla_para_el_cabello), main = "Mascarilla para el cabello", col="lightblue")
```

```{r}
MascTable <- table(as.factor(CA$Mascarilla_para_el_cabello))
ProbMasc <- MascTable/nrow(CA)
ProbMasc
```

Probabilidad aproximada de que los estudiantes utilicen acondicionador: 0.54
Probabilidad aproximada de que los estudiantes NO utilicen acondicionador: 0.45


Si se selecciona una muestra de 10 estudiantes al azar
¬øCu√°l es la probabilidad de que 4 de los estudiantes seleccionados utilice acondiconador?

```{r}
dbinom(4,10,0.54)
```

## **8. Modelos probabil√≠sticos**







##Descriptores num√©ricos








```{r}

library(DescTools)
library(raster)
```

**Medidas de tendencia central:**

Para la variable Precio:
```{r}
mean(CA$Precio)
median(CA$Precio)
Mode(CA$Precio)
```

Para la variable Milis:
```{r}
mean(CA$MiliS)
median(CA$MiliS)
Mode(CA$MiliS)
```

Para la variable Precio y G√©nero:
```{r}
tapply(CA$Precio,CA$Genero,mean)
tapply(CA$Precio,CA$Genero,median)
tapply(CA$Precio,CA$Genero,Mode)
```

Para la variable Tipo y VecesC:
```{r}
tapply(CA$VecesC,CA$Tipo,mean)
tapply(CA$VecesC,CA$Tipo,median)
tapply(CA$VecesC,CA$Tipo,Mode)
```

Utilizando la funci√≥n de la moda "mfv" podemos saber que la mayor√≠a de los estudiantes encuestados prefieren la marca Head & Shoulders y para ser m√°s espec√≠ficos, el g√©nero femenino prefiere usar Sedal y el g√©nero masculino prefiere usar  Head & Shoulders: 


Ahora podemos observar que en una vista general los estudiantes prefieren lavarse el cabello con agua tibia, pero de forma espec√≠fica el g√©nero femenino prefiere lavarse con agua Tibia y el g√©nero masculino prefiere lavarse con agua fr√≠a:
```{r}
mfv(CA$Temperatura)
table(CA$Temperatura,CA$Genero)
```

**Medidas de tendencia no central:**
```{r}
summary(CA$Precio)
```
```{r}
summary(CA$Tiempo)
```



**Distribuci√≥n normal**



```{r}
r <- function(x){
  return(round(x,2))
}
```

##### Funci√≥n de descriptores num√©ricos

```{r}
descpNumericos<-function(datosD,alfa=0.05){
  media_=r(mean(datosD))
  mediana_=r(median(datosD))
  desEst_=r(sd(datosD))
  var_=r(desEst_^2)
  
  m1<-r( media_ - (qt(1-alfa/2,length(datosD)-1)*(desEst_/sqrt(length(datosD)))))
  m2<-r( media_ + (qt(1-alfa/2,length(datosD)-1)*(desEst_/sqrt(length(datosD)))))

  v1 <- r(((length(datosD)-1)*(desEst_^2))/qchisq(1-alfa/2,(length(datosD)-1)))
  v2 <- r(((length(datosD)-1)*(desEst_^2))/qchisq(alfa/2,(length(datosD)-1)))
  
  d1 <- r(sqrt(((length(datosD)-1)*(desEst_^2))/qchisq(1-alfa/2,(length(datosD)-1))))
  d2 <- r(sqrt(((length(datosD)-1)*(desEst_^2))/qchisq(alfa/2,(length(datosD)-1))))
  
  
  print(paste("Promedio: ",media_))
  print(paste("Intervalo de confianza del promedio: [ ",m1," : ",m2," ]"))
  
  print(paste("desviaci√≥n estandar: ",desEst_))
  print(paste("Intervalo de confianza de la desviaci√≥n estandar: [ ",d1," : ",d2," ]"))
  
  print(paste("Varianza: ",var_))
  print(paste("Intervalo de confianza de la varianza: [ ",v1," : ",v2," ]"))
  
  print(paste("Mediana: ",mediana_))
  
  summary(datosD)
  
  
}

```


```{r echo=FALSE}
n_datos=length(CA$Precio)
n_prec=length(CA$Precio[CA$Precio==3])
set.seed(n_datos)

Precio_DistBinom<-rbinom(n=n_datos,size=100,prob=n_prec/n_datos)


hist(Precio_DistBinom,breaks = "Sturges", freq = F,col = c("cadetblue","bisque3","skyblue3","indianred","lightpink3","lightslategrey"))
lines(density(Precio_DistBinom), col = "red", lty = 2, lwd = 3)

```


```{r}

```





DENSIDAD
```{r}
library(ggplot2)
```


```{r}
densi_precio <- ggplot(data=CA)+
  aes(x=Precio)+
  geom_density()

densi_precio +
  labs(title="Gr√°fico de densidad",
       x="Acondicionador",
       y= "Precio")+
  theme(plot.title = element_text(hjust=0.5),
        plot.subtitle = element_text(hjust=0.5),
        plot.caption = element_text(hjust=0.5))
```


```{r}
densi_mili <- ggplot(data=CA)+
  aes(x=MiliS)+
  geom_density()

densi_mili +
  labs(title="Gr√°fico de densidad para los mililitros",
       x="Mililitros",
       y= "Probabilidad")+
  theme(plot.title = element_text(hjust=0.5),
        plot.subtitle = element_text(hjust=0.5),
        plot.caption = element_text(hjust=0.5))
```
La probabilidad de que los estudiantes utecsinos utilicen 3 mL de shampoo es

```{r}
dbinom(3,257,0.31)
```



```{r}
densi_edad <- ggplot(data=CA)+
  aes(x=Edad)+
  geom_density()

densi_edad +
  labs(title="Gr√°fico de densidad para la edad",
       x="Edad",
       y= "Probabilidad")+
  theme(plot.title = element_text(hjust=0.5),
        plot.subtitle = element_text(hjust=0.5),
        plot.caption = element_text(hjust=0.5))
```






La probabilidad de que un los estudiantes utecsinos de entre 18 y 20 a√±os sean entrevistados es 

```{r}
pbinom(20, 257, 0.225) - pbinom(18, 257, 0.225)
```




```{r}
densi_tiempo <- ggplot(data=CA)+
  aes(x=Tiempo)+
  geom_density()

densi_tiempo +
  labs(title="Gr√°fico de densidad",
       x="Edad",
       y= "Probabilidad")+
  theme(plot.title = element_text(hjust=0.5),
        plot.subtitle = element_text(hjust=0.5),
        plot.caption = element_text(hjust=0.5))
```




## **9. Conclusiones y Recomendaciones**



El cabello es parte importante de nuestra presentaci√≥n. Para mantenerlo en buen estado se necesitan productos adicionales con el fin de revitalizarlo y lucir un cabello saludable. Se ha podido evidenciar en este trabajo que los estudiantes no solo utilizan shampoo en el cuidado de su cabellera, como es el caso del acondicionador. Seguidamente, se ha podido determinar si ellos emplean herramientas de calor sobre el cabello. En adici√≥n a ello, se hall√≥ una correlaci√≥n entre variables como precio del shampoo y el n√∫mero de veces que se lava el cabello .Finalmente, se realiz√≥ unos an√°lisis probabil√≠sticos con la finalidad de estimar el nivel de predictibilidad de las variables escogidas respecto a los estudiantes de UTEC del ciclo 2022-2.


#### *Recomendaciones*


- Se recomienda trabajar con una muestra m√°s grande, de manera tan que se pueda obtener una muestra representativa. Almenos se deber√≠a recolectar un 60 % de la poblaci√≥n utecsina para determinar si existe un posible nicho de negocio de productos de cuidado del cabello.

- Debido a que el estudio fue un estudio con datos obtenidos por conveniencia, para futuras investigaciones con un alto grado de confiabilidad, se procurar√≠a realizar un estudio aleatorio.



### **10.Bibliograf√≠a**


_Diferencias entre cabello de hombre y mujer: lo que debes saber_. (s.f.). Garnier. https://www.garnier.com.pe/tips/diferencias-entre-cabello-de-hombre-y-mujer


