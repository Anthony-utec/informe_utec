---
title: ' '
output:
  html_document:
    df_print: paged
---


<b style = 'color : red; font-size : 25px ; font-family : Amasis MT Pro Black'>***Clasificaciones de QS World University***</b>

![](QS.png)

- Obtención de datos públicos  [Aquí](https://www.kaggle.com/divyansh22/qs-world-university-rankings)
- Proveniencia de los datos : **Calificaciones de universidades realizada por Quacquarelli Symmonds**


## I. Título del proyecto

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>**Comparación y análisis de la calidad internacional de universidades**</b>

- Título corto: <b style = 'color : darkblue; font-size : 20px ; font-family : Amasis MT Pro Black'>**Calidad universitaria**</b>

## II. Introducción
 
### 2.1 Importancia

En primer lugar, esta investigación resulta de vital importancia para los estudiantes que están decidiendo dónde estudiar, puesto que suelen desear entrar a las mejores universidades. Para decidir cuáles son estas, suelen  basarse en su renombre en lugar de considerar muchos otros factores tales como la locación, la reputación de los profesores, entre otros factores importantes que se verán en las variables de la presente investigación. 

En segundo lugar, esta investigación podría llegar a servir a los trabajadores profesionales que presentan dudas acerca de qué casa universitaria es la adecuada para desarrollar tanto su pregrado como su posgrado. Este estudio funcionará a modo de referencia y respaldo para una mejor elección en ambos casos (estudiantes y profesionales), con una data internacional que nos permita a su vez  distinguir qué país/ continente ofrece mejor calidad en educación universitaria, ya que hay muchas personas interesadas en estudiar en el extranjero.

Por último, este estudio será importante para las mismas universidades, puesto que pueden llegar a comprender los factores que le brindan la calidad a una universidad, de tal modo que puedan mejorar en esos aspectos a futuro.

<div align="center">
  <img src="Universidades mundial.jpg" width="30%">
</div>

### 2.2 Factibilidad

Es factible puesto que al contar con un Data Frame extenso y con variables abundantes y variadas, aseguramos la posibilidad de establecer diversas relaciones entre estas a fin de ofrecer información relevante para el público objetivo. Asimismo, la fuente de la base de datos es reconocida en este ámbito, por lo cual la investigación puede llegar a ser confiable y representativa.

<div align="center">
  <img src="factible.jpg" width="35%">
</div>

### 2.3 Justificación

- Es <b style = 'color : blue '>***interesante*** </b> porque se podrá distinguir que país/ continente ofrece mejor educación universitaria de calidad, ya que hay muchas personas interesadas en estudiar en el extranjero.
- Es <b style = 'color : blue '>***factible*** </b> porque la información de la data está elaborada por una empresa de renombre y confianza mundial, la Quacquarelli Symmonds.
- Es <b style = 'color : blue '>***específico*** </b> porque nos centramos en una parte única del sector aprendizaje: el área de estudios superiores en universidades.
- Es <b style = 'color : blue '>***desconocido*** </b> porque existen muchos rankings de las mejores universidades, pero muy pocos o nada en cuanto a la educación universitaria por países y o continentes.


## III. Objetivos

### 3.1 Objetivo general:

Alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.

### 3.2 Objetivo específicos: 
* Analizar que variables se relacionan de mejor manera y más directamente a la calidad de enseñanza de una universidad.

* Analizar si las variables relacionadas a la investigación y a la apreciación internacional interactúan de manera directa con la antigüedad de las casas de estudio.

### 3.3. Preguntas de investigación

|           Preguntas        |            Hipótesis        |   Variables Clave  | 
|:---------------------------|:---------------------------:|:------------------:|
|¿Se relacionan de manera directa la cantidad de alumnos y el nivel de educación de la universidad?| Una universidad que llega a tener una gran cantidad de alumnado se puede calificar como popular y de trayectoria, entonces consideramos que el nivel de educación que posee es alto. | Clasificación de Tamaño / Puntaje de Reputación Académica |
|¿Se encuentran aglomeradas en zonas específicas del globo las mejores universidades a nivel mundial? | Las mejores universidades del mundo se encuentran en lugares de alto desarrollo económico. Entre las principales podemos mencionar a países angloparlantes y países europeos. | Puntaje General / Continente |
| ¿Cuál es el nivel de diferencia entre universidades en la calificación general según la cantidad de años que llevan en funciones? | Las universidades con mayor tiempo en funcionamiento tienen una mayor experiencia y desarrollo académico en general | Puntaje General / Tiempo de Funcionamiento |
|¿Producen más conocimiento las universidades con recorrido o universidades relativamente nuevas? ¿En cuánto difieren a este nivel? | Las universidades con una mayor antigüedad tendrán un mejor desempeño tanto cuantitativo como cualitativo al momento de producir conocimiento, esto en base a su experiencia y trayectoria. | Tiempo de Funcionamiento / Puntaje de Citas por Facultad |
| ¿Cuál es el país que produce más trabajos de investigación? ¿Qué continentes tienen una mejor calificación a nivel de información/ investigación generada? | Los países angloparlantes y europeos tienden a concentrar gran parte de la producción bibliográfica del mundo. | País / Puntaje de Citas por Facultad |
|¿Dónde se encuentran las universidades con mayor apreciación de estudiantes internacionales? | Las universidades de los países angloparlantes y europeos son las más atractivas para estudiantes del extranjero. | País / Puntaje de la Proporción de Estudiantes Extranjeros |
| ¿De qué parte del mundo son las universidades con una mayor apreciación de la empresa o corporación en la que laboran sus estudiantes? | Las universidades angloparlantes y europeas son las más solicitadas y generan gran expectativa en empresas alrededor del mundo al momento de contratar trabajadores. | País / Puntaje de Reputación del Empleador |
|¿Las universidades que se encuentran en el tope de la lista tienen un alto rango de estudiantes/ profesores extranjeros? | Las universidades con mayor cantidad de estudiantes y profesores extranjeros suelen ser las de mayor prestigio mundial. | Puntaje Total/ Puntaje de la Proporción de Estudiantes/Profesores Extranjeros |


## IV. Planificación

Para organizar la realización del proyecto del curso de Estadística y Probabilidades se elaboró un diagrama de Gantt, de tal manera que, gráficamente, se pueda apreciar las actividades planeadas y el tiempo que se dedicará a su elaboración. Se utilizó la aplicación Canva.com para la elaboración del diagrama:

<div align="center">
  <img src="GANTT.png" width="70%">
</div>

## V. Marco Teórico

### 5.1. Población 

La población del estudio se encuentra compuesta por más de 25 000 universidades o instituciones de educación superior alrededor del mundo.

### 5.2. Muestra:
Universidades del top 1024 del ranking "QS University 2020"

### 5.3. Unidad muestral:
Universidad del top 1024 del ranking "QS University 2020"

### 5.4. Muestreo:

Nuestra muestra es no aleatoria: esta es elegida de una de las más importantes y prestigiosas clasificaciones a lo largo del mundo: “QS World University Ranking 2020”. Esta clasificación está compuesta por más de mil universidades a lo largo del mundo. Además, esta base de datos se complementa con otra en la plataforma Kaggle, con la cual se amplió la cantidad de variables disponibles para el estudio.

El tipo de muestreo es discrecional: mediante este método, se aplica una técnica parecida a la del muestreo por conveniencia, pues el investigador recluta a los sujetos según sus criterios, pero en este caso los busca de acuerdo a lo que piensa que estos sujetos puedan aportar a la investigación.

La metodología seguida por la empresa encargada de la recopilación de datos (Quacquarelli Symonds) es la siguiente: se compone de 6 variables cuantitativas diferentes, cada una con el respectivo puesto o ranking que poseen las universidades por cada competencia. Estas variables y su porcentaje de aporte a la calificación final por universidad son las siguientes:

* Reputación académica (40 %)

* Reputación del empleador (10 %)

* Proporción de profesores/ estudiantes (20 %)

* Citas por facultad (20 %)

* Proporción de estudiantes internacionales/ profesores internacionales (5 % cada uno)


En base a estos seis parámetros y sus ponderaciones, como se mencionó antes, se obtiene la calificación final del centro de estudio (la cual indica la posición en la lista general).

Además, contamos con las variables adicionales que nos ayudan a establecer relaciones:

* País

* Clasificación de Tamaño

* Intensidad de la Investigación

* Tiempo de Funcionamiento 

* Rango de Clasificación

### 5.5. Clasificación de Variables

#### A) Variables Categóricas

|         Descripción         |        Variable        | Tipo de Variable | Restricciones |
|:---------------------------|:------------------:|:------------------:|:------------------:|
| Clasificación (según QS) de la universidad en el año 2020 |	Puesto en 2020	| Categórica Ordinal	| Un entero positivo |
| Clasificación (según QS) de la universidad en el año 2019 |	Puesto en 2019 | Categórica ordinal	| Un entero positivo |
|Nombre de la Universidad |	Nombre	|Categórica Nominal|	Universidad existente|
|País|	País	| Categórica Nominal |	País|
| Cantidad de Alumnos |Clasificación de Tamaño	| Categórica Ordinal	| XL (> 30 000), L (>12 000), M (>5 000), S (>1 000)|
| - |Clasificación de Enfoque| Categórica Ordinal	| CO, FC, FO, SP |
|Cantidad de investigaciones realizadas en la universidad|	Intensidad de Investigación	|Categórica Ordinal| VH (Muy Alto), HI (Alto), MD (Medio), LO (Bajo)|
|Estatus de referencia general (A,B,C) | Clasificación de Estatus | Categórica Ordinal | A, B, C |
| Clasificación a nivel mundial del aspecto académico | Clasificación de Reputación Académica | Categórica Ordinal | Un entero positivo |
| Clasificación a nivel mundial de la calificación del empleador | Clasificación de Reputación del Empleador | Categórica Ordinal | Entero positivo |
|Clasificación a nivel mundial de la proporción profesores - estudiantes | Clasificación de la Proporción Profesores - Estudiantes | Categórica Ordinal | Un entero positivo |
| Clasificación a nivel mundial de las referencias que se hacen a las facultades | Clasificación de Citas por Facultad | Categórica Ordinal | Un entero positivo |
| Clasificación a nivel mundial de la cantidad de profesores internacionales | Clasificación de la proporción de Profesores Internacionales | Categórica Ordinal | Un entero positivo |
| Clasificación a nivel mundial de la cantidad de estudiantes internacionales | Clasificación de la proporción de Estudiantes Internacionales | Categórica Ordinal | Un entero positivo |

#### B) Variables Numéricas

|         Descripción         |        Variable        | Tipo de Variable | Restricciones |
|:---------------------------|:------------------:|:------------------:|:------------------:|
| Cantidad de años en funcionamiento | Tiempo de Funcionamiento |Numérica Discreta | 5 (Histórico > 100 años), 4 (100 años > Medio > 50 años), 3 (50 años > Establecido > 25 años), 2 (25 años > Joven > 10 años), 1 (10 años > Nuevo > 0)|
| Puntuación numérica del 0 al 100 del aspecto académico | Puntaje de Reputación Académica | Numérica Continua | Un real en un rango de 0 a 100 |
| Puntuación numérica del 0 al 100 por parte del empleador | Puntaje de Reputación del Empleador | Numérica Continua | Un real en un rango de 0 a 100 |
| Puntuación numérica del 0 al 100 de la proporción profesores - estudiantes | Puntaje de la Proporción Profesores - Estudiantes | Numérica Continua |  Un real en un rango de 0 a 100 |
| Puntuación numérica del 0 al 100 de las referencias que se hacen a las facultades | Puntaje de Citas por Facultad | Numérica Continua | Un real en un rango de 0 a 100|
| Puntuación numérica del 0 al 100 de la cantidad de profesores internacionales | Puntaje de la proporción de Profesores Internacionales |Numérica Continua | Un real en un rango de 0 a 100  |
| Puntuación numérica del 0 al 100 de la cantidad de estudiantes internacionales | Puntaje de la proporción de Estudiantes Internacionales | Numérica Continua |  Un real en un rango de 0 a 100 |
| Puntaje general a los aspectos generales de la universidad | Puntaje Total | Numérica Continua | Un real en un rango de 0 a 100|

## VI. Proceso para la limpieza de datos

```{r ,  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
i<-ifelse(sapply("readr", require, character.only = TRUE), library(readr), install.packages("readr")&library(readr))

j<-ifelse(sapply("dplyr", require, character.only = TRUE), library(dplyr), install.packages("dplyr")&library(dplyr))

```

**-  Lectura de la data : **
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DF <- read_csv("QSW.csv",na=c("-","N/A",""))
DF <- DF[-1,] #La data tiene variables en 2 filas, así que se reacomodarán
```
**-  Traducción de las variables del idioma original al español latino :**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DF <- DF %>% rename("Ranking en 2020"="Rank in 2020",
                    "Ranking en 2019"="Rank in 2019",
                    "Nombre de la institución"="Institution Name",
                    "País"="Country",
                     "Clasificación de tamaño"="Classification",
                     "Clasificación de enfoque"="...6",
                     "Clasificación de intensidad de investigación"="...7",
                     "Tiempo de funcionamiento"="...8",
                     "Clasificación de estatus"="...9", 
                     "Puntaje de reputación académica"="Academic Reputation",
                     "Clasificación de reputación académica"="...11",
                     "Puntaje de reputación del empleador"="Employer Reputation",
                     "Clasificación de reputación del empleador"="...13",
                     "Puntaje de la proporción profesores - estudiantes"="Faculty Student",
                     "Clasificación de la proporción profesores - estudiantes"="...15",
                     "Puntaje de citas por facultad"="Citations per Faculty",
                     "Clasificación de citas por facultad"="...17",
                     "Puntaje de la proporción de profesores internacionales"="International Faculty",
                     "Clasificación de la proporción de profesores internacionales"="...19",
                     "Puntaje de la proporción de estudiantes internacionales"="International Students",
                     "Clasificación de la proporción de estudiantes internacionales"="...21",
                     "Puntaje general"="Overall Score")

head(DF)
```

**-  Dimensiones de la data bruta(Observaciones y variables)**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat("Cantidad de observaciones: ",nrow(DF))
```
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat("Cantidad de variables: ",ncol(DF))
```

**-  Variables de la data :**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
str(DF)
```
**-  Recodificación del tipo de variable :**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DF$`Tiempo de funcionamiento` <- as.numeric(DF$`Tiempo de funcionamiento`)
DF$`Puntaje de reputación académica` <- as.numeric(DF$`Puntaje de reputación académica`)
DF$`Puntaje de reputación del empleador` <- as.numeric(DF$`Puntaje de reputación del empleador`)
DF$`Puntaje de la proporción profesores - estudiantes` <- as.numeric(DF$`Puntaje de la proporción profesores - estudiantes`)
DF$`Puntaje de citas por facultad` <- as.numeric(DF$`Puntaje de citas por facultad`)
DF$`Puntaje de la proporción de profesores internacionales` <- as.numeric(DF$`Puntaje de la proporción de profesores internacionales`)
DF$`Puntaje de la proporción de estudiantes internacionales` <- as.numeric(DF$`Puntaje de la proporción de estudiantes internacionales`)
DF$`Puntaje general` <- as.numeric(DF$`Puntaje general`)
str(DF)
```

**-  Data extra (países por continente)**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
P<-read_csv("paises-continentes.csv")
```
**-  Indicar el continente al que pertenece cada universidad del estudio :**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DF <- cbind(DF,Continente = "continente")

T2<- filter(P,P$continente=="América") 
America <- c(T2$name)
p <- c(DF$País)

x <- ifelse(p %in% America, "Si","No")
a<- c(which(x=="Si"))

T3<- filter(P,P$continente=="Asia") 
Asia <- c(T3$name)
x2 <- ifelse(p %in% Asia, "Si","No")
b<- c(which(x2=="Si"))

T4<- filter(P,P$continente=="África") 
Africa <- c(T4$name)
x3 <- ifelse(p %in% Africa, "Si","No")
c<- c(which(x3=="Si"))

T5<- filter(P,P$continente=="Europa") 
Europa <- c(T5$name)
x4 <- ifelse(p %in% Europa, "Si","No")
d<- c(which(x4=="Si"))

T6<- filter(P,P$continente=="Antártida") 
Antartida <- c(T6$name)
x5 <- ifelse(p %in% Antartida, "Si","No")
e<- c(which(x5=="Si"))

T7<- filter(P,P$continente=="Australia y Oceanía") 
A <- c(T7$name)
x6 <- ifelse(p %in% A, "Si","No")
f<- c(which(x6=="Si"))

x7 <- ifelse(p == "United States", "Si","No")
g<- c(which(x7=="Si"))

x8 <- ifelse(p == "Macau", "Si","No")
h<- c(which(x8=="Si"))

#DN<-replace(DN$Continente,2,'blueberry')
DF[a,23]<-"América"
DF[b,23]<-"Asia"
DF[c,23]<- "África"
DF[d,23]<-"Europa"
DF[e,23]<-"Antártida"
DF[f,23]<-"Australia y Oceanía"
DF[g,23]<-"América"
DF[h,23]<-"Asia"
unique(DF$Continente)
```

**Limpieza de la data :**

- Resumen de la data:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
summary(DF)
```

Se puede apreciar que :

1. Todos los datos para las variables numéricas están dentro de las restricciones, por lo que no constituyen un problema para realizar el análisis de la base de datos.

2. La cantidad de datos incompletos por variable oscila entre 300 y 524.
<br>
- Cantidad de datos incompletos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DF))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DatosIncompletos <- sum(is.na(DF))
DatosTotales <- nrow(DF)*ncol(DF)

#Porcentaje de datos incompletos:
cat("Esta cifra puede parecer grande; sin embargo, es un ",round(DatosIncompletos/DatosTotales*100,2),"% del total de datos")
```

- Casos completos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(complete.cases(DF))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
CasosCompletos <- sum(complete.cases(DF))
CasosTotales <- nrow(DF)

#Porcentaje de casos completos:
cat("Esto sería el ",round(CasosCompletos/CasosTotales*100,2),"% del total de observaciones, menos de la mitad.")
```


- Antes de limpiar la data tomaremos las primeras 500 observaciones, y contaremos la cantidad de NA's que tiene:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Q1<-head(DF,500)
sum(is.na(Q1))
```

- Ahora tomaremos las últimos 500 observaciones, y contaremos la cantidad de NA's que tiene:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Q2<-tail(DF,500)
sum(is.na(Q2))
```
Decimos entonces que la mayor cantidad de NA's se encuentran en las 500 últimas observaciones, ahora probaremos con una cantidad más pequeña:

- Ahora tomaremos las últimas 100 observaciones, y contaremos la cantidad de NA's que tiene:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Q3<-tail(DF,100)
sum(is.na(Q3))
```
Las últimas 100 observaciones albergan más de 1000 datos incompletos, lo que sería aproximadamente unas 10 variables sin completar para cada una, lo cual es un poco más del 45 % del total de variables.

Sin embargo, el equipo ha decidido trabajar con la data en su **totalidad**, pues considera que toda la información en ella es necesaria para el análisis, ya que si bien ciertas observaciones tienen datos incompletos, los datos que si están presentes son importantes para el estudio.


## VII. Descriptores gráficos y numéricos
<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Clasificación de tamaño vs Puntaje de reputación académica"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4, 10))
boxplot(DF$`Puntaje de reputación académica`~ DF$`Clasificación de tamaño`, col = colorRampPalette(c('white','aquamarine4'))(4), main = "Relación entre tamaño y reputación de las universidades", xlab ="Clasificación de tamaño", ylab= "Puntaje de reputación académica")


name <- paste(c("L : 12 mil a 30 mil estudiantes", "M : 5 mil a 12 mil estudiantes","S : mil a 5 mil estudiantes ","XL : Más de 30 mil estudiantes"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('white','aquamarine4'))(4), xpd = TRUE,inset = c(-0.45, 0))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Para clasificación  L
#Mediana:
DataL <-filter(DF,`Clasificación de tamaño`=="L")
m1<-median(DataL$`Puntaje de reputación académica`,na.rm=T)
#Media:
M1<-mean(DataL$`Puntaje de reputación académica`,na.rm=T)

#Para clasificación  M
#Mediana:
DataM <-filter(DF,`Clasificación de tamaño`=="M")
m2<-median(DataM$`Puntaje de reputación académica`,na.rm=T)
#Media:
M2<-mean(DataM$`Puntaje de reputación académica`,na.rm=T)

#Para clasificación  S
#Mediana:
DataS <-filter(DF,`Clasificación de tamaño`=="S")
m3<-median(DataS$`Puntaje de reputación académica`,na.rm=T)
#Media:
M3<-mean(DataS$`Puntaje de reputación académica`,na.rm=T)

#Para clasificación  XL
#Mediana:
DataXL <-filter(DF,`Clasificación de tamaño`=="XL")
m4<-median(DataXL$`Puntaje de reputación académica`,na.rm=T)
#Media:
M4<-mean(DataXL$`Puntaje de reputación académica`,na.rm=T)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Descriptores <- DF%>%group_by(`Clasificación de tamaño`)%>%summarise()

medianas <- c(m1,m2,m3,m4)
medias <- round(c(M1,M2,M3,M4),2)

Descriptores<-cbind(Descriptores,Mediana=medianas,Media=medias)
Descriptores
```

- De la gráfica inferimos que existe una relación directamente proporcional entre la cantidad de alumnos y el puntaje de reputación académica que tiene una universidad. 

Esto podría ser una primera mirada a una de nuestras preguntas de investigación: ¿Se relacionan de manera directa la cantidad de alumnos y el nivel de educación de la universidad?

- Sin embargo, existen casos atípicos en la clasificación M y S, en las que se logra alcanzar e incluso sobrepasar a los puntajes obtenidos de las universidades de mayor clasificación de tamaño.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Reputación académica vs Puntaje total"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

plot( DF$`Puntaje general`~DF$`Puntaje de reputación académica`, col="aquamarine3",pch=19, main = "Relación entre puntaje de reputación academica y puntaje total",  ylab = "Puntaje total" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(DF$`Puntaje general`~DF$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=3, lty=c(1), col("aquamarine3"))

corr<- cor( DF$`Puntaje de reputación académica`, DF$`Puntaje general`,use="na.or.complete")
text(paste("Correlación:", round(corr,3)), x=15, y= 80)

#lm(formula = DF$`Puntaje general` ~ DF$`Puntaje de reputación académica`)
text(paste("Ecuación:0.631x + 18.488"), x=19, y= 70)
```

- De la gráfica podemos interpretar, por la distribución de los puntos, existe una tendencia directamente proporcional entre el puntaje de reputación académica y el puntaje total. Esta relación puede ser modelada linealmente, lo cual se puede demostrar con el coeficiente de correlación de Pearson, el cual es aproximadamente 0.9 (cercano a 1).

- La tendencia se ve acentuada en el rango más bajo de puntuación, y también(aunque en menor proporción) en el rango más alto.

- A pesar de lo mencionado anteriormente, existen puntos de la gráfica que no siguen la regla general(mencionada en el primer punto). Por lo que podemos inferir que no siempre un alto puntaje de reputación académica otorga un alto puntaje final, y viceversa.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Puntaje general y Tiempo de funcionamiento"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4, 8))
boxplot(DF$`Puntaje general`~ DF$`Tiempo de funcionamiento` , ylab = "Puntaje general ", xlab = "Tiempo de funcionamiento", col =colorRampPalette(c('white','aquamarine4'))(5),main="Puntaje general vs Tiempo de funcionamiento")
name <- paste(c("1 : De 0 a 10 años", "2 : De 10 a 25 años","3 : De 25 a 50 años","4 : De 50 a 100 años","5 : De 100 años a más"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('white','aquamarine4'))(5), xpd = TRUE,inset = c(-0.335, 0))
```

Se sigue una tendencia ascendente desde la escala 2 a 5, exceptuando a los de escala 1.
Además en la escala 1, la mediana se encuentra muy alejada del tercer cuartil, por lo que podemos decir que sus datos están dispersos.

Sin embargo, a simple vista, no se puede observar la diferencia de medianas de la escala 3 y 4:

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Mediana 1:
Data1 <-filter(DF,`Tiempo de funcionamiento`==1)
d1<-median(Data1$`Puntaje general`,na.rm=T)
#Mediana 2:
Data2 <-filter(DF,`Tiempo de funcionamiento`==2)
d2<-median(Data2$`Puntaje general`,na.rm=T)
#Mediana 3:
Data3 <-filter(DF,`Tiempo de funcionamiento`==3)
d3<-median(Data3$`Puntaje general`,na.rm=T)
#Mediana 4:
Data4 <-filter(DF,`Tiempo de funcionamiento`==4)
d4<-median(Data4$`Puntaje general`,na.rm=T)
#Mediana 5:
Data5 <-filter(DF,`Tiempo de funcionamiento`==5)
d5<-median(Data5$`Puntaje general`,na.rm=T)

#Coeficiente de variación de la clasificación a escala de 1 al 5 respectivamente:

c1<-sd(Data1$`Puntaje general`,na.rm=T)/mean(Data1$`Puntaje general`,na.rm=T)
c2<-sd(Data2$`Puntaje general`,na.rm=T)/mean(Data2$`Puntaje general`,na.rm=T)
c3<-sd(Data3$`Puntaje general`,na.rm=T)/mean(Data3$`Puntaje general`,na.rm=T)
c4<-sd(Data4$`Puntaje general`,na.rm=T)/mean(Data4$`Puntaje general`,na.rm=T)
c5<-sd(Data5$`Puntaje general`,na.rm=T)/mean(Data5$`Puntaje general`,na.rm=T)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Descriptores2 <- DF%>%group_by(`Tiempo de funcionamiento`)%>%summarise()

medianas2 <- c(d1,d2,d3,d4,d5)
desviacion<- round(c(c1,c2,c3,c4,c5),2)

Descriptores2<-Descriptores2[1:5,]
Descriptores2<-cbind(Descriptores2,Mediana=medianas2,"Coeficiente de variación"=desviacion)
Descriptores2
```

La dispersión en casi todas las clasificaciones de tiempo es regular(ni alta ni baja), a excepción de la clasificación 2, que tiene una dispersión baja.

Deducimos entonces, que no necesariamente las universidades relativamente nuevas(de 0 a 10 años), alcancen puntajes bajos, y que las universidades históricas(más de 100 años) no siempre tienen un puntaje alto en el ranking, puesto que en la gráfica se puede ver, que el mínimo de todos es prácticamente igual. 

A pesar de esto los máximos conseguidos efectivamente se encuentra en su mayoría en el rango histórico(más de 100 años), aunque cómo en toda tendencia estadística, suelen haber datos atípicos como en la escala 3 y 4.


<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Intensidad de investigación y tamaño de las universidades"***</b>
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(1, 1, 2,7))
mosaicplot(DF$`Clasificación de intensidad de investigación`~DF$`Clasificación de tamaño`,col=colorRampPalette(c('white','aquamarine4'))(4), main="Intensidad de investigación vs tamaño de las universidades")
name <- paste(c("VH : Muy alta","HI : Alta","MD : Media ", "LO : Baja"))
legend(x ="topright",legend = name , cex = 0.7, fill = 1, xpd = TRUE,inset = c(-0.24, 0.65))
name <- paste(c("L : 12 mil a 30 mil estudiantes", "M : 5 mil a 12 mil estudiantes","S : mil a 5 mil estudiantes ","XL : Más de 30 mil estudiantes"))
legend(x ="bottomright",legend = name , cex = 0.7, fill = colorRampPalette(c('white','aquamarine4'))(4), xpd = TRUE,inset = c(-0.24, 0))
```

Podríamos pensar que a más cantidad de estudiantes, y por ende más profesionales enseñando por facultad, la intensidad de investigación también sería mayor.

Sin embargo, el gráfico nos muestra todo lo contrario, de primera vista podemos ver que las universidades de clasificación "L" (12 mil a 30 mil estudiantes) es la que tiene más alta intensidad de investigación, desplazando a la de clasificación  "XL" (más de 30 mil estudiantes). Esto podría deberse a que no es siempre la investigación es considerada como el área más importante para los ideales de una universidad tamaño XL, estas podrían ver sus intereses reflejadas en áreas como la puntuación efectuada a partir de la composición extranjera y la proporción entre profesores y estudiantes que existe dentro de la comunidad educativa. Esto es inferido debido a que estas áreas tienen mejor valuación a vista general, como se observó en el análisis por histogramas, respecto a otras variables numéricas.

Cabe recalcar que, según la gráfica para las universidades que albergan mas estudiantes, la investigación es un descriptor relevante en las universidades de gran calidad, ya que la casi nula intensidad de investigación baja (LO) se repite en cada una de las categoría de tamaño.

Para finalizar, siendo evidente en todas las universidades de nuestra muestra, se deja claro que la investigación es relevante debido a que intensidad de aparición de la clasificación VH (muy alta)  es arrasadora.


## VIII. Figuras de mérito

### Variables Categóricas

#### 1) Distribución de observaciones por continente
**Cantidad de observaciones por cada continente**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table("Continente"=DF$Continente)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
bar<-barplot(table("Continente"=DF$Continente),col=c(1,"#32CD32","#FFFF66","#00BFFF","#FF6347"),xlab="Continentes",ylab="Frecuencia",ylim=c(0,450),yaxp=c(0,400,8),las=1)
text(bar,table("Continente"=DF$Continente)+ 15 ,labels=table("Continente"=DF$Continente))
#abline(h = v, col="black", lwd=1, lty=1)
grid(nx = NA,ny=NULL, lwd = 1, lty = 2, col = "gray")
barplot(table("Continente"=DF$Continente),col=c(1,"#32CD32","#FFFF66","#00BFFF","#FF6347"),xlab="Continentes",ylab="Frecuencia",main="Universidades del estudio, por continente",yaxp=c(0,400,8),las=1,add=TRUE)
```

#### 2) Distribución de observaciones por países
**Cantidad de observaciones efectivas para esta variable (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$País))
```

**Cantidad de observaciones con dato faltante en la variable "País"**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DF$País))
```


Las universidades dentro de la muestra pertenecen a diversos países a lo largo del mundo. Para contabilizar la cantidad de universidades existente por país, se generará un dataframe `DPaíses` que contendrá las incidencias de cada país en la muestra:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DF1<-DF

DPaises<-DF1 %>% group_by(País) %>% summarise(Cantidad=n())
DPaises
```
Se observa que existen 82 países distintos en la muestra. Para hacer la cantidad por país más relevante (y evitar aglomeraciones en un gráfica), filtraremos a los países con más de 10 incidencias en nuestra data.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DPaises<-filter(DPaises,DPaises$Cantidad>10)
DPaises<-arrange(DPaises,DPaises$Cantidad)
DPaises
```
Observamos que luego del filtrado tenemos a 22 países que cuentan con más de 10 incidencias en la muestra. Ahora, ya obteniendo estos datos, elaboraremos una gráfica de barras distribuida en países y continentes. 

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
america<-"#32CD32"
asia<-"#FFFF66"
europa<-"#FF6347"
oceania<-"#00BFFF"

coloresPorContinente=c(america,america,america,america,europa,europa,asia,america,asia,asia,europa,america,europa,asia,europa,oceania,europa,asia,asia,europa,europa,america)

nombres=c("Chile","Colombia","Argentina","Mexico","Países Bajos","Polonia","Taiwan","Brasil","Malasia","India","Rusia","Canadá","España","Corea del Sur","Francia","Australia","Italia","Japón","China","Alemania","Reino Unido","Estados Unidos")
```


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1.4,cex.axis=0.6,cex.main=0.8,mar = c(2, 5, 3, 3),cex.lab=0.8)

barplot(DPaises$Cantidad,names.arg=nombres,horiz=1,las=1,cex.names=0.5,col=coloresPorContinente,main="Cantidad de universidades por país\nPaíses con al menos 10 incidencias",border = rgb(0,0,0,0.4))
legend(x="bottomright", title="Continentes",inset=c(0,0.05),legend=c("América","Asia","Europa","Oceanía"),fill=c("#32CD32","#FFFF66","#FF6347","#00BFFF"), horiz=TRUE, cex=0.6)
```

A partir de esta gráfica, vemos que el país de más incidencias es **Estados Unidos** con cerca de 140 universidades top en su territorio, seguido por **Reino Unido** con cerca de 80. Además, observamos que los continentes con más universidades dentro del ranking son **Europa** (con una distribución entre países más equilibrada) y **América** (concentrándose en EE.UU. la gran parte de estas) 

#### 3) Distribución de observaciones por longevidad
**Cantidad de observaciones efectivas para esta variable (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$`Tiempo de funcionamiento`))
```
En la data, las universidades también tienen una distribución por longevidad compuesta por números enteros que van de 1 (***Nuevo***) a 5 (***Histórico***). Con las frecuencias con la que aparecen cada tipo, se elaboró un gráfico de barras:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

bar2<-barplot(table(DF$`Tiempo de funcionamiento`),main="Universidades según longevidad",xlab="Frecuencia",ylab="Categorías",col=colorRampPalette(c('white','aquamarine4'))(5),border = rgb(0,0,0,0.4),horiz=T)
text(bar2,table(DF$`Tiempo de funcionamiento`)+ 15 ,labels=table(DF$`Tiempo de funcionamiento`))
legend(x="bottomright", title="Niveles",inset = c(0.02, 0.15),legend=c("1 : Nuevo (0  a  10  años)","2 : Joven (10 a  25  años)","3 : Establecido (25 a 100 años)","4 : Maduro (50 a 100 años)","5 : Histórico (Más de 100 años)"), fill=colorRampPalette(c('white','aquamarine4'))(5), horiz=FALSE, cex=0.8)
```
Del gráfico, podemos concluir que las universidades dentro del ranking son en su mayoría *históricas* (más de 100 años) y *maduras* (de 50 a 100 años). Esto es razonable, ya que estas universidades alcanzan un **estatus alto** por su arraigo y experiencia. 

#### 4) Distribución de observaciones por intensidad de investigación
**Cantidad de observaciones efectivas para esta variable (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$`Clasificación de intensidad de investigación`))
```
La *intensidad de investigación* es el grado de importancia que se le da a la **generación** y **distribución** de contenido ***bibliográfico***. En base a este indicador la producción de conocimiento que tiene cada casa de estudio está dividida en 4 niveles.

Para una óptima visualización general de los datos se elaboró una *gráfica de barras* mostrando la *frecuencia* de los 4 niveles que posee esta variable:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
inves<-table(DF$`Clasificación de intensidad de investigación`)
hi<-inves[1]
lo<-inves[2]
md<-inves[3]
vh<-inves[4]

inves[1]<-lo
inves[2]<-md
inves[3]<-hi
inves[4]<-vh

table(DF$`Clasificación de intensidad de investigación`)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
barplot(inves,horiz=1, main="Universidades según intensidad de investigación",xlab="Frecuencia",names.arg=c("LO","MD","HI","VH"), col=colorRampPalette(c('white','aquamarine4'))(4),border = rgb(0,0,0,0.4),xlim=c(0,700),las=1)

legend(x="bottomright", title="Intensidad",inset = c(0.02, 0.15),legend=c("VH: Muy Alta","HI : Alta","MD: Media","LO: Baja"), fill=colorRampPalette(c('aquamarine4','white'))(4), horiz=FALSE, cex=0.95)
```
Observamos que más de la mitad de las observaciones son clasificadas como ***Intensidad de investigación muy alta***. Esto tiene sentido puesto que siendo universidades del top mundial tienen grandes aportes de conocimiento  *científico mundial*.

Para observar mejor la cantidad que representa la categoría ***Muy Alta***, podemos elaborar una tabla de probabilidades:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
prop.table(table(DF$`Clasificación de intensidad de investigación`))
```
Observamos que la categoría ***Muy Alta (VH)*** abarca más de el 60 % de los datos. Esto confirma nuestra primera observación a partir de la *gráfica de barras*, que daba como predominante a la categoría referida.

#### 5) Distribución de cantidad de estudiantes
**Cantidad de observaciones efectivas para esta variable (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$`Clasificación de tamaño`))
```
Las universidades también son distribuibles en función a la cantidad de estudiantes que poseen. En este caso, se repartirán en 4 categorías: S, M, L y XL. Lo representamos en un *gráfico de barras*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
tamanio<-table(DF$`Clasificación de tamaño`)
L<-tamanio[1]
M<-tamanio[2]
S<-tamanio[3]
XL<-tamanio[4]

tamanio[1]<-S
tamanio[2]<-M
tamanio[3]<-L
tamanio[4]<-XL

table(DF$`Clasificación de tamaño`)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
barplot(tamanio,horiz=1, main="Universidades según cantidad de estudiantes",xlab="Frecuencia",names.arg=c("S","M","L","XL"),col=colorRampPalette(c('white','aquamarine4'))(4),xlim=c(0,500),border = rgb(0,0,0,0.4),las=1)

legend(x="bottomright", title="Tamaño",inset = c(0, 0.1),legend=c("Extra Grande (XL): más de 30 000","Grande (L):más de 12 000","Mediano (M):más de 5000","Pequeño (S):más de 1000"),fill=colorRampPalette(c('aquamarine4','white'))(4), horiz=FALSE, cex=0.85)
```

Es evidente que la mayoría de universidades (cerca de 500) están dentro de la categoría ***Grande (L)***. Sin embargo, las categorías ***Extra Grande (XL)*** y ***Mediano (M)*** son parte significativa también.

Al igual que la variable anterior, podemos ver de mejor manera la distribución con una *tabla de probabilidades*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
round(prop.table(table(DF$`Clasificación de tamaño`)),2)
```

#### 6) Descripción del estatus de la muestra
**Cantidad de observaciones efectivas para esta variable (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$`Clasificación de estatus`))
```
El estatus mide el nivel que posee una universidad. Para analizarlo, usaremos también un *gráfico de barras*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
barplot(table(DF$`Clasificación de estatus`),main="Universidades según estatus", xlab="Frecuencia",las=1,horiz = 1,xlim=c(0,800),col=colorRampPalette(c('aquamarine4','white'))(3),border = rgb(0,0,0,0.4))
legend(x="topright", title="Estatus",inset = c(0, 0.1),legend=c("A: Excelente","B: Buena","C: Regular"),fill=colorRampPalette(c('aquamarine4','white'))(3), horiz=FALSE, cex=0.85)
```

Se observa que la ***Categoría A*** es abrumadora, con poco más de 800 de las observaciones. Por otro lado, vemos que la presencia de la ***Categoría C*** es ínfima.

Podemos observar el número que representa ***C*** y compararla con la cantidad de observaciones efectivas para esta variable, si así lo queremos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table(DF$`Clasificación de estatus`)
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(table(DF$`Clasificación de estatus`))
```


El número tan bajo de incidencias de la ***Categoría C*** en comparación al total es razonable: *estamos hablando de un ranking de alto nivel, con las mejores universidades del mundo*.

### Variables Numéricas
#### 1) Descripción de la composición extranjera:
**Cantidad de observaciones efectivas para Puntuación por composición de Profesores Extranjeros (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de la proporción de profesores internacionales`))
```
**Cantidad de observaciones efectivas para Puntuación por composición de Estudiantes Extranjeros (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de la proporción de estudiantes internacionales`))
```
Analizando las variables relacionadas a la *composición extranjera* de la muestra, `Puntaje de la proporción de profesores internacionales` y `Puntaje de la proporción de estudiantes internacionales`, nos podemos dar una idea de la distribución que se tiene. 
**Obs:** 

Según $QS$ (creadora del ranking), en referencia a las variables:

$Composición$ $Extranjera:$

*Una universidad altamente internacional adquiere y confiere una serie de ventajas. Demuestra la capacidad de atraer profesores y estudiantes de todo el mundo, lo que a su vez sugiere que posee una marca internacional sólida.*


El *análisis* se hará mediante un *boxplot comparativo* y dos *histogramas*.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Profesores<- DF$`Puntaje de la proporción de profesores internacionales`
Estudiantes<-DF$`Puntaje de la proporción de estudiantes internacionales`

boxplot(Profesores, Estudiantes, main= "Puntajes por composición extranjera de la casa de estudios", ylab="Puntaje", border = rgb(0,0,0,0.4), names=c("Profesores","Estudiantes"),col = c("aquamarine2","aquamarine4"),ylim=c(0,120))

abline( h=c(mean(Profesores,na.rm = TRUE),mean(Estudiantes,na.rm = TRUE)) ,col=c("red","blue"),lty=2,lwd=2)

legend(x='topright',legend=c("Media Estudiantes","Media Profesores"),lwd=1,col=c("blue", "red"), lty=3, inset = c(0,0),cex=0.85)


hist(Profesores,main="Histograma del Puntaje Por Profesores Extranjeros",ylab="Frecuencia",xlab="Puntaje",col="aquamarine2",border = rgb(0,0,0,0.4),breaks = 50,prob=T)
lines(density(Profesores,na.rm = T),lwd=2,col="black")
abline(v = c(mean(Profesores,na.rm = TRUE), median(Profesores,na.rm=TRUE)), col = c("red", "blue"))
legend(x='topright',legend=c("Media Profesores","Mediana Profesores","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.1,0),cex=0.8)


hist(Estudiantes,main="Histograma del Puntaje Por Estudiantes Extranjeros",ylab="Probabilidad",xlab="Puntaje",col="aquamarine4",border = rgb(0,0,0,0.4),breaks = 50,prob=T)
lines(density(Estudiantes,na.rm = T),lwd=2,col="black")
abline(v = c(mean(Estudiantes,na.rm = TRUE), median(Estudiantes,na.rm=TRUE)), col = c("red", "blue"))
legend(x='topright',legend=c("Media Estudiantes","Mediana Estudiantes","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.1,0),cex=0.8)

```
A partir del *boxplot* podemos ver que el ***rango intercuartil*** de la evaluación de los `Puntos por Profesores Extranjeros` es más amplio que los `Puntos por Estudiantes Extranjeros`, con lo cual podemos concluir que el 50% de las puntuaciones de `Puntos por Profesores Extranjeros` varía más que el 50% de las puntuaciones de los `Puntos por Estudiantes Extranjeros`. Eso sí, ambos tienen variaciones altas, alcanzando un IQR mayor a la mitad del rango total.

Además, en función  a la ***mediana***, podemos decir también que el 50% de `Puntos por Profesores Extranjeros` está mejor ubicado que el 50% de `Puntos por Estudiantes Extranjeros` . Entonces la muestra en general tiene una mejor evaluación a nivel `Puntos por Profesores Extranjeros` en comparación a `Puntos por Estudiantes Extranjeros`.

Por otro lado, como podemos ver en los *histogramas*, por la configuración de la ***mediana-media***  tenemos en ambos una distribución con **sesgo a la derecha** . Sin embargo, esta no es muy pronunciada para ninguno, debido a la concentración de datos en la parte derecha de la gráfica que incrementa cuando nos ubicamos cerca a la puntuación máxima. Esto provoca una distorsión en la ***curva de nivel***, que en lugar de ser un **pico pronunciado en la izquierda** se convierte en **ondas suaves a lo largo del histograma**.

Es lógico tener para ambas variables una concentración importante al encontrarnos en la zona de puntajes más altos (de 98 a 100 según la distribución del *histograma*). Esto se explica analizando el origen de los datos, que son extraídos de un ranking de las universidades de más alto nivel del mundo (por lo cual es lógico que se alcancen altos puntajes).

Podemos ayudarnos a identificar los ***descriptores numéricos*** mencionados mediante una **tabla**:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_prof_estudiantes<-round(c(c(mean(Profesores,na.rm=T),mean(Estudiantes,na.rm=T)),c(median(Profesores,na.rm=T),median(Estudiantes,na.rm=T),c(IQR(Profesores, na.rm=T),IQR(Estudiantes,na.rm=T)))),2)
matrix_prof_estudiantes<-matrix(datos_prof_estudiantes,nrow=3,ncol=2,byrow = T )
rownames(matrix_prof_estudiantes)<-c("Media","Mediana","Rango Intercuartil  ")
colnames(matrix_prof_estudiantes)<-c("Puntuación Profesores Extranjeros","   Puntuación Estudiantes Extranjeros")
matrix_prof_estudiantes

```

#### 2) Descripción del puntaje de Citas por Facultad (Frecuencia de Citado):
**Cantidad de observaciones efectivas para Puntuación por Citas por Facultad (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de citas por facultad`))
```
Analizando la variable `Citas por Facultad` nos podemos dar una idea de la distribución del **top** de universidades en referencia a la intensidad con la que las citan (uso del material bibliográfico generado por la casa de estudios).

Según $QS$ (creadora del ranking), en referencia a la variable:

$Citas$ $por$ $Facultad:$ 

*Para calcularlo, tomamos el número total de citas recibidas por todos los artículos producidos por una institución durante un período de cinco años en proporción al número de miembros de la facultad en esa institución.*


El *análisis* se hará mediante un *boxplot* e *histograma*.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
CitasFacultad<-DF$`Puntaje de citas por facultad`

boxplot(CitasFacultad,main="Puntajes de Citas por Facultad",ylab="Puntaje",col="aquamarine3", border = rgb(0,0,0,0.4))
abline(h=mean(CitasFacultad,na.rm = T),col="red",lwd=2)
legend(x='topright',legend="Media del puntaje",lwd=2,col="red", inset = c(0,0),cex=1)

hist(CitasFacultad,main="Histograma del Puntaje de Citas Por Facultad",ylab="Probabilidad",xlab="Puntaje",col="aquamarine3",breaks=50,border = rgb(0,0,0,0.4),prob=T)
lines(density(CitasFacultad,na.rm=T),lwd=2,col="black")
abline(v =c(mean(CitasFacultad,na.rm = TRUE), median(CitasFacultad,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)

```
A partir del *boxplot*, nos damos cuenta que la distribución es **sesgada a la derecha**, debido a la ubicación de la ***media*** respecto de la ***mediana***. Además, gracias al ***rango intercuartil*** nos damos cuenta que la distribución de la mitad de los datos no está muy dispersa.

Analizando el *histograma*, confirmamos estas observaciones. La ***curva de densidad*** nos muestra una distribución con cola a la derecha o sesgada a la derecha, viéndose afectada mínimamente por la frecuencia que está acumulada en las puntuaciones más altas.

A diferencia de los histogramas anteriores, no se concentra una gran cantidad de datos en los puntajes máximos. Esto nos quiere decir que es más difícil para las universidades del **top** obtener puntajes por sobre 90 en este grupo de datos en comparación a los `Puntajes Por Composición de Profesores Extranjera` y `Puntajes por Composición de Estudiantes Extranjera`.

Al igual que en los datos anteriores, una tabla nos puede ayudar a ubicar mejor los ***descriptores numéricos***:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_CitasFacultad<-round(c(c(mean(CitasFacultad,na.rm=T)),c(median(CitasFacultad,na.rm=T),c(IQR(CitasFacultad, na.rm=T)))),2)
matrix_CitasFacultad<-matrix(datos_CitasFacultad,nrow=1,ncol=3 )
colnames(matrix_CitasFacultad)<-c("   Media","  Mediana","    Rango Intercuartil")
rownames(matrix_CitasFacultad)<-c(" Putuación Citas Por Facultad")
matrix_CitasFacultad
```
#### 3) Descripción de los puntajes de Reputación del empleador y Reputación Académica:
**Cantidad de observaciones efectivas para Puntuación de Reputación Laboral (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de reputación del empleador`))
```
**Cantidad de observaciones efectivas para Puntuación de Reputación Académica (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de reputación académica`))
```

Analizando las variables `Reputación del empleador` y `Reputación Académica` observaremos la distribución de las universidades respecto a los puntajes obtenidos como apreciación de los empleadores (contratantes de los egresados).

Según $QS$ (creadora del ranking), en referencia a las variables:

$Reputación$ $Laboral:$
*Nuestra métrica de Reputación del empleador se basa en más de 75.000 respuestas a nuestra Encuesta de empleadores de QS y solicita a los empleadores que identifiquen las instituciones de las que obtienen los graduados más competentes, innovadores y eficaces. La Encuesta de empleadores de QS también es la más grande del mundo en su tipo.*

Compararemos a la variable anterior con la `Reputación Académica` que posee la muestra.

$Reputación$ $Académica:$
*Basado en nuestra Encuesta Académica , recopila las opiniones de expertos de más de 130.000 personas en el espacio de la educación superior con respecto a la calidad de la enseñanza y la investigación en las universidades del mundo. Al hacerlo, ha crecido hasta convertirse en la encuesta de opinión académica más grande del mundo y, en términos de tamaño y alcance, es un medio incomparable para medir el sentimiento en la comunidad académica.*

El *análisis* se hará efectivo a través de un *boxplot comparativo* e *histogramas*.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
ReputacionLaboral<-DF$`Puntaje de reputación del empleador`
ReputacionAcademica<-DF$`Puntaje de reputación académica`

boxplot(ReputacionLaboral, ReputacionAcademica, main="Puntajes de Reputación Laboral y Reputación Académica",ylab="Puntaje",col=c("aquamarine3","aquamarine4"), border = rgb(0,0,0,0.4),names=c("Reputacion Laboral","Reputacion Académica"))
abline(h=c(mean(ReputacionLaboral,na.rm = T),mean(ReputacionAcademica,na.rm=T)),col=c("red","blue"),lwd=1,lty=2)
legend(x='topright',legend=c("Media de Reputación Laboral","Media de Reputación Académica"),lwd=1,lty=2,col=c("red","blue"), inset = c(0,0),cex=1)


hist(ReputacionLaboral,main="Histograma Puntaje de Reputación Laboral",ylab="Probabilidad",xlab="Puntaje",col="aquamarine2",breaks=50,border = rgb(0,0,0,0.4),prob=T)
lines(density(ReputacionLaboral,na.rm = T),lwd=2,col="black")
abline(v = c(mean(ReputacionLaboral,na.rm = TRUE), median(ReputacionLaboral,na.rm=TRUE)), col = c("red", "blue"),lwd=1)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)

hist(ReputacionAcademica,main="Histograma Puntaje de Reputación Académica",ylab="Probabilidad",xlab="Puntaje",col="aquamarine3",breaks=50, prob=T)
lines(density(ReputacionAcademica,na.rm=T),lwd=2,col="black")
abline(v = c(mean(ReputacionAcademica,na.rm = TRUE), median(ReputacionAcademica,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)


```
Del *boxplot comparativo* observamos *a priori* cajas y bigotes idénticos para ambas variables, lo cual puede sugerir una fuerte relación entre ambas. Por la ubicación de la ***media*** y ***mediana***, podemos describir los conjuntos como sesgados a la derecha. Por otro lado, el ***rango intercuartil*** no es muy amplio, lo cual indica que no existe gran dispersión entre la mitad de datos ubicados alrededor de la ***mediana***.

Viendo el *histograma*, es mucho más notoria la cola hacia la derecha de la distribución. Viendo la ***curva de densidad***, notamos que existe un pico bastante pronunciado hacia la izquierda, agrupando los datos hacia este lado. Esto evidencia la dificultad del grupo de universidades **top** de alcanzar valores altos de puntuación en la evaluación presentada por el *empleador*. 

Facilitamos la lectura de los principales ***descriptores numéricos*** presentados a través de una tabla:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_Rep<-round(c(c(mean(ReputacionLaboral,na.rm=T),mean(ReputacionAcademica,na.rm=T)),c(median(ReputacionLaboral,na.rm=T),median(ReputacionAcademica,na.rm=T),c(IQR(ReputacionLaboral, na.rm=T),IQR(ReputacionAcademica,na.rm=T)))),2)
matrix_Rep<-matrix(datos_Rep,nrow=3,ncol=2,byrow = T )
rownames(matrix_Rep)<-c("Media","Mediana","Rango Intercuartil  ")
colnames(matrix_Rep)<-c(" Puntuación de Reputación Laboral","Puntuación de Reputación Académica")
matrix_Rep
```


A través de esta *tabla*, confirmamos la gran similitud de los ***descriptores numéricos*** para ambos.

#### 4) Descripción del puntaje de la Proporción  Profesores - Estudiantes:
**Cantidad de observaciones efectivas para Puntuación de Proporción Profesores - Estudiantes (de 1024 totales):**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(!is.na(DF$`Puntaje de la proporción profesores - estudiantes`))
```

Analizando la variable `Proporción Profesores - Estudiantes` tendremos un acercamiento a como está evaluado este conjunto respecto a la cantidad de catedráticos disponibles para el conjunto estudiantil.

Según $QS$ (creadora del ranking), en referencia a la variable:

$Proporción$ $Profesores$ $-$ $Estudiantes:$

*Los estudiantes suelen citar la calidad de la enseñanza como la métrica de mayor importancia para ellos cuando comparan instituciones que utilizan una clasificación. Evalúa hasta qué punto las instituciones pueden brindar a los estudiantes un acceso significativo a profesores y tutores, y reconoce que un alto número de miembros de la facultad por estudiante reducirá la carga docente de cada académico individual.*

El *análisis* se hará efectivo a través de un *boxplot* e *histograma*.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
ProfesoresEstudiantes<-DF$`Puntaje de la proporción profesores - estudiantes`

boxplot(ProfesoresEstudiantes,main="Puntajes de Proporción Profesores - Estudiantes",ylab="Puntaje",col="aquamarine3", border = rgb(0,0,0,0.4))
abline(h=mean(ProfesoresEstudiantes,na.rm = T),col="red",lwd=2)
legend(x='topright',legend="Media del puntaje",lwd=2,col="red", inset = c(0,0),cex=1)

hist(ProfesoresEstudiantes,main="Histograma del Puntaje de Proporción Profesores - Estudiantes",ylab="Probabilidad",xlab="Puntaje",col="aquamarine3",breaks=50,prob=T)
lines(density(ProfesoresEstudiantes,na.rm=T),lwd=2,col="black")
abline(v = c(mean(ProfesoresEstudiantes,na.rm = TRUE), median(ProfesoresEstudiantes,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.1,0.1),cex=0.8)


```
En el *boxplot* seguimos viendo la tendencia de una ***media*** superior a la ***mediana***, indicándonos un sesgo a la derecha en el conjunto de datos. Además, la caja abarca cerca de la mitad del rango, por lo que la mitad de los datos está medianamente disperso.

En nuestro *histograma* confirmamos el sesgo a la derecha, obteniendo una acentuación de la ***curva de nivel*** hacia el lado izquierdo. La elevación se ve reducida debido a la acumulación de valores en el lado derecho de la ***curva*** (fenómeno observado y explicado en gráficas anteriores).

Al igual que antes, una tabla de ***descriptores numéricos*** es útil para obtener los valores exactos mencionados:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_Proporcion<-round(c(c(mean(ProfesoresEstudiantes,na.rm=T)),c(median(ProfesoresEstudiantes,na.rm=T),c(IQR(ProfesoresEstudiantes, na.rm=T)))),2)
matrix_Proporcion<-matrix(datos_Proporcion,nrow=3,ncol=1 )
rownames(matrix_Proporcion)<-c("Media","Mediana","Rango Intercuartil  ")
colnames(matrix_Proporcion)<-c(" Puntuación de Proporción Estudiantes - Profesores")
matrix_Proporcion

```


### IX. Comparación de Variables Numéricas:
Para comparar las variables numéricas obtenidas, usaremos en primer lugar un *boxplot comparativo*:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(3,10,2,2),cex.lab=0.8)
boxplot(Profesores,Estudiantes,CitasFacultad,ReputacionLaboral,ProfesoresEstudiantes,ReputacionAcademica,las=1,cex.names=0.5,col=colorRampPalette(c('aquamarine4','white'))(6),main="Comparación de Variables Numéricas",names=c("Profesores Extranjeros","Estudiantes Extranjeros","Citas por Facultad","Reputación Laboral","Proporción Prof. - Estud.","Reputación Académica"), border = rgb(0,0,0,0.4),horizontal=T)
```
Analizaremos los datos que se encuentren sobre el ***3er cuartil*** (el 25 % superior de los datos). En los puntajes de `Profesores Extranjeros` se ve una clara concentración de este grupo entre los valores de 90 a 100 aproximadamente. De forma un poco menos alta (entre los valores de 70 a 100) los valores de `Estudiantes Extranjeros` y `Proporción Profesores - Estudiantes` presentan una tendencia similar. Para estas variables, esto indicaría una tendencia de puntajes altos, saliendo la muestra en general mejor evaluada en estos aspectos.

Además , gracias al ***rango intercuartil*** o ***IQR*** (indicado por el alto de la caja), nos damos cuenta que la variable más dispersa en el 50 % de sus datos es `Profesores Extranjeros` con un rango intercuartílico (*a priori*) de más de 60. Por otro lado, las variables `Citas por Facultad`, `Reputación Académica` y `Reputación Laboral` presentan los rango intercuartílicos más compactos, es decir, con la mitad de sus datos menos dispersos.

Ahora analizaremos los *histogramas* en conjunto:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))
hist(ReputacionAcademica,breaks=25,main="Reputación Académica",xlab="Puntajes",ylab="Frecuencia",col='aquamarine1',prob=T)
lines(density(ReputacionAcademica,na.rm=T),lwd=1.5,col="black")

hist(CitasFacultad,breaks=25,main="Citas por Facultad",xlab="Puntajes",ylab="Frecuencia",col='white',prob=T)
lines(density(CitasFacultad,na.rm=T),lwd=1.5,col="black")

hist(ProfesoresEstudiantes,breaks=25,main="Prop. Profesores - Estudiantes",xlab="Puntajes",col='aquamarine3',prob=T)
lines(density(ProfesoresEstudiantes,na.rm=T),lwd=1.5,col="black")

hist(Estudiantes,breaks=25,main="Estudiantes Extranjeros",xlab="Puntajes",ylab="Frecuencia",col='gray',prob=T)
lines(density(Estudiantes,na.rm=T),lwd=1.5,col="black")

hist(ReputacionLaboral,breaks=25,main="Reputación Laboral",xlab="Puntajes",ylab="Frecuencia",col='aquamarine4',prob=T)
lines(density(ReputacionLaboral,na.rm=T),lwd=1.5,col="black")

hist(Profesores,breaks=25,main="Profesores Extranjeros",xlab="Puntajes",ylab="Frecuencia",col='darkgray',prob=T)
lines(density(Profesores,na.rm=T),lwd=1.5,col="black")

```
Viendo y comparando los histogramas, vemos que nuestras predicciones anteriores son correctas: las variables `Profesores Extranjeros`, `Estudiantes Extranjeros` y `Proporción Profesores - Estudiantes` presentan aglomeraciones al lado derecho de la gráfica obteniendo varios datos con puntuaciones altas.

Observando las otras tres gráficas, nos damos cuenta que `Citas por Facultad`, `Reputación Académica` y `Reputación Laboral` tienen una configuración fuertemente sesgada a la derecha. De esta configuración podemos decir que la muestra en general toma valores más bajos para estas tres categorías (concentrándose la mayoría de valores tomados a la izquierda). Entonces, establecemos que a la muestra en general le resulta más difícil alcanzar altos puntajes en `Citas por Facultad` (cómo se desempeñan en la producción de conocimiento), `Reputación Académica` (cómo son vistos, reconocidos y evaluados por sus pares) y `Reputación Laboral` (cómo son vistos, reconocidos y evaluados por las empresas/compañías que contratan a sus egresados).

Para una mejor apreciación de los ***descriptores numéricos*** en los cuales nos apoyamos para el análisis, presentamos un *cuadro*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (round(c(mean(Valores,na.rm=T),median(Valores,na.rm=T),IQR(Valores,na.rm=T)),2))
}
descriptores<-matrix(c(datos(ReputacionAcademica),datos(ProfesoresEstudiantes),datos(ReputacionLaboral),datos(CitasFacultad),datos(Estudiantes),datos(Profesores)),nrow=6,ncol=3,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Proporción Profesores Estudiantes ","Reputación Laboral ","Citas por Facultad ","Estudiantes Extranjeros ","Profesores Extranjeros ")

colnames(descriptores)<-c("Media","  Mediana","  Rango Intercuartil")
descriptores

```
## X. Relaciones entre variables

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre reputación del empleador y puntaje total"***</b>

En primer lugar, tomaremos las observaciones que presenten un valor diferente a NA en las variables *Puntaje de reputación del empleador* y *Puntaje general* para no presentar inconvenientes al momento de hallar la correlación entre ambas. A lo anterior, lo llamaremos *R1* como se muestra a continuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R1 <- filter(DF,!is.na(`Puntaje de reputación del empleador`), !is.na(`Puntaje general`))
```

Hecho esto, ahora sí podemos seguir trabajando.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
plot( DF$`Puntaje general`~DF$`Puntaje de reputación del empleador`, col="aquamarine3",pch=19, main = "Puntaje de reputación del empleador y puntaje total",  ylab = "Puntaje total" , xlab = "Puntaje de reputación del empleador")
#modelo lineal
abline(lm(DF$`Puntaje general`~DF$`Puntaje de reputación del empleador`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=3, lty=c(1), col("red"))

corr<- cor( R1$`Puntaje de reputación del empleador`, R1$`Puntaje general`)
text(paste("Correlación:", round(corr,3)), x=15, y= 80)

#lm(formula = DF$`Puntaje general` ~ DF$`Puntaje de reputación del empleador`)
text(paste("Ecuación:0.514x + 23.66"), x=19, y= 70)
```

- La gráfica presenta un comportamiento y análisis similar al anterior, pues también existe una tendencia directamente proporcional, por la distribución de los puntos, entre el puntaje de reputación del empleador y el puntaje total. Sin embargo, al ser modelada linealmente, observamos que su coeficiente de correlación de Pearson es aproximadamente 0.8. Aunque sea cercano a 1, es menor a la correlación del gráfico anterior, es así como observamos una mayor dispersión entre la relación de los puntos de esta gráfica.

- La tendencia se ve acentuada en el rango más bajo de puntuación, y también, aunque en menor proporción, en el rango más alto.

- De igual manera que en el anterior gráfico, existen puntos de la gráfica que no siguen una tendencia directamente proporcional. Por lo que inferimos que no siempre un alto puntaje de reputación del empleador otorga un alto puntaje total, y viceversa.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Puntaje general y Clasificación del tamaño"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4, 10))
XL <- DF$`Puntaje general`[DF$`Clasificación de tamaño`=="XL"]
L <- DF$`Puntaje general`[DF$`Clasificación de tamaño`=="L"]
M <- DF$`Puntaje general`[DF$`Clasificación de tamaño`=="M"]
S <- DF$`Puntaje general`[DF$`Clasificación de tamaño`=="S"]
medianas <- c(median(XL), median(L), median(M), median(S))
index <- order(medianas, decreasing = TRUE)
  boxplot(XL,L,S,M, at = index, main = "Clasificación de tamaño y puntaje total", ylab = "Puntaje general ", xlab = "Clasificación de tamaño", col =colorRampPalette(c('aquamarine4','white'))(4), names=c("XL","L","S","M")
)
name <- paste(c("XL : Más de 30 000", "L : Más de 12 000","S : Más de 1 000","M : Más de 5 000"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('aquamarine4','white'))(4), xpd = TRUE,inset = c(-0.45, 0))
```

En la gráfica podemos observar que las medianas se encuentran más cercanas del primer cuartil, por lo que podemos decir que sus datos presentan una notoria dispersión. Además, a simple vista, no se puede observar la diferencia de medianas de la escala "S" y "M".

Para poder tener una mejor visión de esto, tomaremos las observaciones que presenten un valor diferente a NA en las variables *Clasificación de tamaño* y *Puntaje general* para no presentar inconvenientes al momento de hallar la mediana y el coeficiente de variación. A lo anterior llamaremos *R2* como se muestra a continuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R2 <- filter(DF,!is.na(`Clasificación de tamaño`), !is.na(`Puntaje general`))
```

Hecho esto, ahora sí podemos seguir trabajando.


**- Medianas:**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
# Medianas
Data1 <-filter(R2,`Clasificación de tamaño`=="XL")
Data2 <-filter(R2,`Clasificación de tamaño`=="L")
Data3 <-filter(R2,`Clasificación de tamaño`=="S")
Data4 <-filter(R2,`Clasificación de tamaño`=="M")
YYY<-c(median(Data1$`Puntaje general`),
       median(Data2$`Puntaje general`),
       median(Data3$`Puntaje general`),
       median(Data4$`Puntaje general`))

#Coeficiente de variación de la clasificación:**
ZZZ<-c(round((sd(Data1$`Puntaje general`)/mean(Data1$`Puntaje general`)),2),
       round((sd(Data2$`Puntaje general`)/mean(Data2$`Puntaje general`)),2),
       round((sd(Data3$`Puntaje general`)/mean(Data3$`Puntaje general`)),2),
       round((sd(Data4$`Puntaje general`)/mean(Data4$`Puntaje general`)),2))
```


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_Tam<-c(YYY,ZZZ)
matrix_Tam<-matrix(datos_Tam,nrow=4,ncol=2 )
colnames(matrix_Tam)<-c("Mediana","Coeficiente de Variación")
rownames(matrix_Tam)<-c("XL","L","S","M")
matrix_Tam
```


Con los datos anteriores podemos observar que la mediana de S es apenas superior a la mediana de M.

La dispersión de las clasificaciones de tamaño es regularmente alta pues observamos marcadas distancias entre sus cuartiles.

Deducimos entonces, que no necesariamente las universidades con una gran capacidad de personal estudiantil alcanzan puntajes altos, y que las universidades con una menor capacidad estudiantil no siempre tienen puntajes bajos en el ranking, puesto que en la gráfica se puede ver que el mínimo de todos es prácticamente igual. 

Además podemos observar la cantidad de datos atípicos presentes en cada boxplot, esto demuestra que la clasificación del tamaño no influye notoriamente en el puntaje total de la universidad pues una universidad puede tener un puntaje alto pero con una capacidad de tamaño S, así como una universidad con un puntaje bajo no significa que no pueda ser de tamaño XL o L. A pesar de esto los máximos conseguidos efectivamente se encuentra en su mayoría en el rango de tamaño XL.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Puntaje general y Clasificación de estatus"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4, 3.5))
A <- DF$`Puntaje general`[DF$`Clasificación de estatus`=="A"]
B <- DF$`Puntaje general`[DF$`Clasificación de estatus`=="B"]
C <- DF$`Puntaje general`[DF$`Clasificación de estatus`=="C"]
medianas <- c(median(A), median(B), median(C))
index <- order(medianas, decreasing = TRUE)
boxplot(B,A,C, at = index, main = "Clasificación de estatus y puntaje total", ylab = "Puntaje general ", names=c("B","A","C"), xlab = "Clasificación de estatus", col =colorRampPalette(c('aquamarine4','white'))(3))
name <- paste(c("B", "A","C"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('aquamarine4','white'))(3), xpd = TRUE,inset = c(-0.1, 0))
```
En la gráfica podemos observar que las medianas de las escalas de A y B se encuentra más cercanas del primer cuartil, por lo que podemos decir que sus datos presentan una notoria dispersión. Además, a simple vista, se puede observar que las universidades con un estatus C son mínimas, tanto así que apenas el boxplot de la escala C es visible. Esto se debe a que la cantidad de observaciones es mínima, incluso llega a ser de solo 8 observaciones como podemos ver a continuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table(DF$`Clasificación de estatus`)
```

Para poder tener una mejor visión de esto, tomaremos las observaciones que presenten un valor diferente a NA en las variables *Clasificación de estatus* y *Puntaje general* para no presentar inconvenientes al momento de hallar la mediana y el coeficiente de variación. A lo anterior, lo llamaremos *R3* como se muestra a continuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R3 <- filter(DF,!is.na(`Clasificación de estatus`), !is.na(`Puntaje general`))
```

Hecho esto, ahora sí podemos seguir trabajando.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Conteo
Dataa1 <-filter(DF,`Clasificación de estatus`=="A")
Datab1 <-filter(DF,`Clasificación de estatus`=="B")
Datac1 <-filter(DF,`Clasificación de estatus`=="C")

AAA<- c(nrow(Dataa1),nrow(Datab1),nrow(Datac1))
# Medianas:
Dataa <-filter(R3,`Clasificación de estatus`=="A")
Datab <-filter(R3,`Clasificación de estatus`=="B")
Datac <-filter(R3,`Clasificación de estatus`=="C")
BBB<-c(median(Dataa$`Puntaje general`),
       median(Datab$`Puntaje general`),
       median(Datac$`Puntaje general`))

#Coeficientes de variación de la clasificación:

CCC<-c(round(sd(Dataa$`Puntaje general`)/mean(Dataa$`Puntaje general`),2),
       round(sd(Datab$`Puntaje general`)/mean(Datab$`Puntaje general`),2),
       round((sd(Datac$`Puntaje general`)/mean(Datac$`Puntaje general`)),2))
```


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_Esc<-c(AAA,BBB,CCC)
matrix_Esc<-matrix(datos_Esc,nrow=3,ncol=3 )
colnames(matrix_Esc)<-c("Frecuencia","Mediana del puntaje general","Coeficiente de Variación del puntaje general")
rownames(matrix_Esc)<-c("A","B","C")
matrix_Esc
```


La dispersión de las clasificaciones de estatus es regularmente alta pues observamos marcadas distancias entre sus cuartiles. Además vemos que hay mayores universidades con una clasificación de estatus B en comparación con las de estatus A.

Deducimos entonces, que no necesariamente las universidades con un estatus de clasificación A son las que ocupan los valores más altos de puntaje, y que las universidades con una clasificación de estatus B no siempre tienen puntajes bajos en el ranking, puesto que en la gráfica se puede ver que el mínimo de A y B es prácticamente igual. 

Además, podemos observar la cantidad de datos atípicos presentes en el boxplot A, esto demuestra que la clasificación del tamaño influye de cierta manera en el puntaje total de la universidad pues aunque el factor A no sea el de mayor número, presenta una gran cantidad de datos atípicos los cuales ocupan los puntajes más altos. A pesar de esto, los máximos conseguidos se encuentran en su mayoría en el rango de estatus B.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Puntaje general y Clasificación de intensidad de investigación"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4,6))
VH <- DF$`Puntaje general`[DF$`Clasificación de intensidad de investigación`=="VH"]
HI <- DF$`Puntaje general`[DF$`Clasificación de intensidad de investigación`=="HI"]
MD <- DF$`Puntaje general`[DF$`Clasificación de intensidad de investigación`=="MD"]
LO <- DF$`Puntaje general`[DF$`Clasificación de intensidad de investigación`=="LO"]
medianas <- c(median(VH), median(HI), median(MD), median(LO))
index <- order(medianas, decreasing = TRUE)
boxplot(VH, HI, MD, LO, at = index, names=c("VH","HI","MD","LO"), main = "Clasificación de intensidad de investigación y puntaje total", ylab = "Puntaje general ", xlab = "Clasificación de intensidad de investigación", col = colorRampPalette(c('aquamarine4','white'))(4))
name <- paste(c("VH: Muy Alto", "HI: Alto","MD: Medio","LO: Bajo"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('aquamarine4','white'))(4), xpd = TRUE,inset = c(-0.22, 0))
```

En la gráfica podemos observar que las medianas de las escalas se encuentran más cercanas del primer cuartil, por lo que podemos decir que sus datos presentan una notoria dispersión. Además, a simple vista, se puede observar que la mediana de las universidades con una intensidad de investigación MD es cercana al tercer cuartil, tan cercana que apenas se puede diferenciar de la mediana de las universidades con una intensidad de investigación MD. 

Es así como analizaremos cada escala para tener una mayor precisión de los datos obtenidos.

Para poder tener una mejor visión de esto, tomaremos las observaciones que presenten un valor diferente a NA en las variables *Clasificación de intensidad de investigación* y *Puntaje general* para no presentar inconvenientes al momento de hallar la mediana y el coeficiente de variación. A lo anterior llamaremos *R4* como se muestra a continuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R4 <- filter(DF,!is.na(`Clasificación de intensidad de investigación`), !is.na(`Puntaje general`))
```

Hecho esto, ahora sí podemos seguir trabajando.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Medianas
Data1a <-filter(R4,`Clasificación de intensidad de investigación`=="VH")
Data2a <-filter(R4,`Clasificación de intensidad de investigación`=="HI")
Data3a <-filter(R4,`Clasificación de intensidad de investigación`=="MD")
Data4a <-filter(R4,`Clasificación de intensidad de investigación`=="LO")
OOO<-c(median(Data1a$`Puntaje general`),
       median(Data2a$`Puntaje general`),
       median(Data3a$`Puntaje general`),
       median(Data4a$`Puntaje general`))


#Coeficientes de variación de la clasificación:
PPP<-c(round(sd(Data1a$`Puntaje general`)/mean(Data1a$`Puntaje general`),2),
       round(sd(Data2a$`Puntaje general`)/mean(Data2a$`Puntaje general`),2),
       round(sd(Data3a$`Puntaje general`)/mean(Data3a$`Puntaje general`),2),
       round(sd(Data4a$`Puntaje general`)/mean(Data4a$`Puntaje general`),2))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos_Clasi<-c(OOO,PPP)
matrix_Clasi<-matrix(datos_Clasi,nrow=4,ncol=2 )
colnames(matrix_Clasi)<-c("Mediana","Coeficiente de Variación")
rownames(matrix_Clasi)<-c("VH","HI","MD","LO")
matrix_Clasi
```


Con los datos anteriores podemos observar que la mediana de HI es superior por poco a la mediana de MD.

La dispersión de las clasificaciones de estatus es relativamente baja pues no se observan unas distancias marcadas entre sus cuartiles. Aunque vemos que la escala VH presenta una gran dispersión de sus valores y que la escala HI tiene unos cuantos datos atípicos, aunque no se puede comparar con la cantidad de datos de la escala VH

Deducimos entonces, que la clasificación de intensidad de investigación influye directamente en el puntaje general obtenido por las universidades debido a que las universidades con una clasificación VH (Muy Alto) son las que ocupan los valores más altos de puntaje. Asimismo, las universidades con un clasificación diferente a VH tienen puntajes bajos en el ranking, tal como se observa en el gráfico.

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Relación entre Puntaje general y Puntaje de Reputación académica por continentes"***</b>

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
RA <- DF%>%group_by(Continente)%>%summarise("Media de Reputación académica"=round(mean(`Puntaje de reputación académica`,na.rm=T),2),"Media de Puntaje general"=round(mean(`Puntaje general`,na.rm=T),2))
I2<-t(RA[-1])
colnames(I2)<-c(RA$Continente)
I2
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(4, 3, 4, 5))
ye<-barplot(I2,beside=T,col=c("aquamarine3","aquamarine4"),yaxp=c(0,50,10),ylim=c(0,50),las=1,main="Promedio General VS Reputación Académica")
grid(nx = NA,ny=10, lwd = 1, lty = 1, col = "gray")
barplot(I2,beside=T,col=c("aquamarine3","aquamarine4"),yaxp=c(0,50,10),ylim=c(0,50),las=1,add=T)
legend(x ="topright",legend = c("Media de Reputación académica","Media de Puntaje general") , cex = 0.7,fill = c("aquamarine3","aquamarine4"), xpd = TRUE,inset = c(-0.17, -0.08))
```

<b style = 'color : darkblue; font-size : 25px ; font-family : Amasis MT Pro Black'>***"Promedio de puntajes por composición extranjera"***</b>
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
RA2 <- DF%>%group_by(Continente)%>%summarise("Media de proporción de estudiantes internacionales"=round(mean(`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),2),"Media de proporción de profesores internacionales"=round(mean(`Puntaje de la proporción de profesores internacionales`,na.rm=T),2))
I3<-t(RA2[-1])
colnames(I3)<-c(RA$Continente)
I3

```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(4, 3, 4,5))
ye<-barplot(I3,beside=T,col=c("aquamarine3","aquamarine4"),yaxp=c(0,100,10),ylim=c(0,100),las=1,main=" Puntaje de estudiantes internacionales vs profesores internacionales")
grid(nx = NA,ny=10, lwd = 1, lty = 1, col = "gray")
barplot(I3,beside=T,col=c("aquamarine3","aquamarine4"),yaxp=c(0,100,10),ylim=c(0,100),las=1,add=T)
legend(x ="topright",legend = c("Estudiantes","Profesores") , cex = 0.7,fill = c("aquamarine3","aquamarine4"), xpd = TRUE,inset = c(-0.17, -0.08))
```

## XI VARIABLE ALEATORIAS
### Binomial
#### Puntaje general

Cantidad total de datos disponibles
```{r}
DatosDisponibles <- sum(!is.na(DF$`Puntaje general`))
DatosDisponibles
```
Cantidad de universidades estudiadas
```{r}
nrow(DF)
```

Nuestro muestreo es del tipo discrecional, es decir muy similar a un muestreo por conveniencia. Como estamos hablando de un *Ranking de universidades top* podríamos esperar que la mayoría pase un puntaje general, que es el que define su posición en el ranking, de 50 puntos.

**Éxito** --> Puntaje mayor o igual a 50

**Fracaso** --> Puntaje menor a 50

A continuación mostramos la cantidad de universidades que logran igualar o pasar los 50 puntos y las que no lo logran.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
M<-filter(DF,DF$`Puntaje general`>=50)#Puntaje mayor o igual a 50
N<-filter(DF,DF$`Puntaje general`<50)#Puntaje menor a 50

DN2<-merge(M%>%group_by(Continente)%>%summarise("Puntaje igual o mayor a 50"=n()),N%>%group_by(Continente)%>%summarise("Puntaje menor  a 50"=n()),all = TRUE)
DN2[is.na(DN2)]<-0
DN2
```

## En general

Primero veremos la probabilidad de que las universidades, sin importar el continente al que pertenezcan, pasen o igualen los 50 puntos.

**Probabilidad de éxito**

**Éxito** --> Puntaje mayor o igual a 50

```{r}
nrow(M)/DatosDisponibles
```
**Probabilidad de fracaso**

**Fracaso** --> Puntaje menor a 50
```{r}
nrow(N)/DatosDisponibles
```

**Éxito** --> Puntaje mayor o igual a 50

**Fracaso** --> Puntaje menor a 50

La probabilidad de que el 50% de las universidades estudiadas tengan un **puntaje igual o mayor a 50** es:
```{r  }
dbinom(512,1024,0.302)
```

La probabilidad de que al menos el 50% de las universidades estudiadas tengan un **puntaje menor a 50**es:
```{r}
sum(dbinom(c(512:1024),1024,0.698))
```

### Probabilidad condicional
#### Posición en el ranking por continente

**TABLA DE FRECUENCIA**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
A<-which(DF$Continente=="África")
B<-which(DF$Continente=="América")
C<-which(DF$Continente=="Asia")
D<-which(DF$Continente=="Australia y Oceanía")
E<-which(DF$Continente=="Europa")

uno<-c(sum(A<=300),sum(B<=300),sum(C<=300),sum(D<=300),sum(E<=300))
dos<-c(sum(A<=600&A>300),sum(B<=600&B>300),sum(C<=600&C>300),sum(D<=600&D>300),sum(E<=600&E>300))
tres<-c(sum(A<=900&A>600),sum(B<=900&B>600),sum(C<=900&C>600),sum(D<=900&D>600),sum(E<=900&E>600))
cuatro<-c(sum(A>900),sum(B>900),sum(C>900),sum(D>900),sum(E>900))
DN <- DF%>%group_by(Continente)%>%summarise()

DN <- cbind(DN,"Top 300"=uno,"Top[300-600]"=dos,"Top[600-900]"=tres,"TopDown"=cuatro)
I<-t(DN[-1])
colnames(I)<-c(DN$Continente)
I<-rbind(I,Total=colSums(I))
I

```

**TABLA DE PROBABILIDAD**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
IP<-round(prop.table(I[1:4,1:5]),3)
IP<-rbind(IP,Total=colSums(IP))
IP<-cbind(IP,Total=rowSums(IP))
IP
```

En esta tabla podemos observar la distribución de probabilidades de las variables $Continente$ y $Ranking 2020$.Con este recurso podemos aplicar unas cuantas relaciones de probabilidad condicional entre los eventos de las variables:

$P(Top300|África)=\frac{P(Top300∩África)}{P(África)}=\frac{0.001}{0.013}=0.077$


$P(Top300|Europa)=\frac{P(Top300∩Europa)}{P(Europa)}=\frac{0.124}{0.399}=0.311$


$P(TopDown|Europa)=\frac{P(TopDown∩Europa)}{P(Europa)}=\frac{0.055}{0.399}=0.138$


# Creando modelos de variables aleatorias:

## 1) Distribución binomial:

Tenemos la variable `Tiempo de Funcionamiento`, la cual explica la longevidad de las universidades en un rango del 1 al 5.
Para saber la probabilidad que tiene cada categoría en esta variable, crearemos una *tabla de probabilidades*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
round(prop.table(table(DF$`Tiempo de funcionamiento`)),2)
#table(DF$`Tiempo de funcionamiento`)
```
Como estamos hablando de **probabilidades**, estas deberían sumar **1** (o un número bastante aproximado, debido al redondeo):
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(round(prop.table(table(DF$`Tiempo de funcionamiento`)),2))
```
Una vez obtenidas las probabilidades de cada *valor posible* de la **variable**, buscaremos obtener modelos binomiales a partir de estos:

### Primer modelo: *Individual*

#### Usando una categoría abundante:

Dentro de nuestra muestra mundial, tenemos una gran mayoría de universidades de gran longevidad (entre Histórico y Maduro). Sabemos que la probabilidad es de 0.49 para  la categoría **5: Histórico**, siendo esta la más alta entre las categorías de gran longevidad. Si escogemos aleatoriamente 500 universidades de la muestra, que viene a ser aproximadamente el número de apariciones totales de esta categoría en el ranking de Quacquarelly Symonds. ¿Cuál es la probabilidad de que la mitad de la selección sea de categoría **5: Histórico**?

**éxito**: Que sea de categoría **5**

**fracaso**: Que ***no*** sea de categoría **5**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-250
n<-500
p<-0.49  
round(dbinom(x,n,p),3)
```
Entonces, obtenemos una probabilidad de 0.032 de obtener 250 universidades de categoría **5** al escoger 500 al azar. Conseguimos un número significativo debido a la medianamente alta probabilidad con la que aparece esta variable. Si la probabilidad disminuyera, la posibilidad de encontrar grupos numerosos como el anterior podría ser tan escasa que se aproximaría a 0. Buscaremos respaldar esta afirmación a través del próximo experimento.

#### Usando una categoría escasa:
Antes, postulamos que una categoría de baja aparición daría probabilidades bajísimas e incluso nulas de aparecer si se busca en grupos grandes. Entre nuestras categoría de más bajas apariciones tenemos a Nuevo y Joven, con menos del 0.05 de probabilidad de aparición para ambas. Sabemos que la probabilidad es de 0.02 para  la categoría **1: Nuevo**  (que es la más baja entre ambas). Si escogemos aleatoriamente 500 universidades de la muestra (para obtener las mismas condiciones del caso anterior) ¿Cuál es la probabilidad de que la mitad sea de categoría **1: Nuevo**?

**éxito**: Que sea de categoría **1**

**fracaso**: Que ***no*** sea de categoría **1**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-250
n<-500
p<-0.02  
round(dbinom(x,n,p),3)
```
Entonces, obtenemos una probabilidad de 0 de obtener 250 universidades de categoría **1** al escoger 500 al azar. Esto es lógico, ya que su poquísima incidencia la hace improbable de aparecer en conjuntos tan grandes. Con esto confirmamos el análisis inferencial que hicimos en base al experimento anterior.

### Segundo modelo: *En rangos*

#### Usando una categoría abundante:
*Ahora*, establezcamos las probabilidades para un rango de números:

Nuevamente, al ser la categoría de longevidad de más apariciones en nuestra muestra, escogemos a la **5: Histórico** con probabilidad de 0.49 para este primer experimento en rangos. 

Europa es el país con las universidades más antiguas del mundo tanto en cantidad como en longevidad (las más antiguas creadas a inicios del año 1000 d.C. ) y la cantidad de universidades europeas en el ránking es de 408. Entonces si escogemos esta cantidad de universidades al azar ¿cuál es la probabilidad de que *una* sea de categoría **5**, de que *dos* sean de categoría **5**,de que *tres* sean de categoría **5** y así sucesivamente hasta obtener la probabilidad de que las *408* sean de categoría **5**?

**éxito**: Que sea de categoría **5**

**fracaso**: Que ***no*** sea de categoría **5**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(1:408)
n<-408
p<-0.49

barplot(dbinom(x,n,p),ylab="Probabilidad",ylim=c(0,0.05),xlab="Cantidad de éxitos obtenidos del 1 al 408",col="aquamarine 4",names.arg = c(1:408),border="aquamarine 4",main="Función de masa de  probabilidad binomial: Categoría Histórico",cex.names = 0.5)
```
Observamos que al acercarse el número de éxitos al valor resultante de multiplicar la ***probabilidad de la variable*** con el ***total de datos*** ($0.49$ x $408=199.92$) la probabilidad crece hasta alcanzar a un valor aproximado al *0.04*. Esto es debido a que lo que acabamos de encontrar es justamente la esperanza o valor promedio de nuestra variable, es decir el valor o tamaño en que tiene más posibilidades de aparecer.

*Sin embargo*, en los extremos la probabilidad es tan baja que se anula. Esto es debido a que:

1) *Para el* **lado izquierdo**: es improbable encontrar solo 1 ,2 ,3 ,4 u otras cantidades bajas de universidades pertenecientes a la **categoría 5** en un conjunto de datos donde justamente es esta categoría la que abunda.

2) *Para el* **lado derecho**: es improbable encontrar 408, 407, 406, 405 u otras cantidades muy altas de universidades pertenecientes a la **categoría 5**. Esto es debido a que, a pesar de que su probabilidad es medianamente alta, es muy poco probable que esta categoría abarque valores más allá del 60% de los datos (la probabilidad de esta variable no llega ni al 0.5). 

#### Usando una categoría escasa:

Nuevamente, al ser la categoría de longevidad de más escasas apariciones en nuestra muestra, escogemos a la **1: Nuevo** con probabilidad de 0.02 para este primer experimento. 

La universidad más antigua de Australia (continente descubierto por el mundo moderno cerca de 1600) es la Universidad de Sydney que data del año 1850. Esto es relativamente reciente en comparación a otras universidades (en Perú, la más antigua data de 1551 (UNMSM) creada incluso mucho antes del descubrimiento moderno de Australia). Debido a esto, tomaremos como tamaño de muestra la cantidad de apariciones de este continente en el ranking, es decir, 43 universidades.

Sabemos que la probabilidad de 0.02 para  la categoría **1: Nuevo**, si escogemos aleatoriamente 43 universidades de la muestra ¿cuál es la probabilidad de que *una* sea de categoría **2**, de que *dos* sean de categoría **2**,de que *tres* sean de categoría **2** y así sucesivamente hasta obtener la probabilidad de que las *43* sean de categoría **2**?

**éxito**: Que sea de categoría **1**

**fracaso**: Que ***no*** sea de categoría **1**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(1:43)
n<-43
p<-0.02 
round(dbinom(x,n,p),4)
```
Obtenemos los 43 valores requeridos. De manera numérica se ve caótico, pero ¿cómo se verían en una gráfica de barras? 

Se verían *así*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(1:43)
n<-43
p<-0.02
barplot(dbinom(x,n,p),ylab="Probabilidad",ylim=c(0,0.5),xlab="Cantidad de éxitos del 1 al 100",col="Aquamarine 3",names.arg = c(1:43),border="Aquamarine 3",main="Función de masa de  probabilidad binomial: Categoría Nuevo",cex.names = 0.5)
```
Observamos que al acercarse el número de éxitos al valor resultante de multiplicar la ***probabilidad de la variable*** con el ***total de datos*** ($0.02$ x $43= 0.86$ ) la probabilidad crece hasta acercarse a un valor cercano al *0.4*. Esto es debido a que lo que acabamos de encontrar es justamente la esperanza o valor promedio de nuestra variable, es decir el valor o cantidad en que tiene más posibilidades de aparecer.

*Sin embargo*, mientras más nos acercamos al extremo derecho la probabilidad se anula. Esto es debido a que:

1) Es improbable encontrar un número alto de universidades pertenecientes a esta variable, debido a su bajísima probabilidad de aparición.

#### Conclusiones de la observación de *rangos*:
Como conclusión de la observación de ambos casos vemos que las probabilidades se distribuyen *simétricamente* alrededor de la **cantidad de éxitos esperados** para la categoría. Si una categoría es **extrema** (como en el caso de la variable escasa), las barras se apegan al extremo y tienden a ser más altas que las de una variable regular (como el caso de la abundante) debido a que una parte de su distribución se ve restringida por el extremo . Las variables regulares forman una *distribución normal* o *de campana* que se ubica alrededor del valor esperado (esperanza de la variable) y no ven interrumpida su distribución por ninguno de los dos extremos.

## 2) Distribución Geométrica

Ahora usemos la variable `Clasificación de intensidad de investigación`, la cual nos describe la calidad y constancia de la investigación y generación de conocimientos en una universidad. Esta se divide en 4 categorías: Muy Alta (VH), Alta (HI), Media (MD) y Baja (LO).
Igual que antes, creemos una *tabla de probabilidades*:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
round(prop.table(table(DF$`Clasificación de intensidad de investigación`)),2)
```
Confirmemos que estas probabilidades sumen 1:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(round(prop.table(table(DF$`Clasificación de intensidad de investigación`)),1))
```
### Primer modelo: *Individual*
#### Usando una categoría abundante:
Sabemos que el ranking usado es uno compuesto por las mejores universidades a nivel mundial. Por eso no es de extrañar que tengan un gran nivel en cuanto a intensidad de investigación. Además respaldando esto la categoría con más apariciones es **Muy alta(VH)** con más del 60% de universidades clasificadas de esta manera.

Entonces,sabiendo esto, usaremos la variable mencionada. Por otro lado, sabemos que la categoría **Muy Alta (VH)** tiene una probabilidad de 0.65 en la distribución. ¿Cuál es la probabilidad de que la  universidad número 102 (es decir, llegando la 10% de nuestra muestra si estuvieramos haciendo un sondeo manual) seleccionada sea la primera en poseer la clasificación **VH**?

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-101
p<-0.65
round(dgeom(x,p),4)
```
La probabilidad nos resulta nula debido a que es improbable que ninguna de las primeras 101 universidades que se han seleccionado al azar pertenezcan a la categoría **Muy Alta (VH)**. Esto se justifica en base a su numerosa aparición en el ranking.

#### Usando una categoría escasa:

Contrastando al análisis hecho anteriormente, inferimos que van a existir muy pocas universidades con un nivel bajo de investigación en nuestro ranking (esto evidentemente influye de manera negativa en la evaluación de una universidad). Esto lo confirman nuestros datos al arrojarnos una probabilidad de aparición de tan solo 0.02 para la categoría más baja: **LO: Bajo**.

Usando esta variable, se sabe que la categoría **LO: Bajo** tiene una probabilidad de 0.02 en la distribución. ¿Cuál es la probabilidad de que la universidad número 102 (es decir llegando al 10 % de la nuestra muestra si estuviéramos haciendo un sondeo manual) seleccionada sea la primera en poseer la clasificación **LO**?

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-101
p<-0.02 
round(dgeom(x,p),4)
```
Podemos ver, que a diferencia de la anterior, tenemos una probabilidad relativamente significativa y mayor. Esto es debido a la baja probabilidad de aparición de la categoría **LO**: *es probable seleccionar 102 universidad y que ninguna de las 101 primeras pertenezca a la categoría* **LO**.

# Segundo Modelo: *En rangos*

#### Usando una categoría abundante:

En nuestra muestra general, tenemos 159 universidades pertenecientes a EE.UU. En base a la gran calidad que presentan sus universidades en ámbitos científicos, escogeremos justamente este número como el número de ensayos en el intervalo mayor (n=159) y veremos que comportamiento puede tomar (considerando una distribución similar a la mundial). 

Nuevamente, escogemos la categoría Muy Alta por su mayor cantidad de apariciones y por ser la principal característica de las universidades de gran calidad científica y productoras de conocimiento.

Es sabido que la categoría **Muy alta (VH)** tiene una probabilidad de 0.65 en la muestra. ¿Cuál es la probabilidad de que la *primera* sea **VH**, que la segunda sea la primera **VH**, y así sucesivamente hasta calcular la probabilidad de que la universidad número 159 sea la primera **VH**?

Representaremos gráficamente la expresión anterior.

Tiene *este* aspecto:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(0:158)
p<-0.65 
barplot(dgeom(x,p),ylab="Probabilidad",xlab="Cantidad de fracasos del 0 al 158",col="Aquamarine 3",names.arg = c(0:158),border="Aquamarine 3",main="Función de masa de  probabilidad geométrica: Categoría Muy Alta (VH)\n",cex.names = 0.5)
```
Observamos que la probabilidad alcanza su punto más alto en comparación a las otras cuando se tiene 0 fracasos (*es decir*, la probabilidad de que la primera universidad seleccionada sea **VH** ). Esta representa la probabilidad que tiene en la muestra de 0.65 (probabilidad simple de obtener la categoría esperada al seleccionar una universidad al azar).

Por otro lado, **disminuye** exponencialmente a medida que nos movemos hacia la derecha (más allá de los 8 fracasos la probabilidad es practicamente 0). Esto nos indica que es improbable seleccionar más de 8 universidades y que ninguna de ellas pertenezca a la categoría **VA** (tomemos en cuenta que posee una probabilidad alta de aparición).

#### Usando una categoría escasa:
Ahora, al igual que Estados Unidos ubicado en América, Europa tiene un gran representante en lo referente a producción de conocimiento y referencia bibliográfica: Reino Unido. Usaremos la cantidad de universidades que lo representan en el ránking como la cantidad de ensayos en el intervalo mayor (n=85).

Ahora, usemos una categoría con una probabilidad más baja de aparición para ver cuál es el comportamiento del modelo. La escogida es **Media (MD)** con una probabilidad de 0.08.

Es sabido que la categoría **Media (MD)** tiene una probabilidad de 0.08 en la muestra. ¿Cuál es la probabilidad de que la *primera* sea **MD**, que la segunda sea la primera **MD**, y así sucesivamente hasta calcular la probabilidad de que la universidad número 85 sea la primera **MD**?
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(0:84)
p<-0.08 
round(dgeom(x,p),4)
```
Como decimales se ve de manera desordenada. Igual que con los anteriores, ordenaremos en un ***gráfico de barras***:

Tiene *este* aspecto:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(0:84)
p<-0.08
barplot(dgeom(x,p),ylab="Probabilidad",xlab="Cantidad de fracasos del 0 al 84",col="Aquamarine 3",names.arg = c(0:84),border="Aquamarine 3",main="Función de masa de  probabilidad geométrica: Categoría Media (MD)\n",cex.names = 0.5)
```
Observamos que la probabilidad alcanza su punto más alto cuando se tiene 0 fracasos (*es decir*, la probabilidad de que la primera universidad seleccionada sea **MD** ). Al igual que el ejemplo anterior, este primer caso se refiere a la probabilidad simple de que la primera universidad seleccionada sea de categoría *MD* (0.08).

Ahora, a medida que se avanza a la derecha la probabilidad **disminuye**. En este sentido, sería similar al anterior de no ser por una clara diferencia: en este caso la pendiente de caída es menos pronunciada, asemejándose más a una recta que a una curva exponencial como la anterior. Esto es debido a la poca probabilidad de la variable, al ser escasa la probabilidad de que la selección *n* sea su primera aparición disminuye poco a poco y no de manera abrupta.

##### **Análisis**:
Para confirmar nuestra teoría de semejanza a un recta a medida que la probabilidad es más baja, trabajemos con una categoría de probabilidad aún mas baja: la categoría **LO: Baja** con $0.02$ y con la misma cantidad de ensayos que el anterior (número de universidades de Reino Unido):

Es sabido que la categoría **Baja (LO)** tiene una probabilidad de 0.02 en la muestra. ¿Cuál es la probabilidad de que la *primera* sea **LO**, que la segunda sea la primera **LO**, y así sucesivamente hasta calcular la probabilidad de que la universidad número 85 sea la primera **LO**?

Usemos la ya conocida **gráfica de barras de la función de masa**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-c(0:84)
p<-0.02
barplot(dgeom(x,p),ylab="Probabilidad",xlab="Cantidad de fracasos del 0 al 84",col="Aquamarine 3",names.arg = c(0:84),border="Aquamarine 3",main="Función de masa de  probabilidad geométrica: Categoría Baja (LO)\n",cex.names = 0.5)
```

Vemos que la caída es bastante menos pronunciada, y siempre partiendo del caso simple donde la probabilidad es igual a la probabilidad simple de aparición en la muestra. Debido a su bajísima probabilidad, se va asemejando a una recta tal y como fue planteado.

De esta manera confirmamos la hipótesis anterior.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
r<- function(x)
{
  round(x,2)
}
```

# DIVISIÓN DE LA DATA POR CONTINENTES

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
bar<-barplot(table("Continente"=DF$Continente),col="aquamarine3",xlab="Continentes",ylab="Frecuencia",ylim=c(0,450),yaxp=c(0,400,8),las=1,main="Universidades por continente")
text(bar,table("Continente"=DF$Continente)+ 15 ,labels=table("Continente"=DF$Continente))
#abline(h = v, col="black", lwd=1, lty=1)
grid(nx = NA,ny=NULL, lwd = 1, lty = 2, col = "gray")
barplot(table("Continente"=DF$Continente),col="aquamarine3",xlab="Continentes",ylab="Frecuencia",yaxp=c(0,400,8),las=1,main="Universidades por continente",add=TRUE)
```


# Data europea 
## Análisis de la data:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DEuropa<-filter(DF,DF$Continente=="Europa")
cat("Número de observaciones:\n")
nrow(DEuropa)
cat("Número de casos completos:\n")
sum(complete.cases(DEuropa))
cat("Porcentaje de datos completos:\n")
sum(!is.na(DEuropa))/(nrow(DEuropa)*ncol(DEuropa))*100

```
Observamos que tenemos 202 casos completos, lo cual representa a más de la mitad de observaciones y más del 80% de datos completos. Gracias a esto, podemos decir que contamos con un número suficiente de datos para analizar la sección europea de nuestra data derivada de las 1024 mejores universidades del mundo.

## Análisis de variables categóricas:

Compararemos las variables categóricas derivadas de la **data Europea** con las de la **data Mundial**. Debido a que las frecuencias siempre van a ser menores y no sencillas de analizar a simple vista, haremos uso de las ***probabilidades*** que tienen las categorías de aparecer en una u otra muestra.

Además de este análisis, estableceremos los intervalos de confianza para las variables más importantes para nuestro análisis, **Intensidad de Investigación** y **Tiempo de Funcionamiento**.

### A) Clasificación de Estatus:
Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DEuropa$`Clasificación de estatus`))/nrow(DEuropa)*100
```
Obtenemos cerca del 8%, un porcentaje bajo que permitirá analizar de manera fiable la data y hace posible su comparación eficaz con la data mundial.

**Comparación con la situación mundial:**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}


tabla1<-prop.table(table(DEuropa$`Clasificación de estatus`))
tabla1_1<-table(DEuropa$`Clasificación de estatus`)

tabla2<-prop.table(table(DF$`Clasificación de estatus`))
tabla2_1<-table(DF$`Clasificación de estatus`)

m1<-matrix(c(
        c(tabla1[1],tabla1_1[1],tabla2[1],tabla2_1[1]),
        c(tabla1[2],tabla1_1[2],tabla2[2],tabla2_1[2]),
        c(tabla1[3],tabla1_1[3],tabla2[3],tabla2_1[3])
        )
        ,byrow=T,nrow=3)
        
colnames(m1)<-c("Probabilidad (EUROPA)","   Frecuencia (EUROPA)","    Probabilidad (MUNDO)","   Frecuencia (MUNDO)")
rownames(m1)<-c("A: Excelente","B: Buena","C: Regular")

m1

```
Observamos que más del 95% de universidades de la **muestra Europea** posee una clasificación A (Excelente), mientras que en el **mundo** es solo un poco superior a 80%. Esto significa que en comparación a la situación mundial, Europa posee una *calidad educativa* de *alto rango*.

### B) Clasificación de Tamaño:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DEuropa$`Clasificación de tamaño`))/nrow(DEuropa)*100
```
Obtenemos un 0% de datos faltantes para esta categoría, lo cual hace muy preciso el análisis a realizar .

**Comparación con la situación mundial:**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}


tabla1<-prop.table(table(DEuropa$`Clasificación de tamaño`))
tabla1_1<-table(DEuropa$`Clasificación de tamaño`)

tabla2<-prop.table(table(DF$`Clasificación de tamaño`))
tabla2_1<-table(DF$`Clasificación de tamaño`)

m1<-matrix(c(
        c(tabla1[3],tabla1_1[3],tabla2[3],tabla2_1[3]),
        c(tabla1[2],tabla1_1[2],tabla2[2],tabla2_1[2]),
        c(tabla1[1],tabla1_1[1],tabla2[1],tabla2_1[1]),
        c(tabla1[4],tabla1_1[4],tabla2[4],tabla2_1[4])
        )
        ,byrow=T,nrow=4)
        
colnames(m1)<-c("Probabilidad (EUROPA)","   Frecuencia (EUROPA)","    Probabilidad (MUNDO)","   Frecuencia (MUNDO)")
rownames(m1)<-c("S: Pequeño","M: Mediano","L: Grande","XL: Extra Grande")

m1

```

Observamos que se tiene una distribución similar a la mundial en esta categoría, ya que comparando la columna de probabilidades de ambas muestras observamos valores cercanos entre sí. Debido a su similitud, aquí también vemos una mayoría de universidades con cantidades importantes de estudiantes (Grande - Extra Grande). Por lo que podemos catalogar a la muestra de las mejores universidades europeas como una mayoría de abundante alumnado y concurrencia.

### C) Tiempo de Funcionamiento:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DEuropa$`Tiempo de funcionamiento`))/nrow(DEuropa)*100
```
Obtenemos poco más del 4%, lo cual genera un bajo sesgo al análisis que se realizará a continuación y que, por tanto, tendrá una buena fiabilidad.

**Comparación con la situación mundial:**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DEuropa$`Tiempo de funcionamiento`))
tabla1_1<-table(DEuropa$`Tiempo de funcionamiento`)

tabla2<-prop.table(table(DF$`Tiempo de funcionamiento`))
tabla2_1<-table(DF$`Tiempo de funcionamiento`)

m1<-matrix(c(
        c(tabla1[1],tabla1_1[1],tabla2[1],tabla2_1[1]),
        c(tabla1[2],tabla1_1[2],tabla2[2],tabla2_1[2]),
        c(tabla1[3],tabla1_1[3],tabla2[3],tabla2_1[3]),
        c(tabla1[4],tabla1_1[4],tabla2[4],tabla2_1[4]),
        c(tabla1[5],tabla1_1[5],tabla2[5],tabla2_1[5])
        )
        ,byrow=T,nrow=5)
        
colnames(m1)<-c("Probabilidad (EUROPA)","   Frecuencia (EUROPA)","    Probabilidad (MUNDO)","   Frecuencia (MUNDO)")
rownames(m1)<-c("1: Nuevo","2: Joven","3: Establecido","4: Maduro","5: Histórico")

m1
```

Se aprecia que en las 3 últimas categorías tenemos probabilidades similares a la de la muestra mundial. *Sin embargo*, en las categorías **Nuevo** y **Joven** sucede todo lo contrario: Mientras que en **MUNDO** tenemos una probabilidad mayor de la categoría Joven, en **EUROPA** pasa lo contrario: la categoría Nuevo sobrepasa a la anterior mencionada.

Otro dato importante a resaltar (y que deriva del análisis anterior al mismo tiempo que lo explica) es que Europa contiene **16** de las **17** universidades de categoría **Nuevo** existentes en la muestra mundial, es decir, más del *90%* de universidades de esta categoría se encuentran en la data europea.

Además, podemos catalogar al conjunto de las mejores universidades europeas como un grupo de mayoría longeva (entre Histórico y Maduro) abarcando más del 70 de la muestra de este continente. Esto es lógico, recordemos que las universidades más longevas se encuentran en el **Viejo Mundo** (algunas se remontan al siglo XI, como la universidad de Oxford en Inglaterra.


### D) Clasificación de la intensidad de investigación:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DEuropa$`Clasificación de intensidad de investigación`))/nrow(DEuropa)*100
```
Obtenemos cerca del 4%, lo cual permite efectuar de manera segura y confiable el análisis de comparación.

**Comparación con la situación mundial:**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DEuropa$`Clasificación de intensidad de investigación`))
tabla1_1<-table(DEuropa$`Clasificación de intensidad de investigación`)

tabla2<-prop.table(table(DF$`Clasificación de intensidad de investigación`))
tabla2_1<-table(DF$`Clasificación de intensidad de investigación`)

m1<-matrix(c(
        c(tabla1[2],tabla1_1[2],tabla2[2],tabla2_1[2]),
        c(tabla1[3],tabla1_1[3],tabla2[3],tabla2_1[3]),
        c(tabla1[1],tabla1_1[1],tabla2[1],tabla2_1[1]),
        c(tabla1[4],tabla1_1[4],tabla2[4],tabla2_1[4])
        )
        ,byrow=T,nrow=4)
        
colnames(m1)<-c("Probabilidad (EUROPA)","   Frecuencia (EUROPA)","    Probabilidad (MUNDO)","   Frecuencia (MUNDO)")
rownames(m1)<-c("LO: Baja","MD: Media","HI: Alta","VH: Muy Alta")

m1

```

La probabilidad en que aparece cada categoría es bastante similar a la configuración observada en MUNDO. Sigue el mismo patrón ascendente, es decir, la frecuencia de aparición va en aumento desde la categoría más baja (LO) hasta la más alta (VH). Así podemos ver que la muestra europea posee una gran intensidad de investigación (la mayoría entre HI y VH), lo cual denota una gran preocupación por parte de las universidades de este continente por este ámbito que refleja la producción académica y el aporte al conocimiento mundial (lo cuál ratifica la gran consideración que se le tiene al momento de puntuar a una universidad).

## Análisis de variables numéricas: 

### Registro de la cantidad de datos faltantes por variable:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(">>Observaciones totales\n")
nrow(DEuropa)
cat("\n")
cat("\n")
cat("a) Datos faltantes en Puntaje General\n")
sum(is.na(DEuropa$`Puntaje general`))
cat("\n")
cat("b) Datos faltantes en Puntaje de reputación académica\n")
sum(is.na(DEuropa$`Puntaje de reputación académica`))
cat("\n")
cat("c) Datos faltantes en Puntaje de la proporción profesores - estudiantes\n")
sum(is.na(DEuropa$`Puntaje de la proporción profesores - estudiantes`))
cat("\n")
cat("d) Datos faltantes en Puntaje de reputación del empleador\n")
sum(is.na(DEuropa$`Puntaje de reputación del empleador`))
cat("\n")
cat("e) Datos faltantes en Puntaje de citas por facultad\n")
sum(is.na(DEuropa$`Puntaje de citas por facultad`))
cat("\n")
cat("f) Datos faltantes en Puntaje de la proporción de estudiantes internacionales\n")
sum(is.na(DEuropa$`Puntaje de la proporción de estudiantes internacionales`))
cat("\n")
cat("g) Datos faltantes en Puntaje de la proporción de profesores internacionales\n")
sum(is.na(DEuropa$`Puntaje de la proporción de profesores internacionales`))
```

Observamos que todas tienen cantidades importantes de datos faltantes (que fluctúan entre cerca del 20% y 50%). Esto genera un sesgo en el análisis que se busca realizar al continente Europeo dentro de su representación en el ranking.

### Comparación de datos con la data mundial:

#### Puntaje General: Histogramas
En primer lugar, compararemos el indicador principal: el ***Puntaje General***. Mediante histogramas y boxplot revisaremos la data europea y la mundial:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

par(cex=1,cex.axis=0.8,cex.main=1,mar=c(5,3,4,0.5),cex.lab=0.8)
layout(matrix(c(1:2),nrow=1,byrow=F))

hist(main="Histograma Ptje.General (MUNDO)",DF$`Puntaje general`,breaks = 25,prob=T,col="aquamarine3")
lines(density(DF$`Puntaje general`,na.rm = T),lwd=2,col="darkgreen")
abline(v=c(mean(DF$`Puntaje general`,na.rm=T),median(DF$`Puntaje general`,na.rm=T)),col=c("red","blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","darkgreen"), inset = c(0,0),cex=0.8)

hist(main="Histograma Ptje.General (EUROPA)",DEuropa$`Puntaje general`,breaks=25,prob=T,col="white")
lines(density(DEuropa$`Puntaje general`,na.rm = T),lwd=2,col="darkgreen")
abline(v=c(mean(DEuropa$`Puntaje general`,na.rm=T),median(DEuropa$`Puntaje general`,na.rm=T)),col=c("red","blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","darkgreen"), inset = c(0,0),cex=0.8)

```
Observamos que las curvas de densidad son muy parecidas en ambos casos. Lo único que difiere entre ambas es la caída que toma la curva hacia la derecha: mientras que en *Mundo* la caída es continua, en *Europa* presenta algunas zonas que tienden a elevarse ligeramente. Esto sucede debido a que mientras que en uno las probabilidades bajan de manera regular a medida que nos acercamos a puntajes altos, en el otro presenta altibajos durante su caída, lo que se podría traducir como una relación inversa menos estrecha entre la probabilidad de los intervalos y el aumento el puntaje.

Por otro lado, vemos medias y medianas de configuración similar en ambos con un sesgo hacia la derecha (**media** mayor a la **mediana**).

Finalmente, en ***Mundo*** llegamos a una moda en el intervalo [25, 30> ,mientras que ***Europa*** llega a una moda en el intervalo [30, 35>.

#### Puntaje General: Boxplots
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(5,3,4,0.5),cex.lab=0.8)
layout(matrix(c(1:2),nrow=1,byrow=F))

boxplot(DF$`Puntaje general`,col="aquamarine3",main="Boxplot Ptje. General (MUNDO)")
abline(h=mean(DF$`Puntaje general`,na.rm = T),col="red",lwd=2)

legend(x="topright",legend="Media",col="red",cex=0.8,lty=1:2)

boxplot(DEuropa$`Puntaje general`,col="white",main="Boxplot Ptje. General (EUROPA)")
abline(h=mean(DEuropa$`Puntaje general`,na.rm = T),col="red",lwd=2)

legend(x="topright",legend="Media",col="red",cex=0.8,lty=1:2)

#boxplot.stats(DF$`Puntaje general`)
#boxplot.stats(DEuropa$`Puntaje general`)

```

Los **boxplots**, al igual que los **histogramas**, nos muestra *configuraciones similares* entre ambas datas. Una diferencia a señalar es el valor que alcanza el máximo dentro del rango de seguridad, que es menor en Europa. Esto debido a que presenta menos frecuentemente valores mayores a 80 puntos en esta categoría. Esto se puede deber al sesgo que existe por la falta de datos (que alcanza casi el 50%).

#### Variables determinantes del Puntaje General concedido: Boxplots

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(2,10,2,2),cex.lab=0.8)
boxplot(DF$`Puntaje de la proporción de profesores internacionales`,
        DEuropa$`Puntaje de la proporción de profesores internacionales`,
        DF$`Puntaje de la proporción de estudiantes internacionales`,
        DEuropa$`Puntaje de la proporción de estudiantes internacionales`,
        DF$`Puntaje de citas por facultad`,
        DEuropa$`Puntaje de citas por facultad`,
        DF$`Puntaje de reputación del empleador`,
        DEuropa$`Puntaje de reputación del empleador`,
        DF$`Puntaje de la proporción profesores - estudiantes`,
        DEuropa$`Puntaje de la proporción profesores - estudiantes`,
        DF$`Puntaje de reputación académica`,
        DEuropa$`Puntaje de reputación académica`,
        las=2,cex.names=0.5,col=c("aquamarine4","aquamarine4","aquamarine3","aquamarine3","aquamarine1","aquamarine1",
                                  "darkgray","darkgray","lightgray","lightgray","white","white"),
        main="Comparación de Variables Numéricas",
        names=c("Mundo","Proporción Prof. Intl. : Europa","Mundo","Proporción Est. Intl. : Europa","Mundo","Citas por Facultad: Europa","Mundo","Rep. Laboral: Europa","Mundo","Prop. Prof. - Est.: Europa","Mundo","Rep. Académica: Europa"), xlab="Puntaje", border = rgb(0,0,0,0.4),horizontal=1)

```

En esta primera comparación mediante boxplots observamos que las gráficas son similares en cada categoría (con fluctuaciones bajísimas entre sus descriptores numéricos como lo son la media y el rang intercuartil). Esto pasa en casi todas las variables, a excepción de **Proporción de estudiantes internacionales** y **Proporción de profesores internacionales**, donde superan con una ventaja importante a sus pares mundiales (observemos la ***mediana***). Esto puede ser debido a la gran demanda por el aprendizaje y especialización (sea como educador o educando) en este continente, por la gran reputación con la que gozan sus casas de estudio.

#### Variables determinantes del Puntaje General concedido: Histogramas

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))
hist(DEuropa$`Puntaje de reputación académica`,breaks=25,main="Reputación Académica (EUROPA)",xlab="Puntajes",ylab="Frecuencia",col='white',prob=T)
lines(density(DEuropa$`Puntaje de reputación académica`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de reputación académica`,breaks=25,main="Reputación Académica (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='white',prob=T)
lines(density(DF$`Puntaje de reputación académica`,na.rm=T),lwd=1.5,col="black")


hist(DEuropa$`Puntaje de la proporción profesores - estudiantes`,breaks=25,main="Prop. Prof. - Est. (EUROPA)",xlab="Puntajes",col='lightgray',prob=T)
lines(density(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción profesores - estudiantes`,breaks=25,main="Prop. Prof. - Est. (MUNDO)",xlab="Puntajes",col='lightgray',prob=T)
lines(density(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T),lwd=1.5,col="black")


hist(DEuropa$`Puntaje de reputación del empleador`,breaks=25,main="Reputación Laboral (EUROPA)",xlab="Puntajes",ylab="Frecuencia",col='darkgray',prob=T)
lines(density(DEuropa$`Puntaje de reputación del empleador`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de reputación del empleador`,breaks=25,main="Reputación Laboral (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='darkgray',prob=T)
lines(density(DF$`Puntaje de reputación del empleador`,na.rm=T),lwd=1.5,col="black")



```

En estas tres primeras variables, contamos con curvas de densidad similares entre **Mundo** y **Europa**. Esto confirma y fortalece lo ya mostrado por los boxplots, demostrando una gran similitud entre ambas datas.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

hist(DEuropa$`Puntaje de citas por facultad`,breaks=25,main="Citas por Facultad (EUROPA)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine1',prob=T)
lines(density(DEuropa$`Puntaje de citas por facultad`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de citas por facultad`,breaks=25,main="Citas por Facultad (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine1',prob=T)
lines(density(DF$`Puntaje de citas por facultad`,na.rm=T),lwd=1.5,col="black")


hist(DEuropa$`Puntaje de la proporción de estudiantes internacionales`,breaks=25,main="Estudiantes Extranjeros (EUROPA)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DEuropa$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción de estudiantes internacionales`,breaks=25,main="Estudiantes Extranjeros (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")


hist(DEuropa$`Puntaje de la proporción de profesores internacionales`,breaks=25,main="Profesores Extranjeros (EUROPA)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine4',prob=T)
lines(density(DEuropa$`Puntaje de la proporción de profesores internacionales`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción de profesores internacionales`,breaks=25,main="Profesores Extranjeros (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine4',prob=T)
lines(density(DF$`Puntaje de la proporción de profesores internacionales`,na.rm=T),lwd=1.5,col="black")
```

Observamos que de estas tres categorías, las curvas de nivel son bastante similares. Además de esto, en la primeras podemos observar también que las probabilidades en los intervalos son similares (con un tope cercano a 0.020 para ambos). Sin embargo, esto no pasa con las dos otras variables, donde vemos que Europa alcanza para ambos una probabilidad más alta en su intervalo modal de [95,100> en comparación a la misma en la data mundial. Es decir, alcanza puntajes más altos que el conjunto mundial. Esto se puede confirmar además observando cuidadosamente la curva de nivel (de dos picos): en ambos casos, el pico más cercano a puntajes bajos se achata para Europa.

Esto apoya a lo mostrado por los boxplots, donde son justamente estas dos categorías en las cuáles la mediana Europa alcanza una ventaja sobre la mundial.

### Estableciendo los intervalos de confianza superior e inferior para las medias respectivas:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (c(
    round(mean(Valores,na.rm=T),2),
    round(median(Valores,na.rm=T),2),
    round(sd(Valores,na.rm=T),2),
    round(IQR(Valores, na.rm = T),2),
    round(sd(Valores,na.rm=T)/(mean(Valores,na.rm=T)),2)
                         ))
}
```

En primer lugar, mostraremos los principales descriptores  numéricos de cada una de nuestras variables:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
m1<-matrix(c(
         datos(DEuropa$`Puntaje general`),
         datos(DEuropa$`Puntaje de reputación académica`),
         datos(DEuropa$`Puntaje de la proporción profesores - estudiantes`),
         datos(DEuropa$`Puntaje de reputación del empleador`),
         datos(DEuropa$`Puntaje de citas por facultad`),
         datos(DEuropa$`Puntaje de la proporción de estudiantes internacionales`),
         datos(DEuropa$`Puntaje de la proporción de profesores internacionales`)
         ), byrow=T,nrow=7)

colnames(m1)<-c("Media","  Mediana", "  Desv.estándar","   IQR","  Coef. de variación")
rownames(m1)<-c("Puntaje general","Reputación Académica","Proporción Prof. - Estud.","Reputación Laboral","Citas por Facultad","Estudiantes Extranjeros","Profesores Extranjeros")

m1
```

Ahora, en vista al análisis de datos faltantes por cada variables sabemos que existirá inevitablemente un sesgo en los descriptores. Para aproximar dentro de un intervalo confiable el posible valor que tomen las medias, haremos uso de el establecimientos de intervalos de seguridad inferior y superior a través de la estimación por el Teorema de Límite Central, dado que contamos con data suficiente.

Además, observamos que a pesar de tener rangos constantes en todas las variables (0,100) y prácticamente carecer de outliers, muchos de nuestros datos se encuentran regularmente dispersos (con coeficiente de variación cercanos a 0.6 y además rangos intercuartiles que alcanzan valores entre el 30% y 50% del rango total) por lo que en estos casos necesitamos un valor más alto de confianza (debido a que los valores faltantes bien pueden hacer variar mucho la media). Este nivel de confianza será de 97%. 

Por otro lado, en uno de los casos observamos un coeficiente que está por debajo de 40% y un rango intercuartil que solo representa el 20% del rango total. Debido a esto, podemos darnos la libertad de sacrificar confianza y centrarnos más en la precisión de la media. El valor propuesto a usar en este caso será un nivel de confianza de 90%.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
icno_disnormal <-function(variable,confianza){
        alfa = 1-confianza
        var = var(variable,na.rm=T)
        n = length(variable)
        media = mean(variable,na.rm=T)
        z = qnorm(1-alfa/2)

        ICI = media - z * sqrt(var/n)
        primero<-round(ICI,3)
        ICS = media + z * sqrt(var/n)
        segundo<-round(ICS,3)
        
        return(c(primero,media,segundo,z * sqrt(var/n)))
        
}

m2<-matrix(c(
        icno_disnormal(DEuropa$`Puntaje general`,0.9),
        icno_disnormal(DEuropa$`Puntaje de reputación académica`,0.97),
         icno_disnormal(DEuropa$`Puntaje de la proporción profesores - estudiantes`,0.97),
         icno_disnormal(DEuropa$`Puntaje de reputación del empleador`,0.97),
         icno_disnormal(DEuropa$`Puntaje de citas por facultad`,0.97),
         icno_disnormal(DEuropa$`Puntaje de la proporción de estudiantes internacionales`,0.97),
         icno_disnormal(DEuropa$`Puntaje de la proporción de profesores internacionales`,0.97)),byrow=T,nrow=7)

cat("Intervalo de confianza de las medias muestrales para la población (aproximación a la data si no tuviera NA´s)\n\n")
colnames(m2)<-c("Intervalo inferior","  Media Muestral","   Intervalo superior", "  Margen de Error")
rownames(m2)<-c("Puntaje general","Reputación Académica","Proporción Prof. - Estud.","Reputación Laboral","Citas por Facultad","Estudiantes Extranjeros","Profesores Extranjeros")
m2

```

### HIPÓTESIS

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table(DF$Continente)
```
Europa es el primer continente con más observaciones, es decir más universidades en el top 1024. 

Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

**Sean mayor que las puntuaciones promedio**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DEuropa <- filter(DF,Continente=="Europa")
```


#### 1. Puntaje de Reputación académica

El puntaje de reputación académica según Quacquarelli Symonds representa el 40 % de la evaluación a una universidad.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRA <-DEuropa$`Puntaje de reputación académica`

hist(PRA,main="Histograma Puntaje de Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
**Datos del Puntaje de Reputación Académica Europeo:**
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación académica`)
#Media:
media = r(mean(DEuropa$`Puntaje de reputación académica`,na.rm=T))
#Desviación estándar
sd = r(sd(DEuropa$`Puntaje de reputación académica`,na.rm=T))
#mediana
mediana = r(median(DEuropa$`Puntaje de reputación académica`,na.rm=T))
#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```
A partir de la desviación estándar y el coeficiente de variación cercano a 0.6 podemos establecer y respaldar la necesidad de dar una mayor importancia en este caso a la confianza del valor determinado, por lo cual determinamos conveniente usar el siguiente valor:

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DEuropa$`Puntaje de reputación académica`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(DEuropa$`Puntaje de reputación académica`)
desviacion <- sd(DEuropa$`Puntaje de reputación académica`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación académica`)
#Media:
media = mean(DEuropa$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación académica`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 37.79

**Hipótesis alternativa**

H_1 < 37.79

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación académica`)
#Media:
media = mean(DEuropa$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola: punto crítico**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = - 1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación académica`)
#Media:
media = mean(DEuropa$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **rechaza** que el promedio del puntaje de reputación académica de Europa **es menor que el general** con un nivel de significación del 3%.

Y por lo tanto no se rechaza la hipótesis de que el promedio del puntaje de reputación académica de Europa sea mayor que el general con un nivel de significación del 3 %.


#### 2. Puntaje de Reputación del empleador

El puntaje de reputación del empleador según Quacquarelli Symonds representa el 10 % de la evaluación a una universidad.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRE <-DEuropa$`Puntaje de reputación del empleador`

hist(PRE,main="Histograma Puntaje de Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación del empleador`)
#Media:
media = r(mean(DEuropa$`Puntaje de reputación del empleador`,na.rm=T))
#Desviación estándar
sd = r(sd(DEuropa$`Puntaje de reputación del empleador`,na.rm=T))
#mediana
mediana = r(median(DEuropa$`Puntaje de reputación del empleador`,na.rm=T))

#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```
Observamos un coeficiente de variación alto de 0.7, por lo cual debemos priorizar una confianza antes de una mejor precisión. En vista de esto, escogemos el siguientes nivel de confianza para nuestra hipótesis:

##### Nivel de confianza: 98 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)
nc = 0.98
alfa = 0.02
z <- qnorm(1-alfa/2)
n <- length(DEuropa$`Puntaje de reputación del empleador`)
desviacion <- sd(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación del empleador`)
#Media:
media = mean(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 38.11

**Hipótesis alternativa**

H_1 < 38.11

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación del empleador`)
#Media:
media = mean(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.02
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.02 (una cola), entonces zt = -2.05

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de reputación del empleador`)
#Media:
media = mean(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de reputación del empleador`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.02
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de reputación del empleador de Europa es menor que el general con un nivel de significación del 3 %.

Y por lo tanto **no se rechaza** la hipótesis de que el promedio del puntaje de reputación del empleador de Europa sea mayor que el general con un nivel de significación del 3 %.


#### 3. Puntaje de proporción de profesores / estudiantes

El puntaje de proporción de profesores / estudiantes según Quacquarelli Symonds representa el 20 % de la evaluación a una universidad.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PR <-DEuropa$`Puntaje de la proporción profesores - estudiantes`

hist(PR,main="Histograma Puntaje de proporción de profesores / estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = r(mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#Desviación estándar
sd = r(sd(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#mediana
mediana = r(median(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```
Con un coeficiente de variación cercano a 0.6, los valores de la población tienen una variación importante. Debido a esto, para tomarlos en cuenta en un intervalo de confianza debemos priorizar su confianza en lugar de su precisión. Por lo cual optamos por el siguiente valor de confianza:

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(DEuropa$`Puntaje de la proporción profesores - estudiantes`)
desviacion <- sd(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 49.02

**Hipótesis alternativa**

H_1 < 49.02

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = - 1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **rechaza** que el promedio del puntaje de reputación académica de Europa es menor que el general con un nivel de significación del 3 %.

Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de reputación académica de Europa sea mayor que el general** con un nivel de significación del 3 %.

#### 4. Puntaje de citas por facultad
El puntaje de reputación del empleador según Quacquarelli Symonds representa el 20 % de la evaluación a una universidad.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-DEuropa$`Puntaje de citas por facultad`

hist(PCF,main="Histograma Puntaje de citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
PCF <-DEuropa$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = r(mean(PCF,na.rm=T))
#Desviación estándar
sd = r(sd(PCF,na.rm=T))
#mediana
mediana = r(median(PCF,na.rm=T))
#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)

```
Al igual que con las variables anteriores, observamos un coeficiente de variación importante en esta variable. Por esta razón ponemos la confianza por encima de la precisión y decidimos usar el siguiente valor:
##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-DEuropa$`Puntaje de citas por facultad`
media <- mean(PCF,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PCF)
desviacion <- sd(PCF,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#EUROPA
PCF <-DEuropa$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 41.07

**Hipótesis alternativa**

H_1 < 41.07

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#EUROPA
PCF <-DEuropa$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola: punto crítico**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#EUROPA
PCF <-DEuropa$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de citas por facultad de Europa es menor que el general con un nivel de significación del 3 %.

Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de citas por facultad de Europa sea mayor que el general** con un nivel de significación del 3 %.


#### 5. Puntaje de citas por proporción de profesores internacionales

El puntaje de reputación académica según Quacquarelli Symonds representa el 5 % de la evaluación a una universidad.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`

hist(PPP,main="Histograma Puntaje de proporción de profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = r(mean(PPP,na.rm=T))
#Desviación estándar
sd = r(sd(PPP,na.rm=T))
#mediana
mediana = r(median(PPP,na.rm=T))
#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```
Nuevamente observamos un coeficiente de variación importante. Sobreponemos confianza sobre precisión y obtenemos lo siguiente:

##### Nivel de confianza : 97 %

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
media <- mean(PPP,na.rm=T)
nc = 0.95
alfa = 0.05
z <- qnorm(1-alfa/2)
n <- length(PPP)
desviacion <- sd(PPP,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#EUROPA
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 52.40

**Hipótesis alternativa**

H_1 < 52.40

**Nivel de significancia**

alfa = 0.05

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#EUROPA
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola: punto crítico**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#EUROPA
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de proporción de profesores internacionales de Europa es menor que el general con un nivel de significación del 3 %.

Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de proporción de profesores internacionales de Europa sea mayor que el general** con un nivel de significación del 3 %.

#### 6. Puntaje de proporción de estudiantes internacionales

El puntaje de reputación académica según Quacquarelli Symonds representa el 5 % de la evaluación a una universidad.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`

hist(PPE,main="Histograma Puntaje de proporción de estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = r(mean(PPE,na.rm=T))
#Desviación estándar
sd = r(sd(PPE,na.rm=T))
#mediana
mediana = r(median(PPE,na.rm=T))

#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```

Debido al importante coeficiente de variación, priorizamos confianza sobre precisión (la media puede variar regularmente). Por lo que escogemos el siguiente nivel de confianza:

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
media <- mean(PPE,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PPE)
desviacion <- sd(PPE,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#EUROPA
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Europa")
DATOS
```
Optamos por tomar la media muestral de la población mundial, es decir la estimación puntual del valor. Esto debido a la necesidad de fijar un valor de comparación que se usará en la siguiente prueba de hipótesis:

**Hipótesis nula**

H_0 >= 45.90

**Hipótesis alternativa**

H_1 < 45.90

**Nivel de significancia**

alfa = 0.05

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#EUROPA
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)



z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola: punto crítico**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#EUROPA
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de proporción de estudiantes internacionales de Europa es menor que el general con un nivel de significación del 3 %.

Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de proporción de estudiantes internacionales de Europa sea mayor que el general** con un nivel de significación del 3 %.


## RESUMEN DEL ANÁLISIS ANTERIOR
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

layout(matrix(c(1:6),nrow=2,byrow=F))

PRA <-DEuropa$`Puntaje de reputación académica`
hist(PRA,main="Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)

PRE <-DEuropa$`Puntaje de reputación del empleador`
hist(PRE,main="Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PR <-DEuropa$`Puntaje de la proporción profesores - estudiantes`
hist(PR,main="Proporción profesores/estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PCF <-DEuropa$`Puntaje de citas por facultad`
hist(PCF,main="Citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
hist(PPP,main="Profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

```
**Descriptores numéricos**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (round(c(mean(Valores,na.rm=T),median(Valores,na.rm=T),sd(Valores,na.rm=T),IQR(Valores,na.rm=T),(sd(Valores,na.rm=T)/mean(Valores,na.rm=T))),2))
}

PRA <-DEuropa$`Puntaje de reputación académica`
PRE <-DEuropa$`Puntaje de reputación del empleador`
PR <-DEuropa$`Puntaje de la proporción profesores - estudiantes`
PCF <-DEuropa$`Puntaje de citas por facultad`
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`

descriptores<-matrix(c(datos(PRA),datos(PRE),datos(PR),datos(PCF),datos(PPP),datos(PPE)),nrow=6,ncol=5,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(descriptores)<-c("Media","  Mediana","Desviación Estándar","  Rango Intercuartil"," Coef. Var.")
descriptores

```

**Intervalos de confianza**

Con un nivel de confianza variable dependiente de la tendencia de variación del factor analizado:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores,z,n){
  return (round(c(mean(Valores,na.rm=T),sd(Valores,na.rm=T),z,sd(Valores,na.rm=T)/sqrt(n),mean(Valores,na.rm=T)-sd(Valores,na.rm=T)/sqrt(n)*z,mean(Valores,na.rm=T)+sd(Valores,na.rm=T)/sqrt(n)*z),2))
}

PRA <-DEuropa$`Puntaje de reputación académica`
PRE <-DEuropa$`Puntaje de reputación del empleador`
PR <-DEuropa$`Puntaje de la proporción profesores - estudiantes`
PCF <-DEuropa$`Puntaje de citas por facultad`
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`

z<-function(alfa){
  return (qnorm(1-alfa/2))
}

n <- nrow(DEuropa)



intervalos_c<-matrix(c(datos(PRA,z(0.03),n),datos(PRE,z(0.02),n),datos(PR,z(0.03),n),datos(PCF,z(0.03),n),datos(PPP,z(0.03),n),datos(PPE,z(0.03),n)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("Media"," Desv_estándar","       z"," Error estándar"," limit_inf"," limit_sup")
intervalos_c

```

**HIPÓTESIS**

Europa es el primer continente con más observaciones, es decir más universidades en el top 1024.
Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

**Sean mayor que las puntuaciones promedio**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y/o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,n,alfa){
  zt <- qnorm(1-alfa)
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
PRA1 <-DF$`Puntaje de reputación académica`
PRE1 <-DF$`Puntaje de reputación del empleador`
PR1 <-DF$`Puntaje de la proporción profesores - estudiantes`
PCF1 <-DF$`Puntaje de citas por facultad`
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`

#Europa
PRA <-DEuropa$`Puntaje de reputación académica`
PRE <-DEuropa$`Puntaje de reputación del empleador`
PR <-DEuropa$`Puntaje de la proporción profesores - estudiantes`
PCF <-DEuropa$`Puntaje de citas por facultad`
PPP <-DEuropa$`Puntaje de la proporción de profesores internacionales`
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`

#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#EUROPA
PPE <-DEuropa$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)


z = (media - mediaP)/(sd/sqrt(n))



n = nrow(DEuropa)


intervalos_c<-matrix(c(datos(PRA,PRA1,n,0.03),datos(PRE,PRE1,n,0.02),datos(PR,PR1,n,0.03),datos(PCF,PCF1,n,0.03),datos(PPP,PPP1,n,0.03),datos(PPE,PPE1,n,0.03)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```

Para efectos de la tabla mostrada, los valores **FALSE** indican que la hipótesis nula ha sido rechazada, y los valores **TRUE** que ha sido aceptada.

Tenemos 6 de las 6 variables de puntuación que aceptan nuestra hipótesis, pero es importante recordar que el puntaje general que define su posición en el ranking, esta dada por un promedio ponderado de estas 6 variables.

* Reputación académica (40 %)
* Reputación del empleador (10 %)
* Proporción de profesores/ estudiantes (20 %)
* Citas por facultad (20 %)
* Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

La suma de los pesos de las 6 variables de puntuación que aceptan nuestra hipótesis es:
```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Sp<- 40 + 10 + 20 + 20+5+5
cat(Sp,"%")
```

Obtenemos el 100%, lo cual indica una superioridad absoluta en comparación a la situación mundial.

Además, podemos hacer la misma prueba de hipótesis con la variable Puntaje General, para constatar lo ya indicado por nuestras hipótesis anteriores. En primer lugar, observemos sus descriptores gráficos.

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#EUROPA
#Tamaño de la muestra:
n = length(DEuropa$`Puntaje general`)
#Media:
media = r(mean(DEuropa$`Puntaje general`,na.rm=T))
#Desviación estándar
sd = r(sd(DEuropa$`Puntaje general`,na.rm=T))
#mediana
mediana = r(median(DEuropa$`Puntaje general`,na.rm=T))

#coeficiente de variación
coef_var=r(sd/media)

data.frame(n,media,mediana,sd,coef_var)
```

Con un coeficiente de variación relativamente bajo (cercano a 0.4), podemos centrarnos más en la precisión de esta variable (la variable no varía demasiado). Entonces, elegimos un nivel de confianza de **90%**:

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(europa_1,general,zt,n,alfa){
  media = mean(europa_1,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

alfa = 0.1
zt <- qnorm(1-alfa)
n = nrow(DEuropa)

x = DEuropa$`Puntaje general`
y = DF$`Puntaje general`


intervalos_c<-matrix(datos(x,y,zt,n,alfa),nrow=1,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Puntaje general ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```
Luego de analizar los puntajes en cada factor y el puntaje general, que como dijimos anteriormente es el que define la posición final en el ránking, podemos concluir que: Europa como continente está en una aceptable situación en cuanto a calidad universitaria.


## Establecimiento de relaciones lineales entre variables:

### Modelos de linealización entre variables numéricas:
```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

#Puntaje de reputación académica vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`,ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))

#Puntaje de Reputación del empleador vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de reputación del empleador`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`,ylab = "Puntaje General" , xlab = "Puntaje de Reputación del empleador")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación del empleador`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`))

#Puntaje de la proporción profesores - estudiantes  vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de la proporción profesores - estudiantes`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`,ylab = "Puntaje General" , xlab = "Proporción profesores/estudiantes")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción profesores - estudiantes`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`))

#Puntaje de citas por facultad vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de citas por facultad`))
plot( R1$`Puntaje general`~R1$`Puntaje de citas por facultad`,ylab = "Puntaje General" , xlab = "Puntaje de citas por facultad")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de citas por facultad`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`))

#Puntaje de la proporción de profesores internacionales vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de la proporción de profesores internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`,ylab = "Puntaje General" , xlab = "Profesores internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de profesores internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`))

#Puntaje de la proporción de estudiantes internacionales vs. Puntaje General (ASIA)
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de la proporción de estudiantes internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`,ylab = "Puntaje General" , xlab = "Estudiantes  internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de estudiantes internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes  internacionales`))
```
De estas gráficas visualmente podemos concluir que la que más relación directa guarda con la variable **Puntuación General** es la variable **Reputación Académica**. Y esto lo comprobamos con el coeficiente de correlación de Pearson.


#### Modelo lineal: Puntaje General dependiente de Reputación Académica 
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R1<-filter(DEuropa,!is.na(DEuropa$`Puntaje general`),!is.na(DEuropa$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`, col="aquamarine3",pch=19, main = "Puntaje de reputación académica vs. Puntaje General (EUROPA)",  ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=3, lty=c(1), col("red"))

corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Correlación:", round(corr,3)), x=15, y= 80)

text(paste("Ecuación: 0.59319 x + 20.56438"), x=23, y= 70,col="darkblue")
summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))

```
Observamos que el modelo posee una correlación muy alta entre variables, de más de 0.8 (es, de hecho, la más alta en Europa). Gracias a esto, es posible poner a prueba los valores de nuestra posible regresión, para de esta manera rechazarla o no rechazarla:

**- Validando los coeficientes:**

Considerando una posible regresión de forma: $y=mx+b$

Intersección: Estableciendo una significancia de 0.05, se rechaza la hipótesis nula ($H_0$). Entonces, $b\neq0$.

Pendiente: Estableciendo una significancia de 0.05, se rechaza la hipótesis nula ($H_0$). Entonces, $m\neq0$.

**- Observando el r-cuadrado:**

Vemos que toma el valor de 0.7255, por lo que al ser un valor cercano a 1 decimos que nuestro modelo explica de manera satisfactoria la relación entre ambas variables.

**- Observando el p-valor:**

Observamos que este alcanza un valor muy pequeño (< 2.2e-16) evidentemente menor a nuestra significancia (0.05), por lo cual podemos rechazar la hipótesis nula ($H_0$) que dicta que nuestro modelo no explica la relación entre variables.

*Finalmente:*

Concluimos que el modelo propuesto explica de manera satisfactoria la relación entre variables. Por lo tanto, no se rechaza.

Una vez realizado esto, obtenemos los valores de las constantes (*intersección y pendiente*) de nuestro modelo lineal:

$b=20.56438$

$m= 0.59319$

La ecuación, tomando a $Rep. Académica$ como independiente y a $Ptje.General$ como dependiente, sería la siguiente:

$Ptje.General_{(Rep.Académica)}=0.59319(Rep.Académica)+20.56438$

Se concluye que al tener el respaldo de la totalidad de indicadores numéricos antes mostrados, este modelo explicaría satisfactoriamente la relación entre las variables *Reputación Académica* y *Puntaje General*.

##### **Grado de utilidad:**

Esta fórmula es útil para universidades europeas con valores desconocidos de Ptje. General, pero conocidos de Reputación Académica. La cantidad es la siguiente:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
nrow(filter(DEuropa,DEuropa$`Puntaje de reputación académica`>0,is.na(DEuropa$`Puntaje general`)))
```


##### **Haciendo uso del modelo propuesto para generar predicciones:**

###### *Para Puntaje General conocido (evaluando la efectividad del modelo):*

Escogemos una universidad que cumpla con la condición de tener los dos datos a comparar completos, para eso filtramos en Europa:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta<-filter(DEuropa,!is.na(DEuropa$`Puntaje de reputación académica`),!is.na(DEuropa$`Puntaje general`))
UniversidadCompleta[36,c(3,4,23)]
```

Obtenemos su Reputación Académica y reemplazamos en nuestra ecuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta[36,c(3,10)]
```
$Ptje.General_{(Rep.Académica)}=0.59319(Rep.Académica)+20.56438$

$Ptje.General_{(64.5)}=0.59319(64.5)+20.56438$

$Ptje.General_{(64.5)}=58.83$

Ahora, busquemos el verdadero Puntaje General de la universidad:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta[36,c(3,10,22)]
```

Observamos que los valores son bastante aproximados, comprobando de esta manera la efectividad de nuestro modelo.

###### *Para Puntaje General desconocido (probando el modelo en una situación real):*

Escogemos una universidad que cumpla con la condición de tener solo Reputación Académica completo, para eso filtramos en Europa:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta<-filter(DEuropa,!is.na(DEuropa$`Puntaje de reputación académica`),is.na(DEuropa$`Puntaje general`))
UniversidadCompleta[36,c(3,4,23)]
```

Obtenemos su Reputación Académica y reemplazamos en nuestra ecuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta[36,c(3,10)]
```
$Ptje.General_{(Rep.Académica)}=0.59319(Rep.Académica)+20.56438$

$Ptje.General_{(37.7)}=0.59319(37.7)+20.56438$

$Ptje.General_{(37.7)}=42.93$

El posible valor de Puntaje General de la Universidad Sorbonne Nouvelle París 3 (Francia) es de 42.93 puntos.

# Data America 
## Análisis de la data:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DA<-filter(DF,DF$Continente=="América")
cat("Número de observaciones:\n")
nrow(DA)
cat("Número de casos completos:\n")
sum(complete.cases(DA))
cat("Porcentaje de datos completos:\n")
sum(!is.na(DA))/(nrow(DA)*ncol(DA))*100

```
Observamos que tenemos 202 casos completos, lo cual representa casi la mitad de observaciones, y el 80% de datos completos. Gracias a esto, podemos decir que contamos con un número suficiente de datos para analizar la sección americana de nuestra data derivada de las 1024 mejores universidades del mundo.

## Análisis de variables categóricas:

Compararemos las variables categóricas derivadas de la **data Americana** con las de la **data Mundial**. Debido a que las frecuencias siempre van a ser menores y no sencillas de analizar a simple vista, haremos uso de las ***probabilidades*** que tienen las categorías de aparecer en una u otra muestra. Asimismo se establecerán los intervalos de confianza para las variables más importantes según nuestro análisis, **Intensidad de Investigación** y **Tiempo de Funcionamiento**.

### A) Clasificación de Estatus:
Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DA$`Clasificación de estatus`))/nrow(DA)*100
```
Obteniendo que solo un 2% de los datos son faltantes. Este bajo porcentaje nos permitirá analizar de manera fiable la data.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DA$`Clasificación de estatus`))
tabla1_1<-table(DA$`Clasificación de estatus`)

tabla2<-prop.table(table(DF$`Clasificación de estatus`))
tabla2_1<-table(DF$`Clasificación de estatus`)

m1<-matrix(c(
        c(tabla1[1],tabla2[1]),
        c(tabla1[2],tabla2[2]),
        c(tabla1[3],tabla2[3])
        )
        ,byrow=T,nrow=3)

        
colnames(m1)<-c("Probabilidad (America)","    Probabilidad (Mundo)")
rownames(m1)<-c("A: Excelente","B: Buena","C: Regular")

m1
```

La muestra mundial presenta una probabilidad de 81% de que una universidad posea una clasificación A. Al comparar esto con la **muestra Americana** se puede apreciar que la probabilidad en esta muestra es notablemente menor (62.5%), indicando que América no llega a poseer en su totalidad una *calidad educativa* de *alto rango*. No obstante esto no quita que sea buena, puesto de que más de un 50% de las universidades americanas posee una clasificación A (Excelente) y ninguna universidad presenta una clasificación C (Regular).

### B) Clasificación de Tamaño:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DA$`Clasificación de tamaño`))/nrow(DA)*100
```
Obtenemos que no hay datos faltantes en esta categoría, lo cual brinda mayor fiabilidad al análisis a realizar .

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DA$`Clasificación de tamaño`))
tabla1_1<-table(DA$`Clasificación de tamaño`)

tabla2<-prop.table(table(DF$`Clasificación de tamaño`))
tabla2_1<-table(DF$`Clasificación de tamaño`)

m1<-matrix(c(
        c(tabla1[3],tabla2[3]),
        c(tabla1[2],tabla2[2]),
        c(tabla1[1],tabla2[1]),
        c(tabla1[4],tabla2[4])
        )
        ,byrow=T,nrow=4)
        
colnames(m1)<-c("Probabilidad (América)","    Probabilidad (Mundo)")
rownames(m1)<-c("S: Pequeño","M: Mediano","L: Grande","XL: Extra Grande")

m1

```

Observamos que se tiene una distribución similar a la mundial en esta categoría, ya que comparando la columna de probabilidades de ambas muestras observamos valores cercanos entre sí. Asimismo, se puede apreciar que la mayoría de universidades americanas presentan grandes cantidades de estudiantes, ubicándose entre la categoría Grande y Extra Grande. 


### C) Tiempo de Funcionamiento:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DA$`Tiempo de funcionamiento`))/nrow(DA)*100
```
Obtenemos cerca del 5%, lo cual genera un potencial sesgo al análisis que se realizará a continuación (donde aproximaremos mediante intervalos de confianza a un rango donde se encuentre el valor real).

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DA$`Tiempo de funcionamiento`))
tabla1_1<-table(DA$`Tiempo de funcionamiento`)

tabla2<-prop.table(table(DF$`Tiempo de funcionamiento`))
tabla2_1<-table(DF$`Tiempo de funcionamiento`)

m1<-matrix(c(
        c(tabla1[5],tabla1_1[5],tabla2[1],tabla2_1[1]),
        c(tabla1[1],tabla1_1[1],tabla2[2],tabla2_1[2]),
        c(tabla1[2],tabla1_1[2],tabla2[3],tabla2_1[3]),
        c(tabla1[3],tabla1_1[3],tabla2[4],tabla2_1[4]),
        c(tabla1[4],tabla1_1[4],tabla2[5],tabla2_1[5])
        )
        ,byrow=T,nrow=5)
        
colnames(m1)<-c("Probabilidad (América)","   Frecuencia (América)","    Probabilidad (Mundo)","   Frecuencia (Mundo)")
rownames(m1)<-c("1: Nuevo","2: Joven","3: Establecido","4: Maduro","5: Histórico")

m1
```

Se aprecia que en el caso de las universidades con tiempo de funcionamiento maduro (4), Establecido (3) o Joven (2), la probabilidad de que existan en la **muestra Americana** es mayor a la probabilidad de que existan en la **muestra mundial**. Sin embargo, en las categorías Histórico (5) y Nuevo (1) ocurre todo lo contrario, presentando una mayor probabilidad de existencia en la muestra global.


**Intervalos de confianza de las proporciones de la variable Tiempo de funcionamiento:**
También analizaremos los intervalos inferior y superior de confianza de la proporción de cada una de las categorías de esta variable. Usaremos un nivel de confianza de 95%.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
tabla1<-prop.table(table(DA$`Tiempo de funcionamiento`))
long<-sum(table(DA$`Tiempo de funcionamiento`))
ic_prop<-function(prob,n){
        confianza = 0.95
        alfa = 0.05
        p = prob
        z = qnorm(1-alfa/2)
        ICI = p - z * sqrt(p*(1-p)/n)
        primero<-round(ICI,3)
        ICS = p + z * sqrt(p*(1-p)/n)
        segundo<-round(ICS,3)
        return(c(primero,p,segundo,z*sqrt(p*(1-p)/n)))

}

m2<-matrix(c(
        ic_prop(tabla1[5],long),
        ic_prop(tabla1[1],long),
        ic_prop(tabla1[2],long),
        ic_prop(tabla1[3],long),
        ic_prop(tabla1[4],long)
        )
        ,byrow=T,nrow=5)
colnames(m2)<-c("Inferior","  Probabilidad","   Superior", "   Margen de Error")
rownames(m2)<-c("1: Nuevo","2: Joven","3: Establecido","4: Maduro","5: Histórico")

m2
```


### D) Clasificación de la intensidad de investigación:

Primero, analizamos el porcentaje de datos faltantes para la categoría:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
sum(is.na(DA$`Clasificación de intensidad de investigación`))/nrow(DA)*100
```
Obtenemos aproximadamente 3%, lo cual , al igual que el anterior caso, genera un potencial sesgo al análisis que se realizará a continuación :

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

tabla1<-prop.table(table(DA$`Clasificación de intensidad de investigación`))
tabla1_1<-table(DA$`Clasificación de intensidad de investigación`)

tabla2<-prop.table(table(DF$`Clasificación de intensidad de investigación`))
tabla2_1<-table(DF$`Clasificación de intensidad de investigación`)

m1<-matrix(c(
        c(tabla1[2],tabla1_1[2],tabla2[2],tabla2_1[2]),
        c(tabla1[3],tabla1_1[3],tabla2[3],tabla2_1[3]),
        c(tabla1[1],tabla1_1[1],tabla2[1],tabla2_1[1]),
        c(tabla1[4],tabla1_1[4],tabla2[4],tabla2_1[4])
        )
        ,byrow=T,nrow=4)
        
colnames(m1)<-c("Probabilidad (América)","   Frecuencia (América)","    Probabilidad (Mundo)","   Frecuencia (Mundo)")
rownames(m1)<-c("LO: Baja","MD: Media","HI: Alta","VH: Muy Alta")

m1

```

La frecuencia de aparación va en aumento desde la categoría más baja (LO) hasta la más alta (VH). Así podemos ver que la muestra americana posee una gran intensidad de investigación (la mayoría entre HI y VH). 

**Intervalos de confianza de las proporciones de la variable Tiempo de funcionamiento:**
Usando un nivel de confianza de 95%.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}


long<-sum(table(DA$`Clasificación de intensidad de investigación`))

ic_prop<-function(prob,n){
        confianza = 0.95
        alfa = 0.05
        p = prob
        z = qnorm(1-alfa/2)
        ICI = p - z * sqrt(p*(1-p)/n)
        primero<-round(ICI,3)
        ICS = p + z * sqrt(p*(1-p)/n)
        segundo<-round(ICS,3)
        return(c(primero,p,segundo,z*sqrt(p*(1-p)/n)))

}

m2<-matrix(c(
        ic_prop(tabla1[2],long),
        ic_prop(tabla1[3],long),
        ic_prop(tabla1[4],long),
        ic_prop(tabla1[1],long)
        )
        ,byrow=T,nrow=4)

colnames(m2)<-c("Inferior","  Probabilidad","   Superior", "   Margen de Error")
rownames(m2)<-c("LO: Baja","MD: Media","HI: Alta","VH: Muy Alta")

m2
```

Al igual que el ejemplo anterior con **Tiempo de funcionamiento**, la probabilidad real de cada categoría se va a ubicar entre el nivel superior e inferior calculado (una vez más, idealizando una data europea **sin datos faltantes**).

## Análisis de variables numéricas: 

### Registro de la cantidad de datos faltantes por variable:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(">>Observaciones totales\n")
nrow(DA)
cat("\n")
cat("\n")
cat("a) Datos faltantes en Puntaje General\n")
sum(is.na(DA$`Puntaje general`))
cat("\n")
cat("b) Datos faltantes en Puntaje de reputación académica\n")
sum(is.na(DA$`Puntaje de reputación académica`))
cat("\n")
cat("c) Datos faltantes en Puntaje de la proporción profesores - estudiantes\n")
sum(is.na(DA$`Puntaje de la proporción profesores - estudiantes`))
cat("\n")
cat("d) Datos faltantes en Puntaje de reputación del empleador\n")
sum(is.na(DA$`Puntaje de reputación del empleador`))
cat("\n")
cat("e) Datos faltantes en Puntaje de citas por facultad\n")
sum(is.na(DA$`Puntaje de citas por facultad`))
cat("\n")
cat("f) Datos faltantes en Puntaje de la proporción de estudiantes internacionales\n")
sum(is.na(DA$`Puntaje de la proporción de estudiantes internacionales`))
cat("\n")
cat("g) Datos faltantes en Puntaje de la proporción de profesores internacionales\n")
sum(is.na(DA$`Puntaje de la proporción de profesores internacionales`))
```

Observamos que todas tienen cantidades importantes de datos faltantes, generando un sesgo en el análisis que se busca realizar al continente Europeo dentro de su representación en el ranking.

# Descriptores para las variables de puntuación:
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

layout(matrix(c(1:6),nrow=2,byrow=F))

PRA <-DA$`Puntaje de reputación académica`
hist(PRA,main="Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)


PRE <-DA$`Puntaje de reputación del empleador`
hist(PRE,main="Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PR <-DA$`Puntaje de la proporción profesores - estudiantes`
hist(PR,main="Proporción profesores/estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PCF <-DA$`Puntaje de citas por facultad`
hist(PCF,main="Citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPP <-DA$`Puntaje de la proporción de profesores internacionales`
hist(PPP,main="Profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPE <-DA$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)

```
**Descriptores numéricos**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (round(c(mean(Valores,na.rm=T),median(Valores,na.rm=T),sd(Valores,na.rm=T),IQR(Valores,na.rm=T),(sd(Valores,na.rm=T)/mean(Valores,na.rm=T))),2))
}

PRA <-DA$`Puntaje de reputación académica`
PRE <-DA$`Puntaje de reputación del empleador`
PR <-DA$`Puntaje de la proporción profesores - estudiantes`
PCF <-DA$`Puntaje de citas por facultad`
PPP <-DA$`Puntaje de la proporción de profesores internacionales`
PPE <-DA$`Puntaje de la proporción de estudiantes internacionales`

descriptores<-matrix(c(datos(PRA),datos(PRE),datos(PR),datos(PCF),datos(PPP),datos(PPE)),nrow=6,ncol=5,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(descriptores)<-c("Media","  Mediana","Desviación Estándar","  Rango Intercuartil","Coef.variabilidad")
descriptores

```

# Hipótesis

##### Nivel de confianza : 97 %

Consideramos un 99% de confianza porque el coeficiente de variabilidad es cercano a 1. Buscamos más confianza que precisión debido al valor de coeficiente de variación.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(america,general,zt,n,alfa){
  media = mean(america,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
PRA1 <-DF$`Puntaje de reputación académica`
PRE1 <-DF$`Puntaje de reputación del empleador`
PR1 <-DF$`Puntaje de la proporción profesores - estudiantes`
PCF1 <-DF$`Puntaje de citas por facultad`
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`

#Asia
PRA <-DA$`Puntaje de reputación académica`
PRE <-DA$`Puntaje de reputación del empleador`
PR <-DA$`Puntaje de la proporción profesores - estudiantes`
PCF <-DA$`Puntaje de citas por facultad`
PPP <-DA$`Puntaje de la proporción de profesores internacionales`
PPE <-DA$`Puntaje de la proporción de estudiantes internacionales`



alfa = 0.03
zt <- qnorm(1-alfa)
n = nrow(DA)


intervalos_c<-matrix(c(datos(PRA,PRA1,zt,n,alfa),datos(PRE,PRE1,zt,n,alfa),datos(PR,PR1,zt,n,alfa),datos(PCF,PCF1,zt,n,alfa),datos(PPP,PPP1,zt,n,alfa),datos(PPE,PPE1,zt,n,alfa)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```
Para efectos de la tabla mostrada, los valores **FALSE** indican que la hipótesis nula ha sido rechazada, y los valores **TRUE** que ha sido aceptada.


Tenemos 4 de las 6 variables de puntuación que aceptan nuestra hipótesis, pero es importante recordar que el puntaje general que define su posición en el ranking, esta dada por un promedio ponderado de estas 6 variables.

* Reputación académica (40 %)
* Reputación del empleador (10 %)
* Proporción de profesores/ estudiantes (20 %)
* Citas por facultad (20 %)
* Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

La suma de los pesos de las 4 variables de puntuación que aceptan nuestra hipótesis es:
```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
Sp<- 40 + 10 + 20 + 20
cat(Sp,"%")
```

Ya con esta información, podemos decir que América está en una mejor situación en cuanto a educación universitaria y podemos comprobarlo con el puntaje general.
```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(america,general,zt,n,alfa){
  media = mean(america,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

alfa = 0.03
zt <- qnorm(1-alfa)
n = nrow(DA)

x = DA$`Puntaje general`
y = DF$`Puntaje general`


intervalos_c<-matrix(datos(x,y,zt,n,alfa),nrow=1,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Puntaje general ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```

Luego de analizar los puntajes en cada factor y el puntaje general, que como dijimos anteriormente es el que define la posición final en el ranking, podemos concluir que: América como continente, está muy sobre el promedio en cuanto a calidad universitaria. 


# REGRESIÓN LINEAL SIMPLE
Las posiciones que ocupan en el ranking las universidades dependen directamente del puntaje general y este a su vez depende del promedio ponderado de las distintas variables de puntuación. Por lo cual en las siguientes gráficas mostramos las relaciones que tiene la variable **Puntaje General** con las otras 6 variables de puntación.

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

#Puntaje de reputación académica vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`,ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))

#Puntaje de Reputación del empleador vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de reputación del empleador`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`,ylab = "Puntaje General" , xlab = "Puntaje de Reputación del empleador")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación del empleador`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`))

#Puntaje de la proporción profesores - estudiantes  vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de la proporción profesores - estudiantes`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`,ylab = "Puntaje General" , xlab = "Proporción profesores/estudiantes")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción profesores - estudiantes`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`))

#Puntaje de citas por facultad vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de citas por facultad`))
plot( R1$`Puntaje general`~R1$`Puntaje de citas por facultad`,ylab = "Puntaje General" , xlab = "Puntaje de citas por facultad")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de citas por facultad`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`))

#Puntaje de la proporción de profesores internacionales vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de la proporción de profesores internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`,ylab = "Puntaje General" , xlab = "Profesores internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de profesores internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`))

#Puntaje de la proporción de estudiantes internacionales vs. Puntaje General (ASIA)
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de la proporción de estudiantes internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`,ylab = "Puntaje General" , xlab = "Estudiantes  internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de estudiantes internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes  internacionales`))
```

De estas gráficas visualmente podemos concluir que la que más relación directa guarda con la variable **Puntuación General** es la variable **Reputación Académica**. Y esto lo comprobamos con el coeficiente de correlación de Pearson.

```{r}
R1<-filter(DA,!is.na(DA$`Puntaje general`),!is.na(DA$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`, col="aquamarine3",pch=19, main = "Asia",  ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)

corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Correlación:", round(corr,3)), x=20, y= 90 )

text(paste("Ec:0.63784 x + 17.76118"), x=25, y= 75,col="darkblue")
summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))
```

**- Observando el r-cuadrado:**
Toma el valor de  0.8417, por lo que al ser cercano a 1 decimos que nuestro modelo explica de manera satisfactoria la relación entre ambas variables.

**- Observando el p-valor:**
Alcanza un valor muy pequeño (< 2.2e-16) evidentemente menor a nuestra significancia (0.05), por lo cual podemos rechazar la hipótesis nula ($H_0$) que dicta que nuestro modelo no explica la relación entre variables.

*Finalmente:*

Concluimos que el modelo propuesto explica de manera satisfactoria la relación entre variables. Por lo tanto, no se rechaza.

Una vez realizado esto, obtenemos los valores de las constantes (*intersección y pendiente*) de nuestro modelo lineal:

$b=17.76118 $

$m= 0.63784$


El puntaje general depende de 6 variables numéricas continuas que toman valores dentro de un rango de 0 a 100. Esta dependencia es establecida por la empresa **"Quacquarelli Symonds"**, pues este puntaje general, como lo dijimos anteriormente, es un promedio ponderado de las otras 6 variables de puntuación:

*Reputación académica (40 %)

*Reputación del empleador (10 %)

*Proporción de profesores/ estudiantes (20 %)

*Citas por facultad (20 %)

*Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

A primera vista nos damos cuenta que la que más influye en el puntaje general es la variable **Reputación académica**, tomando en cuenta además, que tiene un coeficiente de correlación de Pearson de 0.944, un valor bastante cercano a 1.

La ecuación, tomando a $Rep. Académica$ como independiente y a $Ptje.General$ como dependiente, sería la siguiente:

$Ptje.General_{(Rep.Académica)}= 0.63784(Rep.Académica)+17.76118$

Se concluye que al tener el respaldo de la totalidad de indicadores numéricos antes mostrados, este modelo explicaría satisfactoriamente la relación entre las variables *Reputación Académica* y *Puntaje General*.


## Asia
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table(DF$Continente)
```
Asia es el segundo continente con más observaciones, es decir más universidades en el top 1024. 

##### HIPÓTESIS
Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

**Sean mayor que las puntuaciones promedio**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
D_Asia <- filter(DF,Continente=="Asia")
```


#### 1. Puntaje de Reputación académica
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRA <-D_Asia$`Puntaje de reputación académica`

hist(PRA,main="Histograma Puntaje de Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación académica`)
#Media:
media = r(mean(D_Asia$`Puntaje de reputación académica`,na.rm=T))
#Desviación estándar
sd = r(sd(D_Asia$`Puntaje de reputación académica`,na.rm=T))
#mediana
mediana = r(median(D_Asia$`Puntaje de reputación académica`,na.rm=T))
#coeficiente de variabilidad
coef=sd/media


data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 97 %

Consideramos un 97% de confianza porque el coeficiente de variabilidad es cercano a 1.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(D_Asia$`Puntaje de reputación académica`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(D_Asia$`Puntaje de reputación académica`)
desviacion <- sd(D_Asia$`Puntaje de reputación académica`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```
Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación académica`)
#Media:
media = mean(D_Asia$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación académica`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 37.79

**Hipótesis alternativa**

H_1 < 37.79

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación académica`)
#Media:
media = mean(D_Asia$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = - 1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación académica`)
#Media:
media = mean(D_Asia$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **acepta** que el promedio del puntaje de reputación académica de Asia **es menor que el general** con un nivel de significación del 3 %

Y por lo tanto se rechaza la hipótesis de que el promedio del puntaje de reputación académica de Asia sea mayor que el general con un nivel de significación del 3 %


#### 2. Puntaje de Reputación del empleador
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRE <-D_Asia$`Puntaje de reputación del empleador`

hist(PRE,main="Histograma Puntaje de Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación del empleador`)
#Media:
media = r(mean(D_Asia$`Puntaje de reputación del empleador`,na.rm=T))
#Desviación estándar
sd = r(sd(D_Asia$`Puntaje de reputación del empleador`,na.rm=T))
#mediana
mediana = r(median(D_Asia$`Puntaje de reputación del empleador`,na.rm=T))
#coeficiente de variabilidad
coef=sd/media


data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 97 %
Consideramos un 97% de confianza porque el coeficiente de variabilidad es cercano a 1
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(D_Asia$`Puntaje de reputación del empleador`)
desviacion <- sd(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación del empleador`)
#Media:
media = mean(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 38.11

**Hipótesis alternativa**

H_1 < 38.11

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación del empleador`)
#Media:
media = mean(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de reputación del empleador`)
#Media:
media = mean(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de reputación del empleador`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de reputación del empleador de Asia es menor que el general con un nivel de significación del 3 %

Y por lo tanto se **acepta** la hipótesis de que el promedio del puntaje de reputación del empleador de Asia sea mayor que el general con un nivel de significación del 3 %


#### 3. Puntaje de proporción de profesores / estudiantes
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PR <-D_Asia$`Puntaje de la proporción profesores - estudiantes`

hist(PR,main="Histograma Puntaje de proporción de profesores / estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = r(mean(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#Desviación estándar
sd = r(sd(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#mediana
mediana = r(median(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#coeficiente de variabilidad
coef=sd/media


data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 90 %
Consideramos un 90% de confianza porque el coeficiente de variabilidad es menor a 0.5
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
nc = 0.90
alfa = 0.1
z <- qnorm(1-alfa/2)
n <- length(D_Asia$`Puntaje de la proporción profesores - estudiantes`)
desviacion <- sd(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 49.02

**Hipótesis alternativa**

H_1 < 49.02

**Nivel de significancia**

alfa = 0.1

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.1
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.05 (una cola), entonces zt = - 1.28

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#ASIA
#Tamaño de la muestra:
n = length(D_Asia$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(D_Asia$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.1
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **rechaza** que el promedio del puntaje de reputación académica de Asia es menor que el general con un nivel de significación del 10 %

Y por lo tanto **se acepta la hipótesis de que el promedio del puntaje de reputación académica de Asia sea mayor que el general** con un nivel de significación del 10 %

#### 4. Puntaje de citas por facultad
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-D_Asia$`Puntaje de citas por facultad`

hist(PCF,main="Histograma Puntaje de citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
PCF <-D_Asia$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = r(mean(PCF,na.rm=T))
#Desviación estándar
sd = r(sd(PCF,na.rm=T))
#mediana
mediana = r(median(PCF,na.rm=T))
#coeficiente de variación
coef=sd/media
data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 97 %
Consideramos un 95% de confianza porque el coeficiente de variabilidad es mayor a 0.5
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-D_Asia$`Puntaje de citas por facultad`
media <- mean(PCF,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PCF)
desviacion <- sd(PCF,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#ASIA
PCF <-D_Asia$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 41.07

**Hipótesis alternativa**

H_1 < 41.07

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#ASIA
PCF <-D_Asia$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.05 (una cola), entonces zt = -1.88


**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#ASIA
PCF <-D_Asia$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de citas por facultad de Asia es menor que el general con un nivel de significación del 3 %

Y por lo tanto **se acepta la hipótesis de que el promedio del puntaje de citas por facultad de Asia sea mayor que el general** con un nivel de significación del 3 %


#### 5. Puntaje de citas por proporción de profesores internacionales
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`

hist(PPP,main="Histograma Puntaje de proporción de profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.2,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = r(mean(PPP,na.rm=T))
#Desviación estándar
sd = r(sd(PPP,na.rm=T))
#mediana
mediana = r(median(PPP,na.rm=T))
#coef
coef=sd/media
data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 97 %
Consideramos un 97% de confianza porque el coeficiente de variabilidad es cercano a 1
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
media <- mean(PPP,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PPP)
desviacion <- sd(PPP,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#ASIA
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 52.40

**Hipótesis alternativa**

H_1 < 52.40

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#ASIA
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.05 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#ASIA
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se acepta que el promedio del puntaje de proporción de profesores internacionales de Asia es menor que el general con un nivel de significación del 3 %

Y por lo tanto **se rechaza la hipótesis de que el promedio del puntaje de proporción de profesores internacionales de Asia sea mayor que el general** con un nivel de significación del 3 %

#### 6. Puntaje de citas por proporción de estudiantes internacionales
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`

hist(PPE,main="Histograma Puntaje de proporción de estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T,breaks=25)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#ASIA
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = r(mean(PPE,na.rm=T))
#Desviación estándar
sd = r(sd(PPE,na.rm=T))
#mediana
mediana = r(median(PPE,na.rm=T))
#coef
coef=sd/media
data.frame(n,media,mediana,sd,coef)
```

##### Nivel de confianza : 99 %
Consideramos un 99% de confianza porque el coeficiente de variabilidad es muy cercano 1
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
media <- mean(PPE,na.rm=T)
nc = 0.99
alfa = 0.01
z <- qnorm(1-alfa/2)
n <- length(PPE)
desviacion <- sd(PPE,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#ASIA
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Asia")
DATOS
```
**Hipótesis nula**

H_0 >= 45.90

**Hipótesis alternativa**

H_1 < 45.90

**Nivel de significancia**

alfa = 0.01

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#ASIA
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.01
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.05 (una cola), entonces zt = -2.33

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#ASIA
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.01
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se acepta que el promedio del puntaje de proporción de estudiantes internacionales de Asia es menor que el general con un nivel de significación del 1 %

Y por lo tanto **se rechaza la hipótesis de que el promedio del puntaje de proporción de estudiantes internacionales de Asia sea mayor que el general** con un nivel de significación del 1 %


## RESUMEN DEL ANÁLISIS ANTERIOR
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

layout(matrix(c(1:6),nrow=2,byrow=F))

PRA <-D_Asia$`Puntaje de reputación académica`
hist(PRA,main="Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)


PRE <-D_Asia$`Puntaje de reputación del empleador`
hist(PRE,main="Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PR <-D_Asia$`Puntaje de la proporción profesores - estudiantes`
hist(PR,main="Proporción profesores/estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PCF <-D_Asia$`Puntaje de citas por facultad`
hist(PCF,main="Citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
hist(PPP,main="Profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)

```
**Descriptores numéricos**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (round(c(mean(Valores,na.rm=T),median(Valores,na.rm=T),sd(Valores,na.rm=T),IQR(Valores,na.rm=T),(sd(Valores,na.rm=T)/mean(Valores,na.rm=T))),2))
}

PRA <-D_Asia$`Puntaje de reputación académica`
PRE <-D_Asia$`Puntaje de reputación del empleador`
PR <-D_Asia$`Puntaje de la proporción profesores - estudiantes`
PCF <-D_Asia$`Puntaje de citas por facultad`
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`

descriptores<-matrix(c(datos(PRA),datos(PRE),datos(PR),datos(PCF),datos(PPP),datos(PPE)),nrow=6,ncol=5,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(descriptores)<-c("Media","  Mediana","Desviación Estándar","  Rango Intercuartil","Coef.variabilidad")
descriptores

```

**Intervalos de confianza**

Con un nivel de confianza del 90%, 97% y 99% dependiendo del coeficiente de variabilidad.
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores,z,n){
  return (round(c(mean(Valores,na.rm=T),sd(Valores,na.rm=T),z,sd(Valores,na.rm=T)/sqrt(n),mean(Valores,na.rm=T)-sd(Valores,na.rm=T)/sqrt(n)*z,mean(Valores,na.rm=T)+sd(Valores,na.rm=T)/sqrt(n)*z),2))
}

PRA <-D_Asia$`Puntaje de reputación académica`
PRE <-D_Asia$`Puntaje de reputación del empleador`
PR <-D_Asia$`Puntaje de la proporción profesores - estudiantes`
PCF <-D_Asia$`Puntaje de citas por facultad`
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`


alfa1 = 0.1
alfa2 = 0.03
alfa3 = 0.01
z1 <- qnorm(1-alfa1/2)
z2 <- qnorm(1-alfa2/2)
z3 <- qnorm(1-alfa3/2)
n <- nrow(D_Asia)

intervalos_c<-matrix(c(datos(PRA,z2,n),datos(PRE,z2,n),datos(PR,z1,n),datos(PCF,z2,n),datos(PPP,z2,n),datos(PPE,z3,n)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("Media"," Desv_estándar","       z"," Error estándar"," limit_inf"," limit_sup")
intervalos_c

```

**HIPÓTESIS**

Asia es el segundo continente con más observaciones, es decir más universidades en el top 1024.
Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

**Sean mayor que las puntuaciones promedio**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
PRA1 <-DF$`Puntaje de reputación académica`
PRE1 <-DF$`Puntaje de reputación del empleador`
PR1 <-DF$`Puntaje de la proporción profesores - estudiantes`
PCF1 <-DF$`Puntaje de citas por facultad`
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`

#Asia
PRA <-D_Asia$`Puntaje de reputación académica`
PRE <-D_Asia$`Puntaje de reputación del empleador`
PR <-D_Asia$`Puntaje de la proporción profesores - estudiantes`
PCF <-D_Asia$`Puntaje de citas por facultad`
PPP <-D_Asia$`Puntaje de la proporción de profesores internacionales`
PPE <-D_Asia$`Puntaje de la proporción de estudiantes internacionales`

alfa1 = 0.1
alfa2 = 0.03
alfa3 = 0.01
zt1 <- qnorm(1-alfa1)
zt2 <- qnorm(1-alfa2)
zt3 <- qnorm(1-alfa3)
n <- nrow(D_Asia)

intervalos_c<-matrix(c(datos(PRA,PRA1,zt2,n,alfa2),datos(PRE,PRE1,zt2,n,alfa2),datos(PR,PR1,zt1,n,alfa1),datos(PCF,PCF1,zt2,n,alfa2),datos(PPP,PPP1,zt2,n,alfa2),datos(PPE,PPE1,zt3,n,alfa3)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c
```

Para efectos de la tabla mostrada, los valores **FALSE** indican que la hipótesis nula ha sido rechazada, y los valores **TRUE** que ha sido aceptada.



Tenemos 3 de las 6 variables de puntuación que aceptan nuestra hipótesis, pero es importante recordar que el puntaje general que define su posición en el ranking, esta dada por un promedio ponderado de estas 6 variables.

* Reputación académica (40 %)
* Reputación del empleador (10 %)
* Proporción de profesores/ estudiantes (20 %)
* Citas por facultad (20 %)
* Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

Por lo cual aplicaremos la misma prueba para el puntaje general:

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

alfa = 0.03
zt <- qnorm(1-alfa)
n = nrow(D_Asia)

x = D_Asia$`Puntaje general`
y = DF$`Puntaje general`


intervalos_c<-matrix(datos(x,y,zt,n,alfa),nrow=1,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Puntaje general ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```

Luego de analizar los puntajes en cada factor y el puntaje general, que como dijimos anteriormente es el que define la posición final en el ranking, podemos concluir que: Asia como continente, está en una buena situación en cuanto a calidad universitaria. 


# REGRESIÓN LINEAL SIMPLE
Las posiciones que ocupan en el ranking las universidades dependen directamente del puntaje general y este a su vez depende del promedio ponderado de las distintas variables de puntuación. Por lo cual en las siguientes gráficas mostramos las relaciones que tiene la variable **Puntaje General** con las otras 6 variables de puntación.

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

#Puntaje de reputación académica vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`,ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))

#Puntaje de Reputación del empleador vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de reputación del empleador`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`,ylab = "Puntaje General" , xlab = "Puntaje de Reputación del empleador")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación del empleador`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`))

#Puntaje de la proporción profesores - estudiantes  vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de la proporción profesores - estudiantes`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`,ylab = "Puntaje General" , xlab = "Proporción profesores/estudiantes")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción profesores - estudiantes`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`))

#Puntaje de citas por facultad vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de citas por facultad`))
plot( R1$`Puntaje general`~R1$`Puntaje de citas por facultad`,ylab = "Puntaje General" , xlab = "Puntaje de citas por facultad")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de citas por facultad`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`))

#Puntaje de la proporción de profesores internacionales vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de la proporción de profesores internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`,ylab = "Puntaje General" , xlab = "Profesores internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de profesores internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`))

#Puntaje de la proporción de estudiantes internacionales vs. Puntaje General (ASIA)
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de la proporción de estudiantes internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`,ylab = "Puntaje General" , xlab = "Estudiantes  internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de estudiantes internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes  internacionales`))
```
De estas gráficas visualmente podemos concluir que la que más relación directa guarda con la variable **Puntuación General** es la variable **Reputación Académica**. Y esto lo comprobamos con el coeficiente de correlación de Pearson.

```{r}
R1<-filter(D_Asia,!is.na(D_Asia$`Puntaje general`),!is.na(D_Asia$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`, col="aquamarine3",pch=19, main = "Asia",  ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)

corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Correlación:", round(corr,3)), x=20, y= 90 )

text(paste("Ec:0.65819 x + 17.79292"), x=25, y= 75,col="darkblue")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))
```
**- Observando el r-cuadrado:**
Toma el valor de  0.8914, por lo que al ser cercano a 1 decimos que nuestro modelo explica de manera satisfactoria la relación entre ambas variables.

**- Observando el p-valor:**
Alcanza un valor muy pequeño (< 2.2e-16) evidentemente menor a nuestra significancia (0.05), por lo cual podemos rechazar la hipótesis nula ($H_0$) que dicta que nuestro modelo no explica la relación entre variables.

*Finalmente:*

Concluimos que el modelo propuesto explica de manera satisfactoria la relación entre variables. Por lo tanto, no se rechaza.

Una vez realizado esto, obtenemos los valores de las constantes (*intersección y pendiente*) de nuestro modelo lineal:

$b=17.79292$

$m= 0.65819$


El puntaje general depende de 6 variables numéricas continuas que toman valores dentro de un rango de 0 a 100. Esta dependencia es establecida por la empresa **"Quacquarelli Symonds"**, pues este puntaje general, como lo dijimos anteriormente, es un promedio ponderado de las otras 6 variables de puntuación:

*Reputación académica (40 %)

*Reputación del empleador (10 %)

*Proporción de profesores/ estudiantes (20 %)

*Citas por facultad (20 %)

*Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

A primera vista nos damos cuenta que la que más influye en el puntaje general es la variable **Reputación académica**, tomando en cuenta además, que tiene un coeficiente de correlación de Pearson de 0.944, un valor bastante cercano a 1.

La ecuación, tomando a $Rep. Académica$ como independiente y a $Ptje.General$ como dependiente, sería la siguiente:

$Ptje.General_{(Rep.Académica)}= 0.65819(Rep.Académica)+17.79292$

Se concluye que al tener el respaldo de la totalidad de indicadores numéricos antes mostrados, este modelo explicaría satisfactoriamente la relación entre las variables *Reputación Académica* y *Puntaje General*.

##### **Grado de utilidad:**

Esta fórmula es útil para universidades europeas con valores desconocidos de Ptje. General, pero conocidos de Reputación Académica. La cantidad es la siguiente:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
nrow(filter(DEuropa,DEuropa$`Puntaje de reputación académica`>0,is.na(DEuropa$`Puntaje general`)))
```


##### **Haciendo uso del modelo propuesto para generar predicciones:**

###### *Para Puntaje General conocido (evaluando la efectividad del modelo):*

Escogemos una universidad que cumpla con la condición de tener los dos datos a comparar completos, para eso filtramos en Europa:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta<-filter(D_Asia,!is.na(D_Asia$`Puntaje de reputación académica`),!is.na(D_Asia$`Puntaje general`))
UniversidadCompleta[36,c(3,4,23)]
```

Obtenemos su Reputación Académica y reemplazamos en nuestra ecuación:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta[36,c(3,10)]
```
$Ptje.General_{(Rep.Académica)}= 0.65819(Rep.Académica)+17.79292$

$Ptje.General_{(64.5)}= 0.65819(49.6)+17.79292$

$Ptje.General_{(64.5)}=50.44$

Ahora, busquemos el verdadero Puntaje General de la universidad:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta[36,c(3,10,22)]
```

Observamos que los valores son bastante aproximados, con un porcentaje de error simple de 5% aproximadamente, comprobando de esta manera la efectividad de nuestro modelo.


# Data Africana 
## Análisis de la data:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
AF <- filter(DF,Continente=="África")
cat("Número de observaciones:\n")
nrow(AF)
cat("Número de casos completos:\n")
sum(complete.cases(AF))
cat("Porcentaje de datos completos:\n")
sum(!is.na(AF))/(nrow(AF)*ncol(AF))*100

```
Observamos que apenas contamos con 13 observaciones y 4 casos completos, aunque con un 74.25% de datos completos. Debido a esto, podemos decir que no contamos con un número suficiente de datos para analizar la sección africana de nuestra data derivada de las 1024 mejores universidades del mundo.

## Análisis de variables numéricas: 

### Registro de la cantidad de datos faltantes por variable:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(">>Observaciones totales\n")
nrow(AF)
cat("\n")
cat("\n")
cat("a) Datos faltantes en Puntaje General\n")
sum(is.na(AF$`Puntaje general`))
cat("\n")
cat("b) Datos faltantes en Puntaje de reputación académica\n")
sum(is.na(AF$`Puntaje de reputación académica`))
cat("\n")
cat("c) Datos faltantes en Puntaje de la proporción profesores - estudiantes\n")
sum(is.na(AF$`Puntaje de la proporción profesores - estudiantes`))
cat("\n")
cat("d) Datos faltantes en Puntaje de reputación del empleador\n")
sum(is.na(AF$`Puntaje de reputación del empleador`))
cat("\n")
cat("e) Datos faltantes en Puntaje de citas por facultad\n")
sum(is.na(AF$`Puntaje de citas por facultad`))
cat("\n")
cat("f) Datos faltantes en Puntaje de la proporción de estudiantes internacionales\n")
sum(is.na(AF$`Puntaje de la proporción de estudiantes internacionales`))
cat("\n")
cat("g) Datos faltantes en Puntaje de la proporción de profesores internacionales\n")
sum(is.na(AF$`Puntaje de la proporción de profesores internacionales`))
```

Observamos que todas tienen cantidades importantes de datos faltantes (que fluctúan entre cerca del 23% y 69%). Esto genera un sesgo en el análisis que se busca realizar al continente africano dentro de su representación en el ránking.

### Comparación de datos con la data mundial:

#### Variables determinantes del Puntaje General concedido: Boxplots

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(2,10,2,2),cex.lab=0.8)
boxplot(DF$`Puntaje de la proporción de profesores internacionales`,
        AF$`Puntaje de la proporción de profesores internacionales`,
        DF$`Puntaje de la proporción de estudiantes internacionales`,
        AF$`Puntaje de la proporción de estudiantes internacionales`,
        DF$`Puntaje de citas por facultad`,
        AF$`Puntaje de citas por facultad`,
        DF$`Puntaje de reputación del empleador`,
        AF$`Puntaje de reputación del empleador`,
        DF$`Puntaje de la proporción profesores - estudiantes`,
        AF$`Puntaje de la proporción profesores - estudiantes`,
        DF$`Puntaje de reputación académica`,
        AF$`Puntaje de reputación académica`,
        las=2,cex.names=0.5,col=c("aquamarine4","aquamarine4","aquamarine3","aquamarine3","aquamarine1","aquamarine1",
                                  "darkgray","darkgray","lightgray","lightgray","white","white"),
        main="Comparación de Variables Numéricas",
        names=c("Mundo","Proporción Prof. Intl. : África","Mundo","Proporción Est. Intl. : África","Mundo","Citas por Facultad: África","Mundo","Rep. Laboral: África","Mundo","Prop. Prof. - Est.: África","Mundo","Rep. Académica: África"), xlab="Puntaje", border = rgb(0,0,0,0.4),horizontal=1)
```
**Descriptores numéricos**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores,df){
  return (round(c(mean(Valores,na.rm=T),mean(df,na.rm=T),median(Valores,na.rm=T),sd(Valores,na.rm=T),IQR(Valores,na.rm=T)),2))
}

PRA <-AF$`Puntaje de reputación académica`
PRE <-AF$`Puntaje de reputación del empleador`
PR <-AF$`Puntaje de la proporción profesores - estudiantes`
PCF <-AF$`Puntaje de citas por facultad`
PPP <-AF$`Puntaje de la proporción de profesores internacionales`
PPE <-AF$`Puntaje de la proporción de estudiantes internacionales`

PRA1 <-DF$`Puntaje de reputación académica`
PRE1 <-DF$`Puntaje de reputación del empleador`
PR1 <-DF$`Puntaje de la proporción profesores - estudiantes`
PCF1 <-DF$`Puntaje de citas por facultad`
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`

descriptores<-matrix(c(datos(PRA,PRA1),datos(PRE,PRE1),datos(PR,PR1),datos(PCF,PCF1),datos(PPP,PPP1),datos(PPE,PPE1)),nrow=6,ncol=5,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(descriptores)<-c("Media","    Media mundial","  Mediana","Desviación Estándar","  Rango Intercuartil")
descriptores

```
En la mayoría de las variables de puntuación, África esta por debajo del promedio mundial. Además sus máximos nunca sobrepasan ni alcanzan a los máximos del mundo. 

Los 2 únicas variables que están por encima del promedio mundial son: **Reputación laboral** y **Proporción de profesores internacionales**, si recordemos los pesos de cada variable de puntuación:

* Reputación académica (40 %)
* Reputación del empleador (10 %)
* Proporción de profesores/ estudiantes (20 %)
* Citas por facultad (20 %)
* Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

Podemos observar que ambas variables solo pesan un 15%.

## Búsqueda de normalidad:

### **Puntaje de reputación académica**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de reputación académica`,breaks=25,main="Puntaje de reputación académica",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de reputación académica`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.


### **Puntaje de reputación del empleador**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de reputación del empleador`,breaks=25,main="Puntaje de reputación del empleador",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de reputación del empleador`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.

### **Puntaje de la proporción profesores - estudiantes**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de la proporción profesores - estudiantes`,breaks=25,main="Puntaje de la proporción profesores - estudiantes",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de la proporción profesores - estudiantes`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.

### **Puntaje de citas por facultad**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de citas por facultad`,breaks=25,main="Puntaje de citas por facultad",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de citas por facultad`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.

### **Puntaje de la proporción de profesores internacionales**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de la proporción de profesores internacionales`,breaks=25,main="Puntaje de la proporción de profesores internacionales",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de la proporción de profesores internacionales`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.

### **Puntaje de reputación académica**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje de la proporción de estudiantes internacionales`,breaks=25,main="Puntaje de la proporción de estudiantes internacionales",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje de la proporción de estudiantes internacionales`)
```

Vemos que el valor de **p-value** es mayor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución normal.

### **Puntaje general**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
hist(AF$`Puntaje general`,breaks=25,main="Puntaje general",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")
```

Como estamos trabajando con un nivel de confianza del 95%, nuestro alfa es 0.05. Aquí podemos decir que si nuestro **p-value** excede a este valor, la distribución será normal, caso contrario no lo será.

Para esto, realizaremos una prueba de normalidad para observar si la distribución de nuestra variable es normal.


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
shapiro.test(AF$`Puntaje general`)
```

Vemos que el valor de **p-value** es menor a 0.05. Entonces podemos afirmar que se trata de una variable con una distribución diferente a la normal.

## Búsqueda de relaciones entre variables numéricas: 

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

#Puntaje de reputación académica vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`,ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))

#Puntaje de Reputación del empleador vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de reputación del empleador`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`,ylab = "Puntaje General" , xlab = "Puntaje de Reputación del empleador")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación del empleador`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación del empleador`))

#Puntaje de la proporción profesores - estudiantes  vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de la proporción profesores - estudiantes`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`,ylab = "Puntaje General" , xlab = "Proporción profesores/estudiantes")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción profesores - estudiantes`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción profesores - estudiantes`))

#Puntaje de citas por facultad vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de citas por facultad`))
plot( R1$`Puntaje general`~R1$`Puntaje de citas por facultad`,ylab = "Puntaje General" , xlab = "Puntaje de citas por facultad")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de citas por facultad`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de citas por facultad`))

#Puntaje de la proporción de profesores internacionales vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de la proporción de profesores internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`,ylab = "Puntaje General" , xlab = "Profesores internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de profesores internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de profesores internacionales`))

#Puntaje de la proporción de estudiantes internacionales vs. Puntaje General (ASIA)
R1<-filter(AF,!is.na(AF$`Puntaje general`),!is.na(AF$`Puntaje de la proporción de estudiantes internacionales`))
plot( R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`,ylab = "Puntaje General" , xlab = "Estudiantes  internacionales")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes internacionales`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=1, lty=c(1),cex=1)
corr<- cor(R1$`Puntaje general` , R1$`Puntaje de la proporción de estudiantes internacionales`)
text(paste("Cor:", round(corr,3)), x=20, y= 70,cex=1, col="red")
#summary(lm(R1$`Puntaje general`~R1$`Puntaje de la proporción de estudiantes  internacionales`))
```
No se pueden establecer modelos lineales.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
r<- function(x)
{
  round(x,2)
}
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
table(DF$Continente)
```
África es el continente con menos observaciones, con apenas 13 observaciones 

##### HIPÓTESIS
Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

**Sean menores que las puntuaciones promedio**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
coef_var <- function(x, na.rm = TRUE) {
  sd(x, na.rm=na.rm) / mean(x, na.rm=na.rm)
}
cat(">>Coeficiente de variación del Puntaje de reputación académica\n")
coef_var(AF$`Puntaje de reputación académica`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje de reputación del empleador\n")
coef_var(AF$`Puntaje de reputación del empleador`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje de la proporción profesores - estudiantes\n")
coef_var(AF$`Puntaje de la proporción profesores - estudiantes`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje de citas por facultad\n")
coef_var(AF$`Puntaje de citas por facultad`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje de la proporción de profesores internacionales\n")
coef_var(AF$`Puntaje de la proporción de profesores internacionales`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje de la proporción de estudiantes internacionales\n")
coef_var(AF$`Puntaje de la proporción de estudiantes internacionales`)
cat("\n")
cat("\n")
cat(">>Coeficiente de variación del Puntaje general\n")
coef_var(AF$`Puntaje general`)
cat("\n")
cat("\n")
```
Teniendo en cuenta el mismo análisis de los anteriores continentes:

#### 1. Puntaje de reputación académica

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de reputación académica`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.90)
```

No se **rechaza** que el promedio del puntaje de reputación académica de África **es menor que el general** con un nivel de significación del 5 %


#### 2. Puntaje de Reputación del empleador

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de reputación del empleador`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.90)
```

No se **rechaza** la hipótesis de que el promedio del puntaje de reputación del empleador de África **sea menor** que el general con un nivel de significación del 5 %


#### 3. Puntaje de proporción de profesores / estudiantes

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de la proporción profesores - estudiantes`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.97)
```

No se **rechaza** que el promedio del puntaje de reputación académica de África **es menor** que el general con un nivel de significación del 5 %

#### 4. Puntaje de citas por facultad

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de citas por facultad`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.97)
```

No se **rechaza** la hipótesis de que el promedio del puntaje de citas por facultad de África **sea menor** que el general con un nivel de significación del 5 %.

#### 5. Puntaje de la proporción de profesores internacionales

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de la proporción de profesores internacionales`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.97)
```

No se **rechaza** la hipótesis de que el promedio del puntaje de proporción de profesores internacionales de África **sea menor** que el general con un nivel de significación del 5 %

#### 6. Puntaje de la proporción de estudiantes internacionales

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje de la proporción de estudiantes internacionales`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.97)
```

No se **rechaza** que el promedio del puntaje de proporción de estudiantes internacionales de África **es menor** que el general con un nivel de significación del 5 %


#### 7. Puntaje general

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
t.test(AF$`Puntaje general`, y = NULL,
       alternative = "less",
       mu = 0, paired = FALSE, var.equal = FALSE,
       conf.level = 0.90)
```

No se **rechaza** que el promedio del puntaje general de África **es menor** que el general con un nivel de significación del 5 %


## RESUMEN DEL ANÁLISIS ANTERIOR
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

PRA <-AF$`Puntaje de reputación académica`
hist(PRA,main="Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)


PRE <-AF$`Puntaje de reputación del empleador`
hist(PRE,main="Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PR <-AF$`Puntaje de la proporción profesores - estudiantes`
hist(PR,main="Proporción profesores/estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PCF <-AF$`Puntaje de citas por facultad`
hist(PCF,main="Citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPP <-AF$`Puntaje de la proporción de profesores internacionales`
hist(PPP,main="Profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPE <-AF$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
```

# Australia y Oceanía
```{r}
DAusOce <- filter(DF,DF$Continente == "Australia y Oceanía")
```

## Análisis de variables numéricas: 
### Registro de la cantidad de datos faltantes por variable:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(">>Observaciones totales\n")
nrow(DAusOce)
cat("\n")
cat("\n")
cat("a) Datos faltantes en Puntaje General\n")
sum(is.na(DAusOce$`Puntaje general`))
cat("\n")
cat("b) Datos faltantes en Puntaje de reputación académica\n")
sum(is.na(DAusOce$`Puntaje de reputación académica`))
cat("\n")
cat("c) Datos faltantes en Puntaje de la proporción profesores - estudiantes\n")
sum(is.na(DAusOce$`Puntaje de la proporción profesores - estudiantes`))
cat("\n")
cat("d) Datos faltantes en Puntaje de reputación del empleador\n")
sum(is.na(DAusOce$`Puntaje de reputación del empleador`))
cat("\n")
cat("e) Datos faltantes en Puntaje de citas por facultad\n")
sum(is.na(DAusOce$`Puntaje de citas por facultad`))
cat("\n")
cat("f) Datos faltantes en Puntaje de la proporción de estudiantes internacionales\n")
sum(is.na(DAusOce$`Puntaje de la proporción de estudiantes internacionales`))
cat("\n")
cat("g) Datos faltantes en Puntaje de la proporción de profesores internacionales\n")
sum(is.na(DAusOce$`Puntaje de la proporción de profesores internacionales`))
```
Observamos que todas tienen cantidades mínimas de datos faltantes (que fluctúan entre cerca del 3% y 20%). 
### Comparación de datos con la data mundial:

#### Puntaje General: Histogramas
En primer lugar, compararemos el indicador principal: el ***Puntaje General***. Mediante histogramas y boxplot revisaremos la data europea y la mundial:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

par(cex=1,cex.axis=0.8,cex.main=1,mar=c(5,3,4,0.5),cex.lab=0.8)
layout(matrix(c(1:2),nrow=1,byrow=F))

hist(main="Histograma Ptje.General (MUNDO)",DF$`Puntaje general`,breaks = 25,prob=T,col="aquamarine3")
lines(density(DF$`Puntaje general`,na.rm = T),lwd=2,col="darkgreen")
abline(v=c(mean(DF$`Puntaje general`,na.rm=T),median(DF$`Puntaje general`,na.rm=T)),col=c("red","blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","darkgreen"), inset = c(0,0),cex=0.8)

hist(main="Histograma Ptje.General (AusyOce)",DAusOce$`Puntaje general`,breaks=25,prob=T,col="white")
lines(density(DAusOce$`Puntaje general`,na.rm = T),lwd=2,col="darkgreen")
abline(v=c(mean(DAusOce$`Puntaje general`,na.rm=T),median(DAusOce$`Puntaje general`,na.rm=T)),col=c("red","blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","darkgreen"), inset = c(0,0),cex=0.8)

```
Observamos que las curvas de densidad son muy parecidas en ambos casos. Lo único que difiere entre ambas es la caída que toma la curva hacia la derecha: mientras que en *Mundo* la caída es continua, en *Australia y Oceanía* presenta algunas zonas que tienden a elevarse ligeramente.

Por otro lado, vemos medias y medianas de configuración similar en ambos con un sesgo hacia la derecha (**media** mayor a la **mediana**).

#### Puntaje General: Boxplots
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(5,3,4,0.5),cex.lab=0.8)
layout(matrix(c(1:2),nrow=1,byrow=F))

boxplot(DF$`Puntaje general`,col="aquamarine3",main="Boxplot Ptje. General (MUNDO)")
abline(h=mean(DF$`Puntaje general`,na.rm = T),col="red",lwd=2)

legend(x="topright",legend="Media",fill="red",cex=0.8)

boxplot(DAusOce$`Puntaje general`,col="white",main="Boxplot Ptje. General (Australia y Oceanía)")
abline(h=mean(DAusOce$`Puntaje general`,na.rm = T),col="red",lwd=2)

legend(x="topright",legend="Media",fill="red",cex=0.8)

#boxplot.stats(DF$`Puntaje general`)
#boxplot.stats(DEuropa$`Puntaje general`)

```

Los **boxplots**, al igual que los **histogramas**, nos muestra *configuraciones similares* entre ambas datas.

#### Variables determinantes del Puntaje General concedido: Boxplots

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(2,10,2,2),cex.lab=0.8)
boxplot(DF$`Puntaje de la proporción de profesores internacionales`,
        DAusOce$`Puntaje de la proporción de profesores internacionales`,
        DF$`Puntaje de la proporción de estudiantes internacionales`,
        DAusOce$`Puntaje de la proporción de estudiantes internacionales`,
        DF$`Puntaje de citas por facultad`,
        DAusOce$`Puntaje de citas por facultad`,
        DF$`Puntaje de reputación del empleador`,
        DAusOce$`Puntaje de reputación del empleador`,
        DF$`Puntaje de la proporción profesores - estudiantes`,
        DAusOce$`Puntaje de la proporción profesores - estudiantes`,
        DF$`Puntaje de reputación académica`,
        DAusOce$`Puntaje de reputación académica`,
        las=2,cex.names=0.5,col=c("aquamarine4","aquamarine4","aquamarine3","aquamarine3","aquamarine1","aquamarine1",
                                  "darkgray","darkgray","lightgray","lightgray","white","white"),
        main="Comparación de Variables Numéricas",
        names=c("Mundo","Proporción Prof. Intl. : Australia","Mundo","Proporción Est. Intl. : Australia","Mundo","Citas por Facultad: Australia","Mundo","Rep. Laboral: Australia","Mundo","Prop. Prof. - Est.: Australia","Mundo","Rep. Académica: Australia"), xlab="Puntaje", border = rgb(0,0,0,0.4),horizontal=1)

```

En esta primera comparación mediante boxplots observamos que las gráficas son similares en cada categoría (con fluctuaciones bajísimas entre sus descriptores numéricos como lo son la media y el rang intercuartil). Esto pasa en casi todas las variables, a excepción de **Proporción de estudiantes internacionales** y **Proporción de profesores internacionales**, donde superan con una ventaja importante a sus pares mundiales (observemos la ***mediana***).
#### Variables determinantes del Puntaje General concedido: Histogramas

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))
hist(DAusOce$`Puntaje de reputación académica`,breaks=25,main="Reputación Académica (Australia)",xlab="Puntajes",ylab="Frecuencia",col='white',prob=T)
lines(density(DAusOce$`Puntaje de reputación académica`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de reputación académica`,breaks=25,main="Reputación Académica (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='white',prob=T)
lines(density(DF$`Puntaje de reputación académica`,na.rm=T),lwd=1.5,col="black")


hist(DAusOce$`Puntaje de la proporción profesores - estudiantes`,breaks=25,main="Prop. Prof. - Est. (Australia)",xlab="Puntajes",col='lightgray',prob=T)
lines(density(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción profesores - estudiantes`,breaks=25,main="Prop. Prof. - Est. (MUNDO)",xlab="Puntajes",col='lightgray',prob=T)
lines(density(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T),lwd=1.5,col="black")


hist(DAusOce$`Puntaje de reputación del empleador`,breaks=25,main="Reputación Laboral (Australia)",xlab="Puntajes",ylab="Frecuencia",col='darkgray',prob=T)
lines(density(DAusOce$`Puntaje de reputación del empleador`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de reputación del empleador`,breaks=25,main="Reputación Laboral (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='darkgray',prob=T)
lines(density(DF$`Puntaje de reputación del empleador`,na.rm=T),lwd=1.5,col="black")



```
Los histogramas confirman y fortalecen lo ya mostrado por los boxplots, demostrando una gran similitud entre ambas datas.

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
layout(matrix(c(1:6),nrow=2,byrow=F))

hist(DAusOce$`Puntaje de citas por facultad`,breaks=25,main="Citas por Facultad (Australia)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine1',prob=T)
lines(density(DAusOce$`Puntaje de citas por facultad`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de citas por facultad`,breaks=25,main="Citas por Facultad (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine1',prob=T)
lines(density(DF$`Puntaje de citas por facultad`,na.rm=T),lwd=1.5,col="black")


hist(DAusOce$`Puntaje de la proporción de estudiantes internacionales`,breaks=25,main="Estudiantes Extranjeros (Australia)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DAusOce$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción de estudiantes internacionales`,breaks=25,main="Estudiantes Extranjeros (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine3',prob=T)
lines(density(DF$`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),lwd=1.5,col="black")


hist(DAusOce$`Puntaje de la proporción de profesores internacionales`,breaks=25,main="Profesores Extranjeros (Australia)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine4',prob=T)
lines(density(DAusOce$`Puntaje de la proporción de profesores internacionales`,na.rm=T),lwd=1.5,col="black")

hist(DF$`Puntaje de la proporción de profesores internacionales`,breaks=25,main="Profesores Extranjeros (MUNDO)",xlab="Puntajes",ylab="Frecuencia",col='aquamarine4',prob=T)
lines(density(DF$`Puntaje de la proporción de profesores internacionales`,na.rm=T),lwd=1.5,col="black")
```

#### 1. Puntaje de Reputación académica
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRA <-DAusOce$`Puntaje de reputación académica`

hist(PRA,main="Histograma Puntaje de Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación académica`)
#Media:
media = r(mean(DAusOce$`Puntaje de reputación académica`,na.rm=T))
#Desviación estándar
sd = r(sd(DAusOce$`Puntaje de reputación académica`,na.rm=T))
#mediana
mediana = r(median(DAusOce$`Puntaje de reputación académica`,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DAusOce$`Puntaje de reputación académica`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(DAusOce$`Puntaje de reputación académica`)
desviacion <- sd(DAusOce$`Puntaje de reputación académica`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación académica`)
#Media:
media = mean(DAusOce$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación académica`,na.rm=T)

datos<-round(c(c(nP,n),c(mediaP,media),c(sdP,sd)),2)

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 37.79

**Hipótesis alternativa**

H_1 < 37.79

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación académica`)
#Media:
media = mean(DAusOce$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = - 1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación académica`)
mediaP = mean(DF$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación académica`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación académica`)
#Media:
media = mean(DAusOce$`Puntaje de reputación académica`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación académica`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **r** que el promedio del puntaje de reputación académica de Europa **es mayor que el general** con un nivel de significación del 3 %.


#### 2. Puntaje de Reputación del empleador
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PRE <-DAusOce$`Puntaje de reputación del empleador`

hist(PRE,main="Histograma Puntaje de Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación del empleador`)
#Media:
media = r(mean(DAusOce$`Puntaje de reputación del empleador`,na.rm=T))
#Desviación estándar
sd = r(sd(DAusOce$`Puntaje de reputación del empleador`,na.rm=T))
#mediana
mediana = r(median(DAusOce$`Puntaje de reputación del empleador`,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(DAusOce$`Puntaje de reputación del empleador`)
desviacion <- sd(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación del empleador`)
#Media:
media = mean(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 38.11

**Hipótesis alternativa**

H_1 < 38.11

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación del empleador`)
#Media:
media = mean(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de reputación del empleador`)
mediaP = mean(DF$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de reputación del empleador`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de reputación del empleador`)
#Media:
media = mean(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de reputación del empleador`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de reputación del empleador de Australia es menor que el general con un nivel de significación del 3%.


#### 3. Puntaje de proporción de profesores / estudiantes
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PR <-DAusOce$`Puntaje de la proporción profesores - estudiantes`

hist(PR,main="Histograma Puntaje de proporción de profesores / estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```
```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = r(mean(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#Desviación estándar
sd = r(sd(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))
#mediana
mediana = r(median(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
media <- mean(DEuropa$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(DAusOce$`Puntaje de la proporción profesores - estudiantes`)
desviacion <- sd(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,"Desviación"=desviacion,z,"Error_estándar"=errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 49.02

**Hipótesis alternativa**

H_1 < 49.02

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = - 1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
#Media:
nP = length(DF$`Puntaje de la proporción profesores - estudiantes`)
mediaP = mean(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sdP = sd(DF$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

#Australia
#Tamaño de la muestra:
n = length(DAusOce$`Puntaje de la proporción profesores - estudiantes`)
#Media:
media = mean(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)
#Desviación estándar
sd = sd(DAusOce$`Puntaje de la proporción profesores - estudiantes`,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se **rechaza** que el promedio del puntaje de reputación académica de Australia es menor que el general con un nivel de significación del 3%


#### 4. Puntaje de citas por facultad
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-DAusOce$`Puntaje de citas por facultad`

hist(PCF,main="Histograma Puntaje de citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
PCF <-DAusOce$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = r(mean(PCF,na.rm=T))
#Desviación estándar
sd = r(sd(PCF,na.rm=T))
#mediana
mediana = r(median(PCF,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PCF <-DAusOce$`Puntaje de citas por facultad`
media <- mean(PCF,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PCF)
desviacion <- sd(PCF,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#Australia
PCF <-DAusOce$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 41.07

**Hipótesis alternativa**

H_1 < 41.07

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#Australia
PCF <-DAusOce$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PCF1 <-DF$`Puntaje de citas por facultad`
#Media:
nP = length(PCF1)
mediaP = mean(PCF1,na.rm=T)
#Desviación estándar
sdP = sd(PCF1,na.rm=T)

#Australia
PCF <-DAusOce$`Puntaje de citas por facultad`
#Tamaño de la muestra:
n = length(PCF)
#Media:
media = mean(PCF,na.rm=T)
#Desviación estándar
sd = sd(PCF,na.rm=T)

z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de citas por facultad de Australia es menor que el general con un nivel de significación del 3 %.

#### 5. Puntaje de citas por proporción de profesores internacionales
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`

hist(PPP,main="Histograma Puntaje de proporción de profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.7,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = r(mean(PPP,na.rm=T))
#Desviación estándar
sd = r(sd(PPP,na.rm=T))
#mediana
mediana = r(median(PPP,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
media <- mean(PPP,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PPP)
desviacion <- sd(PPP,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#EUROPA
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 52.40

**Hipótesis alternativa**

H_1 < 52.40

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#Australia
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
#Media:
nP = length(PPP1)
mediaP = mean(PPP1,na.rm=T)
#Desviación estándar
sdP = sd(PPP1,na.rm=T)

#Australia
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
#Tamaño de la muestra:
n = length(PPP)
#Media:
media = mean(PPP,na.rm=T)
#Desviación estándar
sd = sd(PPP,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de proporción de profesores internacionales de Europa sea mayor que el general** con un nivel de significación del 3%.

#### 6. Puntaje de citas por proporción de estudiantes internacionales
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Histograma Puntaje de proporción de estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.7,0),cex=0.8)
```

```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#Australia
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = r(mean(PPE,na.rm=T))
#Desviación estándar
sd = r(sd(PPE,na.rm=T))
#mediana
mediana = r(median(PPE,na.rm=T))

data.frame(n,media,mediana,sd)
```

##### Nivel de confianza : 97 %
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
media <- mean(PPE,na.rm=T)
nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
n <- length(PPE)
desviacion <- sd(PPE,na.rm=T)
errorEstandar <- desviacion/sqrt(n)

limit_inf <- media - z*errorEstandar
limit_sup <- media + z*errorEstandar

interval_m <- data.frame(n,media,desviacion,z,errorEstandar,limit_inf,limit_sup)
#interval_m <- data.frame(n,media,limit_inf,limit_sup)
interval_m
```

Datos:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#Australia
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)

datos<-r(c(c(nP,n),c(mediaP,media),c(sdP,sd)))

DATOS<-matrix(datos,nrow=3,ncol=2,byrow = T )
rownames(DATOS)<-c("Tamaño","Media","Desviación Estándar")
colnames(DATOS)<-c("General","  Australia")
DATOS
```
**Hipótesis nula**

H_0 >= 45.90

**Hipótesis alternativa**

H_1 < 45.90

**Nivel de significancia**

alfa = 0.03

**Estadístico de prueba**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#Australia
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)



z = (media - mediaP)/(sdP/sqrt(n))
r(z)
```
**Prueba de una cola**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
alfa = 0.03
zt <- qnorm(1-alfa)
-r(zt)
# Si es cola izquierda el valor saldrá negativo y si es cola derecha el valor saldrá positivo
```
alfa = 0.03 (una cola), entonces zt = -1.88

**Decisión**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
#GENERAL
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`
#Media:
nP = length(PPE1)
mediaP = mean(PPE1,na.rm=T)
#Desviación estándar
sdP = sd(PPE1,na.rm=T)

#Australia
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
#Tamaño de la muestra:
n = length(PPE)
#Media:
media = mean(PPE,na.rm=T)
#Desviación estándar
sd = sd(PPE,na.rm=T)


z = (media - mediaP)/(sdP/sqrt(n))
alfa = 0.03
zt <- qnorm(1-alfa)
prueba = z >= -zt
prueba
```
Se rechaza que el promedio del puntaje de proporción de estudiantes 
Y por lo tanto **no se rechaza la hipótesis de que el promedio del puntaje de proporción de estudiantes internacionales de Australia sea mayor que el general** con un nivel de significación del 3 %.

### Comparación de datos con la data mundial:
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
par(cex=1,cex.axis=0.8,cex.main=1,mar=c(2,10,2,2),cex.lab=0.8)
boxplot(DF$`Puntaje de la proporción de profesores internacionales`,
        DAusOce$`Puntaje de la proporción de profesores internacionales`,
        DF$`Puntaje de la proporción de estudiantes internacionales`,
        DAusOce$`Puntaje de la proporción de estudiantes internacionales`,
        DF$`Puntaje de citas por facultad`,
        DAusOce$`Puntaje de citas por facultad`,
        DF$`Puntaje de reputación del empleador`,
        DAusOce$`Puntaje de reputación del empleador`,
        DF$`Puntaje de la proporción profesores - estudiantes`,
        DAusOce$`Puntaje de la proporción profesores - estudiantes`,
        DF$`Puntaje de reputación académica`,
        DAusOce$`Puntaje de reputación académica`,
        las=2,cex.names=0.5,col=c("aquamarine4","aquamarine4","aquamarine3","aquamarine3","aquamarine1","aquamarine1",
                                  "darkgray","darkgray","lightgray","lightgray","white","white"),
        main="Comparación de Variables Numéricas",
        names=c("Mundo","Proporción Prof. Intl. : Australia","Mundo","Proporción Est. Intl. : Australia","Mundo","Citas por Facultad: Australia","Mundo","Rep. Laboral: Australia","Mundo","Prop. Prof. - Est.: Australia","Mundo","Rep. Académica: Australia"), xlab="Puntaje", border = rgb(0,0,0,0.4),horizontal=1)

```
En la mayoría de las variables de puntuación, Australia está por encima del promedio mundial. 

La única variable que está por debajo del promedio mundial es: **Proporción de profesores-estudiantes**, si recordamos los pesos de cada variable de puntuación:

* Reputación académica (40 %)
* Reputación del empleador (10 %)
* Proporción de profesores/ estudiantes (20 %)
* Citas por facultad (20 %)
* Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

Podemos observar que la variable solo pesa un 20%.


```{r eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

layout(matrix(c(1:6),nrow=2,byrow=F))

PRA <-DAusOce$`Puntaje de reputación académica`
hist(PRA,main="Reputación Académica",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRA,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRA,na.rm = TRUE), median(PRA,na.rm=TRUE)), col = c("red", "blue"),lwd=2)


PRE <-DAusOce$`Puntaje de reputación del empleador`
hist(PRE,main="Reputación empleador",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PRE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PRE,na.rm = TRUE), median(PRE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PR <-DAusOce$`Puntaje de la proporción profesores - estudiantes`
hist(PR,main="Proporción profesores/estudiantes",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PR,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PR,na.rm = TRUE), median(PR,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PCF <-DAusOce$`Puntaje de citas por facultad`
hist(PCF,main="Citas por facultad",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PCF,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PCF,na.rm = TRUE), median(PCF,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
hist(PPP,main="Profesores internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPP,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPP,na.rm = TRUE), median(PPP,na.rm=TRUE)), col = c("red", "blue"),lwd=2)

PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`
hist(PPE,main="Estudiantes internacionales",xlab="Puntaje",col="aquamarine3", prob=T)
lines(density(PPE,na.rm=T),lwd=2,col="black")
abline(v = c(mean(PPE,na.rm = TRUE), median(PPE,na.rm=TRUE)), col = c("red", "blue"),lwd=2)
legend(x='topright',legend=c("Media","Mediana","Curva de Densidad"),fill=c("red", "blue","black"), inset = c(0.35,0),cex=0.5)
```
**Descriptores numéricos**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores){
  return (round(c(mean(Valores,na.rm=T),median(Valores,na.rm=T),sd(Valores,na.rm=T),IQR(Valores,na.rm=T)),2))
}

PRA <-DAusOce$`Puntaje de reputación académica`
PRE <-DAusOce$`Puntaje de reputación del empleador`
PR <-DAusOce$`Puntaje de la proporción profesores - estudiantes`
PCF <-DAusOce$`Puntaje de citas por facultad`
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`

descriptores<-matrix(c(datos(PRA),datos(PRE),datos(PR),datos(PCF),datos(PPP),datos(PPE)),nrow=6,ncol=4,byrow=T)

rownames(descriptores)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(descriptores)<-c("Media","  Mediana","Desviación Estándar","  Rango Intercuartil")
descriptores

```
**Intervalos de confianza**

Con un nivel de confianza del 97%
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(Valores,z,n){
  return (round(c(mean(Valores,na.rm=T),sd(Valores,na.rm=T),z,sd(Valores,na.rm=T)/sqrt(n),mean(Valores,na.rm=T)-sd(Valores,na.rm=T)/sqrt(n)*z,mean(Valores,na.rm=T)+sd(Valores,na.rm=T)/sqrt(n)*z),2))
}

PRA <-DAusOce$`Puntaje de reputación académica`
PRE <-DAusOce$`Puntaje de reputación del empleador`
PR <-DAusOce$`Puntaje de la proporción profesores - estudiantes`
PCF <-DAusOce$`Puntaje de citas por facultad`
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`

nc = 0.97
alfa = 0.03
z <- qnorm(1-alfa/2)
z1 <- qnorm(1-0.01/2)
z2 <- qnorm(1-0.1/2)
n <- nrow(DAusOce)



intervalos_c<-matrix(c(datos(PRA,z,n),datos(PRE,z,n),datos(PR,z2,n),datos(PCF,z,n),datos(PPP,z,n),datos(PPE,z,n)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("Media"," Desv_estándar","       z"," Error estándar"," limit_inf"," limit_sup")
intervalos_c

```

En todo el proceso, los niveles de confianza usados en, valga la redundancia, $intervalos$ $de$ $confianza$, van a depender de la variación que presentan las variables. Mientras estas varían menos se da una mayor importancia a la precisión y mientras más varían aumentamos el nivel de confianza para tener una mayor aproximación a la media real. 
Si no se tomará en cuenta las característica de las variables estudiadas podríamos a tender a generar intervalos inseguros por su amplitud, o al contrario, generar intervalos tan reducidos que sean incapaces de contener a la media real.


**HIPÓTESIS**

Australia y Oceanía es uno de los continentes con muy pocas observaciones (poco más de 40).

Por lo que podemos suponer que sus puntuaciones en los distintos factores:

- Reputación académica
- Reputación del empleador
- Proporción de profesores/ estudiantes 
- Citas por facultad 
- Proporción de profesores internacionales 
- Proporción de estudiantes internacionales 

Sean menor que las puntuaciones promedio; sin embargo, en los boxplots anteriores pudimos observar que en la mayoría de variables de puntuación el promedio es **mayor que el promedio mundial**

Comprobar o negar esta hipótesis nos hace avanzar con el objetivo principal de esta investigación: *alcanzar una comprensión más profunda de los países y o continentes que ofrecen mejor educación superior y los factores que le brindan esta calidad.*

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
PRA1 <-DF$`Puntaje de reputación académica`
PRE1 <-DF$`Puntaje de reputación del empleador`
PR1 <-DF$`Puntaje de la proporción profesores - estudiantes`
PCF1 <-DF$`Puntaje de citas por facultad`
PPP1 <-DF$`Puntaje de la proporción de profesores internacionales`
PPE1 <-DF$`Puntaje de la proporción de estudiantes internacionales`

#Australia y Oceanía 
PRA <-DAusOce$`Puntaje de reputación académica`
PRE <-DAusOce$`Puntaje de reputación del empleador`
PR <-DAusOce$`Puntaje de la proporción profesores - estudiantes`
PCF <-DAusOce$`Puntaje de citas por facultad`
PPP <-DAusOce$`Puntaje de la proporción de profesores internacionales`
PPE <-DAusOce$`Puntaje de la proporción de estudiantes internacionales`


z = (media - mediaP)/(sd/sqrt(n))

alfa = 0.03
zt <- qnorm(1-alfa)
n = nrow(DAusOce)

intervalos_c<-matrix(c(datos(PRA,PRA1,zt,n,alfa),datos(PRE,PRE1,zt,n,alfa),datos(PR,PR1,zt,n,alfa),datos(PCF,PCF1,zt,n,alfa),datos(PPP,PPP1,zt,n,alfa),datos(PPE,PPE1,zt,n,alfa)),nrow=6,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Reputación Académica ","Reputación del empleador ","Proporción Profesores Estudiantes ","Citas por Facultad ","Profesores Extranjeros ","Estudiantes Extranjeros ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c
```

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

alfa = 0.03
zt <- qnorm(1-alfa)
n = nrow(DAusOce)

x = DAusOce$`Puntaje general`
y = DF$`Puntaje general`


intervalos_c<-matrix(datos(x,y,zt,n,alfa),nrow=1,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Puntaje general ")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```

Luego de analizar los puntajes en cada factor y el puntaje general, que como dijimos anteriormente es el que define la posición final en el ranking, podemos concluir que: Asia como continente, está en una buena situación en cuanto a calidad universitaria. 


## XII Análisis final

Como parte final del proyecto, recopilaremos todo la información obtenida a lo largo de este proyecto para responder a las preguntas de investigación planteadas inicialmente.


**¿Se encuentran aglomeradas en zonas específicas del globo las mejores universidades a nivel mundial?**

**TABLA DE FRECUENCIA**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
A<-which(DF$Continente=="África")
B<-which(DF$Continente=="América")
C<-which(DF$Continente=="Asia")
D<-which(DF$Continente=="Australia y Oceanía")
E<-which(DF$Continente=="Europa")

uno<-c(sum(A<=300),sum(B<=300),sum(C<=300),sum(D<=300),sum(E<=300))
dos<-c(sum(A<=600&A>300),sum(B<=600&B>300),sum(C<=600&C>300),sum(D<=600&D>300),sum(E<=600&E>300))
tres<-c(sum(A<=900&A>600),sum(B<=900&B>600),sum(C<=900&C>600),sum(D<=900&D>600),sum(E<=900&E>600))
cuatro<-c(sum(A>900),sum(B>900),sum(C>900),sum(D>900),sum(E>900))
DN <- DF%>%group_by(Continente)%>%summarise()

DN <- cbind(DN,"Top 300"=uno,"Top[300-600]"=dos,"Top[600-900]"=tres,"TopDown"=cuatro)
I<-t(DN[-1])
colnames(I)<-c(DN$Continente)
I<-rbind(I,Total=colSums(I))
I
```

Esta tabla nos permite darnos cuenta que, efectivamente, las mejores universidades del mundo se encuentran aglomeradas en zonas específicas, pues para empezar África y Australia tienen muy poca presencia en este ranking a comparación de los otros continentes. Y dentro de las primeras 300 mejores universidades, Europa y América tienen mucho más presencia. 


**¿Cuál es el país que produce más trabajos de investigación?**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DFprueba2 <- DF%>%group_by(País)%>%summarise(n=n(),Punt.Citas=round(mean(`Puntaje de citas por facultad`,na.rm=T),2),Punt.Citas_mediana=median(`Puntaje de citas por facultad`,na.rm=T))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
m<-mean(DFprueba2$n,na.rm=T)

filtro1 <- filter(DFprueba2,n>12)
filtro1 <- arrange(filtro1,(filtro1$Punt.Citas))
nombres1 <- c(filtro1$País)

america<-"#32CD32"
asia<-"#FFFF66"
europa<-"#FF6347"
oceania<-"#00BFFF"

```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
coloresPorContinente=c(america,america,europa,europa,asia,america,europa,asia,europa,asia,asia,europa,europa,america,europa,america,oceania,asia,asia,europa)

par(cex=0.8,mar = c(2, 7, 2, 1))
barplot(filtro1$Punt.Citas,horiz=T,names.arg =nombres1,las=1,cex.names = 0.9,xlim=c(0,85),col=coloresPorContinente, main = "Puntaje de citas por facultad por países")
legend(x="bottomright", title="Continentes",inset=c(0,0.05),legend=c("América","Asia","Europa","Oceanía"),fill=c("#32CD32","#FFFF66","#FF6347","#00BFFF"), horiz=TRUE)

abline(v = mean(filtro1$Punt.Citas,na.rm=T), col="black", lwd=3, lty=2)
abline(v = median(filtro1$Punt.Citas_mediana,na.rm=T), col="black")
legend(x="bottomright", inset = c(0.03, 0.35), legend=c("Mediana  ", "Media    "),
       col=c("black", "black"),lty=1:2)
```

Netherlands es evidentemente el país que produce más trabajo de investigación, esto lo vemos a través del puntaje de citas por facultad. Además más paises de Europa, al cual también pertenece Netherlands, sobrepasan la media. 

**¿Dónde se encuentran las universidades con mayor apreciación de estudiantes internacionales?**

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
DFprueba <- DF%>%group_by(País)%>%summarise(n=n(),Punt.Estd.intr=round(mean(`Puntaje de la proporción de estudiantes internacionales`,na.rm=T),2),Punt.Estd_mediana=median(`Puntaje de la proporción de estudiantes internacionales`,na.rm=T))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
x<-mean(DFprueba$n,na.rm=T)

filtro <- filter(DFprueba,n>12)
filtro <- arrange(filtro,(filtro$Punt.Estd.intr))
nombres <- c(filtro$País)


america<-"#32CD32"
asia<-"#FFFF66"
europa<-"#FF6347"
oceania<-"#00BFFF"

```

```{r   eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
coloresPorContinente=c(asia,america,america,europa,asia,europa,asia,asia,asia,europa,europa,america,europa,america,asia,europa,america,europa,europa,oceania)

par(cex=0.8,mar = c(2, 7, 2, 1))
barplot(filtro$Punt.Estd.intr,horiz=T,names.arg =nombres,las=1,cex.names = 0.9,xlim=c(0,85),col=coloresPorContinente, main = "Puntaje de estudiantes internacionales por países")
legend(x="bottomright", title="Continentes",inset=c(0,0.05),legend=c("América","Asia","Europa","Oceanía"),fill=c("#32CD32","#FFFF66","#FF6347","#00BFFF"), horiz=TRUE)

abline(v = mean(filtro$Punt.Estd.intr,na.rm=T), col="black", lwd=3, lty=2)
abline(v = median(filtro$Punt.Estd_mediana,na.rm=T), col="black")
legend(x="bottomright", inset = c(0.03, 0.35), legend=c("Mediana  ", "Media    "),
       col=c("black", "black"),lty=1:2)
```
En cuanto a apreciación de estudiantes internacionales, sobresalen Australia y Reino Unido, estos son de "Australia y Oceanía" y Europa respectivamente. Sin embargo, más países de Europa sobrepasan la media y mediana, mientras que "Australia y Oceanía" solo tienen una aparición.


**¿Cuál es el nivel de diferencia entre universidades en la calificación general según la cantidad de años que llevan en funciones?**


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(4, 4, 3, 10))
boxplot(DF$`Puntaje general`~ DF$`Tiempo de funcionamiento` , ylab = "Puntaje general ", xlab = "Tiempo de funcionamiento", col =colorRampPalette(c('white','aquamarine4'))(5),main="Puntaje general vs Tiempo de funcionamiento")
name <- paste(c("1 : De 0 a 10 años", "2 : De 10 a 25 años","3 : De 25 a 50 años","4 : De 50 a 100 años","5 : De 100 años a más"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('white','aquamarine4'))(5), xpd = TRUE,inset = c(-0.4, 0))
legend(x ="bottomright",legend = c("    Mediana    Coef.Var","5    44.9           0.41","4    33.4           0.35","3    33.85         0.40","2    28.2           0.13","1    34.7           0.41"),cex=0.9, xpd = TRUE,inset = c(-0.44, 0))
```
Mientras más antigua es una universidad mejor posición en el ranking tiene, recordemos nuevamente que esta posición esta dada por el puntaje general que a su vez depende de las otras 6 variables de puntuación correspondientes a distintas áreas. Sin embargo las universidades nuevas no siguen este patron, pese a su baja aparición dentro del ranking logran sobrepasar a universidades de hasta 100 años.


**¿Producen más conocimiento las universidades con recorrido o universidades relativamente nuevas?**


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
opar <- par(no.readonly = TRUE)
par(mar = c(4, 4, 3, 10))
cinco <- DF$`Puntaje de citas por facultad`[DF$`Tiempo de funcionamiento`=="5"]
cuatro <- DF$`Puntaje de citas por facultad`[DF$`Tiempo de funcionamiento`=="4"]
tres <- DF$`Puntaje de citas por facultad`[DF$`Tiempo de funcionamiento`=="3"]
dos <- DF$`Puntaje de citas por facultad`[DF$`Tiempo de funcionamiento`=="2"]
uno <- DF$`Puntaje de citas por facultad`[DF$`Tiempo de funcionamiento`=="1"]
medianas <- c(median(cinco), median(cuatro), median(tres), median(dos), median(uno))
index <- order(medianas, decreasing = TRUE)
  boxplot(cinco,cuatro,tres,dos,uno, at = index, main = "Tiempo de funcionamiento y puntaje de citas por facultad", ylab = "Puntaje de citas por facultad ", xlab = "Tiempo de funcionamiento", col =colorRampPalette(c('aquamarine4','white'))(5), names=c("5","4","3","2","1")
)
name <- paste(c("1 : Nuevo (0  a  10  años)","2 : Joven (10 a  25  años)","3 : Establecido (25 a 100 años)","4 : Maduro (50 a 100 años)","5 : Histórico (Más de 100 años)"))
legend(x ="topright",legend = name , cex = 0.595, fill = colorRampPalette(c("white",'aquamarine4'))(5), xpd = TRUE,inset = c(-0.44, 0))
legend(x ="bottomright",legend = c("    Mediana    Coef.Var","5    42.4           0.56","4    36.8           0.60","3    32.2           0.66","2    23.4           0.85","1    36.2           0.41"),cex=0.9, xpd = TRUE,inset = c(-0.44, 0))
```
Mientras más antigua es una universidad mejor puntuación de citas por facultad tiene, es decir, tienen más aporte de conocmientos. Sin embargo las universidades nuevas no siguen este patron, pese a su baja aparición dentro del ranking logran sobrepasar a universidades de hasta 100 años. Además, el mínimo del puntaje de las universidades nuevas es incluso mayor que las históricas.


**¿Se relacionan de manera directa la cantidad de alumnos y el nivel de educación de la universidad?**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}

opar <- par(no.readonly = TRUE)
par(mar = c(6, 5, 4, 10))
XL <- DF$`Puntaje de reputación académica`[DF$`Clasificación de tamaño`=="XL"]
L <- DF$`Puntaje de reputación académica`[DF$`Clasificación de tamaño`=="L"]
M <- DF$`Puntaje de reputación académica`[DF$`Clasificación de tamaño`=="M"]
S <- DF$`Puntaje de reputación académica`[DF$`Clasificación de tamaño`=="S"]
medianas <- c(median(XL), median(L), median(M), median(S))
index <- order(medianas, decreasing = TRUE)
  boxplot(XL,L,M,S, at = index, main = "Clasificación de tamaño y puntaje de reputación académica", ylab = "Puntaje de reputación académica ", xlab = "Clasificación de tamaño", col =colorRampPalette(c('aquamarine4','white'))(4), names=c("XL","L","M","S")
)
name <- paste(c("XL : Más de 30 000", "L : Más de 12 000","S : Más de 1 000","M : Más de 5 000"))
legend(x ="topright",legend = name , cex = 0.7, fill = colorRampPalette(c('aquamarine4','white'))(4), xpd = TRUE,inset = c(-0.45, 0))
legend(x ="bottomright",legend = c("    Media    Mediana","S     19.96        15.35","M     24.92        19.90","L      38.39        29.50","XL    47.40        39.35"),cex=0.9, xpd = TRUE,inset = c(-0.44, 0))
```
Mientras más alumnos albergue una universidad mejor reputación académica tiene. Aunque siempre hay algunas excepciones, como se pueden observar con los datos atípicos que logran alcanzar en 2 ocaciones al puntaje máximo posible (100 puntos).


**Hipótesis finales**

Como se ha mencionado anteriormente, el puntaje general es dependiente de las otras variables estudiadas. Es por ello, que para elegir al continente que mejor calidad de educación universiaria posee, se planteó como **H_0** que las medias del puntaje general por continente sea mayor a la media mundial

**Parámetros**

- **Nivel de confianza:** Varía entre 90%,97% y 99% dependiendo del coeficiente de variación de la variable

Mientras más cercano al 1 sea el coeficiente de variación usamos un mayor nivel de confianza.

- Usamos 90% cuando son menores a 0.4
- Usamos 97% cuando son iguales o mayores a 0.5
- Usamos 99% cuando son de 0.9 en adelante.

Esta diferencia de niveles de confianza puede generar posible errores como los errores Tipo I y Tipo II. En los casos que busquemos darle más importancia a la precisión podríamos estar cometiendo el error de tipo I, al rechazar una hipótesis nula que puede ser verdadera. Caso contrario, al darle más relevancia a la confianza y aumentar el intervalo podríamos dar como verdadera una hipótesis nula que debería ser rechazada, cometiendo de esta manera un error del tipo II.  

De esta manera, podemos demostrar la importancia de escoger un correcto nivel de confianza, minimizando las probabilidades de error en base a las características de nuestra muestra.

- **Tamaño de la muestra:** 1024
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
D_E <- filter(DF,Continente=="Europa")
D_Am <- filter(DF,Continente=="América")
D_As <- filter(DF,Continente=="Asia")
D_A <- filter(DF,Continente=="Australia y Oceanía")
D_Af <- filter(DF,Continente=="África")
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = mean(general,na.rm=T)
  sdP = sd(general,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
P <-DF$`Puntaje general`

#Asia
A <-D_E$`Puntaje general`
B <-D_Am$`Puntaje general`
C <-D_As$`Puntaje general`
D <-D_A$`Puntaje general`
E <-D_Af$`Puntaje general`



alfa1 = 0.1
alfa2 = 0.03
alfa3 = 0.01
zt1 <- qnorm(1-alfa1)
zt2 <- qnorm(1-alfa2)
zt3 <- qnorm(1-alfa3)

a <- nrow(D_E)
b <- nrow(D_Am)
c <- nrow(D_As)
d <- nrow(D_A)
e <- nrow(D_Af)



intervalos_c<-matrix(c(datos(A,P,zt1,a,alfa1),datos(B,P,zt2,b,alfa2),datos(C,P,zt3,c,alfa3),datos(D,P,zt3,d,alfa3),datos(E,P,zt2,e,alfa2)),nrow=5,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Europa","América ","Asia ","Australia","África")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```
Para efectos de la tabla mostrada, los valores **FALSE** indican que la hipótesis nula ha sido rechazada, y los valores **TRUE** que no ha sido rechazada.


Sólo África no logró pasar a la media mundial. Esto no nos ayuda mucho a responder nuestro objetivo de investigación por lo que plantearemos una nueva hipótesis:

Se planteó como **H_0** que las medias del puntaje general por continente sea mayor que 50, pues este es un valor medio entre los posibles valores que toma esta variable (0 a 100)

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
D_E <- filter(DF,Continente=="Europa")
D_Am <- filter(DF,Continente=="América")
D_As <- filter(DF,Continente=="Asia")
D_A <- filter(DF,Continente=="Australia y Oceanía")
D_Af <- filter(DF,Continente=="África")
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
datos<-function(asia,general,zt,n,alfa){
  media = mean(asia,na.rm=T)
  mediaP = general
  sdP = sd(asia,na.rm=T)
  z = (media - mediaP)/(sdP/sqrt(n))
  prueba = z >= -zt
  Ho= paste("µ",r(mediaP),sep = ">=")
  H1 = paste("µ",r(mediaP),sep = "<")
  return (c(Ho,H1,as.numeric(r(alfa)),r(z),r(-zt),prueba))
}

#General
P <- 50

#Asia
A <-D_E$`Puntaje general`
B <-D_Am$`Puntaje general`
C <-D_As$`Puntaje general`
D <-D_A$`Puntaje general`
E <-D_Af$`Puntaje general`



alfa1 = 0.1
alfa2 = 0.03
alfa3 = 0.01
zt1 <- qnorm(1-alfa1)
zt2 <- qnorm(1-alfa2)
zt3 <- qnorm(1-alfa3)

a <- nrow(D_E)
b <- nrow(D_Am)
c <- nrow(D_As)
d <- nrow(D_A)
e <- nrow(D_Af)



intervalos_c<-matrix(c(datos(A,P,zt1,a,alfa1),datos(B,P,zt2,b,alfa2),datos(C,P,zt3,c,alfa3),datos(D,P,zt3,d,alfa3),datos(E,P,zt2,e,alfa2)),nrow=5,ncol=6,byrow=T)

rownames(intervalos_c)<-c("Europa","América ","Asia ","Australia","África")

colnames(intervalos_c)<-c("  H_0","  H_1"," alfa","Estad_Prueba","Punto_crítico"," Decisión")
intervalos_c

```
Para efectos de la tabla mostrada, los valores **FALSE** indican que la hipótesis nula ha sido rechazada, y los valores **TRUE** que no ha sido rechazada.


**Análisis y decisión final**

Sólo América y Australia superan los 50 puntos en puntaje general; sin embargo,América tiene muchas más observaciones que Australia. Considerando que nuestra muestra es discrecional, es decir por conveniencia, llegamos a la decisión de declarar a América como el continente con mejor calidad universitaria
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(" América : ",nrow(D_Am))
```

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
cat(" Australia: ",nrow(D_A))
```

**Relación entre Puntaje de reputación académica y Puntaje General**
```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
R1<-filter(DF,!is.na(DF$`Puntaje general`),!is.na(DF$`Puntaje de reputación académica`))
plot( R1$`Puntaje general`~R1$`Puntaje de reputación académica`, col="aquamarine3",pch=19, main = "Puntaje de reputación académica vs. Puntaje General",  ylab = "Puntaje General" , xlab = "Puntaje de reputación académica")
#modelo lineal
abline(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`), lwd=3)
#leyenda
legend("topleft",legend = c("Modelo Lineal"), lwd=3, lty=c(1), col("red"))

corr<- cor(R1$`Puntaje general` , R1$`Puntaje de reputación académica`)
text(paste("Correlación:", round(corr,3)), x=15, y= 80)

text(paste("Ecuación: 0.6241 x + 18.9522"), x=23, y= 70,col="darkblue")
```


```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
summary(lm(R1$`Puntaje general`~R1$`Puntaje de reputación académica`))
```


**Validando los coeficientes**

**- Observando el r-cuadrado:** Vemos que toma el valor de 0.8223, que es bastante aceptable.

**- Observando el p-valor:** Alcanza un valor muy pequeño (< 2.2e-16) evidentemente menor a nuestra significancia (0.03), por lo cual podemos rechazar $H_0$ que dicta que nuestro modelo no explica la relación entre variables.


Obtenemos los valores de las constantes (*intersección y pendiente*) de nuestro modelo lineal:

$b=18.9522$ 

$m= 0.6241$

El puntaje general depende de 6 variables numéricas continuas que toman valores dentro de un rango de 0 a 100. Esta dependencia es establecida por la empresa **"Quacquarelli Symonds"**, pues este puntaje general, como lo dijimos anteriormente, es un promedio ponderado de las otras 6 variables de puntuación.

La variable que más influye en el puntaje general es la variable **Reputación académica** pues tiene un coeficiente de correlación de Pearson de 0.907, un valor bastante cercano a 1.

La ecuación, tomando a $Rep. Académica$ como independiente y a $Ptje.General$ como dependiente, sería la siguiente:

$Ptje.General_{(Rep.Académica)}= 0.6241(Rep.Académica)+18.9522$

Se concluye que al tener el respaldo de la totalidad de indicadores numéricos antes mostrados, este modelo explicaría satisfactoriamente la relación entre las variables *Reputación Académica* y *Puntaje General*.



**Haciendo uso del modelo propuesto para generar predicciones:**

*Para Puntaje General conocido (evaluando la efectividad del modelo):*

Escogemos una universidad que cumpla con la condición de tener los dos datos a comparar completos:

```{r  eval=TRUE, echo=FALSE, message=FALSE,warning=FALSE}
UniversidadCompleta<-filter(DF,!is.na(DF$`Puntaje de reputación académica`),!is.na(DF$`Puntaje general`))
UniversidadCompleta[36,c(3,10,22)]
```

Obtenemos su Reputación Académica y reemplazamos en nuestra ecuación:

$Ptje.General_{(Rep.Académica)}=0.6241(Rep.Académica)+18.9522$

$Ptje.General_{(100)}=0.6241(100)+18.9522$

$Ptje.General_{(100)}=81.36$

Observamos que los valores son bastante aproximados, con un porcentaje de error simple de 1.2% comprobando de esta manera la efectividad de nuestro modelo.



## XIII Conclusiones

Concluimos que América es el mejor continente a nivel mundial en base a la prueba de hipótesis planteada para el Puntaje General, que defina la posición general de una universidad a nivel mundial.
 
Además de esto, otro factor que respalda su superioridad es el área cuantitativa, donde 159 de las 1024 universidades (más del 10% del total) son universidades estadounidenses pertenecientes a su vez a América. Esto además indica que la concentración de la calidad educativa se da justamente en este país.

En base a lo anterior, una propuesta de mejora para nuestro planteamiento inicial sería la selección de áreas continentales en lugar de continentes completos. Haciendo esta separación, tendríamos posiblemente que América del Norte (perteneciente al total América) es en realidad el área continental mejor valuada, en vez de asegurar que todo el continente completo posee una superioridad educativa en comparación al resto del mundo.

Por otro lado, en base a los países más importantes podemos señalar a Estados Unidos y Reino Unido - Alemania por parte de América y Europa, respectivamente. Estos países son los de mayor representación dentro de la lista total de universidades de alto rango mundial. Además, no podemos dejar de lado a Australia dentro de Oceanía, que a pesar de su poca cantidad de universidades, la mayoría de estas alcanzan puntajes sobresaliente en diversos ámbitos como el de Puntaje por Composición Extranjera y el de Citas Por Facultad.

Analizando la influencia de las variables en la calificación final tenemos lo siguiente: en las categóricas, obtuvimos una relación directamente proporcional entre el Puntaje General y la longevidad y cantidad de estudiantes que posee la universidad, por lo que se concluye que estos factores son en gran parte determinantes al analizar la calidad universitaria.

En adición, contrario a lo que se pensó al principio, no se logra establecer una relación directa entre las variables referentes a la investigación y a la apreciación internacional con la del Puntaje General obtenido. Se establece una relación poco significativa y no concluyente entre variables.

Por el contrario, la variable Reputación Académica alcanza una relación lineal bastante clara con el Puntaje General. 

Estas últimas conclusiones respaldan la importancia que se le da en la evaluación por parte de la compañía QS a cada una de las áreas analizadas:

- De alto grado de relación:
Reputación académica (40 %)

- De bajo grado de relación:
Citas por facultad (20 %)
Proporción de estudiantes internacionales / profesores internacionales (5 % cada uno)

